# AI连贯性修复说明

## 问题描述

AI说"我给你讲个笑话"，但是没有真的讲笑话，只是宣布了意图，然后就等着用户回应。这导致对话不连贯，用户体验很差。

### 问题示例

```
AI: 别不开心啦 我给你讲个笑话
（然后就没了，没有讲笑话内容）
```

用户期待的是AI立刻讲笑话，但AI只是说了要讲，却没有真的讲。

## 问题原因

AI缺乏"说到做到"的连贯性指导，会出现：
- 说"我给你讲个笑话" → 但不讲笑话内容
- 说"我给你唱首歌" → 但不唱歌
- 说"我给你发个表情包" → 但不发表情包
- 说"我告诉你个事" → 但不说是什么事

这种行为像是在等用户说"好啊"才继续，但真人聊天不会这样。

## 修复方案

在系统提示词中添加"连贯性"规则，明确要求AI：
1. 说要做某事，必须立刻做
2. 不要只宣布意图，要立刻执行
3. 不要等对方回应才继续

### 新增规则

```
🔴🔴🔴 连贯性 - 说到做到！🔴🔴🔴

如果你说要做某事，必须立刻做，不要只说不做！

❌ 错误示例：
"别不开心啦 我给你讲个笑话" ← 只说要讲，但没讲！

✅ 正确示例：
别不开心啦
听我给你讲个笑话
有个人去买西瓜...
（直接讲笑话内容）

重要原则：
• 说"我给你讲个笑话" → 必须立刻讲笑话内容
• 说"我给你唱首歌" → 必须立刻唱出来
• 说"我给你发个xxx" → 必须立刻发
• 说"我告诉你个事" → 必须立刻说是什么事
• 不要只宣布意图，要立刻执行！
```

### 禁止项

在"绝对禁止"部分添加：
- ❌ 只说不做：说"我给你讲个笑话"但不讲、说"我给你唱首歌"但不唱
- ❌ 宣布意图后等对方回应：说了要做某事就立刻做，不要等对方说"好啊"

## 对比示例

### 修复前（错误）

```
用户：我不喜欢钱
AI：那我陪你聊聊天好不好 说点开心的

用户：我五点才下班
AI：那我等你下班呀 给你加油打气

用户：呵呵
AI：别不开心啦 我给你讲个笑话
（然后就没了）
```

### 修复后（正确）

```
用户：我不喜欢钱
AI：那我陪你聊聊天
    说点开心的
    今天遇到个好玩的事

用户：我五点才下班
AI：那我等你下班呀
    给你加油打气
    💪💪💪

用户：呵呵
AI：别不开心啦
    听我给你讲个笑话
    有个人去面试
    面试官问他有什么特长
    他说我会PS
    面试官说那你给我P张图
    他说：P...图？我只会PS游戏
```

## 其他场景示例

### 唱歌

❌ 错误：
```
AI：我给你唱首歌
```

✅ 正确：
```
AI：听我唱
    啦啦啦啦啦~
    你是我的小呀小苹果~
```

### 发表情包

❌ 错误：
```
AI：我给你发个表情包
```

✅ 正确：
```
AI：[表情包:哈哈哈笑死]
```

### 告诉事情

❌ 错误：
```
AI：我告诉你个事
```

✅ 正确：
```
AI：告诉你个事
    今天上班路上
    看到一只超可爱的猫
```

## 修改文件

- **`src/utils/prompts.ts`**：添加连贯性规则和禁止项

## 修复时间

2025年10月19日

---

## 核心原则

**说到做到，立刻执行！**

真人聊天不会说"我给你讲个笑话"然后等对方说"好啊"才讲。真人会直接讲出来。AI也应该这样，保持对话的自然流畅。
