# Cloudflare Workers 反代部署教程

## 你已经有的文件
- ✅ `cloudflare-worker-ai-proxy.js` - 完整的反代代码（已填好你的 10 个 Key）

---

## 第一步：注册 Cloudflare 账号（2分钟）

1. 访问：https://dash.cloudflare.com/sign-up
2. 填写邮箱和密码
3. 验证邮箱
4. 登录

---

## 第二步：创建 Worker（3分钟）

### 1. 进入 Workers 页面
- 登录后，左侧菜单找到 **"Workers & Pages"**
- 点击进入

### 2. 创建新 Worker
- 点击右上角 **"Create Application"** 按钮
- 选择 **"Create Worker"**
- 名字随便起，比如：`gemini-proxy` 或 `ai-api`
- 点击 **"Deploy"**

### 3. 编辑代码
- 部署后，点击 **"Edit Code"** 按钮
- 删除所有默认代码
- 打开你电脑上的 `cloudflare-worker-ai-proxy.js` 文件
- **全选复制**所有代码
- **粘贴**到 Cloudflare 编辑器中
- 点击右上角 **"Save and Deploy"** 按钮

---

## 第三步：获取你的反代地址

部署成功后，你会看到一个地址，格式像这样：
```
https://gemini-proxy.你的用户名.workers.dev
```

**复制这个地址！** 这就是你的专属 AI API 反代地址！

---

## 第四步：测试是否正常

### 方法 1：浏览器测试
直接在浏览器打开你的地址：
```
https://你的worker地址.workers.dev/health
```

如果看到类似这样的 JSON，说明成功了：
```json
{
  "status": "ok",
  "service": "Gemini API Proxy",
  "totalKeys": 10,
  "stats": [...]
}
```

### 方法 2：命令行测试（可选）
打开 PowerShell，运行：
```powershell
curl https://你的worker地址.workers.dev/v1beta/models/gemini-pro:generateContent `
  -Method POST `
  -Headers @{"Content-Type"="application/json"} `
  -Body '{"contents":[{"parts":[{"text":"你好"}]}]}'
```

---

## 第五步：在你的项目中使用

我会帮你修改项目代码，让它使用你的反代地址。

**你只需要告诉我你的 Worker 地址！**

---

## 常见问题

### Q: 部署后访问显示 404？
A: 等待 1-2 分钟，Cloudflare 需要时间部署到全球节点

### Q: 如何查看使用统计？
A: 访问 `https://你的地址.workers.dev/health`

### Q: 如何设置访问密码？
A: 编辑代码，找到这一行：
```javascript
const ACCESS_PASSWORD = '';
```
改成：
```javascript
const ACCESS_PASSWORD = 'your-password-123';
```
然后重新 Save and Deploy

### Q: Key 用完了怎么办？
A: Gemini 免费版每分钟 60 次请求，10 个 Key = 每分钟 600 次，够用了！

### Q: 如何添加更多 Key？
A: 编辑代码，在 `GEMINI_KEYS` 数组里添加新的 Key

---

## 下一步

**告诉我你的 Worker 地址，我帮你：**
1. ✅ 修改项目代码，集成反代
2. ✅ 测试是否正常工作
3. ✅ 优化配置

---

## 费用说明

- ✅ **完全免费**
- ✅ 每天 10 万次请求
- ✅ 无限流量
- ✅ 全球 CDN 加速

**你的 10 个 Key 现在变成了一个超强反代站！**
