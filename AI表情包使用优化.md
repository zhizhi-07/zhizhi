# AI 表情包使用优化 - 防止过度使用

## 🐛 问题描述

用户给 AI 发送表情包后，AI 就一直发表情包，不说话了。

## 🔍 问题原因

### 原因 1：提示词不够明确

**之前的提示词：**
```
【表情包使用规则】
• 表情包是可选的！只在合适的时候发送
• 大部分情况下直接发送文字即可
```

**问题：**
- "可选的"和"大部分情况"太模糊
- AI 可能理解为"经常可以用"
- 没有明确的使用频率限制
- 没有说明如何回应对方的表情包

### 原因 2：AI 学习模仿用户行为

- 用户发表情包 → AI 觉得这是正常交流方式
- AI 开始频繁使用表情包
- 形成"表情包对话"模式

## ✅ 优化方案

### 核心原则：文字为主，表情包为辅

**新的提示词规则：**

```
🔴 核心原则：文字为主，表情包为辅

• 90%的情况下只发文字，不要发表情包
• 只在特殊情况下使用表情包：
  ✓ 对方先发了表情包，你可以偶尔回一个
  ✓ 表达强烈情绪（非常开心、生气、无语等）
  ✓ 开玩笑、调侃的时候
• 连续3条消息中最多只能有1条带表情包
• 如果对方只发表情包不说话，你应该用文字回复询问，而不是也发表情包
```

## 📊 对比

### 优化前

**用户行为：**
```
用户: [表情包:哈哈哈]
```

**AI 可能的回复：**
```
AI: [表情包:笑哭]
AI: [表情包:点赞]
AI: [表情包:OK]
（一直发表情包）
```

### 优化后

**用户行为：**
```
用户: [表情包:哈哈哈]
```

**AI 正确的回复：**
```
AI: 怎么啦？笑什么呢
（用文字询问，而不是也发表情包）
```

或者：
```
AI: 哈哈哈，怎么突然发表情包
（偶尔回一个表情包，但要带文字）
```

## 🎯 使用场景

### ✅ 适合使用表情包的场景

1. **表达强烈情绪**
   ```
   用户: 我考试考了满分！
   AI: 哇！太厉害了！[表情包:点赞]
   ```

2. **开玩笑/调侃**
   ```
   用户: 你是不是偷懒了
   AI: 才没有呢 [表情包:无辜]
   ```

3. **回应对方的表情包（偶尔）**
   ```
   用户: [表情包:生气]
   AI: 怎么啦？生气了吗
   （注意：主要用文字，不是也发表情包）
   ```

### ❌ 不适合使用表情包的场景

1. **正常聊天**
   ```
   用户: 今天天气不错
   AI: 是啊，挺好的
   （不需要表情包）
   ```

2. **回答问题**
   ```
   用户: 你在干嘛
   AI: 在看书呢
   （不需要表情包）
   ```

3. **连续使用**
   ```
   AI: 好呀 [表情包:OK]
   AI: 没问题 [表情包:点赞]
   AI: 就这样 [表情包:握手]
   （❌ 错误！连续使用太多）
   ```

## 📝 使用频率控制

### 规则：连续3条消息中最多1条带表情包

**示例 1：正确**
```
AI: 好呀
AI: 我也想去
AI: 什么时候出发？[表情包:期待]
✅ 3条消息中只有1条带表情包
```

**示例 2：错误**
```
AI: 好呀 [表情包:OK]
AI: 我也想去 [表情包:开心]
AI: 什么时候出发？[表情包:期待]
❌ 3条消息都带表情包，太多了！
```

## 🔧 技术实现

### 提示词优化

```typescript
【表情包使用规则 - 重要！】

🔴 核心原则：文字为主，表情包为辅

• 90%的情况下只发文字，不要发表情包
• 只在特殊情况下使用表情包：
  ✓ 对方先发了表情包，你可以偶尔回一个
  ✓ 表达强烈情绪（非常开心、生气、无语等）
  ✓ 开玩笑、调侃的时候
• 连续3条消息中最多只能有1条带表情包
• 如果对方只发表情包不说话，你应该用文字回复询问，而不是也发表情包
```

### 关键改进点

1. **明确比例**：90% 只发文字
2. **列举场景**：什么时候可以用
3. **频率限制**：连续3条最多1条
4. **行为指导**：对方发表情包时应该怎么回应

## 💡 最佳实践

### AI 回复示例

**场景 1：用户发表情包**
```
用户: [表情包:哈哈哈]

✅ 好的回复：
AI: 怎么啦？笑什么呢

❌ 不好的回复：
AI: [表情包:笑哭]
```

**场景 2：表达开心**
```
用户: 我们去吃火锅吧

✅ 好的回复：
AI: 好呀！我超喜欢吃火锅 [表情包:开心]

❌ 不好的回复：
AI: [表情包:开心][表情包:点赞][表情包:OK]
```

**场景 3：正常聊天**
```
用户: 你在干嘛

✅ 好的回复：
AI: 在看书呢，你呢

❌ 不好的回复：
AI: 在看书呢 [表情包:书]
```

## 🎯 预期效果

### 优化后的 AI 行为

1. **主要用文字交流**
   - 90% 的回复只有文字
   - 表情包作为点缀，不是主要内容

2. **适度使用表情包**
   - 只在合适的时候使用
   - 不会连续发送多个表情包

3. **正确回应用户**
   - 用户发表情包时，用文字询问
   - 不会陷入"表情包对话"模式

4. **更自然的交流**
   - 像真人一样聊天
   - 表情包使用恰到好处

## 📊 测试场景

### 测试 1：用户发表情包
```
用户: [表情包:哈哈哈]
预期: AI 用文字回复，询问原因
实际: AI: "怎么啦？笑什么呢" ✅
```

### 测试 2：连续对话
```
用户: 今天天气不错
AI: 是啊，挺好的
用户: 要不要出去玩
AI: 好呀，去哪里
用户: 去公园吧
AI: 可以呀 [表情包:开心]
预期: 5条消息中只有1条带表情包 ✅
```

### 测试 3：表达情绪
```
用户: 我考试考了满分！
预期: AI 可以用表情包表达开心
实际: AI: "哇！太厉害了！[表情包:点赞]" ✅
```

## ✅ 总结

通过优化提示词，明确表情包使用规则：

1. ✅ **文字为主**：90% 只发文字
2. ✅ **频率控制**：连续3条最多1条带表情包
3. ✅ **场景限制**：只在特殊情况使用
4. ✅ **行为指导**：教 AI 如何正确回应

**结果：**
- AI 不会再一直发表情包
- 交流更自然，更像真人
- 表情包使用恰到好处

---

**优化时间**: 2025-10-19  
**问题类型**: AI 行为控制  
**解决方案**: 提示词优化
