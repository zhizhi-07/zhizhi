# 🚀 快速开始 - 后端功能

## ✨ 新功能一览

你的 AI 聊天应用现在支持：

1. **🌐 AI 联网搜索** - AI 可以搜索实时信息（天气、新闻等）
2. **☁️ 云端数据备份** - 聊天记录自动备份，永不丢失
3. **🤖 AI 主动发消息** - 定时问候、长时间未聊天自动关心
4. **🔔 浏览器推送通知** - 关闭网页也能收到消息

---

## 📝 最简部署步骤（5 分钟）

### 步骤 1：配置 Supabase（2 分钟）

1. 访问 https://supabase.com 并登录
2. 点击 "New Project"
3. 填写信息：
   - Name: `zhizhi-ai`
   - Database Password: 设置一个密码
   - Region: `Southeast Asia` 或 `Northeast Asia`
4. 等待项目创建完成
5. 点击 "SQL Editor" → "New query"
6. 复制粘贴以下代码并运行：

```sql
CREATE TABLE user_data (
  id BIGSERIAL PRIMARY KEY,
  user_id TEXT UNIQUE NOT NULL,
  data JSONB,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

CREATE INDEX idx_user_data_user_id ON user_data(user_id);
```

7. 点击 "Settings" → "API"，复制：
   - Project URL
   - anon public key

---

### 步骤 2：配置 Netlify（1 分钟）

1. 访问 https://app.netlify.com
2. 找到你的项目 `zhizhi-ai`
3. 点击 "Site settings" → "Environment variables"
4. 添加 3 个变量：

```
DEEPSEEK_API_KEY = 你的 DeepSeek API Key
SUPABASE_URL = 你的 Supabase Project URL
SUPABASE_KEY = 你的 Supabase anon public key
```

---

### 步骤 3：部署（2 分钟）

```bash
# 提交代码
git add .
git commit -m "添加后端功能"
git push

# Netlify 会自动部署，等待 2-3 分钟即可
```

---

## ✅ 验证部署

打开你的网站：https://zhizhi-ai.netlify.app

### 测试 1：联网搜索
发送消息："今天天气怎么样？"
→ AI 应该返回实时天气信息

### 测试 2：数据备份
1. 发送几条消息
2. 清除浏览器缓存
3. 刷新页面
4. 消息应该还在（已从云端恢复）

### 测试 3：推送通知
1. 点击右上角 "开启通知"
2. 允许通知权限
3. 最小化浏览器
4. 等待 AI 发消息（或触发新消息）
5. 应该收到桌面通知

---

## 🎯 使用技巧

### 1. 联网搜索示例

试试这些问题：
- "今天北京天气怎么样？"
- "最近有什么科技新闻？"
- "人民币对美元汇率是多少？"
- "今天是几号？星期几？"

### 2. 数据备份

- 数据每 5 秒自动备份一次
- 支持跨设备同步（使用相同浏览器指纹）
- 清除缓存也不怕，数据在云端

### 3. AI 主动消息

- 每天早上 8:00 发早安
- 每天晚上 22:00 发晚安
- 3 天不聊天会主动问候

### 4. 推送通知

- 关闭网页也能收到通知
- 点击通知直接打开聊天
- 可以随时在浏览器设置中关闭

---

## 🆓 完全免费

所有功能都在免费额度内：

| 服务 | 免费额度 | 个人使用 |
|------|---------|---------|
| Netlify Functions | 125,000 次/月 | ✅ 完全够用 |
| Supabase 存储 | 500 MB | ✅ 完全够用 |
| DeepSeek API | 按量付费 | ✅ 很便宜 |

**预计每月成本：0-5 元**

---

## ❓ 常见问题

### Q: 定时任务不工作？
A: Netlify 免费版的定时任务可能不稳定，如需稳定使用建议升级 Pro 版（$19/月）

### Q: 数据会丢失吗？
A: 不会！数据同时保存在本地和云端，双重保障

### Q: 可以关闭某些功能吗？
A: 可以！所有功能都是可选的，不影响基础使用

### Q: 如何查看后端日志？
A: Netlify → Functions → Logs

### Q: 如何回退到纯前端版本？
A: 删除 `netlify/functions` 目录，重新部署即可

---

## 🎉 完成！

现在你拥有一个功能完整的智能 AI 助手：
- ✅ 能联网搜索实时信息
- ✅ 数据永不丢失
- ✅ AI 会主动关心你
- ✅ 随时随地收到通知

**开始享受吧！** 🚀

---

## 📚 更多文档

- `后端部署说明.md` - 详细部署步骤
- `后端功能集成指南.md` - 代码集成说明
- `README.md` - 项目总体说明

有问题随时问我！😊
