# 部署配置备份

**备份时间**: 2025-10-19 17:37

## 当前配置文件

### 1. vercel.json
```json
{
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "framework": "vite",
  "rewrites": [
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ]
}
```

### 2. package.json
```json
{
  "name": "wechat-ui-clone",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-router-dom": "^6.20.0"
  },
  "devDependencies": {
    "@types/react": "^18.2.43",
    "@types/react-dom": "^18.2.17",
    "@vitejs/plugin-react": "^4.2.1",
    "autoprefixer": "^10.4.16",
    "postcss": "^8.4.32",
    "tailwindcss": "^3.3.6",
    "typescript": "^5.2.2",
    "vite": "^5.0.8"
  }
}
```

### 3. vite.config.ts
```typescript
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  server: {
    port: 3000,
    host: true
  }
})
```

## 部署已知问题

### Vercel 部署问题
1. **路由问题**: 需要配置 rewrites 确保 SPA 路由正常工作
2. **构建命令**: 使用 `tsc && vite build`
3. **输出目录**: `dist`

### Netlify 部署问题
1. **需要 netlify.toml 配置文件**
2. **需要配置重定向规则**

## 建议的 Netlify 配置

如果要使用 Netlify 部署，创建 `netlify.toml`:

```toml
[build]
  command = "npm run build"
  publish = "dist"

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
```

## 部署前检查清单

- [ ] 确保 `npm install` 成功
- [ ] 确保 `npm run build` 本地构建成功
- [ ] 检查 dist 目录是否生成
- [ ] 确认所有依赖都在 package.json 中
- [ ] 确认没有使用本地文件路径（如图片）
- [ ] 确认 localStorage 使用正常
- [ ] 测试所有路由是否正常

## 常见部署错误

### 1. 构建失败
- 检查 TypeScript 类型错误
- 检查导入路径是否正确
- 检查是否有未安装的依赖

### 2. 路由 404
- 确保配置了 rewrites/redirects
- 检查 React Router 配置

### 3. 静态资源加载失败
- 检查资源路径是否使用相对路径
- 确保资源在 public 或 src/assets 目录

## 回滚方法

如果部署出现问题：
1. 使用 Git 回滚: `git reset --hard HEAD~1`
2. 恢复此备份文件中的配置
3. 重新构建: `npm run build`
4. 本地测试: `npm run preview`
