# 拉黑功能 - 完整实现步骤

## 目标
实现拉黑功能，当用户拉黑AI后，AI发送的消息左侧显示警告图标⚠️

## 实现步骤

### 第1步：确认基础设施已就绪 ✅
- [x] `blacklistManager` 工具已创建
- [x] `Message` 接口已添加 `blocked` 字段
- [x] `ChatSettings` 页面已添加拉黑开关

### 第2步：在AI发送消息时标记blocked状态
**文件**: `src/pages/ChatDetail.tsx`

需要修改的位置：所有创建AI消息的地方，添加 `blocked: isAiBlocked` 字段

已完成的消息类型：
- [x] 文本消息（单行）
- [x] 文本消息（多行）
- [x] 表情包消息
- [x] 语音消息
- [x] 位置消息
- [x] 照片消息
- [x] 红包消息
- [x] 转账消息
- [x] 亲密付消息

### 第3步：在MessageItem组件中显示警告图标
**文件**: `src/components/MessageItem.tsx`

需要做的事情：
1. 导入 `blacklistManager`
2. 添加检查函数（只检查消息的blocked字段，简单直接）
3. 在AI消息左侧显示警告图标

## 关键原则

1. **简单优先**：只检查消息的 `blocked` 字段，不做复杂的实时检查
2. **最小修改**：只修改必要的代码，不影响其他功能
3. **清晰明确**：每个修改都有明确的目的和注释

## 下一步行动

现在开始第3步：在MessageItem组件中显示警告图标
