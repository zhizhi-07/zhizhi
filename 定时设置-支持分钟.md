# ⏰ 定时设置 - 支持精确到分钟

## ✨ 更新内容

现在定时设置支持**精确到分钟**了！

---

## 🎯 可以设置的格式

### 之前
```
早安：8:00  ← 只能设置整点
晚安：22:00
```

### 现在
```
早安：8:30  ← 可以设置任意分钟
晚安：22:15
午间：12:45
想念：10:20
```

---

## 📱 界面示例

```
┌─────────────────────────────────┐
│  ⏰ AI 定时消息设置        ×   │
├─────────────────────────────────┤
│                                 │
│  ☑ 🌅 早安问候                 │
│     每天 [8]:[30] 发送          │
│          ↑   ↑                  │
│        小时 分钟                │
│                                 │
│  ☑ 🍱 午间问候                 │
│     每天 [12]:[15] 发送         │
│                                 │
│  ☑ 🌙 晚安问候                 │
│     每天 [22]:[45] 发送         │
│                                 │
│  ☑ 💭 想念提醒                 │
│     [3] 天未聊天时提醒          │
│     在 [10]:[20] 发送           │
│                                 │
│  [重置默认]  [保存设置]         │
└─────────────────────────────────┘
```

---

## ⚙️ 输入范围

- **小时**：0-23
- **分钟**：0-59

---

## 💡 使用示例

### 示例 1：早起的人
```
早安：6:30  ← 早上 6 点 30 分
晚安：21:00 ← 晚上 9 点整
```

### 示例 2：上班族
```
早安：7:45  ← 起床时间
午间：12:30 ← 午休时间
晚安：23:15 ← 睡前时间
```

### 示例 3：夜猫子
```
早安：9:00  ← 睡到自然醒
晚安：1:30  ← 凌晨 1 点 30（输入 1:30）
```

### 示例 4：精确提醒
```
想念：3 天，10:25  ← 3 天未聊天，早上 10:25 提醒
```

---

## 🔧 技术实现

### 前端
- 两个输入框：小时 + 分钟
- 小时范围：0-23
- 分钟范围：0-59

### 后端
- 定时任务每分钟检查一次
- 精确匹配小时和分钟
- 只在完全匹配时发送消息

### 数据格式
```json
{
  "morningEnabled": true,
  "morningHour": 8,
  "morningMinute": 30,
  "nightEnabled": true,
  "nightHour": 22,
  "nightMinute": 15
}
```

---

## ⚠️ 注意事项

### 1. 定时任务频率
- Netlify 定时任务最快每分钟运行一次
- 需要在 `netlify.toml` 中设置：
  ```toml
  schedule = "* * * * *"  # 每分钟运行
  ```

### 2. 免费版限制
- Netlify 免费版可能不支持每分钟运行
- 建议设置为每 5 分钟或每小时
- 或升级到 Pro 版

### 3. 时区问题
- 时间基于服务器时区（通常是 UTC）
- 如果时间不准，需要调整时区设置

---

## 🚀 部署步骤

### 1. 更新 netlify.toml
```toml
# 如果要精确到分钟，改成每分钟运行
[[functions]]
  path = "/scheduled-messages"
  schedule = "* * * * *"  # 每分钟

# 或者每 5 分钟运行（更稳定）
[[functions]]
  path = "/scheduled-messages"
  schedule = "*/5 * * * *"  # 每 5 分钟
```

### 2. 提交代码
```bash
git add .
git commit -m "支持定时设置精确到分钟"
git push
```

### 3. 测试
1. 设置一个 2 分钟后的时间
2. 等待定时任务运行
3. 检查是否收到消息

---

## 📊 Cron 表达式说明

```
* * * * *
│ │ │ │ │
│ │ │ │ └─ 星期 (0-7)
│ │ │ └─── 月份 (1-12)
│ │ └───── 日期 (1-31)
│ └─────── 小时 (0-23)
└───────── 分钟 (0-59)
```

**常用配置：**
- `* * * * *` - 每分钟
- `*/5 * * * *` - 每 5 分钟
- `*/10 * * * *` - 每 10 分钟
- `0 * * * *` - 每小时（整点）

---

## 🎉 完成！

现在你可以：
- ✅ 设置精确到分钟的定时消息
- ✅ 比如 8:30、12:15、22:45
- ✅ 更灵活的时间安排
- ✅ 完全自定义

**享受更精确的定时功能吧！** 🚀
