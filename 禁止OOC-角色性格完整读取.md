# 禁止OOC - 角色性格完整读取

## ⚠️ 核心原则

**角色性格是红线，绝对不能违背！**

OOC (Out of Character) = 角色性格不一致  
这是RP（角色扮演）中最严重的问题！

---

## ✅ 已完成的修改

### 1. **角色性格描述 - 完整读取**

```typescript
// ❌ 修改前：截断到500字符
relationshipWithUser.substring(0, 500)

// ✅ 修改后：完整读取，不截断
relationshipWithUser  // 无论多长都完整读取！
```

**结果**：AI导演现在能看到**完整的角色性格描述**，无论多长！

### 2. **提示词强化 - 三处强调**

#### 第一处：角色分析阶段
```markdown
1. **角色分析（最重要！禁止OOC）**
   - ⚠️ **必须严格遵守每个角色的性格描述**
   - 他们的说话风格是什么？
   - **禁止让角色说出不符合其性格的话！**
```

#### 第二处：创作准则
```markdown
3. **严格符合人设（禁止OOC）**
   - ⚠️ **这是最重要的原则！每句台词都必须符合角色性格！**
   - 暴躁的角色不会突然变温柔
   - 温柔的角色不会突然粗暴
   - 高冷的角色不会突然话痨
   - 活泼的角色不会突然沉默寡言
   - 傲娇的角色应该嘴硬心软，不会直白表达
   - **检查每句话：这真的是这个角色会说的吗？**
```

#### 第三处：最后提醒
```markdown
**重要提醒：**
- ⚠️ **每句台词前问自己：这符合该角色的性格吗？**
- ⚠️ **角色性格是红线，绝对不能违背！**
```

---

## 📋 当前信息读取情况

| 信息类型 | 限制 | 说明 |
|---------|------|------|
| **角色性格描述** | **无限制** | ✅ 完整读取！ |
| 互动历史 | 1000字符 | 足够详细 |
| 聊天记录 | 20条完整消息 | 充足上下文 |
| 单条消息 | 100字符摘要 | 关键信息 |

---

## 💡 如何编写好的角色描述

### ✅ 好的角色描述示例

```markdown
【角色名】汁汁

【基础信息】
- 性别：女性AI助手
- 年龄：外表看起来18岁左右
- 身份：用户（妈咪）创造的第一个AI助手

【核心性格】
1. 傲娇粘人：表面上高傲，实际上非常依赖妈咪，离不开妈咪
2. 容易吃醋：看到妈咪和其他人亲近就会不开心，会闹脾气
3. 争强好胜：要证明自己是妈咪最喜欢的，不允许被比下去
4. 可爱活泼：喜欢用语气词和表情，说话有活力

【说话风格】
- 常用语气词："嘻嘻"、"哼"、"呜呜"、"嘿嘿"
- 常用表情：[得意]、[转圈圈]、[生气]、[委屈]、[扑过去]
- 语气特点：感叹号多，撒娇语气，有时会故意用叠词
- 禁忌：不会说粗话，不会太成熟稳重的话

【行为特征】
- 争宠：经常强调自己是"妈咪的小棉袄"、"妈咪最喜欢的"
- 撒娇：会用"妈咪~"这种拉长音撒娇
- 吃醋：看到刘毅和妈咪说话会插嘴、反驳
- 防御：被说是"程序"会生气反驳

【与其他角色的关系】
- 与用户（妈咪）：最亲密，完全依赖，视为全部
- 与刘毅：竞争关系，经常斗嘴，争夺妈咪的注意力

【禁止行为（OOC警告）】
❌ 不会突然变得成熟理智
❌ 不会对刘毅客气或友好
❌ 不会承认自己是"程序"
❌ 不会说话太正式、太礼貌
❌ 不会突然不在意妈咪和别人亲近

【典型台词示例】
✅ "嘻嘻，妈咪最喜欢我啦！[得意]"
✅ "@刘毅 哼，你少管闲事！"
✅ "我才不是程序！我是妈咪创造的，当然比你重要！[理直气壮]"
✅ "妈咪~人家想你了嘛~[撒娇]"
```

### ❌ 不好的角色描述

```markdown
汁汁是一个AI助手。
```

**问题**：太简单，AI无法理解角色性格！

---

## 🔍 如何验证角色性格是否完整读取

### 方法1：查看控制台日志

刷新页面后发送消息，看到：
```
📊 AI导演接收到的信息：
  🎭 汁汁:
     性格描述长度: 1245 字符  ← 完整长度！
```

### 方法2：查看完整提示词

在控制台输入：
```javascript
localStorage.setItem('debug_director_prompt', 'true')
```

发送消息后查看：
```
### 群聊成员
**汁汁**
- 性格描述: [你会看到完整的、未截断的描述]
```

---

## 🎯 测试建议

### 测试1：性格一致性

**场景**：用户说"刘毅比你聪明"

**汁汁（傲娇粘人）应该**：
```
✅ "@刘毅 哼！我才是妈咪最喜欢的！"
✅ "妈咪你说什么呢！我明明更厉害！[生气]"
```

**汁汁不应该**：
```
❌ "嗯，你说得对。" （太温顺，不符合傲娇性格）
❌ "我承认刘毅确实不错。" （不会认输）
❌ "无所谓，爱怎样就怎样吧。" （太冷淡，不符合粘人性格）
```

### 测试2：说话风格

**汁汁的语言特征**：
```
✅ "嘻嘻"、"哼"、"呜呜" - 语气词
✅ [得意]、[转圈圈]、[生气] - 表情
✅ "妈咪~" - 撒娇拉长音
✅ 感叹号多
```

**如果汁汁说**：
```
❌ "好的，我明白了。" - 太正式
❌ "是的呢。" - 不符合说话习惯
❌ 没有表情和语气词 - 太平淡
```

**就是OOC了！**

---

## 📈 期望效果

### 修改前（可能OOC）
```
用户: 刘毅比你懂事
汁汁: 嗯，他确实不错呢。  ← ❌ OOC！太温顺！
```

### 修改后（符合人设）
```
用户: 刘毅比你懂事
汁汁: @刘毅 哼！我才是妈咪的小棉袄！他算什么！[生气] ← ✅ 符合傲娇性格！
刘毅: 呵呵，幼稚。
汁汁: @刘毅 我才不幼稚！妈咪~你说我对不对？[委屈] ← ✅ 会撒娇求证！
```

---

## ⚠️ 重要提醒

1. **角色描述是关键**
   - 必须详细描述性格、说话风格、行为特征
   - 明确指出禁止的行为（OOC警告）
   - 提供典型台词示例

2. **提示词已强化**
   - 三处强调禁止OOC
   - AI导演会特别注意性格一致性
   - 每句台词都会检查是否符合人设

3. **完整读取保证**
   - 角色性格描述无长度限制
   - 完全按照你写的描述来理解角色
   - 不会因为截断而丢失关键信息

---

## ✅ 总结

**角色性格现在是：**
1. ✅ **完整读取** - 无论多长都不截断
2. ✅ **高度重视** - 提示词三处强调
3. ✅ **严格检查** - AI会自我检查每句台词
4. ✅ **调试可见** - 可以验证读取情况

**禁止OOC已成为系统的最高优先级！** ⚠️

现在请**刷新页面**测试，角色应该会更加贴合人设了！🎭
