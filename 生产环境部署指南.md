# 🚀 生产环境部署指南

## ✅ 你已经完成的准备工作

1. **Cloudflare Worker 已部署**
   - URL: `https://zhizhi-api.2373922440jhj.workers.dev`
   - 功能：音乐搜索、播放、歌词、AI代理、图片代理
   - 状态：✅ 正常运行

2. **前端代码已更新**
   - 生产环境会自动使用 Worker
   - `.env` 文件已配置 Worker URL
   - 代码已推送到 GitHub

3. **本地构建已完成**
   - `dist` 文件夹已生成
   - 生产版本已编译完成

---

## 📦 方案1：Vercel 部署（推荐）

### 步骤1：在网页部署（最简单）

1. **访问** https://vercel.com
2. **登录** 你的账号
3. **点击 "Add New..." → "Project"**
4. **导入 GitHub 仓库** `zhizhi`
5. **配置环境变量**：
   ```
   VITE_WORKER_URL = https://zhizhi-api.2373922440jhj.workers.dev
   ```
6. **点击 Deploy**

✅ 完成！几分钟后就能访问了

---

### 步骤2：命令行部署（备选）

如果网页部署失败，用命令行：

```bash
# 1. 登录（已完成）
npx vercel login

# 2. 部署（会自动读取 vercel.json 配置）
npx vercel --prod

# 3. 按提示操作
# - Set up and deploy? Yes
# - Which scope? 选择你的账号
# - Link to existing project? 选择 zhizhi 或创建新的
# - 等待部署完成
```

部署成功后会显示类似：
```
✅ Production: https://zhizhi-xxx.vercel.app
```

---

## 📦 方案2：Netlify 部署

1. **访问** https://app.netlify.com
2. **拖拽 `dist` 文件夹** 到部署区域
3. **或连接 GitHub 自动部署**
4. **设置环境变量**：
   - `VITE_WORKER_URL` = `https://zhizhi-api.2373922440jhj.workers.dev`

---

## 📦 方案3：GitHub Pages 部署

```bash
# 1. 安装 gh-pages
npm install -D gh-pages

# 2. 在 package.json 添加脚本
"scripts": {
  "deploy": "gh-pages -d dist"
}

# 3. 构建并部署
npm run build
npm run deploy
```

然后在 GitHub 仓库设置中启用 GitHub Pages。

---

## 🔧 重要：环境变量配置

**无论用哪个平台，都要设置这个环境变量：**

```
VITE_WORKER_URL = https://zhizhi-api.2373922440jhj.workers.dev
```

### Vercel 设置环境变量：
1. 进入项目设置
2. 点击 "Environment Variables"
3. 添加 `VITE_WORKER_URL`
4. 重新部署

### Netlify 设置环境变量：
1. 进入 Site settings
2. Build & deploy → Environment
3. 添加环境变量

---

## 🎵 部署后测试

部署成功后，打开你的网站：

1. **进入音乐搜索页面**
2. **搜索"周杰伦"**
3. **应该能看到真实的音乐列表**

如果能搜索到音乐，说明部署成功！✅

---

## 🐛 常见问题

### Q: 部署后音乐搜索失败？
A: 检查环境变量 `VITE_WORKER_URL` 是否设置正确

### Q: Worker URL 是什么？
A: `https://zhizhi-api.2373922440jhj.workers.dev`（已经部署好了）

### Q: 需要重新构建吗？
A: 如果修改了代码，需要重新 `npm run build`

### Q: Vercel 命令行部署失败？
A: 用网页部署更简单，直接在 vercel.com 导入 GitHub 仓库

---

## 📝 提交最新代码

在部署前，先提交你的更改：

```bash
git add -A
git commit -m "🚀 准备生产环境部署"
git push
```

---

## 🎯 推荐部署方案

**最简单：Vercel 网页部署**
1. 访问 https://vercel.com
2. 导入 GitHub 仓库
3. 添加环境变量
4. 点击部署
5. 完成！

**优势：**
- ✅ 自动 HTTPS
- ✅ 全球 CDN
- ✅ 自动部署（每次 push 都自动更新）
- ✅ 完全免费

---

**祝部署顺利！** 🎉

有问题随时问我！
