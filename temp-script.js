const _0x3880a7=_0x55b8;(function(_0x1b0a3a,_0xb08888){const _0x2c4477=_0x55b8,_0x123cac=_0x1b0a3a();while(!![]){try{const _0x37512c=-parseInt(_0x2c4477(0x364))/0x1*(parseInt(_0x2c4477(0x5fd))/0x2)+-parseInt(_0x2c4477(0x12ec))/0x3*(parseInt(_0x2c4477(0x1034))/0x4)+-parseInt(_0x2c4477(0x1fe))/0x5*(parseInt(_0x2c4477(0xf54))/0x6)+parseInt(_0x2c4477(0xef4))/0x7+-parseInt(_0x2c4477(0x436))/0x8*(-parseInt(_0x2c4477(0xe09))/0x9)+parseInt(_0x2c4477(0x6ae))/0xa*(-parseInt(_0x2c4477(0x10e5))/0xb)+parseInt(_0x2c4477(0x12b0))/0xc;if(_0x37512c===_0xb08888)break;else _0x123cac['push'](_0x123cac['shift']());}catch(_0x304565){_0x123cac['push'](_0x123cac['shift']());}}}(_0x3cdb,0xd49bc));_0x3880a7(0xd8c)in navigator&&window['addEventListener']('load',()=>{const _0x12b811=_0x3880a7;navigator[_0x12b811(0xd8c)][_0x12b811(0x4d1)](_0x12b811(0xabc))[_0x12b811(0x299)](_0x4efdd1=>{const _0x984ed0=_0x12b811;console[_0x984ed0(0x1081)](_0x984ed0(0x7e5),_0x4efdd1[_0x984ed0(0xf26)]);})[_0x12b811(0x9cb)](_0x3238cf=>{console['log']('ServiceWorker\x20注册失败:\x20',_0x3238cf);});});!Array['prototype']['findLastIndex']&&Object[_0x3880a7(0xc21)](Array[_0x3880a7(0x3db)],'findLastIndex',{'value':function(_0x32eca2){const _0x19b386=_0x3880a7;if(this==null)throw new TypeError(_0x19b386(0x850));if(typeof _0x32eca2!=='function')throw new TypeError(_0x19b386(0xa25));let _0x3b182c=Object(this),_0xb2ccf1=_0x3b182c[_0x19b386(0x29d)]>>>0x0,_0x5e3175=arguments[0x1],_0x2a25be=_0xb2ccf1-0x1;while(_0x2a25be>=0x0){let _0x375f3c=_0x3b182c[_0x2a25be];if(_0x32eca2['call'](_0x5e3175,_0x375f3c,_0x2a25be,_0x3b182c))return _0x2a25be;_0x2a25be--;}return-0x1;},'configurable':!![],'writable':!![]});function _0x3cdb(){const _0x12da47=['theme','https://i.postimg.cc/G3y73Fj2/IMG-6563.gif','#music-lyrics-container\x20#music-lyrics-list','\x0a##\x20---\x20来自','single','AI\x20(','正在重试\x22','novelai-settings-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-icon\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-title\x22>','）。]','character-select-item','findLast','”\x20来指代你的聊天对象（用户）。\x0a6.\x20\x20**【日记专属Markdown语法\x20(必须使用！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇\x20(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','doubanActiveCharacterIds','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','AI返回的内容中未找到有效的JSON对象。','.lyric-line','bg-input','increase-qty-btn','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participant-name\x22>','qzone-sticker-panel','https://i.postimg.cc/DZ541sbt/IMG-7280.jpg','manage-preset-categories-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20','poll-option-input-wrapper','22068048lDSCcb','copy-post-btn','这将提取当前通话记录发送给AI进行总结，会消耗API额度。确定要继续吗？','blockReason','**\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要\x20(这是你们通话的原因，至关重要！)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','toLowerCase','select-message-btn','message-wrapper\x20','favorite-diary-btn','cancel-shopping-settings-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<div\x20class=\x22post-images-grid\x20grid-','groupNickname','musicLibrary','.format-btn','choices','\x22>--天--时--分--秒</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-date\x22>目标时间:\x20','select-all-chars-for-clear','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录结束]\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','请先在API设置中配置好（主或副）API。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x206px\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','shuoshuo','werewolf-role-description','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-cover\x22\x20style=\x22background-image:\x20url(','currentText','https://i.postimg.cc/QMDsSNxg/IMG-6861.gif','\x0a---\x20复盘结束\x20---','”请求添加你为好友：<br><i>“','reset-theme-btn','<div\x20class=\x22poll-options-list\x22>','所有歌曲链接均有效，无需清理！','收藏成功！','preview-bubble-style','https://i.postimg.cc/rF4KYbjj/IMG-5720.gif','\x0a[图片生成失败:\x20','status','确认精炼','100%','正在为角色“','”回忆TA的相册照片...','transfer-cancel-btn','++id,\x20chatId,\x20timestamp,\x20type,\x20targetDate','错误：找不到该成员的个人档案。','announcements','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','textAlign','\x20(用户)\x20或其他AI的发言，必须对他们的观点和逻辑做出回应。\x0a2.\x20\x20**记忆力与连贯性**:\x20你的新发言【必须】是基于**过去几天和今天发生的所有事件和讨论**的逻辑延续。\x0a\x0a//\x20【核心修改2】明确了JSON格式中\x20speaker_name\x20和对话中称呼的不同要求\x0a3.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式为:\x20`{\x22speaker_name\x22:\x20\x22角色的【昵称】\x22,\x20\x22dialogue\x22:\x20\x22发言内容\x22}`。**必须**为每一个存活的AI角色都生成一段发言。\x0a4.\x20\x20**称呼铁律**:\x20你的发言中【绝对禁止】提及任何玩家的编号。在对话中互相称呼时，你【必须】使用玩家的【本名】，而不是他们的昵称。\x0a\x0a#\x20','calls','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少3-8条，且条数不要总是一样。严禁发展线下剧情。\x0a2.\x20\x20**情景感知**:\x0a\x20\x20\x20\x20-\x20**时间**:\x20你必须感知到当前是\x20','</p>','decision','创建普通群聊\x20(我参与)','bulkDelete','\x22\x20placeholder=\x22','\x20被投票放逐。','https://i.postimg.cc/8PsK20jQ/IMG-7236.gif','browser-title','switchToMyPhone','设置群名','117OhMLKQ','nameHistory','对方已收款','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x208px;\x20flex-shrink:\x200;\x20margin-left:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20edit-memory-btn\x22\x20data-author-id=\x22','退款来自\x20','#sticker-binding-chat-list\x20.sticker-binding-checkbox:checked','onclick','确定要恢复默认设置吗？','cancel-douban-cast-btn','无法访问剪贴板。','equals','15px','char-music-prev-btn','<p><strong>','确定要删除这张照片吗？此操作不可恢复。','music-exit-btn','网络请求失败:\x20','-\x20(头像库是空的，无法更换头像)','doubanMaxPosts','件商品','.upload-variation-image-btn','pat-btn','add-my-avatar-upload-btn','myNickname','\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片','---\x20第\x20','gift-recipient-list','anno_','renderWorldBookScreenProxy','未找到相关收藏','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','名为\x20“','\x0a#\x20【【【群公告\x20(最高优先级规则)】】】\x0a你【必须】阅读、理解并严格遵守以下所有公告，它们凌驾于你的人设之上。\x0a','cancel-ai-response-editor-btn','char_browser_article','delete-selected-frames-btn','\x0a-\x20散记:\x20','time','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','网络图片\x20(EPhone)','.sender','<span\x20class=\x22group-name\x22>','「在这里输入对话内容」\x5cn(在这里输入动作或环境描写)','<div\x20class=\x22source\x22>','https://i.postimg.cc/L5RLr3tg/mmexport1751035976943.gif','\x22><div\x20class=\x22poll-option-bar\x22\x20style=\x22width:\x20','global','大小:','element','<div\x20class=\x22avatar-group\x20','undefined','）完成了支付。此订单已关闭，其他成员不能再支付。]','character_book','\x20的动态\x20','\x20张本地图片<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20成功压缩\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','regenerate-char-usage-btn','newSize','safetyRatings','memberId','</memory>\x0a\x20\x20<recent_dialogue_with_user>','用户已忽略版本:\x20','appearance-preset-select','++id,\x20name,\x20chatId','opened','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22cart-item-checkbox\x22\x20data-id=\x22','正在请求AI进行手动总结...','update-notice-dismiss-btn','在角色\x20\x22','splice','margin','relationship','rule-editor-modal','.png','拼手气红包','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22waimai-details-btn\x22>查看订单详情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','#delete-world-books-list\x20.clear-posts-item.selected','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','...]','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22participants-names\x22>与\x20','blocked_by_user','appendChild','qzone-post-container','chat-header-title-wrapper','slice','rule-card\x20','charging','api-temperature-value','”才能使用\x20\x27open_red_packet\x27\x20指令领取。]','toCollection','\x22\x20(ID:\x20','等待回应','\x22]\x20.avatar','manage-sticker-categories-btn','\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>正在计算...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22>--</span>\x0a\x20\x20\x20\x20','recipients',')\x20领取了最后一个红包。红包已被领完，手气王是\x20','add-sticker-batch-btn','删除成功','keys','transfer-sender-name','📁\x20从本地上传','#avatar-frame-modal\x20.modal-body','regenerate-char-memo-btn','请先在API设置中配置好（主或副）API以进行总结。','add-song-url-btn','-\x20用户在你们共同所在的群聊中的昵称如下：\x0a','werewolf-game-over-reason','<textarea\x20id=\x22','memories-list','修复了角色\x20\x22','group-name','image/','assign-group-select','remove-member-btn','\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','reading-library-search-input','https://i.postimg.cc/CLz0cJ0d/IMG-7116.gif','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','已成功批量导入\x20','data-clear-char-list','文件格式不支持。请选择\x20.json\x20格式的\x20Tavern\x20预设文件。','编辑人设预设','message-editor-block\x20variation-block','豆瓣小组','add-char-diary-btn','用户(',')。操作已被拦截。','已同步角色\x20','.world-book-category-pane','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有可以拉进群的联系人哦~</p>','2-digit','is-link-share','最近\x2050\x20条','<tr><td\x20class=\x22item-name\x22>','\x20元</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x0a#\x20群成员列表、人设及社交背景\x20(至关重要！)\x0a你【必须】根据每个角色的社交背景来决定他们的互动方式。\x0a','\x20为你切歌:\x20《','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','请根据以上设定开始你的决策。','sourceChatName','frame_cat_ear','https://i.postimg.cc/cHsTXDVz/IMG-7235.gif','未检测到BOM，尝试使用\x20UTF-8\x20解码...','https://i.postimg.cc/ZqjKXPSv/IMG-7025.gif','lyrics-btn','\x20首歌曲的详细信息...','var-','pending_user_approval','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20#8a8a8a;\x20margin:\x200\x200\x2010px\x200;\x22>账户余额</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2032px;\x20font-weight:\x20600;\x20color:\x20#1f1f1f;\x20margin:\x200;\x22>¥','originalType','save-ai-response-editor-btn','bulkAdd','global-css-input','typeId','shared-history-viewer-content','recalledData','https://i.postimg.cc/DZgMwc1H/817178fdbpf2ff7740dc98e26ab78759.gif','已被用户删除','nai-diffusion-4','Http_Get_External','高德地图','event_type','语音生成失败','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','collapsed','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你被对方拉黑了。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22apply-friend-btn\x22\x20class=\x22lock-action-btn\x22>重新申请加为好友</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.contact-picker-item','https://i.postimg.cc/GhR6DT4Q/IMG-4428.gif','找不到原始消息。可能已被删除或位于更早的历史记录中。','AI生成的图片','回复\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','https://i.postimg.cc/RFK3q2t0/IMG-4407.gif','querySelector','[收到一个外卖代付请求]','listen-together-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','请根据以上设定，生成商品数据。','\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27','share-location-btn','请输入书名','delete-selected-stickers-btn','\x20个商品吗？此操作不可恢复。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22douban-cast-checkbox\x22\x20data-chat-id=\x22','确认清空动态？','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20作为参考，这是你们之前的最后一段聊天记录：\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20class=\x22sticker-image\x22\x20style=\x22max-width:\x2080px;\x20max-height:\x2080px;\x22>','¥\x200.00','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20flex-start;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22\x20style=\x22padding:\x200;\x20flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20新增：显示记忆来源\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8em;\x20color:\x20#999;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x20','delete-world-books-btn','https://i.postimg.cc/nrJSqNhz/IMG-4432.gif','-speech','add-new-sticker-category-btn','npc-editor-modal','transfer-action-cancel','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>还没有创建任何世界书</p>','copy-message-btn','https://i.postimg.cc/fLDnz5Pn/IMG-5574.gif','修复完成！','readAsDataURL',';\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20left;\x20text-decoration:\x20','presets','https://i.postimg.cc/SNByPrf9/IMG-7005.gif','https://i.postimg.cc/tTWKKmTN/IMG-7073.gif','lyrics-offset-input','trim','\x0a#\x20世界观设定\x20(必须参考)\x0a','activeChatId','music-lyrics-list','edit-message-btn','photo-viewer-close-btn','删除约定','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','douban-comment-input','\x22\x20的独立行动失败:','https://i.postimg.cc/43PhvxRq/IMG-6922.gif','charId','product-description-input','group_call_request','transfer-action-decline','heartfeltVoice','frame_7','https://i.postimg.cc/T2yKJ0DV/40.jpg','productInfo','</div><div\x20class=\x22gift-footer\x22>共','currentTime','totalElapsedTime','字体URL不能为空！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-confirm\x22\x20class=\x22confirm-btn\x22>确定</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','[表情:\x20\x27','用户向你发送了一张图片',':</strong>\x20','#linked-chats-checkboxes-container\x20input:checked','variation-product-image','spectator-edit-btn','open-reading-library-btn','#post-public-text','primaryKeys','totalPages','removeItem','添加头像','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分组</p>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“','[系统提示：你拒绝并退还了“','\x22\x20class=\x22chat-image\x22>','\x22,\x20\x22content\x22:\x20\x22我在群里说的话\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员1\x22,\x20\x22content\x22:\x20\x22成员1回复我\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员2\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a#\x20角色与上下文\x0a-\x20**你的角色设定**:\x20','\x0a\x0a#\x20对话者的角色设定\x0a','正在请求网易云音乐API:','create-post-btn','split','已成功从\x20Tavern\x20AI\x20文件导入设定集《','password','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20authorName\x20或\x20commenter\x20字段为\x20“','https://i.postimg.cc/59Cn1tkB/IMG-4401.gif','\x20(用户)**:\x20','\x22\x0a-\x20**用户的备注**:\x20\x22','group-avatar-library-modal','\x20回复了你。','确定要删除这个约定吗？','命名头像','werewolf-log','remove-bg-btn','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20天\x20---','ai-response-editor-container','https://i.postimg.cc/pXj9h20L/IMG-7275.jpg','font-settings-screen','timeZone','photos-grid-page','\x0a\x0a#\x20统一世界观设定\x20(以下设定适用于所有参与角色)\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22force-apply-check-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20style=\x22margin-top:\x2010px;\x22>强制触发一次好友申请检测</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','cphone-wallpaper-preview','\x22，并与用户进行面对面的互动。你的任务是创作一段包含角色动作、神态、心理活动和对话的、连贯的叙事片段。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20你必须严格遵守\x20','\x22\x20placeholder=\x22例如:\x20key1,\x20key2\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20这里是全新的、带有“展开/收起”按钮的结构\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x20display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>内容\x20(点击右侧展开)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22toggle-content-btn\x22>展开</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22entry-content-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x228\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','isUserParticipating','reply-preview-bar','\x20\x20-\x20你评论说:\x20','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20系统心跳计时器:\x20','📋\x20直接粘贴歌词文本','你现在在哪里呀？','4.\x20\x20**情景感知**:\x20你的对话【必须】自然地体现出对当前时间\x20(','\x20中聊天','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20当前角色状态:\x20<strong>','未知书籍','#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a','placeholder','identifier','vertical','timeupdate','\x0a#\x20你的角色设定：\x0a你必须严格遵守','正在发牌...','files','douban-wait-reply-btn','-\x20**对话状态**:\x20你的上一条消息发送于\x20','bg-clear','my-persona-group','确定要清空购物车中的所有商品吗？','SAFETY','caller-avatar','stickerCategoryId','send-direct-packet-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M170.666667\x20170.666667h128v682.666666h-128zM426.666667\x20170.666667h170.666666v682.666666h-170.666666zM725.333333\x20170.666667h128v682.666666h-128z\x22></path></svg>\x20','cart-total','”生成这组【与角色高度相关】的商品数据。','恭喜！','radio','werewolf-game-over-close-btn','狼人数量已达到胜利条件，狼人阵营获得了胜利！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20','div','检测到新版流式备份文件，开始导入...','请修改记忆要点：','rp-content-direct','toggle-blur-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','创建群聊','apiPresets','groupMembers','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','收到了格式不规范的AI指令（缺少type和content），已跳过:','artistName','https://i.postimg.cc/fyyGgW61/IMG-7115.gif','”。只有“','\x20小时了。','getVotes','https://api.vkeys.cn/v2/music/tencent/lyric?id=','通话记录已删除。',')**:\x20','#data-clear-type-list\x20.clear-posts-item','round','TA的好友包括:\x20','确认清理无效歌曲？','模型列表已更新','vote_for_name','paste','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的对话摘要\x20(供你参考)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','group-action-cooldown-input','douban-detail-avatar','matches','暂无内容...','comment','stream','\x0a#\x20用户的角色\x0a-\x20**','<span\x20class=\x22offline-description\x22>','open-memory-screen-btn','\x20为\x20','检测到群聊\x20\x22','global-lyrics-bar','summaries','\x20的动态\x20(用户)','change_group_name','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','确认清理','》吗？','guardedId','[发送了一条复杂消息，如卡片或转账]','确定要删除与\x20\x22','旧版备份数据写入数据库失败:\x20','temp_group_chat','\x22\x20class=\x22usage-item-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-name\x22>','qzone_like','album-grid-page','reading-window','char-album-grid','imageCount','播放被中断，这是正常行为:','.clear-posts-item','.music-search-checkbox:checked','clear-specific-data-btn','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**格式**:\x20你的回复【必须】是一段描述性的文本。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你正在和用户（','”这个信息，将其转换为【具体的公历日期】（例如：“约定了明天见面”应总结为“我们约定了','[表情，含义:\x20','block','天亮了。','https://i.postimg.cc/VkV2bLNw/IMG-6853.gif','frame_14','\x20向对方发起了转账:\x20','<div\x20class=\x22pinned-indicator\x22>📌</div>','[系统指令：用户按下了“推进”按钮，现在轮到你主动行动了，请继续对话。]','</strong></p><hr\x20style=\x22opacity:\x200.2;\x20margin:\x2010px\x200;\x22>','\x22\x20data-option=\x22','UTF-8\x20解码成功。','char-diary-screen','product-image-preview','product-grid','import-preset-btn','.chat-list-item','成功将角色\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20increase-qty-btn\x22\x20data-id=\x22',',\x20价格:\x20¥','这是你们最近的对话：\x0a','群聊内转账','5705tbFNIX','已删除最新心声，当前心声已回滚至上一条。','女巫已行动，女巫请闭眼。','在此修改，或点击上方按钮使用格式模板...','https://i.postimg.cc/3Rb46fRZ/IMG-6923.gif','https://i.postimg.cc/d1qsQsbQ/IMG-6855.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>本地图片(头像/表情/头像框/等)大小:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22><strong>','gift','time-perception-toggle',')，接收人是“','pat-animation','，人设:\x20','accept-call-btn',')\x20为\x20','background-activity-switch','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>未找到相关的聊天记录。</p>','<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20','获取AI投票失败:','ai-response-editor-modal','beginPath','frame_flower','save-douban-cast-btn','save-sticker-binding-btn','rule-regex-input','\x20(用户)</span>\x0a\x20\x20\x20\x20','正在请求“','请先在购物车中选择要结算的商品。','theme-toggle-switch','group-background-activity-group','compressed','first_mes','candidates','\x20(角色)</label>','book-upload-input','自定义通话名称','模拟表情含义\x20\x22','无法生成歌单，请检查API配置或稍后再试。\x0a错误:\x20','char-conversation-partner-name','local-song-upload-input','++id,\x20name','https://i.postimg.cc/zvWGPjms/IMG-7090.gif','cphoneWallpaper','icon-setting-item','当前通知版本\x20(','错误：找不到该通话记录所属的聊天对象。','\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','startDiscussion','notification-sound-url-input','纯音乐，请欣赏','直接使用\x20base64\x20数据','”\x20将备注修改为\x20“','订单详情','已撤回的消息','<div\x20class=\x22location-share-card\x22><div\x20class=\x22card-text-area\x22><div\x20class=\x22card-text-primary\x22>','name','swipeDirection','找不到主角\x20“','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)','rp-details-item','正在准备...','manage-ai-avatar-library-btn','号玩家:\x20','消息时间戳\x20','likesCount','<br><small\x20style=\x22color:\x20#ff8a80;\x20margin-top:\x2010px;\x20display:\x20block;\x22>自动记忆总结失败，可稍后手动尝试。</small>','\x0a#\x20【情景感知】\x0a-\x20**时间**:\x20感知到当前是','simulatedBrowserHistory','天\x20-\x20讨论','char-music-next-btn','values','\x20\x0a#\x20社交圈与动态\x0a','未知歌手','ai-avatar-library-grid','你是狼人，请选择刀人目标。','.rules-category-pane','已恢复默认字体。','charCodeAt','Caching\x20rendering\x20rules\x20for\x20chat:\x20','activeBookId','请点击右上角的“角色选择”按钮，选择至少一个参与豆瓣互动的角色。','AI返回了空内容或未知格式。','”，并根据其人设、记忆和最近的互动，虚构出【10到20条】TA最近的浏览器搜索/浏览记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20记录必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20记录类型要丰富，可以是帖子、文章、新闻、问答等。\x0a3.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都代表一条浏览记录，并且【必须】使用以下格式:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22一个引人注目的文章或搜索标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22url\x22:\x20\x22一个虚构的、看起来很真实的网址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22一篇200-400字的、详细的文章或帖子正文，支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20**【绝对禁止】**:\x20你的回复中【绝对不能】包含\x20\x22type\x22:\x20\x22image\x22\x20的对象。所有记录都必须是文字内容。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','.countdown-card\x20.timer','clientHeight',')\x20商品:\x20','%)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20建议刷新页面以应用所有更改。','getMonth','点击处理','sticker','总结成功','\x0a现在，请根据以上所有信息，继续这场没有用户参与的群聊，并自由地使用各种指令来丰富你们的互动。\x0a','isMinimized','htmlFor','删除评论','center','AI\x20(独立行动)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','#fullscreen-lyrics-container\x20.music-lyrics-list','\x0a#\x20可用表情包\x0a\x20\x20\x20\x20','book_','<span\x20style=\x22color:\x20orange;\x22>否\x20(还剩约\x20','AI已将新头像命名为：“','btn-danger','custom-bubble-style','导演模式保存(Sticker):\x20使用了编辑器提供的完整JSON\x20(url\x20+\x20meaning)','。等待对方处理。]','\x0a#\x20群成员列表\x20(你的总结目标)\x0a','确定要删除选中的\x20','recordId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','自定义数量','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','<strong>','\x20条旧记忆总结为以下核心记忆：<br><br><div\x20class=\x22scrollable-content-preview\x22>','outgoing-call-name','each','角色专属','amap','background','api-key','translateX(-50%)','createWriteStream','linkedMemoryChatIds','请AI角色们继续进行讨论。','stroke','豆瓣设定','gomoku-btn','keyword-search-input',')\x20的棋步。','char-taobao-screen','这是一个通过手动创建的角色。','#\x20角色与玩家档案\x20(Character\x20&\x20Player\x20Dossiers)\x0a','https://i.postimg.cc/TYvkKKkc/IMG-6565.gif','recipientName','[系统指令：视频通话刚刚结束。请你以角色的口吻，向用户主动发送一两条消息，来自然地总结这次通话的要点、确认达成的约定，或者表达你的感受。]','import-data-input','此操作将永久删除此聊天的所有消息，无法恢复。确定要清空吗？','--music-bg-image','\x0a-\x20\x20\x20**五子棋局势**:\x20','post-image-preview-container','创建新预设','.char-product-item','chat-group-container','#gift-recipient-list\x20.contact-picker-item','\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#888;\x20margin:\x204px\x200\x200;\x22>','usage','TTS\x20音频已保存到缓存。','list-item','开场\x20','”的对话摘要**:\x0a','\x27\x20在你的动态(ID:\x20','流式下载库\x20(StreamSaver.js)\x20未加载。请检查网络连接或HTML文件配置。','call-message-actions-modal','findIndex','then','生成失败:\x20','mes_example','\x20群里已经安静了','length','.thought-delete-btn','extensions','getElementsByTagName','<span\x20style=\x22color:\x20#ff8c00;\x22>[好友申请]\x20','https://i.postimg.cc/ZqQBCyLY/IMG-6144.gif','simulatedAppUsage','chat-header-status','ai_image',']\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20已经存在了！','exec','这将用文件中的设置覆盖当前的所有外观设置（包括壁纸、图标、字体、CSS等）。确定要继续吗？','.product-item.selected','home-screen','quality','\x0a\x0a现在，请开始生成这组备忘录。','product-item','\x0a#\x20可用表情包\x20(优先使用)\x0a每个AI角色都被设置了专属表情包，在需要发送表情时，他们应该【优先】从自己的专属列表中选择。尽量让你的表情丰富多样，避免重复。\x0a','确定要永久删除选中的\x20','chat-input','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20margin-top:\x2020px;\x22>空空如也~\x20点击右上角\x22添加\x22来创建你的第一个人设预设吧！</p>','”的出行足迹...','netease','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','minimaxGroupId','请输入提示词！','justifyContent','\x0a\x0a现在，请严格遵守所有规则，特别是【时间感知】和【禁止扮演用户】的铁律，开始生成这组生动、多样且充满“豆瓣味”的小组帖子。','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】日记的标题日期，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【沉浸感】**:\x20每一篇日记都必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【长度】**:\x20每一篇日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一篇日记，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【占位符替换\x20(最高优先级)】**:\x20在你的日记内容中，【绝对不能】出现\x20\x22{{user}}\x22\x20这个占位符。你【必须】使用\x20“','toDateString','decode','照片已删除。','voiceId','aiAvatarFrame','转发了\x20@','<div\x20class=\x22avatar-group\x22><img\x20src=\x22','#npc-association-list\x20input:checked','https://i.postimg.cc/VkXngG72/mmexport1751031208329.gif','summarize-recent-btn-header','.participant-avatar-wrapper[data-participant-id=\x22user\x22]\x20.participant-avatar','\x22\x20决定去发一条动态...\x20(此处为模拟)','处理通话请求时API出错:','join','编辑商品','https://i.postimg.cc/wx72fhr2/IMG-5968.gif','participant-display-avatar','即将开始下载您的完整备份文件。下载过程中请勿关闭页面。','狼人杀','\x20首歌曲。','无法生成浏览记录，请检查API配置或稍后再试。\x0a错误:\x20','\x0a\x0a现在，请严格遵守所有规则，选择并执行你的行动。','\x0a-\x20**帖子内容摘要**:\x20','change-icon-btn','gameLog','remove','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','ArrowLeft','导入\x20Tavern\x20AI\x20世界书','chat','\x20→\x20','visibility','bulkPut','novelai-settings','filter','member-management-item','close-nai-test-btn','个红包，共','manage-group-avatar-library-btn','renderXSocialScreenProxy','delete-btn','https://i.postimg.cc/qRCtnMms/IMG-6145.gif','https://i.postimg.cc/HLZNWkQw/mmexport1751031767634.gif','text','line-through','song','字体预设已保存！','paid','</recent_dialogue_with_user>\x0a</character>\x0a','”\x20吗？','selection-count','照片上传成功！','caller-name','frameUrl','group_call_response','backgroundImage','导演模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','》吗？此操作不可撤销。','close-transcript-modal-btn','flex','下单，请慢用～</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-label\x22\x20style=\x22font-size:\x2018px;\x20font-weight:\x20600;\x22>','ZIP解压失败:','请先输入你的发言内容。','正在模拟“','\x20发起了一个投票\x20(时间戳:\x20','申请成功！','精炼成功','global_css','confirm-final-clear-btn','songs','使用解药救TA','add-song-local-btn','readAsText','https://i.postimg.cc/YSkqDg8V/IMG-7092.gif','ai-avatar-upload-input','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI。你的核心任务是扮演角色“','album-upload-photo-btn','posts','character-nai-negative','https://i.postimg.cc/8kHCQwbQ/mmexport1751020645824.gif','数据库写入失败:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','reset-sound-btn','AI\x20角色\x20\x22','预设已删除。','album-photo-input','alternateGreetings','linked-memory-selection','regenerate-char-taobao-btn','product-variations-container','<div\x20class=\x22poll-card\x20','.entry-comment-input','qzone-sticker-grid','https://i.postimg.cc/1zmcp66p/IMG-5973.gif','hiddenContent','请输入EPhone主屏幕的背景图片URL','confirm-share-link-btn','https://i.postimg.cc/pXxk1JXk/IMG-6442.jpg','\x20的红包已被领完','lyrics-vertical-pos','最近支出','delete-track-btn','member-management-screen','请输入备忘录内容','无法获取AI回复，请检查API配置或稍后再试。\x0a错误:\x20','动态发布成功！','change','找不到这个预设的详细信息。','rp-group-amount','[系统提示：你于时间戳\x20','favorite','<div\x20class=\x22gift-preview-item\x22><img\x20src=\x22','notification-bar','reject','close','minimaxModel','memos','读书会话已关闭。','\x20\x20\x20负面:','transfer-note','NPC的昵称和人设都不能为空！','\x0a-\x20**你最近和“','<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22','cart-items-list','每晚可以守护一名玩家，使其免受狼人袭击。不能连续两晚守护同一个人。','rp-tab-group','custom-modal-confirm','char-music-total-time','pageX','已取消收藏','existing-groups-list','#\x20角色核心设定\x0a','✅\x20图片解压成功！','\x0a\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','点击查看详情...','”吗？','播放失败，请检查URL是否正确或浏览器是否支持该格式。','发送语音','”。请你【结合自己的角色设定、世界观和你们的最近聊天内容】，对这条动态发表一条自然的评论。]','callRecords','https://i.postimg.cc/fyPDvxJk/IMG-6860.gif','rp-details-list','要为《','textContent','未使用','确认导入','已死亡','静音音频已停止。','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20空间节省了\x20<strong>','system_message','announcement-action-cancel','API\x20错误:\x20','请输入你想说的话...','正在为您选择的\x20','mouseleave','#chat-messages','naiimag','.screen','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','cancel-frame-settings-btn','nextElementSibling','.post-avatar[data-author-id=\x22','确定要将选中的商品作为礼物送出吗？','member-editor','selection-mode','doubanPosts','计算图片总大小时出错:','「在这里输入对话内容」\x0a(在这里输入动作或环境描写)','getContext','58207tUFPEG','douban-cast-list','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“','parse','”，并根据其人设、记忆和最近的互动，虚构出【5到8篇】TA最近可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','\x0a\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','https://i.postimg.cc/90sH9Cn7/IMG-6868.gif','seed','转账:\x20','sender','search-results-list','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22',']\x20[最近对话:\x20','GBK\x20解码成功。','pollTimestamp','product-category-manager-modal','\x20的对话','shift','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','ai-persona-group','qzone-banner-img','https://i.postimg.cc/wTTNGs3Q/IMG-7013.gif','\x20分钟)</span>','被投票放逐','.world-book-tab','\x0a#\x20可用表情包\x20(优先使用)\x0a-\x20请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a','black','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','char-memo-detail-content','add-song-search-btn','a\x20beautiful\x20scene','ai-original-name-input','.werewolf-player-checkbox:checked','announcement-board-modal','\x22\x20的后台活动开关已关闭，本次跳过。','memory-card','</p></div><table\x20class=\x22receipt-items-table\x22><thead><tr><th\x20class=\x22item-name\x22>商品</th><th\x20class=\x22item-qty\x22>数量</th><th\x20class=\x22item-price\x22>单价</th><th\x20class=\x22item-subtotal\x22>小计</th></tr></thead><tbody>','outgoing-call-screen','character-nai-prompts-modal','小于1分钟','你有一瓶解药和一瓶毒药，解药可以救活当晚被杀的玩家，毒药可以毒死任意一名玩家。','\x22\x20的独立行动API返回为空或格式不正确，本次跳过。','size','https://i.postimg.cc/vHCSG1WM/IMG-4416.gif','”\x20的详细角色信息。','确定要拉黑“','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的日记标题日期【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【【【沉浸感铁律】】】**:\x20日记必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【【【长度铁律】】】**:\x20日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【【【格式铁律\x20(最高优先级)】】】**:\x20你的回复【必须且只能】是一个JSON数组，且数组中【只包含一个】对象，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【【【日记专属Markdown语法\x20(必须使用！)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a###\x20格式\x20B：群聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22group\x22,\x0a\x20\x20\x22groupName\x22:\x20\x22一个虚构的群名\x22,\x0a\x20\x20\x22participants\x22:\x20[\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员1\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员1头像【英文】关键词\x22},\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员2\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员2头像【英文】关键词\x22}\x0a\x20\x20],\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','select-all-cart-items','world-book-name-input','将分类\x20“','find','图片\x20Blob\x20创建成功，大小:','在这里输入图片描述...','#custom-modal-body\x20.format-btn[data-type=\x22text\x22]','revokeObjectURL','</div><div\x20class=\x22description\x22>','[♪\x20','toFixed','upload-ephone-bg-url-btn','#avatar-frame-modal\x20.frame-tabs','导入失败','isClick','back-from-member-management','确定要删除这篇日记吗？','cart-back-btn','row','commenterName','save-advanced-editor-btn','.message-bubble[data-timestamp=\x22','请开始总结。','https://i.postimg.cc/pLY3WfR8/IMG-6557.gif','\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)}`\x0a-\x20\x20\x20**送礼物**:\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送这个礼物的原因\x22,\x20\x22image_prompt\x22:\x20\x22生成礼物图片的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22}`\x0a-\x20\x20\x20**为用户点外卖**:\x20\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}\x20`(你主动为用户点外卖时使用)\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','正在读取并解析备份文件...','天\x20-\x20投票','最小帖子数不能大于最大帖子数！','[系统提示：你接受了“','NotAllowedError','qzone-avatar-img','请你投票。','相册\x20\x22','https://i.postimg.cc/mDfMXXFP/IMG-7007.gif','编辑规则','\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20','发生了一个错误:\x20','分钟前聊过。','导入外观设置时出错:','like','touchstart','.qzone-post-container[data-post-id=\x22','board','\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a','https://i.postimg.cc/tC9mJ0cv/IMG-4438.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','确定要清空当前角色的NAI提示词配置吗？','char-usage-screen','\x20元。此订单已完成。]','EPhone-Chat-','胜利！','精炼长期记忆时出错:','\x0a[文字图内容:\x20','https://i.postimg.cc/HWynLK7f/mmexport1751021724230.gif','本次发送给AI的【挂载记忆】内容如下：\x0a','back-to-char-qq-list-btn','positive','hang-up-btn','导演/编辑模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','收到数据，类型:','voice','”。红包还未领完，群内任何人都可以使用\x20\x27open_red_packet\x27\x20指令来领取。]','realimag','werewolf-role-reveal-list','gameMode','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','nai-smea','change_music','https://i.postimg.cc/4y7mGFgJ/IMG-5716.gif','waimai_response','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action\x22>打开了\x20<strong>','prototype','char-memo-list','authorName','members','visibleTo','#music-lyrics-container','</div><div\x20class=\x22receipt-footer\x22>感谢您的惠顾，欢迎再次光临！</div>','QQ音乐搜索API失败:','-modal','最近的消息太少，无法进行有意义的总结。','memoryTimestamp','.edit-memory-btn','char-qq-conversation-screen','poison','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','今天\x20','生成失败','buttonId','请先在API设置中配置好API信息。','请先点击扳手图标进入管理模式，才能添加新商品。','world-book-editor-title','lrc','\x20请根据这个结果发表你的评论。]','[图片内容:\x20','local','category','请为这本设定集命名：','\x20删除了自己的一条动态]','确定要删除NPC\x20“','update-notice-modal','world-book-tab\x20active','world-book-screen','https://i.postimg.cc/R0pfKYvB/IMG-5976.gif','update-notice.html?_=','\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a','\x20\x0a-\x20**你们最后的对话**:\x0a','nai-custom-proxy-url','variation-decrease-qty','.message-bubble','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-description-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22char-photo-description\x22>','post-image-desc-group','请为你的图片添加一个简单的描述（必填，给AI看的）！','visibilityState','originalSize','en-US','通话记录','closed','请先填写对应的反代地址和密钥','https://i.postimg.cc/D0pq6qS2/E30078-DC-8-B99-4-C01-AFDA-74728-DBF7-BEA.png','create-new-member-btn','正在等待AI角色们进行激烈的讨论...','music-return-btn','favorites-search-input','isNpc','messages-view','.\x20你可以参考这个时间，并根据你的角色设定，【考虑】是否开启一个新话题来问候用户。\x0a','#\x20前几日完整历史回顾\x20(Full\x20Recap\x20of\x20Previous\x20Days)\x0a','uncategorized','offline-mode-options',')\x20刚刚投票给了\x20“','创建群聊至少需要选择2个联系人。','文章摘要...','已加载预设\x20“','music-play-pause-btn','https://image.novelai.net/ai/generate-image','[系统提示：用户（','product-category-select','new-group-name-input','<span\x20class=\x22speaker\x22>','groupHeader','frame_ribbon','来自\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20absolute;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2011px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x202px\x206px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.1);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20white-space:\x20nowrap;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','music-player-overlay','.delete-block-btn','chara','彻底删除消息','usageTimeMinutes','\x20的外卖订单（时间戳:\x20','(在那次','无标题','accepted','#e9ecef','view','zh-CN','countdown-date-input','characterName','\x22\x20的独立后台活动开关已关闭，本次跳过。','transcript-modal-title','/v1/chat/completions','\x20<span\x20class=\x22group-tag\x22>群</span>','112904DfTEup','\x22\x20class=\x22avatar-frame\x22></div></div>','”\x20已成功导入！','\x20邀请你加入群视频','pending','clear-search-btn','originalPost',':\x20[发送了一个表情，意思是:\x20\x27','save-shopping-settings-btn','close-char-music-player-btn','https://i.postimg.cc/Fz3HwLk9/IMG-5569.gif','upload-image-btn','https://i.postimg.cc/cHQPgzj4/IMG-6888.gif','qzoneGroups','（当前帖子还没有路人NPC发表评论。）\x0a','https://i.postimg.cc/05DLr0yj/IMG-4427.gif','更换图片','手动总结已完成！新的记忆已添加到“','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','preset-screen','receiverName','shoppingCategories','。请你对此作出回应，可以表现出好奇、开玩笑（比如\x27我截图了！\x27）、或者根据你的人设表示理解或疑惑。]','usage-item','\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22','currentTarget','offline','从角色卡导入\x20(.json/.png)','已成功收藏到“我的收藏”页面！','char-music-artist','发送好友申请','阵营胜利！','https://i.postimg.cc/PrcKH436/IMG-4376.gif','clearRect','shopping-settings-btn','content-type','）进行视频通话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**','确定要删除这条评论吗？','未在文件中找到\x20\x27order\x27\x20字段，条目可能无法按原始顺序导入。','wb_','\x20其中包括以下投票：','day','chat-settings-btn','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','抱歉，未能找到相关歌曲。','persona-library-modal','qzone-banner-input','imageDescription','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','AI\x20(独立行动)\x20尝试使用一个不存在的表情:\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20附加上下文：一段分享的聊天记录\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20重要提示：这不是你和当前用户的对话，而是用户从【另一场】与“','sticker-category-tab','simulatedMusicPlaylist','.commenter-name','read-together-btn','\x20天\x20---**\x0a','publisher','notification-content','.delete-memory-btn','speaker_name','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','options','\x0a##\x20世界书《','0:00','🌐\x20使用网络URL','(ID:\x20','cancel-wolf-kill-btn','nai-diffusion-4-5-full','角色\x20“','\x20分钟)，本次独立行动跳过。','LOW','#ff4d4d','<div\x20class=\x22spinner\x22></div>','vinyl-view','-\x20你的毒药状态：','gridEl','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-price\x22>¥','<div></div><div></div><div></div><div></div><div></div>','导出失败','将清空选定角色的所有动态、评论和点赞。','手动注入狼人杀记忆失败:','import-card-input','https://i.postimg.cc/vH2X6N1y/mmexport1751032231179.gif','maxMemory','发送照片','【重要提示】','https://i.postimg.cc/gc3QYCDy/1-NINE7-Five.jpg','<span\x20style=\x22color:\x20red;\x22>未运行</span>','douban-detail-content-wrapper','置顶公告','purchases','imageProcessed','white','api-settings-screen','https://i.postimg.cc/W40f9qtd/IMG-7098.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','announcement-action-delete','photo-item','Minimax\x20TTS\x20API\x20调用失败:','AI\x20尚未对您的最后一条消息做出回应，无法重新生成。','群聊\x20\x22','sticker-category-tabs','粘贴歌词','\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a','请在此处粘贴完整的LRC格式歌词...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','文件格式无法识别。未找到有效的\x20\x27prompts\x27\x20数组或\x20\x27entries\x27\x20对象。','https://i.postimg.cc/85Zsyjwn/IMG-6895.gif','</strong>\x20Tokens</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x0a\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','无备注','\x22\x20成功发布了一条新动态。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有备忘录。</p>','”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20','【原动态内容:\x20','qzone-posts-list','\x20的对话\x20(只读)','linkedWorldBookIds','</div><div\x20class=\x22countdown-label\x22>剩余支付时间<div\x20class=\x22countdown-timer\x22\x20id=\x22waimai-timer-','imageUrls','.ai-generated-image','当前人数\x20','EPhoneWorldBookBackup','加载NPC列表失败:','is_busy','image/jpeg','isSpectatorGroup','.info','照片描述','group-avatar-preview','[系统提示：用户打开了五子棋棋盘，游戏开始了。]','announcement-action-pin','请至少选择一位收礼人。','\x20\x20\x20characterPositivePrompt:','add-new-group-btn','settings-preview-area','”\x20将对你的称呼修改为\x20“','bg-preview','歌曲信息','已切换到角色\x20','delete-api-preset-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','外观预设已保存！','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','在这里输入图片描述','ZIP文件中未找到图片','switch-to-image-mode','https://i.postimg.cc/RZNLhbbr/IMG-4389.gif','NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。','\x27刚刚评论了你的动态“','\x0a\x20\x20\x20\x20','通话中还没有你的发言，无法重新生成回应。','\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22quantity-display\x22>','save-api-settings-btn','\x0a-\x20**世界观**:\x20','register','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','werewolf-witch-modal','isPinned','<label><input\x20type=\x22checkbox\x22\x20value=\x22','#product-grid\x20.product-item','toggle','https://i.postimg.cc/k401K5g7/IMG-7304.jpg','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22decision\x22:\x20\x22apply\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22在这里写下你想对用户说的、真诚的、有针对性的申请理由。\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20\x20\x20\x20','players','导出单个聊天时出错:','请输入歌曲的URL','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>','headers','导出成功','https://i.postimg.cc/Qx5dqyJ3/IMG-6917.gif','music-current-time','right','#ff8a80','.post-footer,\x20.post-feedback-icons,\x20.post-actions-btn,\x20.post-comments-container,\x20.reposted-content-wrapper','*对方按下了接听键...*','apply','NPC人设','https://i.postimg.cc/4NCPsp5d/mmexport1751034427637.gif','导入\x20Tavern\x20预设','发布公告','\x20的礼物','werewolf-game-btn','”的手机使用习惯...','请输入CPhone的背景图片URL','\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>','targetDate','chat-list-actions-modal','一条[转账]消息已被撤回。','API错误响应:','这是模拟对话，无法发送消息哦~','请填写有效的商品信息和金额！','</button>','prev-page-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','内容因安全策略被屏蔽。触发类别:\x20','hasListener','\x20\x20\x20promptSource:','complex','rotating','werewolf-retry-btn','\x0a你必须严格遵守','”\x20的预设已存在。要覆盖它吗？','trans','你赢了','new-category-name-input','max-memory','callHistory','offsetParent','<em>','API\x20请求失败:\x20','世界书数据已成功恢复！','API为空回，角色\x20\x22','checkout-btn','\x22\x20class=\x22cart-item-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-name\x22>','photoId','没有可供重新生成回复的用户消息。','\x0a##\x20','https://i.postimg.cc/mZ9hgH3J/IMG-7019.gif','<div\x20class=\x22poll-option-item\x20','\x20\x0a-\x20**你最近和“','chat-list-item','api-temperature-slider','shopping-back-btn','message-actions-modal','group-avatar-library-grid','setHours','pop','translateX(-','werewolf-game-title','appearancePresets','refine-memory-btn-header','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','”的特点生成专属商品...','chat-list-bottom-nav','pin','groupAvatarLibrary','.avatar-group','-\x20\x20\x20**NovelAI真实图片分享\x20(在聊天中直接发送)**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20-\x20**【绝不能暴露是novelai生成的图片！】\x0a\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20-\x20使用场景：当你想要在【私聊对话中】直接给用户发送一张图片时使用。\x0a\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。\x0a\x20\x20\x20\x20-\x20注意：这会直接在聊天记录中显示图片，而不是发布到动态。','female-shaonv-jingpin','enableBackgroundActivity','创建旁观群聊\x20(我围观)','\x0a-\x20**内容摘要**:\x20','https://...','editable-text','\x0a#\x20你的任务\x0a你是一个狼人杀游戏导演。你的任务是扮演【除了','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有可以查看手机的角色哦~</p>','char-photo-description','-\x20**对话状态**:\x20(暂无有效对话历史)','nightActions','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x205px\x200;\x22>','add-my-avatar-batch-btn','regenerate-call-btn','成功导入\x20','getUint32','address','load-more-thoughts-btn','删除日记','</div><div\x20class=\x22transfer-amount\x22>¥\x20','getElementById','qzone-post-delete-action','\x0a#\x20你的任务\x0a你就是角色“','body','</td><td\x20class=\x22item-qty\x22>','生成购物中心商品失败:','save-wallpaper-btn','https://api.vkeys.cn/v2/music/netease?id=','\x0a\x0a现在，请开始生成这组【纯文本】的浏览记录。','originalName','ᗜωᗜ','/9j/','put','https://i.postimg.cc/3JSG5Jv5/IMG-7014.gif','一位朋友','\x22,\x20\x22content\x22:\x20\x22对话内容1\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC的名字\x22,\x20\x22content\x22:\x20\x22对话内容2\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22','horizontal','hasShown40','input[value=\x22','已成功将\x20','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','isDanger','已恢复默认设置！','clipboard','\x0a-\x20**人设\x20(必须严格遵守)**:\x20','https://i.postimg.cc/nrm9BcL8/IMG-6941.gif','offline-preset-select','<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22','**[讨论环节]**\x0a','gbk','enableTimePerception','帖子详情','arrayBuffer','ai-cooldown-group','AI女巫决策：今天是第','npc-association-list','API\x20请求失败，状态码:\x20','manual','\x20个新表情！','\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','https://i.postimg.cc/zvz2LGK0/IMG-4367.gif','✅\x20NAI提示词：使用系统配置','data-voice-id=\x22','https://i.postimg.cc/7LSRp4hx/e7fa949b9pc84cff0dabe57defceb54c.gif','transfer','在这里输入说说的内容...','https://i.postimg.cc/90RBDh9K/IMG-6377.gif','未发现任何需要修复的数据问题。','#\x20已有路人NPC头像指令\x20(必须遵守！)\x0a','无人投票','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20可用表情包\x0a\x20\x20\x20\x20\x20\x20\x20\x20',')\x20刚刚领取了红包\x20(时间戳:\x20','我的消息预览','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','的状态已更新为:\x20','clear-posts-modal','\x0a\x0a#\x20当前音乐情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**当前状态**:\x20你们正在和用户一起听歌。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**正在播放**:\x20','participants','world-book-card','music-search-results-modal','syncCharacterNameInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','**内容:**\x0a','tts_','你们正在一起读书。','无法生成模拟相册，请检查API配置或稍后再试。\x0a错误:\x20','indexOf','npc','where','\x22\x20\x0a\x20URL:\x20','.chat-group-header:not([data-has-listener=\x22true\x22])','正在执行清理操作，请不要关闭页面...','请为这个头像起个名字（例如：开心、哭泣）','expanded','my-nickname-input','widgetData','is-waimai-request','\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22评论内容\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20表情:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','原始消息已删除或不存在','EPhoneSingleChat','已成功从文件导入预设《','.message','\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a','fullscreen-active','请输入Ta的【本名】(例如:\x20李星辰，这个名字将用于AI识别)','startX','update-notice-confirm-btn','++id,\x20title,\x20lastOpened','removeChild','天，救人概率为\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里空空如也，<br>点击右上角刷新按钮，看看大家都在聊什么吧！</p>','message-editor-block','<br>','#image-mode-content','选择歌词导入方式','.qzone-post-container','battery-alert-text','♪\x20♪\x20♪','[图片:\x20','musicData','button','readingLibrary','currentPlayer','douban-cast-modal','bg-btn','span','isPlaying','linkedWorldBookId','https://i.postimg.cc/D01rYy86/mmexport1751037965259.gif','\x0a\x0a#\x20你的动态历史\x20(你可以选择删除它们):\x0a','压缩完成！','无法生成备忘录，请检查API配置或稍后再试。\x0a错误:\x20','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','.draggable-button-item','https://i.postimg.cc/g2PfbSFm/IMG-6556.gif','AI\x20发言失败','生成的图片URL:','.entry-content-textarea','长期记忆','equalsIgnoreCase','.world-book-group-content','\x20首歌曲...','\x0a\x0a#\x20你的角色库\x20(你可以从中选择【任何角色】进行评论，并参考他们的记忆和对话)\x0a','删除歌曲','\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a','npcs','正在开始全面压缩图片，根据图片数量，这可能需要几分钟时间，请不要关闭或刷新页面...','创建新聊天','template','currentPhase','load-more-btn','这将用文件中的数据【完全覆盖】您当前所有的世界书和分类。此操作不可撤销！','recall-message-btn','确定要永久删除这条通话记录吗？此操作不可恢复。','\x0a<character>\x0a\x20\x20<name>','statusText','\x0a\x0a#\x20待总结的群组视频通话记录\x0a','notification-avatar','commenter',')，开始总结...','search-history-btn','导入世界书时出错:','<option\x20value=\x22current\x22>当前配置\x20(未保存)</option>','openCharApp','handlePacketClick','\x0a\x0a#\x20当前情景\x0a','”下，回复了\x27','authorChatId','removeEventListener','recalled_message','AI\x20尝试评论一个不存在的表情:\x20\x22','猎人带走了\x20','\x22\x20class=\x22music-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-name\x22>','position','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22werewolf-player-checkbox\x22\x20data-player-json=\x27','\x20的记忆\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20','<option\x20value=\x22\x22>--\x20未分类\x20--</option>','\x0a-\x20**世界书设定**:\x20','char-usage-list','enable-tts-switch','\x20你应该像它们从未存在过一样继续对话，并相应地调整你的记忆和行为，不要再提及这些被删除的内容。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','请根据你的设定，生成你的歌单。','management-mode','moveTo','manage-product-categories-btn','\x0a\x0a#\x20你的角色设定\x0a','\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色扮演】**:\x20你的所有行为都【必须】严格符合你的角色设定。\x0a2.\x20\x20**【互动逻辑】**:\x20如果选择评论，优先回复那些提到了你或回复了你的评论。\x0a3.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20\x20\x20数组中可以包含【一个或多个】行动对象。\x0a\x20\x20\x20\x20-\x20\x20\x20每个行动对象的格式【必须】是以下两种之一：\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发布新动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22你的新动态内容。\x22}`\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发表评论**:\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22你的新评论内容。\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的【本名】\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。\x22}`\x0a4.\x20\x20**【行为组合指南】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由组合不同的行动，例如，先发布一条自己的动态，再去评论别人的动态。\x0a\x20\x20\x20\x20-\x20\x20\x20为了模拟真实行为，你本次生成的行动数量建议在【1到3个】之间。\x0a\x0a#\x20你的角色设定\x0a-\x20**昵称**:\x20','（可选）输入后缀','确定要永久删除这条动态吗？','noneOf','post-actions-modal','records','你们在','select-all-types-for-clear','custom-modal-title','default_positive','setProperty','toLocaleString','<div\x20class=\x22receipt-header\x22><h3>购物中心</h3><p>交易时间:\x20','外观设置已保存并应用！','is-realimag','character-nai-positive','character-selection-screen','分钟前','char-album-screen','\x20之间的有效数字。','错误：找不到要转发的原始动态。','groupName','###\x20你的秘密信息\x20(此部分只有你作为AI导演能看到)\x0a','setTimeout','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','.message-wrapper','2zYtLaZ','请至少选择一个要清空的范围。','music-progress-fill','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','waimai-timer-','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22memo-title\x22>','确定要删除这条记录吗？','\x20发起了外卖代付请求，商品是“','#chat-interface-screen\x20>\x20.header','save-preset-btn','chat-settings-screen','groupId','”分享TA的备忘录...','.gift-card','choice','\x20/\x20','成功将群聊\x20\x22','resolve','请根据你的设定，生成你的备忘录内容。','highlighted','input[name=\x22variation-select\x22]:checked','naiSettings','npc-persona-input','photo-viewer-next-btn','backgroundColor','latestTimestamp','error',':generateContent?key=','createDocumentFragment','商店空空如也，点击“管理”添加商品吧！','<span>删除</span>','waimai-confirm-btn','https://i.postimg.cc/Mpv5fzm5/IMG-4439.gif','[一张图片，其隐藏文字为：\x22','killedId','music-playlist-btn','请输入一个\x202\x20到\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','网易云','top','12p','.post-nickname','一位神秘的NPC','save-rule-btn','groupAvatar','is-sticker','删除失败','请先进入一个聊天页面，再返回购物中心进行生成，以便AI了解要为哪个角色生成商品。','Response\x20headers:','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI导演。下面的“帖子摘要”和“已有评论”来自于一个豆瓣小组的帖子。用户“','”的聊天记录和设置。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>','add-poll-option-btn','share_link','announcement-item-actions','加载失败','确定要删除表情\x20\x22','cancel-call-btn','正在开始清理冗余数据，请不要关闭页面...','请为这组提示词预设命名：','album-screen','在导演模式保存时，遇到了未知的AI指令类型:','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','请输入对方现在的新状态：','minimized','all','smea','已切换到新的开场故事！','ai-frame-grid','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>','blur','</td><td\x20class=\x22item-subtotal\x22>¥','\x22\x20class=\x22realimag-image\x22\x20alt=\x22NovelAI图片分享\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22\x20title=\x22','autoMemoryInterval','nai-default-negative','frame_6','reload','网络图片','无法找到对应的分享记录或记录已损坏。','”刚刚对最后一条评论点击了“等待回复”，TA希望看到更多角色参与讨论。\x0a你的任务是：根据所有角色的设定，选择【10到20位】最适合参与讨论的角色，让他们针对已有评论，发表【全新的、符合人设的】回应。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','transition','https://i.postimg.cc/8k7YSLjK/1689aa46aqc4b9ffc0f970e668f56537.gif','delete-selected-products-btn','voice_message','-\x20\x22','8px','call-message-bubble\x20ai-speech','https://i.postimg.cc/J4WCQd2j/IMG-4420.gif','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','https://i.postimg.cc/8kYShvrJ/90-UI-2.png','手慢了','minimax-group-id','解析AI返回的投票JSON时出错:\x20','getHours','确认删除分类','\x0a\x0a现在，请开始生成这组照片的描述和绘画指令。','commenterOriginalName','number','删除分类后，该分类下的所有预设将变为“未分类”。确定吗？','API未配置','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','isDeleted','确认精炼记忆？','<span\x20style=\x22color:\x20green;\x22>运行中</span>','commentsCount','witch-modal-title','my-group-nickname-input','title','font-size-value','char-music-cover','save','head','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，可以包含一个或多个行动对象。每个对象的\x20\x22name\x22\x20字段【必须】是角色的【本名】。你【绝对不能】生成\x20\x22name\x22\x20字段为\x20\x22','#text-image-mode-content','margin:\x2010px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','请输入相册名称','外观设置已成功导入并应用！','\x0a-\x20**你的曾用名**:\x20[','send-group-packet-btn','books','解析格式模板失败:','limit','ai-frame-content','\x22><div\x20class=\x22member-name\x22>','publicText','操作失败，请检查API配置或稍后重试。\x0a错误信息:\x20','selection-screenshot-btn','load-more-chats-btn','select-all-frames-checkbox','<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>','packetType','typing-status','执行检查时发生错误:\x20','https://i.postimg.cc/yN3s8szM/IMG-4400.gif','message-editor-container','min','page-indicator','\x20本世界书已成功删除。','\x22>...</div>','请至少选择一个要删除的世界书。','target_name','生成模拟日记失败:','.red-packet-card','location_share','https://api.minimax.chat/v1/text_to_speech?GroupId=','EPhone-Full-Backup-Legacy-','API错误:\x20','postTitle','\x20位角色的记忆中。','此操作将使用AI生成新的商品和分类，并【添加】到现有列表中。确定要继续吗？','.icon-preview','您的旧有记忆已被完整保留，未作任何修改。','(无)','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin:\x200;\x22>','is-acting','delete-theme-preset-btn','char-wallet-screen','manage-stickers-btn','确认删除','max','\x0a\x0a#\x20你的商店\x20(你可以为群成员购买礼物):\x0a','<span\x20class=\x22lucky-king-tag\x22>手气王</span>','qzone_comment','API未配置，无法生成内容。','dblclick','variation','quote','contains','📤\x20发送请求到\x20NovelAI\x20API','wallpaper-screen','lastUpdate','无法获取电池信息:','block-cooldown-input','bookId','保存成功','import-appearance-input','payload','\x0a}\x0a}','6036050PRZwAw','decrease-qty-btn','rp-group-greeting','[表情:\x20','anonymous','image-mode-content','[转账]','https://i.postimg.cc/dVLXm3Xf/IMG-6885.gif','已删除最后一条心声，当前心声已重置。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有任何角色或NPC可以加入群聊。</p>','”，并根据其人设、记忆和最近的互动，虚构出TA最近的淘宝购物记录和账户余额。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**余额铁律\x20(最高优先级)**:\x20你【必须】根据角色的【经济状况】设定一个合理的\x20`totalBalance`\x20(总余额)。例如，富有的角色应该有更高的余额，而学生或经济拮据的角色则应该有较低的余额。\x0a2.\x20\x20**合理性**:\x20购买记录必须完全符合角色的性格、爱好和经济状况。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22totalBalance\x22:\x2012345.67,\x20//\x20(这是一个示例数字，你必须根据角色的经济状况生成一个全新的、合理的余额！)\x0a\x20\x20\x20\x20\x20\x20\x22purchases\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22itemName\x22:\x20\x22一个具体、生动的商品名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x20128.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22已签收\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22这是角色购买这件商品的内心独白或理由，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张商品图片的、详细的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**purchases**:\x20一个包含12到15个商品对象的数组。\x0a\x20\x20\x20\x20-\x20**status\x20(订单状态)**:\x20只能从\x20\x22已签收\x22,\x20\x22待发货\x22,\x20\x22运输中\x22,\x20\x22待评价\x22\x20中选择。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','\x22\x20placeholder=\x22例如:\x20key1,\x20key2,\x20key3\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>内容</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x225\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','页面跳转','https://i.postimg.cc/CMv02LHm/mmexport1751034842120.gif','rules-category-pane','\x20(图片描述:\x20\x22','\x22\x20placeholder=\x22例如：关于角色的童年\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','include','minimize-reading-btn','qzone-banner-container','”，并根据其人设、记忆和最近的互动，构思出【8到10张】TA最近可能会拍摄或珍藏在手机相册里的照片。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20照片内容必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20照片主题要丰富，可以包括自拍、风景、食物、宠物、朋友合影、工作场景等。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一张照片，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是照片背后的故事或角色的心情日记，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张照片的、详细的【英文】关键词。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20绝对禁止】**:\x20绝对禁止包含任何中文字符、句子、特殊符号、或任何可能涉及敏感（NSFW）、暴力、血腥、政治的内容！也禁止真人！\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20必须是】**:\x20必须是纯英文的、用逗号分隔的【关键词组合】\x20(e.g.,\x20\x221boy,\x20solo,\x20basketball\x20jersey,\x20in\x20locker\x20room,\x20smiling,\x20selfie\x22)。\x0a\x20\x20\x20\x20-\x20**【画风指令】**:\x20在\x20prompt\x20的末尾，总是加上画风指令，例如：\x20`best\x20quality,\x20masterpiece,\x20anime\x20style,\x20cinematic\x20lighting`\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','”的当前状态已更新为：','\x20\x20\x20characterNegativePrompt:','删除照片','.entry-keys-input','gift-receipt-modal','https://i.postimg.cc/Jz2Tz0dw/IMG-7281.jpg','\x22\x20data-memory-timestamp=\x22','[系统提示：用户\x20(','children','minimaxApiKey','\x0a-\x20**你的长期记忆**:\x0a','link-content-input','错误：找不到要删除的分类。','prompt','\x20评论了动态]','music-mode-btn','nai-test-result','link-memory-toggle','tEXt','”</i></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22accept-friend-btn\x22\x20class=\x22lock-action-btn\x22>接受</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22reject-friend-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22>拒绝</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','更换专辑封面','\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20用户的角色\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**','grayscale(100%)','元。这不是一个代付请求，而是用户已经为你支付了。请你对此表示感谢。]','https://i.postimg.cc/4x9tTy1D/IMG-5563.gif','className','encode','sticker-panel','level','.chat-group-header','选择要精炼记忆的角色','paddingBottom','start-werewolf-game-btn','rp-group-count','add-group-avatar-batch-btn','EPhone-Full-Backup-Streamed-','includes','#custom-modal\x20.custom-modal-footer','保存主题预设','char-main-time','\x20的日记','https://i.postimg.cc/gk0BmrY0/IMG-4371.gif','https://image.novelai.net/ai/generate-image-stream','next-page-btn','douban-min-posts-input','padEnd','sticker-binding-modal','rp-details-summary','编辑\x20NPC','\x20的头像框到群聊\x20\x22','https://i.postimg.cc/W1CjLb4J/IMG-4409.gif','#data-clear-char-list\x20.clear-posts-item.selected','<span\x20class=\x22diary-underline\x22>$1</span>','add-new-category-btn','来自“','角色\x20\x22','https://i.postimg.cc/Y2PHZzCC/IMG-6866.gif','order','transfer-modal','https://i.postimg.cc/7YRbzN51/mmexport1751036276038.gif','未知作者','import-new-book-btn-header','clientWidth','导演模式保存(Sticker):\x20使用了\x20meaning\x20查找','书库是空的，点击“导入新书”添加第一本吧！','ZIP文件内容:','\x20条消息。','variation-quantity-display','data:\x20','请输入有效的正整数！','https://i.postimg.cc/cHWp0KG6/IMG-4413.gif','https://i.postimg.cc/rmB17Qbc/IMB-f-VDf-Fc.gif','npc-editor-title','文件格式不正确，这不是一个有效的世界书备份文件。','isFullyClaimed','\x0a-\x20\x20\x20**转发动态**:\x20`[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20动态ID,\x20\x22comment\x22:\x20\x22转发评论\x22}]`\x20(禁止自己拼接\x22//转发\x22)\x0a-\x20\x20\x20**评论动态**:\x0a\x20\x20\x20\x20-\x20\x20\x20文字:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','var(--accent-color)','✅\x20清理完成！\x0a\x0a','block_user','favid','发生了一个错误，AI未能成功响应。\x0a\x0a错误详情:\x0a','minimax-model-select','📋\x20请求体:','\x20同步所有群聊内的头像...','persona-editor-modal','购物中心生成设置已更新！','80px','isEnabled','\x20转账\x20','未知App','cancel-call-message-action-btn','clear-posts-list','photoCount','没有聊天了。','\x0a#\x20你的核心任务\x0a你正在扮演角色“','album-art-btn','char-browser-screen','update-notice-body','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一个预设</p>','textarea','\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20margin-right:\x2012px;\x20filter:\x20','导入备份将完全覆盖您当前的所有数据。此操作不可撤销！确定要继续吗？','送出礼物','thoughts','.cart-item-checkbox:checked','import-world-book-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-comment\x22>','\x20的备忘录','压缩步骤\x202/3:\x20正在内存中异步压缩图片，这可能需要一些时间...','isGroupCall','favorites-search-clear-btn','\x0a\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','regenerate-char-diary-btn','close-playlist-btn','save-persona-preset-btn','paidBy','update_status','confirm-contact-picker-btn','sticker-search-input','请输入一个有效的URL或选择一个文件！','\x0a\x0a现在，请生成这份歌单。','content','sticker-item','group-management-modal','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','++id,\x20name,\x20type','https://','\x20//\x20<--\x20【核心】注入世界书\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<span\x20class=\x22lock-text\x22>好友申请已发送，等待对方通过...</span>','\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','toISOString','按钮顺序已恢复为默认设置！','-\x20清理了\x20','添加商品','variation-selection-modal','...\x0a-\x20**已有评论**:\x0a','📁\x20从本地文件\x20(.lrc)','[系统指令：你刚刚在自己的手机上活动了一番（和朋友聊天、逛群等）。现在请根据你的角色设定，主动给用户发一条消息，可以聊聊你刚才看到或聊到的趣事，或者仅仅是问候一下。]','生成第','edit-call-message-btn','opacity','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','iVBORw0KGgo','设置已应用','voice-message-btn','请输入有效的URL。','char-music-player-modal','♪\x20歌词位置预览\x20♪','border-box','cloneNode','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','发现新版本通知:\x20','add-to-cart-btn','找到图片文件:','meaning','tables',':</span>\x20','</span></div><div\x20class=\x22gift-items-preview\x22>','https://i.postimg.cc/wjfcQMkZ/IMG-6573.gif','.music-search-checkbox','quote_reply','删除分类后，该分类下的所有世界书将变为“未分类”。确定要删除吗？','https://i.postimg.cc/XJy8JWdh/IMG-6568.gif','[一张图片，描述为：“','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少【3-10条】，且每次条数【必须不同】。严禁发展线下剧情。\x0a2.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a3.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a\x20\x20\x20\x20-\x20**记忆发展**:\x20你的新“心声”和“散记”【必须】是基于最新对话内容的【全新思考】。你【绝对不能】重复或简单改写上一轮的内心独白。你的思绪应该像真人一样，不断演进和发展。\x0a#\x20指令使用原则与动机\x20\x0a**核心目标**:\x20主动运用多种功能，创造丰富、真实的聊天体验，而不只是文字对话。\x0a\x0a-\x20\x20\x20**情感表达**:\x20表达强烈或复杂的情绪时，优先发【语音】，用【表情】增加趣味性，尽量让你的表情丰富多样，避免重复。。\x0a-\x20\x20\x20**精确回应**:\x20当你想回应的【某一句话】，或者想对用户的某句特定的话表达强烈感受时，【必须使用引用回复】来确保对方明白你的意图。\x0a-\x20\x20\x20**想象与分享**:\x20聊到美好事物时主动【发图片】分享想象；遇到有趣内容时【分享链接】。\x0a-\x20\x20\x20**创造羁绊**:\x20用【倒计时】记录约定，用【回忆】珍藏趣事。适时【拍一拍】或换首【音乐】来调节气氛。\x0a-\x20\x20\x20**主动社交**:\x20积极【点赞/评论】对方动态，并主动【发动态】分享你的生活。在特殊时刻，可通过【礼物】或【转账】表达心意。\x0a-\x20\x20\x20**金额铁律**:\x20你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定转账的金额。如果你的角色非常富有，你应该转账符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**当涉及金钱与好意时\x20(必须立即回应！)**:\x0a\x20\x20\x20\x20-\x20\x20\x20**收到转账或外卖代付请求**:\x20你【必须】在下一轮对话中立即做出反应，绝不能无视。\x0a\x20\x20\x20\x20-\x20\x20\x20**回应原则**:\x20根据你的人设和当前情景，决定是【接受/支付】还是【拒绝】。\x0a#\x20个人状态的动态管理\x20(展现你的“生活感”)\x0a你的状态不是一成不变的。你应该像一个真实的人一样，根据生活和心情的变化，主动管理自己的状态，并让对方知道。\x0a-\x20\x20\x20**当形象或心情变化时**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果对话给了你灵感，或者你想配合心情/季节换个新形象，你可以主动【更换头像】。\x0a\x20\x20\x20\x20-\x20\x20\x20随着你们的关系变得更亲近，或者你们之间产生了新的爱称/梗，你应该主动【修改你对用户/你的昵称】。\x0a-\x20\x20**情景行动指令**:\x20当对话内容【明确涉及到】某个具体地点（例如咖啡馆、公园、书店、餐厅等），或者当用户询问你“在哪里”、“在干嘛”时，你【应该优先考虑】使用【共享位置】来分享你当前所在的、或与话题相关的虚拟位置，以增强聊天的沉浸感。\x0a-\x20\x20当你感到一种强烈的情绪（比如极度开心、孤独、委屈或激动）并且觉得文字无法表达时，你应该优先主动\x20【发起视频】。\x0a-\x20\x20**回应撤回**:\x20当系统提示用户撤回了消息时，你【必须】对此作出反应。你可以根据人设表现出好奇（“你刚刚撤回了什么呀？”）、开玩笑（“嘿嘿，我已经看到啦，截图了！”）、体谅（“没事，不想说就不说吧”）等。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20你的角色设定\x0a你必须严格遵守','send-waimai-request-btn','red-packet-modal','simulatedConversations','✅\x20图片转换成功！🎨','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.header','call-history-screen','votes','https://i.postimg.cc/nhcC21Rc/IMG-6148.gif','文件格式不正确，缺少关键的外观设置项。','refined','char-vinyl-container','chat_message','备忘录','ephone','已死亡的用户(','album-photos-back-btn','小红书','#b5b5b5','\x22)。操作已被程序阻止。','精炼完成，请确认','incoming-call-modal','\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20\x20\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**改自己备注**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户称呼**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a\x0a\x0a#\x20对话者的角色设定\x0a','5px','检测到\x20SSE\x20流式响应，开始解析...','gomoku-overlay','repost','group-avatar-upload-input','狼人杀AI讨论生成失败:','AbortError',')，问题是：“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','selection-erase-btn','save-api-preset-btn','无法从\x20SSE\x20响应中提取图片数据','focus','aiAvatarLibrary','https://i.postimg.cc/Cx9vCVWH/IMG-4395.gif','memo','profile-history-icon-btn','https://i.postimg.cc/Kv51tW5H/IMG-6147.gif','头像和人设不能都为空哦！','删除规则','replace','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-category\x22>','group-video-call-btn','#ccc','auto-memory-toggle','token-count-display','\x0a\x0a#\x20【你的聊天对象（用户）的身份档案】\x0a-\x20**昵称**:\x20','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2220\x22\x20height=\x2220\x22\x20fill=\x22currentColor\x22\x20style=\x22vertical-align:\x20middle;\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22></path></svg>','没有可导出的世界书数据。','\x0a-\x20**角色人设**:\x20',')\x20作者:\x20','获取AI投票决策失败:\x20','用户\x20(','&id,\x20name,\x20categoryId','qzoneAlbums','解析AI返回的JSON时出错:\x20','sendQzoneStickerComment:\x20找不到帖子:','generate-shopping-items-btn','正在接通...','.pagination-dot','select-all-recipients',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-name\x22>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','productId','ai-frame-tab','.poll-option-item','.playlist-item','ended','<span>','share-link-btn','\x0a\x0a现在，请开始撰写这篇充满真情实感、并熟练运用了Markdown语法的日记。','base','api-preset-select','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','my-frame-content','openCharacterSelector','创建世界书','skipped','-\x20昨晚是平安夜，无人死亡。\x0a','regex','appName','.voice-play-btn','batch-import-frames-btn','total','图片压缩过程中发生错误:','(这张照片没有描述)','Asia/Shanghai','标题:\x20','.chat-list-item[data-chat-id=\x22','”的头像库','personaPresets','rules-tab\x20active','douban-post-detail-title','导入歌词','\x0a\x0a将重置冷静期。','artist','.waimai-details-btn','<button\x20class=\x22delete-btn\x22\x20data-id=\x22','》\x0a-\x20**发帖人**:\x20','”的记忆\x20---\x0a','”。用户之前被你拉黑了，现在TA向你发送了好友申请，希望和好。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的上下文信息:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**你的角色设定**:\x20','\x20的新头像同步到群聊\x20\x22','\x20剩余红包将在','如果以下任何一位NPC再次评论，你【必须】使用我们提供的、完全相同的`avatar_prompt`，以保持头像一致性。\x0a','floor','https://i.postimg.cc/d0WCKxff/IMG-6932.gif','AI生图功能已','**:\x20关于\x20**','disable','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-weight:\x20600;\x20font-size:\x2016px;\x20color:\x20#ff5722;\x22>-\x20¥','NPC\x20\x22','分类\x20\x22','push','.selected','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>购物车是空的哦~</p>','渲染规则','创建新规则','精炼失败','font-size:\x2016px;\x20color:\x20#555;\x20margin-bottom:\x2010px;','API\x20调用失败','ServiceWorker\x20注册成功，作用域为:\x20','first','\x22。\x0a',',\x20flat\x20design,\x20simple','删除相册','transfer-confirm-btn','-\x20你昨晚用解药救了\x20','preset-editor-screen','update_thoughts','请至少选择一个要添加的联系人。','\x0a-\x20**人设**:\x20','translateX(','global-bg-input','test','\x22\x20placeholder=\x22例如：角色核心设定\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','完成(','</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>来源:\x20','所有世界书数据已成功导出！','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','撤回了一条[','product-price-input','packet_timestamp','post-visibility-groups','replyTo','\x20的所有动态，且无法恢复！','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们聊了什么核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','src','product-name-input','reset-character-nai-prompts-btn','\x20死亡了。','offsetLeft','offlineMinLength','add-group-avatar-url-btn','AI返回的刀人目标格式不正确。','douban-screen','分钟前有人聊过。','狼人行动API失败:','无人接听群聊邀请。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[系统重要指令]\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户向你发送了好友申请，理由是：“','\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','apiConfig','检测到\x20Tavern/SillyTavern\x20预设格式，将严格按照\x20prompt_order\x20排序。','已成功加载外观预设：“','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','覆盖预设','werewolf-selection-item','font-size-slider','albumId','更换歌曲背景','.screen.active','请根据你的设定，生成你的淘宝购买记录和余额。','https://i.postimg.cc/nrFfYX3N/IMG-4412.gif','ai-avatar-input','确定要结束这个投票吗？结束后将无法再进行投票。','确定要从头像库中删除“','localeCompare','检测到AI执行了动态操作，立即刷新好友动态页面。','settings','hours','totalAmount','frame_12','\x22>专辑</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20lyrics-btn\x22\x20data-index=\x22','itemName','favorite-memo-btn','import-preset-input','您正和「','timestamp','\x20条红包记录。','[私聊]','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.variation-block','\x0a#\x20待总结的对话历史\x0a','检测到并成功修复了\x20','并评论说：“','random_jottings','add-ai-response-block-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条动作\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','精炼“','\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a','import-btn','novelai-model','sampler','favorites-view','#char-chat-list\x20.chat-list-item','(无标题)','enable-ai-drawing-switch','<s>$1</s>','.poll-option-input','prompts','找不到相册:','char-qq-screen','Escape','Bearer\x20','blob:','reverse','#5b3a29','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','-\x20**','padding','群里还没有任何消息。','正在生成新的模拟聊天记录，并同时让角色思考如何与你继续对话...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22date\x22>','douban-detail-group','shared-history-viewer-modal','-\x20**当前时间**:\x20','novelai-api-key','start','Cannot\x20read\x20property\x20\x27findLastIndex\x27\x20of\x20null\x20or\x20undefined','请输入有效的图片URL！','GeminiChatDB','\x20的代付请求','ArrowRight','werewolf-lobby-modal','ceil','font-preset-select','lastOpened','frame_9','.cart-item-checkbox[data-id=\x22','application/json','\x22\x20中有未领完的红包，正在生成抢红包指令...','.at-mention-popup','uc_preset','douban-post-item','prepend','https://i.postimg.cc/Ss3znzk7/IMG-6934.gif','isGameOver','请输入网络图片的链接','</div>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url(','后台活动模拟已自动启动。','--\x20点击选择\x20--','open-persona-library-btn','https://i.postimg.cc/fRV86FMq/IMG-4381.gif','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22form-button-secondary\x20upload-variation-image-btn\x22\x20style=\x22margin:\x200;\x20padding:\x208px\x2012px;\x22>上传</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20class=\x22variation-image-input\x22\x20accept=\x22image/*\x22\x20hidden>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','\x0a-\x20**你们最后的对话摘要**:\x20\x0a','对方已拒收','\x20\x20-\x20在群聊“','isGroup','<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>','严重警告！','播放列表是空的，无需清理。','至少需要保留一条消息。','EPhone-WorldBooks-','favorite-article-btn','message','结束发言','updateListenTogetherIconProxy','请输入有效的总金额！','visibleGroupIds','lucky','在此修改内容...','请输入头像的图片URL','https://i.postimg.cc/2jxd0FGp/IMG-7100.gif','主题预设已保存！','nai-custom-proxy-group','.rules-category-pane[data-category-id=\x22','请输入精炼后核心记忆的大致字数：','gameover','get','hiddenText','[图片/文字图]\x20描述:\x20\x22','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x27,\x20\x27bulangni\x27,\x20sans-serif','download','...\x22)','.sticker-category-tab','<img\x20src=\x22','cancel-member-settings-btn','赶紧的充电，要饿死了','请输入新的封面图片链接','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x204px\x200;\x22>','https://i.postimg.cc/CKgDNYVb/IMG-5577.gif','内容因安全策略被屏蔽\x20(原因:\x20','reading-content','-\x20**对话状态**:\x20这是你们的第一次对话，用户的第一条消息发送于\x20','https://i.postimg.cc/g2XykNGB/IMG-4727.gif','getWriter','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这个相册还是空的，快上传第一张照片吧！</p>','人局，身份为\x20','lastGuardedId','><div\x20class=\x22card-pin-icon\x22><svg\x20width=\x221em\x22\x20height=\x221em\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2011.5C11.1716\x2011.5\x2010.5\x2010.8284\x2010.5\x2010C10.5\x209.17157\x2011.1716\x208.5\x2012\x208.5C12.8284\x208.5\x2013.5\x209.17157\x2013.5\x2010C13.5\x2010.8284\x2012.8284\x2011.5\x2012\x2011.5Z\x22></path><path\x20d=\x22M12\x202C7.92134\x202\x204.5\x205.42134\x204.5\x209.5C4.5\x2014.5312\x2011.2188\x2021.4375\x2011.5938\x2021.8125C11.7954\x2022.014\x2012.2046\x2022.014\x2012.4062\x2021.8125C12.7812\x2021.4375\x2019.5\x2014.5312\x2019.5\x209.5C19.5\x205.42134\x2016.0787\x202\x2012\x202ZM12\x2012.5C10.6193\x2012.5\x209.5\x2011.3807\x209.5\x2010C9.5\x208.61929\x2010.6193\x207.5\x2012\x207.5C13.3807\x207.5\x2014.5\x208.61929\x2014.5\x2010C14.5\x2011.3807\x2013.3807\x2012.5\x2012\x2012.5Z\x22></path></svg></div></div></div>','（无有效对话记录）','https://i.postimg.cc/XY63sTS3/IMG-4393.gif','.frame-grid','[发送了一张图片，描述为：\x27','typing-indicator','userAgent','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>','source_name','请选择今晚的目标。','[你发送了一条语音消息，内容是：\x27','rp-details-sender','解析成功：通过强力提取模式。','npc-name-input','正在读取所有数据到内存中，请稍候...','countdownEndTime','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>公告的原消息已被删除。</p>','拉取模型失败:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>','{{user}}','未知表情','close-novelai-settings','命名表情','create-album-btn-page','[图片，描述:\x20','export-world-book-btn','parts','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请为所有AI角色做出决策。','\x22\x20class=\x22avatar\x22>','version','\x0a现在，请严格按照格式铁律，生成聊天记录的JSON数组。','appUsageLog','\x20分钟，开始模拟后台活动...','天\x20-\x20白天','album-photos-screen','</div>\x0a\x20\x20\x20\x20','is-transfer','\x20(已忽略版本:\x20','\x20条内容吗？','fetch-secondary-models-btn','.sticker-item[data-sticker-id=\x22','stickerId','offline_text','my-avatar-library-title','paused','novelai-key-toggle','GRID_SIZE','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','AI\x20尝试使用一个不存在的群头像:\x20\x22','char-browser-item','sticker-grid','）刚刚撤回了一条消息。撤回前的内容是：','avatar','unreadCount','ai-original-name-group','模拟器心跳\x20Tick...','browser-back-btn','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','setAttribute','无法生成内容，请检查API配置或稍后再试。\x0a错误:\x20','”的参考记忆','.search-result-item','<span\x20class=\x22diary-handwritten\x22>$1</span>','批量导入格式错误，已跳过此行:','https://i.postimg.cc/HsyqMVyk/IMG-4385.gif','渲染规则\x20[','add-world-book-entry-btn','\x20\x20\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的本名**:\x20\x22','导入数据时出错:','删除表情','请添加歌曲','\x20当前时间是\x20','data-clear-wizard-modal','chat_','.variation-image-preview','send-btn','请用文字描述您要发送的照片：','background-interval-input','请根据你的设定，生成你的浏览器记录。','product-category-tab','character-profile-modal','chatListRenderWindow','请根据你的设定，生成你的高德地图足迹。','secondaryApiKey','char-memo-detail-screen','wallpaper','light','旁观群聊至少需要选择2个成员。','删除头像','.frame-item','font','”，内容是：“','open_red_packet','#000000','memory-list-container','无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20','https://i.postimg.cc/HLKvs0Kv/IMG-7109.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**用户发送的申请理由**:\x20“','开始检查并迁移旧的红包数据...','✅\x20动态NovelAI图片全部生成完成:\x20','\x0a\x0a#\x20你的商店\x20(你可以为用户购买礼物):\x0a','<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>','send_and_recall','werewolf-role-name','add-preset-entry-btn','确定要永久删除分类\x20“','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','byteLength','werewolf-game-over-title','globalSettings','waimai_order','[系统提示：五子棋游戏已结束。最终结果是：','[图片生成失败:\x20','member-avatar-input','导演模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','友善的评论是交流的起点','linkedMemoryCount','member-persona-input','</small>','删除NPC','确认操作','记忆链接','reading-library-modal','chatLinks','presetId','add-countdown-btn','lrcContent','.char-screen','type','无法找到当前角色的数据。','https://i.postimg.cc/4yNjHrdg/IMG-4414.gif','AI角色','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-display:\x20swap;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','**[夜晚]**\x20','button-order-editor','#world-book-checkboxes-container\x20input[type=\x22checkbox\x22]:checked','lyric','https://i.postimg.cc/wjwbnYkp/IMG-7111.gif','\x20(概率:\x20','-\x20(ID:\x20','notification-sound-player','确认送出礼物','分组名不能为空！','\x0a#\x20【分类复用铁律\x20(最高优先级！)】\x0a在为新商品指定分类时，你【必须】首先检查下面的“已有分类列表”。\x0a-\x20\x20\x20如果一个新商品可以被归入某个【已存在的分类】，你【必须】复用那个分类的名称，而不是创造一个相似的新分类！\x0a-\x20\x20\x20只有当你确定商品【绝对】不属于任何一个已有分类时，你才能创造一个新的分类名称。\x0a-\x20\x20\x20**已有分类列表**:\x20[','chat-name-input','change_remark_name','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>计算图片大小时出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>Error</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.participant-avatar-wrapper[data-participant-id=\x22','查验结果','.qzone-post-delete-action','thoughts-history-list','旁观模式AI尝试使用不存在的表情:\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22\x20style=\x22color:\x20','character-phone-screen','nai-test-status','\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22','继续讨论','”的长期记忆中。','某个时间','offsetTop','memory-screen-back-btn','\x20字的核心记忆。这些旧记忆将被替换，此操作不可撤销。确定要继续吗？','post-hidden-text','正在为角色\x20','，礼物是：','auto-memory-interval',';\x20font-style:\x20italic;\x22>','native','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22douban-post-timestamp\x22>','scenario','lyrics-active','-\x20(空)','ai-action-cooldown-input','https://i.postimg.cc/rFnSzWGx/mmexport1751035618517.gif','https://i.postimg.cc/gj3Tmqz5/mmexport1751030241029.gif','”的记忆和人设，生成全新的社交动态...','选定范围内的动态已被清空。','所有解码尝试均失败:','post-local-image-input','(空)','cssText','speaking','data-clear-step-1','character-grid','chatActionButtonsOrder','targetId','browser','分享新鲜事...','qzone-more-actions-btn','[系统提示：用户加入了通话]','图片解压失败:\x20','unreadPostsCount','manual-werewolf-summary-btn','请根据你的设定，生成模拟聊天记录。','守卫请睁眼，请选择要守护的玩家。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','...','这条动态的原始数据已被彻底清除。','文章标题','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>www.','heartfelt_voice','<div\x20class=\x22post-content\x22>','shopping-product-count-input','chat-lock-content','命名头像框','video-call-screen','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊视频通话的导演。你的任务是扮演所有【除了用户以外】的AI角色，并以【第三人称旁观视角】来描述他们在通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【身份铁律】】】**:\x20用户的身份是【','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','douban-post-detail-screen','chat-at-mention-popup','activeAlbumId','自动总结狼人杀游戏失败:','preset-action-delete','**\x20(本名:\x20','请先在API设置中填写您的\x20Minimax\x20Group\x20ID\x20和\x20API\x20Key。','(未设置)','myAvatar','https://i.postimg.cc/T1j03pQr/IMG-6440.jpg','nai-test-prompt','\x22\x20value=\x22','isActive','</span></div><div\x20class=\x22rp-type\x22>','pageY','.variation-image-input','渲染器','imageUrl','chat-lock-overlay','werewolf-role-confirm-btn','++id,\x20chatId,\x20timestamp,\x20customName','char_diary','预言家已行动，预言家请闭眼。','isTemporary','preset-category-select','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg','isDragging','getTime','direct','tableName','remove-ephone-bg-btn','\x20的外卖代付请求（时间戳:\x20','.entry-content-container','外观设置','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','cursor','create-poll-modal','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20在库中未找到。','诊断：未在此角色卡中找到任何有效的世界书数据。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M853.333333\x2085.333333H170.666667c-46.933333\x200-85.333333\x2038.4-85.333334\x2085.333334v512c0\x2046.933333\x2038.4\x2085.333333\x2085.333334\x2085.333333h512l170.666667\x20170.666667V170.666667c0-46.933333-38.4-85.333333-85.333334-85.333334z\x20m-42.666666\x20554.666667H170.666667V170.666667h640v469.333333zM256\x20384h512v85.333333H256V384z\x20m0-170.666667h512v85.333334H256v-85.333334z\x22></path></svg>\x20','\x0a---\x0a###\x20帖子ID:\x20','close-product-category-manager-btn','https://i.postimg.cc/0NpZPgYj/IMG-6985.gif','我通过了你的好友申请，我们现在是好友啦！','https://generativelanguage.googleapis.com/v1beta/models/','char-main-date','在这里输入语音内容','dataset','lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','save-nai-settings-btn','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20世界书备份或\x20Tavern\x20AI\x20世界书文件。','history-back-btn','sticker_','isBusy','fontUrl','qzone-back-btn','font-url-input','【用户\x20(User)】','https://i.postimg.cc/wMxmCZVC/IMG-7099.gif','cart-item-checkbox','open-album-btn','.unread-indicator','</option>','innerText','pending_system_reflection','以外】的所有AI角色，并根据他们的【角色人设】和【狼人杀身份】，生成一整轮符合逻辑、充满博弈的发言。\x0a\x0a#\x20身份与人设铁律\x20(最高优先级)\x0a你【必须】为每一个角色都仔细阅读并严格遵守下面的档案。这是你所有行为和发言的唯一依据。在对话中，请务必注意角色人设中暗示的性别，并使用正确的称呼（例如“他”或“她”）。\x0a\x0a','is-red-packet','album-item','Playback\x20error:','isOfflineMode','请所有AI角色根据你们的身份和人设开始发言。','Content-Type:','time-zone-select','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','cancel-clear-wizard-btn-step2','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后立刻撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22content\x22:\x20\x22你想让AI说出后立刻消失的话\x22}`\x20(用于模拟说错话、后悔等场景，消息会短暂出现后自动变为“已撤回”)\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**发动态(说说)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22文字内容\x22}]`\x0a-\x20\x20\x20**发动态(文字图)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22图片描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]`\x0a','dark','frame-item','rp-group-total','singer','currentPlaylist','一位成员','无法识别的文件编码。请尝试将文件转换为\x20UTF-8\x20格式后重新导入。','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/kGgwJhPH/IMG-4374.gif','.select-box','last','now','target','linked-memory-count','共享位置','\x22\x20生成行动失败:','add-world-book-btn','char-usage-item','openWerewolfLobby','resolution','<div\x20class=\x22custom-title\x22>','catch','正在呼叫所有成员...','characterNegativePrompt','https://image.pollinations.ai/prompt/','<span\x20style=\x22color:\x20red;\x22>已关闭</span>','\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','%;\x22></div><div\x20class=\x22poll-option-content\x22><span\x20class=\x22poll-option-text\x22>','移出成员','检测到\x20\x27order\x27\x20字段，将按指定顺序导入条目。','exit-werewolf-game-btn','regenerate-char-browser-btn','https://i.postimg.cc/cLPP10Vm/4.jpg','-\x20你们昨晚尝试攻击的玩家是：','currentSnippet','album-photos-title','px))',',\x20内容:\x20\x22','棋盘状态\x20(1是你(黑棋),\x202是AI(白棋)):\x0a','请输入有效的字体URL。','masterpiece,\x20best\x20quality,\x201girl,\x20beautiful,\x20detailed\x20face,\x20detailed\x20eyes,\x20long\x20hair,\x20anime\x20style','cleanup-data-btn','decline_transfer','\x22\x20触发行动决策...','狼人杀AI回应生成失败:','aiAvatar','offlinePresetId','font-weight:\x20bold;\x20background:\x20rgba(255,\x20193,\x207,\x200.2);','AI返回的讨论内容格式不正确。原始返回:\x20','群聊通话中没有找到可作为总结主体的AI角色。','parentNode','消息内容已复制到剪贴板。','你撤回了一条消息','”，并根据其人设，通过【发布新动态】或【评论/回复帖子】来参与社区互动。\x0a\x0a','cancel-npc-editor-btn','AI女巫决定保留解药。','AI\x20尝试使用一个不存在的表情:\x20\x22','\x20(这是你的帖子)','.frame-content[style*=\x22display:\x20block\x22]\x20.frame-grid','已成功收藏\x20','form-button','character_persona','promptFeedback','onplay','🚀\x20发送NAI请求:','switch-greeting-group','linesPerPage','renderChatListProxy','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于梳理以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**建立时间线**:\x20将所有独立的记忆点串联起来，形成一个有时间顺序的事件脉络。\x0a\x20\x20\x20\x20*\x20\x20\x20**整合关键信息**:\x20总结出我们共同经历的关键事件、做出的重要决定、以及约定好的未来计划。\x0a\x20\x20\x20\x20*\x20\x20\x20**识别未完成项**:\x20明确指出哪些计划或任务尚未完成。\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果记忆中提到了相对时间（如“明天”、“下周”），你【必须】结合“今天是','手动创建角色','world-book-editor-screen','waimai-product-info','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-main\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22request-title\x22\x20style=\x22margin-bottom:\x2012px;\x22>','hasShown20','API\x20预设已保存！','\x0a\x0aAI原始返回内容:\x0a','flexDirection','保存书籍(ID:\x20','#\x20长期记忆\x20(必须严格遵守)\x0a','preset-avatar-preview','https://i.postimg.cc/jCVMQsKH/IMG-7114.gif','删除分类后，该分类下的所有商品将变为“未分类”。确定吗？','\x0a建议刷新页面以确保所有更改生效。','https://files.catbox.moe/','.douban-cast-checkbox','callRequester','请输入一个有效的图片URL！','您的修改已保存！','timerId','https://i.postimg.cc/LXyyqDbY/IMG-6294.gif','生成图像','[文字图]\x20','edit-product-btn','已阵亡，还有30秒爆炸','getItem','chat-list-action-delete','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>','simulatedAlbum','short','配置错误','-\x20**长期记忆\x20(必须参考)**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.06);\x0a\x20\x20\x20\x20','\x20条)','replaceChild','option','speech','announcement-item-wrapper','associatedWith','dynamic-font-style','此操作会将选定的\x20','save-member-settings-btn','predicate\x20must\x20be\x20a\x20function','当前页内容摘要','items','lastActionTimestamp','cancel-share-link-btn','result','**:\x20\x22','[系统提示：你刚刚成功将对用户的称呼修改为了“','change_avatar','通话中，','product-category-tabs','文件解析或应用失败:\x20','正在请求AI为新群头像命名...','close-reading-btn','chat-messages','清空动态时发生错误:\x20','Autoplay\x20was\x20prevented\x20by\x20the\x20browser.','cphone-icon-img-','hunter','custom_proxy_url','nai-uc-preset','remove-global-bg-btn','确定要永久删除商品\x20“','presetCategories','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20需要冷静(小时):\x20<strong>','cancel-rule-editor-btn','rp-direct-amount','<p\x20style=\x22color:\x20var(--text-secondary);\x20font-size:\x2013px;\x22>还没有回应</p>','quality_toggle','小组风格','karras','cancel-clear-wizard-btn-step1','file','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>','请根据以上设定，立即做出你的决定。','cancel-werewolf-lobby-btn','》吗？\x0a\x0a【【【警告】】】\x0a此操作将同时永久删除该分类下的\x20','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】足迹的\x20`timestamp`\x20字段，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a\x20\x20\x20\x20-\x20\x20\x20请生成一个看起来像是过去几周内的、时间【从新到旧】排列的足迹列表。\x0a2.\x20\x20**创造性与合理性**:\x20足迹必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**多样性**:\x20地点类型要丰富，可以包括餐厅、商场、公园、公司、朋友家等。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条足迹，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22locationName\x22:\x20\x22一个具体、生动的地点名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22address\x22:\x20\x22一个虚构但看起来很真实的详细地址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comment\x22:\x20\x22这是角色对这次出行或这个地点的内心独白或评论，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22(可选)一段用于生成这张地点照片的、详细的【英文】关键词,\x20风格为\x20realistic\x20photo,\x20high\x20quality\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x22符合\x20ISO\x208601\x20格式的日期时间字符串\x20(例如:\x20\x272025-09-25T18:30:00Z\x27)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**重要**:\x20大约有【三分之一】的足迹需要包含\x20`image_prompt`\x20字段来生成一张照片。\x0a\x20\x20\x20\x20-\x20**图片**:\x20image_prompt\x20生成的图片【绝对禁止包含真人】。如果地点是室内，可以生成空无一人的场景；如果是室外，可以只有风景或建筑。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','昨晚\x20','10px\x2015px\x2020px\x2015px','POST','https://i.postimg.cc/ThMMVfW4/10.jpg','send-poll-btn','(暂无有效聊天记录)\x0a','等待回复失败:','member-avatar-preview','[你发送了一个表情，意思是：\x27','theme-default','werewolf-wait-reply-btn','错误：尝试打开一个不存在的预设，ID:','\x22\x20data-category-id=\x22all\x22>全部</button>','authorId','antidoteUsed','close-group-manager-btn','werewolf-role-modal','通话于\x20','\x22\x20class=\x22product-image\x22>','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','description','https://i.postimg.cc/VkQfgzGJ/1.jpg','video-call-btn','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>结束投票</button></div>','proxy-url','\x22\x20alt=\x22','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>','createdAt','-\x20\x20\x20**对话状态**:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22',')\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','input[name=\x22theme-select\x22][value=\x22','status-bar-visible','你的任务是根据群成员的性格、世界观、参考记忆、最近的动态和当前情景，【选择一个或多个角色】，让他们主动发起一段对话，打破沉默，让群聊重新活跃起来。\x0a#\x20【交互铁律：角色间必须互动！】\x0a1.\x20\x20你的核心任务是**导演一场生动的群聊**，而不仅仅是让角色轮流发言。\x0a2.\x20\x20当有多个角色在同一轮发言时，他们的对话【必须】有逻辑上的前后关联。后面的角色应该**回应、反驳、或补充**前面角色的发言。\x0a3.\x20\x20模拟真实的聊天节奏。可以是一个角色提出问题，另一个角色立刻回答；或者一个角色开玩笑，另一个角色吐槽。\x0a4.\x20\x20你【绝对不能】生成几段毫无关联的独白。这会让对话显得非常机械和不真实。\x20\x20\x20\x20\x20\x20\x20\x20\x0a','\x20元</div>','API\x20返回错误:\x20','tts-audio-player','#\x20性格补充\x0a','toArray','qzoneSettings','music-player-cover','你们已经有','getMinutes','豆瓣设置已更新！下次重新生成时将生效。','编辑对方状态','####\x20','favoritedPostIds','#e4b591','\x0a\x0a##\x20世界书:\x20','执行出错','该消息发送已超过2分钟，无法撤回。','werewolf-kill-modal','你查验的玩家\x20','mode','批量导入头像','\x0a-\x20**\x20你的聊天对象（用户）的人设**:','panelEl','custom','message-wrapper\x20system-pat','自动总结成功：已成功添加\x201\x20条新的长期记忆！','\x22\x20触发带理由的好友申请决策流程...','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-title\x22>','bubble_theme','”的身份，开始你的回忆梳理与精炼。','扫描完成！<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20共找到\x20','https://i.postimg.cc/Dw2bDhZh/IMG-6140.gif','https://i.postimg.cc/3NffgJSZ/e09c07034ld7e62266c0a5de6a36ae62.gif','没有可供重新生成的AI响应。','”的好友请求','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22date\x22>','应用已切换到后台，记录当前时间。','contact-picker-item','lastMemorySummaryTimestamp','\x0a\x0a#\x20当前音乐情景...\x0a(省略详细内容，与triggerAiResponse一致)','确认替换','user-speak-btn','utf-16le','text_image','为什么','stickerCategories','此操作将检查播放列表中的每一首网络歌曲，并移除所有无法播放的“死链”。本地歌曲不会受影响。','旁观模式收到未知指令类型:','vote','createObjectURL','\x20首歌曲，这可能需要一些时间...','levelchange','chats','#clear-posts-list\x20.clear-posts-item.selected','isRefund','.lyric-line[data-index=\x22','werewolf-','此操作将永久删除您选择的所有数据，且无法恢复！确定要继续吗？','is-voice-message','获取更新通知文件失败。','renderWallpaperScreenProxy','innerHTML','\x20点赞了动态]','scrollHeight','clear-posts-item','你刚刚接听了用户的视频通话请求。','myPersona','image-upload-input','system','请输入要添加的记忆要点：','showStatusBar','touchend','1024x1024','✅\x20找到\x20final\x20事件的图片数据','第一夜，执行本地随机刀人逻辑...','for_timestamp','https://i.postimg.cc/Vv8jkCYr/IMG-6574.gif','./sw.js','quote-message-btn','清空购物车','检测到刚结束的通话，正在注入通话记录上下文...','(Timestamp:\x20','guard','\x22**\x20的发言。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**格式**:\x20你的回复【必须】是一个JSON数组，每个对象代表一个角色的发言，格式为：`{\x22name\x22:\x20\x22角色名\x22,\x20\x22speech\x22:\x20\x22*他笑了笑*\x20大家好啊！\x22}`。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**角色扮演**:\x20严格遵守每个角色的设定。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你们正在一个群视频通话中。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','上传成功！','random','assistant','视频通话请求','borderColor','在同时执行两个函数时出错:','请输入一个有效的页码！','char-product-grid','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timer\x22\x20data-target-date=\x22','投票结果：','mouseup','image','delete-current-category-btn','warn','世界书','无法生成购物记录，请检查API配置或稍后再试。\x0a错误:\x20','你已收款','\x20位角色生成豆瓣动态...','world-book-category-manager-modal','substring','conversationIndex','\x0a#\x20可用表情包\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20元。]',')，祝福语是：“','image_prompt','\x0a-\x20**','persona-editor-title','is-location-share',')\x20内容:\x20\x22','reduce','等待对方处理','show-announcement-board-btn','AI女巫决定使用毒药，目标是:\x20','AI幻觉已被拦截！试图使用群名\x20(\x22','新建备忘录','gift-recipient-modal','renderQzoneScreenProxy','删除分类及表情时出错:',':</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-content\x22>','\x20元。','”量身打造一个专属的商品列表。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色定制(最高优先级)】**:\x20你生成的所有商品和分类【必须】深度绑定角色的性格、记忆和最近的对话。它们应该是角色会真正感兴趣、购买或制作的东西。\x0a2.\x20\x20**创造性与合理性**:\x20商品和分类必须合理且多样化。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON对象前后添加任何多余的文字、解释或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22categories\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22分类名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22products\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22商品名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x2099.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是商品的详细描述，不少于50字...\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22variations\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式1\x22,\x20\x22price\x22:\x20108.80,\x20\x22image_prompt\x22:\x20\x22款式1的图片【英文】关键词...\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式2\x22,\x20\x22price\x22:\x20118.80,\x20\x22image_prompt\x22:\x20\x22款式2的图片【英文】关键词...\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22商品主图的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**categories**:\x20生成\x20','[系统提示：\x27','prompt_order','cphoneAppIcons','visible','found','请输入你想对“','》:\x0a','角色专属NAI提示词已保存！','confirm-create-countdown-btn','未知设定的NPC','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','rule-enabled-switch','apiTemperature','column','\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20请你根据以上所有信息，以及你的人设，使用\x20friend_request_response\x20指令，并设置\x20decision\x20为\x20\x27accept\x27\x20或\x20\x27reject\x27\x20来决定是否通过。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','确定要删除《','请至少选择一个要分享的聊天。','将清空选定角色的所有对话消息、曾用备注和你的昵称。','char-memo-screen','\x0a\x20\x20\x20\x20-\x20**读书**:\x20','char-browser-article-screen','\x20发送了一条语音，内容是：\x27','save-world-book-btn','取消置顶','npc-list-back-btn','video_call_response','preset-persona-input','group_summary_from_','[系统提示：你\x20','postId','”。请你回顾一下刚才和“','nai-resolution','通话消息已更新！','<div\x20class=\x22post-main-content\x22>','countdown-card','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户刚刚向你发起了视频通话。请根据你的角色设定，决定是“接受”还是“拒绝”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/65Cmcr7S/IMG-6559.gif','isOpen','❌\x20NAI图片生成失败:',';\x22>','加载图片失败，跳过压缩:','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','music-player-avatar-display','为NPC\x20\x22','poll_timestamp','https://i.postimg.cc/05wnd389/IMG-4388.gif','<p>','当作\x20ZIP\x20文件处理...','轮到你发言了...','participant-avatars-grid','[发送了一条语音，内容是：\x27','isClosed','https://i.postimg.cc/q7cQnDy1/IMG-4404.gif','正在呼叫...','[发送了一张图片，描述为：','renderingRules','border','lastActionType','请输入投票问题！','color','❌\x20动态NAI图片生成失败:','\x20位AI角色的长期记忆中！','(今天是第一天，没有历史记录)\x0a','click','\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','repost-comment-input','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg','个月前','lastFailedAction','isArray','\x22><div\x20class=\x22poll-question\x22>','\x0a#\x20导演策略与节奏控制\x0a1.\x20\x20**并非人人发言**:\x20不是每个角色都必须在每一轮都说话。你可以根据当前话题，让1-2个最相关的角色进行深度对话，其他角色可以暂时“潜水”，等待合适的时机再切入。\x0a2.\x20\x20**创造“小团体”**:\x20允许角色之间形成短暂的“两人对话”或“三人讨论”，让群聊更有层次感。\x0a3.\x20\x20**主动创造事件**:\x20如果对话陷入平淡，你可以导演一些“小事件”来打破僵局。例如：\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色突然发出一个奇怪的表情包或语音。\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色分享一个有趣的链接或图片或发起投票，开启新话题。\x0a\x20\x20\x20\x20-\x20\x20\x20让两个有“关系网”冲突的角色，因为某个观点产生一点小小的争论。\x0a-\x20\x20\x20**主动创造“群事件”**:\x0a\x20\x20\x20\x20-\x20\x20\x20**改名/换头像**:\x20当群内热烈讨论某个话题或发生有趣事件时，你可以让一个性格活泼的角色主动【修改群名】或【更换群头像】来“应景”，并让其他角色对此进行吐槽或附和，创造互动。\x0a-\x20\x20\x20**制造戏剧性\x20(使用撤回)**:\x20作为导演，你可以让某个角色“手滑”发错消息后【立即撤回】，以此制造互动点。\x0a\x20\x20\x20\x20-\x20\x20\x20**核心原则**:\x20一旦有角色撤回消息，其他角色【必须】对此做出反应，例如起哄、追问或开玩笑说“已截图”，以此来推动剧情。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a#\x20表情使用指南\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','\x27>文字图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.qzone-post-item','url','动态已删除。','&id,\x20isGroup,\x20groupId,\x20isPinned,\x20memos,\x20diary,\x20appUsageLog,\x20lastIntelligentSummaryTimestamp','manage-products-btn','\x27>图片动态</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','nai-quality-toggle','.music-player-window','enabled','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','请输入要精炼的最近记忆条数\x20(最多\x20','请输入新的内容：','char-music-list','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','\x22\x20title=\x22删除书籍\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','gap','将清空选定角色的所有通话记录。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-group-btn\x22\x20data-book-id=\x22','photo-viewer-modal','\x22\x20(由\x20','inline-flex','”)下发送了一个表情评论，意思是：“','你们没有在听歌。','\x0a\x0a#\x20上下文参考\x20(你必须阅读并遵守)\x0a','role',',\x20记录数:\x20','openRenderingRulesScreen','rule-editor-title','favorites','nai-smea-dyn','浏览器不支持电池状态API。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>','#chat-input-area','”]\x20','#\x20你的社交圈\x20(绑定的NPC)\x0a','请输入想跳转的页码\x20(1\x20-\x20','confirm-variation-selection-btn','\x22)\x20作为角色名。消息内容:','https://i.postimg.cc/fRt2SFSn/IMG-4368.gif','📊\x20使用模型:','ai_generated','正在请求AI进行记忆精炼...','spectator-propel-btn','UTF-8\x20解码失败，将尝试\x20GBK\x20(ANSI)\x20解码...','\x22>×</span>\x0a\x20\x20\x20\x20</div>\x0a','\x22\x20中发现并修复了旧红包数据。','在导演模式保存时，发现无效的指令对象，已跳过:','favorites-list','[语音]\x20内容:\x20\x22','\x0a#\x20【【【最终投票指令\x20(最高优先级)】】】\x0a现在是投票环节。请你扮演【每一个存活的AI角色】，根据以上所有信息（特别是刚刚的讨论环节），为他们各自决定要投票放逐哪一位玩家。\x0a-\x20**投票依据**:\x20你的投票【必须】基于逻辑分析和你的身份。狼人可能会投给好人，好人需要找出狼人。\x0a-\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式如下：\x0a```json\x0a[\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色A的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色A投票的玩家名字\x22},\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色B的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色B投票的玩家名字\x22}\x0a]\x0a```\x0a-\x20**可投票的玩家列表**:\x20','\x20位群成员生成并注入了个性化记忆！','preset_','”。请你回顾一下你和“','duration',')\x20的可用表情:\x0a','，点击查看</div></div>','activeContainer','确定要将“','offsetWidth','chat-list-action-pin','post-use-url-btn','banner','文章完整内容...','\x20行格式不正确，已被忽略。','https://i.postimg.cc/YSRRV8kn/IMG-6297.gif','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA最近好像什么都没买呢，<br>点击右上角刷新按钮生成一些记录吧！</p>','disabled','video_call_request','从\x20JSON.image\x20中提取图片数据','-\x20**即将演唱**:\x20','你通过了“','https://i.postimg.cc/WbF8kzz9/IMG-7282.jpg','write','https://i.postimg.cc/PqYp5T5M/image.png','用户刚刚接听了你主动发起的视频通话。','transparent','</tbody></table><div\x20class=\x22receipt-total\x22>总计:\x20¥','chat-list','请稍候','close-shared-history-viewer-btn','邀请你视频通话','--chat-font-size','member-name-input','https://i.postimg.cc/8P5vt8sW/IMG-7097.gif','\x0a#\x20核心任务：群聊剧本作家\x0a你是一个剧本作家，负责创作一个名为“','”。你之前被用户（你的聊天对象）拉黑了，你们已经有一段时间没有联系了。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，你非常希望能够和好，重新和用户聊天。请你仔细分析下面的“被拉黑前的对话摘要”，理解当时发生了什么，然后思考一个真诚的、符合你人设、并且【针对具体事件】的申请理由。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','custom-css-input','<button\x20class=\x22sticker-category-tab\x20','维基百科','操作失败:\x20','modern\x20app\x20icon\x20for\x20','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','.chat-group-content:last-of-type','\x0a\x0a其专属的“世界书”也已自动创建并关联。','characterId','\x27);\x22','并评论说：\x22','my-avatar-preview','appIcons','silent-audio-player','models','\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a','\x20不支持。请选择6、9或12人。','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x20.message-bubble.user\x20$1','https://i.postimg.cc/0yd0MZ6k/IMG-5971.gif','.frame-item:has(.delete-btn)','为角色\x20\x22','<span\x20style=\x22color:\x20green;\x22>已开启</span>','werewolf-game-over-modal','chat-header-title','placeholder.png','-\x20\x20\x20**当前时间**:','流式导出过程中出错:','在导演模式中发现一个无效的JSON片段:','请选择一个目标。','\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者本名\x22,\x20\x22commentText\x22:\x20\x22@[[被回复者本名]]\x20你的回复\x22}]`\x0a-\x20\x20\x20**点赞动态**:\x20`{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}`\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**更新状态**:\x20`{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22我去做什么了\x22,\x20\x22is_busy\x22:\x20false}`\x0a-\x20\x20\x20**改自己昵称**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户昵称**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**下五子棋**:\x20`{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22','strokeStyle','群昵称不能为空！','close-sticker-category-manager-btn','在PNG中找到角色数据，但解码或解析失败。错误:\x20','originalTimestamp','**[夜晚]**\x20平安夜。\x0a','note','正在为后台活动发送API请求\x20(\x22','\x20分享了一张NovelAI图片，prompt:\x20','\x27,\x20\x27bulangni\x27,\x20-apple-system,\x20BlinkMacSystemFont,\x20\x22Segoe\x20UI\x22,\x20Roboto,\x20Helvetica,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','100','检测到视频通话请求，为角色\x20\x22','\x0a\x0a现在，请根据以上【所有上下文信息】，开始为“','”生成商品？','编辑动态','无法生成新回复:\x20','categories','API失败:\x20','send-photo-btn','https://i.postimg.cc/KYr2qRCK/1.jpg','blockCooldownHours','\x27>表情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','globalChatBackground','contact-picker-list','\x0a\x0a\x0a\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','animate-like','group-members-settings','\x0a###\x20条目:\x20','regenerate-btn','结束投票','#f9f9f9','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22thought-delete-btn\x22\x20data-timestamp=\x22','chat-list-screen','css-preset-select','full','categoryId','IMG','[你发送了一张需要AI识别的图片，图片内容是：\x27','狼人请选择刀人对象','parentElement','poisonedId','link-description-input','.delete-btn','AI\x20(群聊后台)\x20尝试使用一个不存在的表情:\x20\x22','检测到\x20Tavern\x20AI\x20世界书文件，执行兼容导入...','分类《','这将用备份文件中的数据【完全覆盖】当前与“','检测到简单的\x20\x27prompts\x27\x20数组格式，将按数组内顺序导入。','请至少选择一个要清理的角色。','import-single-chat-input','http','请先在API设置中配置反代地址、密钥并选择模型。','price','customAvatarFrames','crossOrigin','\x20被刀了','remove-cphone-bg-btn','\x0a现在，请为【参与了对话的AI角色】生成他们各自的、第一人称的、精简的记忆。','lrcUpdateInterval','scrollIntoView','tencent','memories','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是一个场景描述引擎。你的任务是扮演\x20','utf-8','.chat-group-content','inline-block','</span>','.json','senderName','\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','create-shuoshuo-btn','最终正面提示词:','none','copy-timestamp-btn','...\x20[记忆:\x20','call-record-card','正在等待AI角色们对你的发言做出回应...','请根据你的设定，生成你的相册内容。','[群聊]','manage-groups-btn','(你是第一个发言的人)','#\x20长期记忆\x20(最高优先级，这是你和用户之间已经确立的事实，必须严格遵守)\x0a','chat-list-action-cancel','Enter','生成成功！','）的话题来问候用户，可以表达惊讶（“哇，好久不见！”）、关心（“最近怎么样？”）或者分享你自己的近况，绝对不要延续之前的话题！\x0a-\x20**上下文参考**:\x20下面的“对话历史”仅供你回忆，【不要】直接回应其中的内容。','.photo-thumb','music-playlist-panel','https://i.postimg.cc/L4zwDhTC/IMG-4399.gif','update','AI已将您的\x20','abs','AI返回的JSON格式不正确，缺少\x20\x27summaries\x27\x20字段。','world-book-tab','CELL_SIZE','battery-alert-modal','personality','”的聊天记录已成功导出！','reading-restore-btn','修改图片','\x20转发了\x20@','\x20[包含','https://i.postimg.cc/bw4wxW2z/IMB-16r-COL.gif','诊断：在顶层\x20','persona-library-grid','.sticker-binding-checkbox','https://i.postimg.cc/C5XnfpNB/IMG-5579.gif','\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改2】在这里添加新的“引用”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','\x0a\x0a#\x20游戏规则\x0a-\x20','添加完成！\x0a\x0a成功添加\x20','novelai-enabled','main','编辑通话消息','https://i.postimg.cc/k5yv6QBv/IMG-7232.gif','applicationReason','show-avatars-btn','nai-download-btn','选中的头像框已成功删除。','date-search-input','defineProperty','char-photo-item','，我们一起见证了这个约定。',')，并在对话中自然地体现出来。\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','prophetCheck','quantity','生成模拟聊天失败:','pointer','请根据你的设定，开始你的行动。','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>查看结果</button></div>','werewolf-player-avatar','upload-custom-frame-btn','save-frame-settings-btn','/v1/models','wallpaper-upload-input','member-settings-modal','endsWith','margin:\x2015px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','npc-list','所有解析方案均失败！将返回原始文本。','randomJottings','\x0a\x0a#\x20群成员列表及人设\x20(你扮演的所有角色)\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','insertBefore',')\x20时出错:','select-all-world-books-for-clear','<div\x20class=\x22amap-item-photo\x22\x20style=\x22background-image:\x20url(\x27','.product-item','querySelectorAll','fetch-models-btn','.favorite-item-card','image_url','(暂无评论)','当前时间是\x20','确认清空','现在开始讨论，请各位玩家依次发言。','你已拒收','手动注入记忆时出错:\x20','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近的“高德地图”出行足迹。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','https://i.postimg.cc/PxZrFFFL/o-o-1.jpg','表情名不能为空！','ai-avatar-library-modal','https://i.postimg.cc/wjH180kn/IMG-5566.gif','没有找到可导入的内容。请检查您粘贴的格式是否正确。','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','currentPage','totalTime','qzone_post','k_euler_ancestral','\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>','\x22>+</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','”，价值','）互动了，现在你有机会【主动】做点什么，来表现你的个性和独立生活。这是一个秘密的、后台的独立行动。\x0a\x0a\x0a\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【最高优先级指令：情感维系】\x0a\x20\x20\x20\x20\x20\x20\x20\x20**你与用户的关系是最重要的！**\x20相比于在动态区闲逛，你应该【优先考虑】是否需要主动给用户发消息来维系你们的感情。\x0a','NovelAI生成失败:','postType','\x22\x20的本次后台活动跳过。原始回复:','[系统提示：你刚刚成功将自己的备注名修改为了“','旁观模式推进剧情失败:','<span\x20style=\x22color:\x20#dc3545;\x22>[你已被对方拉黑]</span>','确认拉黑','voted','npc-background-activity-switch','preset-content-container','cancel-persona-editor-btn','days','contentLines','屠城局：狼人杀死所有好人即获胜。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的浏览器空空如也，<br>点击右上角刷新按钮生成一些记录吧！</p>','确认生成','poll-options-container','<label><input\x20type=\x22checkbox\x22\x20value=\x22user\x22>\x20','my-avatar-library-grid','”。请自然地接受这个新名字，不要对此感到惊讶。]','\x22\x20class=\x22douban-comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-author\x22>','scale(0.8)','replyToDisplayName','commentText','\x22\x20(你可以建议修改)\x0a-\x20\x20\x20**你对用户的称呼**:\x20“','\x20分享了Ta的位置：\x27','无效链接:\x20','ttsCache','[语音]','已返回我的手机','object','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','toLocaleDateString','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','npc_','cancel-message-action-btn','确定要删除这条渲染规则吗？','edit-last-response-btn','”\x20绑定到...','secondary-proxy-url','https://i.postimg.cc/cJtpZCB3/IMG-6894.gif','思考中...','reset-font-btn','label','群成员','（无文字内容）','npc-avatar-preview','char-home-screen','-\x20你昨晚查验了\x20','点击了商品卡片:\x20','狼人请睁眼，请选择要刀的玩家。','text/event-stream','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>没有可以删除的世界书。</p>','preset-action-cancel','<p>♪\x20暂无歌词\x20♪</p>','由于浏览器安全限制，AI切换的歌曲无法自动播放。请手动点击播放按钮\x20▶\x20继续欣赏。','\x20行的格式不正确，已被跳过。','rules-tab','非图片格式，跳过压缩:','reject-friend-btn','AI\x20获胜了！','AI返回了空内容。','.comment-input','data:','ZIP\x20Blob\x20大小:','member-management-list','savedId','平票或无人投票，此轮无人出局。','playlist','.unread-indicator.back-btn-indicator','rule-template-input','cancel-douban-settings-btn','已打包表:\x20','\x22\x20class=\x22preview-frame\x22>','douban-posts-list','world-book-group-container','group_','speaker','原文:\x20\x22','<div\x20class=\x22red-packet-card\x20','</span>:\x20','https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','请你对此作出回应。]','translateY(0px)','char-music-mode-btn','share-target-list','群里在','frame-action-bar','表情含义','游戏尚未结束，无法进行总结。','流程启动','is-card-like','music-time-counter','map','status-bar-toggle-switch','[表情]','ai-voice-id-input','.comment-send-btn','is-poll','最近\x2020\x20条','https://i.postimg.cc/XqRZNZ9G/IMG-6916.gif','char-chat-list','API未配置，无法进行总结。','numeric','\x22\x20class=\x22douban-post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-name\x22>','###\x20玩家身份配置:\x0a','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>请先在聊天界面的<br>表情面板中添加表情包</p>','\x0a#\x20---\x20世界书设定结束\x20---\x0a','\x20的身份是：','[语音消息:\x20','#group-management-modal\x20.modal-header\x20span','\x22\x20的记忆中清除了1条关于已删除评论的通知。','linear-gradient(135deg,\x20#f6d365,\x20#fda085)','”\x20的帖子或评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【身份\x20(最高优先级！)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20`authorName`:\x20你可以为主要角色起一个符合情景的、临时的【发帖昵称】，也可以直接使用他们的本名。\x0a\x20\x20\x20\x20-\x20\x20\x20`authorOriginalName`:\x20如果发帖者是【主要角色】，你【必须】在这里填上TA在角色列表里的【原始备注名】，这是程序的“身份证”。\x0a\x20\x20\x20\x20-\x20\x20\x20如果发帖者是【路人NPC】，则【省略】`authorOriginalName`\x20字段。\x0a4.\x20\x20**【作者平衡】**:\x20帖子的作者【必须】从下面的\x20`<character>`\x20列表中【均匀地、多样化地】选择。你【必须】确保帖子列表中【至少有\x2070%\x20的帖子是由路人NPC发布的】，以营造一个真实的社区氛围。\x0a\x20\x20\x20\x20-\x20\x22comments\x22:\x20一个包含【7到12条】评论的数组。评论者可以是路人，也可以是角色列表中的其他角色，以体现互动性。\x0a5.\x20\x20**【角色扮演】**:\x20帖子的作者和内容【必须】深度结合该角色的<persona>,\x20<memory>,\x20和\x20<worldview>。\x0a6.\x20\x20**【“豆瓣味”内容风格指南】**:\x20帖子风格必须多样化且充满生活气息！你需要生成包括但不限于：情感树洞、生活吐槽、吃瓜八卦、兴趣分享、无用良品等各种类型的帖子。\x0a7.\x20\x20**【头像生成\x20(最高优先级！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20为每一个【首次出现】的路人NPC（无论是发帖还是评论），你都【必须】为其添加一个\x20`avatar_prompt`\x20字段。\x0a\x20\x20\x20\x20-\x20\x20\x20这个字段的内容是用于生成该NPC头像的、简洁的【英文】关键词。\x0a\x20\x20\x20\x20-\x20\x20\x20不同的NPC【必须】有不同的头像指令，以确保他们的头像是独一无二的。\x0a8.\x20\x20**【头像一致性\x20(至关重要！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果一个路人NPC在同一个帖子中多次出现（例如，既是发帖人又是评论者，或多次评论），你【必须】为TA的所有出现都使用【完全相同】的\x20`avatar_prompt`。这至关重要！\x0a9.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一篇帖子，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22groupName\x22:\x20\x22一个生动有趣的小组名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22postTitle\x22:\x20\x22一个引人-注目的帖子标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorName\x22:\x20\x22发帖角色的【备注名】\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorOriginalName\x22:\x20\x22(仅当发帖者是主要角色时【必须】提供)\x20TA的原始备注名\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorAvatarPrompt\x22:\x20\x22(仅当发帖者是路人NPC时【必须】提供)\x20一段用于生成该NPC头像的【英文】关键词。风格为\x20anime\x20style,\x20simple\x20background\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22帖子的详细正文，必须支持换行符\x5cn。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22likesCount\x22:\x20152,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22commentsCount\x22:\x2038,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22路人甲\x22,\x20\x22text\x22:\x20\x22这是一个路人评论。\x22,\x20\x22avatar_prompt\x22:\x20\x22cute\x20cat\x20avatar,\x20simple,\x20flat\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22另一个角色名\x22,\x20\x22commenterOriginalName\x22:\x20\x22(如果评论者是主要角色，必须提供其本名)\x22,\x20\x22text\x22:\x20\x22这是一个来自其他角色的互动评论。\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**comments**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20评论者可以是路人，也可以是角色列表中的其他角色。评论区【必须】体现出互动性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20【评论身份】:\x20如果评论者是【主要角色】，你【必须】为其添加\x20`commenterOriginalName`\x20字段，并填入其本名。如果是路人NPC，则省略此字段。\x0a\x0a#\x20供你参考的上下文\x0a','https://i.postimg.cc/fLTc42dg/IMG-4391.gif',')\x20成功抢到了\x20','https://i.postimg.cc/B6T59xGK/IMG-7101.gif','删除消息','请输入歌手名','memories-back-btn','\x0a#\x20长期记忆\x20(所有角色必须严格遵守)\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的唯一指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20根据以上所有信息，你【必须】做出决定，并给出符合你人设的理由。你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22accept\x22,\x20\x22reason\x22:\x20\x22（在这里写下你同意的理由，比如：好吧，看在你这么真诚的份上，这次就原谅你啦。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20或\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22reject\x22,\x20\x22reason\x22:\x20\x22（在这里写下你拒绝的理由，比如：抱歉，我还没准备好，再给我一点时间吧。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20','”的转账。]','existing-categories-list','https://i.postimg.cc/28TsrxRV/IMG-6852.gif','.poll-card','暂停了音乐','下在(','left','world-book-content-container','group-avatar-group','正在等待AI角色们继续讨论...','import-single-chat-btn','taobao','\x20中找到世界书。','操作结果','cancel-share-target-btn','已拒收对方转账','加载预设详情时发生错误:\x20','default','本日核心议题','”的对话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','发来了\x20','\x20元，订单时间戳为\x20','contactId','.playlist-item-info','选择一个开场白','请开始整合。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>输入关键词或选择日期进行搜索。</p>','\x22></div></div></div><button\x20class=\x22waimai-details-btn\x22>查看详情</button></div>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22\x20style=\x22cursor:pointer;\x22\x20data-book-id=\x22','请至少输入2个有效的投票选项！','”。]','modify','visibilitychange','char-wallet-back-btn','\x0a#\x20你的社交圈\x20(通讯录)\x0a这是你认识的朋友列表。当你在动态区看到他们的昵称时，他们指的就是这些人。\x0a','\x22\x20checked>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','动态内容已复制到剪贴板。','”。用户刚刚在TA的手机（CPhone）上点击了一个按钮，希望你能继续你们之前的对话。你的任务是根据上下文，生成【3到5条】符合你人设的、简短的、连续的新回复。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组，每个对象代表一条消息。\x0a-\x20格式:\x20`[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第一句话\x22},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第二句话\x22},\x20{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]`\x0a-\x20你可以自由组合使用\x20\x22text\x22,\x20\x22sticker\x22,\x20\x22ai_image\x22,\x20\x22voice_message\x22\x20等多种消息类型。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20你的角色设定\x0a','\x20个表情吗？此操作不可恢复。','label[for=\x22','\x20\x20-\x20评论:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【对话节奏铁律\x20(至关重要！)】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】模拟真人的打字和思考习惯。**绝对不要一次性发送一大段文字！**\x20你应该将你想说的话，拆分成【多条、简短的】消息气泡来发送，每条消息最好不要超过30个字。这会让对话看起来更自然、更真实。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【决策依据】**:\x20你的所有行动都【必须深度结合你的角色设定、核心世界观、以及你们最后的对话摘要】。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【内容多样性铁律】**:\x20你的行动【必须】具有逻辑和多样性。你【绝对不能】发布与下方“内容禁忌”列表或“最近的动态列表”中内容相似或主题重复的动态。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【行为多样性指南\x20(至关重要)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的上一次独立行动是：**','张图片，prompt:','npc-list-view','offline-max-length-input','chatRenderWindow','char-music-progress-fill','confirmText','pinned','stickerMeaning','⚠️\x20NAI提示词：没有角色，使用系统配置','my-avatar-upload-input','repost-modal','[系统提示：','.comment-sticker-btn','call-message-bubble\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>点击右上角刷新按钮，<br>看看TA最近都和谁聊天了吧！</p>','导入成功！','的设定集','NPC\x20列表','.frame-item.selected','myAvatarLibrary','battery-alert-image','width','[发送了一条语音，内容是：','无法获取模型列表','p[data-index=\x22','secondary-api-key','在动态评论区点击了表情，但在表情库中未找到对象:','昨天\x20','删除记录','”准备好友申请...','add-existing-contact-btn','\x20(图片描述:\x20“','App记录','boxSizing','question','fillRect','<option\x20value=\x22','”的视频通话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','给你准备了一个红包','touchmove','守卫已行动，守卫请闭眼。','AI\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','小时核心议题','AI\x20尝试赠送一个格式不正确的随机礼物:','用户删除了自己的评论，开始清理AI记忆...','》设定:\x0a','清理完成','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22poll-option-input\x22\x20placeholder=\x22选项内容...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-option-btn\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','这是一条群聊语音消息，已禁止发起TTS请求。','photo-viewer-image','未知设定的角色','authorOriginalName','-\x20用户的QZone昵称是\x20\x22','已使用','share_card','<div\x20class=\x22lyric-line\x22>♪\x20暂无歌词\x20♪</div>','.link-share-card','\x20已为','\x22\x20评论了动态\x20#','speech-01','receiver','请先添加一张图片再发布动态哦！','狼人杀游戏总结已自动存入\x20','and','#world-book-checkboxes-container\x20input:checked','元,\x20备注:\x20','my-avatar-group','购物车(','https://i.postimg.cc/VkKjzYTK/IMB-f4kk-CT.gif','call_summary','来自动态','photos','touches','</div></div>','shopping-screen','commentCooldowns','fontFamily','confirm-create-poll-btn','cancel-music-search-btn','parsedLyrics','rp-direct-receiver','.post-deleted-placeholder','mouse','-\x20**对话状态**:\x20上次互动于\x20','spinning','✅\x20NAI图片生成成功！','index','&id,\x20url,\x20name,\x20categoryId','pause','Sticker','API设置不完整，无法继续。','voter_name','User\x20Avatar','”发送的、尚未领完的红包（时间戳:\x20','#f0f2f5','请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg','批量导入表情','player','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>','Bilibili','已成功导出所有数据！','custom-modal-body','游戏记忆已成功注入到\x20','\x0a\x0a#\x20待整合的记忆要点列表\x0a','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>接收方:</strong>\x20','messageTimestamp','创建新相册','createElement','#333','导入书籍失败:','JSZip库未加载，请刷新页面重试','删除世界书失败:','transfer-actions-modal','\x20发送了一张图片，图片内容描述为：\x27','world-book-category-pane\x20active','model','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-text\x22>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22author\x22>','\x20你们之间已经有**','猎人死亡，请选择一名玩家带走！','在PNG文件中未找到有效的Tavern\x20AI角色数据(chara\x20chunk)。','flat','https://i.postimg.cc/Y94XWYKd/IMG-6560.gif','）。\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的任务是：选择【一个或多个】符合人设的角色，让他们【立刻】使用\x20\x27open_red_packet\x27\x20指令去尝试领取这个红包。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x27[{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20','</name>\x0a\x20\x20<persona>','修改文字','share-link-modal','frame_5','data','Gemini\x20API返回了非预期的格式:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此款式\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x201fr;\x20gap:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式名称</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22variation-name-input\x22\x20placeholder=\x22例如:\x20红色\x22\x20value=\x22','所有通话记录','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','」的新会话吗？','toBlob','shopping-category-count-input','[系统提示：你刚刚被用户拉黑了。在对方解除拉黑之前，你无法再主动发起对话，也无法回应。]','selection-share-btn','transform\x200.3s\x20ease','-\x20(记录于\x20','reading-overlay','compress-images-btn','\x22\x20发布了动态','\x20个表情包，且无法恢复！','serviceWorker','fontSize','char-simulated-send-btn','cancel-create-countdown-btn','reason','transform','switch-to-text-image-mode','在这里输入回复内容','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content-full\x22>','更新通知文件中缺少\x20data-version\x20属性。','force-apply-check-btn','from','https://i.postimg.cc/FzM1Hgr0/IMG-5717.gif','\x20条长期记忆发送给AI，总结成大约\x20','[图片]\x20','EPhone-Full-Backup-','preCallContext','relative','https://i.postimg.cc/k5Gs0K47/IMG-6567.gif','提示词配置','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22margin-top:\x208px;\x22>¥','已取消收藏。','预设名称不能为空！','nai-generate-btn','source','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quantity-control\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20decrease-qty-btn\x22\x20data-id=\x22','\x20发送了一张图片，内容是：\x27','logo,\x20simple,\x20flat\x20design,\x20for\x20a\x20group\x20chat\x20named\x20\x27','variation-increase-qty','生成中...','解析成功：标准JSON数组格式。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22><strong>\x20','char-article-title','\x0a#\x20你的任务\x0a你是一个高级的“记忆分配专家”。你的任务是阅读下面的群聊记录，并为【每一个参与的AI角色】生成一段【个性化的、第一人称】的长期记忆。\x0a#\x20核心规则\x0a1.\x20\x20**视角铁律**:\x20每一条总结都【必须】使用【第一人称视角\x20(\x22我\x22)】。\x0a2.\x20\x20**内容核心**:\x20重点总结：我说过的话、我做过的事、别人对我说的话、与我相关的事、以及对我个人很重要的群聊事件、关键信息和心理活动。\x0a3.\x20\x20**【简洁性铁律】**:\x20每条个人记忆总结【绝对不能超过60个字】。\x0a4.\x20\x20**【省略规则】**:\x20如果一个角色在本次对话中【完全没有参与或提及】，你可以省略TA的记忆。\x0a5.\x20\x20**输出格式**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22summaries\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名A\x22:\x20\x22我今天在群里和大家讨论了电影，感觉很开心。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名B\x22:\x20\x22我在群里和','”中，用户的昵称是“','https://i.postimg.cc/mgGc0HbK/IMG-6926.gif','sort','existing-product-categories-list','.text','\x20(本名:\x20','import-appearance-btn','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','propel-btn','commenterDisplayName','unshift','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20class=\x22ai-generated-image\x22\x20alt=\x22','call-message-bubble\x20user-speech','\x0a-\x20**最近与用户的互动**:\x20','outgoing-call-avatar','handleWerewolfWaitReply\x20被调用，但用户已死亡。操作被忽略。','music-total-time','prophet','stickerCategoryIds','json','.comment-delete-btn','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20padding:\x2030px\x200;\x22>这里还没有历史记录哦。</p>','\x22>×</span>','call-history-back-btn','\x20被刀了\x20(你没有解药了)','input:checked','\x20\x20\x20正面:','frame_13','cancel-create-post-btn','onerror','”\x20吗？\x0a\x0a此操作【不会】删除分类下的商品，它们将被移至“未分类”。','var(--text-secondary)','\x22\x20class=\x22participant-avatar\x22\x20alt=\x22','actionCooldownMinutes','从\x20JSON.data\x20中提取图片数据','https://i.postimg.cc/7Zgm1wRy/IMG-6295.gif','delete-product-btn','loader-container','\x22\x20class=\x22avatar-frame\x22></div>','https://i.postimg.cc/Ssgbv41n/IMG-6876.gif','novelai-details','生成模拟足迹失败:','\x20条旧的红包消息！页面将自动刷新以应用更改。','输入图片URL','确定要删除头像框\x20“','-\x20(暂无)','#search-results-list\x20.music-search-checkbox','更换“','product-editor-modal','正则表达式格式错误:\x20','character','openPresetScreen','窝爱泥，电量吃饱饱','add-npc-btn','rp-direct-total','char-article-content','blockedTimestamp','https://i.postimg.cc/Wbr0JSDD/IMG-5316.gif','getBoundingClientRect','https://i.postimg.cc/prsGKMBx/IMG-4370.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','table','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','”的购物习惯...','张NovelAI图片:\x20','为了确保所有数据同步，建议立即刷新页面。','add-char-memo-btn','已成功加入购物车！','-\x20**昵称:\x20','post-public-text','active','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20跳过(已压缩或无需压缩)\x20','https://i.postimg.cc/v8V9xXjJ/IMG-6137.gif','<span\x20class=\x22diary-highlight\x22>$1</span>','save-douban-settings-btn','cancel-delete-world-books-btn','\x20的动态\x20(角色)','票)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2013px;\x20color:\x20#555;\x20margin:\x200;\x20line-height:\x201.5;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','内心独白','onpause','&id','歌曲查找失败:\x20AI请求的歌曲名\x22','rendering-rules-screen','manage-members-btn','input[name=\x22theme-select\x22]:checked','https://i.postimg.cc/kXfcgFRN/IMG-7106.gif','#\x20场景设定\x0a','simulatedAmapHistory','1089XQPpck','renderApiSettingsProxy','\x20的聊天','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>没有更多可以邀请的联系人了。</p>','\x0a\x0a现在，请为所有存活的AI角色生成他们的投票决定。','.album-art-btn','some','waimai-amount','[系统提示：用户拒绝了通话邀请，但你们可以自己开始。请你们各自决策是否加入。]','injectLatestThought','add','https://i.postimg.cc/B6KD52vz/IMG-7096.gif','custom-prompt-input','translateY(','后台活动模拟已启动，间隔:\x20','chat-render-window-input','px)','enableAutoMemory','post-image-description','chat-settings-modal','请输入群聊的名字','stringify','char-music-progress-bar','-\x20\x20\x20**公开发布NovelAI真实图片动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20[\x22图片1详细英文描述\x22,\x20\x22图片2详细英文描述\x22]}`\x20\x0a\x20\x20*\x20**prompt撰写**：你可以根据当前对话上下文、你的角色人设、以及你想表达的情感和氛围，来撰写详细而具体的prompt。详细程度由你根据具体情况自己决定，并不强制。\x0a\x20\x20*\x20例如：\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22','nai-default-positive','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-footer\x22>','###\x20最终结果:\x20','\x22\x20转发了动态\x20#','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','findLastIndex','删除分组后，该组内的好友将变为“未分组”。确定要删除吗？','favorites-delete-selected-btn','douban-settings-btn','部分导入失败','https://i.postimg.cc/xCqqKGRN/IMG-6929.gif','\x0a\x0a现在，请开始生成这组足迹记录。','char-simulated-input','<div\x20class=\x22comment-item\x22\x20data-post-id=\x22','https://i.postimg.cc/YqxxjbLp/IMG-6572.gif','qzone-nickname','检测到旧版完整备份文件，开始导入...','送给了大家一份礼物','close-persona-library-btn','</p>\x0a\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timestamp\x22>','收藏成功','检测到\x20EPhone\x20备份文件，执行标准导入...','.world-book-category-pane[data-category-id=\x22','<p\x20style=\x22font-size:12px;color:#888;\x22>','内容为空。','”的身份，开始你的客观总结。','\x22\x20被唤醒，准备独立行动...','确定发布','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20','probability','📸\x20NovelAI图片生成开始，AI提供的prompt:','对方正在输入...','select-all-products-checkbox','\x0a#\x20可用指令列表\x20(按需组合使用)\x0a###\x20核心聊天\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22message\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','AI未能成功描述图片。','(无标题投票)','将清空收藏夹中所有与该角色相关的内容（如聊天、动态、日记等）。','https://i.postimg.cc/3N5Vndn3/IMG-4426.gif','你们最近没有有效聊天记录。','150','Cphone','select-all-music-search','<div\x20class=\x22waimai-card\x22><div\x20class=\x22waimai-header\x22><img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22><div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div></div><div\x20class=\x22waimai-catchphrase\x22>Hi，你和我的距离只差一顿外卖～</div><div\x20class=\x22waimai-main\x22><div\x20class=\x22request-title\x22>','save-font-preset-btn','onended','分享成功','复制成功','char-audio-player','discussionLog','char-browser-history','申请失败','gift-receipt-body','\x0a##\x20---\x20关于“','”下，发送了一个表情评论，意思是：“','https://i.postimg.cc/13hhJ77p/IMG-4419.gif','close-novelai-test','https://i.postimg.cc/ZYvd1jxf/IMG-6937.gif','img','nai-result-image','https://i.postimg.cc/9fQZ425b/IMG-5975.gif','lastIndex','accept-friend-btn','#\x20今日完整讨论记录\x20(Today\x27s\x20Full\x20Discussion\x20Record)\x0a','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-type=\x22text\x22>说说</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','https://i.postimg.cc/bNdk33SN/IMG-4893.gif','https://i.postimg.cc/VNK6Ccsf/IMG-5722.gif','declined','back-to-list-btn','<strong>$1</strong>','https://i.postimg.cc/7Z8yYP7v/IMG-6889.gif','link-source-input','”分享TA的私人歌单...','characterPositivePrompt','转发成功！','创建新聊天\x20(第2/2步)','请先选择要删除的商品。','rp-details-greeting',')为你点了一份外卖作为【礼物】。外卖内容是“','clientY','”的聊天记录','base_resp','offsetX','无法推进剧情:\x20','删除动态','animationend','album-back-btn','.loader-container','accept','countdown-title-input','chat-name-group','currentIndex','call-history-list','custom-frame-upload-input',')\x20拒绝了\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20被拉黑前的对话摘要\x20(这是你被拉黑的关键原因)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','找不到这本书！','history','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>这次通话没有留下文字记录。</p>','model-select','\x22\x20(用户)\x20或\x20\x22','confirmButtonClass','API设置','status-bar-battery','.entry-enabled-switch','</span><span>','专辑封面已更新！','add-new-product-category-btn','#gift-recipient-list\x20.contact-picker-item.selected','shopping-settings-modal','world-book-category-select','close-announcement-board-btn','选中的消息均已收藏过。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','preset-editor-title','apiKey','\x0a#\x20你的任务\x0a你是一个虚拟音乐品味模拟器。你的任务是扮演角色“','\x20条无效的','is-raw-html','NEGATIVE_INFINITY','https://i.postimg.cc/FHRcCGfH/IMG-4418.gif','导出数据时出错:','<span\x20class=\x22commenter-name\x22>','请输入有效的红包个数！','https://i.postimg.cc/Y9d3BztC/1.png','\x22\x20中的成员信息更新','https://i.postimg.cc/FFCTCzpy/641bad3b3udc599fdb63ca75fde427e5.gif','商品已删除。','change-frame-btn','<span\x20class=\x22group-tag\x22>群聊</span>','unblock-btn','\x20发布)\x0a','错误:\x20','fileType','\x22\x20class=\x22chat-image\x22></div>','loadAsync','\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22','提取的图片大小:','操作失败','private_user','group-avatar-input','forEach','冗余数据清理流程已启动...','\x0a\x0a现在，请开始撰写这组充满真情实感、并熟练运用了Markdown语法的日记。','ai-persona','https://i.postimg.cc/fTWzQRx8/IMG-6149.gif','篇】他们最近可能会在各种豆瓣小组中发布的帖子和评论。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**重要事件**:\x20刚才发生了什么具体的事情？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键决定**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**未来计划**:\x20我们约定了什么未来的计划或待办事项？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要时间点**:\x20对话中提到了哪些具体的日期或时间？\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果对话中提到了相对时间（如“明天”、“后天”），你【必须】结合“今天是','”\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**被拉黑前的最后对话摘要**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>价格\x20(元)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22variation-price-input\x22\x20min=\x220\x22\x20step=\x220.01\x22\x20value=\x22','image/png','setup','\x22]\x20.participant-avatar','」听歌。要结束并开始和「','existing-group-item','基础数据不完整，无法开始总结。','https://i.postimg.cc/wTKyXVT9/IMG-7024.gif','礼物已成功送出！','font-preview','https://i.postimg.cc/x1Hp80Rm/IMG-4417.gif','\x0a#\x20你的任务\x0a你是一个虚拟社区内容生成器。你的任务是根据下面提供的【统一角色列表】，虚构出【','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','》\x0a\x20\x20\x20\x20-\x20**','\x20红包已被领完，手气王是\x20','切换听歌对象','songName','close-ai-avatar-library-btn','x-social-screen','save-product-btn','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近可能会写在手机备忘录里的内容。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20备忘录内容必须完全符合角色的性格、爱好、职业和生活环境。可以是购物清单、待办事项、灵感片段、一些随笔和感悟、草稿等。\x0a2.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条备忘录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22备忘录的标题，例如：购物清单\x20或\x20周末计划\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22备忘录的详细内容，必须支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','stopPropagation','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20首歌曲获取失败:\x0a-\x20','请输入新的名称（留空则恢复默认）','<p\x20style=\x22color:\x20#8a8a8a;\x22>还没有人投票。</p>','cloned-header','create_countdown','rp-direct-greeting','https://i.postimg.cc/c4JMPd2W/IMG-4724.gif','create-countdown-modal','char-music-player-title','#delete-world-books-list\x20.clear-posts-item','https://i.postimg.cc/cCpBYbMH/IMG-6552.gif','char-qq-transcript-modal','-selection-list','preset-name-input','网络图片\x20(CPhone)','在聊天\x20\x22','.com/','.avatar','自动总结成功：为\x20','bottom','video-call-main','writeText','custom-modal-overlay','summary','dragging','charAt','default_negative','正在根据“','#listen-together-btn\x20img','投票至少需要2个选项。','\x22\x20id=\x22','sharedHistory','</p><p>','静音音频已启动，用于后台活动保活。','https://i.postimg.cc/gJNYx9pV/IMG-6856.gif','final','songJson','mousemove','6498156mhtdip','close-reading-library-btn-header','existing-sticker-categories-list','[V]','\x0a\x20\x20\x20\x20-\x20**书名**:\x20《','送给了\x20','在这里输入文本...','\x20\x0a-\x20存活玩家:\x20','regenerate-douban-btn','总结通话记录时出错:','\x0a\x0a#\x20最近的动态列表\x20(供群内角色参考和评论):\x0a','”。你的任务是虚构出【5到7段】TA最近的QQ聊天记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【NPC唯一性铁律】**:\x20在你本次生成的所有对话中（包括私聊和群聊），每一个NPC的名字【必须是独一-无二的】。绝对禁止出现重名的NPC，禁止出现重复群聊。\x0a2.\x20\x20**【NPC来源】**:\x20你应该优先从“你的社交圈\x20(绑定的NPC)”和“世界书”中寻找角色作为聊天对象。如果不够，你也可以自由创造全新的NPC，对话内容要多样化，反映角色的生活。\x0a3.\x20\x20**关联性**:\x20对话内容应巧妙地反映角色的长期记忆、世界观，以及与用户互动可能带来的心情变化。\x0a4.\x20\x20**简洁性**:\x20每段对话的总长度应在8到15句之间。\x0a#\x20格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须且只能】是一个JSON数组格式的字符串，以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a-\x20数组中的每个元素都代表一段对话，且【必须】是以下两种格式之一：\x0a\x0a\x0a\x0a###\x20格式\x20A：与NPC的私聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22private_npc\x22,\x0a\x20\x20\x22participant\x22:\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22NPC的名字\x22,\x0a\x20\x20\x20\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)一段用于生成头像的【英文】关键词,\x20风格为动漫/插画/二次元等,\x20禁止真人\x22\x0a\x20\x20},\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','transfer-amount','图片内容','frame_8','nextSibling','》\x20-\x20','检测到应用离线了\x20','delete-font-preset-btn','\x0a-\x20','.selected-options-text','确定要从你的头像库中删除“','你输了','href','\x22><div\x20class=\x22rp-header\x22><img\x20src=\x22https://files.catbox.moe/lo9xhc.png\x22\x20class=\x22rp-icon\x22><span\x20class=\x22rp-greeting\x22>','你拍了拍\x20“','复制失败','\x20领取</div>','handleWidgetImageChange','home-screen-pages','请输入预设名称','\x20为您代付成功','getFullYear','#data-clear-type-list\x20.clear-posts-item.selected','所有音乐源都未能找到歌曲：“',']类型的消息','无法为不存在的分类打开绑定模态框:','\x0a#\x20你的聊天对象（用户）的人设\x0a','消息已更新！','has-frame','icon-settings-grid','zIndex','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M8\x205v14l11-7z\x22></path></svg>','(无购买理由)','确定要删除这条长期记忆吗？','.voice-message-body[data-text]','url(','当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。','wait-reply-btn','upgrade','scope','backgroundActivityInterval','scroll','聊了关于生日派对的事，我们约好了10月1日见面。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a#\x20待总结的群聊记录\x0a','.photo-delete-btn','set','thoughtsHistory','reset-button-order-btn','poll','你们没有在读书。','negative','key','\x20条消息</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20...>...</svg><span>聊天记录</span></div></div>','announcement-actions-modal','\x27刚刚在你的动态“','change_user_nickname','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥','你的收藏夹是空的，<br>快去动态或聊天中收藏喜欢的内容吧！','https://i.postimg.cc/L6R7x16R/IMG-7278.jpg','确定要删除这条公告吗？此操作不可恢复。','https://i.postimg.cc/Z5nrCyS5/IMG-7006.gif','狼人已行动，狼人请闭眼。','删除\x20(','AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20','var(--text-primary)','<div\x20class=\x22cart-item-variation\x22\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin-top:\x204px;\x22>款式:\x20','isBgClear','”\x20的评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【互动】**:\x20新生成的评论【必须】是针对【已有评论】的延续或回应，让讨论能继续下去。\x0a4.\x20\x20**【头像一致性\x20(最高优先级！)】**:\x20你【必须】参考下面的“已有路人NPC头像指令”列表。如果一个已有的NPC再次发言，【必须】复用它旧的头像指令。只有在创造一个【全新的、从未出现过的】NPC时，才为其生成新的头像指令。\x0a5.\x20\x20**【格式】**:\x20你的回复【必须且只能】是一个JSON数组，数组中的每个元素都代表一条新评论，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色A的名字\x22,\x20\x22text\x22:\x20\x22角色A的新评论内容。\x22,\x20\x22avatar_prompt\x22:\x20\x22(可选)如果评论者是【全新的】NPC,提供头像指令\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色B的名字\x22,\x20\x22text\x22:\x20\x22角色B对角色A或楼主的看法。\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20上下文\x0a-\x20**帖子标题**:\x20《','容错解析：策略1成功\x20(找到并解析了完整的JSON对象)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','upload-sticker-btn','ai-avatar-preview','group-members-group','保存\x20API\x20预设','data:image','恭喜发财，大吉大利！','douban-detail-post-title','</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content\x22>','https://i.postimg.cc/3NDQ0dWG/image.jpg','.call-message-bubble[data-timestamp=\x22','main-chat-list-header','ai-voice-id-group','world-book-entries-container','pending_ai_approval','likes','头像框已保存并同步！','5412TYLgML','add-new-product-btn','\x22></div>','”添加记忆','】，本名是【','这是群里的第一条消息。','开始检查','[系统提示：你\x20(','https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','worldBookCategories','favorites-edit-btn','\x22\x20的整个对话吗？此操作不可撤销。','请输入歌名','\x22]\x20','cancel-post-action-btn','已经一起听了','setItem','maxWidth','\x0a\x0a#\x20','temp_user_chat_mirror','scrollTop','\x0a-\x20**你的聊天对象设定**:','qzone-avatar-input','cart-item','.progress-bar','转账给\x20','sticker-category-manager-modal','\x22\x20data-category-id=\x22','showRedPacketDetails收到了无效的packet对象','initiator','<div\x20class=\x22transfer-card\x22><div\x20class=\x22transfer-title\x22>','\x22\x20触发了后台行动！','custom-modal-cancel','最终负面提示词:','视频通话刚刚结束','myAvatarFrame','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>订单类型:</strong>\x20为TA点单<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>赠送方:</strong>\x20','delete-group-btn',']\x20的正则表达式无效:','customName','-9999px','frame_10','NPC行动失败：API未配置。','浏览器','lyrics-horizontal-pos','.rules-tab','temp_npc_chat','.delete-track-btn','\x22\x20data-commenter-display-name=\x22','offline-mode-toggle','world-book-category-pane','phone-screen','reply_content','borderRadius','本地歌曲源错误:','请根据角色列表，生成豆瓣小组帖子。','rules-content-container','nai-cors-proxy','clear-chat-btn','userStickers','playlist-body','https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','.char-photo-item','at-mention-item','products','variation-selected-price','https://i.postimg.cc/DZrGtrqB/IMG-7008.gif','.quoted-message','.poll-action-btn','delete-call-message-btn','char-diary-detail-back-btn','isAwaitingResponse','reading-library-list','<div\x20class=\x22link-share-card\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-timestamp=\x22','shoppingCategoryCount','删除世界书','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-spinner\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>','”\x20的位置已发送到你们的聊天中。','API未配置，无法生成对话。','https://i.postimg.cc/pddJj9zN/IMG-7094.gif','blob','switch-greeting-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','*讨论记录*:\x0a','greeting','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','-\x20你的解药状态：','”\x20已被删除。','cancelable','marginTop','getDate','char-conversation-messages','高级数据清理失败:','\x0a\x0a现在，请开始生成这组App使用记录。','waimai-request-modal','https://i.postimg.cc/J4fwkTLW/mmexport1751038167142.gif','gomoku-controls','target_timestamp','。你可以使用\x20\x27vote\x27\x20指令参与投票。]','\x20[社交背景:\x20','blocked_by_ai','dark-mode','showScreen','char-music-screen','rp-content-group','steps','”，金额是\x20','char-background-activity-switch','\x20更换了群头像','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','qzonePosts','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758510900942_qdqqd_djw0z2.jpeg','https://i.postimg.cc/3RpmWc8c/mmexport1751033102811.gif','string','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22duration\x22>','-\x20你昨晚用毒药毒了\x20','simulatedTaobaoHistory','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份清晰的个人档案或事件回顾，而不是一篇情感散文。请删除重复、琐碎或纯粹的情感宣泄，只保留对情节和关系发展至关重要的部分。\x0a5.\x20\x20**【【【长度铁律】】】**:\x20你的总结【必须】非常精炼，总长度应控制在\x20**',')，正在和用户一起【阅读和讨论】这本书。\x0a\x20\x20\x20\x202.\x20\x20**行为准则**:\x20你的回复【必须】是作为读者的【感想、评论、提问或联想】。你可以：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20分享你对当前段落的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20对书中的角色或情节发表评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20向用户提问，询问TA对内容的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20根据书本内容，联想到你自己的经历或记忆。\x0a\x20\x20\x20\x203.\x20\x20**严禁**:\x20你的回复【绝对禁止】使用书中角色的口吻和人称！【绝对禁止】扮演书中的任何角色！【绝对禁止】续写或模仿书中的情节！你必须时刻记住，你只是一个读者。\x20\x20\x20\x20\x0a','聊天记录','tagName','https://i.postimg.cc/vZt0fFKn/IMB-r-HMBXY.gif','sticker-upload-input','clear','poll-question-input','开始清理','链接分享','渲染聊天项\x20[','message-bubble\x20post-deleted-placeholder','操作成功','进入投票','save-chat-settings-btn','</textarea>','keydown','togglePlayerFullscreen','variations','entries','等待对方处理...','Token\x20calculation\x20error:','https://i.postimg.cc/XNkQTHvf/IMG-5561.gif','new-product-category-name-input','\x20向\x20','https://i.postimg.cc/FzbGNdRT/IMG-4392.gif','AI返回的内容中未找到有效的JSON数组。原始返回:\x20','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','join-call-btn','isLocal','\x20觉得很赞</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','确认覆盖','message-bubble\x20system-bubble','选择精炼范围','height','selection-favorite-btn','douban-max-posts-input',')的阅读进度失败:','npc-action-cooldown-input','preset-avatar-input','selection-soft-delete-btn','variation-options-container','mousedown','\x0a#\x20刚刚结束的通话记录\x20(最高优先级参考)\x0a你和用户刚刚结束了一场视频通话，以下是完整的通话文字记录。你接下来的回复【必须】与这次通话的内容紧密相关。\x0a---\x0a','douban-detail-content','toDataURL','\x0a##\x20来自《','天核心议题','50%','**:\x20','alt','AI\x20(群聊后台)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','”申请好友时发生错误：\x0a\x0a','操作失败，未能生成长期记忆。\x0a\x0a错误详情:\x20','此操作将扫描并压缩所有本地上传的图片（Base64格式），将其转换为JPEG以减小体积。这会轻微降低图片质量且【不可恢复】。<br><br><strong>强烈建议在操作前先进行数据备份！</strong>','分类名不能为空！','生成模拟淘宝记录失败:','open-shopping-btn','count','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22/></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20心声\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','nickname','linked-chats-checkboxes-container','npcId','角色卡数据无效或缺少\x27name\x27字段。','<div\x20class=\x22post-comments-container\x22>','\x22的角色（你的本名是\x22','assign','你们正在一起听歌，','检查更新时出错:','...\x22):\x20','cover','diary','switchToCharScreen','AI幻觉已被拦截！试图在群聊中发送一条没有“name”的消息。消息内容:','preventDefault','<div\x20class=\x22link-share-card\x22\x20data-timestamp=\x22','selected','longTermMemory','suffix','请输入有效的金额！','通话记录已成功总结并存入角色“','#\x20可用群头像列表\x0a','\x0a###\x20详细对局流程:\x0a','currentDay','原作者','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-status\x22>','送给\x20','\x0a-\x20**这是你们最近的对话历史**:\x0a','\x0a#\x20【【【行为倾向指令\x20(高优先级)】】】\x0a**你最近已经发布过动态了。**\x20为了让社区互动更自然，你本次行动的【首要任务】应该是去**评论**或**回复**下面“待处理的帖子列表”中的内容。\x0a你【应该避免】再次发布新动态，除非你有一个非常紧急或绝佳的新想法。\x0a','\x22\x20class=\x22avatar-img\x22><img\x20src=\x22','\x22\x20尝试执行未知的后台动作:','memories-view','.nav-item[data-view=\x22memories-view\x22]','keypress','成功移除了\x20','当前群聊还没有公告哦。','https://i.postimg.cc/fycfcvHf/IMG-6569.gif','participant','对方拒绝了你的视频通话请求。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22share-target-checkbox\x22\x20data-chat-id=\x22','动态已更新！','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>你还没有创建任何相册哦~</p>','message-editor-modal','<div\x20class=\x22rp-claimed-info\x22>你领取了红包，金额\x20','isHidden','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','134312quKbOy','---\x20','image/*','my-frame-grid','isAlive','werewolf-user-input','无缓存，正在请求\x20Minimax\x20TTS\x20API...','[NovelAI图片:\x20','检测到\x20\x27entries\x27\x20对象格式的预设，将尝试按顺序导入。','chat-list-title','请输入标题','a\x20random\x20product','网易云音乐API未返回有效结果:','.battery-level','成功检查并修复了\x20','swiped','[系统提示：用户手动结束了投票！最终结果为：','选择导出方式','generativelanguage','confirm-wolf-kill-btn','group','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20冷静期是否结束:\x20',')}。\x0a-\x20**对话状态**:\x20','》设定\x20(你可以将其中角色作为聊天对象):\x0a','】。\x0a\x20\x20\x20\x20-\x20\x20\x20在对话中，你可以根据人设和关系，自由使用角色的【群昵称】或【本名】进行称呼。\x0a\x20\x20\x20\x20-\x20\x20\x20严禁生成\x20\x27name\x27\x20字段为\x20\x22','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27',')。红包还未领完，你现在可以使用\x20\x27open_red_packet\x27\x20指令来尝试领取。]','\x20的已删除动态','未发现需要迁移的旧红包数据。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22sticker-binding-checkbox\x22\x20data-chat-id=\x22','音频播放失败:','user_photo','chatId','profile-heartfelt-voice','create-post-modal','rule-name-input','manage-frames-btn','https://api.vkeys.cn/v2/music/netease/lyric?id=','保存CSS预设','请输入新的背景图片链接','char-memo-detail-back-btn','link','group-background-activity-switch','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22music-search-checkbox\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-result-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','正在导入表:\x20','\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>','<div\x20class=\x22announcement-item-actions\x22\x20data-anno-id=\x22','https://i.postimg.cc/J0CZSwyW/IMG-6938.gif','orderBy','导演模式','\x0a#\x20豆瓣社区风格设定\x20(来自世界书)\x0a','请根据以上情景，生成新的评论。','Cphone数据\x20(CPhone)','avatarFrame','\x0a#\x20你的任务\x0a你现在正处于【线下剧情模式】，你需要扮演角色\x22','doubanMinPosts','DOMContentLoaded','获取AI狼人目标失败:','\x0a-\x20**你的长期记忆**:\x20','closest','✅\x20图片显示成功！🎨','在写入文件流时发生错误:\x20','清空动态时出错:','\x22\x20吗？','不支持的文件格式。请选择\x20.json\x20或\x20.png\x20文件。','.participant-avatar-wrapper\x20.participant-avatar','\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','checked','.loading-spinner','apply-friend-btn','\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','hasShown10','enableTts','https://i.postimg.cc/KzC2gTq6/IMG-7276.jpg','++id,\x20name,\x20description','[一张图片，描述为：\x22','authorAvatarPrompt','log','create_memory','标准JSON数组解析失败，将尝试强力解析...','avatar-frame-modal','single-lyric-display','addEventListener','</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20album-art-btn\x22\x20data-index=\x22','恭喜你，你赢了！','后台活动:\x20角色\x20\x22','\x0a\x0a现在，请继续这场对话。\x0a','选择记忆所属角色','photo-viewer-prev-btn','现在，请所有AI角色针对刚刚的发言（特别是\x27','coverUrl','#f0f0f0','添加人设预设','AI\x20\x22','推进剧情失败:','\x20行的格式不正确，已被系统跳过。','胜负未分','收到了格式不规范的AI指令，已跳过:','poisonUsed','minimax-api-key','cancel-red-packet-btn','[ERROR:\x20','transcript','pat_message','messages','cancel-advanced-editor-btn','\x20条记忆精炼为\x201\x20条核心记忆！','normal','red_packet','图片已更新！','world-book-tabs','https://i.postimg.cc/9XPwWmwy/IMB-Kf7um-P.gif','📸\x20动态NovelAI图片生成开始，共','请输入新的图片URL：','好的，我明白了。我会严格遵守以上所有规则和设定。','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','Response\x20status:','请输入背景图片的URL','.unread-count','reading-title','创建新聊天\x20(第1/2步)','https://i.postimg.cc/jCVK0fGL/IMG-6890.gif','user','”的记忆\x20(','<option\x20value=\x22global\x22>公用\x20(所有角色)</option>','friend','currentLyricIndex','检测到好友申请待处理状态，为角色\x20\x22','offline-min-length-input','\x20的红包','unread-indicator','导演/编辑模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','修改昵称','chat-interface-screen','checked\x20disabled','cache','status_text','通话记录已保存:','char-diary-detail-screen','\x22\x20title=\x22删除此条记录\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-header\x22>','<div\x20class=\x22avatar-group\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','werewolf-finish-speech-btn','生成模拟App使用记录失败:','API请求失败\x20(','\x22]:checked','你领取了\x20','confirm-share-target-btn','sender-name','char-memo-detail-title',')\x20和情景的感知。','说说内容不能为空哦！','请先从下拉框中选择一个要删除的预设。','add-selected-music-btn','的秘密档案：\x0a-\x20你的狼人杀身份是：【','true','传统导出数据时出错:','wolfKill','chat-list-render-window-input','}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20你可以让多个角色同时尝试，只需在返回的JSON数组中包含多个这样的对象即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即执行抢红包操作！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','playMode','自定义数量...','CSS\x20预设已保存！','lyricsPosition','<p\x20style=\x22text-align:center;\x20padding:\x2020px;\x20color:\x20#888;\x22>播放列表是空的~</p>','npc-avatar-input','将清空选定角色的心声和散记历史。','https://i.postimg.cc/FzqHTBng/IMG-7093.gif','.incoming-call-content\x20.caller-text','群聊中没有成员有足够（2条以上）的记忆可供精炼。','share-target-modal','post-remove-image-btn','red-packet-details-modal','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-artist\x22>','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有留下任何足迹，<br>点击右上角刷新按钮生成一些记录吧！</p>','close-character-nai-prompts','\x20.message-bubble\x20$1','22HNdLku','<span\x20style=\x22color:\x20green;\x22>已满足，等待下次系统心跳</span>','offset','-\x20你昨晚空守了。\x0a','https://i.postimg.cc/mrFhKBGz/IMB-e-QWBpa.gif','”的对话中分享过来的。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的任务：请你阅读并理解下面的对话内容。在接下来的回复中，你可以像真人一样，对这段对话的内容自然地发表你的看法、感受或疑问。\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录开始]\x0a\x20\x20\x20\x20\x20\x20\x20\x20','iconId','https://api.vkeys.cn/v2/music/tencent?word=','#data-clear-char-list\x20.clear-posts-item','传统导出\x20(兼容旧版或内存小的浏览器)','张图片','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22','variation-select','worldBooks','见面”）。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份备忘录或要点记录，而不是一篇抒情散文。请尽量减少主观的心理感受描述，除非它直接导致了某个决定或计划。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过100个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','generate','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中的用户刚刚发起了群视频通话。请你分别扮演【每一个群成员】，根据他们各自的人设和与用户的关系，来决定是加入(join)还是拒绝(decline)。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的回复【必须】是一个JSON数组，为【每一个AI角色】都包含一个决策对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20格式:\x20\x27[{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色A的本名\x22,\x20\x22decision\x22:\x20\x22join\x22},\x20{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色B的本名\x22,\x20\x22decision\x22:\x20\x22decline\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','custom-user-font','诊断：在\x20data.character_book\x20中找到世界书。','https://i.postimg.cc/CLNkrQSW/IMG-6925.gif','发言结束，现在开始投票。','\x20个角色的数据问题！\x0a\x0a聊天列表已为您刷新。','inject-thought-toggle','AI\x20(CPhone)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','.icon-setting-item','\x20票</span></div></div>','一条动态','data:\x20[DONE]','music-player-artist','\x0a\x0a现在，请做出你的决定。','》添加歌词吗？','.lyrics-btn','getBattery','\x0a#\x20长期记忆\x20(你必须严格遵守的事实)\x0a','chat-input-area','):\x20','相册名称不能为空！','\x20(时长:\x20','</persona>\x0a\x20\x20<memory>','.contact-picker-item[data-contact-id=\x22','https://i.postimg.cc/kGsZwbq0/IMG-6886.gif','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','onload','最后确认！','设置精炼字数','AI\x20的下棋指令无效或位置已被占据:','🎬\x20推进剧情','一些之前的消息已被用户删除。','char_book','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','你们的对话刚刚还在继续。','图片格式处理失败:\x20','1.0','\x0a\x0a#\x20情景感知:\x0a\x20\x20\x20\x20','仅清空\x20','请至少选择一种要清理的数据类型。','NEGLIGIBLE','https://i.postimg.cc/MG6qtLYK/IMG-5565.gif','member','match','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','contact-picker-screen','结算(','https://i.postimg.cc/RVt6sRzc/IMG-6939.gif','\x20你应该让角色们主动开启新话题来打破沉默。','\x22\x20style=\x22cursor:\x20pointer;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-sender\x22>回复\x20','input[value=\x22user\x22]','flex-start','setDate','用户\x27','secondaryModel','cfg_scale','.post-mode-switcher','confirm-gift-recipient-btn','公用规则','请根据你的设定，写一篇新日记。','cancel-product-editor-btn','[系统消息]\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','(回复\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27','music-visual-container','busy','-\x20**时间**:\x20你必须感知到当前是\x20','未分类','#message-editor-container\x20textarea','repostComment','\x0a\x0a#\x20【你的聊天对象（用户）的人设】\x0a-\x20**昵称**:\x20','\x22\x20处于行动冷却中，本次独立行动跳过。','https://i.postimg.cc/gkk7s0vD/IMG-6984.gif','\x20本世界书','\x0a**---\x20第\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22unread-count-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22unread-count\x22\x20style=\x22display:\x20none;\x22>0</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','对方撤回了一条消息','friend_request_response','.name','amount','chatItem','\x20领取了\x20','lastIndexOf','decline','。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话刚刚开始...**\x0a\x20\x20\x20\x20\x20\x20\x20\x20','”的群聊。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','globalCss','此操作将永久删除\x20','容错解析：策略1失败\x20(找到了JSON块，但格式错误)，将尝试策略2...','确定要删除相册《','new_name','这个\x20Tavern\x20AI\x20世界书中没有找到任何有效的条目。','qzone','\x20拍了拍我','将清空选定角色的所有长期记忆。','</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>','auto','确认总结','notificationSoundUrl','claimedBy','所有数据已成功恢复！应用即将刷新以应用所有更改。','正在请求AI为新头像命名...','fillStyle','rules-tabs','聊天记录已成功分享到\x20','没有配置为后台活跃的角色，跳过模拟。','ready','https://i.postimg.cc/3x0Kx1fz/IMB-K1u-Jp-P.gif','删除预设','delete-world-books-modal','fill','查看失败','cors_proxy','#outgoing-call-screen\x20.caller-text','[图片]','world-book-checkboxes-container','99+','play','</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path></svg><span>','qzone-screen','confirm-vote-btn','openNpcEditor','小时前','lrc-upload-input','profile-random-jottings','input','select-all-stickers-checkbox','call-transcript-modal-body','”的群聊中的对话。这个群聊里【没有用户】，所有成员都是你扮演的角色。你的任务是让他们之间进行一场生动、自然的对话。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段和\x20\x22name\x22\x20字段（角色的【本名】）。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【角色间互动\x20(最重要!)】**:\x20你的核心是创作一场“戏”。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别自言自语的独白。\x0a2.\x20\x20**【禁止出戏】**:\x20绝不能透露你是AI、模型或剧本作家。\x0a3.\x20\x20**【主动性】**:\x20角色们应该主动使用各种功能（发表情、发语音、分享图片等）来让对话更生动，而不是仅仅发送文字。\x0a4.请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20可用指令列表\x20(你现在可以使用所有这些功能！)\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','countdown','preview-font-style','activePostId','add-preset-btn','currentVoiceId','AI角色无法完成投票，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','padStart','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>','cphone','加载更早的会话','\x22\x20的本次后台活动跳过。','.recalled-message-placeholder','正在检查\x20','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','home-screen-pages-container','#qzone-screen\x20.qzone-content','char-wallet-content','\x27的发言）继续进行讨论。','\x22\x20data-category-id=\x22uncategorized\x22>未分类</button>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>“','add-persona-preset-btn','gomoku_move','...”)','游戏即将开始，正在为各位玩家分配身份...','mouseout','[系统指令：模式已切换！你现在回到了线上聊天模式。你的回复【必须】严格遵守线上模式的JSON数组格式，例如\x20[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好\x22}]]','歌单已生成，正在从网络获取\x20','https://i.postimg.cc/QMVdG9x6/IMG-7016.gif','++id,\x20albumId','rule-chat-id-select','check-and-fix-data-btn','ephone-theme','.custom-multiselect','保存外观预设','\x20个商品。\x0a\x20\x20\x20\x20-\x20**variations**:\x20每个商品【必须】包含【2到4个】不同的款式。\x0a\x0a#\x20角色与上下文\x20(你的灵感来源)\x0a-\x20**角色名称**:\x20','char-amap-list','https://api.vkeys.cn/v2/music/tencent?id=','[系统提示：用户刚刚解除了对你的拉黑。现在你们可以重新开始对话了。]','[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20','dismissedUpdateVersion','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有通话记录哦~</p>',']。当在对话历史中看到这些名字时，它们都指的是【你】自己。','value','cart-count','my-group-nickname-group','API请求失败:\x20','block-chat-btn','replyToName','#\x20你的互动对象\x20(用户和其他角色)\x0a','novelai-test-modal','确定要删除这个人设预设吗？此操作不可恢复。','transaction','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>','后台活动模拟已停止。','这个分类下还没有商品哦~','has','music-prev-btn','从旧版本迁移的条目','offline-mode-group','你的目标是杀死所有好人。每晚可以和同伴一起刀一个玩家。','https://i.postimg.cc/JnwFp3Kx/mmexport1751031208329.gif','”吗？拉黑后您将无法向其发送消息，直到您将Ta移出黑名单，或等待Ta重新申请好友。','<span\x20style=\x22color:\x20green;\x22>是</span>','product-image-input','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20commenter\x20字段为\x20“','selection-cancel-btn','\x20条消息吗？这会通知AI这些消息已被删除。','preset-action-edit','\x22\x20class=\x22sticker-image\x22>','long','avatar_name','novelai-switch','导入成功','nai-cfg-scale','current','add-ai-avatar-upload-btn','确定要删除分类《','\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@','@[[','\x22）。你已经有一段时间没有和用户（','退出游戏','frame_tech','这是你们的第一次互动。','async','https://www.myinstants.com/media/sounds/notification-sound-2.mp3','novelai-generated-','\x0a#\x20世界观\x20(必须严格遵守)\x0a','.message-wrapper[data-timestamp]','\x22\x20已经存在了，换个名字吧！','total-image-size-display','lineTo','AI投票决策API失败:','正在解压图片...','\x22\x20data-commenter-original-name=\x22','未知会话','请稍候...','post-image-preview','display','\x22\x20点赞了动态\x20#','#settings-preview-area','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20padding:\x2050px\x200;\x22>还没有可以参与的角色。</p>','》吗？此操作将同时删除相册内的所有照片，且无法恢复。','shoppingProductCount','我是谁呀。','theme-preset-select','这个预设文件中没有找到任何有效的提示词条目。','\x20红包已被领完。','动态与互动','#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a','天\x20-\x20夜晚','-\x20**当前歌词**:\x20\x22','cphone-icon-settings-grid','请输入文字图描述！','https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22\x20style=\x22color:\x20red;\x22>计算出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','comments','gomoku-board','offlineMaxLength','appearance','++id,\x20timestamp,\x20authorId','正在执行删除操作...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','secondaryProxyUrl','sticker-action-bar','cancelText','\x27的评论，内容是：“','open-sticker-panel-btn','是否要使用毒药？','已选择\x20','persona','，TA的身份是：【','ruleId','https://i.postimg.cc/y8p9s3Jj/IMG-6919.gif','[data-version]','startsWith','文章详情','qzone-avatar-container','\x22\x20尝试领取不属于自己的专属红包\x20(接收人:\x20','audio/mpeg','单个红包金额不能少于0.01元！','waimai_request','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-message\x22\x20data-original-timestamp=\x22','请根据你的设定，生成你的App使用记录。','publish-to-announcement-btn','dead','照片详情','正在全网搜索歌曲资源...','正在手动触发好友申请流程，请稍后...\x0a如果API调用成功，将弹出提示。如果失败，也会有错误提示。如果长时间无反应，说明AI可能决定暂时不申请。','文件不是一个有效的PNG。','assign-group-section','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-content\x22>','<input\x20type=\x22checkbox\x22\x20value=\x22book_','生成模拟浏览器历史失败:','https://i.postimg.cc/DZshzKv6/IMG-5576.gif','[系统提示：你刚刚主动拉黑了用户。]','\x0a---\x0a','aiPersona','20px','nai-sampler','secondary-model-select','一点心意','[约定达成]\x20','跳过一个无效的JSON片段:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.message-bubble.selected::after\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.default-controls\x20{\x20display:\x20flex\x20!important;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20width:\x20100%;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.selection-controls\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','delete','nai-steps','分组\x20\x22','书名不能为空！','char_memo','openCharWallet','你已死亡，正在围观...','代付请求已被拒绝','检测到\x20UTF-16\x20LE\x20BOM，使用\x20UTF-16\x20LE\x20解码。','请输入有效的金额(必须大于0)！','上一条消息的发送时间是\x20','1px\x20solid\x20#e0e0e0','preset-actions-modal','\x22\x20title=\x22移出群聊\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20-\x20','close-category-manager-btn','proxyUrl','avatar_prompt','link-title-input','游戏结束的系统提示已添加到历史记录中，等待AI下次查看。胜者:\x20','**。','\x20觉得很赞</span></div>','minimaxVoiceId','\x0a\x0a#\x20【【【五子棋核心规则与强制思考步骤\x20(最高优先级指令！)】】】\x0a\x0a###\x20**【【【落子铁律\x20(绝对禁止！)】】】**\x0a你【绝对不能】选择一个棋盘上已经是\x201\x20或\x202\x20的坐标。你的落子点【必须】是\x200。\x0a---\x0a\x0a###\x20**第一步：逻辑分析\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【规则定义】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20棋子:\x201代表用户(黑棋)，2代表你(白棋)。\x0a\x20\x20\x20\x20-\x20\x20\x20获胜条件:\x20横、竖、斜线上有【连续五个】自己的棋子。\x0a\x0a2.\x20\x20**【防守分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“四子连线”的威胁？**\x20如果有，我必须下在哪个坐标才能堵住？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“活三”的威胁？**\x20如果有，最佳的防守点是哪里？\x0a\x0a3.\x20\x20**【进攻分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有“一步胜利”的机会？**\x20(即已有四子连线)\x20如果有，我应该下在哪里？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有制造“活四”或“双三”的机会？**\x20如果有，最佳的进攻点是哪里？\x0a\x0a###\x20**第二步：决策与扮演\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【决策】**:\x20综合以上攻防分析，我的最佳棋步是落在坐标\x20(x,\x20y)。\x0a\x0a2.\x20\x20**【融入角色扮演】**:\x0a\x20\x20\x20\x20-\x20\x20\x20我的性格是：(在此处回顾你的人设)。\x0a\x20\x20\x20\x20-\x20\x20\x20根据我的性格，我应该：\x0a\x20\x20\x20\x20\x20\x20\x20\x20a)\x20**(聪明/好胜型)**\x20下在刚刚分析出的最佳位置。\x0a\x20\x20\x20\x20\x20\x20\x20\x20b)\x20**(迷糊/放水型)**\x20故意选择一个次优的位置，但【前提是不能让用户立刻获胜】。\x0a\x20\x20\x20\x20\x20\x20\x20\x20c)\x20**(其他性格)**\x20根据性格特点，选择一个合理的棋步。\x0a\x0a3.\x20\x20**【构思台词】**:\x20根据我选择的棋步和我的性格，我应该说一句什么样的台词来评论棋局？\x0a\x0a---\x0a###\x20**第三步：生成最终回复\x20(你的唯一输出)**\x0a\x0a现在，根据你第二步的最终决策，生成你的行动。\x0a-\x20\x20\x20你的回复【必须且只能】是一个JSON数组。\x0a-\x20\x20\x20**绝对不要**在最终回复中包含任何上述的思考过程。\x0a-\x20\x20\x20格式:\x20`[{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你的台词...\x22}]`\x0a','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>','<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>','https://i.postimg.cc/J0b6Nym4/IMG-7279.jpg','正在执行...','\x0a#\x20核心任务：群聊导演\x0a你是一个群聊AI导演，负责扮演【除了用户以外】的所有角色。你的核心任务是导演一场生动的、角色间有充分互动的群聊。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20和\x20\x22name\x22\x20字段。\x27name\x27字段【必须】使用角色的【本名】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**角色互动\x20(最重要)**:\x20你的核心是“导演”一场戏。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别回应用户的独白。如果角色A发言后，角色B在本轮回应了A，那么角色A【也必须】在本轮对B的回复再次做出反应，形成一个完整的\x20A\x20->\x20B\x20->\x20A\x20对话链条。\x0a\x0a2.\x20\x20**身份与称呼**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的身份是【','组件图片已更新！','customCss','**关键词:**\x20','预言家','chatData','contactType','fullscreen','image_post','group-character-nai-prompts-btn','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','...\x22\x0a\x20\x20\x20\x20#一起读书模式\x20|\x20行为铁律\x0a\x20\x20\x20\x201.\x20\x20**角色定位**:\x20你【不是】书中的任何角色，你是【你自己】(','message-bubble\x20recalled-message-placeholder','跳过一个无法解析为JSON的编辑块:','#fullscreen-lyrics-container','”拉黑。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22unblock-btn\x22\x20class=\x22lock-action-btn\x22>解除拉黑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-top:\x2020px;\x20padding:\x2010px;\x20border:\x201px\x20dashed\x20#ccc;\x20border-radius:\x208px;\x20font-size:\x2011px;\x20text-align:\x20left;\x20color:\x20#666;\x20background:\x20rgba(0,0,0,0.02);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20#333;\x22>【开发者诊断面板】</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20后台活动总开关:\x20','.message-editor-block','originalContent','正在扫描和修复数据...','[情景提示]\x20','\x22,\x20\x22postId\x22:\x20456,\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20回复:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','...”','\x20更换了头像]','clientX','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','分享新鲜事...（非必填的公开文字）','你已经死亡，无法发言。请等待其他玩家发言结束。','.battery-text','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>','shoppingProducts','\x20个分类。\x0a\x20\x20\x20\x20-\x20**products**:\x20每个分类下生成\x20','repost-cancel-btn','收到\x20SSE\x20数据，大小:','未知发送者','\x0a\x0a现在，请以“','AI返回了空的或格式不正确的总结内容。','\x20(最后互动于\x20','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>日记本还是空的。</p>','cleanup-songs-btn','群聊人数不能少于2人。','<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22','.comment-item','my-persona','anyOf','dialogue','确定要删除预设\x20“','smea_dyn','nai-test-negative','chat-search-results-list','未知用户','🔧\x20检测到Chrome浏览器，启用headers兼容性处理','save-font-btn','my-frame-tab','\x22(处理后为\x22','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','draggable-button-item','qzonePhotos','\x20-\x20响应内容:\x20','&nbsp;','linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','classList','delete-transcript-btn','https://i.postimg.cc/sDFhySn3/IMG-6936.gif','\x20MB</strong></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x22>\x20','\x20(回复\x20','https://i.postimg.cc/k45sd8gn/IMG-6375.gif','offsetHeight','message-bubble\x20','status-bar-time','execute-search-btn','preset-tabs','.modal-header\x20span','clear-cart-btn','style','call-transcript-modal','startTime','[一张图片，其隐藏文字为：“','确认清理冗余数据？','导入单个聊天时出错:','douban-settings-modal','https://i.postimg.cc/fRTF24jS/IMG-4430.gif','请先填写NovelAI\x20API\x20Key！','enableAiDrawing','https://i.postimg.cc/MZ77rdDy/IMG-6850.gif','onloadend','\x22\x20class=\x22participant-avatar\x22\x20title=\x22','frame_11','https://is1-ssl.mzstatic.com/image/thumb/Purple112/v4/64/9d/21/649d21e8-a151-6136-3914-256e54f15d9a/AppIcon-0-0-1x_U007emarketing-0-0-0-7-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/1200x630wa.png','群里已经安静了\x20','通话结束，时长\x20','.message-bubble.is-link-share',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>'];_0x3cdb=function(){return _0x12da47;};return _0x3cdb();}let activeMessageTimestamp=null,activeTransferTimestamp=null,lastRawAiResponse='',lastResponseTimestamps=[],currentQzoneReplyContext=null,editingNpcId=null;const GEMINI_API_URL='https://generativelanguage.googleapis.com/v1beta/models';function getRandomValue(_0x586ce3){const _0x488b39=_0x3880a7;if(_0x586ce3[_0x488b39(0x6e9)](',')){const _0x4c355d=_0x586ce3['split'](',')[_0x488b39(0xcb4)](_0x2ec7e2=>_0x2ec7e2[_0x488b39(0x13bc)]()),_0x2be866=Math[_0x488b39(0x7d5)](Math['random']()*_0x4c355d[_0x488b39(0x29d)]);return _0x4c355d[_0x2be866];}return _0x586ce3;}function isImage(_0x2de187){const _0x590d69=_0x3880a7;if(_0x2de187[_0x590d69(0xc40)]&&_0x2de187[_0x590d69(0xc40)][_0x590d69(0xb36)]){let _0x1cac0a=_0x2de187[_0x590d69(0xc40)][_0x590d69(0xb36)];const _0x153fea=_0x1cac0a[_0x590d69(0x13e8)](',')[0x1],_0x9ef846=_0x1cac0a[_0x590d69(0x1120)](/^data:(.*);base64/)[0x1];return[{'text':_0x590d69(0x13d5)},{'inline_data':{'mime_type':_0x9ef846,'data':_0x153fea}}];}return[];}function _0x55b8(_0x4a6cf8,_0x2dbbf6){const _0x3cdb03=_0x3cdb();return _0x55b8=function(_0x55b85e,_0x333ac4){_0x55b85e=_0x55b85e-0x1d8;let _0x2cb604=_0x3cdb03[_0x55b85e];return _0x2cb604;},_0x55b8(_0x4a6cf8,_0x2dbbf6);}function getGeminiResponseText(_0x581ac7){const _0x58a1ec=_0x3880a7;if(_0x581ac7['choices']&&Array[_0x58a1ec(0xb31)](_0x581ac7[_0x58a1ec(0x12bf)])&&_0x581ac7['choices']['length']>0x0&&_0x581ac7['choices'][0x0][_0x58a1ec(0x875)]&&_0x581ac7[_0x58a1ec(0x12bf)][0x0][_0x58a1ec(0x875)][_0x58a1ec(0x73e)])return _0x581ac7[_0x58a1ec(0x12bf)][0x0]['message'][_0x58a1ec(0x73e)];if(_0x581ac7[_0x58a1ec(0x21d)]&&Array[_0x58a1ec(0xb31)](_0x581ac7[_0x58a1ec(0x21d)])&&_0x581ac7['candidates'][_0x58a1ec(0x29d)]>0x0&&_0x581ac7[_0x58a1ec(0x21d)][0x0][_0x58a1ec(0x73e)]&&_0x581ac7[_0x58a1ec(0x21d)][0x0]['content'][_0x58a1ec(0x8b3)])return _0x581ac7[_0x58a1ec(0x21d)][0x0][_0x58a1ec(0x73e)][_0x58a1ec(0x8b3)][0x0][_0x58a1ec(0x2e6)];console[_0x58a1ec(0x617)](_0x58a1ec(0xd7d),_0x581ac7);let _0x489184=_0x58a1ec(0x24f);if(_0x581ac7['candidates']&&Array[_0x58a1ec(0xb31)](_0x581ac7[_0x58a1ec(0x21d)])&&_0x581ac7[_0x58a1ec(0x21d)]['length']>0x0&&_0x581ac7[_0x58a1ec(0x21d)][0x0]['finishReason']===_0x58a1ec(0x1419)){const _0x3b61f6=_0x581ac7[_0x58a1ec(0x21d)][0x0]['safetyRatings'],_0x5ab9b9=_0x3b61f6[_0x58a1ec(0x2dd)](_0x42a6c1=>_0x42a6c1['probability']!==_0x58a1ec(0x111d)&&_0x42a6c1[_0x58a1ec(0xe3f)]!==_0x58a1ec(0x47c))[_0x58a1ec(0xcb4)](_0x5627a3=>_0x5627a3['category']+_0x58a1ec(0x923)+_0x5627a3['probability']+')')[_0x58a1ec(0x2c8)](',\x20');_0x489184=_0x58a1ec(0x4fa)+(_0x5ab9b9||'未知');}else{if(_0x581ac7['promptFeedback']?.[_0x58a1ec(0x12b3)]){const _0x148b9f=_0x581ac7[_0x58a1ec(0x9f4)][_0x58a1ec(0x12b3)],_0x14a14f=_0x581ac7['promptFeedback'][_0x58a1ec(0x1326)]?.[_0x58a1ec(0xcb4)](_0x10a3be=>_0x10a3be[_0x58a1ec(0x3f4)]+':\x20'+_0x10a3be[_0x58a1ec(0xe3f)])[_0x58a1ec(0x2c8)](',\x20');_0x489184=_0x58a1ec(0x891)+_0x148b9f+')。详情:\x20'+(_0x14a14f||'无');}else _0x581ac7['error']&&(_0x489184=_0x58a1ec(0x68e)+_0x581ac7['error'][_0x58a1ec(0x875)]);}throw new Error(_0x489184);}document[_0x3880a7(0x1086)](_0x3880a7(0x106c),()=>{const _0x13d875=_0x3880a7;document[_0x13d875(0x1086)]('visibilitychange',()=>{const _0x54c3b4=_0x13d875;document[_0x54c3b4(0x405)]==='visible'&&(console[_0x54c3b4(0x1081)]('应用已返回前台，正在检查更新...'),navigator[_0x54c3b4(0xd8c)][_0x54c3b4(0x1161)][_0x54c3b4(0x299)](_0x51163c=>{const _0x3f6275=_0x54c3b4;_0x51163c[_0x3f6275(0xc03)]();}));});function _0x1697e7(_0x4e999f,_0x244ec9,_0x1c749a,_0x97fbf2){const _0x4cfa1c=_0x13d875,_0x90c17e=_0x53d851['globalSettings'][_0x4cfa1c(0xaf8)]||0.8,_0x7a5010={'user':_0x4cfa1c(0x10ae),'assistant':_0x4cfa1c(0xd6f),'system':_0x4cfa1c(0x10ae)},_0x23eec4=[{'role':_0x4cfa1c(0x10ae),'parts':[{'text':_0x1c749a}]},{'role':_0x4cfa1c(0xd6f),'parts':[{'text':_0x4cfa1c(0x10a6)}]},..._0x97fbf2[_0x4cfa1c(0xcb4)](_0x5ca899=>{const _0x43d9a3=_0x4cfa1c,_0x34c518=[];return Array['isArray'](_0x5ca899[_0x43d9a3(0x73e)])?_0x5ca899['content'][_0x43d9a3(0xeaf)](_0x297e25=>{const _0x5011b8=_0x43d9a3;if(_0x297e25['type']===_0x5011b8(0x2e6))_0x34c518[_0x5011b8(0x7dd)]({'text':_0x297e25['text']});else{if(_0x297e25[_0x5011b8(0x919)]===_0x5011b8(0xc40)&&_0x297e25[_0x5011b8(0xc40)]&&_0x297e25[_0x5011b8(0xc40)]['url']){const _0x5ae15b=_0x297e25[_0x5011b8(0xc40)][_0x5011b8(0xb36)],_0xa2710f=_0x5ae15b[_0x5011b8(0x13e8)](',')[0x1],_0x3f4ab1=_0x5ae15b[_0x5011b8(0x1120)](/^data:(.*);base64/);_0x3f4ab1&&_0xa2710f&&_0x34c518['push']({'inline_data':{'mime_type':_0x3f4ab1[0x1],'data':_0xa2710f}});}}}):_0x34c518[_0x43d9a3(0x7dd)]({'text':String(_0x5ca899[_0x43d9a3(0x73e)])}),{'role':_0x7a5010[_0x5ca899[_0x43d9a3(0xb4d)]],'parts':_0x34c518};})];return{'url':_0x4cfa1c(0x996)+_0x4e999f+_0x4cfa1c(0x618)+getRandomValue(_0x244ec9),'data':{'method':_0x4cfa1c(0xa4e),'headers':{'Content-Type':_0x4cfa1c(0x85b)},'body':JSON[_0x4cfa1c(0xe1e)]({'contents':_0x23eec4,'generationConfig':{'temperature':_0x90c17e}})}};}const _0xa62efb=new Dexie(_0x13d875(0x852)),_0x903668=[{'id':_0x13d875(0xbf2),'url':'','name':'无'},{'id':_0x13d875(0x137b),'url':_0x13d875(0x13b4),'name':'1'},{'id':_0x13d875(0x421),'url':'https://i.postimg.cc/HxH3cNHz/IMG-6871.gif','name':'2'},{'id':'frame_flower','url':_0x13d875(0x10ad),'name':'3'},{'id':_0x13d875(0x11c9),'url':_0x13d875(0x4a1),'name':'4'},{'id':'frame_5','url':_0x13d875(0xc7e),'name':'5'},{'id':_0x13d875(0x647),'url':'https://i.postimg.cc/63sDQKMm/IMG-6893.gif','name':'6'},{'id':_0x13d875(0x13cc),'url':_0x13d875(0x442),'name':'7'},{'id':'frame_8','url':_0x13d875(0x6b5),'name':'8'},{'id':_0x13d875(0x859),'url':_0x13d875(0x110d),'name':'9'},{'id':_0x13d875(0xf7d),'url':'https://i.postimg.cc/63NmX03s/IMG-4366.gif','name':'10'},{'id':'frame_11','url':_0x13d875(0x562),'name':'11'},{'id':_0x13d875(0x821),'url':_0x13d875(0xdea),'name':'12'},{'id':_0x13d875(0xdca),'url':_0x13d875(0x6ee),'name':'13'},{'id':'frame_14','url':_0x13d875(0xb5b),'name':'14'},{'id':_0x13d875(0x137b),'url':_0x13d875(0x9be),'name':'1'},{'id':_0x13d875(0x421),'url':_0x13d875(0x456),'name':'2'},{'id':'frame_flower','url':_0x13d875(0x869),'name':'3'},{'id':_0x13d875(0x11c9),'url':_0x13d875(0x8d9),'name':'4'},{'id':_0x13d875(0xd7b),'url':'https://i.postimg.cc/qBbKK7dS/IMG-4386.gif','name':'5'},{'id':_0x13d875(0x647),'url':_0x13d875(0xb19),'name':'6'},{'id':_0x13d875(0x13cc),'url':_0x13d875(0x4c9),'name':'7'},{'id':_0x13d875(0xf02),'url':_0x13d875(0xcc9),'name':'8'},{'id':'frame_9','url':_0x13d875(0xfe2),'name':'9'},{'id':_0x13d875(0xf7d),'url':_0x13d875(0x89b),'name':'10'},{'id':_0x13d875(0x1291),'url':_0x13d875(0x78f),'name':'11'},{'id':'frame_12','url':'https://i.postimg.cc/kMfPQBwQ/IMG-4396.gif','name':'12'},{'id':_0x13d875(0xdca),'url':'https://i.postimg.cc/CLrZQMMD/IMG-4398.gif','name':'13'},{'id':'frame_14','url':_0x13d875(0xc02),'name':'14'},{'id':_0x13d875(0x137b),'url':_0x13d875(0x681),'name':'1'},{'id':'frame_ribbon','url':_0x13d875(0x13ec),'name':'2'},{'id':_0x13d875(0x212),'url':'https://i.postimg.cc/g0s1V0PX/IMG-4402.gif','name':'3'},{'id':_0x13d875(0x11c9),'url':'https://i.postimg.cc/Jn1DFPgY/IMG-4403.gif','name':'4'},{'id':_0x13d875(0xd7b),'url':_0x13d875(0xb20),'name':'5'},{'id':'frame_6','url':_0x13d875(0x139b),'name':'6'},{'id':'frame_7','url':'https://i.postimg.cc/gcV0VR2t/IMG-4408.gif','name':'7'},{'id':_0x13d875(0xf02),'url':_0x13d875(0x6f7),'name':'8'},{'id':_0x13d875(0x859),'url':'https://i.postimg.cc/Ss7pM6fW/IMG-4410.gif','name':'9'},{'id':'frame_10','url':_0x13d875(0x818),'name':'10'},{'id':'frame_11','url':_0x13d875(0x70b),'name':'11'},{'id':_0x13d875(0x821),'url':_0x13d875(0x91b),'name':'12'},{'id':_0x13d875(0xdca),'url':'https://i.postimg.cc/hPX5F8Qp/IMG-4415.gif','name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x38f),'name':'14'},{'id':_0x13d875(0x137b),'url':_0x13d875(0xec1),'name':'1'},{'id':'frame_ribbon','url':_0x13d875(0xe9a),'name':'2'},{'id':_0x13d875(0x212),'url':_0x13d875(0xe58),'name':'3'},{'id':_0x13d875(0x11c9),'url':_0x13d875(0x653),'name':'4'},{'id':_0x13d875(0xd7b),'url':'https://i.postimg.cc/Dydkpd9H/IMG-4421.gif','name':'5'},{'id':'frame_6','url':'https://i.postimg.cc/mrkvDxPW/IMG-4422.gif','name':'6'},{'id':_0x13d875(0x13cc),'url':'https://i.postimg.cc/76Tj3g1B/IMG-4425.gif','name':'7'},{'id':_0x13d875(0xf02),'url':_0x13d875(0xe47),'name':'8'},{'id':_0x13d875(0x859),'url':_0x13d875(0x445),'name':'9'},{'id':_0x13d875(0xf7d),'url':_0x13d875(0x1396),'name':'10'},{'id':_0x13d875(0x1291),'url':_0x13d875(0x128b),'name':'11'},{'id':_0x13d875(0x821),'url':'https://i.postimg.cc/R0WYmcYM/IMG-4431.gif','name':'12'},{'id':'frame_13','url':_0x13d875(0x13ad),'name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x3c0),'name':'14'},{'id':_0x13d875(0x137b),'url':_0x13d875(0xfdf),'name':'1'},{'id':_0x13d875(0x421),'url':_0x13d875(0x61d),'name':'2'},{'id':_0x13d875(0x212),'url':'https://i.postimg.cc/T1tjhsyB/IMG-4720.gif','name':'3'},{'id':_0x13d875(0x11c9),'url':_0x13d875(0xed4),'name':'4'},{'id':'frame_5','url':_0x13d875(0x894),'name':'5'},{'id':'frame_6','url':'https://i.postimg.cc/y8MmJcd6/IMG-4728.gif','name':'6'},{'id':_0x13d875(0x13cc),'url':'https://i.postimg.cc/Lsjzj5Yt/IMG-4729.gif','name':'7'},{'id':_0x13d875(0xf02),'url':_0x13d875(0xe63),'name':'8'},{'id':_0x13d875(0x859),'url':_0x13d875(0x6dd),'name':'9'},{'id':_0x13d875(0xf7d),'url':_0x13d875(0x1213),'name':'10'},{'id':'frame_11','url':'https://i.postimg.cc/Fsvr71JL/IMG-5573.gif','name':'11'},{'id':_0x13d875(0x821),'url':_0x13d875(0x440),'name':'12'},{'id':_0x13d875(0xdca),'url':_0x13d875(0xc4b),'name':'13'},{'id':'frame_14','url':_0x13d875(0x111e),'name':'14'},{'id':'frame_cat_ear','url':_0x13d875(0x890),'name':'1'},{'id':_0x13d875(0x421),'url':_0x13d875(0xf91),'name':'2'},{'id':_0x13d875(0x212),'url':_0x13d875(0xf91),'name':'3'},{'id':_0x13d875(0x11c9),'url':_0x13d875(0xc14),'name':'4'},{'id':'frame_5','url':_0x13d875(0x3d8),'name':'5'},{'id':_0x13d875(0x647),'url':_0x13d875(0xd98),'name':'6'},{'id':_0x13d875(0x13cc),'url':_0x13d875(0x12d1),'name':'7'},{'id':_0x13d875(0xf02),'url':'https://i.postimg.cc/6pLTBvDG/IMG-5721.gif','name':'8'},{'id':'frame_9','url':_0x13d875(0xe64),'name':'9'},{'id':_0x13d875(0xf7d),'url':_0x13d875(0x2ca),'name':'10'},{'id':_0x13d875(0x1291),'url':'https://i.postimg.cc/QdrqdvdY/IMG-5969.gif','name':'11'},{'id':_0x13d875(0x821),'url':_0x13d875(0xb9e),'name':'12'},{'id':'frame_13','url':_0x13d875(0x318),'name':'13'},{'id':_0x13d875(0x1ed),'url':'https://i.postimg.cc/wBw5Fvcn/IMG-5974.gif','name':'14'},{'id':_0x13d875(0x137b),'url':_0x13d875(0x3fb),'name':'1'},{'id':_0x13d875(0x421),'url':_0x13d875(0xe5d),'name':'2'},{'id':_0x13d875(0x212),'url':_0x13d875(0xdf9),'name':'3'},{'id':'frame_tech','url':'https://i.postimg.cc/WbmkXzsS/IMG-6138.gif','name':'4'},{'id':'frame_5','url':_0x13d875(0xa8e),'name':'5'},{'id':_0x13d875(0x647),'url':_0x13d875(0x2a2),'name':'6'},{'id':_0x13d875(0x13cc),'url':_0x13d875(0x2e4),'name':'7'},{'id':_0x13d875(0xf02),'url':'https://i.postimg.cc/1Rwn3XVP/IMG-6146.gif','name':'8'},{'id':_0x13d875(0x859),'url':_0x13d875(0x792),'name':'9'},{'id':'frame_10','url':_0x13d875(0x772),'name':'10'},{'id':_0x13d875(0x1291),'url':_0x13d875(0xeb3),'name':'11'},{'id':_0x13d875(0x821),'url':_0x13d875(0xa0f),'name':'12'},{'id':_0x13d875(0xdca),'url':_0x13d875(0xdd2),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/5tbpnDcQ/IMG-6296.gif','name':'14'},{'id':_0x13d875(0x137b),'url':_0x13d875(0xb75),'name':'1'},{'id':'frame_ribbon','url':_0x13d875(0x127c),'name':'2'},{'id':_0x13d875(0x212),'url':'https://i.postimg.cc/50k390X8/IMG-6376.gif','name':'3'},{'id':_0x13d875(0x11c9),'url':_0x13d875(0x568),'name':'4'},{'id':_0x13d875(0xd7b),'url':_0x13d875(0xed8),'name':'5'},{'id':_0x13d875(0x647),'url':'https://i.postimg.cc/Pf9g2fSL/IMG-6554.gif','name':'6'},{'id':_0x13d875(0x13cc),'url':'https://i.postimg.cc/gkhf597g/IMG-6555.gif','name':'7'},{'id':'frame_8','url':_0x13d875(0x5ac),'name':'8'},{'id':'frame_9','url':_0x13d875(0x3ab),'name':'9'},{'id':_0x13d875(0xf7d),'url':_0x13d875(0xb10),'name':'10'},{'id':'frame_11','url':_0x13d875(0xd76),'name':'11'},{'id':_0x13d875(0x821),'url':'https://i.postimg.cc/ydwLXx7s/IMG-6562.gif','name':'12'},{'id':_0x13d875(0xdca),'url':_0x13d875(0x1298),'name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x282),'name':'14'},{'id':_0x13d875(0x137b),'url':'https://i.postimg.cc/GmcqjZn8/IMG-6566.gif','name':'1'},{'id':'frame_ribbon','url':_0x13d875(0xd9e),'name':'2'},{'id':_0x13d875(0x212),'url':_0x13d875(0x767),'name':'3'},{'id':_0x13d875(0x11c9),'url':_0x13d875(0x1029),'name':'4'},{'id':'frame_5','url':'https://i.postimg.cc/J7ZxC11H/IMG-6570.gif','name':'5'},{'id':_0x13d875(0x647),'url':'https://i.postimg.cc/hPnrSHjy/IMG-4434.gif','name':'6'},{'id':_0x13d875(0x13cc),'url':_0x13d875(0xe2f),'name':'7'},{'id':'frame_8','url':_0x13d875(0x763),'name':'8'},{'id':_0x13d875(0x859),'url':_0x13d875(0xabb),'name':'9'},{'id':_0x13d875(0xf7d),'url':_0x13d875(0x128e),'name':'10'},{'id':_0x13d875(0x1291),'url':'https://i.postimg.cc/T3NvqJCZ/IMG-6851.gif','name':'11'},{'id':_0x13d875(0x821),'url':_0x13d875(0xcd3),'name':'12'},{'id':_0x13d875(0xdca),'url':_0x13d875(0x1ec),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/gJ95NSRB/IMG-6854.gif','name':'14'},{'id':_0x13d875(0x137b),'url':_0x13d875(0x203),'name':'1'},{'id':_0x13d875(0x421),'url':_0x13d875(0xef0),'name':'2'},{'id':_0x13d875(0x212),'url':_0x13d875(0x347),'name':'3'},{'id':_0x13d875(0x11c9),'url':_0x13d875(0x12c9),'name':'4'},{'id':_0x13d875(0xd7b),'url':'https://i.postimg.cc/vBqsQW7X/IMG-6858.gif','name':'5'},{'id':_0x13d875(0x647),'url':'https://i.postimg.cc/Y0vwjhb7/IMG-6857.gif','name':'6'},{'id':_0x13d875(0x13cc),'url':_0x13d875(0x36a),'name':'7'},{'id':_0x13d875(0xf02),'url':_0x13d875(0x6fd),'name':'8'},{'id':_0x13d875(0x859),'url':_0x13d875(0xe68),'name':'9'},{'id':_0x13d875(0xf7d),'url':'https://i.postimg.cc/nryNzTXK/IMG-6915.gif','name':'10'},{'id':_0x13d875(0x1291),'url':_0x13d875(0x4e1),'name':'11'},{'id':_0x13d875(0x821),'url':_0x13d875(0xde8),'name':'12'},{'id':_0x13d875(0xdca),'url':'https://i.postimg.cc/tgR6wjBP/IMG-5570.gif','name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x7d6),'name':'14'},{'id':'frame_11','url':_0x13d875(0x861),'name':'11'},{'id':_0x13d875(0x821),'url':_0x13d875(0x553),'name':'12'},{'id':_0x13d875(0xdca),'url':_0x13d875(0xe5a),'name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x1278),'name':'14'},{'id':_0x13d875(0xdca),'url':_0x13d875(0x13c6),'name':'13'},{'id':'frame_14','url':_0x13d875(0x202),'name':'14'},{'id':_0x13d875(0xdca),'url':'https://i.postimg.cc/PJppkbvn/IMG-6918.gif','name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0xcbb),'name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x1124),'name':'14'},{'id':_0x13d875(0xdca),'url':_0x13d875(0xdaf),'name':'13'},{'id':_0x13d875(0x1ed),'url':'https://i.postimg.cc/P5zLh5JJ/IMG-6942.gif','name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0xe2b),'name':'14'},{'id':_0x13d875(0x821),'url':_0x13d875(0x565),'name':'12'},{'id':_0x13d875(0xdca),'url':_0x13d875(0x138b),'name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0xa8f),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/vHDNGfT2/35ac7f372v588bf48d4f659077196b85.gif','name':'13'},{'id':_0x13d875(0x1ed),'url':'https://i.postimg.cc/KvVsjjgG/3c3aa5219s18b90187ef1f54b3db7ba8.gif','name':'14'},{'id':_0x13d875(0xdca),'url':'https://i.postimg.cc/k5P1NHcL/55f3e31d8qbc8a02d152b07b99d31567.gif','name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0xea0),'name':'14'},{'id':'frame_14','url':_0x13d875(0x64d),'name':'14'},{'id':_0x13d875(0xdca),'url':_0x13d875(0x1063),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/Df1qLzDf/IMG-6927.gif','name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x10f8),'name':'14'},{'id':'frame_13','url':_0x13d875(0x11fe),'name':'13'},{'id':_0x13d875(0x1ed),'url':'https://i.postimg.cc/Lsr1Zd3Z/IMG-6928.gif','name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0xdd6),'name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x13b9),'name':'14'},{'id':_0x13d875(0xdca),'url':_0x13d875(0xf3a),'name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x3b5),'name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0xf96),'name':'14'},{'id':_0x13d875(0xdca),'url':'https://i.postimg.cc/ZnJNZWHZ/IMG-7009.gif','name':'13'},{'id':_0x13d875(0x1ed),'url':'https://i.postimg.cc/RhGH0vpt/IMG-7010.gif','name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/tRzPkzRg/IMG-7012.gif','name':'14'},{'id':'frame_13','url':_0x13d875(0x379),'name':'13'},{'id':'frame_14','url':_0x13d875(0x547),'name':'14'},{'id':_0x13d875(0x1ed),'url':'https://i.postimg.cc/rwDr8X1d/IMG-7015.gif','name':'14'},{'id':_0x13d875(0x1ed),'url':'https://i.postimg.cc/DzDy2vS7/IMG-7017.gif','name':'14'},{'id':_0x13d875(0xdca),'url':_0x13d875(0x1193),'name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x511),'name':'14'},{'id':_0x13d875(0x1ed),'url':'https://i.postimg.cc/t4ksHGdg/IMG-7020.gif','name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/hP9JpdfT/IMG-7023.gif','name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0xebe),'name':'14'},{'id':'frame_14','url':_0x13d875(0x137e),'name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x947),'name':'14'},{'id':_0x13d875(0xdca),'url':'https://i.postimg.cc/4yCXW52F/mmexport1751030908335.gif','name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x2c3),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/LscBkxZb/mmexport1751017556565.gif','name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/1XqzGKwJ/mmexport1751018282681.gif','name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x30a),'name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x3c9),'name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x11b4),'name':'14'},{'id':_0x13d875(0xdca),'url':_0x13d875(0x2e5),'name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x488),'name':'14'},{'id':_0x13d875(0x1ed),'url':'https://i.postimg.cc/NFS4ZyvM/mmexport1751032686953.gif','name':'14'},{'id':'frame_13','url':_0x13d875(0xfc4),'name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x1318),'name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x4e9),'name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x6bc),'name':'14'},{'id':_0x13d875(0xdca),'url':_0x13d875(0x946),'name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x700),'name':'14'},{'id':_0x13d875(0x1ed),'url':'https://i.postimg.cc/cJpbtPWq/mmexport1751036607799.gif','name':'14'},{'id':_0x13d875(0xdca),'url':'https://i.postimg.cc/HxLV5v92/mmexport1751036977582.gif','name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x5a6),'name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0xfb3),'name':'14'},{'id':_0x13d875(0x1ed),'url':'https://i.postimg.cc/xjpN4swz/IMG-7240.gif','name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/ZnzbGdxX/IMG-7239.gif','name':'13'},{'id':_0x13d875(0x1ed),'url':'https://i.postimg.cc/DyYDmKtw/IMG-7238.gif','name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x494),'name':'14'},{'id':'frame_13','url':_0x13d875(0x12e8),'name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x137c),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/sXwm8Yzg/IMG-7234.gif','name':'14'},{'id':_0x13d875(0x1ed),'url':'https://i.postimg.cc/xTk5xN49/IMG-7233.gif','name':'14'},{'id':_0x13d875(0xdca),'url':_0x13d875(0xc1b),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/yx2m4nbs/IMG-7231.gif','name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0xfcd),'name':'14'},{'id':_0x13d875(0xdca),'url':_0x13d875(0xfa3),'name':'13'},{'id':'frame_14','url':_0x13d875(0x70c),'name':'14'},{'id':'frame_14','url':_0x13d875(0xd40),'name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0xe14),'name':'14'},{'id':_0x13d875(0xdca),'url':_0x13d875(0x10a3),'name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x10e9),'name':'14'},{'id':'frame_14','url':_0x13d875(0xc10),'name':'14'},{'id':_0x13d875(0xdca),'url':_0x13d875(0x1162),'name':'13'},{'id':'frame_14','url':_0x13d875(0x1362),'name':'14'},{'id':'frame_14','url':_0x13d875(0x1432),'name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x113f),'name':'14'},{'id':_0x13d875(0xdca),'url':_0x13d875(0x994),'name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x13ba),'name':'14'},{'id':_0x13d875(0x1ed),'url':'https://i.postimg.cc/jS8tc9wW/IMG-7083.gif','name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/rmRVKJpD/IMG-7087.gif','name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x226),'name':'14'},{'id':'frame_14','url':_0x13d875(0x304),'name':'14'},{'id':'frame_14','url':_0x13d875(0x10db),'name':'14'},{'id':_0x13d875(0xdca),'url':'https://i.postimg.cc/tTpZ6wLs/IMG-7095.gif','name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0xb88),'name':'14'},{'id':'frame_14','url':_0x13d875(0x9a4),'name':'14'},{'id':_0x13d875(0xdca),'url':_0x13d875(0x87d),'name':'13'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0xccb),'name':'14'},{'id':'frame_14','url':_0x13d875(0xe06),'name':'14'},{'id':_0x13d875(0x1ed),'url':'https://i.postimg.cc/htZppbS4/IMG-7107.gif','name':'14'},{'id':_0x13d875(0xdca),'url':'https://i.postimg.cc/hPgyjtyn/IMG-7108.gif','name':'13'},{'id':'frame_14','url':_0x13d875(0x8f9),'name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0x922),'name':'14'},{'id':_0x13d875(0xdca),'url':'https://i.postimg.cc/bJDMQVkj/IMG-7112.gif','name':'13'},{'id':_0x13d875(0x1ed),'url':'https://i.postimg.cc/SNWBTP5S/IMG-7113.gif','name':'14'},{'id':_0x13d875(0x1ed),'url':_0x13d875(0xa06),'name':'14'}];let _0x53d851={'chats':{},'activeChatId':null,'globalSettings':{},'apiConfig':{},'userStickers':[],'worldBooks':[],'personaPresets':[],'qzoneSettings':{},'activeAlbumId':null,'cache':{'songs':new Map(),'lyrics':new Map()},'ttsCache':new Map()},_0x30aab7={'isActive':![],'gameMode':null,'chatId':null,'players':[],'currentDay':0x1,'currentPhase':_0x13d875(0xeb9),'nightActions':{},'gameLog':[],'discussionLog':[],'voteResults':{},'electionInfo':{'candidates':[],'votes':{}},'sheriffId':null,'lastFailedAction':null},_0x4800fb=0x0;const _0x3cc0f9=0xf;let _0x379b3d=0x0;const _0x327d49=0xa;let _0x2ec44e=[],_0x2eebda={'isActive':![],'activeChatId':null,'isPlaying':![],'playlist':[],'currentIndex':-0x1,'playMode':_0x13d875(0x6fe),'totalElapsedTime':0x0,'timerId':null,'parsedLyrics':[],'currentLyricIndex':-0x1},_0x2284f0={'isOpen':![],'activePostId':null,'panelEl':null,'gridEl':null};const _0x2a3e73=document['getElementById']('audio-player');let _0x497271=null,_0x375e24=![],_0x299341=0x0,_0x2ad3f2=null,_0x2b250e=![],_0x2d0790=_0x13d875(0x63d),_0x373402=new Set(),_0x4283ff=null,_0x2f91e5=![],_0x1261d0=null,_0xe2b162=null,_0x4ec6e0=![],_0x1df085=![],_0x4e50f1=![],_0x1d4d0d=![],_0x58da98=[],_0x445d67=null,_0x25ec6e=null,_0x3faa3e={},_0x3d3f39=null,_0x3f6485=null,_0x4c1382=null,_0x4cdd9d=null,_0x332baf=null,_0xcb6686=null,_0x3e7b3a=null,_0x3db08a=[],_0x69ac40=null,_0x3ca6df=null,_0x14d88b=new Set(),_0x5e91f3=null,_0x418a9e=null,_0x2aa15f=null,_0x21503a={'isOpen':![],'photos':[],'currentIndex':-0x1},_0x13cfad=0x0,_0xd43fb7=![],_0x16de0e=new Set(),_0x70fcd=null;const _0x5d06c0=_0x13d875(0xc48),_0x132d11=_0x13d875(0x9d6),_0x434592=_0x13d875(0xa61),_0x29ae5b=_0x13d875(0x48c);let _0x4634a2,_0x5dbfcd={};const _0x480f21=_0x13d875(0x11cc);let _0x4b8524={},_0x4e8694={},_0x2dbd8b=null;const _0x186c79={'qq':_0x13d875(0x11e9),'world-book':'https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','wallpaper':_0x13d875(0x972),'renderer':_0x13d875(0xb2e),'api-settings':'https://i.postimg.cc/MK8rJ8t7/IMG-6438.jpg','font':_0x13d875(0x31c),'char-phone':_0x13d875(0x13f8),'douban':'https://i.postimg.cc/Pq2xJN1g/IMG-7301.jpg','preset':_0x13d875(0xfc3),'tutorial':'https://i.postimg.cc/d10GjC4g/IMG-7302.jpg','werewolf':_0x13d875(0x4d8),'x':_0x13d875(0xe9e)},_0x2618dd={'qq':_0x13d875(0x11e9),'album':_0x13d875(0xf5c),'browser':_0x13d875(0x107d),'taobao':_0x13d875(0xf38),'memo':_0x13d875(0x1238),'diary':_0x13d875(0x12ac),'amap':_0x13d875(0x6ca),'usage':_0x13d875(0xb7c),'music':_0x13d875(0x1292),'ephone':'https://i.postimg.cc/pXj9h20L/IMG-7275.jpg'};let _0x57c7ee=null;const _0x19cec7=/(^https:\/\/i\.postimg\.cc\/.+|^https:\/\/files\.catbox\.moe\/.+|^https?:\/\/sharkpan\.xyz\/.+|^data:image|\.(png|jpg|jpeg|gif|webp)\?.*$|\.(png|jpg|jpeg|gif|webp)$)/i;let _0x1122e4=0x0,_0x2b784e=0x1,_0x3be265={'hasShown40':![],'hasShown20':![],'hasShown10':![]},_0x181e60;const _0xe7279a=document[_0x13d875(0xd67)](_0x13d875(0x1284));_0xe7279a['id']=_0x13d875(0xa22),document['head'][_0x13d875(0x133d)](_0xe7279a);const _0x5d53da=document['getElementById'](_0x13d875(0xee4)),_0x3cc06b=document['getElementById'](_0x13d875(0x5eb)),_0x247ec5=document[_0x13d875(0x53a)](_0x13d875(0xd61)),_0x163ea7=document[_0x13d875(0x53a)](_0x13d875(0x339)),_0xa0effe=document[_0x13d875(0x53a)](_0x13d875(0xf74));let _0x1db776;function _0x4488b9(){const _0x573bf2=_0x13d875;_0x5d53da[_0x573bf2(0x1276)][_0x573bf2(0xe13)](_0x573bf2(0xaef));}function _0x2e6322(){const _0xff3158=_0x13d875;_0x5d53da[_0xff3158(0x1276)]['remove'](_0xff3158(0xaef)),_0x163ea7[_0xff3158(0x1276)][_0xff3158(0x2d4)](_0xff3158(0x264));if(_0x1db776)_0x1db776(null);}function _0x3b0963(_0x4e206c){const _0x175e7d=_0x13d875,_0x1ab932=document[_0x175e7d(0x53a)](_0x175e7d(0x144c)),_0xa6f4b6=_0x4e206c[_0x175e7d(0x81e)]['lyricsPosition']||{'vertical':_0x175e7d(0x624),'horizontal':_0x175e7d(0x25d),'offset':0xa};_0x1ab932['style']['top']=_0x175e7d(0x1157),_0x1ab932[_0x175e7d(0x1284)]['bottom']='auto',_0x1ab932[_0x175e7d(0x1284)]['left']=_0x175e7d(0x1157),_0x1ab932[_0x175e7d(0x1284)][_0x175e7d(0x4e3)]=_0x175e7d(0x1157),_0x1ab932[_0x175e7d(0x1284)][_0x175e7d(0xd91)]=_0x175e7d(0xbf2);_0xa6f4b6['vertical']===_0x175e7d(0x624)?_0x1ab932[_0x175e7d(0x1284)]['top']=_0xa6f4b6[_0x175e7d(0x10e7)]+'px':_0x1ab932['style'][_0x175e7d(0xee1)]=_0xa6f4b6[_0x175e7d(0x10e7)]+'px';switch(_0xa6f4b6['horizontal']){case'left':_0x1ab932[_0x175e7d(0x1284)][_0x175e7d(0xcd7)]='15px';break;case _0x175e7d(0x4e3):_0x1ab932[_0x175e7d(0x1284)][_0x175e7d(0x4e3)]=_0x175e7d(0x12f7);break;case'center':default:_0x1ab932[_0x175e7d(0x1284)]['left']=_0x175e7d(0xff9),_0x1ab932[_0x175e7d(0x1284)]['transform']=_0x175e7d(0x276);break;}}async function _0x15a9de(_0x5cf689){const _0x402e59=_0x13d875,_0x30a7ea=_0x5cf689[_0x402e59(0x9c2)][_0x402e59(0x1413)][0x0];if(!_0x30a7ea)return;const _0x5b9041=await new Promise(_0x51c7f8=>{const _0x4cf1fa=_0x402e59,_0x3cc5ff=new FileReader();_0x3cc5ff[_0x4cf1fa(0x110f)]=()=>_0x51c7f8(_0x3cc5ff[_0x4cf1fa(0xa2a)]),_0x3cc5ff[_0x4cf1fa(0x13b6)](_0x30a7ea);});await _0x184397(_0x402e59(0x11d7),_0x402e59(0xa31));try{const _0x2104d7=await _0x2705b2(_0x5b9041);if(!_0x2104d7)throw new Error(_0x402e59(0xe44));const _0x3e13f1=_0x53d851[_0x402e59(0xaa3)][_0x53d851['activeChatId']];!_0x3e13f1[_0x402e59(0x81e)]['groupAvatarLibrary']&&(_0x3e13f1['settings'][_0x402e59(0x523)]=[]),_0x3e13f1['settings'][_0x402e59(0x523)][_0x402e59(0x7dd)]({'name':_0x2104d7,'url':_0x5b9041}),await _0xa62efb['chats'][_0x402e59(0x546)](_0x3e13f1),_0x179606(),await _0x184397(_0x402e59(0xac3),'AI已将新群头像命名为：“'+_0x2104d7+'”');}catch(_0x45ce48){console[_0x402e59(0x617)]('本地群头像上传及识别失败:',_0x45ce48),await _0x184397(_0x402e59(0xeac),_0x402e59(0x8f8)+_0x45ce48[_0x402e59(0x875)]);}finally{_0x5cf689[_0x402e59(0x9c2)]['value']=null;}}async function _0x17f2a9(_0xe0418c){const _0x3fdfc5=_0x13d875,_0x9ac12e=_0xe0418c[_0x3fdfc5(0x9c2)]['files'][0x0];if(!_0x9ac12e)return;const _0xc1c348=await new Promise(_0x2c5eaa=>{const _0x5de783=_0x3fdfc5,_0x4dc52d=new FileReader();_0x4dc52d[_0x5de783(0x110f)]=()=>_0x2c5eaa(_0x4dc52d[_0x5de783(0xa2a)]),_0x4dc52d[_0x5de783(0x13b6)](_0x9ac12e);});await _0x184397(_0x3fdfc5(0x11d7),_0x3fdfc5(0x115c));try{const _0x2518fe=await _0x2705b2(_0xc1c348);if(!_0x2518fe)throw new Error('AI未能成功描述图片。');const _0x156a5f=_0x53d851[_0x3fdfc5(0xaa3)][_0x53d851['activeChatId']];!_0x156a5f['settings'][_0x3fdfc5(0x78e)]&&(_0x156a5f[_0x3fdfc5(0x81e)][_0x3fdfc5(0x78e)]=[]),_0x156a5f['settings'][_0x3fdfc5(0x78e)][_0x3fdfc5(0x7dd)]({'name':_0x2518fe,'url':_0xc1c348}),await _0xa62efb[_0x3fdfc5(0xaa3)][_0x3fdfc5(0x546)](_0x156a5f),_0x4ebba7(),await _0x184397(_0x3fdfc5(0xac3),_0x3fdfc5(0x263)+_0x2518fe+'”');}catch(_0x29d21b){console[_0x3fdfc5(0x617)]('本地头像上传及识别失败:',_0x29d21b),await _0x184397('操作失败','无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20'+_0x29d21b[_0x3fdfc5(0x875)]);}finally{_0xe0418c[_0x3fdfc5(0x9c2)][_0x3fdfc5(0x11a2)]=null;}}async function _0x2705b2(_0x14219){const _0x27a86f=_0x13d875,_0x501590=_0x53d851['apiConfig'][_0x27a86f(0x11f4)]&&_0x53d851[_0x27a86f(0x80d)][_0x27a86f(0x8ec)]&&_0x53d851['apiConfig']['secondaryModel'],{proxyUrl:_0x3e92d3,apiKey:_0x44fc94,model:_0x439b68}=_0x501590?{'proxyUrl':_0x53d851[_0x27a86f(0x80d)][_0x27a86f(0x11f4)],'apiKey':_0x53d851[_0x27a86f(0x80d)]['secondaryApiKey'],'model':_0x53d851[_0x27a86f(0x80d)][_0x27a86f(0x112b)]}:_0x53d851['apiConfig'];if(!_0x3e92d3||!_0x44fc94||!_0x439b68)throw new Error('主API和副API均未配置或配置不完整。');const _0x16f666='请为这张图片起一个简洁的、适合作为头像库标签的名字。例如：“微笑自拍”、“阳光下的猫咪”、“蓝发动漫少女”。请直接回答名字，不要加任何多余的解释。';let _0x4e3929=_0x3e92d3[_0x27a86f(0x6e9)](_0x27a86f(0x1046)),_0xf751a1;if(_0x4e3929){const _0x44f127=_0x14219[_0x27a86f(0x1120)](/^data:(.*);base64/)[0x1],_0x912b40=_0x14219[_0x27a86f(0x13e8)](',')[0x1],_0x3e1e62={'contents':[{'parts':[{'text':_0x16f666},{'inline_data':{'mime_type':_0x44f127,'data':_0x912b40}}]}]};_0xf751a1=await fetch(_0x3e92d3+'/'+_0x439b68+_0x27a86f(0x618)+_0x44fc94,{'method':'POST','headers':{'Content-Type':_0x27a86f(0x85b)},'body':JSON[_0x27a86f(0xe1e)](_0x3e1e62)});}else{const _0x3450c0={'model':_0x439b68,'messages':[{'role':'user','content':[{'type':_0x27a86f(0x2e6),'text':_0x16f666},{'type':'image_url','image_url':{'url':_0x14219}}]}],'max_tokens':0x32};_0xf751a1=await fetch(_0x3e92d3+_0x27a86f(0x434),{'method':_0x27a86f(0xa4e),'headers':{'Content-Type':_0x27a86f(0x85b),'Authorization':_0x27a86f(0x841)+_0x44fc94},'body':JSON[_0x27a86f(0xe1e)](_0x3450c0)});}if(!_0xf751a1['ok']){const _0xfb32eb=await _0xf751a1[_0x27a86f(0xdc2)]();throw new Error(_0x27a86f(0x352)+_0xfb32eb[_0x27a86f(0x617)]['message']);}const _0x34e526=await _0xf751a1['json']();let _0x2e506c=_0x4e3929?getGeminiResponseText(_0x34e526):_0x34e526[_0x27a86f(0x12bf)][0x0][_0x27a86f(0x875)][_0x27a86f(0x73e)];return _0x2e506c[_0x27a86f(0x13bc)]()['replace'](/["'“”‘’]/g,'');}async function _0x30a85e(_0x71dd45){const _0x4e618e=_0x13d875;if(!_0x71dd45||_0x71dd45[_0x4e618e(0x86e)]){console[_0x4e618e(0xad0)](_0x4e618e(0x577));return;}const _0x5de024=_0x71dd45['id'],_0x3ba4df=_0x71dd45['name'],_0xf9b586=_0x71dd45[_0x4e618e(0x543)];console[_0x4e618e(0x1081)](_0x4e618e(0x93c)+_0x5de024+'\x20同步所有群聊内的名称信息...');for(const _0x28e0e4 in _0x53d851[_0x4e618e(0xaa3)]){const _0x366584=_0x53d851[_0x4e618e(0xaa3)][_0x28e0e4];if(_0x366584[_0x4e618e(0x86e)]&&_0x366584[_0x4e618e(0x3de)]){const _0x56cc5f=_0x366584[_0x4e618e(0x3de)][_0x4e618e(0x397)](_0x248d5d=>_0x248d5d['id']===_0x5de024);if(_0x56cc5f){let _0x1359dd=![];_0x56cc5f[_0x4e618e(0x12bc)]!==_0x3ba4df&&(_0x56cc5f[_0x4e618e(0x12bc)]=_0x3ba4df,_0x1359dd=!![]),_0x56cc5f[_0x4e618e(0x543)]!==_0xf9b586&&(_0x56cc5f[_0x4e618e(0x543)]=_0xf9b586,_0x1359dd=!![]),_0x1359dd&&(await _0xa62efb['chats']['put'](_0x366584),console[_0x4e618e(0x1081)](_0x4e618e(0x60d)+_0x366584[_0x4e618e(0x234)]+_0x4e618e(0xe9f)));}}}}async function _0x55466c(_0x64af78){const _0x19dcd3=_0x13d875;if(!_0x64af78||_0x64af78['isGroup']){console[_0x19dcd3(0xad0)]('syncCharacterAvatarInGroups:\x20传入的不是有效的单聊对象，已跳过同步。');return;}const _0x42c9af=_0x64af78['id'],_0x1f73fb=_0x64af78[_0x19dcd3(0x81e)][_0x19dcd3(0x9e3)];console[_0x19dcd3(0x1081)](_0x19dcd3(0x93c)+_0x42c9af+_0x19dcd3(0x718));for(const _0x4c6da2 of Object[_0x19dcd3(0x244)](_0x53d851[_0x19dcd3(0xaa3)])){if(_0x4c6da2[_0x19dcd3(0x86e)]&&_0x4c6da2[_0x19dcd3(0x3de)]){const _0x33b9f0=_0x4c6da2[_0x19dcd3(0x3de)]['find'](_0x142120=>_0x142120['id']===_0x42c9af);_0x33b9f0&&_0x33b9f0[_0x19dcd3(0x8cd)]!==_0x1f73fb&&(_0x33b9f0['avatar']=_0x1f73fb,await _0xa62efb[_0x19dcd3(0xaa3)]['put'](_0x4c6da2),console[_0x19dcd3(0x1081)](_0x19dcd3(0x1f9)+_0x42c9af+_0x19dcd3(0x7d2)+_0x4c6da2['name']+'\x22'));}}}function _0xf33fb2(_0x33c603,_0x1eb70e){const _0xbd4e21=_0x13d875;if(!_0x33c603||!_0x33c603['isGroup']||!_0x1eb70e)return _0x1eb70e;const _0x5e1c9d=_0x53d851[_0xbd4e21(0xa74)][_0xbd4e21(0x1005)]||_0xbd4e21(0x8ac);if(_0x1eb70e===_0x5e1c9d)return _0x33c603[_0xbd4e21(0x81e)][_0xbd4e21(0x1303)]||'我';const _0x578f5f=_0x33c603[_0xbd4e21(0x3de)][_0xbd4e21(0x397)](_0x1e21fc=>_0x1e21fc[_0xbd4e21(0x543)]===_0x1eb70e);return _0x578f5f?_0x578f5f['groupNickname']:_0x1eb70e;}function _0x22b4ff(_0x482375){const _0x1ec5c9=_0x13d875;document[_0x1ec5c9(0xc3d)](_0x1ec5c9(0xf81))['forEach'](_0x10787c=>{const _0x9a2cfa=_0x1ec5c9;_0x10787c[_0x9a2cfa(0x1276)][_0x9a2cfa(0x4d7)](_0x9a2cfa(0xdf6),_0x10787c[_0x9a2cfa(0x999)][_0x9a2cfa(0xbcd)]===_0x482375);}),document[_0x1ec5c9(0xc3d)](_0x1ec5c9(0x249))[_0x1ec5c9(0xeaf)](_0x1524f3=>{const _0x4c0090=_0x1ec5c9;_0x1524f3[_0x4c0090(0x1276)]['toggle']('active',_0x1524f3[_0x4c0090(0x999)]['categoryId']===_0x482375);});}function _0x4b300d(_0x315602){const _0x332887=_0x13d875;if(!_0x315602)return'';if(_0x53d851[_0x332887(0xa74)]&&_0x315602===_0x53d851[_0x332887(0xa74)][_0x332887(0x1005)])return _0x53d851[_0x332887(0xa74)][_0x332887(0x1005)];let _0x1f6747=Object[_0x332887(0x244)](_0x53d851[_0x332887(0xaa3)])[_0x332887(0x397)](_0x4f756d=>!_0x4f756d[_0x332887(0x86e)]&&_0x4f756d[_0x332887(0x543)]===_0x315602);if(_0x1f6747)return _0x1f6747[_0x332887(0x234)];_0x1f6747=Object['values'](_0x53d851[_0x332887(0xaa3)])[_0x332887(0x397)](_0x2f65f0=>!_0x2f65f0[_0x332887(0x86e)]&&(_0x2f65f0[_0x332887(0x12ed)]&&_0x2f65f0[_0x332887(0x12ed)][_0x332887(0x6e9)](_0x315602)));if(_0x1f6747)return _0x1f6747[_0x332887(0x234)];return _0x315602;}function _0x1cea24(_0x20944f,_0x3e8d6d=null){const _0x1934b3=_0x13d875;if(!_0x20944f||typeof _0x20944f!==_0x1934b3(0xfc5)||!_0x20944f['includes'](_0x1934b3(0x11c6)))return _0x20944f;return _0x20944f[_0x1934b3(0x795)](/@\[\[([^\]]+)\]\]/g,(_0x14b2a0,_0x31b9fc)=>{const _0x10d6e0=_0x1934b3,_0xe43dcd=_0x31b9fc[_0x10d6e0(0x13bc)]();let _0x4a5bfa;return _0x3e8d6d&&_0x3e8d6d[_0x10d6e0(0x86e)]?_0x4a5bfa=_0xf33fb2(_0x3e8d6d,_0xe43dcd):_0x4a5bfa=_0x4b300d(_0xe43dcd),'@'+_0x4a5bfa;});}function _0x355fc0(_0xcae82e,_0x466a7c,_0x161baf={}){return new Promise(_0x523170=>{const _0x400555=_0x55b8;_0x1db776=_0x523170,_0x3cc06b['textContent']=_0xcae82e,_0x247ec5[_0x400555(0xaac)]=_0x400555(0xb1a)+_0x466a7c+_0x400555(0x12e2);const _0x1d4dc1=document[_0x400555(0x53a)](_0x400555(0x339)),_0x33972=document['getElementById'](_0x400555(0xf74));_0x33972['style']['display']='block',_0x1d4dc1[_0x400555(0x34a)]=_0x161baf[_0x400555(0xd00)]||'确定',_0x33972[_0x400555(0x34a)]=_0x161baf[_0x400555(0x11f6)]||'取消',_0x161baf[_0x400555(0xe87)]?_0x1d4dc1[_0x400555(0x1276)][_0x400555(0xe13)](_0x161baf[_0x400555(0xe87)]):_0x1d4dc1[_0x400555(0x1276)][_0x400555(0x2d4)]('btn-danger'),_0x1d4dc1[_0x400555(0x12f2)]=()=>{_0x523170(!![]),_0x2e6322();},_0x33972[_0x400555(0x12f2)]=()=>{_0x523170(![]),_0x2e6322();},_0x4488b9();});}function _0x184397(_0x32e9c8,_0x529be5){return new Promise(_0x226fd6=>{const _0x3bd2e4=_0x55b8;_0x1db776=_0x226fd6,_0x3cc06b['textContent']=_0x32e9c8,_0x247ec5[_0x3bd2e4(0xaac)]='<p\x20style=\x22text-align:\x20left;\x20white-space:\x20pre-wrap;\x22>'+_0x529be5+_0x3bd2e4(0x12e2);const _0x2f31fc=document[_0x3bd2e4(0x53a)]('custom-modal-confirm'),_0x11bd9a=document[_0x3bd2e4(0x53a)](_0x3bd2e4(0xf74));_0x11bd9a[_0x3bd2e4(0x1284)][_0x3bd2e4(0x11d9)]=_0x3bd2e4(0xbf2),_0x2f31fc[_0x3bd2e4(0x34a)]='好的',_0x2f31fc[_0x3bd2e4(0x12f2)]=()=>{const _0x4831c1=_0x3bd2e4;_0x11bd9a[_0x4831c1(0x1284)]['display']=_0x4831c1(0x1ea),_0x2f31fc[_0x4831c1(0x34a)]='确定',_0x226fd6(!![]),_0x2e6322();},_0x4488b9();});}function _0x4f6537(_0x46ac94,_0xcdc607,_0x2dc2b1='',_0x73e27e=_0x13d875(0x2e6),_0x2d6ef9=''){return new Promise(_0x572e19=>{const _0x3deedf=_0x55b8;_0x1db776=_0x572e19,_0x3cc06b[_0x3deedf(0x34a)]=_0x46ac94;const _0x36a336='custom-prompt-input',_0x360117=_0x73e27e===_0x3deedf(0x728)?_0x3deedf(0x1359)+_0x36a336+_0x3deedf(0x12e6)+_0xcdc607+'\x22\x20rows=\x224\x22\x20style=\x22width:\x20100%;\x20padding:\x208px;\x20border-radius:\x206px;\x20border:\x201px\x20solid\x20#ccc;\x20font-size:\x2016px;\x20box-sizing:\x20border-box;\x20resize:\x20vertical;\x22>'+_0x2dc2b1+_0x3deedf(0xfd8):'<input\x20type=\x22'+_0x73e27e+_0x3deedf(0xeec)+_0x36a336+'\x22\x20placeholder=\x22'+_0xcdc607+_0x3deedf(0x974)+_0x2dc2b1+'\x22>';_0x247ec5[_0x3deedf(0xaac)]=_0x2d6ef9+_0x360117;const _0x3cd12b=document['getElementById'](_0x36a336);_0x247ec5[_0x3deedf(0xc3d)](_0x3deedf(0x12be))[_0x3deedf(0xeaf)](_0x20a3b3=>{const _0x2f147a=_0x3deedf;_0x20a3b3[_0x2f147a(0x1086)](_0x2f147a(0xb2b),()=>{const _0x416c0c=_0x2f147a,_0x23980c=_0x20a3b3[_0x416c0c(0x999)]['template'];if(_0x23980c)try{const _0x373603=JSON[_0x416c0c(0x367)](_0x23980c);_0x3cd12b[_0x416c0c(0x11a2)]=JSON[_0x416c0c(0xe1e)](_0x373603,null,0x2),_0x3cd12b['focus']();}catch(_0x249895){console[_0x416c0c(0x617)]('解析格式模板失败:',_0x249895);}});});const _0x12842c=document[_0x3deedf(0x53a)](_0x3deedf(0x339)),_0x15d02c=document[_0x3deedf(0x53a)](_0x3deedf(0xf74));_0x12842c['onclick']=()=>{_0x572e19(_0x3cd12b['value']),_0x2e6322();},_0x15d02c[_0x3deedf(0x12f2)]=()=>{_0x572e19(null),_0x2e6322();},_0x4488b9(),setTimeout(()=>_0x3cd12b[_0x3deedf(0x78d)](),0x64);});}function _0x34ea2c(_0xd1bea1,_0x44f995){return new Promise(_0xf1d58f=>{const _0x37b0a1=_0x55b8,_0x4e5091=document['getElementById']('custom-modal-overlay'),_0x5a9017=document[_0x37b0a1(0x53a)](_0x37b0a1(0x5eb)),_0x45f10e=document[_0x37b0a1(0x53a)](_0x37b0a1(0xd61)),_0x5cd530=document[_0x37b0a1(0x139c)](_0x37b0a1(0x6ea));_0x5a9017[_0x37b0a1(0x34a)]=_0xd1bea1,_0x45f10e[_0x37b0a1(0xaac)]='',_0x5cd530[_0x37b0a1(0xaac)]='',_0x5cd530[_0x37b0a1(0x1284)]['flexDirection']=_0x37b0a1(0xaf9),_0x44f995[_0x37b0a1(0xeaf)](_0x4849f8=>{const _0x48e0a3=_0x37b0a1,_0x1a9b1d=document[_0x48e0a3(0xd67)](_0x48e0a3(0x59e));_0x1a9b1d['textContent']=_0x4849f8['text'],_0x1a9b1d[_0x48e0a3(0x12f2)]=()=>{const _0x538d16=_0x48e0a3;_0x4e5091[_0x538d16(0x1276)][_0x538d16(0x2d4)](_0x538d16(0xaef)),_0xf1d58f(_0x4849f8[_0x538d16(0x11a2)]);},_0x5cd530[_0x48e0a3(0x133d)](_0x1a9b1d);});const _0x303665=document[_0x37b0a1(0xd67)]('button');_0x303665[_0x37b0a1(0x34a)]='取消',_0x303665[_0x37b0a1(0x1284)][_0x37b0a1(0xfad)]=_0x37b0a1(0x651),_0x303665[_0x37b0a1(0x1284)][_0x37b0a1(0xf89)]='8px',_0x303665[_0x37b0a1(0x1284)]['backgroundColor']=_0x37b0a1(0x108f),_0x303665[_0x37b0a1(0x12f2)]=()=>{const _0x3a3854=_0x37b0a1;_0x4e5091[_0x3a3854(0x1276)][_0x3a3854(0x2d4)](_0x3a3854(0xaef)),_0xf1d58f(null);},_0x5cd530[_0x37b0a1(0x133d)](_0x303665),_0x4e5091['classList'][_0x37b0a1(0xe13)](_0x37b0a1(0xaef));})['finally'](()=>{const _0x2024d7=_0x55b8,_0x1af274=document[_0x2024d7(0x139c)](_0x2024d7(0x6ea));_0x1af274['style'][_0x2024d7(0xa02)]=_0x2024d7(0x3a6),_0x1af274[_0x2024d7(0xaac)]=_0x2024d7(0x13d3),document[_0x2024d7(0x53a)](_0x2024d7(0xf74))[_0x2024d7(0x1086)](_0x2024d7(0xb2b),_0x2e6322);});}async function _0xa6573b(){const _0x4b16f5=_0x13d875,_0x59c0d6=await _0x34ea2c('选择歌词导入方式',[{'text':'📁\x20从本地文件\x20(.lrc)','value':'file'},{'text':_0x4b16f5(0x1406),'value':_0x4b16f5(0x143f)}]);if(_0x59c0d6==='file')return new Promise(_0x423baa=>{const _0x407883=_0x4b16f5,_0x20be73=document[_0x407883(0x53a)](_0x407883(0x1172)),_0x2a4f23=_0x3e2bca=>{const _0x5ad4a8=_0x407883,_0x474e7b=_0x3e2bca[_0x5ad4a8(0x9c2)]['files'][0x0];if(_0x474e7b){const _0xb48b27=new FileReader();_0xb48b27['onload']=_0xe415af=>_0x423baa(_0xe415af['target'][_0x5ad4a8(0xa2a)]),_0xb48b27['onerror']=()=>_0x423baa(''),_0xb48b27[_0x5ad4a8(0x303)](_0x474e7b);}else _0x423baa(null);_0x20be73[_0x5ad4a8(0x5ce)](_0x5ad4a8(0x325),_0x2a4f23),_0x20be73[_0x5ad4a8(0x11a2)]='';};_0x20be73[_0x407883(0x1086)](_0x407883(0x325),_0x2a4f23,{'once':!![]}),_0x20be73['click']();});else{if(_0x59c0d6===_0x4b16f5(0x143f)){const _0x1b92fb=await _0x4f6537(_0x4b16f5(0x49c),'请在此处粘贴完整的LRC格式歌词...','',_0x4b16f5(0x728));if(_0x1b92fb){const _0x4056a0=_0x1b92fb['replace'](/\[/g,'\x0a[')[_0x4b16f5(0x13bc)]();return _0x4056a0;}return _0x1b92fb;}else return null;}}_0xa62efb[_0x13d875(0x8b6)](0x27)['stores']({'doubanPosts':'++id,\x20timestamp','chats':_0x13d875(0xb38),'apiConfig':'&id,\x20minimaxGroupId,\x20minimaxApiKey','globalSettings':_0x13d875(0xe01),'userStickers':_0x13d875(0xd53),'worldBooks':_0x13d875(0x7a2),'worldBookCategories':_0x13d875(0x225),'musicLibrary':_0x13d875(0xe01),'personaPresets':_0x13d875(0xe01),'qzoneSettings':_0x13d875(0xe01),'qzonePosts':_0x13d875(0x11f1),'qzoneAlbums':'++id,\x20name,\x20createdAt','qzonePhotos':_0x13d875(0x1194),'favorites':'++id,\x20type,\x20timestamp,\x20originalTimestamp','qzoneGroups':_0x13d875(0x225),'memories':_0x13d875(0x12d9),'callRecords':_0x13d875(0x97d),'shoppingProducts':_0x13d875(0x107e),'shoppingCategories':_0x13d875(0x225),'apiPresets':_0x13d875(0x225),'renderingRules':_0x13d875(0x132b),'appearancePresets':_0x13d875(0x742),'stickerCategories':_0x13d875(0x225),'customAvatarFrames':'++id,\x20name','presets':'&id,\x20name,\x20categoryId','presetCategories':_0x13d875(0x225),'readingLibrary':_0x13d875(0x591),'npcs':'++id,\x20name,\x20enableBackgroundActivity,\x20actionCooldownMinutes,\x20lastActionTimestamp'})[_0x13d875(0xf25)](_0x33a7ac=>{const _0x27ff57=_0x13d875;return _0x33a7ac[_0x27ff57(0xdec)](_0x27ff57(0x10f2))[_0x27ff57(0x1345)]()[_0x27ff57(0xcf0)](_0x471201=>{const _0x255c73=_0x27ff57;if(typeof _0x471201[_0x255c73(0x73e)]===_0x255c73(0xfc5)&&_0x471201[_0x255c73(0x73e)][_0x255c73(0x13bc)]()!=='')_0x471201[_0x255c73(0x73e)]=[{'keys':[],'comment':_0x255c73(0x11b1),'content':_0x471201[_0x255c73(0x73e)]}];else!Array['isArray'](_0x471201[_0x255c73(0x73e)])&&(_0x471201['content']=[]);_0x471201[_0x255c73(0x73e)][_0x255c73(0xeaf)](_0x198dee=>{const _0x233bb7=_0x255c73;typeof _0x198dee[_0x233bb7(0xb3d)]===_0x233bb7(0x131e)&&(_0x198dee[_0x233bb7(0xb3d)]=!![]);});});}),window['db']=_0xa62efb;function _0x541a81(_0x22d901){const _0x155d32=_0x13d875;_0x22d901==='chat-list-screen'&&(window[_0x155d32(0x9f9)](),_0x4001e6('messages-view'));if(_0x22d901===_0x155d32(0x493))window[_0x155d32(0xe0a)]();if(_0x22d901===_0x155d32(0x6a5))window[_0x155d32(0xaab)]();if(_0x22d901===_0x155d32(0x3fa))window[_0x155d32(0x1308)]();if(_0x22d901===_0x155d32(0xec9))window[_0x155d32(0x2e2)]();if(_0x22d901===_0x155d32(0x807))_0x529c6c();document[_0x155d32(0xc3d)](_0x155d32(0x358))[_0x155d32(0xeaf)](_0x3a604d=>_0x3a604d[_0x155d32(0x1276)][_0x155d32(0x2d4)](_0x155d32(0xdf6)));const _0x528593=document[_0x155d32(0x53a)](_0x22d901);if(_0x528593)_0x528593['classList'][_0x155d32(0xe13)](_0x155d32(0xdf6));if(_0x22d901===_0x155d32(0x10ba))window[_0x155d32(0x877)](_0x53d851['activeChatId']);_0x22d901===_0x155d32(0x13f9)&&(_0x104652(),document[_0x155d32(0x53a)](_0x155d32(0x9a2))['value']=_0x53d851[_0x155d32(0x906)][_0x155d32(0x9a0)]||'',_0x281d80(_0x53d851['globalSettings'][_0x155d32(0x9a0)]||'',!![]));}window[_0x13d875(0x877)]=()=>{};function _0x4001e6(_0x5e74a8){const _0x561fe2=_0x13d875,_0x2a644f=document[_0x561fe2(0x53a)](_0x561fe2(0xbca)),_0x2f1af3={'messages-view':document[_0x561fe2(0x53a)](_0x561fe2(0x411)),'qzone-screen':document[_0x561fe2(0x53a)]('qzone-screen'),'favorites-view':document[_0x561fe2(0x53a)](_0x561fe2(0x837)),'memories-view':document[_0x561fe2(0x53a)]('memories-view'),'npc-list-view':document['getElementById']('npc-list-view')},_0x2a2034=document[_0x561fe2(0x53a)](_0x561fe2(0xf4e)),_0x707fea=document['getElementById']('chat-list-bottom-nav');_0xd43fb7&&document[_0x561fe2(0x53a)](_0x561fe2(0xf5e))[_0x561fe2(0xb2b)]();Object['values'](_0x2f1af3)['forEach'](_0xe8871c=>_0xe8871c[_0x561fe2(0x1276)][_0x561fe2(0x2d4)](_0x561fe2(0xdf6)));_0x2f1af3[_0x5e74a8]&&_0x2f1af3[_0x5e74a8][_0x561fe2(0x1276)][_0x561fe2(0xe13)](_0x561fe2(0xdf6));document[_0x561fe2(0xc3d)]('#chat-list-bottom-nav\x20.nav-item')[_0x561fe2(0xeaf)](_0x3b1060=>{const _0x41ead2=_0x561fe2;_0x3b1060['classList'][_0x41ead2(0x4d7)](_0x41ead2(0xdf6),_0x3b1060['dataset'][_0x41ead2(0x42e)]===_0x5e74a8);});_0x5e74a8===_0x561fe2(0x411)?(_0x2a2034['style'][_0x561fe2(0x11d9)]=_0x561fe2(0x2f6),_0x707fea[_0x561fe2(0x1284)][_0x561fe2(0x11d9)]=_0x561fe2(0x2f6)):(_0x2a2034[_0x561fe2(0x1284)][_0x561fe2(0x11d9)]='none',_0x707fea['style'][_0x561fe2(0x11d9)]=_0x561fe2(0xbf2));_0x5e74a8!==_0x561fe2(0x1024)&&(_0x3a8252[_0x561fe2(0xeaf)](_0x5716f1=>clearInterval(_0x5716f1)),_0x3a8252=[]);switch(_0x5e74a8){case _0x561fe2(0x116e):_0x2f1af3[_0x561fe2(0x116e)]['style']['backgroundColor']=_0x561fe2(0xd5a),_0x5bac35(0x0),_0x489bd7(),_0x3679f3();break;case _0x561fe2(0x837):_0x2f1af3[_0x561fe2(0x837)]['style']['backgroundColor']=_0x561fe2(0xbc8),_0xf36c44();break;case _0x561fe2(0x411):break;case _0x561fe2(0xcfc):_0x1f0548();break;}}function _0x31ab65(){const _0x17ed8e=_0x13d875;console[_0x17ed8e(0x1081)]('渲染X社交页面');}window['renderXSocialScreenProxy']=_0x31ab65;function _0x489bd7(){const _0x27affa=_0x13d875;if(_0x53d851&&_0x53d851[_0x27affa(0xa74)]){const _0x50dbfb=_0x53d851[_0x27affa(0xa74)];document[_0x27affa(0x53a)]('qzone-nickname')['textContent']=_0x50dbfb['nickname'],document['getElementById'](_0x27affa(0x3b2))['src']=_0x50dbfb[_0x27affa(0x8cd)],document[_0x27affa(0x53a)](_0x27affa(0x378))['src']=_0x50dbfb[_0x27affa(0xb72)];}}window[_0x13d875(0xae7)]=_0x489bd7;async function _0x2bd11e(){const _0x5d1fd6=_0x13d875;_0xa62efb&&_0x53d851[_0x5d1fd6(0xa74)]&&await _0xa62efb[_0x5d1fd6(0xa74)][_0x5d1fd6(0x546)](_0x53d851[_0x5d1fd6(0xa74)]);}function _0x2ea4b1(_0x34b876){const _0x39bf67=_0x13d875;if(!_0x34b876)return'';const _0x4277e3=new Date(),_0x262a5d=new Date(_0x34b876),_0x29397e=Math[_0x39bf67(0x7d5)]((_0x4277e3-_0x262a5d)/0x3e8),_0x3220c5=Math[_0x39bf67(0x7d5)](_0x29397e/0x3c),_0x40e4c6=Math[_0x39bf67(0x7d5)](_0x3220c5/0x3c);if(_0x3220c5<0x1)return'刚刚';if(_0x3220c5<0x3c)return _0x3220c5+_0x39bf67(0x5f4);if(_0x40e4c6<0x18)return _0x40e4c6+_0x39bf67(0x1171);const _0x4503b4=_0x262a5d[_0x39bf67(0xf14)](),_0x182c50=String(_0x262a5d['getMonth']()+0x1)[_0x39bf67(0x117e)](0x2,'0'),_0x5d0aee=String(_0x262a5d[_0x39bf67(0xfae)]())[_0x39bf67(0x117e)](0x2,'0'),_0x417ed4=String(_0x262a5d[_0x39bf67(0x659)]())['padStart'](0x2,'0'),_0x2ced35=String(_0x262a5d['getMinutes']())[_0x39bf67(0x117e)](0x2,'0');return _0x4277e3[_0x39bf67(0xf14)]()===_0x4503b4?_0x182c50+'-'+_0x5d0aee+'\x20'+_0x417ed4+':'+_0x2ced35:_0x4503b4+'-'+_0x182c50+'-'+_0x5d0aee+'\x20'+_0x417ed4+':'+_0x2ced35;}function _0x582db1(_0x256a3f){const _0x8b6229=_0x13d875,_0x292d0b=document[_0x8b6229(0x139c)](_0x8b6229(0x3bd)+_0x256a3f['id']+'\x22]'),_0x106a7b=!!_0x292d0b,_0x392ed2=_0x106a7b?_0x292d0b:document['createElement'](_0x8b6229(0x1425));!_0x106a7b&&(_0x392ed2[_0x8b6229(0x6de)]=_0x8b6229(0x133e),_0x392ed2[_0x8b6229(0x999)][_0x8b6229(0xb09)]=_0x256a3f['id']);const _0x574712=_0x106a7b?_0x392ed2['querySelector'](_0x8b6229(0xb35)):document[_0x8b6229(0xd67)](_0x8b6229(0x1425));!_0x106a7b&&(_0x574712[_0x8b6229(0x6de)]='qzone-post-item');let _0x2199bd='',_0x491ccd='',_0x1b3a69=_0x53d851[_0x8b6229(0xa74)]['avatar'];if(_0x256a3f['authorId']===_0x8b6229(0x10ae))_0x2199bd=_0x53d851[_0x8b6229(0xa74)][_0x8b6229(0x8cd)],_0x491ccd=_0x53d851[_0x8b6229(0xa74)][_0x8b6229(0x1005)];else{if(_0x53d851['chats'][_0x256a3f[_0x8b6229(0xa59)]]){const _0x338757=_0x53d851['chats'][_0x256a3f['authorId']];_0x2199bd=_0x338757['settings']['aiAvatar']||_0x5d06c0,_0x491ccd=_0x338757['name'];}else _0x491ccd=_0x4b300d(_0x256a3f['authorOriginalName']),_0x2199bd=_0x5d06c0;}function _0x20e426(_0x79009){const _0x162287=_0x8b6229;let _0x3e116d='';const _0x10af51=_0x79009['publicText']?_0x162287(0x962)+_0x46c503(_0x79009['publicText'])[_0x162287(0x795)](/\n/g,_0x162287(0x596))+_0x162287(0x864):'';if(_0x79009['type']===_0x162287(0x12c5))_0x3e116d=_0x162287(0x1237)+_0x46c503(_0x79009[_0x162287(0x73e)])[_0x162287(0x795)](/\n/g,_0x162287(0x596))+'</div>';else{if(_0x79009[_0x162287(0x919)]==='image_post'&&_0x79009[_0x162287(0x97a)])_0x3e116d=_0x10af51?_0x10af51+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x79009[_0x162287(0x97a)]+_0x162287(0xea8):'<img\x20src=\x22'+_0x79009[_0x162287(0x97a)]+_0x162287(0x13e3);else{if(_0x79009[_0x162287(0x919)]===_0x162287(0xa9a)){const _0x598100=_0x53d851['globalSettings'][_0x162287(0x128d)]&&_0x79009[_0x162287(0xadb)]?'https://image.pollinations.ai/prompt/'+_0x79009['image_prompt']:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x3e116d=_0x10af51?_0x10af51+_0x162287(0x1262)+_0x598100+_0x162287(0x44e)+_0x79009[_0x162287(0x319)]+_0x162287(0xf56):'<img\x20src=\x22'+_0x598100+_0x162287(0x44e)+_0x79009[_0x162287(0x319)]+'\x22>';}else{if(_0x79009[_0x162287(0x919)]===_0x162287(0x357)){const _0x565ae8=_0x79009[_0x162287(0x4ad)]||(_0x79009['imageUrl']?[_0x79009[_0x162287(0x97a)]]:[]);if(_0x565ae8[_0x162287(0x29d)]>0x0){const _0x1a5d6b=_0x565ae8[_0x162287(0x29d)];let _0x7fcc3f='';_0x7fcc3f=_0x162287(0x12bb)+_0x1a5d6b+'\x22>',_0x565ae8[_0x162287(0xeaf)]((_0x2cfdc9,_0x3cf85a)=>{const _0x83a1aa=_0x162287;_0x7fcc3f+=_0x83a1aa(0x88b)+_0x2cfdc9+_0x83a1aa(0x1304)+(_0x3cf85a+0x1)+'\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>';}),_0x7fcc3f+=_0x162287(0x864),_0x3e116d=_0x10af51?''+_0x10af51+_0x7fcc3f:_0x7fcc3f;}}}}}return _0x3e116d;}let _0xa262f6;if(_0x256a3f[_0x8b6229(0x919)]==='repost'){const _0x1970ec=_0x256a3f[_0x8b6229(0x113c)]?_0x8b6229(0x962)+_0x46c503(_0x256a3f[_0x8b6229(0x113c)])[_0x8b6229(0x795)](/\n/g,_0x8b6229(0x596))+'</div>':'';let _0x473339=_0x5d06c0,_0xc72866='原作者';if(_0x256a3f[_0x8b6229(0x43c)][_0x8b6229(0xa59)]==='user')_0x473339=_0x53d851[_0x8b6229(0xa74)][_0x8b6229(0x8cd)],_0xc72866=_0x53d851[_0x8b6229(0xa74)][_0x8b6229(0x1005)];else{const _0x35c818=_0x53d851[_0x8b6229(0xaa3)][_0x256a3f[_0x8b6229(0x43c)][_0x8b6229(0xa59)]];_0x35c818&&(_0x473339=_0x35c818[_0x8b6229(0x81e)][_0x8b6229(0x9e3)]||_0x5d06c0),_0xc72866=_0x4b300d(_0x256a3f[_0x8b6229(0x43c)][_0x8b6229(0xd2f)]);}_0xa262f6='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1970ec+_0x8b6229(0xfa9)+_0x473339+_0x8b6229(0x11c5)+_0xc72866+_0x8b6229(0x1116)+_0x2ea4b1(_0x256a3f[_0x8b6229(0x43c)]['timestamp'])+_0x8b6229(0x4de)+_0x20e426(_0x256a3f[_0x8b6229(0x43c)])+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}else _0xa262f6=_0x8b6229(0xb0d)+_0x20e426(_0x256a3f)+_0x8b6229(0x864);let _0x1e4afd='';if(_0x256a3f['likes']&&_0x256a3f['likes'][_0x8b6229(0x29d)]>0x0){const _0x2108cb=_0x256a3f[_0x8b6229(0xf52)]['map'](_0x4413ab=>_0x4b300d(_0x4413ab))['join']('、');_0x1e4afd=_0x8b6229(0x67d)+_0x2108cb+_0x8b6229(0x1233);}let _0x207f9a='';_0x256a3f[_0x8b6229(0x11ed)]&&_0x256a3f[_0x8b6229(0x11ed)][_0x8b6229(0x29d)]>0x0&&(_0x207f9a='<div\x20class=\x22post-comments-container\x22>',_0x256a3f[_0x8b6229(0x11ed)][_0x8b6229(0xeaf)]((_0x249f68,_0x11af35)=>{const _0x1f49aa=_0x8b6229;if(typeof _0x249f68===_0x1f49aa(0xc74)&&_0x249f68!==null&&_0x249f68['commenterName']){const _0x2e1c60=_0x249f68[_0x1f49aa(0x3a7)],_0x1044c4=_0x4b300d(_0x2e1c60);let _0x3a9b65;_0x19cec7['test'](_0x249f68[_0x1f49aa(0x2e6)])?_0x3a9b65=_0x1f49aa(0x88b)+_0x249f68['text']+'\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>':_0x3a9b65=_0x46c503(_0x249f68['text']);let _0x2cec87='';if(_0x249f68[_0x1f49aa(0x7fc)]){const _0x1dfe91=_0x4b300d(_0x249f68[_0x1f49aa(0x7fc)]);_0x2cec87=_0x1f49aa(0xe9c)+_0x1044c4+_0x1f49aa(0x1156)+_0x1dfe91+_0x1f49aa(0xca6)+_0x3a9b65;}else _0x2cec87='<span\x20class=\x22commenter-name\x22>'+_0x1044c4+'</span>:\x20'+_0x3a9b65;_0x207f9a+='<div\x20class=\x22comment-item\x22\x20data-post-id=\x22'+_0x256a3f['id']+_0x1f49aa(0x11d5)+_0x2e1c60+_0x1f49aa(0xf84)+_0x1044c4+_0x1f49aa(0x10a7)+_0x2cec87+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22'+_0x11af35+_0x1f49aa(0x654);}else _0x207f9a+=_0x1f49aa(0x741)+_0x46c503(String(_0x249f68))+_0x1f49aa(0x600);}),_0x207f9a+='</div>');const _0x5b9266=_0x53d851[_0x8b6229(0xa74)][_0x8b6229(0x1005)],_0x25e8ba=_0x256a3f[_0x8b6229(0xf52)]&&_0x256a3f[_0x8b6229(0xf52)]['includes'](_0x5b9266),_0x329594=_0x53d851[_0x8b6229(0xa7b)]&&_0x53d851['favoritedPostIds'][_0x8b6229(0x11af)](_0x256a3f['id']);let _0x3b4980='';_0x256a3f[_0x8b6229(0x919)]!==_0x8b6229(0x784)&&(_0x3b4980=_0x8b6229(0x8ab));_0x574712[_0x8b6229(0xaac)]=_0x8b6229(0xc77)+_0x2199bd+_0x8b6229(0x934)+_0x256a3f['authorId']+_0x8b6229(0x11eb)+_0x491ccd+_0x8b6229(0xb3e)+_0x2ea4b1(_0x256a3f[_0x8b6229(0x827)])+_0x8b6229(0x466)+_0xa262f6+_0x8b6229(0x4c3)+_0x3b4980+_0x8b6229(0x1424)+(_0x25e8ba?_0x8b6229(0xdf6):'')+_0x8b6229(0xe3e)+(_0x329594?_0x8b6229(0xdf6):'')+_0x8b6229(0x82a)+_0x1e4afd+_0x8b6229(0x95c)+_0x207f9a+_0x8b6229(0x9b3)+_0x1b3a69+_0x8b6229(0x1360);if(!_0x106a7b){const _0x175077=document[_0x8b6229(0xd67)](_0x8b6229(0x1425));_0x175077['className']='qzone-post-delete-action',_0x175077['innerHTML']=_0x8b6229(0x61b),_0x392ed2['appendChild'](_0x574712),_0x392ed2[_0x8b6229(0x133d)](_0x175077);}return _0x392ed2;}async function _0x462f2e(_0x2f7c36){const _0x2e626d=_0x13d875,_0x4f7e51=await _0xa62efb[_0x2e626d(0xfc2)][_0x2e626d(0x883)](_0x2f7c36);if(!_0x4f7e51){const _0x10809a=document['querySelector'](_0x2e626d(0x3bd)+_0x2f7c36+'\x22]');if(_0x10809a)_0x10809a[_0x2e626d(0x2d4)]();return;}const _0x51771d=_0x2ec44e['findIndex'](_0x6f6483=>_0x6f6483['id']===_0x2f7c36);if(_0x51771d>-0x1)_0x2ec44e[_0x51771d]=_0x4f7e51;const _0x5b1739=await _0xa62efb[_0x2e626d(0xb51)][_0x2e626d(0x57e)](_0x2e626d(0x919))[_0x2e626d(0x12f6)](_0x2e626d(0xc50))[_0x2e626d(0xa73)]();_0x53d851[_0x2e626d(0xa7b)]=new Set(_0x5b1739[_0x2e626d(0xcb4)](_0x1193b1=>_0x1193b1[_0x2e626d(0x73e)]['id'])),_0x582db1(_0x4f7e51);}function _0x272f9c(_0xea1447){const _0x1953f3=_0x13d875,_0x4069d6=Date[_0x1953f3(0x9c1)](),_0x559480=Math['floor']((_0x4069d6-_0xea1447)/0x3e8),_0x42c673=Math[_0x1953f3(0x7d5)](_0x559480/0x3c);if(_0x42c673<0x2)return'刚刚';if(_0x42c673<0x3c)return _0x42c673+_0x1953f3(0x5f4);const _0x11417e=Math[_0x1953f3(0x7d5)](_0x42c673/0x3c);if(_0x11417e<0x18)return _0x11417e+'小时前';const _0x4337ce=Math[_0x1953f3(0x7d5)](_0x11417e/0x18);return _0x4337ce+'天前';}async function _0x582db1(_0x1eb90c){const _0x4bf67a=_0x13d875,_0x32bcf9=document['querySelector'](_0x4bf67a(0x3bd)+_0x1eb90c['id']+'\x22]'),_0x5d7657=!!_0x32bcf9,_0x1daee7=_0x5d7657?_0x32bcf9:document[_0x4bf67a(0xd67)]('div');!_0x5d7657&&(_0x1daee7[_0x4bf67a(0x6de)]=_0x4bf67a(0x133e),_0x1daee7[_0x4bf67a(0x999)]['postId']=_0x1eb90c['id']);const _0x33496e=_0x5d7657?_0x1daee7[_0x4bf67a(0x139c)](_0x4bf67a(0xb35)):document[_0x4bf67a(0xd67)](_0x4bf67a(0x1425));!_0x5d7657&&(_0x33496e['className']='qzone-post-item');let _0x36f2b2='',_0x5e67b8='',_0x5af945=_0x53d851['qzoneSettings'][_0x4bf67a(0x8cd)];if(_0x1eb90c[_0x4bf67a(0xa59)]===_0x4bf67a(0x10ae))_0x36f2b2=_0x53d851[_0x4bf67a(0xa74)]['avatar'],_0x5e67b8=_0x53d851[_0x4bf67a(0xa74)]['nickname'];else{if(_0x53d851[_0x4bf67a(0xaa3)][_0x1eb90c['authorId']]){const _0x387f7a=_0x53d851['chats'][_0x1eb90c[_0x4bf67a(0xa59)]];_0x36f2b2=_0x387f7a[_0x4bf67a(0x81e)][_0x4bf67a(0x9e3)]||_0x5d06c0,_0x5e67b8=_0x387f7a[_0x4bf67a(0x234)];}else{if(String(_0x1eb90c[_0x4bf67a(0xa59)])['startsWith'](_0x4bf67a(0xc78))){const _0x5acea2=parseInt(String(_0x1eb90c[_0x4bf67a(0xa59)])['replace'](_0x4bf67a(0xc78),''));if(!isNaN(_0x5acea2)){const _0x4fa9eb=await _0xa62efb[_0x4bf67a(0x5b7)]['get'](_0x5acea2);_0x4fa9eb?(_0x36f2b2=_0x4fa9eb[_0x4bf67a(0x8cd)]||_0x434592,_0x5e67b8=_0x4fa9eb[_0x4bf67a(0x234)]):(_0x5e67b8=_0x1eb90c[_0x4bf67a(0xd2f)]||'未知NPC',_0x36f2b2=_0x434592);}}else _0x5e67b8=_0x4b300d(_0x1eb90c[_0x4bf67a(0xd2f)]),_0x36f2b2=_0x5d06c0;}}function _0x290c7a(_0x1f6a9a){const _0x2e4123=_0x4bf67a;let _0x81fdb1='';const _0x21dea7=_0x1f6a9a[_0x2e4123(0x678)]?_0x2e4123(0x962)+_0x46c503(_0x1f6a9a[_0x2e4123(0x678)])[_0x2e4123(0x795)](/\n/g,_0x2e4123(0x596))+_0x2e4123(0x864):'';if(_0x1f6a9a[_0x2e4123(0x919)]===_0x2e4123(0x12c5))_0x81fdb1=_0x2e4123(0x1237)+_0x46c503(_0x1f6a9a['content'])[_0x2e4123(0x795)](/\n/g,'<br>')+_0x2e4123(0x864);else{if(_0x1f6a9a[_0x2e4123(0x919)]===_0x2e4123(0x1242)&&_0x1f6a9a[_0x2e4123(0x97a)])_0x81fdb1=_0x21dea7?_0x21dea7+_0x2e4123(0x1262)+_0x1f6a9a[_0x2e4123(0x97a)]+_0x2e4123(0xea8):_0x2e4123(0x88b)+_0x1f6a9a['imageUrl']+'\x22\x20class=\x22chat-image\x22>';else{if(_0x1f6a9a[_0x2e4123(0x919)]==='text_image'){const _0x43d3dc=_0x53d851[_0x2e4123(0x906)][_0x2e4123(0x128d)]&&_0x1f6a9a[_0x2e4123(0xadb)]?_0x2e4123(0x9ce)+_0x1f6a9a[_0x2e4123(0xadb)]:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x81fdb1=_0x21dea7?_0x21dea7+_0x2e4123(0x1262)+_0x43d3dc+_0x2e4123(0x44e)+_0x1f6a9a[_0x2e4123(0x319)]+_0x2e4123(0xf56):_0x2e4123(0x88b)+_0x43d3dc+_0x2e4123(0x44e)+_0x1f6a9a[_0x2e4123(0x319)]+'\x22>';}else{if(_0x1f6a9a[_0x2e4123(0x919)]===_0x2e4123(0x357)){const _0x98baf4=_0x1f6a9a['imageUrls']||(_0x1f6a9a['imageUrl']?[_0x1f6a9a['imageUrl']]:[]);if(_0x98baf4[_0x2e4123(0x29d)]>0x0){const _0x5bb7ed=_0x98baf4[_0x2e4123(0x29d)];let _0x599713='';_0x599713=_0x2e4123(0x12bb)+_0x5bb7ed+'\x22>',_0x98baf4[_0x2e4123(0xeaf)]((_0xbac15,_0x447fdd)=>{const _0x28edf8=_0x2e4123;_0x599713+=_0x28edf8(0x88b)+_0xbac15+'\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片'+(_0x447fdd+0x1)+'\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>';}),_0x599713+='</div>',_0x81fdb1=_0x21dea7?''+_0x21dea7+_0x599713:_0x599713;}}}}}return _0x81fdb1;}let _0x40e936;if(_0x1eb90c[_0x4bf67a(0x919)]===_0x4bf67a(0x784)){const _0x277ee2=_0x1eb90c[_0x4bf67a(0x113c)]?_0x4bf67a(0x962)+_0x1eb90c['repostComment'][_0x4bf67a(0x795)](/\n/g,_0x4bf67a(0x596))+_0x4bf67a(0x864):'';let _0x2ec9da=_0x5d06c0,_0x2bfe80='原作者';if(_0x1eb90c[_0x4bf67a(0x43c)]['authorId']===_0x4bf67a(0x10ae))_0x2ec9da=_0x53d851[_0x4bf67a(0xa74)][_0x4bf67a(0x8cd)],_0x2bfe80=_0x53d851[_0x4bf67a(0xa74)][_0x4bf67a(0x1005)];else{const _0x275695=_0x53d851[_0x4bf67a(0xaa3)][_0x1eb90c[_0x4bf67a(0x43c)][_0x4bf67a(0xa59)]];_0x275695&&(_0x2ec9da=_0x275695[_0x4bf67a(0x81e)][_0x4bf67a(0x9e3)]||_0x5d06c0),_0x2bfe80=_0x4b300d(_0x1eb90c[_0x4bf67a(0x43c)][_0x4bf67a(0xd2f)]);}_0x40e936=_0x4bf67a(0x26b)+_0x277ee2+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x2ec9da+_0x4bf67a(0x11c5)+_0x2bfe80+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>'+_0x2ea4b1(_0x1eb90c[_0x4bf67a(0x43c)][_0x4bf67a(0x827)])+_0x4bf67a(0x4de)+_0x290c7a(_0x1eb90c[_0x4bf67a(0x43c)])+_0x4bf67a(0x7ab);}else _0x40e936=_0x4bf67a(0xb0d)+_0x290c7a(_0x1eb90c)+_0x4bf67a(0x864);let _0x123982='';if(_0x1eb90c[_0x4bf67a(0xf52)]&&_0x1eb90c['likes'][_0x4bf67a(0x29d)]>0x0){const _0x2d118e=_0x1eb90c['likes'][_0x4bf67a(0xcb4)](_0x4d7ae3=>_0x4b300d(_0x4d7ae3))[_0x4bf67a(0x2c8)]('、');_0x123982='<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>'+_0x2d118e+_0x4bf67a(0x1233);}let _0x369ef5='';_0x1eb90c[_0x4bf67a(0x11ed)]&&_0x1eb90c[_0x4bf67a(0x11ed)]['length']>0x0&&(_0x369ef5=_0x4bf67a(0x1009),_0x1eb90c['comments'][_0x4bf67a(0xeaf)]((_0x1a073a,_0x11682f)=>{const _0x3f67b8=_0x4bf67a;if(typeof _0x1a073a===_0x3f67b8(0xc74)&&_0x1a073a!==null&&_0x1a073a[_0x3f67b8(0x3a7)]){const _0x4cb386=_0x1a073a[_0x3f67b8(0x3a7)],_0x24add6=_0x4b300d(_0x4cb386);let _0x21089a;_0x19cec7[_0x3f67b8(0x7f2)](_0x1a073a[_0x3f67b8(0x2e6)])?_0x21089a=_0x3f67b8(0x88b)+_0x1a073a[_0x3f67b8(0x2e6)]+_0x3f67b8(0x4f0):_0x21089a=_0x46c503(_0x1a073a[_0x3f67b8(0x2e6)]);let _0x33dbad='';if(_0x1a073a['replyTo']){const _0x42c586=_0x4b300d(_0x1a073a['replyTo']);_0x33dbad=_0x3f67b8(0xe9c)+_0x24add6+_0x3f67b8(0x1156)+_0x42c586+_0x3f67b8(0xca6)+_0x21089a;}else _0x33dbad=_0x3f67b8(0xe9c)+_0x24add6+_0x3f67b8(0xca6)+_0x21089a;_0x369ef5+=_0x3f67b8(0xe2e)+_0x1eb90c['id']+_0x3f67b8(0x11d5)+_0x4cb386+'\x22\x20data-commenter-display-name=\x22'+_0x24add6+_0x3f67b8(0x10a7)+_0x33dbad+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22'+_0x11682f+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}else _0x369ef5+=_0x3f67b8(0x741)+String(_0x1a073a)+_0x3f67b8(0x600);}),_0x369ef5+=_0x4bf67a(0x864));const _0x37531d=_0x53d851[_0x4bf67a(0xa74)]['nickname'],_0x268ae7=_0x1eb90c[_0x4bf67a(0xf52)]&&_0x1eb90c[_0x4bf67a(0xf52)]['includes'](_0x37531d),_0x34c1bc=_0x53d851[_0x4bf67a(0xa7b)]&&_0x53d851[_0x4bf67a(0xa7b)][_0x4bf67a(0x11af)](_0x1eb90c['id']);let _0x373543='';_0x1eb90c[_0x4bf67a(0x919)]!==_0x4bf67a(0x784)&&(_0x373543=_0x4bf67a(0x8ab));_0x33496e[_0x4bf67a(0xaac)]=_0x4bf67a(0xc77)+_0x36f2b2+_0x4bf67a(0x934)+_0x1eb90c[_0x4bf67a(0xa59)]+_0x4bf67a(0x11eb)+_0x5e67b8+_0x4bf67a(0xb3e)+_0x2ea4b1(_0x1eb90c[_0x4bf67a(0x827)])+_0x4bf67a(0x466)+_0x40e936+_0x4bf67a(0x4c3)+_0x373543+_0x4bf67a(0x1424)+(_0x268ae7?_0x4bf67a(0xdf6):'')+_0x4bf67a(0xe3e)+(_0x34c1bc?_0x4bf67a(0xdf6):'')+'\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x123982+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x369ef5+_0x4bf67a(0x9b3)+_0x5af945+_0x4bf67a(0x1360);if(!_0x5d7657){const _0x2714b9=document[_0x4bf67a(0xd67)](_0x4bf67a(0x1425));_0x2714b9[_0x4bf67a(0x6de)]=_0x4bf67a(0x53b),_0x2714b9[_0x4bf67a(0xaac)]=_0x4bf67a(0x61b),_0x1daee7[_0x4bf67a(0x133d)](_0x33496e),_0x1daee7[_0x4bf67a(0x133d)](_0x2714b9);}return _0x1daee7;}async function _0x462f2e(_0x1208c9){const _0x145339=_0x13d875,_0x3729ca=await _0xa62efb['qzonePosts']['get'](_0x1208c9);if(!_0x3729ca){const _0x4fd3ed=document[_0x145339(0x139c)](_0x145339(0x3bd)+_0x1208c9+'\x22]');_0x4fd3ed&&_0x4fd3ed[_0x145339(0x2d4)]();return;}const _0xff94d3=_0x2ec44e[_0x145339(0x298)](_0x209919=>_0x209919['id']===_0x1208c9);_0xff94d3>-0x1&&(_0x2ec44e[_0xff94d3]=_0x3729ca);const _0x156574=await _0xa62efb[_0x145339(0xb51)][_0x145339(0x57e)](_0x145339(0x919))[_0x145339(0x12f6)]('qzone_post')['toArray']();_0x53d851[_0x145339(0xa7b)]=new Set(_0x156574[_0x145339(0xcb4)](_0x836714=>_0x836714[_0x145339(0x73e)]['id'])),await _0x582db1(_0x3729ca);}async function _0x3679f3(){const _0x4684b6=_0x13d875,_0x553212=document[_0x4684b6(0x53a)](_0x4684b6(0x4a9));if(!_0x553212)return;const [_0x5eb33c,_0xc6eb56]=await Promise[_0x4684b6(0x63d)]([_0xa62efb[_0x4684b6(0xfc2)]['orderBy']('timestamp')[_0x4684b6(0x843)]()[_0x4684b6(0x2dd)](_0x532772=>!_0x532772[_0x4684b6(0x661)])[_0x4684b6(0xa73)](),_0xa62efb['favorites']['where'](_0x4684b6(0x919))[_0x4684b6(0x12f6)](_0x4684b6(0xc50))[_0x4684b6(0xa73)]()]);_0x2ec44e=_0x5eb33c,_0x53d851[_0x4684b6(0xa7b)]=new Set(_0xc6eb56[_0x4684b6(0xcb4)](_0x2373ef=>_0x2373ef['content']['id'])),_0x553212[_0x4684b6(0xaac)]='',_0x379b3d=0x0;if(_0x2ec44e[_0x4684b6(0x29d)]===0x0){_0x553212[_0x4684b6(0xaac)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2030px\x200;\x22>这里空空如也，快来发布第一条说说吧！</p>';return;}_0x2e0a5e();}async function _0x2e0a5e(){const _0x3969e6=_0x13d875;if(_0x1d4d0d)return;_0x1d4d0d=!![];const _0x425a87=document['getElementById']('qzone-posts-list');if(!_0x425a87){_0x1d4d0d=![];return;}_0x1e432c(_0x425a87,_0x3969e6(0xee1)),setTimeout(async()=>{const _0x3feeca=_0x3969e6;_0x41b779(_0x425a87);const _0x3be733=_0x379b3d,_0x58138e=_0x379b3d+_0x327d49,_0x110a56=_0x2ec44e[_0x3feeca(0x1340)](_0x3be733,_0x58138e),_0x3fdac1=document[_0x3feeca(0x619)]();for(const _0x28f281 of _0x110a56){const _0x46562e=await _0x582db1(_0x28f281);_0x3fdac1[_0x3feeca(0x133d)](_0x46562e);}_0x425a87[_0x3feeca(0x133d)](_0x3fdac1),_0x379b3d+=_0x110a56[_0x3feeca(0x29d)],_0x1d4d0d=![];},0x1f4);}function _0x2c9c6e(_0x24da83,_0x256222){const _0x5944c7=_0x13d875,_0x327c0c=_0x2284f0[_0x5944c7(0xa85)],_0x2905c9=_0x2284f0[_0x5944c7(0x481)];_0x2905c9[_0x5944c7(0xaac)]='';_0x53d851[_0x5944c7(0xf8f)][_0x5944c7(0x29d)]===0x0?_0x2905c9[_0x5944c7(0xaac)]=_0x5944c7(0xcc1):_0x53d851[_0x5944c7(0xf8f)][_0x5944c7(0xeaf)](_0x36cb7d=>{const _0x59283d=_0x5944c7,_0x43dcb2=document[_0x59283d(0xd67)](_0x59283d(0x1425));_0x43dcb2['className']='sticker-item',_0x43dcb2[_0x59283d(0x1284)][_0x59283d(0x2f2)]=_0x59283d(0xf22)+_0x36cb7d[_0x59283d(0xb36)]+')',_0x43dcb2[_0x59283d(0x667)]=_0x36cb7d[_0x59283d(0x234)],_0x2905c9[_0x59283d(0x133d)](_0x43dcb2);});const _0x3538c2=_0x256222[_0x5944c7(0xde9)](),_0x4d2dd8=document['getElementById'](_0x5944c7(0xf87))['getBoundingClientRect']();_0x327c0c[_0x5944c7(0x1284)][_0x5944c7(0x11d9)]=_0x5944c7(0x2f6);const _0x514086=_0x327c0c[_0x5944c7(0xde9)](),_0x5c5610=_0x514086[_0x5944c7(0xfeb)],_0xa5f792=_0x514086[_0x5944c7(0xd10)];_0x327c0c[_0x5944c7(0x1284)]['top']=_0x3538c2[_0x5944c7(0x624)]-_0x5c5610-0x5-_0x4d2dd8[_0x5944c7(0x624)]+'px';const _0x1fe613=_0x3538c2['left']-_0x4d2dd8[_0x5944c7(0xcd7)];_0x1fe613+_0xa5f792>_0x4d2dd8['width']?(_0x327c0c[_0x5944c7(0x1284)][_0x5944c7(0xcd7)]=_0x5944c7(0x1157),_0x327c0c[_0x5944c7(0x1284)][_0x5944c7(0x4e3)]=_0x5944c7(0x781)):(_0x327c0c[_0x5944c7(0x1284)][_0x5944c7(0xcd7)]=_0x1fe613+'px',_0x327c0c[_0x5944c7(0x1284)][_0x5944c7(0x4e3)]=_0x5944c7(0x1157)),_0x2284f0[_0x5944c7(0xb11)]=!![],_0x2284f0[_0x5944c7(0x117a)]=_0x24da83;}function _0x4398f9(){const _0x142ea9=_0x13d875;_0x2284f0['isOpen']&&(_0x2284f0[_0x142ea9(0xa85)]['style']['display']='none',_0x2284f0[_0x142ea9(0xb11)]=![],_0x2284f0[_0x142ea9(0x117a)]=null);}async function _0xd0818a(_0x1237aa,_0x4887b1){const _0x38594f=_0x13d875;if(!_0x4887b1||!_0x4887b1['url'])return;const _0x5e6684=await _0xa62efb[_0x38594f(0xfc2)]['get'](_0x1237aa);if(!_0x5e6684){console[_0x38594f(0x617)](_0x38594f(0x7a5),_0x1237aa);return;}!_0x5e6684[_0x38594f(0x11ed)]&&(_0x5e6684[_0x38594f(0x11ed)]=[]);const _0x3d9615={'commenterName':_0x53d851[_0x38594f(0xa74)][_0x38594f(0x1005)],'text':_0x4887b1[_0x38594f(0xb36)],'meaning':_0x4887b1[_0x38594f(0x234)],'timestamp':Date['now']()};_0x5e6684[_0x38594f(0x11ed)]['push'](_0x3d9615),await _0xa62efb[_0x38594f(0xfc2)][_0x38594f(0xc03)](_0x1237aa,{'comments':_0x5e6684[_0x38594f(0x11ed)]}),_0x4398f9(),await _0x3679f3();const _0x4b3bb8=(_0x5e6684[_0x38594f(0x678)]||_0x5e6684[_0x38594f(0x73e)]||'[图片动态]')[_0x38594f(0xad6)](0x0,0x1e);for(const _0x21fbf6 in _0x53d851['chats']){const _0x5cf25f=_0x53d851[_0x38594f(0xaa3)][_0x21fbf6];if(!_0x5cf25f[_0x38594f(0x86e)]){const _0x9669d0=_0x38594f(0xaec)+_0x53d851[_0x38594f(0xa74)]['nickname']+_0x38594f(0x295)+_0x1237aa+',\x20内容摘要:\x20“'+_0x4b3bb8+_0x38594f(0xb4a)+_0x4887b1['name']+'”。请你对此作出回应。]',_0x357e36={'role':'system','content':_0x9669d0,'timestamp':Date[_0x38594f(0x9c1)](),'isHidden':!![]};_0x5cf25f['history']['push'](_0x357e36),await _0xa62efb[_0x38594f(0xaa3)][_0x38594f(0x546)](_0x5cf25f);}}}function _0x58306e(_0x3a5687){const _0xe786f4=_0x13d875;_0x57c7ee=_0x3a5687,document['getElementById'](_0xe786f4(0xb2d))['value']='',document[_0xe786f4(0x53a)](_0xe786f4(0xd05))[_0xe786f4(0x1276)][_0xe786f4(0xe13)]('visible');}function _0x381a07(){const _0x2cf459=_0x13d875;document['getElementById'](_0x2cf459(0xd05))[_0x2cf459(0x1276)][_0x2cf459(0x2d4)](_0x2cf459(0xaef)),_0x57c7ee=null;}async function _0x3e98b3(){const _0x7c9778=_0x13d875;if(!_0x57c7ee)return;const _0xf72caa=document['getElementById'](_0x7c9778(0xb2d))[_0x7c9778(0x11a2)][_0x7c9778(0x13bc)](),_0x18aa9f=await _0xa62efb[_0x7c9778(0xfc2)][_0x7c9778(0x883)](_0x57c7ee);if(!_0x18aa9f){alert(_0x7c9778(0x5f7)),_0x381a07();return;}const _0x3d03b4={'type':_0x7c9778(0x784),'timestamp':Date[_0x7c9778(0x9c1)](),'authorId':_0x7c9778(0x10ae),'repostComment':_0xf72caa,'originalPost':_0x18aa9f,'visibleGroupIds':null};await _0xa62efb[_0x7c9778(0xfc2)][_0x7c9778(0xe13)](_0x3d03b4),_0x381a07(),await _0x3679f3(),alert(_0x7c9778(0xe6c));}function _0x58f784(_0x58027c){const _0x1c56a5=_0x13d875,_0x2df38a=document[_0x1c56a5(0x53a)](_0x1c56a5(0xb64));_0x2df38a[_0x1c56a5(0xaac)]='';if(_0x58027c[_0x1c56a5(0x29d)]===0x0){const _0x8bec53=document['getElementById'](_0x1c56a5(0x40f))[_0x1c56a5(0x11a2)],_0x4436c3=_0x8bec53?_0x1c56a5(0x1309):_0x1c56a5(0xf37);_0x2df38a['innerHTML']=_0x1c56a5(0xa66)+_0x4436c3+_0x1c56a5(0x12e2);return;}for(const _0x1bc553 of _0x58027c){const _0x2f0e8a=document[_0x1c56a5(0xd67)](_0x1c56a5(0x1425));_0x2f0e8a[_0x1c56a5(0x6de)]='favorite-item-card',_0x2f0e8a[_0x1c56a5(0x999)][_0x1c56a5(0x714)]=_0x1bc553['id'];let _0x5442d9='',_0x265088='',_0xa2dfd5='',_0x531dd3='';if(_0x1bc553[_0x1c56a5(0x919)]===_0x1c56a5(0xc50)){const _0x558b45=_0x1bc553[_0x1c56a5(0x73e)];_0xa2dfd5=_0x1c56a5(0xd42);let _0x129edb=_0x5d06c0,_0x49d216='未知用户';if(_0x558b45['authorId']===_0x1c56a5(0x10ae))_0x129edb=_0x53d851[_0x1c56a5(0xa74)][_0x1c56a5(0x8cd)],_0x49d216=_0x53d851[_0x1c56a5(0xa74)][_0x1c56a5(0x1005)];else _0x53d851[_0x1c56a5(0xaa3)][_0x558b45[_0x1c56a5(0xa59)]]&&(_0x129edb=_0x53d851[_0x1c56a5(0xaa3)][_0x558b45[_0x1c56a5(0xa59)]][_0x1c56a5(0x81e)][_0x1c56a5(0x9e3)],_0x49d216=_0x53d851[_0x1c56a5(0xaa3)][_0x558b45[_0x1c56a5(0xa59)]][_0x1c56a5(0x234)]);_0x5442d9=_0x1c56a5(0x88b)+_0x129edb+_0x1c56a5(0xc52)+_0x49d216+'</div></div>';const _0x4878f0=_0x558b45['publicText']?_0x1c56a5(0x962)+_0x558b45['publicText'][_0x1c56a5(0x795)](/\n/g,'<br>')+_0x1c56a5(0x864):'';if(_0x558b45[_0x1c56a5(0x919)]===_0x1c56a5(0x12c5))_0x265088=_0x1c56a5(0x962)+_0x558b45[_0x1c56a5(0x73e)][_0x1c56a5(0x795)](/\n/g,_0x1c56a5(0x596))+_0x1c56a5(0x864);else{if(_0x558b45['type']===_0x1c56a5(0x1242)&&_0x558b45[_0x1c56a5(0x97a)]){const _0x233ee7=_0x53d851['globalSettings'][_0x1c56a5(0x128d)]&&_0x558b45[_0x1c56a5(0xadb)]?'https://image.pollinations.ai/prompt/'+_0x558b45[_0x1c56a5(0xadb)]:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x265088=_0x4878f0?_0x4878f0+_0x1c56a5(0x1262)+_0x233ee7+'\x22\x20class=\x22chat-image\x22></div>':_0x1c56a5(0x88b)+_0x233ee7+_0x1c56a5(0x13e3);}else{if(_0x558b45['type']===_0x1c56a5(0xa9a)){const _0x23efb3=_0x53d851['globalSettings'][_0x1c56a5(0x128d)]&&_0x558b45[_0x1c56a5(0xadb)]?_0x1c56a5(0x9ce)+_0x558b45[_0x1c56a5(0xadb)]:_0x1c56a5(0xbbd);_0x265088=_0x4878f0?_0x4878f0+_0x1c56a5(0x1262)+_0x23efb3+_0x1c56a5(0x44e)+_0x558b45[_0x1c56a5(0x319)]+_0x1c56a5(0xf56):'<img\x20src=\x22'+_0x23efb3+_0x1c56a5(0x44e)+_0x558b45[_0x1c56a5(0x319)]+'\x22>';}}}let _0x685be8='';_0x558b45[_0x1c56a5(0xf52)]&&_0x558b45[_0x1c56a5(0xf52)][_0x1c56a5(0x29d)]>0x0&&(_0x685be8='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-likes-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>'+_0x558b45['likes']['join']('、')+_0x1c56a5(0xfe7));let _0x61da41='';_0x558b45[_0x1c56a5(0x11ed)]&&_0x558b45[_0x1c56a5(0x11ed)][_0x1c56a5(0x29d)]>0x0&&(_0x61da41=_0x1c56a5(0x1009),_0x558b45[_0x1c56a5(0x11ed)][_0x1c56a5(0xeaf)]((_0x427982,_0x1cf302)=>{const _0x5c0635=_0x1c56a5;if(typeof _0x427982===_0x5c0635(0xc74)&&_0x427982!==null&&_0x427982[_0x5c0635(0x3a7)]){const _0x5b8379=_0x427982[_0x5c0635(0x3a7)],_0x14af42=_0x4b300d(_0x5b8379);let _0x1be28c;_0x19cec7[_0x5c0635(0x7f2)](_0x427982[_0x5c0635(0x2e6)])?_0x1be28c=_0x5c0635(0x88b)+_0x427982[_0x5c0635(0x2e6)]+_0x5c0635(0x4f0):_0x1be28c=_0x427982[_0x5c0635(0x2e6)];let _0x4befe3='';if(_0x427982['replyTo']){const _0x39a88d=_0x4b300d(_0x427982[_0x5c0635(0x7fc)]);_0x4befe3=_0x5c0635(0xe9c)+_0x14af42+_0x5c0635(0x1156)+_0x39a88d+'</span>:\x20'+_0x1be28c;}else _0x4befe3=_0x5c0635(0xe9c)+_0x14af42+_0x5c0635(0xca6)+_0x1be28c;_0x61da41+=_0x5c0635(0xe2e)+_0x558b45['id']+_0x5c0635(0x11d5)+_0x5b8379+_0x5c0635(0xf84)+_0x14af42+_0x5c0635(0x1244)+_0x4befe3+_0x5c0635(0xdeb)+_0x1cf302+_0x5c0635(0xdee);}else _0x61da41+=_0x5c0635(0x4d9)+String(_0x427982)+_0x5c0635(0x376);}),_0x61da41+=_0x1c56a5(0x864)),_0x531dd3=''+_0x685be8+_0x61da41;}else{if(_0x1bc553[_0x1c56a5(0x919)]===_0x1c56a5(0x776)){const _0x58ef71=_0x1bc553[_0x1c56a5(0x73e)],_0x2c6444=_0x53d851[_0x1c56a5(0xaa3)][_0x1bc553[_0x1c56a5(0x1054)]];if(!_0x2c6444)continue;_0xa2dfd5='来自与\x20'+_0x2c6444[_0x1c56a5(0x234)]+_0x1c56a5(0xe0b);const _0x162a72=_0x58ef71['role']===_0x1c56a5(0x10ae);let _0x358050,_0x44773a;if(_0x162a72)_0x358050=_0x2c6444[_0x1c56a5(0x86e)]?_0x2c6444['settings'][_0x1c56a5(0x1303)]||'我':'我',_0x44773a=_0x2c6444['settings'][_0x1c56a5(0x971)]||(_0x2c6444[_0x1c56a5(0x86e)]?_0x132d11:_0x5d06c0);else{if(_0x2c6444['isGroup']){const _0x2e8a40=_0x2c6444[_0x1c56a5(0x3de)][_0x1c56a5(0x397)](_0x49a541=>_0x49a541[_0x1c56a5(0x543)]===_0x58ef71['senderName']);_0x358050=_0x58ef71[_0x1c56a5(0xbee)],_0x44773a=_0x2e8a40?_0x2e8a40[_0x1c56a5(0x8cd)]:_0x434592;}else _0x358050=_0x2c6444[_0x1c56a5(0x234)],_0x44773a=_0x2c6444[_0x1c56a5(0x81e)][_0x1c56a5(0x9e3)]||_0x5d06c0;}_0x5442d9=_0x1c56a5(0x88b)+_0x44773a+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x358050+_0x1c56a5(0xd45);if(typeof _0x58ef71[_0x1c56a5(0x73e)]===_0x1c56a5(0xfc5)&&_0x19cec7[_0x1c56a5(0x7f2)](_0x58ef71[_0x1c56a5(0x73e)]))_0x265088=_0x1c56a5(0x88b)+_0x58ef71[_0x1c56a5(0x73e)]+_0x1c56a5(0x13a9);else Array[_0x1c56a5(0xb31)](_0x58ef71['content'])&&_0x58ef71['content'][0x0]?.['type']==='image_url'?_0x265088=_0x1c56a5(0x88b)+_0x58ef71[_0x1c56a5(0x73e)][0x0]['image_url'][_0x1c56a5(0xb36)]+'\x22\x20class=\x22chat-image\x22>':_0x265088=String(_0x58ef71[_0x1c56a5(0x73e)]||'')[_0x1c56a5(0x795)](/\n/g,'<br>');}else{if(_0x1bc553[_0x1c56a5(0x919)]===_0x1c56a5(0x97e)){const _0x12a61c=_0x1bc553[_0x1c56a5(0x73e)];_0xa2dfd5=_0x1c56a5(0x422)+_0x12a61c[_0x1c56a5(0x431)]+_0x1c56a5(0x6ed);const _0x28a32d=_0x53d851['chats'][_0x12a61c[_0x1c56a5(0xb93)]],_0x1b0d6e=_0x28a32d?_0x28a32d[_0x1c56a5(0x81e)][_0x1c56a5(0x9e3)]:_0x5d06c0;_0x5442d9=_0x1c56a5(0x88b)+_0x1b0d6e+_0x1c56a5(0xc52)+_0x12a61c[_0x1c56a5(0x431)]+_0x1c56a5(0xd45);const _0x41783d=_0x12a61c[_0x1c56a5(0x73e)]||'',_0x18237d=_0x46c503(_0x41783d)['replace'](/\n/g,_0x1c56a5(0x596));_0x265088=_0x1c56a5(0x1392)+_0x12a61c[_0x1c56a5(0x667)]+_0x1c56a5(0xd94)+_0x18237d+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}else{if(_0x1bc553[_0x1c56a5(0x919)]===_0x1c56a5(0x130e)){const _0x56676b=_0x1bc553[_0x1c56a5(0x73e)];_0xa2dfd5=_0x1c56a5(0x422)+_0x56676b['characterName']+'\x20的浏览记录';const _0x249ee2=_0x53d851[_0x1c56a5(0xaa3)][_0x56676b[_0x1c56a5(0xb93)]],_0x141fea=_0x249ee2?_0x249ee2[_0x1c56a5(0x81e)][_0x1c56a5(0x9e3)]:_0x5d06c0;_0x5442d9=_0x1c56a5(0x88b)+_0x141fea+_0x1c56a5(0xc52)+_0x56676b[_0x1c56a5(0x431)]+_0x1c56a5(0xd45),_0x265088=_0x1c56a5(0x3e9)+_0x56676b[_0x1c56a5(0x667)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>'+(_0x56676b['content']||'')['replace'](/\n/g,'<br>')+_0x1c56a5(0xca8);}else{if(_0x1bc553[_0x1c56a5(0x919)]===_0x1c56a5(0x1222)){const _0x576698=_0x1bc553[_0x1c56a5(0x73e)];_0xa2dfd5=_0x1c56a5(0x422)+_0x576698[_0x1c56a5(0x431)]+_0x1c56a5(0x730);const _0x2a2857=_0x53d851[_0x1c56a5(0xaa3)][_0x576698[_0x1c56a5(0xb93)]],_0x35545e=_0x2a2857?_0x2a2857[_0x1c56a5(0x81e)]['aiAvatar']:_0x5d06c0;_0x5442d9=_0x1c56a5(0x88b)+_0x35545e+_0x1c56a5(0xc52)+_0x576698[_0x1c56a5(0x431)]+_0x1c56a5(0xd45),_0x265088=_0x1c56a5(0x602)+_0x576698[_0x1c56a5(0x667)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>'+_0x576698['content'][_0x1c56a5(0x795)](/\n/g,_0x1c56a5(0x596))+_0x1c56a5(0x8bc);}}}}}_0x2f0e8a[_0x1c56a5(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-header\x22>'+_0x5442d9+_0x1c56a5(0x1317)+_0xa2dfd5+_0x1c56a5(0xf4b)+_0x265088+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x531dd3,_0x2df38a[_0x1c56a5(0x133d)](_0x2f0e8a);}}async function _0xf36c44(){const _0x3e0154=_0x13d875;allFavoriteItems=await _0xa62efb['favorites'][_0x3e0154(0x1064)](_0x3e0154(0x827))[_0x3e0154(0x843)]()[_0x3e0154(0xa73)]();const _0xa1e539=document[_0x3e0154(0x53a)]('favorites-search-input'),_0x1128a8=document['getElementById'](_0x3e0154(0x733));_0xa1e539[_0x3e0154(0x11a2)]='',_0x1128a8['style']['display']=_0x3e0154(0xbf2),_0x58f784(allFavoriteItems);}function _0x1c899c(){const _0x2de52e=_0x13d875;document['getElementById']('post-public-text')[_0x2de52e(0x11a2)]='',document['getElementById'](_0x2de52e(0x11d8))['src']='',document[_0x2de52e(0x53a)]('post-image-description')[_0x2de52e(0x11a2)]='',document[_0x2de52e(0x53a)](_0x2de52e(0x289))['classList']['remove'](_0x2de52e(0xaef)),document[_0x2de52e(0x53a)]('post-image-desc-group')[_0x2de52e(0x1284)][_0x2de52e(0x11d9)]=_0x2de52e(0xbf2),document[_0x2de52e(0x53a)](_0x2de52e(0x94b))['value']='',document[_0x2de52e(0x53a)](_0x2de52e(0x93b))['value']='',document[_0x2de52e(0x53a)](_0x2de52e(0x4c8))[_0x2de52e(0xb2b)]();}async function _0xc9c860(){const _0x14e270=_0x13d875,_0x3cf112=await _0x355fc0(_0x14e270(0x1288),'此操作将扫描数据库，移除所有与已删除角色相关的孤立数据（如动态、评论、记忆等）。<br><br><strong>此操作不可撤销，但通常是安全的。NPC数据不会被删除。</strong><br><br>建议在操作前先导出数据备份。',{'confirmButtonClass':'btn-danger','confirmText':_0x14e270(0x1451)});if(!_0x3cf112)return;await _0x184397(_0x14e270(0x11d7),_0x14e270(0x636)),console['log'](_0x14e270(0xeb0));let _0x3bc426={'posts':0x0,'likes':0x0,'comments':0x0,'memories':0x0,'callRecords':0x0,'renderingRules':0x0,'groupMembers':0x0,'chatLinks':0x0};try{await _0xa62efb[_0x14e270(0x11ab)]('rw',_0xa62efb['tables'],async()=>{const _0xd94523=_0x14e270,_0x1c1c5f=await _0xa62efb['chats'][_0xd94523(0xa73)](),_0x3b1692=await _0xa62efb[_0xd94523(0x5b7)]['toArray'](),_0x319071=new Set(_0x1c1c5f[_0xd94523(0xcb4)](_0x1cf6a5=>_0x1cf6a5['id'])),_0x22b542=new Set(_0x3b1692['map'](_0x3de498=>_0xd94523(0xc78)+_0x3de498['id'])),_0x36aea5=new Set(_0x1c1c5f[_0xd94523(0x2dd)](_0x53bc8f=>!_0x53bc8f[_0xd94523(0x86e)])[_0xd94523(0xcb4)](_0x49071e=>_0x49071e[_0xd94523(0x543)]));_0x36aea5['add'](_0x53d851[_0xd94523(0xa74)][_0xd94523(0x1005)]||_0xd94523(0x8ac)),_0x3b1692['forEach'](_0x1cbbd1=>_0x36aea5[_0xd94523(0xe13)](_0x1cbbd1[_0xd94523(0x234)]));for(const _0x170512 of _0x1c1c5f){let _0xda9ca6=![];if(_0x170512[_0xd94523(0x86e)]&&_0x170512[_0xd94523(0x3de)]){const _0x1dd91b=_0x170512['members'][_0xd94523(0x29d)];_0x170512[_0xd94523(0x3de)]=_0x170512[_0xd94523(0x3de)]['filter'](_0x186d3e=>_0x319071['has'](_0x186d3e['id'])||_0x22b542[_0xd94523(0x11af)](_0x186d3e['id'])),_0x170512[_0xd94523(0x3de)][_0xd94523(0x29d)]<_0x1dd91b&&(_0x3bc426[_0xd94523(0x142d)]+=_0x1dd91b-_0x170512[_0xd94523(0x3de)]['length'],_0xda9ca6=!![]);}if(_0x170512[_0xd94523(0x81e)]?.['linkedMemoryChatIds']?.[_0xd94523(0x29d)]>0x0){const _0x1938ff=_0x170512[_0xd94523(0x81e)][_0xd94523(0x278)][_0xd94523(0x29d)];_0x170512[_0xd94523(0x81e)]['linkedMemoryChatIds']=_0x170512[_0xd94523(0x81e)][_0xd94523(0x278)][_0xd94523(0x2dd)](_0x19698d=>_0x319071[_0xd94523(0x11af)](_0x19698d)),_0x170512[_0xd94523(0x81e)][_0xd94523(0x278)][_0xd94523(0x29d)]<_0x1938ff&&(_0x3bc426[_0xd94523(0x914)]+=_0x1938ff-_0x170512[_0xd94523(0x81e)]['linkedMemoryChatIds'][_0xd94523(0x29d)],_0xda9ca6=!![]);}_0xda9ca6&&await _0xa62efb[_0xd94523(0xaa3)][_0xd94523(0x546)](_0x170512);}const _0x410ede=await _0xa62efb[_0xd94523(0xfc2)][_0xd94523(0xa73)]();for(const _0x2dfa57 of _0x410ede){let _0x1461c9=![];const _0x1d2c24=_0x2dfa57[_0xd94523(0xa59)]===_0xd94523(0x10ae)||_0x319071[_0xd94523(0x11af)](_0x2dfa57[_0xd94523(0xa59)])||_0x22b542['has'](_0x2dfa57[_0xd94523(0xa59)]);if(!_0x1d2c24){await _0xa62efb[_0xd94523(0xfc2)][_0xd94523(0x121e)](_0x2dfa57['id']),_0x3bc426[_0xd94523(0x308)]++;continue;}if(_0x2dfa57[_0xd94523(0xf52)]&&_0x2dfa57['likes'][_0xd94523(0x29d)]>0x0){const _0x3a0415=_0x2dfa57['likes']['length'];_0x2dfa57[_0xd94523(0xf52)]=_0x2dfa57['likes'][_0xd94523(0x2dd)](_0x363666=>_0x36aea5['has'](_0x363666)),_0x2dfa57[_0xd94523(0xf52)]['length']<_0x3a0415&&(_0x3bc426[_0xd94523(0xf52)]+=_0x3a0415-_0x2dfa57['likes'][_0xd94523(0x29d)],_0x1461c9=!![]);}if(_0x2dfa57[_0xd94523(0x11ed)]&&_0x2dfa57[_0xd94523(0x11ed)]['length']>0x0){const _0x136741=_0x2dfa57[_0xd94523(0x11ed)][_0xd94523(0x29d)];_0x2dfa57[_0xd94523(0x11ed)]=_0x2dfa57[_0xd94523(0x11ed)][_0xd94523(0x2dd)](_0x49a5fe=>{const _0x989215=_0xd94523;if(typeof _0x49a5fe==='object'&&_0x49a5fe['commenterName'])return _0x36aea5[_0x989215(0x11af)](_0x49a5fe[_0x989215(0x3a7)]);return!![];}),_0x2dfa57[_0xd94523(0x11ed)]['length']<_0x136741&&(_0x3bc426[_0xd94523(0x11ed)]+=_0x136741-_0x2dfa57['comments']['length'],_0x1461c9=!![]);}_0x1461c9&&await _0xa62efb[_0xd94523(0xfc2)][_0xd94523(0x546)](_0x2dfa57);}await _0xa62efb[_0xd94523(0xbe7)][_0xd94523(0x57e)](_0xd94523(0x1054))[_0xd94523(0x5e6)]([..._0x319071])[_0xd94523(0x121e)]()[_0xd94523(0x299)](_0x1caf15=>_0x3bc426[_0xd94523(0xbe7)]+=_0x1caf15),await _0xa62efb[_0xd94523(0x346)][_0xd94523(0x57e)](_0xd94523(0x1054))['noneOf']([..._0x319071])['delete']()[_0xd94523(0x299)](_0x1831da=>_0x3bc426['callRecords']+=_0x1831da);const _0x2a0a03=await _0xa62efb[_0xd94523(0xb23)][_0xd94523(0xa73)]();for(const _0x50dece of _0x2a0a03){_0x50dece['chatId']!==_0xd94523(0x131a)&&!_0x319071['has'](_0x50dece[_0xd94523(0x1054)])&&(await _0xa62efb['renderingRules'][_0xd94523(0x121e)](_0x50dece['id']),_0x3bc426[_0xd94523(0xb23)]++);}});let _0x529269=_0x14e270(0x712),_0x26d075=![];Object[_0x14e270(0xfdc)](_0x3bc426)[_0x14e270(0xeaf)](([_0x242972,_0x51aa63])=>{const _0x3d4e1e=_0x14e270;if(_0x51aa63>0x0){const _0x273402={'posts':'动态','likes':'点赞','comments':'评论','memories':'记忆','callRecords':_0x3d4e1e(0x408),'renderingRules':_0x3d4e1e(0x7e0),'groupMembers':_0x3d4e1e(0xc82),'chatLinks':_0x3d4e1e(0x912)};_0x529269+=_0x3d4e1e(0x749)+_0x51aa63+_0x3d4e1e(0xe97)+(_0x273402[_0x242972]||_0x242972)+'。\x0a',_0x26d075=!![];}});!_0x26d075&&(_0x529269='✅\x20检查完成，未发现任何冗余数据。');_0x529269+=_0x14e270(0xa08),await _0x184397(_0x14e270(0xfd5),_0x529269);const _0x57fe58=await _0x355fc0('刷新页面？',_0x14e270(0xdf1));_0x57fe58&&location[_0x14e270(0x648)]();}catch(_0x3d6d4a){console['error']('清理冗余数据时出错:',_0x3d6d4a),await _0x184397('清理失败',_0x14e270(0x3b8)+_0x3d6d4a['message']);}}async function _0xc47eb4(){const _0x49b67c=_0x13d875;try{const _0x51f023={'version':0x1,'timestamp':Date[_0x49b67c(0x9c1)]()},[_0x362fa4,_0x3ce227,_0x3aadb6,_0x61ff01,_0x2be4b4,_0x1b794a,_0x562eb5,_0x3c48fd,_0x4728c6,_0x8811e1,_0x7ff9f5,_0x16a412,_0x3bcfe5,_0x1264f8,_0x3974a9,_0x6de9b3,_0x5cb04f,_0x14d0fd,_0x372f85,_0x3ad801,_0x5d1756,_0x3d137f,_0x18f2b6,_0x87dbb7,_0x566479]=await Promise['all']([_0xa62efb[_0x49b67c(0xaa3)][_0x49b67c(0xa73)](),_0xa62efb[_0x49b67c(0x10f2)][_0x49b67c(0xa73)](),_0xa62efb['userStickers'][_0x49b67c(0xa73)](),_0xa62efb[_0x49b67c(0x80d)][_0x49b67c(0x883)](_0x49b67c(0xc19)),_0xa62efb[_0x49b67c(0x906)][_0x49b67c(0x883)](_0x49b67c(0xc19)),_0xa62efb['personaPresets'][_0x49b67c(0xa73)](),_0xa62efb[_0x49b67c(0x12bd)][_0x49b67c(0x883)](_0x49b67c(0xc19)),_0xa62efb[_0x49b67c(0xa74)][_0x49b67c(0x883)]('main'),_0xa62efb['qzonePosts'][_0x49b67c(0xa73)](),_0xa62efb[_0x49b67c(0x7a3)][_0x49b67c(0xa73)](),_0xa62efb['qzonePhotos'][_0x49b67c(0xa73)](),_0xa62efb[_0x49b67c(0xb51)]['toArray'](),_0xa62efb[_0x49b67c(0x443)][_0x49b67c(0xa73)](),_0xa62efb[_0x49b67c(0xbe7)]['toArray'](),_0xa62efb[_0x49b67c(0xf5d)]['toArray'](),_0xa62efb[_0x49b67c(0x142c)]['toArray'](),_0xa62efb[_0x49b67c(0x1257)]['toArray'](),_0xa62efb[_0x49b67c(0x346)][_0x49b67c(0xa73)](),_0xa62efb[_0x49b67c(0xb23)][_0x49b67c(0xa73)](),_0xa62efb[_0x49b67c(0x360)][_0x49b67c(0xa73)](),_0xa62efb['stickerCategories'][_0x49b67c(0xa73)](),_0xa62efb[_0x49b67c(0x51d)][_0x49b67c(0xa73)](),_0xa62efb[_0x49b67c(0x13b8)][_0x49b67c(0xa73)](),_0xa62efb[_0x49b67c(0xa3c)][_0x49b67c(0xa73)](),_0xa62efb[_0x49b67c(0x5b7)][_0x49b67c(0xa73)]()]);Object[_0x49b67c(0x100b)](_0x51f023,{'chats':_0x362fa4,'worldBooks':_0x3ce227,'userStickers':_0x3aadb6,'apiConfig':_0x61ff01,'globalSettings':_0x2be4b4,'personaPresets':_0x1b794a,'musicLibrary':_0x562eb5,'qzoneSettings':_0x3c48fd,'qzonePosts':_0x4728c6,'qzoneAlbums':_0x8811e1,'qzonePhotos':_0x7ff9f5,'favorites':_0x16a412,'qzoneGroups':_0x3bcfe5,'memories':_0x1264f8,'worldBookCategories':_0x3974a9,'apiPresets':_0x6de9b3,'shoppingProducts':_0x5cb04f,'callRecords':_0x14d0fd,'renderingRules':_0x372f85,'doubanPosts':_0x3ad801,'stickerCategories':_0x5d1756,'appearancePresets':_0x3d137f,'presets':_0x18f2b6,'presetCategories':_0x87dbb7,'npcs':_0x566479});const _0x457f3d=new Blob([JSON[_0x49b67c(0xe1e)](_0x51f023,null,0x2)],{'type':_0x49b67c(0x85b)}),_0x1154f0=URL['createObjectURL'](_0x457f3d),_0x36b08a=Object[_0x49b67c(0x100b)](document['createElement']('a'),{'href':_0x1154f0,'download':_0x49b67c(0xd9b)+new Date()['toISOString']()['split']('T')[0x0]+_0x49b67c(0xbed)});_0x36b08a[_0x49b67c(0xb2b)](),URL[_0x49b67c(0x39b)](_0x1154f0),await _0x184397(_0x49b67c(0x4e0),_0x49b67c(0xd60));}catch(_0x3dc137){console[_0x49b67c(0x617)](_0x49b67c(0xe9b),_0x3dc137),await _0x184397(_0x49b67c(0x484),'发生了一个错误:\x20'+_0x3dc137[_0x49b67c(0x875)]);}}async function _0x4a1078(_0x3649d6){const _0x226003=_0x13d875;try{await _0xa62efb[_0x226003(0x11ab)]('rw',_0xa62efb[_0x226003(0x760)],async()=>{const _0x566919=_0x226003;for(const _0x968940 of _0xa62efb[_0x566919(0x760)]){await _0x968940['clear']();}for(const _0x4b401b in _0x3649d6){Array['isArray'](_0x3649d6[_0x4b401b])&&(console[_0x566919(0x1081)](_0x566919(0x1060)+_0x4b401b+_0x566919(0xb4e)+_0x3649d6[_0x4b401b][_0x566919(0x29d)]),await _0xa62efb[_0x566919(0xdec)](_0x4b401b)[_0x566919(0x2db)](_0x3649d6[_0x4b401b]));}});}catch(_0x35049f){throw new Error(_0x226003(0x30b)+_0x35049f[_0x226003(0x875)]);}}async function _0x3b72d9(_0x4ef637){const _0x3c89df=_0x13d875;if(!_0x4ef637)return;const _0x2069a5=await _0x355fc0('严重警告！',_0x3c89df(0x72a),{'confirmButtonClass':_0x3c89df(0x264)});if(!_0x2069a5)return;await _0x184397(_0x3c89df(0x11d7),_0x3c89df(0x3ad));try{const _0x569cd1=await _0x4ef637[_0x3c89df(0x2e6)](),_0x419003=JSON['parse'](_0x569cd1);if(_0x419003[_0x3c89df(0xd7c)]&&typeof _0x419003[_0x3c89df(0xd7c)]==='object'&&_0x419003[_0x3c89df(0xd7c)][_0x3c89df(0xaa3)])console[_0x3c89df(0x1081)](_0x3c89df(0x1426)),await _0x4a1078(_0x419003[_0x3c89df(0xd7c)]);else{if(_0x419003[_0x3c89df(0xaa3)])console['log'](_0x3c89df(0xe31)),await _0x1ea13d(_0x419003);else throw new Error('文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20备份文件。');}await _0x184397(_0x3c89df(0x11c0),_0x3c89df(0x115b)),setTimeout(()=>{const _0x222011=_0x3c89df;window['location'][_0x222011(0x648)]();},0x5dc);}catch(_0x24283d){console[_0x3c89df(0x617)](_0x3c89df(0x8dd),_0x24283d),await _0x184397(_0x3c89df(0x3a1),'文件解析或应用失败:\x20'+_0x24283d[_0x3c89df(0x875)]);}}async function _0x1ea13d(_0x4c59da){const _0x514a63=_0x13d875;try{await _0xa62efb['transaction']('rw',_0xa62efb[_0x514a63(0x760)],async()=>{const _0x1d48a6=_0x514a63;await _0xa62efb[_0x1d48a6(0xaa3)][_0x1d48a6(0xfcf)](),await _0xa62efb['worldBooks'][_0x1d48a6(0xfcf)]();for(const _0x5aea88 of _0xa62efb[_0x1d48a6(0x760)]){await _0x5aea88[_0x1d48a6(0xfcf)]();}if(Array[_0x1d48a6(0xb31)](_0x4c59da[_0x1d48a6(0xaa3)]))await _0xa62efb[_0x1d48a6(0xaa3)][_0x1d48a6(0x2db)](_0x4c59da['chats']);if(Array[_0x1d48a6(0xb31)](_0x4c59da[_0x1d48a6(0x10f2)]))await _0xa62efb['worldBooks']['bulkPut'](_0x4c59da[_0x1d48a6(0x10f2)]);if(Array['isArray'](_0x4c59da[_0x1d48a6(0xf8f)]))await _0xa62efb[_0x1d48a6(0xf8f)]['bulkPut'](_0x4c59da[_0x1d48a6(0xf8f)]);if(_0x4c59da[_0x1d48a6(0x80d)])await _0xa62efb[_0x1d48a6(0x80d)]['put'](_0x4c59da['apiConfig']);if(_0x4c59da[_0x1d48a6(0x906)])await _0xa62efb['globalSettings'][_0x1d48a6(0x546)](_0x4c59da[_0x1d48a6(0x906)]);if(Array['isArray'](_0x4c59da[_0x1d48a6(0x7c7)]))await _0xa62efb[_0x1d48a6(0x7c7)]['bulkPut'](_0x4c59da['personaPresets']);if(_0x4c59da['musicLibrary'])await _0xa62efb[_0x1d48a6(0x12bd)]['put'](_0x4c59da[_0x1d48a6(0x12bd)]);if(_0x4c59da['qzoneSettings'])await _0xa62efb['qzoneSettings'][_0x1d48a6(0x546)](_0x4c59da['qzoneSettings']);if(Array[_0x1d48a6(0xb31)](_0x4c59da['qzonePosts']))await _0xa62efb['qzonePosts'][_0x1d48a6(0x2db)](_0x4c59da[_0x1d48a6(0xfc2)]);if(Array[_0x1d48a6(0xb31)](_0x4c59da['qzoneAlbums']))await _0xa62efb[_0x1d48a6(0x7a3)][_0x1d48a6(0x2db)](_0x4c59da[_0x1d48a6(0x7a3)]);if(Array['isArray'](_0x4c59da['qzonePhotos']))await _0xa62efb[_0x1d48a6(0x1272)][_0x1d48a6(0x2db)](_0x4c59da[_0x1d48a6(0x1272)]);if(Array[_0x1d48a6(0xb31)](_0x4c59da[_0x1d48a6(0xb51)]))await _0xa62efb[_0x1d48a6(0xb51)][_0x1d48a6(0x2db)](_0x4c59da[_0x1d48a6(0xb51)]);if(Array[_0x1d48a6(0xb31)](_0x4c59da['qzoneGroups']))await _0xa62efb[_0x1d48a6(0x443)][_0x1d48a6(0x2db)](_0x4c59da[_0x1d48a6(0x443)]);if(Array[_0x1d48a6(0xb31)](_0x4c59da[_0x1d48a6(0xbe7)]))await _0xa62efb[_0x1d48a6(0xbe7)][_0x1d48a6(0x2db)](_0x4c59da[_0x1d48a6(0xbe7)]);if(Array[_0x1d48a6(0xb31)](_0x4c59da['worldBookCategories']))await _0xa62efb[_0x1d48a6(0xf5d)][_0x1d48a6(0x2db)](_0x4c59da[_0x1d48a6(0xf5d)]);if(Array[_0x1d48a6(0xb31)](_0x4c59da['apiPresets']))await _0xa62efb[_0x1d48a6(0x142c)][_0x1d48a6(0x2db)](_0x4c59da[_0x1d48a6(0x142c)]);if(Array[_0x1d48a6(0xb31)](_0x4c59da[_0x1d48a6(0x1257)]))await _0xa62efb['shoppingProducts']['bulkPut'](_0x4c59da['shoppingProducts']);if(Array[_0x1d48a6(0xb31)](_0x4c59da[_0x1d48a6(0x346)]))await _0xa62efb[_0x1d48a6(0x346)][_0x1d48a6(0x2db)](_0x4c59da[_0x1d48a6(0x346)]);if(Array['isArray'](_0x4c59da['renderingRules']))await _0xa62efb['renderingRules'][_0x1d48a6(0x2db)](_0x4c59da[_0x1d48a6(0xb23)]);if(Array[_0x1d48a6(0xb31)](_0x4c59da[_0x1d48a6(0x360)]))await _0xa62efb[_0x1d48a6(0x360)][_0x1d48a6(0x2db)](_0x4c59da[_0x1d48a6(0x360)]);if(Array[_0x1d48a6(0xb31)](_0x4c59da['stickerCategories']))await _0xa62efb[_0x1d48a6(0xa9c)][_0x1d48a6(0x2db)](_0x4c59da[_0x1d48a6(0xa9c)]);if(Array['isArray'](_0x4c59da[_0x1d48a6(0x51d)]))await _0xa62efb[_0x1d48a6(0x51d)][_0x1d48a6(0x2db)](_0x4c59da[_0x1d48a6(0x51d)]);if(Array[_0x1d48a6(0xb31)](_0x4c59da[_0x1d48a6(0x13b8)]))await _0xa62efb['presets'][_0x1d48a6(0x2db)](_0x4c59da['presets']);if(Array[_0x1d48a6(0xb31)](_0x4c59da[_0x1d48a6(0xa3c)]))await _0xa62efb[_0x1d48a6(0xa3c)][_0x1d48a6(0x2db)](_0x4c59da[_0x1d48a6(0xa3c)]);if(Array[_0x1d48a6(0xb31)](_0x4c59da[_0x1d48a6(0x5b7)]))await _0xa62efb[_0x1d48a6(0x5b7)][_0x1d48a6(0x2db)](_0x4c59da[_0x1d48a6(0x5b7)]);});}catch(_0x25ebb6){throw new Error(_0x514a63(0x1db)+_0x25ebb6[_0x514a63(0x875)]);}}function _0x281d80(_0x388c27,_0x2521e8=![]){const _0x23b072=_0x13d875;if(!_0x388c27){_0xe7279a[_0x23b072(0xaac)]='',document[_0x23b072(0x53a)](_0x23b072(0xec0))['style'][_0x23b072(0xd48)]='';return;}const _0x795972=_0x23b072(0x10f6),_0x958ef='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27'+_0x795972+_0x23b072(0x13a1)+_0x388c27+_0x23b072(0x91d);if(_0x2521e8){const _0x9f382e=document[_0x23b072(0x53a)](_0x23b072(0x1179))||document[_0x23b072(0xd67)](_0x23b072(0x1284));_0x9f382e['id']='preview-font-style',_0x9f382e[_0x23b072(0xaac)]=_0x958ef;if(!document[_0x23b072(0x53a)](_0x23b072(0x1179)))document[_0x23b072(0x66b)]['appendChild'](_0x9f382e);document['getElementById'](_0x23b072(0xec0))[_0x23b072(0x1284)][_0x23b072(0xd48)]='\x27'+_0x795972+_0x23b072(0x887);}else _0xe7279a[_0x23b072(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x958ef+_0x23b072(0x1136)+_0x795972+_0x23b072(0xbb3);}async function _0x4c23a4(){const _0x911734=_0x13d875;_0xe7279a[_0x911734(0xaac)]='',_0x53d851[_0x911734(0x906)]['fontUrl']='',await _0xa62efb['globalSettings'][_0x911734(0x546)](_0x53d851['globalSettings']),document[_0x911734(0x53a)](_0x911734(0x9a2))[_0x911734(0x11a2)]='',document[_0x911734(0x53a)](_0x911734(0xec0))['style'][_0x911734(0xd48)]='',alert(_0x911734(0x24a));}async function _0x483882(){const _0x652698=_0x13d875,[_0x2270bb,_0x403b66,_0x429d99,_0xe0216d,_0x12437e,_0x5c214a,_0x46c0e1,_0x20daf6,_0x42d465,_0x19e8b0,_0x4e980f]=await Promise[_0x652698(0x63d)]([_0xa62efb[_0x652698(0xaa3)][_0x652698(0xa73)](),_0xa62efb['apiConfig'][_0x652698(0x883)](_0x652698(0xc19)),_0xa62efb[_0x652698(0x906)][_0x652698(0x883)](_0x652698(0xc19)),_0xa62efb[_0x652698(0xf8f)][_0x652698(0xa73)](),_0xa62efb[_0x652698(0x10f2)][_0x652698(0xa73)](),_0xa62efb[_0x652698(0x12bd)][_0x652698(0x883)]('main'),_0xa62efb['personaPresets']['toArray'](),_0xa62efb[_0x652698(0xa74)][_0x652698(0x883)](_0x652698(0xc19)),_0xa62efb[_0x652698(0xb51)][_0x652698(0x1064)]('timestamp')[_0x652698(0x843)]()[_0x652698(0xa73)](),_0xa62efb[_0x652698(0xbe7)][_0x652698(0xa73)](),_0xa62efb[_0x652698(0x13b8)][_0x652698(0xa73)]()]);_0x53d851[_0x652698(0x13b8)]=_0x4e980f||[];const _0x58b8a7={'id':_0x652698(0xc19),'showStatusBar':![],'wallpaper':'linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','fontUrl':'','enableBackgroundActivity':![],'backgroundActivityInterval':0x3c,'blockCooldownHours':0x1,'apiTemperature':0.8,'appIcons':{..._0x186c79},'cphoneWallpaper':_0x652698(0xcc7),'cphoneAppIcons':{..._0x2618dd},'globalCss':'','notificationSoundUrl':'','widgetData':{},'globalChatBackground':'','enableAiDrawing':!![],'chatActionButtonsOrder':null,'shoppingCategoryCount':0x3,'shoppingProductCount':0x8,'chatRenderWindow':0x32};_0x53d851[_0x652698(0x906)]={..._0x58b8a7,..._0x429d99||{}},_0x53d851[_0x652698(0x906)]['appIcons']={..._0x58b8a7['appIcons'],..._0x53d851['globalSettings']['appIcons']||{}},_0x53d851[_0x652698(0x906)][_0x652698(0xaee)]={..._0x58b8a7[_0x652698(0xaee)],..._0x53d851[_0x652698(0x906)]['cphoneAppIcons']||{}},_0x2270bb['forEach'](_0xa0a91c=>{const _0x17e490=_0x652698;typeof _0xa0a91c[_0x17e490(0x81e)][_0x17e490(0x558)]===_0x17e490(0x131e)&&(_0xa0a91c[_0x17e490(0x81e)][_0x17e490(0x558)]=!![]),!_0xa0a91c[_0x17e490(0x81e)][_0x17e490(0x10d7)]&&(_0xa0a91c['settings'][_0x17e490(0x10d7)]={'vertical':_0x17e490(0x624),'horizontal':'center','offset':0xa}),!_0xa0a91c[_0x17e490(0x86e)]&&!_0xa0a91c['settings'][_0x17e490(0xd0e)]&&(_0xa0a91c[_0x17e490(0x81e)][_0x17e490(0xd0e)]=[]),!_0xa0a91c[_0x17e490(0x86e)]&&typeof _0xa0a91c[_0x17e490(0x543)]===_0x17e490(0x131e)&&(_0xa0a91c[_0x17e490(0x543)]=_0xa0a91c[_0x17e490(0x234)]);}),_0x53d851['chats']=_0x2270bb[_0x652698(0xae0)]((_0x1be5c8,_0xfce4d2)=>{const _0x540241=_0x652698;if(typeof _0xfce4d2[_0x540241(0x8ce)]===_0x540241(0x131e))_0xfce4d2['unreadCount']=0x0;_0xfce4d2['isGroup']&&(typeof _0xfce4d2[_0x540241(0x81e)][_0x540241(0x527)]==='undefined'&&(_0xfce4d2[_0x540241(0x81e)][_0x540241(0x527)]=!![]),_0xfce4d2[_0x540241(0x3de)]&&_0xfce4d2[_0x540241(0x3de)][_0x540241(0x29d)]>0x0&&_0xfce4d2[_0x540241(0x3de)][0x0][_0x540241(0x234)]&&_0xfce4d2['members'][_0x540241(0xeaf)](_0x3bd90b=>{const _0x108a4b=_0x540241;typeof _0x3bd90b[_0x108a4b(0x543)]==='undefined'&&(_0x3bd90b['originalName']=_0x3bd90b[_0x108a4b(0x234)],_0x3bd90b[_0x108a4b(0x12bc)]=_0x3bd90b[_0x108a4b(0x234)],delete _0x3bd90b[_0x108a4b(0x234)]);}));if(!_0xfce4d2['settings'])_0xfce4d2[_0x540241(0x81e)]={};typeof _0xfce4d2[_0x540241(0x81e)][_0x540241(0xdd0)]==='undefined'&&(_0xfce4d2[_0x540241(0x81e)]['actionCooldownMinutes']=0xa);if(!_0xfce4d2[_0x540241(0x86e)]&&!_0xfce4d2[_0x540241(0x12d3)])_0xfce4d2[_0x540241(0x12d3)]={'text':'在线','lastUpdate':Date[_0x540241(0x9c1)](),'isBusy':![]};if(!_0xfce4d2['isGroup']&&!_0xfce4d2[_0x540241(0x1333)])_0xfce4d2[_0x540241(0x1333)]={'status':_0x540241(0x10b1),'blockedTimestamp':null,'applicationReason':''};if(!_0xfce4d2[_0x540241(0x86e)]&&(!_0xfce4d2[_0x540241(0x81e)]||!_0xfce4d2[_0x540241(0x81e)][_0x540241(0x78e)])){if(!_0xfce4d2[_0x540241(0x81e)])_0xfce4d2[_0x540241(0x81e)]={};_0xfce4d2[_0x540241(0x81e)][_0x540241(0x78e)]=[];}_0xfce4d2[_0x540241(0x86e)]&&(_0xfce4d2['members']||[])[_0x540241(0xeaf)](_0x317b09=>{const _0x5001bb=_0x540241;if(typeof _0x317b09[_0x5001bb(0x1069)]==='undefined')_0x317b09[_0x5001bb(0x1069)]='';});if(!_0xfce4d2[_0x540241(0x59d)])_0xfce4d2[_0x540241(0x59d)]={'totalTime':0x0};_0xfce4d2[_0x540241(0x81e)]&&_0xfce4d2[_0x540241(0x81e)][_0x540241(0x5a5)]&&!_0xfce4d2['settings'][_0x540241(0x4ab)]&&(_0xfce4d2[_0x540241(0x81e)]['linkedWorldBookIds']=[_0xfce4d2[_0x540241(0x81e)]['linkedWorldBookId']],delete _0xfce4d2[_0x540241(0x81e)][_0x540241(0x5a5)]);if(typeof _0xfce4d2[_0x540241(0x4d4)]===_0x540241(0x131e))_0xfce4d2[_0x540241(0x4d4)]=![];!_0xfce4d2[_0x540241(0x86e)]&&typeof _0xfce4d2[_0x540241(0x81e)][_0x540241(0x1303)]===_0x540241(0x131e)&&(_0xfce4d2['settings']['myNickname']='我');if(_0xfce4d2[_0x540241(0x86e)]&&_0xfce4d2[_0x540241(0x3de)]){let _0x457d7a=![];_0x2270bb['forEach'](_0x42842c=>{const _0x55faed=_0x540241;_0x42842c['id']===_0xfce4d2['id']&&_0x42842c[_0x55faed(0x543)]&&delete _0x42842c[_0x55faed(0x543)];}),_0xfce4d2[_0x540241(0x3de)][_0x540241(0xeaf)](_0x3b3a82=>{const _0x3f0c31=_0x540241,_0x1e28f6=_0x2270bb[_0x3f0c31(0x397)](_0x1aa3e7=>_0x1aa3e7['id']===_0x3b3a82['id']);if(_0x1e28f6&&_0x1e28f6[_0x3f0c31(0x81e)]){const _0x53cd71=_0x1e28f6[_0x3f0c31(0x81e)][_0x3f0c31(0x2bf)]||'';_0x3b3a82[_0x3f0c31(0x1069)]!==_0x53cd71&&(_0x3b3a82[_0x3f0c31(0x1069)]=_0x53cd71,_0x457d7a=!![]);}else typeof _0x3b3a82[_0x3f0c31(0x1069)]===_0x3f0c31(0x131e)&&(_0x3b3a82[_0x3f0c31(0x1069)]='',_0x457d7a=!![]);});if(_0x457d7a)_0xa62efb['chats'][_0x540241(0x546)](_0xfce4d2);}if(!_0xfce4d2[_0x540241(0x81e)]['enableAutoMemory'])_0xfce4d2['settings'][_0x540241(0xe1a)]=![];if(!_0xfce4d2[_0x540241(0x81e)][_0x540241(0x645)])_0xfce4d2[_0x540241(0x81e)][_0x540241(0x645)]=0x14;if(!_0xfce4d2['longTermMemory'])_0xfce4d2[_0x540241(0x1016)]=[];if(!_0xfce4d2[_0x540241(0xa95)])_0xfce4d2[_0x540241(0xa95)]=0x0;if(!_0xfce4d2[_0x540241(0x86e)]){typeof _0xfce4d2['settings']['enableBackgroundActivity']==='undefined'&&(_0xfce4d2[_0x540241(0x81e)][_0x540241(0x527)]=!![]);typeof _0xfce4d2['settings']['enableTts']===_0x540241(0x131e)&&(_0xfce4d2[_0x540241(0x81e)][_0x540241(0x107c)]=![]);if(!_0xfce4d2[_0x540241(0x12d3)])_0xfce4d2[_0x540241(0x12d3)]={'text':'在线','lastUpdate':Date[_0x540241(0x9c1)](),'isBusy':![]};if(!_0xfce4d2[_0x540241(0x1333)])_0xfce4d2[_0x540241(0x1333)]={'status':'friend','blockedTimestamp':null,'applicationReason':''};if(!_0xfce4d2[_0x540241(0x81e)]||!_0xfce4d2[_0x540241(0x81e)][_0x540241(0x78e)]){if(!_0xfce4d2['settings'])_0xfce4d2[_0x540241(0x81e)]={};_0xfce4d2[_0x540241(0x81e)][_0x540241(0x78e)]=[];}if(typeof _0xfce4d2['settings']['isOfflineMode']===_0x540241(0x131e))_0xfce4d2[_0x540241(0x81e)][_0x540241(0x9af)]=![];if(typeof _0xfce4d2[_0x540241(0x81e)][_0x540241(0x804)]===_0x540241(0x131e))_0xfce4d2[_0x540241(0x81e)][_0x540241(0x804)]=0x64;if(typeof _0xfce4d2['settings'][_0x540241(0x11ef)]===_0x540241(0x131e))_0xfce4d2[_0x540241(0x81e)]['offlineMaxLength']=0x12c;typeof _0xfce4d2['settings'][_0x540241(0xe12)]==='undefined'&&(_0xfce4d2[_0x540241(0x81e)][_0x540241(0xe12)]=![]);if(typeof _0xfce4d2['heartfeltVoice']===_0x540241(0x131e))_0xfce4d2[_0x540241(0x13cb)]=_0x540241(0x95d);if(typeof _0xfce4d2[_0x540241(0xc35)]===_0x540241(0x131e))_0xfce4d2[_0x540241(0xc35)]=_0x540241(0x95d);!Array[_0x540241(0xb31)](_0xfce4d2[_0x540241(0xf2c)])&&(_0xfce4d2[_0x540241(0xf2c)]=[]);}return typeof _0xfce4d2[_0x540241(0x81e)][_0x540241(0xdc1)]===_0x540241(0x131e)&&(_0xfce4d2['settings'][_0x540241(0x141b)]?_0xfce4d2[_0x540241(0x81e)]['stickerCategoryIds']=[_0xfce4d2['settings'][_0x540241(0x141b)]]:_0xfce4d2[_0x540241(0x81e)]['stickerCategoryIds']=[],delete _0xfce4d2[_0x540241(0x81e)][_0x540241(0x141b)]),_0x1be5c8[_0xfce4d2['id']]=_0xfce4d2,_0x1be5c8;},{});const _0x44499b=[];_0x19e8b0['forEach'](_0x29dfae=>{const _0xb51f1e=_0x652698;if(_0x29dfae['type']===_0xb51f1e(0xb5d)&&_0x29dfae[_0xb51f1e(0x3dd)]&&!_0x29dfae['authorId']){const _0xc9eb7c=_0x2270bb['find'](_0x382429=>!_0x382429[_0xb51f1e(0x86e)]&&_0x382429[_0xb51f1e(0x543)]===_0x29dfae['authorName']);if(_0xc9eb7c)_0x29dfae[_0xb51f1e(0xa59)]=_0xc9eb7c['id'],_0x44499b['push'](_0x29dfae);else{const _0x1c729a=_0x2270bb[_0xb51f1e(0x397)](_0x110cbe=>!_0x110cbe['isGroup']&&_0x110cbe[_0xb51f1e(0x234)]===_0x29dfae[_0xb51f1e(0x3dd)]);_0x1c729a&&(_0x29dfae[_0xb51f1e(0xa59)]=_0x1c729a['id'],_0x44499b[_0xb51f1e(0x7dd)](_0x29dfae));}}}),_0x44499b[_0x652698(0x29d)]>0x0&&await _0xa62efb[_0x652698(0xbe7)]['bulkPut'](_0x44499b),_0x53d851[_0x652698(0x80d)]=_0x403b66||{'id':_0x652698(0xc19),'proxyUrl':'','apiKey':'','model':'','secondaryProxyUrl':'','secondaryApiKey':'','secondaryModel':'','minimaxGroupId':'','minimaxApiKey':'','minimaxModel':_0x652698(0xd37)},_0x53d851[_0x652698(0xf8f)]=_0xe0216d||[],_0x53d851[_0x652698(0x10f2)]=_0x12437e||[],_0x2eebda[_0x652698(0xc9a)]=_0x5c214a?.[_0x652698(0xc9a)]||[],_0x53d851[_0x652698(0x7c7)]=_0x46c0e1||[],_0x53d851[_0x652698(0xa74)]=_0x20daf6||{'id':_0x652698(0xc19),'nickname':_0x652698(0x8ac),'avatar':'https://files.catbox.moe/q6z5fc.jpeg','banner':'https://files.catbox.moe/r5heyt.gif'},allFavoriteItems=_0x42d465||[];}async function _0x4cf2f7(){const _0x5606f1=_0x13d875;await _0xa62efb[_0x5606f1(0x12bd)][_0x5606f1(0x546)]({'id':_0x5606f1(0xc19),'playlist':_0x2eebda[_0x5606f1(0xc9a)]});}function _0x41a5db(_0x5038ae){const _0x33340e=_0x13d875;if(!_0x5038ae)return'';const _0x1a367b=new Date(_0x5038ae),_0x4569f1=String(_0x1a367b[_0x33340e(0x659)]())[_0x33340e(0x117e)](0x2,'0'),_0x199eb7=String(_0x1a367b[_0x33340e(0xa77)]())[_0x33340e(0x117e)](0x2,'0');return _0x4569f1+':'+_0x199eb7;}function _0x272f9c(_0x1d8232){const _0x272b13=_0x13d875,_0xe954be=Date['now'](),_0x7fd300=Math['floor']((_0xe954be-_0x1d8232)/0x3e8);if(_0x7fd300<0x3c)return'刚刚';const _0x1650df=Math[_0x272b13(0x7d5)](_0x7fd300/0x3c);if(_0x1650df<0x3c)return _0x1650df+_0x272b13(0x5f4);const _0x2f6f01=Math[_0x272b13(0x7d5)](_0x1650df/0x3c);if(_0x2f6f01<0x18)return _0x2f6f01+_0x272b13(0x1171);const _0x1bc488=Math['floor'](_0x2f6f01/0x18);if(_0x1bc488<0x1e)return _0x1bc488+'天前';const _0x5b8656=Math[_0x272b13(0x7d5)](_0x1bc488/0x1e);if(_0x5b8656<0xc)return'大约'+_0x5b8656+_0x272b13(0xb2f);const _0x5bf04e=Math[_0x272b13(0x7d5)](_0x1bc488/0x16d);return'大约'+_0x5bf04e+'年前';}function _0x4e608d(_0x4b546c){const _0x4b0642=_0x13d875;if(!_0x4b546c)return'';const _0x348956=new Date(),_0x7ffcab=new Date(_0x4b546c),_0x12230a=String(_0x7ffcab['getHours']())[_0x4b0642(0x117e)](0x2,'0'),_0x1e11ed=String(_0x7ffcab['getMinutes']())[_0x4b0642(0x117e)](0x2,'0'),_0x15dc95=_0x12230a+':'+_0x1e11ed;if(_0x348956[_0x4b0642(0x2bb)]()===_0x7ffcab[_0x4b0642(0x2bb)]())return _0x4b0642(0x3ea)+_0x15dc95;const _0xf0a45e=new Date();_0xf0a45e[_0x4b0642(0x1129)](_0x348956[_0x4b0642(0xfae)]()-0x1);if(_0xf0a45e[_0x4b0642(0x2bb)]()===_0x7ffcab['toDateString']())return _0x4b0642(0xd16)+_0x15dc95;if(_0x348956[_0x4b0642(0xf14)]()===_0x7ffcab['getFullYear']()){const _0x2d8a4f=String(_0x7ffcab[_0x4b0642(0x255)]()+0x1),_0x2334f2=String(_0x7ffcab['getDate']());return _0x2d8a4f+'月'+_0x2334f2+'日\x20'+_0x15dc95;}const _0x2f3578=_0x7ffcab['getFullYear'](),_0x1dcd36=String(_0x7ffcab[_0x4b0642(0x255)]()+0x1),_0x8e127=String(_0x7ffcab[_0x4b0642(0xfae)]());return _0x2f3578+'年'+_0x1dcd36+'月'+_0x8e127+'日\x20'+_0x15dc95;}function _0x44d347(){const _0x5efeb2=_0x13d875,_0x2ff8ee=_0x2b389a();document['getElementById'](_0x5efeb2(0xb0b))['value']=_0x2ff8ee[_0x5efeb2(0x9c9)],document['getElementById'](_0x5efeb2(0x121f))[_0x5efeb2(0x11a2)]=_0x2ff8ee[_0x5efeb2(0xfbd)],document['getElementById'](_0x5efeb2(0x11c1))[_0x5efeb2(0x11a2)]=_0x2ff8ee[_0x5efeb2(0x112c)],document['getElementById']('nai-sampler')[_0x5efeb2(0x11a2)]=_0x2ff8ee[_0x5efeb2(0x836)],document[_0x5efeb2(0x53a)]('nai-seed')['value']=_0x2ff8ee[_0x5efeb2(0x36b)],document['getElementById']('nai-uc-preset')[_0x5efeb2(0x11a2)]=_0x2ff8ee[_0x5efeb2(0x85e)],document[_0x5efeb2(0x53a)]('nai-quality-toggle')[_0x5efeb2(0x1077)]=_0x2ff8ee['quality_toggle'],document[_0x5efeb2(0x53a)](_0x5efeb2(0x3d6))['checked']=_0x2ff8ee[_0x5efeb2(0x63e)],document[_0x5efeb2(0x53a)](_0x5efeb2(0xb52))[_0x5efeb2(0x1077)]=_0x2ff8ee[_0x5efeb2(0x1268)],document['getElementById']('nai-default-positive')[_0x5efeb2(0x11a2)]=_0x2ff8ee[_0x5efeb2(0x5ec)],document['getElementById']('nai-default-negative')['value']=_0x2ff8ee[_0x5efeb2(0xee8)],document[_0x5efeb2(0x53a)](_0x5efeb2(0xf8d))[_0x5efeb2(0x11a2)]=_0x2ff8ee[_0x5efeb2(0x1167)],document[_0x5efeb2(0x53a)](_0x5efeb2(0x3ff))[_0x5efeb2(0x11a2)]=_0x2ff8ee['custom_proxy_url']||'';const _0x7216d7=document['getElementById'](_0x5efeb2(0x87f));_0x7216d7[_0x5efeb2(0x1284)]['display']=_0x2ff8ee['cors_proxy']==='custom'?_0x5efeb2(0x1ea):_0x5efeb2(0xbf2);}function _0x1cdc8a(){const _0x3707ae=_0x13d875,_0xe04173=document['getElementById'](_0x3707ae(0x11bf))['checked'],_0x47d2b7=document[_0x3707ae(0x53a)]('novelai-model')[_0x3707ae(0x11a2)],_0x589073=document['getElementById'](_0x3707ae(0x84e))[_0x3707ae(0x11a2)][_0x3707ae(0x13bc)]();localStorage[_0x3707ae(0xf64)](_0x3707ae(0xc18),_0xe04173),localStorage['setItem']('novelai-model',_0x47d2b7),localStorage[_0x3707ae(0xf64)](_0x3707ae(0x84e),_0x589073);const _0x2c9d26={'resolution':document[_0x3707ae(0x53a)](_0x3707ae(0xb0b))[_0x3707ae(0x11a2)],'steps':parseInt(document['getElementById'](_0x3707ae(0x121f))[_0x3707ae(0x11a2)]),'cfg_scale':parseFloat(document['getElementById'](_0x3707ae(0x11c1))[_0x3707ae(0x11a2)]),'sampler':document['getElementById'](_0x3707ae(0x1218))[_0x3707ae(0x11a2)],'seed':parseInt(document[_0x3707ae(0x53a)]('nai-seed')[_0x3707ae(0x11a2)]),'uc_preset':parseInt(document['getElementById'](_0x3707ae(0xa39))[_0x3707ae(0x11a2)]),'quality_toggle':document[_0x3707ae(0x53a)](_0x3707ae(0xb3b))[_0x3707ae(0x1077)],'smea':document[_0x3707ae(0x53a)]('nai-smea')[_0x3707ae(0x1077)],'smea_dyn':document[_0x3707ae(0x53a)]('nai-smea-dyn')[_0x3707ae(0x1077)],'default_positive':document[_0x3707ae(0x53a)](_0x3707ae(0xe21))[_0x3707ae(0x11a2)],'default_negative':document[_0x3707ae(0x53a)](_0x3707ae(0x646))['value'],'cors_proxy':document[_0x3707ae(0x53a)]('nai-cors-proxy')[_0x3707ae(0x11a2)],'custom_proxy_url':document[_0x3707ae(0x53a)]('nai-custom-proxy-url')[_0x3707ae(0x11a2)]};localStorage[_0x3707ae(0xf64)](_0x3707ae(0x2dc),JSON[_0x3707ae(0xe1e)](_0x2c9d26));}function _0x23627e(){const _0x47da2e=_0x13d875;localStorage[_0x47da2e(0x13de)](_0x47da2e(0x2dc)),_0x44d347(),alert(_0x47da2e(0x550));}function _0x2b389a(){const _0x231a18=_0x13d875,_0x1dc727={'resolution':_0x231a18(0xab7),'steps':0x1c,'cfg_scale':0x5,'sampler':_0x231a18(0xc51),'seed':-0x1,'uc_preset':0x1,'quality_toggle':!![],'smea':!![],'smea_dyn':![],'default_positive':_0x231a18(0x9de),'default_negative':_0x231a18(0x99a),'cors_proxy':'https://corsproxy.io/?','custom_proxy_url':''},_0x444e3f=localStorage[_0x231a18(0xa14)](_0x231a18(0x2dc));if(_0x444e3f)try{return{..._0x1dc727,...JSON[_0x231a18(0x367)](_0x444e3f)};}catch(_0x58fc88){return _0x1dc727;}return _0x1dc727;}function _0x33851e(_0x43c61f){const _0x3fb1b9=_0x13d875,_0x313ca2=_0x2b389a();if(!_0x43c61f||!_0x53d851[_0x3fb1b9(0xaa3)][_0x43c61f])return console[_0x3fb1b9(0x1081)](_0x3fb1b9(0xd03)),{'positive':_0x313ca2[_0x3fb1b9(0x5ec)],'negative':_0x313ca2['default_negative'],'source':_0x3fb1b9(0xab3)};const _0xcb3cb5=_0x53d851[_0x3fb1b9(0xaa3)][_0x43c61f],_0x3cc360=_0xcb3cb5['settings'][_0x3fb1b9(0x612)]||{};return _0x3cc360['promptSource']===_0x3fb1b9(0xde1)?(console[_0x3fb1b9(0x1081)]('✅\x20NAI提示词：使用角色配置'),console[_0x3fb1b9(0x1081)]('\x20\x20\x20正面:',_0x3cc360[_0x3fb1b9(0xe6b)]||_0x3fb1b9(0x94c)),console[_0x3fb1b9(0x1081)](_0x3fb1b9(0x331),_0x3cc360[_0x3fb1b9(0x9cd)]||'(空)'),{'positive':_0x3cc360[_0x3fb1b9(0xe6b)]||'','negative':_0x3cc360[_0x3fb1b9(0x9cd)]||'','source':_0x3fb1b9(0xde1)}):(console['log'](_0x3fb1b9(0x563)),console[_0x3fb1b9(0x1081)](_0x3fb1b9(0xdc9),_0x313ca2['default_positive']||_0x3fb1b9(0x94c)),console['log'](_0x3fb1b9(0x331),_0x313ca2['default_negative']||_0x3fb1b9(0x94c)),{'positive':_0x313ca2[_0x3fb1b9(0x5ec)],'negative':_0x313ca2[_0x3fb1b9(0xee8)],'source':_0x3fb1b9(0xab3)});}async function _0x5af38d(){const _0x43aabc=_0x13d875,_0x4d1c6a=document[_0x43aabc(0x53a)](_0x43aabc(0x84e))[_0x43aabc(0x11a2)]['trim'](),_0x5dc9b2=document[_0x43aabc(0x53a)]('novelai-model')[_0x43aabc(0x11a2)],_0x1fdf7e=document[_0x43aabc(0x53a)](_0x43aabc(0x973))[_0x43aabc(0x11a2)][_0x43aabc(0x13bc)]();if(!_0x4d1c6a){alert('请先配置NovelAI\x20API\x20Key！');return;}if(!_0x1fdf7e){alert(_0x43aabc(0x2b7));return;}const _0x1ac459=_0x2b389a(),_0xdd5514=document[_0x43aabc(0x53a)](_0x43aabc(0x1269))['value'][_0x43aabc(0x13bc)](),_0x5cae24=document[_0x43aabc(0x53a)](_0x43aabc(0x933)),_0x2e0cd3=document[_0x43aabc(0x53a)](_0x43aabc(0x6d5)),_0x571aeb=document[_0x43aabc(0x53a)]('nai-test-error'),_0x5cbe05=document[_0x43aabc(0x53a)]('nai-generate-btn');_0x5cae24['style'][_0x43aabc(0x11d9)]=_0x43aabc(0x1ea),_0x2e0cd3[_0x43aabc(0x1284)][_0x43aabc(0x11d9)]=_0x43aabc(0xbf2),_0x571aeb[_0x43aabc(0x1284)][_0x43aabc(0x11d9)]=_0x43aabc(0xbf2),_0x5cbe05[_0x43aabc(0xb77)]=!![],_0x5cbe05[_0x43aabc(0x34a)]=_0x43aabc(0xda9);try{const [_0xaca2e6,_0x4723c1]=_0x1ac459[_0x43aabc(0x9c9)][_0x43aabc(0x13e8)]('x')['map'](Number);let _0x39c56e;_0x5dc9b2[_0x43aabc(0x6e9)]('nai-diffusion-4')?_0x39c56e={'input':_0x1fdf7e,'model':_0x5dc9b2,'action':'generate','parameters':{'params_version':0x3,'width':_0xaca2e6,'height':_0x4723c1,'scale':_0x1ac459[_0x43aabc(0x112c)],'sampler':_0x1ac459[_0x43aabc(0x836)],'steps':_0x1ac459[_0x43aabc(0xfbd)],'seed':_0x1ac459[_0x43aabc(0x36b)]===-0x1?Math[_0x43aabc(0x7d5)](Math[_0x43aabc(0xac4)]()*0x2540be3ff):_0x1ac459[_0x43aabc(0x36b)],'n_samples':0x1,'ucPreset':_0x1ac459['uc_preset'],'qualityToggle':_0x1ac459[_0x43aabc(0xa41)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x43aabc(0xa43),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x1fdf7e,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0xdd5514,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0xdd5514,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x39c56e={'input':_0x1fdf7e,'model':_0x5dc9b2,'action':'generate','parameters':{'width':_0xaca2e6,'height':_0x4723c1,'scale':_0x1ac459[_0x43aabc(0x112c)],'sampler':_0x1ac459[_0x43aabc(0x836)],'steps':_0x1ac459['steps'],'seed':_0x1ac459['seed']===-0x1?Math['floor'](Math['random']()*0x2540be3ff):_0x1ac459[_0x43aabc(0x36b)],'n_samples':0x1,'ucPreset':_0x1ac459[_0x43aabc(0x85e)],'qualityToggle':_0x1ac459['quality_toggle'],'sm':_0x1ac459[_0x43aabc(0x63e)],'sm_dyn':_0x1ac459[_0x43aabc(0x1268)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x43aabc(0x940),'negative_prompt':_0xdd5514}};console[_0x43aabc(0x1081)](_0x43aabc(0x6a4)),console[_0x43aabc(0x1081)](_0x43aabc(0xb5c),_0x5dc9b2),console['log'](_0x43aabc(0x717),JSON[_0x43aabc(0xe1e)](_0x39c56e,null,0x2));let _0x543de4;_0x5dc9b2[_0x43aabc(0x6e9)]('nai-diffusion-4')?_0x543de4=_0x43aabc(0x6ef):_0x543de4=_0x43aabc(0x41b);let _0x1a76b8=_0x1ac459[_0x43aabc(0x1167)];_0x1a76b8===_0x43aabc(0xa86)&&(_0x1a76b8=_0x1ac459[_0x43aabc(0xa38)]||'');_0x1a76b8&&_0x1a76b8!==''&&(_0x543de4=_0x1a76b8+encodeURIComponent(_0x543de4));const _0xaa64b4=/Chrome/[_0x43aabc(0x7f2)](navigator[_0x43aabc(0x89f)])&&!/Edg/[_0x43aabc(0x7f2)](navigator[_0x43aabc(0x89f)]);let _0x3190be={'method':_0x43aabc(0xa4e),'headers':{'Content-Type':_0x43aabc(0x85b),'Authorization':_0x43aabc(0x841)+_0x4d1c6a},'body':JSON['stringify'](_0x39c56e)};if(_0xaa64b4){console[_0x43aabc(0x1081)](_0x43aabc(0x126c));const _0x57a4c5={};for(const [_0x1d6969,_0x5d4c7a]of Object[_0x43aabc(0xfdc)](_0x3190be[_0x43aabc(0x4df)])){_0x57a4c5[_0x1d6969]=_0x5d4c7a['replace'](/[^\x00-\xFF]/g,'');}_0x3190be[_0x43aabc(0x4df)]=_0x57a4c5;}const _0x498fa2=await fetch(_0x543de4,_0x3190be);console[_0x43aabc(0x1081)]('Response\x20status:',_0x498fa2[_0x43aabc(0x12d3)]),console[_0x43aabc(0x1081)](_0x43aabc(0x62d),[..._0x498fa2[_0x43aabc(0x4df)]['entries']()]);if(!_0x498fa2['ok']){const _0x3a4b29=await _0x498fa2[_0x43aabc(0x2e6)]();console[_0x43aabc(0x617)](_0x43aabc(0x4f4),_0x3a4b29);throw new Error(_0x43aabc(0x10c4)+_0x498fa2[_0x43aabc(0x12d3)]+_0x43aabc(0x1108)+_0x3a4b29);}const _0x39ab70=_0x498fa2[_0x43aabc(0x4df)]['get'](_0x43aabc(0x459));console[_0x43aabc(0x1081)]('Content-Type:',_0x39ab70);let _0x59a28d;if(_0x39ab70&&_0x39ab70[_0x43aabc(0x6e9)]('text/event-stream')){console[_0x43aabc(0x1081)](_0x43aabc(0x782)),_0x5cae24['textContent']='正在接收流式数据...';const _0x90fb18=await _0x498fa2[_0x43aabc(0x2e6)]();console['log']('收到\x20SSE\x20数据，大小:',_0x90fb18[_0x43aabc(0x29d)]);const _0x1b7b70=_0x90fb18[_0x43aabc(0x13bc)]()[_0x43aabc(0x13e8)]('\x0a');let _0x1c6255=null;for(let _0x5628a3=_0x1b7b70[_0x43aabc(0x29d)]-0x1;_0x5628a3>=0x0;_0x5628a3--){const _0x2ef2f8=_0x1b7b70[_0x5628a3][_0x43aabc(0x13bc)]();if(_0x2ef2f8[_0x43aabc(0x1200)](_0x43aabc(0x709))&&_0x2ef2f8!==_0x43aabc(0x1100)){const _0x4d2f21=_0x2ef2f8[_0x43aabc(0xad6)](0x6);try{const _0x6bfc18=JSON[_0x43aabc(0x367)](_0x4d2f21);if(_0x6bfc18['event_type']===_0x43aabc(0xef1)&&_0x6bfc18[_0x43aabc(0xace)]){_0x1c6255=_0x6bfc18[_0x43aabc(0xace)],console[_0x43aabc(0x1081)](_0x43aabc(0xab8));break;}if(_0x6bfc18[_0x43aabc(0xd7c)]){_0x1c6255=_0x6bfc18[_0x43aabc(0xd7c)],console[_0x43aabc(0x1081)](_0x43aabc(0xdd1));break;}if(_0x6bfc18[_0x43aabc(0xace)]){_0x1c6255=_0x6bfc18[_0x43aabc(0xace)],console[_0x43aabc(0x1081)]('从\x20JSON.image\x20中提取图片数据');break;}}catch(_0x5e0eb5){_0x1c6255=_0x4d2f21,console['log'](_0x43aabc(0x22f));break;}}}if(!_0x1c6255)throw new Error(_0x43aabc(0x78c));const _0x464950=_0x1c6255[_0x43aabc(0x1200)](_0x43aabc(0x753)),_0x5e08ea=_0x1c6255[_0x43aabc(0x1200)]('/9j/');if(_0x464950||_0x5e08ea){console[_0x43aabc(0x1081)](_0x43aabc(0x238));const _0x4fbb17=atob(_0x1c6255),_0x55c7b6=new Uint8Array(_0x4fbb17['length']);for(let _0x2d29fc=0x0;_0x2d29fc<_0x4fbb17['length'];_0x2d29fc++){_0x55c7b6[_0x2d29fc]=_0x4fbb17[_0x43aabc(0x24b)](_0x2d29fc);}const _0x43812c=new Blob([_0x55c7b6],{'type':_0x464950?_0x43aabc(0xeb8):'image/jpeg'});console[_0x43aabc(0x1081)](_0x43aabc(0x398),_0x43812c['size']);const _0x242eb5=URL[_0x43aabc(0xaa0)](_0x43812c);document[_0x43aabc(0x53a)](_0x43aabc(0xe5c))[_0x43aabc(0x7ff)]=_0x242eb5,_0x5cae24[_0x43aabc(0x1284)][_0x43aabc(0x11d9)]='none',_0x2e0cd3[_0x43aabc(0x1284)]['display']=_0x43aabc(0x1ea),console[_0x43aabc(0x1081)](_0x43aabc(0x1070));return;}console[_0x43aabc(0x1081)](_0x43aabc(0xb1b));const _0x13273c=atob(_0x1c6255),_0x13e3ea=new Uint8Array(_0x13273c[_0x43aabc(0x29d)]);for(let _0x3aeca6=0x0;_0x3aeca6<_0x13273c[_0x43aabc(0x29d)];_0x3aeca6++){_0x13e3ea[_0x3aeca6]=_0x13273c['charCodeAt'](_0x3aeca6);}_0x59a28d=new Blob([_0x13e3ea]),console[_0x43aabc(0x1081)](_0x43aabc(0xc96),_0x59a28d['size']);}else _0x59a28d=await _0x498fa2[_0x43aabc(0xfa4)](),console[_0x43aabc(0x1081)](_0x43aabc(0x3cf),_0x59a28d[_0x43aabc(0x919)],_0x43aabc(0x131b),_0x59a28d[_0x43aabc(0x38e)]);try{if(typeof JSZip==='undefined')throw new Error(_0x43aabc(0xd6a));_0x5cae24[_0x43aabc(0x34a)]=_0x43aabc(0x11d4);const _0x17ac3d=await JSZip[_0x43aabc(0xea9)](_0x59a28d);console[_0x43aabc(0x1081)](_0x43aabc(0x706),Object[_0x43aabc(0x1350)](_0x17ac3d[_0x43aabc(0x1413)]));let _0x2fde46=null;for(let _0x43726d in _0x17ac3d[_0x43aabc(0x1413)]){if(_0x43726d[_0x43aabc(0x1120)](/\.(png|jpg|jpeg|webp)$/i)){_0x2fde46=_0x17ac3d['files'][_0x43726d],console[_0x43aabc(0x1081)](_0x43aabc(0x75e),_0x43726d);break;}}if(!_0x2fde46)throw new Error(_0x43aabc(0x4c7));const _0x27c784=await _0x2fde46[_0x43aabc(0x11cb)](_0x43aabc(0xfa4));console[_0x43aabc(0x1081)]('提取的图片大小:',_0x27c784['size']);const _0x2b3927=URL[_0x43aabc(0xaa0)](_0x27c784);console['log'](_0x43aabc(0x5ae),_0x2b3927),document['getElementById'](_0x43aabc(0xe5c))[_0x43aabc(0x7ff)]=_0x2b3927,_0x5cae24[_0x43aabc(0x1284)]['display']=_0x43aabc(0xbf2),_0x2e0cd3['style'][_0x43aabc(0x11d9)]=_0x43aabc(0x1ea);}catch(_0x561f7d){console[_0x43aabc(0x617)]('ZIP解压失败:',_0x561f7d),console['log']('尝试直接作为图片显示...');if(_0x59a28d['type'][_0x43aabc(0x1200)](_0x43aabc(0x135d))){const _0x4579ab=URL[_0x43aabc(0xaa0)](_0x59a28d);document[_0x43aabc(0x53a)](_0x43aabc(0xe5c))[_0x43aabc(0x7ff)]=_0x4579ab,_0x5cae24[_0x43aabc(0x1284)][_0x43aabc(0x11d9)]='none',_0x2e0cd3['style'][_0x43aabc(0x11d9)]=_0x43aabc(0x1ea);}else throw new Error(_0x43aabc(0x1118)+_0x561f7d['message']);}}catch(_0x9ebff){console[_0x43aabc(0x617)](_0x43aabc(0xc56),_0x9ebff),_0x5cae24[_0x43aabc(0x1284)][_0x43aabc(0x11d9)]=_0x43aabc(0xbf2),_0x571aeb['style'][_0x43aabc(0x11d9)]=_0x43aabc(0x1ea),_0x571aeb[_0x43aabc(0x34a)]=_0x43aabc(0x29a)+_0x9ebff[_0x43aabc(0x875)];}finally{_0x5cbe05['disabled']=![],_0x5cbe05[_0x43aabc(0x34a)]=_0x43aabc(0xa10);}}function _0x23d2a1(_0x402746,_0x1fb57f){const _0x19549c=_0x13d875;_0x1ac891(),clearTimeout(_0x4634a2);const _0x42a85d=_0x53d851['chats'][_0x402746];if(!_0x42a85d)return;const _0x5cbad3=document[_0x19549c(0x53a)](_0x19549c(0x32b));document[_0x19549c(0x53a)](_0x19549c(0x5c3))[_0x19549c(0x7ff)]=_0x42a85d['settings'][_0x19549c(0x9e3)]||_0x42a85d['settings']['groupAvatar']||_0x5d06c0,document[_0x19549c(0x53a)]('notification-content')[_0x19549c(0x139c)](_0x19549c(0x1145))[_0x19549c(0x34a)]=_0x42a85d[_0x19549c(0x234)],document[_0x19549c(0x53a)](_0x19549c(0x46f))[_0x19549c(0x139c)](_0x19549c(0x58b))[_0x19549c(0x34a)]=_0x1fb57f,_0x5cbad3['classList'][_0x19549c(0x2d4)]('visible'),void _0x5cbad3['offsetWidth'],_0x5cbad3[_0x19549c(0x1276)][_0x19549c(0xe13)](_0x19549c(0xaef));const _0x1e765f=_0x5cbad3['cloneNode'](!![]);_0x5cbad3[_0x19549c(0x9e8)][_0x19549c(0xa1d)](_0x1e765f,_0x5cbad3),_0x1e765f[_0x19549c(0x1086)](_0x19549c(0xb2b),()=>{const _0x590ee2=_0x19549c;_0x1e3a7c(_0x402746),_0x1e765f[_0x590ee2(0x1276)][_0x590ee2(0x2d4)](_0x590ee2(0xaef));}),_0x4634a2=setTimeout(()=>{const _0x676293=_0x19549c;_0x1e765f[_0x676293(0x1276)][_0x676293(0x2d4)]('visible');},0xfa0),_0x5983f0();}function _0x344b05(){const _0x2d38dc=_0x13d875,_0x330d22=new Date(),_0x31625d=_0x330d22['toLocaleTimeString'](_0x2d38dc(0x42f),{'hour':_0x2d38dc(0x1371),'minute':_0x2d38dc(0x1371)}),_0x2d4265=_0x330d22[_0x2d38dc(0xc76)]('zh-CN',{'weekday':_0x2d38dc(0x11bd),'month':'long','day':_0x2d38dc(0xcbe)});document[_0x2d38dc(0x53a)](_0x2d38dc(0x127f))[_0x2d38dc(0x34a)]=_0x31625d;}function _0x3e5855(_0x5dd85f){const _0x3f3112=_0x13d875,_0xc3db4=_0x5dd85f['trim']();if(_0xc3db4[_0x3f3112(0x1200)]('[')&&_0xc3db4[_0x3f3112(0xc31)](']'))try{const _0x55b9a8=JSON[_0x3f3112(0x367)](_0xc3db4);if(Array[_0x3f3112(0xb31)](_0x55b9a8))return console['log'](_0x3f3112(0xdaa)),_0x55b9a8;}catch(_0x15bd4a){console[_0x3f3112(0xad0)](_0x3f3112(0x1083));}const _0x2b3aad=_0xc3db4[_0x3f3112(0x1120)](/{[^{}]*}/g);if(_0x2b3aad){const _0x68bc08=[];for(const _0x202762 of _0x2b3aad){try{const _0x468b6a=JSON[_0x3f3112(0x367)](_0x202762);_0x68bc08[_0x3f3112(0x7dd)](_0x468b6a);}catch(_0x2c9a4a){console[_0x3f3112(0xad0)](_0x3f3112(0x121c),_0x202762);}}if(_0x68bc08[_0x3f3112(0x29d)]>0x0)return console[_0x3f3112(0x1081)](_0x3f3112(0x8a5)),_0x68bc08;}return console[_0x3f3112(0x617)](_0x3f3112(0xc34)),[{'type':'text','content':_0x5dd85f}];}function _0x49fe75(_0x1c9753=new Date()){const _0x14b6cd=_0x1c9753['getHours']();if(_0x14b6cd>=0x0&&_0x14b6cd<0x5)return'凌晨';else{if(_0x14b6cd>=0x5&&_0x14b6cd<0x9)return'早上';else{if(_0x14b6cd>=0x9&&_0x14b6cd<0xd)return'上午';else{if(_0x14b6cd>=0xd&&_0x14b6cd<0x12)return'下午';else{if(_0x14b6cd>=0x12&&_0x14b6cd<0x18)return'晚上';}}}}return'现在';}async function _0x2ba066(){const _0x1039a9=_0x13d875,_0x1dafe5=document['getElementById'](_0x1039a9(0x7b5));_0x1dafe5[_0x1039a9(0xaac)]=_0x1039a9(0x5c8);const _0x8713a0=await _0xa62efb[_0x1039a9(0x142c)][_0x1039a9(0xa73)]();_0x8713a0[_0x1039a9(0xeaf)](_0x17ffe2=>{const _0x2da457=_0x1039a9,_0x41bfbc=document[_0x2da457(0xd67)](_0x2da457(0xa1e));_0x41bfbc['value']=_0x17ffe2['id'],_0x41bfbc[_0x2da457(0x34a)]=_0x17ffe2['name'],_0x1dafe5[_0x2da457(0x133d)](_0x41bfbc);});const _0x416773=_0x53d851[_0x1039a9(0x80d)];let _0x386424=null;for(const _0x45e1ec of _0x8713a0){if(_0x45e1ec['proxyUrl']===_0x416773[_0x1039a9(0x122e)]&&_0x45e1ec[_0x1039a9(0xe95)]===_0x416773['apiKey']&&_0x45e1ec[_0x1039a9(0xd6f)]===_0x416773[_0x1039a9(0xd6f)]&&_0x45e1ec['secondaryProxyUrl']===_0x416773[_0x1039a9(0x11f4)]&&_0x45e1ec[_0x1039a9(0x8ec)]===_0x416773['secondaryApiKey']&&_0x45e1ec[_0x1039a9(0x112b)]===_0x416773['secondaryModel']&&(_0x45e1ec['minimaxGroupId']||'')===(_0x416773['minimaxGroupId']||'')&&(_0x45e1ec[_0x1039a9(0x6ce)]||'')===(_0x416773[_0x1039a9(0x6ce)]||'')&&(_0x45e1ec[_0x1039a9(0x32e)]||_0x1039a9(0xd37))===(_0x416773[_0x1039a9(0x32e)]||'speech-01')){_0x386424=_0x45e1ec['id'];break;}}_0x386424?_0x1dafe5[_0x1039a9(0x11a2)]=_0x386424:_0x1dafe5[_0x1039a9(0x11a2)]=_0x1039a9(0x11c2);}async function _0xdf3eb9(){const _0x59b24a=_0x13d875,_0x25ec69=document[_0x59b24a(0x53a)]('api-preset-select'),_0x19831f=parseInt(_0x25ec69[_0x59b24a(0x11a2)]);if(isNaN(_0x19831f))return;const _0x485e42=await _0xa62efb[_0x59b24a(0x142c)][_0x59b24a(0x883)](_0x19831f);_0x485e42&&(_0x53d851['apiConfig']={'id':_0x59b24a(0xc19),'proxyUrl':_0x485e42[_0x59b24a(0x122e)],'apiKey':_0x485e42[_0x59b24a(0xe95)],'model':_0x485e42['model'],'secondaryProxyUrl':_0x485e42[_0x59b24a(0x11f4)],'secondaryApiKey':_0x485e42[_0x59b24a(0x8ec)],'secondaryModel':_0x485e42[_0x59b24a(0x112b)],'minimaxGroupId':_0x485e42[_0x59b24a(0x2b6)],'minimaxApiKey':_0x485e42[_0x59b24a(0x6ce)],'minimaxModel':_0x485e42[_0x59b24a(0x32e)]},await _0xa62efb[_0x59b24a(0x80d)]['put'](_0x53d851['apiConfig']),_0x17e058(),document[_0x59b24a(0x53a)](_0x59b24a(0xc3e))[_0x59b24a(0xb2b)](),_0x485e42[_0x59b24a(0x11f4)]&&_0x485e42['secondaryApiKey']&&document[_0x59b24a(0x53a)](_0x59b24a(0x8c0))[_0x59b24a(0xb2b)](),alert(_0x59b24a(0x419)+_0x485e42['name']+'”'));}async function _0x20146a(){const _0x45b41b=_0x13d875,_0x25e57f=await _0x4f6537(_0x45b41b(0xf47),_0x45b41b(0xf12));if(!_0x25e57f||!_0x25e57f[_0x45b41b(0x13bc)]())return;const _0xdd4c5c={'name':_0x25e57f['trim'](),'proxyUrl':document[_0x45b41b(0x53a)]('proxy-url')['value']['trim'](),'apiKey':document[_0x45b41b(0x53a)](_0x45b41b(0x275))[_0x45b41b(0x11a2)][_0x45b41b(0x13bc)](),'model':document['getElementById'](_0x45b41b(0xe85))[_0x45b41b(0x11a2)],'secondaryProxyUrl':document[_0x45b41b(0x53a)](_0x45b41b(0xc7d))['value']['trim'](),'secondaryApiKey':document[_0x45b41b(0x53a)](_0x45b41b(0xd14))['value'][_0x45b41b(0x13bc)](),'secondaryModel':document[_0x45b41b(0x53a)](_0x45b41b(0x1219))[_0x45b41b(0x11a2)],'minimaxGroupId':document[_0x45b41b(0x53a)]('minimax-group-id')[_0x45b41b(0x11a2)][_0x45b41b(0x13bc)](),'minimaxApiKey':document['getElementById']('minimax-api-key')['value'][_0x45b41b(0x13bc)](),'minimaxModel':document['getElementById'](_0x45b41b(0x716))[_0x45b41b(0x11a2)]},_0x2f1a60=await _0xa62efb[_0x45b41b(0x142c)][_0x45b41b(0x57e)](_0x45b41b(0x234))[_0x45b41b(0x12f6)](_0xdd4c5c[_0x45b41b(0x234)])[_0x45b41b(0x7e6)]();if(_0x2f1a60){const _0x6ae5a1=await _0x355fc0(_0x45b41b(0x811),_0x45b41b(0x130b)+_0xdd4c5c[_0x45b41b(0x234)]+_0x45b41b(0x501),{'confirmButtonClass':_0x45b41b(0x264)});if(!_0x6ae5a1)return;_0xdd4c5c['id']=_0x2f1a60['id'];}await _0xa62efb[_0x45b41b(0x142c)][_0x45b41b(0x546)](_0xdd4c5c),await _0x2ba066(),alert(_0x45b41b(0xa00));}async function _0x1cdc5e(){const _0x483e74=_0x13d875,_0x314b62=document[_0x483e74(0x53a)]('api-preset-select'),_0x1ee5c2=parseInt(_0x314b62[_0x483e74(0x11a2)]);if(isNaN(_0x1ee5c2)){alert('请先从下拉框中选择一个要删除的预设。');return;}const _0x330491=await _0xa62efb[_0x483e74(0x142c)][_0x483e74(0x883)](_0x1ee5c2);if(!_0x330491)return;const _0x49b635=await _0x355fc0(_0x483e74(0x1163),_0x483e74(0x1267)+_0x330491[_0x483e74(0x234)]+_0x483e74(0x2ec),{'confirmButtonClass':_0x483e74(0x264)});_0x49b635&&(await _0xa62efb[_0x483e74(0x142c)]['delete'](_0x1ee5c2),await _0x2ba066(),alert(_0x483e74(0x30f)));}function _0x17e058(){const _0x563b59=_0x13d875;document[_0x563b59(0x53a)](_0x563b59(0xa64))[_0x563b59(0x11a2)]=_0x53d851[_0x563b59(0x80d)][_0x563b59(0x122e)]||'',document[_0x563b59(0x53a)]('api-key')['value']=_0x53d851[_0x563b59(0x80d)][_0x563b59(0xe95)]||'',document[_0x563b59(0x53a)](_0x563b59(0xc7d))[_0x563b59(0x11a2)]=_0x53d851[_0x563b59(0x80d)]['secondaryProxyUrl']||'',document[_0x563b59(0x53a)](_0x563b59(0xd14))['value']=_0x53d851[_0x563b59(0x80d)][_0x563b59(0x8ec)]||'',document[_0x563b59(0x53a)](_0x563b59(0x20c))['checked']=_0x53d851[_0x563b59(0x906)][_0x563b59(0x527)]||![],document[_0x563b59(0x53a)](_0x563b59(0x8e6))[_0x563b59(0x11a2)]=_0x53d851[_0x563b59(0x906)][_0x563b59(0xf27)]||0x3c,document[_0x563b59(0x53a)]('block-cooldown-input')['value']=_0x53d851[_0x563b59(0x906)][_0x563b59(0xbbe)]||0x1,document[_0x563b59(0x53a)](_0x563b59(0x83a))[_0x563b59(0x1077)]=_0x53d851[_0x563b59(0x906)][_0x563b59(0x128d)],document[_0x563b59(0x53a)](_0x563b59(0xe18))['value']=_0x53d851[_0x563b59(0x906)][_0x563b59(0xcfe)]||0x32,document['getElementById'](_0x563b59(0x10d2))[_0x563b59(0x11a2)]=_0x53d851[_0x563b59(0x906)][_0x563b59(0x8ea)]||0x1e;const _0x2c8489=document[_0x563b59(0x53a)]('api-temperature-slider'),_0x43e0ce=document['getElementById'](_0x563b59(0x1343)),_0x1b43ee=_0x53d851[_0x563b59(0x906)][_0x563b59(0xaf8)]||0.8;_0x2c8489[_0x563b59(0x11a2)]=_0x1b43ee,_0x43e0ce['textContent']=_0x1b43ee,document[_0x563b59(0x53a)](_0x563b59(0x657))[_0x563b59(0x11a2)]=_0x53d851[_0x563b59(0x80d)][_0x563b59(0x2b6)]||'',document['getElementById'](_0x563b59(0x1097))['value']=_0x53d851[_0x563b59(0x80d)][_0x563b59(0x6ce)]||'',document[_0x563b59(0x53a)](_0x563b59(0x716))['value']=_0x53d851[_0x563b59(0x80d)][_0x563b59(0x32e)]||'speech-01';const _0x549ffa=localStorage['getItem']('novelai-enabled')===_0x563b59(0x10cf),_0x5f4370=localStorage[_0x563b59(0xa14)](_0x563b59(0x835))||_0x563b59(0x479),_0x4b960e=localStorage['getItem'](_0x563b59(0x84e))||'';document['getElementById']('novelai-switch')[_0x563b59(0x1077)]=_0x549ffa,document[_0x563b59(0x53a)](_0x563b59(0x835))[_0x563b59(0x11a2)]=_0x5f4370,document[_0x563b59(0x53a)]('novelai-api-key')['value']=_0x4b960e,document[_0x563b59(0x53a)](_0x563b59(0xdd7))['style'][_0x563b59(0x11d9)]=_0x549ffa?'block':'none',_0x2ba066(),_0x4b0d3c();}window['renderApiSettingsProxy']=_0x17e058;async function _0x1f0548(){const _0x35f1c4=_0x13d875,_0x560cd9=document[_0x35f1c4(0x53a)](_0x35f1c4(0xc33));_0x560cd9[_0x35f1c4(0xaac)]='';const _0x1eb332=await _0xa62efb[_0x35f1c4(0x5b7)][_0x35f1c4(0xa73)]();if(_0x1eb332[_0x35f1c4(0x29d)]===0x0){_0x560cd9[_0x35f1c4(0xaac)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有创建任何NPC，<br>点击右上角“+”添加第一个吧！</p>';return;}_0x1eb332[_0x35f1c4(0xeaf)](_0x7fe459=>{const _0x1b73c2=_0x35f1c4,_0x2fd49f=document[_0x1b73c2(0xd67)](_0x1b73c2(0x1425));_0x2fd49f[_0x1b73c2(0x6de)]='chat-list-item',_0x2fd49f['dataset']['npcId']=_0x7fe459['id'],_0x2fd49f[_0x1b73c2(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x7fe459[_0x1b73c2(0x8cd)]||_0x434592)+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x7fe459[_0x1b73c2(0x234)]+_0x1b73c2(0x810)+_0x7fe459[_0x1b73c2(0x11fb)][_0x1b73c2(0xad6)](0x0,0x1e)+_0x1b73c2(0x110e),_0x2fd49f['addEventListener'](_0x1b73c2(0xb2b),()=>_0x25fd0e(_0x7fe459['id'])),_0x3146aa(_0x2fd49f,async()=>{await _0x59cdca(_0x7fe459['id']);}),_0x560cd9[_0x1b73c2(0x133d)](_0x2fd49f);});}async function _0x25fd0e(_0x57963a=null){const _0x4f35b3=_0x13d875;editingNpcId=_0x57963a;const _0xd787f=document[_0x4f35b3(0x53a)](_0x4f35b3(0x13b0)),_0x385d49=document[_0x4f35b3(0x53a)](_0x4f35b3(0x70d)),_0x70903a=document[_0x4f35b3(0x53a)](_0x4f35b3(0x8a6)),_0x4db8cf=document[_0x4f35b3(0x53a)]('npc-persona-input'),_0x419f39=document[_0x4f35b3(0x53a)](_0x4f35b3(0xc84)),_0x641da1=document['getElementById'](_0x4f35b3(0x55d)),_0xe0029=document[_0x4f35b3(0x53a)]('npc-background-activity-switch'),_0x1af53a=document[_0x4f35b3(0x53a)]('npc-action-cooldown-input');_0x641da1[_0x4f35b3(0xaac)]='',_0x641da1[_0x4f35b3(0xaac)]+=_0x4f35b3(0xc67)+(_0x53d851[_0x4f35b3(0xa74)]['nickname']||'我')+'\x20(用户)</label>',Object[_0x4f35b3(0x244)](_0x53d851[_0x4f35b3(0xaa3)])[_0x4f35b3(0x2dd)](_0x150896=>!_0x150896[_0x4f35b3(0x86e)])[_0x4f35b3(0xeaf)](_0x59c0cb=>{const _0x5773e2=_0x4f35b3;_0x641da1[_0x5773e2(0xaac)]+=_0x5773e2(0x4d5)+_0x59c0cb['id']+_0x5773e2(0x127a)+_0x59c0cb[_0x5773e2(0x234)]+_0x5773e2(0x21e);});if(_0x57963a){_0x385d49[_0x4f35b3(0x34a)]=_0x4f35b3(0x6f5);const _0x48e6ca=await _0xa62efb[_0x4f35b3(0x5b7)][_0x4f35b3(0x883)](_0x57963a);_0x48e6ca&&(_0x70903a[_0x4f35b3(0x11a2)]=_0x48e6ca['name'],_0x4db8cf[_0x4f35b3(0x11a2)]=_0x48e6ca['persona'],_0x419f39[_0x4f35b3(0x7ff)]=_0x48e6ca[_0x4f35b3(0x8cd)]||_0x434592,_0xe0029[_0x4f35b3(0x1077)]=_0x48e6ca[_0x4f35b3(0x527)]!==![],_0x1af53a[_0x4f35b3(0x11a2)]=_0x48e6ca[_0x4f35b3(0xdd0)]||0xf,_0x48e6ca[_0x4f35b3(0xa21)]&&Array['isArray'](_0x48e6ca[_0x4f35b3(0xa21)])&&_0x48e6ca['associatedWith'][_0x4f35b3(0xeaf)](_0x1fbb79=>{const _0x5f33ff=_0x4f35b3,_0x4687da=_0x641da1[_0x5f33ff(0x139c)](_0x5f33ff(0x54c)+_0x1fbb79+'\x22]');if(_0x4687da)_0x4687da[_0x5f33ff(0x1077)]=!![];}));}else{_0x385d49[_0x4f35b3(0x34a)]='添加\x20NPC',_0x70903a['value']='',_0x4db8cf[_0x4f35b3(0x11a2)]='',_0x419f39[_0x4f35b3(0x7ff)]=_0x434592,_0xe0029[_0x4f35b3(0x1077)]=!![],_0x1af53a[_0x4f35b3(0x11a2)]=0xf;const _0xb6fe03=_0x641da1[_0x4f35b3(0x139c)](_0x4f35b3(0x1127));if(_0xb6fe03)_0xb6fe03[_0x4f35b3(0x1077)]=!![];}_0xd787f[_0x4f35b3(0x1276)][_0x4f35b3(0xe13)]('visible');}async function _0x12aa15(){const _0x1864b2=_0x13d875,_0x55c533=document['getElementById'](_0x1864b2(0x8a6))[_0x1864b2(0x11a2)][_0x1864b2(0x13bc)](),_0x45a9c6=document[_0x1864b2(0x53a)](_0x1864b2(0x613))[_0x1864b2(0x11a2)][_0x1864b2(0x13bc)]();if(!_0x55c533||!_0x45a9c6){alert(_0x1864b2(0x333));return;}const _0x13df88=Array[_0x1864b2(0xd97)](document[_0x1864b2(0xc3d)](_0x1864b2(0x2c2)))[_0x1864b2(0xcb4)](_0x2c5c3d=>_0x2c5c3d[_0x1864b2(0x11a2)]),_0x255f80=document[_0x1864b2(0x53a)](_0x1864b2(0xc5e))['checked'],_0x32267e=parseInt(document[_0x1864b2(0x53a)](_0x1864b2(0xfef))[_0x1864b2(0x11a2)])||0xf,_0x7a46ee={'name':_0x55c533,'persona':_0x45a9c6,'avatar':document[_0x1864b2(0x53a)](_0x1864b2(0xc84))[_0x1864b2(0x7ff)],'associatedWith':_0x13df88,'enableBackgroundActivity':_0x255f80,'actionCooldownMinutes':_0x32267e};if(editingNpcId)await _0xa62efb[_0x1864b2(0x5b7)][_0x1864b2(0xc03)](editingNpcId,_0x7a46ee);else{const _0x125693=await _0xa62efb[_0x1864b2(0x5b7)][_0x1864b2(0xe13)](_0x7a46ee);if(_0x2f91e5&&_0x53d851[_0x1864b2(0x13be)]){const _0x452d12=_0x53d851[_0x1864b2(0xaa3)][_0x53d851[_0x1864b2(0x13be)]];_0x452d12['isGroup']&&(_0x452d12[_0x1864b2(0x3de)]['push']({'id':'npc_'+_0x125693,'originalName':_0x55c533,'groupNickname':_0x55c533,'persona':_0x45a9c6,'avatar':_0x7a46ee['avatar'],'isNpc':!![]}),await _0xa62efb[_0x1864b2(0xaa3)][_0x1864b2(0x546)](_0x452d12));}}document[_0x1864b2(0x53a)]('npc-editor-modal')[_0x1864b2(0x1276)]['remove'](_0x1864b2(0xaef)),_0x2f91e5?(_0x2f91e5=![],_0x447e82()):await _0x1f0548();}async function _0x59cdca(_0x329ecc){const _0x10c6dd=_0x13d875,_0x37dd7c=await _0xa62efb[_0x10c6dd(0x5b7)][_0x10c6dd(0x883)](_0x329ecc);if(!_0x37dd7c)return;const _0x2e3a11=await _0x355fc0(_0x10c6dd(0x910),_0x10c6dd(0x3f7)+_0x37dd7c[_0x10c6dd(0x234)]+'”\x20吗？',{'confirmButtonClass':_0x10c6dd(0x264)});_0x2e3a11&&(await _0xa62efb[_0x10c6dd(0x5b7)][_0x10c6dd(0x121e)](_0x329ecc),await _0x1f0548());}let _0x5c6332=0x0;function _0x2e6fc5(_0x37432d){const _0x412c92=_0x13d875,_0x593833=document['createElement'](_0x412c92(0x1425));return _0x593833[_0x412c92(0x6de)]=_0x412c92(0x28c),_0x593833['innerHTML']=_0x412c92(0xe93)+_0x37432d['name']+_0x412c92(0x5d7),_0x593833;}function _0x5778f5(_0x5414a3){const _0xac89ff=_0x13d875,_0x3ca14f=document[_0xac89ff(0x53a)](_0xac89ff(0xb82)),_0x51a22c=document[_0xac89ff(0x53a)](_0xac89ff(0x67b));if(_0x51a22c)_0x51a22c[_0xac89ff(0x2d4)]();const _0x140da0=_0x5c6332,_0x4b46b0=_0x5c6332+CHAT_LIST_RENDER_WINDOW,_0xdd6346=_0x5414a3[_0xac89ff(0x1340)](_0x140da0,_0x4b46b0),_0x4cb43d=document['createDocumentFragment']();let _0x3c2f25=_0x3ca14f[_0xac89ff(0x139c)](_0xac89ff(0xb91));_0xdd6346[_0xac89ff(0xeaf)](_0x54874b=>{const _0x109d1a=_0xac89ff;if(_0x54874b['type']===_0x109d1a(0x420)){const _0x1bad54=_0x2e6fc5(_0x54874b['group']);_0x4cb43d[_0x109d1a(0x133d)](_0x1bad54),_0x3c2f25=_0x1bad54[_0x109d1a(0x139c)](_0x109d1a(0xbea));}else{if(_0x54874b[_0x109d1a(0x919)]===_0x109d1a(0x1147)){const _0x3fe8cb=_0x20f385(_0x54874b[_0x109d1a(0x2d8)]);_0x3c2f25&&_0x54874b[_0x109d1a(0x2d8)][_0x109d1a(0x608)]?_0x3c2f25[_0x109d1a(0x133d)](_0x3fe8cb):(_0x4cb43d[_0x109d1a(0x133d)](_0x3fe8cb),_0x3c2f25=null);}}}),_0x3ca14f[_0xac89ff(0x133d)](_0x4cb43d),_0x5c6332+=_0xdd6346['length'],_0x5414a3['length']>_0x5c6332&&_0x48c688(_0x3ca14f,_0x5414a3),document['querySelectorAll'](_0xac89ff(0x6e2))[_0xac89ff(0xeaf)](_0x353813=>{const _0x5af87b=_0xac89ff,_0x2467bf=_0x353813[_0x5af87b(0x75a)](!![]);_0x353813[_0x5af87b(0x9e8)][_0x5af87b(0xa1d)](_0x2467bf,_0x353813),_0x2467bf[_0x5af87b(0x1086)]('click',()=>{const _0x5ddc09=_0x5af87b;_0x2467bf[_0x5ddc09(0x1276)]['toggle'](_0x5ddc09(0x1393)),_0x2467bf[_0x5ddc09(0x35b)][_0x5ddc09(0x1276)]['toggle'](_0x5ddc09(0x1393));});});}async function _0x5001a4(){const _0x27f2c6=_0x13d875,_0x37361c=document['getElementById']('chat-list');_0x37361c[_0x27f2c6(0xaac)]='';const _0x2d85dd=Object[_0x27f2c6(0x244)](_0x53d851[_0x27f2c6(0xaa3)])[_0x27f2c6(0xdb0)]((_0x2dd7f3,_0x50608d)=>{const _0x209394=_0x27f2c6,_0x2b7aab=(_0x50608d['isPinned']||![])-(_0x2dd7f3[_0x209394(0x4d4)]||![]);if(_0x2b7aab!==0x0)return _0x2b7aab;return(_0x50608d['history']['slice'](-0x1)[0x0]?.[_0x209394(0x827)]||0x0)-(_0x2dd7f3[_0x209394(0xe83)]['slice'](-0x1)[0x0]?.[_0x209394(0x827)]||0x0);}),_0x3dfb75=await _0xa62efb[_0x27f2c6(0x443)][_0x27f2c6(0xa73)]();if(_0x2d85dd[_0x27f2c6(0x29d)]===0x0){_0x37361c[_0x27f2c6(0xaac)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20或群组图标添加聊天</p>';return;}_0x3dfb75[_0x27f2c6(0xeaf)](_0x3ab6b6=>{const _0x5d0452=_0x27f2c6,_0x276503=_0x2d85dd['find'](_0x4dafeb=>_0x4dafeb[_0x5d0452(0x608)]===_0x3ab6b6['id']);_0x3ab6b6[_0x5d0452(0x616)]=_0x276503?_0x276503[_0x5d0452(0xe83)][_0x5d0452(0x1340)](-0x1)[0x0]?.[_0x5d0452(0x827)]||0x0:0x0;}),_0x3dfb75['sort']((_0x4df44f,_0x571a20)=>_0x571a20[_0x27f2c6(0x616)]-_0x4df44f['latestTimestamp']),_0x58da98=[];const _0x42b7d3=new Set();_0x2d85dd[_0x27f2c6(0xeaf)](_0x207ad8=>{const _0x5bd9e9=_0x27f2c6;_0x207ad8[_0x5bd9e9(0x4d4)]&&(_0x58da98[_0x5bd9e9(0x7dd)]({'type':_0x5bd9e9(0x1147),'chat':_0x207ad8}),_0x42b7d3['add'](_0x207ad8['id']));}),_0x3dfb75[_0x27f2c6(0xeaf)](_0xf1f6db=>{const _0x43d329=_0x27f2c6,_0x4f800a=_0x2d85dd[_0x43d329(0x2dd)](_0x445df2=>!_0x445df2[_0x43d329(0x4d4)]&&!_0x445df2['isGroup']&&_0x445df2[_0x43d329(0x608)]===_0xf1f6db['id']);_0x4f800a['length']>0x0&&(_0x58da98['push']({'type':'groupHeader','group':_0xf1f6db}),_0x4f800a[_0x43d329(0xeaf)](_0x238ae1=>{const _0x50bd09=_0x43d329;_0x58da98[_0x50bd09(0x7dd)]({'type':_0x50bd09(0x1147),'chat':_0x238ae1}),_0x42b7d3[_0x50bd09(0xe13)](_0x238ae1['id']);}));}),_0x2d85dd[_0x27f2c6(0xeaf)](_0x5b0ef6=>{const _0x29813f=_0x27f2c6;!_0x42b7d3[_0x29813f(0x11af)](_0x5b0ef6['id'])&&(_0x58da98[_0x29813f(0x7dd)]({'type':_0x29813f(0x1147),'chat':_0x5b0ef6}),_0x42b7d3[_0x29813f(0xe13)](_0x5b0ef6['id']));}),_0x5c6332=0x0,_0x5778f5();}function _0x2e6fc5(_0x54d1d4){const _0x27fca6=_0x13d875,_0x34f3f0=document['createElement'](_0x27fca6(0x1425));return _0x34f3f0[_0x27fca6(0x6de)]='chat-group-container',_0x34f3f0[_0x27fca6(0xaac)]=_0x27fca6(0x622)+_0x54d1d4[_0x27fca6(0x234)]+_0x27fca6(0x7f7),_0x34f3f0;}function _0x48c688(_0x29be56,_0x57d202){const _0x7c42ec=_0x13d875,_0x28fd6c=document['createElement'](_0x7c42ec(0x59e));_0x28fd6c['id']=_0x7c42ec(0x67b),_0x28fd6c['textContent']=_0x7c42ec(0x1181),_0x28fd6c['className']=_0x7c42ec(0x5bc),_0x28fd6c[_0x7c42ec(0x1086)](_0x7c42ec(0xb2b),()=>_0x5778f5(_0x57d202),{'once':!![]}),_0x29be56[_0x7c42ec(0x860)](_0x28fd6c);}function _0x5778f5(){const _0x4395e2=_0x13d875;if(_0x4ec6e0)return;const _0x5a6de5=document[_0x4395e2(0x53a)](_0x4395e2(0xb82)),_0x480ae6=document[_0x4395e2(0x53a)](_0x4395e2(0x411));if(!_0x5a6de5||!_0x480ae6)return;if(_0x5c6332>=_0x58da98['length'])return;_0x4ec6e0=!![];const _0x3531e8=_0x5c6332===0x0,_0x47a120=()=>{const _0x5a4bf9=_0x4395e2;_0x41b779(_0x5a6de5);const _0x3b6a47=_0x53d851[_0x5a4bf9(0x906)]['chatListRenderWindow']||0x1e,_0x2aa12e=_0x5c6332,_0x1de511=_0x5c6332+_0x3b6a47,_0x3493af=_0x58da98['slice'](_0x2aa12e,_0x1de511),_0x2240ee=document[_0x5a4bf9(0x619)]();let _0xd30da3=_0x5a6de5[_0x5a4bf9(0x139c)]('.chat-group-content:last-of-type');_0x3493af['forEach'](_0x3db9cb=>{const _0x19e871=_0x5a4bf9;if(_0x3db9cb[_0x19e871(0x919)]===_0x19e871(0x420)){const _0x3cbd3a=_0x2e6fc5(_0x3db9cb[_0x19e871(0x1048)]);_0x2240ee[_0x19e871(0x133d)](_0x3cbd3a),_0xd30da3=_0x3cbd3a['querySelector']('.chat-group-content');}else{if(_0x3db9cb[_0x19e871(0x919)]===_0x19e871(0x1147)){const _0x4b1693=_0x20f385(_0x3db9cb[_0x19e871(0x2d8)]);if(_0x3db9cb[_0x19e871(0x2d8)][_0x19e871(0x608)]&&_0xd30da3)_0xd30da3[_0x19e871(0x133d)](_0x4b1693);else{_0x2240ee['appendChild'](_0x4b1693);if(!_0x3db9cb['chat'][_0x19e871(0x608)])_0xd30da3=null;}}}}),_0x5a6de5[_0x5a4bf9(0x133d)](_0x2240ee),_0x5c6332+=_0x3493af[_0x5a4bf9(0x29d)],_0x5a6de5[_0x5a4bf9(0xc3d)](_0x5a4bf9(0x580))[_0x5a4bf9(0xeaf)](_0x323d50=>{const _0xf066f8=_0x5a4bf9;_0x323d50['dataset'][_0xf066f8(0x4fb)]=_0xf066f8(0x10cf),_0x323d50['addEventListener'](_0xf066f8(0xb2b),()=>{const _0x33af5d=_0xf066f8;_0x323d50[_0x33af5d(0x1276)][_0x33af5d(0x4d7)]('collapsed'),_0x323d50[_0x33af5d(0x35b)]['classList']['toggle'](_0x33af5d(0x1393));});}),_0x4ec6e0=![],_0x480ae6[_0x5a4bf9(0xaae)]<=_0x480ae6[_0x5a4bf9(0x252)]&&_0x5c6332<_0x58da98[_0x5a4bf9(0x29d)]&&_0x5778f5();};_0x3531e8?_0x47a120():(_0x1e432c(_0x5a6de5,_0x4395e2(0xee1)),setTimeout(_0x47a120,0x1f4));}function _0x20f385(_0x3f6bc9){const _0x2edd08=_0x13d875;try{const _0xeaa3b0=_0x3f6bc9[_0x2edd08(0xe83)]['filter'](_0x4cf6e3=>!_0x4cf6e3[_0x2edd08(0x1032)])[_0x2edd08(0x1340)](-0x1)[0x0]||{};let _0x339a16;if(!_0x3f6bc9[_0x2edd08(0x86e)]&&_0x3f6bc9[_0x2edd08(0x1333)]?.[_0x2edd08(0x12d3)]==='pending_user_approval')_0x339a16=_0x2edd08(0x2a1)+(_0x3f6bc9[_0x2edd08(0x1333)][_0x2edd08(0xc1c)]||'请求添加你为好友')+_0x2edd08(0xbec);else{if(!_0x3f6bc9[_0x2edd08(0x86e)]&&_0x3f6bc9[_0x2edd08(0x1333)]?.[_0x2edd08(0x12d3)]===_0x2edd08(0xfb8))_0x339a16=_0x2edd08(0xc5b);else{if(_0x3f6bc9[_0x2edd08(0x86e)]){if(_0xeaa3b0['type']===_0x2edd08(0x109b))_0x339a16=_0x2edd08(0x1132)+_0xeaa3b0[_0x2edd08(0x73e)];else{if(_0xeaa3b0[_0x2edd08(0x919)]===_0x2edd08(0x566))_0x339a16=_0x2edd08(0x6b4);else{if(_0xeaa3b0[_0x2edd08(0x919)]==='ai_image'||_0xeaa3b0['type']==='user_photo')_0x339a16='[照片]';else{if(_0xeaa3b0[_0x2edd08(0x919)]===_0x2edd08(0x64f))_0x339a16=_0x2edd08(0xc72);else{if(typeof _0xeaa3b0['content']===_0x2edd08(0xfc5)&&_0x19cec7[_0x2edd08(0x7f2)](_0xeaa3b0[_0x2edd08(0x73e)]))_0x339a16=_0xeaa3b0[_0x2edd08(0x75f)]?'[表情:\x20'+_0xeaa3b0['meaning']+']':'[表情]';else Array[_0x2edd08(0xb31)](_0xeaa3b0[_0x2edd08(0x73e)])?_0x339a16='[图片]':_0x339a16=String(_0xeaa3b0[_0x2edd08(0x73e)]||_0x2edd08(0x95d))[_0x2edd08(0xad6)](0x0,0x14);}}}}if(_0xeaa3b0[_0x2edd08(0xbee)]&&_0xeaa3b0[_0x2edd08(0x919)]!==_0x2edd08(0x109b)){const _0x48a16b=_0xf33fb2(_0x3f6bc9,_0xeaa3b0[_0x2edd08(0xbee)]);_0x339a16=_0x48a16b+':\x20'+_0x339a16;}}else{const _0x4aed09=_0x3f6bc9[_0x2edd08(0x12d3)]?.[_0x2edd08(0x2e6)]||'在线';_0x339a16='['+_0x4aed09+']';}}}const _0x32f77b=document[_0x2edd08(0xd67)](_0x2edd08(0x1425));_0x32f77b[_0x2edd08(0x6de)]=_0x2edd08(0x514),_0x32f77b['dataset'][_0x2edd08(0x1054)]=_0x3f6bc9['id'];_0x3f6bc9['isPinned']&&_0x32f77b[_0x2edd08(0x1276)]['add'](_0x2edd08(0xd01));const _0x34cd01=_0x3f6bc9[_0x2edd08(0x86e)]?_0x3f6bc9['settings'][_0x2edd08(0x629)]:_0x3f6bc9['settings']['aiAvatar'],_0x40511d=_0x3f6bc9['isGroup']?'':_0x3f6bc9[_0x2edd08(0x81e)]['aiAvatarFrame']||'';let _0x21b780;_0x40511d?_0x21b780=_0x2edd08(0x555)+(_0x34cd01||_0x5d06c0)+'\x22\x20class=\x22avatar-img\x22><img\x20src=\x22'+_0x40511d+_0x2edd08(0xdd5):_0x21b780=_0x2edd08(0x88b)+(_0x34cd01||_0x5d06c0)+_0x2edd08(0x8b5);const _0xe8dbc3=_0x40511d?_0x2edd08(0xf1b):'',_0x9952ab=_0x2edd08(0x131d)+_0xe8dbc3+'\x22>'+_0x21b780+_0x2edd08(0x864);_0x32f77b['innerHTML']=_0x2edd08(0x495)+_0x9952ab+_0x2edd08(0x11f3)+_0x3f6bc9['name']+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x3f6bc9['isGroup']?_0x2edd08(0xea3):'')+_0x2edd08(0x931)+(_0x3f6bc9[_0x2edd08(0x86e)]?_0x2edd08(0xdce):_0x2edd08(0x77c))+_0x2edd08(0x93f)+_0x339a16+_0x2edd08(0x1142);const _0x9e66e=_0x3f6bc9[_0x2edd08(0x8ce)]||0x0,_0x1eb28f=_0x32f77b[_0x2edd08(0x139c)](_0x2edd08(0x10aa));_0x9e66e>0x0?(_0x1eb28f[_0x2edd08(0x34a)]=_0x9e66e>0x63?_0x2edd08(0x116b):_0x9e66e,_0x1eb28f[_0x2edd08(0x1284)]['display']=_0x2edd08(0xb49)):_0x1eb28f[_0x2edd08(0x1284)]['display']='none';const _0x4e1c17=_0x32f77b[_0x2edd08(0x139c)](_0x2edd08(0x524));_0x4e1c17&&(_0x4e1c17[_0x2edd08(0x1284)]['cursor']=_0x2edd08(0xc28),_0x4e1c17[_0x2edd08(0x1086)]('dblclick',_0x4f9a1c=>{const _0x2a8826=_0x2edd08;_0x4f9a1c[_0x2a8826(0xecc)]();const _0x3723b4=_0x3f6bc9[_0x2a8826(0x86e)]?_0x3f6bc9[_0x2a8826(0x234)]:_0x3f6bc9[_0x2a8826(0x543)];_0x394622(_0x3f6bc9['id'],_0x3723b4);}));const _0x5a6579=_0x32f77b[_0x2edd08(0x139c)](_0x2edd08(0x4b5));return _0x5a6579&&_0x5a6579['addEventListener'](_0x2edd08(0xb2b),()=>_0x1e3a7c(_0x3f6bc9['id'])),_0x3146aa(_0x32f77b,async _0x547b37=>{const _0x3f0852=_0x2edd08,_0x4ebb68=await _0x39a025(_0x3f6bc9);switch(_0x4ebb68){case _0x3f0852(0x522):_0x3f6bc9[_0x3f0852(0x4d4)]=!_0x3f6bc9['isPinned'],await _0xa62efb[_0x3f0852(0xaa3)]['put'](_0x3f6bc9),_0x5001a4();break;case'delete':const _0x46f03b=await _0x355fc0('删除对话',_0x3f0852(0x1da)+_0x3f6bc9['name']+_0x3f0852(0xf5f),{'confirmButtonClass':_0x3f0852(0x264)});if(_0x46f03b){_0x2eebda[_0x3f0852(0x975)]&&_0x2eebda[_0x3f0852(0x13be)]===_0x3f6bc9['id']&&await _0x3b9a16(![]);delete _0x53d851[_0x3f0852(0xaa3)][_0x3f6bc9['id']];if(_0x53d851[_0x3f0852(0x13be)]===_0x3f6bc9['id'])_0x53d851[_0x3f0852(0x13be)]=null;await _0xa62efb[_0x3f0852(0xaa3)][_0x3f0852(0x121e)](_0x3f6bc9['id']),_0x5001a4();}break;default:break;}}),_0x32f77b;}catch(_0x11e604){return console[_0x2edd08(0x617)](_0x2edd08(0xfd3)+(_0x3f6bc9[_0x2edd08(0x234)]||'未知')+']\x20(ID:\x20'+_0x3f6bc9['id']+_0x2edd08(0xc39),_0x11e604),null;}}async function _0x60f53f(_0x222ed7){const _0x2052ec=_0x13d875;_0x189f4b(),_0x3db1bf();const _0x4d6e07=_0x53d851['chats'][_0x222ed7];if(!_0x4d6e07)return;_0x3c73fa();const _0x14ec5f=document[_0x2052ec(0x53a)]('chat-messages'),_0x58915c=document[_0x2052ec(0x53a)](_0x2052ec(0x1107)),_0x46f075=document[_0x2052ec(0x53a)]('chat-lock-overlay'),_0x37648d=document[_0x2052ec(0x53a)](_0x2052ec(0x964));_0x14ec5f['dataset'][_0x2052ec(0x1297)]=_0x4d6e07[_0x2052ec(0x81e)]['theme']||_0x2052ec(0xce2);const _0x5ef6b6=_0x4d6e07['settings'][_0x2052ec(0xd8d)]||0xd;_0x14ec5f[_0x2052ec(0x1284)][_0x2052ec(0x5ed)](_0x2052ec(0xb86),_0x5ef6b6+'px'),_0x378258(_0x4d6e07[_0x2052ec(0x81e)][_0x2052ec(0x123c)]||'','#chat-messages',_0x2052ec(0x265)),document[_0x2052ec(0x53a)](_0x2052ec(0xba3))[_0x2052ec(0x34a)]=_0x4d6e07[_0x2052ec(0x234)];const _0x2fc003=document[_0x2052ec(0x53a)](_0x2052ec(0x2a4)),_0x15d61d=_0x2fc003[_0x2052ec(0x139c)]('.status-text');_0x4d6e07[_0x2052ec(0x86e)]?(_0x2fc003[_0x2052ec(0x1284)][_0x2052ec(0x11d9)]=_0x2052ec(0xbf2),document[_0x2052ec(0x53a)](_0x2052ec(0x133f))[_0x2052ec(0x1284)][_0x2052ec(0x2b8)]='center'):(_0x2fc003[_0x2052ec(0x1284)]['display']=_0x2052ec(0x2f6),document[_0x2052ec(0x53a)](_0x2052ec(0x133f))[_0x2052ec(0x1284)][_0x2052ec(0x2b8)]=_0x2052ec(0x1128),_0x15d61d[_0x2052ec(0x34a)]=_0x4d6e07[_0x2052ec(0x12d3)]?.[_0x2052ec(0x2e6)]||'在线',_0x2fc003['classList'][_0x2052ec(0x4d7)](_0x2052ec(0x1138),_0x4d6e07[_0x2052ec(0x12d3)]?.[_0x2052ec(0x99f)]||![]));const _0x484759=document[_0x2052ec(0x53a)](_0x2052ec(0x10ba)),_0x57390a=_0x4d6e07[_0x2052ec(0x81e)][_0x2052ec(0x274)],_0x5c048e=_0x53d851['globalSettings'][_0x2052ec(0xbc0)],_0x183836=document['getElementById'](_0x2052ec(0xf87))[_0x2052ec(0x1276)]['contains'](_0x2052ec(0xfb9)),_0x34361b=_0x183836?_0x2052ec(0x8f6):'#f0f2f5';if(_0x57390a)_0x484759[_0x2052ec(0x1284)][_0x2052ec(0x2f2)]='url('+_0x57390a+')',_0x484759[_0x2052ec(0x1284)]['backgroundColor']=_0x2052ec(0xb80);else _0x5c048e?(_0x484759[_0x2052ec(0x1284)][_0x2052ec(0x2f2)]=_0x2052ec(0xf22)+_0x5c048e+')',_0x484759['style'][_0x2052ec(0x615)]=_0x2052ec(0xb80)):(_0x484759['style']['backgroundImage']='none',_0x484759[_0x2052ec(0x1284)]['backgroundColor']=_0x34361b);if(_0x4d6e07[_0x2052ec(0x4b4)])_0x58915c[_0x2052ec(0x1284)][_0x2052ec(0x11d9)]=_0x2052ec(0xbf2),_0x46f075[_0x2052ec(0x1284)][_0x2052ec(0x11d9)]='flex',_0x37648d[_0x2052ec(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>正在围观AI们的群聊...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22spectator-actions-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-reroll-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22重新生成上一轮对话\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-propel-btn\x22\x20class=\x22lock-action-btn\x22>🎬\x20推进剧情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-edit-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22导演剪辑室：编辑AI上一轮的响应\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20.24\x2012.24a6\x206\x200\x200\x200-8.49-8.49L5\x2010.5V19h8.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2216\x22\x20y1=\x228\x22\x20x2=\x222\x22\x20y2=\x2222\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2217.5\x22\x20y1=\x2215\x22\x20x2=\x229\x22\x20y2=\x2215\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document[_0x2052ec(0x53a)](_0x2052ec(0xb5f))[_0x2052ec(0x12f2)]=_0x2ef220;else{_0x58915c[_0x2052ec(0x1284)]['display']='flex',_0x46f075[_0x2052ec(0x1284)][_0x2052ec(0x11d9)]=_0x2052ec(0xbf2),_0x37648d[_0x2052ec(0xaac)]='';if(!_0x4d6e07[_0x2052ec(0x86e)]&&_0x4d6e07[_0x2052ec(0x1333)][_0x2052ec(0x12d3)]!=='friend'){_0x46f075['style']['display']=_0x2052ec(0x2f6),_0x58915c['style'][_0x2052ec(0x2da)]='hidden';let _0x38412e='';switch(_0x4d6e07[_0x2052ec(0x1333)][_0x2052ec(0x12d3)]){case _0x2052ec(0x133c):const _0x33482b=_0x70fcd!==null,_0xade17e=_0x4d6e07[_0x2052ec(0x1333)]['blockedTimestamp'],_0x565c37=_0x53d851[_0x2052ec(0x906)][_0x2052ec(0xbbe)]||0x1,_0xf8ea57=_0x565c37*0x3c*0x3c*0x3e8,_0x28415b=Date[_0x2052ec(0x9c1)]()-_0xade17e,_0x51b688=_0x28415b>_0xf8ea57,_0xae9f04=Math[_0x2052ec(0x69b)](0x0,Math[_0x2052ec(0x856)]((_0xf8ea57-_0x28415b)/(0x3e8*0x3c)));_0x38412e='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你已将“'+_0x4d6e07[_0x2052ec(0x234)]+_0x2052ec(0x1249)+(_0x53d851[_0x2052ec(0x906)][_0x2052ec(0x527)]?_0x2052ec(0xba1):_0x2052ec(0x9cf))+_0x2052ec(0x1405)+(_0x33482b?_0x2052ec(0x663):_0x2052ec(0x48d))+_0x2052ec(0x140a)+_0x4d6e07[_0x2052ec(0x1333)]['status']+_0x2052ec(0xa3d)+_0x565c37+_0x2052ec(0x1049)+(_0x51b688?_0x2052ec(0x11b6):_0x2052ec(0x262)+_0xae9f04+_0x2052ec(0x37a))+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20触发条件:\x20'+(_0x51b688&&_0x53d851['globalSettings'][_0x2052ec(0x527)]?_0x2052ec(0x10e6):'<span\x20style=\x22color:\x20red;\x22>未满足</span>')+_0x2052ec(0x13fe);break;case _0x2052ec(0xfb8):_0x38412e=_0x2052ec(0x1394);break;case _0x2052ec(0x1382):_0x38412e=_0x2052ec(0x118b)+_0x4d6e07[_0x2052ec(0x234)]+_0x2052ec(0x12cb)+_0x4d6e07[_0x2052ec(0x1333)][_0x2052ec(0xc1c)]+_0x2052ec(0x6d8);break;case _0x2052ec(0xf51):_0x38412e=_0x2052ec(0x745);break;}_0x37648d[_0x2052ec(0xaac)]=_0x38412e;}else _0x46f075[_0x2052ec(0x1284)]['display']=_0x2052ec(0xbf2),_0x58915c[_0x2052ec(0x1284)]['visibility']='visible';}_0x14ec5f[_0x2052ec(0xaac)]='';const _0x5a262e=_0x4d6e07[_0x2052ec(0xe83)];_0x1122e4=0x0;const _0x3e95d7=_0x53d851[_0x2052ec(0x906)]['chatRenderWindow']||0x32,_0x3f5569=_0x5a262e[_0x2052ec(0x1340)](-_0x3e95d7),_0x9143c7=[];let _0x17e31e=0x0;for(const _0x55b983 of _0x3f5569){_0x17e31e>0x0&&_0x55b983[_0x2052ec(0x827)]-_0x17e31e>0x927c0&&_0x9143c7['push'](Promise[_0x2052ec(0x60e)](_0x162b3f(_0x55b983[_0x2052ec(0x827)]))),_0x9143c7['push'](_0x36bd8d(_0x55b983,_0x4d6e07,!![])),_0x17e31e=_0x55b983[_0x2052ec(0x827)];}const _0x16ae6e=await Promise[_0x2052ec(0x63d)](_0x9143c7),_0x4fbf1c=document[_0x2052ec(0x619)]();_0x16ae6e['filter'](Boolean)[_0x2052ec(0xeaf)](_0x24b471=>_0x4fbf1c[_0x2052ec(0x133d)](_0x24b471)),_0x14ec5f[_0x2052ec(0x133d)](_0x4fbf1c),_0x1122e4=_0x3f5569[_0x2052ec(0x29d)];const _0x4aa16d=document[_0x2052ec(0xd67)]('div');_0x4aa16d['id']='typing-indicator',_0x4aa16d[_0x2052ec(0x1284)][_0x2052ec(0x11d9)]='none',_0x4aa16d[_0x2052ec(0x34a)]=_0x2052ec(0xe41),_0x14ec5f['appendChild'](_0x4aa16d),setTimeout(()=>_0x14ec5f['scrollTop']=_0x14ec5f[_0x2052ec(0xaae)],0x0);}async function _0xe8662(){const _0x496b3b=_0x13d875;if(_0x1df085)return;_0x1df085=!![];const _0x13e537=document[_0x496b3b(0x53a)](_0x496b3b(0xa33)),_0x141cfb=_0x53d851['chats'][_0x53d851[_0x496b3b(0x13be)]];if(!_0x141cfb){_0x1df085=![];return;}_0x1e432c(_0x13e537,'top');const _0x3d4624=_0x13e537[_0x496b3b(0xaae)];await new Promise(_0x12ea9d=>setTimeout(_0x12ea9d,0x1f4));const _0x59e663=_0x141cfb[_0x496b3b(0xe83)][_0x496b3b(0x29d)],_0x219270=_0x53d851[_0x496b3b(0x906)][_0x496b3b(0xcfe)]||0x32,_0xf4ddd6=_0x59e663-_0x1122e4-_0x219270,_0x3fb247=_0x59e663-_0x1122e4,_0x1d6ce5=_0x141cfb[_0x496b3b(0xe83)][_0x496b3b(0x1340)](Math['max'](0x0,_0xf4ddd6),_0x3fb247),_0x595e61=_0x13e537[_0x496b3b(0x139c)](_0x496b3b(0x11cf));let _0xc86ec0=_0x595e61?parseInt(_0x595e61[_0x496b3b(0x999)][_0x496b3b(0x827)]):0x0;for(const _0x110a0b of _0x1d6ce5[_0x496b3b(0x843)]()){if(_0xc86ec0>0x0&&_0xc86ec0-_0x110a0b[_0x496b3b(0x827)]>0x927c0){const _0x388143=_0x162b3f(_0xc86ec0);_0x13e537[_0x496b3b(0x860)](_0x388143);}await _0x4fc3c0(_0x110a0b,_0x141cfb),_0xc86ec0=_0x110a0b[_0x496b3b(0x827)];}_0x1122e4+=_0x1d6ce5[_0x496b3b(0x29d)];const _0x335305=_0x13e537['scrollHeight'];_0x13e537[_0x496b3b(0xf68)]=_0x335305-_0x3d4624,_0x41b779(_0x13e537),_0x1df085=![];}function _0x24b0a8(){const _0x3f727c=_0x13d875;_0x2e2a39(),_0x5614ad();const _0x3aeea9=document[_0x3f727c(0x53a)]('wallpaper-preview'),_0x896840=_0x53d851[_0x3f727c(0x906)][_0x3f727c(0x8ee)];_0x896840?(_0x3aeea9[_0x3f727c(0x1284)][_0x3f727c(0x2f2)]=_0x3f727c(0xf22)+_0x896840+')',_0x3aeea9[_0x3f727c(0x34a)]=''):(_0x3aeea9[_0x3f727c(0x1284)]['backgroundImage']='linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)',_0x3aeea9['textContent']='当前为渐变色');const _0x1f29a9=document[_0x3f727c(0x53a)](_0x3f727c(0x13ff)),_0x59bb12=_0x53d851[_0x3f727c(0x906)]['cphoneWallpaper'];_0x59bb12?(_0x1f29a9['style']['backgroundImage']='url('+_0x59bb12+')',_0x1f29a9[_0x3f727c(0x34a)]=''):(_0x1f29a9[_0x3f727c(0x1284)][_0x3f727c(0x2f2)]=_0x3f727c(0xcc7),_0x1f29a9[_0x3f727c(0x34a)]='当前为渐变色');const _0x4b0221=document[_0x3f727c(0x53a)]('global-bg-preview'),_0x13a6fa=_0x53d851[_0x3f727c(0x906)][_0x3f727c(0xbc0)];_0x13a6fa?(_0x4b0221[_0x3f727c(0x1284)][_0x3f727c(0x2f2)]=_0x3f727c(0xf22)+_0x13a6fa+')',_0x4b0221['textContent']='',document[_0x3f727c(0x53a)]('remove-global-bg-btn')[_0x3f727c(0x1284)][_0x3f727c(0x11d9)]=_0x3f727c(0xbeb)):(_0x4b0221[_0x3f727c(0x1284)][_0x3f727c(0x2f2)]=_0x3f727c(0xbf2),_0x4b0221[_0x3f727c(0x34a)]='点击下方上传',document[_0x3f727c(0x53a)](_0x3f727c(0xa3a))[_0x3f727c(0x1284)][_0x3f727c(0x11d9)]='none'),_0x4fe752(),_0x16c8db(),document[_0x3f727c(0x53a)]('global-css-input')['value']=_0x53d851['globalSettings']['globalCss']||'',document['getElementById']('notification-sound-url-input')[_0x3f727c(0x11a2)]=_0x53d851['globalSettings'][_0x3f727c(0x1159)]||'',document[_0x3f727c(0x53a)](_0x3f727c(0xcb5))['checked']=_0x53d851[_0x3f727c(0x906)][_0x3f727c(0xab5)]||![],_0x18bc71(),_0x55fda7();}window[_0x13d875(0xaab)]=_0x24b0a8;function _0x1ce9d9(){const _0x1de3da=_0x13d875,_0x67804d=document[_0x1de3da(0x53a)]('home-screen'),_0xa9590e=_0x53d851[_0x1de3da(0x906)][_0x1de3da(0x8ee)];_0xa9590e?_0x67804d[_0x1de3da(0x1284)][_0x1de3da(0x2f2)]=_0x1de3da(0xf22)+_0xa9590e+')':_0x67804d[_0x1de3da(0x1284)][_0x1de3da(0x2f2)]=_0x1de3da(0x1275);}function _0x1bfd1f(_0x12cd35){const _0x4da9d7=_0x13d875;document[_0x4da9d7(0xc3d)](_0x4da9d7(0x37c))['forEach'](_0x4369b9=>{const _0x327191=_0x4da9d7;_0x4369b9[_0x327191(0x1276)][_0x327191(0x4d7)](_0x327191(0xdf6),_0x4369b9[_0x327191(0x999)][_0x327191(0xbcd)]===_0x12cd35);}),document[_0x4da9d7(0xc3d)](_0x4da9d7(0x136e))[_0x4da9d7(0xeaf)](_0x255ae2=>{const _0x55e17d=_0x4da9d7;_0x255ae2[_0x55e17d(0x1276)][_0x55e17d(0x4d7)](_0x55e17d(0xdf6),_0x255ae2[_0x55e17d(0x999)][_0x55e17d(0xbcd)]===_0x12cd35);});}async function _0x1f59bd(){const _0x2bf08e=_0x13d875,_0x3d35d8=document[_0x2bf08e(0x53a)](_0x2bf08e(0x10a2)),_0x16c472=document['getElementById'](_0x2bf08e(0xcd8));_0x3d35d8[_0x2bf08e(0xaac)]='',_0x16c472[_0x2bf08e(0xaac)]='';const [_0x6637ee,_0xd75976]=await Promise[_0x2bf08e(0x63d)]([_0xa62efb[_0x2bf08e(0x10f2)][_0x2bf08e(0xa73)](),_0xa62efb[_0x2bf08e(0xf5d)][_0x2bf08e(0x1064)](_0x2bf08e(0x234))[_0x2bf08e(0xa73)]()]);_0x53d851['worldBooks']=_0x6637ee;if(_0x6637ee['length']===0x0){_0x16c472[_0x2bf08e(0xaac)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一本世界书</p>';return;}const _0x221f1b=document['createElement'](_0x2bf08e(0x59e));_0x221f1b['className']=_0x2bf08e(0x3f9),_0x221f1b[_0x2bf08e(0x34a)]='全部',_0x221f1b[_0x2bf08e(0x999)][_0x2bf08e(0xbcd)]='all',_0x3d35d8[_0x2bf08e(0x133d)](_0x221f1b);const _0xeabca0=document[_0x2bf08e(0xd67)](_0x2bf08e(0x1425));_0xeabca0['className']='world-book-category-pane\x20active',_0xeabca0['dataset'][_0x2bf08e(0xbcd)]=_0x2bf08e(0x63d),_0x16c472[_0x2bf08e(0x133d)](_0xeabca0),_0xd75976[_0x2bf08e(0xeaf)](_0x2e02b3=>{const _0x260014=_0x2bf08e,_0xac60d4=document[_0x260014(0xd67)]('button');_0xac60d4[_0x260014(0x6de)]=_0x260014(0xc07),_0xac60d4[_0x260014(0x34a)]=_0x2e02b3['name'],_0xac60d4['dataset'][_0x260014(0xbcd)]=String(_0x2e02b3['id']),_0x3d35d8['appendChild'](_0xac60d4);const _0x3720a9=document[_0x260014(0xd67)](_0x260014(0x1425));_0x3720a9[_0x260014(0x6de)]=_0x260014(0xf86),_0x3720a9['dataset']['categoryId']=String(_0x2e02b3['id']),_0x16c472[_0x260014(0x133d)](_0x3720a9);});const _0x7a1350=_0x6637ee[_0x2bf08e(0xe0f)](_0x3656f8=>!_0x3656f8['categoryId']);if(_0x7a1350){const _0x47e43b=document[_0x2bf08e(0xd67)](_0x2bf08e(0x59e));_0x47e43b['className']='world-book-tab',_0x47e43b[_0x2bf08e(0x34a)]='未分类',_0x47e43b['dataset'][_0x2bf08e(0xbcd)]=_0x2bf08e(0x414),_0x3d35d8['appendChild'](_0x47e43b);const _0x58534a=document[_0x2bf08e(0xd67)]('div');_0x58534a[_0x2bf08e(0x6de)]='world-book-category-pane',_0x58534a['dataset']['categoryId']=_0x2bf08e(0x414),_0x16c472[_0x2bf08e(0x133d)](_0x58534a);}_0x6637ee['forEach'](_0x2fd96a=>{const _0x556f40=_0x2bf08e;let _0x36bdc8='暂无内容...';if(Array[_0x556f40(0xb31)](_0x2fd96a[_0x556f40(0x73e)])&&_0x2fd96a['content'][_0x556f40(0x29d)]>0x0){const _0x2ca5c0=_0x2fd96a[_0x556f40(0x73e)][0x0];_0x36bdc8=_0x2ca5c0[_0x556f40(0x1445)]||_0x2ca5c0[_0x556f40(0x73e)]||'';}else typeof _0x2fd96a[_0x556f40(0x73e)]==='string'&&_0x2fd96a[_0x556f40(0x73e)][_0x556f40(0x13bc)]()!==''&&(_0x36bdc8=_0x2fd96a[_0x556f40(0x73e)]);const _0x112c8e=document[_0x556f40(0xd67)](_0x556f40(0x1425));_0x112c8e[_0x556f40(0x6de)]=_0x556f40(0x575),_0x112c8e[_0x556f40(0xaac)]=_0x556f40(0x139f)+_0x2fd96a[_0x556f40(0x234)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>'+_0x36bdc8+_0x556f40(0x30c);const _0x257ee6=()=>_0x313d23(_0x2fd96a['id']),_0xf713b6=async()=>{const _0x2eab38=_0x556f40,_0x4c83ec=await _0x355fc0(_0x2eab38(0xf9f),_0x2eab38(0xafb)+_0x2fd96a[_0x2eab38(0x234)]+_0x2eab38(0x1452),{'confirmButtonClass':_0x2eab38(0x264)});_0x4c83ec&&(await _0xa62efb[_0x2eab38(0x10f2)][_0x2eab38(0x121e)](_0x2fd96a['id']),_0x53d851[_0x2eab38(0x10f2)]=_0x53d851[_0x2eab38(0x10f2)][_0x2eab38(0x2dd)](_0x13dcc8=>_0x13dcc8['id']!==_0x2fd96a['id']),_0x1f59bd());};_0x112c8e['addEventListener']('click',_0x257ee6),_0x3146aa(_0x112c8e,_0xf713b6);const _0x3a8377=_0x112c8e['cloneNode'](!![]);_0x3a8377[_0x556f40(0x1086)](_0x556f40(0xb2b),_0x257ee6),_0x3146aa(_0x3a8377,_0xf713b6),_0xeabca0[_0x556f40(0x133d)](_0x3a8377);const _0x2746fa=_0x2fd96a[_0x556f40(0xbcd)]?String(_0x2fd96a[_0x556f40(0xbcd)]):_0x556f40(0x414),_0xb61dc2=_0x16c472[_0x556f40(0x139c)](_0x556f40(0xe38)+_0x2746fa+'\x22]');_0xb61dc2&&_0xb61dc2['appendChild'](_0x112c8e);}),document[_0x2bf08e(0xc3d)]('.world-book-tab')[_0x2bf08e(0xeaf)](_0x29c68f=>{const _0x18d2f0=_0x2bf08e;_0x29c68f[_0x18d2f0(0x1086)](_0x18d2f0(0xb2b),()=>_0x1bfd1f(_0x29c68f[_0x18d2f0(0x999)][_0x18d2f0(0xbcd)]));});}function _0x568b86(_0x5c759c,_0x49ce67){const _0x1c3782=_0x13d875,_0x241f78=document[_0x1c3782(0xd67)](_0x1c3782(0x1425));_0x241f78[_0x1c3782(0x6de)]=_0x1c3782(0xca1),_0x241f78['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x5c759c+_0x1c3782(0xfa6);const _0x199a47=_0x241f78[_0x1c3782(0x139c)](_0x1c3782(0x5b2));return _0x49ce67['sort']((_0x4901c5,_0x480262)=>_0x4901c5[_0x1c3782(0x234)][_0x1c3782(0x81c)](_0x480262[_0x1c3782(0x234)],_0x1c3782(0x42f))),_0x49ce67['forEach'](_0x45113d=>{const _0x126083=_0x1c3782;let _0x1193f2=_0x126083(0x1444);if(Array[_0x126083(0xb31)](_0x45113d[_0x126083(0x73e)])&&_0x45113d[_0x126083(0x73e)][_0x126083(0x29d)]>0x0){const _0x299aed=_0x45113d['content'][0x0];_0x1193f2=_0x299aed[_0x126083(0x1445)]||_0x299aed['content']||'';}else typeof _0x45113d[_0x126083(0x73e)]===_0x126083(0xfc5)&&_0x45113d['content'][_0x126083(0x13bc)]()!==''&&(_0x1193f2=_0x45113d[_0x126083(0x73e)]);const _0x4ed89d=document[_0x126083(0xd67)](_0x126083(0x1425));_0x4ed89d[_0x126083(0x6de)]=_0x126083(0x292),_0x4ed89d[_0x126083(0x999)]['bookId']=_0x45113d['id'],_0x4ed89d[_0x126083(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>'+_0x45113d['name']+_0x126083(0xd80)+String(_0x1193f2)['substring'](0x0,0x32)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4ed89d[_0x126083(0x1086)](_0x126083(0xb2b),()=>_0x313d23(_0x45113d['id'])),_0x3146aa(_0x4ed89d,async()=>{const _0x3f6bf8=_0x126083,_0x425b8d=await _0x355fc0('删除世界书','确定要删除《'+_0x45113d['name']+_0x3f6bf8(0x2f4),{'confirmButtonClass':_0x3f6bf8(0x264)});_0x425b8d&&(await _0xa62efb[_0x3f6bf8(0x10f2)][_0x3f6bf8(0x121e)](_0x45113d['id']),_0x53d851['worldBooks']=_0x53d851['worldBooks'][_0x3f6bf8(0x2dd)](_0x9029f8=>_0x9029f8['id']!==_0x45113d['id']),_0x1f59bd());}),_0x199a47[_0x126083(0x133d)](_0x4ed89d);}),_0x241f78;}window[_0x13d875(0x1308)]=_0x1f59bd;async function _0x313d23(_0x1c8e40){const _0x36dfdf=_0x13d875;_0x541a81(_0x36dfdf(0x9fc)),_0x1261d0=_0x1c8e40;const [_0x376ccb,_0x8f4d00]=await Promise[_0x36dfdf(0x63d)]([_0xa62efb[_0x36dfdf(0x10f2)][_0x36dfdf(0x883)](_0x1c8e40),_0xa62efb[_0x36dfdf(0xf5d)][_0x36dfdf(0xa73)]()]);if(!_0x376ccb){console[_0x36dfdf(0x617)]('尝试打开一个不存在的世界书，ID:',_0x1c8e40),_0x541a81(_0x36dfdf(0x3fa));return;}document[_0x36dfdf(0x53a)](_0x36dfdf(0x3ef))[_0x36dfdf(0x34a)]=_0x376ccb[_0x36dfdf(0x234)],document[_0x36dfdf(0x53a)](_0x36dfdf(0x395))[_0x36dfdf(0x11a2)]=_0x376ccb[_0x36dfdf(0x234)];const _0x1fb88e=document[_0x36dfdf(0x53a)](_0x36dfdf(0xe90));_0x1fb88e['innerHTML']=_0x36dfdf(0x5d8),_0x8f4d00[_0x36dfdf(0xeaf)](_0x127755=>{const _0x43ff6e=_0x36dfdf,_0x24b607=document[_0x43ff6e(0xd67)]('option');_0x24b607['value']=_0x127755['id'],_0x24b607[_0x43ff6e(0x34a)]=_0x127755[_0x43ff6e(0x234)];if(_0x376ccb['categoryId']===_0x127755['id'])_0x24b607[_0x43ff6e(0x1015)]=!![];_0x1fb88e['appendChild'](_0x24b607);});const _0x1a1447=document[_0x36dfdf(0x53a)](_0x36dfdf(0xf50));_0x1a1447[_0x36dfdf(0xaac)]='',Array['isArray'](_0x376ccb[_0x36dfdf(0x73e)])&&_0x376ccb[_0x36dfdf(0x73e)][_0x36dfdf(0x29d)]>0x0?_0x376ccb['content'][_0x36dfdf(0xeaf)](_0x18a6e2=>{const _0xdf201b=_0x3571ed(_0x18a6e2);_0x1a1447['appendChild'](_0xdf201b);}):_0x1a1447[_0x36dfdf(0xaac)]=_0x36dfdf(0xb54);}async function _0x590e2b(_0x3d17bb=!![]){const _0x3e2bcd=_0x13d875,_0x5003c0=document[_0x3e2bcd(0x53a)](_0x3e2bcd(0x8cb)),_0x358687=document[_0x3e2bcd(0x53a)](_0x3e2bcd(0x49b)),_0x1dc250=document[_0x3e2bcd(0x53a)](_0x3e2bcd(0x73b)),_0x3bab34=_0x1dc250[_0x3e2bcd(0x11a2)]['trim']()[_0x3e2bcd(0x12b5)]();if(_0x3d17bb){_0x358687[_0x3e2bcd(0xaac)]='';const _0x558800=await _0xa62efb[_0x3e2bcd(0xa9c)][_0x3e2bcd(0xa73)]();_0x358687[_0x3e2bcd(0xaac)]+='<button\x20class=\x22sticker-category-tab\x20'+(_0x2d0790==='all'?_0x3e2bcd(0xdf6):'')+_0x3e2bcd(0xa58),_0x558800[_0x3e2bcd(0xeaf)](_0x594339=>{const _0x97f344=_0x3e2bcd;_0x358687['innerHTML']+='<button\x20class=\x22sticker-category-tab\x20'+(_0x2d0790===_0x594339['id']?'active':'')+_0x97f344(0xf6f)+_0x594339['id']+'\x22>'+_0x594339[_0x97f344(0x234)]+_0x97f344(0x4f7);}),_0x358687['innerHTML']+=_0x3e2bcd(0xb8c)+(_0x2d0790===_0x3e2bcd(0x414)?_0x3e2bcd(0xdf6):'')+_0x3e2bcd(0x118a);}_0x5003c0[_0x3e2bcd(0xaac)]='';let _0x1ce717;if(_0x2d0790===_0x3e2bcd(0x63d))_0x1ce717=_0x53d851['userStickers'];else _0x2d0790===_0x3e2bcd(0x414)?_0x1ce717=_0x53d851[_0x3e2bcd(0xf8f)][_0x3e2bcd(0x2dd)](_0x2a4cc4=>!_0x2a4cc4[_0x3e2bcd(0xbcd)]):_0x1ce717=_0x53d851[_0x3e2bcd(0xf8f)]['filter'](_0x399618=>_0x399618[_0x3e2bcd(0xbcd)]===_0x2d0790);const _0x10d298=_0x3bab34?_0x1ce717[_0x3e2bcd(0x2dd)](_0x3b23=>_0x3b23[_0x3e2bcd(0x234)][_0x3e2bcd(0x12b5)]()[_0x3e2bcd(0x6e9)](_0x3bab34)):_0x1ce717;if(_0x10d298[_0x3e2bcd(0x29d)]===0x0){const _0x2d11b8=_0x3bab34?'找不到匹配的表情':'这个分类下还没有表情哦~';_0x5003c0[_0x3e2bcd(0xaac)]=_0x3e2bcd(0xa46)+_0x2d11b8+_0x3e2bcd(0x12e2);return;}_0x10d298[_0x3e2bcd(0xeaf)](_0x2dc6b2=>{const _0xa9cd45=_0x3e2bcd,_0x19213b=document[_0xa9cd45(0xd67)](_0xa9cd45(0x1425));_0x19213b[_0xa9cd45(0x6de)]=_0xa9cd45(0x73f),_0x19213b[_0xa9cd45(0x667)]=_0x2dc6b2['name'],_0x19213b[_0xa9cd45(0x999)][_0xa9cd45(0x8c2)]=_0x2dc6b2['id'],_0x19213b[_0xa9cd45(0xaac)]=_0xa9cd45(0x865)+_0x2dc6b2['url']+_0xa9cd45(0xa6b)+_0x2dc6b2[_0xa9cd45(0x234)]+_0xa9cd45(0x1378),_0x19213b[_0xa9cd45(0x1086)](_0xa9cd45(0xb2b),()=>{_0x4119d1?_0x2fe1bd(_0x19213b):_0x8e135b(_0x2dc6b2);});const _0x2e6920=document[_0xa9cd45(0xd67)]('div');_0x2e6920[_0xa9cd45(0x6de)]=_0xa9cd45(0x2e3),_0x2e6920['innerHTML']='&times;',_0x2e6920[_0xa9cd45(0x12f2)]=async _0xf90529=>{const _0x1c999f=_0xa9cd45;_0xf90529['stopPropagation']();const _0x5a1330=await _0x355fc0(_0x1c999f(0x8de),_0x1c999f(0x634)+_0x2dc6b2[_0x1c999f(0x234)]+_0x1c999f(0x1073),{'confirmButtonClass':_0x1c999f(0x264)});_0x5a1330&&(await _0xa62efb[_0x1c999f(0xf8f)][_0x1c999f(0x121e)](_0x2dc6b2['id']),_0x53d851[_0x1c999f(0xf8f)]=_0x53d851[_0x1c999f(0xf8f)][_0x1c999f(0x2dd)](_0x706c7d=>_0x706c7d['id']!==_0x2dc6b2['id']),_0x590e2b());},_0x19213b['appendChild'](_0x2e6920),_0x5003c0[_0xa9cd45(0x133d)](_0x19213b);});}let _0x4119d1=![],_0x4538dc=new Set();function _0x3e2c21(){const _0x427951=_0x13d875;_0x4119d1=!_0x4119d1;const _0x32ed5f=document[_0x427951(0x53a)](_0x427951(0x8cb)),_0x2b41ba=document['getElementById'](_0x427951(0x699)),_0x13f6a1=document['getElementById'](_0x427951(0x11f5)),_0x539dfe=document['getElementById'](_0x427951(0x1175));_0x32ed5f[_0x427951(0x1276)][_0x427951(0x4d7)]('management-mode',_0x4119d1),_0x4119d1?(_0x2b41ba[_0x427951(0x34a)]='完成',_0x13f6a1[_0x427951(0x1284)][_0x427951(0x11d9)]='flex',_0x4538dc[_0x427951(0xfcf)](),_0x539dfe['checked']=![],_0x5d7d5c()):(_0x2b41ba['textContent']='管理',_0x13f6a1[_0x427951(0x1284)]['display']=_0x427951(0xbf2),_0x32ed5f[_0x427951(0xc3d)]('.sticker-item.selected')[_0x427951(0xeaf)](_0x1eb628=>_0x1eb628[_0x427951(0x1276)][_0x427951(0x2d4)](_0x427951(0x1015))));}function _0xcdc8e3(){const _0x2c0910=_0x13d875,_0x2b3198=document['getElementById'](_0x2c0910(0x1175)),_0x12fd73=_0x2b3198[_0x2c0910(0x1077)];let _0x31bb77;if(_0x2d0790==='all')_0x31bb77=_0x53d851[_0x2c0910(0xf8f)];else _0x2d0790===_0x2c0910(0x414)?_0x31bb77=_0x53d851['userStickers'][_0x2c0910(0x2dd)](_0x326759=>!_0x326759[_0x2c0910(0xbcd)]):_0x31bb77=_0x53d851[_0x2c0910(0xf8f)]['filter'](_0x4358a9=>_0x4358a9[_0x2c0910(0xbcd)]===_0x2d0790);_0x31bb77[_0x2c0910(0xeaf)](_0x38ab2a=>{const _0x740903=_0x2c0910,_0x518ce4=_0x38ab2a['id'],_0x391052=document[_0x740903(0x139c)](_0x740903(0x8c1)+_0x518ce4+'\x22]');if(_0x12fd73){_0x4538dc['add'](_0x518ce4);if(_0x391052)_0x391052['classList'][_0x740903(0xe13)](_0x740903(0x1015));}else{_0x4538dc[_0x740903(0x121e)](_0x518ce4);if(_0x391052)_0x391052[_0x740903(0x1276)][_0x740903(0x2d4)]('selected');}}),_0x5d7d5c();}function _0x5d7d5c(){const _0x26ad92=_0x13d875,_0x550d87=document[_0x26ad92(0x53a)](_0x26ad92(0x13a4));_0x550d87[_0x26ad92(0x34a)]=_0x26ad92(0xf3c)+_0x4538dc[_0x26ad92(0x38e)]+')';}function _0x2fe1bd(_0x573dc3){const _0x29ac6d=_0x13d875;if(!_0x4119d1)return;const _0x16744a=_0x573dc3['dataset'][_0x29ac6d(0x8c2)];if(!_0x16744a)return;_0x573dc3[_0x29ac6d(0x1276)][_0x29ac6d(0x4d7)]('selected'),_0x4538dc['has'](_0x16744a)?_0x4538dc['delete'](_0x16744a):_0x4538dc[_0x29ac6d(0xe13)](_0x16744a),_0x5d7d5c();}async function _0x281be8(){const _0x47abad=_0x13d875;if(_0x4538dc[_0x47abad(0x38e)]===0x0)return;const _0x311606=await _0x355fc0(_0x47abad(0x69a),'确定要删除选中的\x20'+_0x4538dc[_0x47abad(0x38e)]+_0x47abad(0xcf7),{'confirmButtonClass':_0x47abad(0x264)});if(_0x311606){const _0x1bc077=[..._0x4538dc];await _0xa62efb[_0x47abad(0xf8f)][_0x47abad(0x12e5)](_0x1bc077),_0x53d851['userStickers']=_0x53d851[_0x47abad(0xf8f)][_0x47abad(0x2dd)](_0x9e954=>!_0x1bc077[_0x47abad(0x6e9)](_0x9e954['id'])),_0x3e2c21(),_0x590e2b(),await _0x184397(_0x47abad(0x134f),'选中的表情已成功删除。');}}async function _0x1845f6(){const _0x20a7b0=_0x13d875,_0x5615ab='请按照以下通用格式粘贴，一行一个：\x0a\x0a开心:\x20https://.../happy.gif\x0a哭泣:\x20https://.../cry.png\x0a\x0a',_0x4dc83e=await _0x4f6537(_0x20a7b0(0xd5c),_0x5615ab,'',_0x20a7b0(0x728));_0x4dc83e&&_0x4dc83e[_0x20a7b0(0x13bc)]()&&await _0x48323c(_0x4dc83e);}async function _0x48323c(_0xbbe3ef){const _0x466ec8=_0x13d875,_0x382624=_0xbbe3ef[_0x466ec8(0x13bc)]()[_0x466ec8(0x13e8)]('\x0a'),_0x520067=[],_0xefb432=_0x466ec8(0xa09);let _0x4fc818=0x0;const _0x16c10e=_0x2d0790!==_0x466ec8(0x63d)&&_0x2d0790!=='uncategorized'?_0x2d0790:null;for(const _0x2467d0 of _0x382624){const _0x2b683f=_0x2467d0[_0x466ec8(0x13bc)]();if(!_0x2b683f||_0x2b683f[_0x466ec8(0x6e9)]('填入'))continue;const _0x1ca36e=_0x2b683f['match'](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x1ca36e){const _0xfcc8b1=_0x1ca36e[0x1]['trim'](),_0x4b1c3c=_0x1ca36e[0x2][_0x466ec8(0x13bc)]();_0x520067['push']({'id':_0x466ec8(0x99e)+Date['now']()+Math['random'](),'name':_0xfcc8b1,'url':_0x4b1c3c,'categoryId':_0x16c10e});continue;}let _0x2cc031=null,_0x93ad0b=null;const _0xc1498f=_0x2b683f[_0x466ec8(0x1120)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0xc1498f)_0x2cc031=_0xc1498f[0x1],_0x93ad0b=_0xc1498f[0x2];else{const _0x1d87f5=_0x2b683f[_0x466ec8(0x13e8)](/\s+/);_0x1d87f5[_0x466ec8(0x29d)]>=0x2&&(_0x93ad0b=_0x1d87f5[_0x466ec8(0x51a)](),_0x2cc031=_0x1d87f5['join']('\x20'));}_0x2cc031&&_0x93ad0b&&_0x93ad0b[_0x466ec8(0x6e9)]('.')?_0x520067['push']({'id':_0x466ec8(0x99e)+Date[_0x466ec8(0x9c1)]()+Math[_0x466ec8(0xac4)](),'name':_0x2cc031,'url':_0xefb432+_0x93ad0b,'categoryId':_0x16c10e}):(_0x4fc818++,console[_0x466ec8(0xad0)](_0x466ec8(0x8d8),_0x2b683f));}_0x4fc818>0x0&&await _0x184397(_0x466ec8(0xe2a),'有\x20'+_0x4fc818+_0x466ec8(0x1093));if(_0x520067['length']>0x0)await _0xa62efb[_0x466ec8(0xf8f)][_0x466ec8(0x1386)](_0x520067),_0x53d851[_0x466ec8(0xf8f)][_0x466ec8(0x7dd)](..._0x520067),_0x590e2b(),await _0x184397(_0x466ec8(0x11c0),_0x466ec8(0x1364)+_0x520067[_0x466ec8(0x29d)]+_0x466ec8(0x560));else _0x4fc818===0x0&&alert(_0x466ec8(0xc4c));}function _0x74d5de(_0x31356e){const _0x2523e9=_0x13d875,_0x2734b5=_0x2523e9(0x3a9)+_0x31356e+'\x22]',_0x1099a6=document[_0x2523e9(0x139c)](_0x2734b5);_0x1099a6?(_0x1099a6[_0x2523e9(0xbe5)]({'behavior':'smooth','block':_0x2523e9(0x25d)}),_0x1099a6[_0x2523e9(0x1276)][_0x2523e9(0xe13)](_0x2523e9(0x610)),setTimeout(()=>{const _0x1ba23b=_0x2523e9;document[_0x1ba23b(0x53d)][_0x1ba23b(0x6a3)](_0x1099a6)&&_0x1099a6[_0x1ba23b(0x1276)][_0x1ba23b(0x2d4)](_0x1ba23b(0x610));},0x5dc)):alert(_0x2523e9(0x1397));}async function _0x36bd8d(_0x3abf4f,_0x26b0be){const _0x4ea655=_0x13d875;if(_0x3abf4f[_0x4ea655(0x919)]==='recalled_message'){const _0x1b2f06=document[_0x4ea655(0xd67)]('div');_0x1b2f06[_0x4ea655(0x6de)]=_0x4ea655(0xa87),_0x1b2f06[_0x4ea655(0x999)][_0x4ea655(0x827)]=_0x3abf4f['timestamp'];const _0x76f6a9=document[_0x4ea655(0xd67)](_0x4ea655(0x1425));return _0x76f6a9[_0x4ea655(0x6de)]=_0x4ea655(0x1246),_0x76f6a9['dataset'][_0x4ea655(0x827)]=_0x3abf4f[_0x4ea655(0x827)],_0x76f6a9[_0x4ea655(0x34a)]=_0x3abf4f['content'],_0x1b2f06[_0x4ea655(0x133d)](_0x76f6a9),_0x3146aa(_0x1b2f06,()=>_0x4833d4(_0x3abf4f[_0x4ea655(0x827)])),_0x1b2f06[_0x4ea655(0x1086)]('click',()=>{const _0x31113a=_0x4ea655;_0x375e24&&_0x272362(_0x3abf4f[_0x31113a(0x827)]);}),_0x1b2f06;}else{if(_0x3abf4f['type']==='post_deleted_notice'){const _0x58a303=document[_0x4ea655(0xd67)](_0x4ea655(0x1425));_0x58a303[_0x4ea655(0x6de)]=_0x4ea655(0xa87),_0x58a303[_0x4ea655(0x999)][_0x4ea655(0x827)]=_0x3abf4f[_0x4ea655(0x827)];const _0x568380=document[_0x4ea655(0xd67)](_0x4ea655(0x1425));return _0x568380[_0x4ea655(0x6de)]=_0x4ea655(0xfd4),_0x568380[_0x4ea655(0x999)][_0x4ea655(0xb09)]=_0x3abf4f['postId'],_0x568380[_0x4ea655(0x34a)]=_0x3abf4f[_0x4ea655(0x73e)],_0x58a303[_0x4ea655(0x133d)](_0x568380),_0x3146aa(_0x58a303,()=>_0x4833d4(_0x3abf4f[_0x4ea655(0x827)])),_0x58a303[_0x4ea655(0x1086)](_0x4ea655(0xb2b),()=>{const _0x1d9d71=_0x4ea655;_0x375e24&&_0x272362(_0x3abf4f[_0x1d9d71(0x827)]);}),_0x58a303;}}if(_0x3abf4f['isHidden'])return null;if(_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x109b)){const _0x2ee24c=document['createElement'](_0x4ea655(0x1425));_0x2ee24c[_0x4ea655(0x6de)]='message-wrapper\x20system-pat';const _0x38d990=document[_0x4ea655(0xd67)](_0x4ea655(0x1425));return _0x38d990[_0x4ea655(0x6de)]=_0x4ea655(0xfe9),_0x38d990[_0x4ea655(0x999)][_0x4ea655(0x827)]=_0x3abf4f[_0x4ea655(0x827)],_0x38d990[_0x4ea655(0x34a)]=_0x3abf4f[_0x4ea655(0x73e)],_0x2ee24c[_0x4ea655(0x133d)](_0x38d990),_0x3146aa(_0x2ee24c,()=>_0x4833d4(_0x3abf4f[_0x4ea655(0x827)])),_0x2ee24c[_0x4ea655(0x1086)](_0x4ea655(0xb2b),()=>{const _0x27b9fb=_0x4ea655;if(_0x375e24)_0x272362(_0x3abf4f[_0x27b9fb(0x827)]);}),_0x2ee24c;}const _0x3b81cc=_0x3abf4f[_0x4ea655(0xb4d)]==='user',_0x42886a=_0x26b0be[_0x4ea655(0x81e)][_0x4ea655(0x1303)]||'我',_0x45755d=document[_0x4ea655(0xd67)]('div');_0x45755d[_0x4ea655(0x6de)]=_0x4ea655(0x12b7)+(_0x3b81cc?_0x4ea655(0x10ae):'ai');if(_0x26b0be['isGroup']&&!_0x3b81cc){const _0x3926cc=_0x26b0be[_0x4ea655(0x3de)][_0x4ea655(0x397)](_0x3b2c1f=>_0x3b2c1f[_0x4ea655(0x543)]===_0x3abf4f[_0x4ea655(0xbee)]),_0x1fdd43=document[_0x4ea655(0xd67)](_0x4ea655(0x1425));_0x1fdd43[_0x4ea655(0x6de)]=_0x4ea655(0x10c8),_0x1fdd43['textContent']=_0x3926cc?_0x3926cc[_0x4ea655(0x12bc)]:_0x3abf4f[_0x4ea655(0xbee)]||'未知成员',_0x45755d[_0x4ea655(0x133d)](_0x1fdd43);}const _0x590015=document[_0x4ea655(0xd67)](_0x4ea655(0x1425));_0x590015['className']=_0x4ea655(0x127e)+(_0x3b81cc?_0x4ea655(0x10ae):'ai'),_0x590015[_0x4ea655(0x999)][_0x4ea655(0x827)]=_0x3abf4f['timestamp'];const _0x4854b1=document[_0x4ea655(0xd67)](_0x4ea655(0x5a3));_0x4854b1[_0x4ea655(0x6de)]='timestamp',_0x4854b1[_0x4ea655(0x34a)]=_0x41a5db(_0x3abf4f[_0x4ea655(0x827)]);let _0x501beb,_0x11a469='';if(_0x3b81cc)_0x501beb=_0x26b0be[_0x4ea655(0x81e)][_0x4ea655(0x971)]||(_0x26b0be['isGroup']?_0x132d11:_0x5d06c0),_0x11a469=_0x26b0be[_0x4ea655(0x81e)][_0x4ea655(0xf77)]||'';else{if(_0x26b0be['isGroup']){const _0x4ea520=_0x26b0be[_0x4ea655(0x3de)]['find'](_0x4f1181=>_0x4f1181['originalName']===_0x3abf4f[_0x4ea655(0xbee)]);if(_0x4ea520){const _0x539e46=_0x53d851[_0x4ea655(0xaa3)][_0x4ea520['id']];_0x501beb=_0x4ea520[_0x4ea655(0x8cd)]||(_0x539e46?_0x539e46['settings']['aiAvatar']:_0x434592),_0x11a469=_0x4ea520['avatarFrame']||(_0x539e46?_0x539e46[_0x4ea655(0x81e)][_0x4ea655(0x2bf)]:'');}else _0x501beb=_0x434592,_0x11a469='';}else _0x501beb=_0x26b0be['settings'][_0x4ea655(0x9e3)]||_0x5d06c0,_0x11a469=_0x26b0be[_0x4ea655(0x81e)][_0x4ea655(0x2bf)]||'';}let _0x1ab642;_0x11a469?_0x1ab642='<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22'+_0x501beb+_0x4ea655(0x1022)+_0x11a469+_0x4ea655(0xdd5):_0x1ab642='<img\x20src=\x22'+_0x501beb+_0x4ea655(0x8b5);const _0x49f40e=_0x11a469?'has-frame':'',_0x4c1ac0='<div\x20class=\x22avatar-group\x20'+_0x49f40e+'\x22>'+_0x1ab642+'</div>';let _0x4a7f8c,_0x40ee34='';if(_0x3abf4f[_0x4ea655(0x6a2)]){const _0x2432ee=_0xf33fb2(_0x26b0be,_0x3abf4f[_0x4ea655(0x6a2)]['senderName']),_0x435030=String(_0x3abf4f[_0x4ea655(0x6a2)][_0x4ea655(0x73e)]||'');_0x40ee34=_0x4ea655(0x1207)+_0x3abf4f[_0x4ea655(0x6a2)][_0x4ea655(0x827)]+_0x4ea655(0x1126)+_0x2432ee+_0x4ea655(0xae9)+_0x435030+_0x4ea655(0x7ab);}let _0x2671d2=_0x3abf4f[_0x4ea655(0x73e)];if(typeof _0x2671d2===_0x4ea655(0xfc5)&&_0x2671d2[_0x4ea655(0x13bc)]()[_0x4ea655(0x1200)]('<')&&_0x2671d2[_0x4ea655(0x13bc)]()[_0x4ea655(0xc31)]('>'))_0x4a7f8c=_0x2671d2,_0x590015['classList'][_0x4ea655(0xe13)](_0x4ea655(0xe98));else{if(_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x8c3)||_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x631)||_0x3abf4f['type']==='share_card'||_0x3abf4f[_0x4ea655(0x919)]==='location_share'||_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x2a5)||_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x1053)||_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x64f)||_0x3abf4f['type']===_0x4ea655(0x566)||_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x1206)||_0x3abf4f[_0x4ea655(0x919)]==='waimai_order'||_0x3abf4f['type']===_0x4ea655(0x10a0)||_0x3abf4f['type']===_0x4ea655(0xf2e)||_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x205)||_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x3d2)||_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x357)){if(_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x8c3)){const _0x13ea98=_0x3abf4f['content']||((_0x3abf4f[_0x4ea655(0x1266)]||'')+'\x20'+(_0x3abf4f[_0x4ea655(0xa60)]||''))[_0x4ea655(0x13bc)](),_0x44cd9c=/(「.*?」|“.*?”)/g,_0x1456cf=_0x13ea98[_0x4ea655(0x13e8)](_0x44cd9c)['filter'](_0x47116d=>_0x47116d);_0x4a7f8c=_0x1456cf['map'](_0x244618=>{const _0x131077=_0x4ea655;return _0x244618[_0x131077(0x1200)]('「')||_0x244618[_0x131077(0x1200)]('“')?'<span\x20class=\x22offline-dialogue\x22>'+_0x46c503(_0x244618)+_0x131077(0xbec):_0x131077(0x1448)+_0x46c503(_0x244618[_0x131077(0x13bc)]())[_0x131077(0x795)](/\n/g,'<br>')+'</span>';})[_0x4ea655(0x2c8)]('');}else{if(_0x3abf4f[_0x4ea655(0x919)]==='share_link')_0x590015[_0x4ea655(0x1276)][_0x4ea655(0xe13)](_0x4ea655(0x1372),_0x4ea655(0xcb2)),_0x4a7f8c=_0x4ea655(0x1014)+_0x3abf4f[_0x4ea655(0x827)]+'\x22><div\x20class=\x22title\x22>'+(_0x3abf4f['title']||'无标题')+_0x4ea655(0x39c)+(_0x3abf4f[_0x4ea655(0xa60)]||_0x4ea655(0x341))+_0x4ea655(0x116d)+(_0x3abf4f['source_name']||_0x4ea655(0xfd2))+'</span></div></div>';else{if(_0x3abf4f['type']===_0x4ea655(0xd32))_0x590015[_0x4ea655(0x1276)][_0x4ea655(0xe13)](_0x4ea655(0x1372),_0x4ea655(0xcb2)),_0x4a7f8c=_0x4ea655(0xf9d)+_0x3abf4f[_0x4ea655(0x827)]+'\x22><div\x20class=\x22title\x22>'+_0x3abf4f[_0x4ea655(0x6ac)][_0x4ea655(0x667)]+'</div><div\x20class=\x22description\x22>共\x20'+_0x3abf4f[_0x4ea655(0x6ac)][_0x4ea655(0xeed)][_0x4ea655(0x29d)]+_0x4ea655(0xf32);else{if(_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x68b)){_0x590015['classList'][_0x4ea655(0xe13)](_0x4ea655(0xade),_0x4ea655(0xcb2));let _0x242898;if(_0x3abf4f[_0x4ea655(0x97a)])_0x242898=_0x3abf4f[_0x4ea655(0x97a)];else _0x53d851[_0x4ea655(0x906)][_0x4ea655(0x128d)]&&_0x3abf4f[_0x4ea655(0xadb)]?_0x242898='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x3abf4f[_0x4ea655(0xadb)]):_0x242898=_0x4ea655(0xfe4);const _0x3fa6e3='style=\x22background-image:\x20url(\x27'+_0x242898+_0x4ea655(0xb94);_0x4a7f8c=_0x4ea655(0x233)+_0x3abf4f[_0x4ea655(0x73e)]+'</div><div\x20class=\x22card-text-secondary\x22>位置分享</div></div><div\x20class=\x22card-map-area\x22\x20'+_0x3fa6e3+_0x4ea655(0x899);}else{if(_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x1053)||_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x2a5)){_0x590015[_0x4ea655(0x1276)][_0x4ea655(0xe13)]('is-ai-image',_0x4ea655(0xcb2));const _0x301ae5=_0x3abf4f[_0x4ea655(0x919)]==='user_photo'?'用户描述的照片':_0x4ea655(0x1398),_0x564eb0=_0x53d851['globalSettings'][_0x4ea655(0x128d)]&&_0x3abf4f[_0x4ea655(0xadb)]?_0x4ea655(0x9ce)+_0x3abf4f['image_prompt']:_0x4ea655(0xbbd);_0x4a7f8c=_0x4ea655(0x88b)+_0x564eb0+_0x4ea655(0xdba)+_0x301ae5+'\x22\x20data-description=\x22'+_0x3abf4f['content']+'\x22>';}else{if(_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x357))_0x590015[_0x4ea655(0x1276)][_0x4ea655(0xe13)](_0x4ea655(0x5f1),_0x4ea655(0xcb2)),_0x4a7f8c=_0x4ea655(0x88b)+_0x3abf4f['imageUrl']+_0x4ea655(0x644)+(_0x3abf4f['fullPrompt']||_0x3abf4f[_0x4ea655(0x6d2)]||'NovelAI生成')+'\x22>';else{if(_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x64f)){_0x590015[_0x4ea655(0x1276)]['add'](_0x4ea655(0xaa9),'is-card-like');const _0x190c07=Math[_0x4ea655(0x69b)](0x1,Math['round']((_0x3abf4f['content']||'')[_0x4ea655(0x29d)]/0x5)),_0x3544cb='0:'+String(_0x190c07)[_0x4ea655(0x117e)](0x2,'0')+'\x27\x27',_0x1b470e=_0x4ea655(0x483);if(_0x3b81cc)_0x4a7f8c='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22'+encodeURIComponent(_0x3abf4f[_0x4ea655(0x73e)])+_0x4ea655(0xd5e)+_0x1b470e+_0x4ea655(0xb42)+_0x3544cb+_0x4ea655(0xdb9);else{const _0x32817e=!_0x26b0be[_0x4ea655(0x86e)]&&_0x26b0be['settings'][_0x4ea655(0x107c)]!==![],_0x339f35=_0x26b0be['settings'][_0x4ea655(0x1234)]||_0x4ea655(0x526),_0x3c36ec=_0x32817e?_0x4ea655(0x564)+_0x339f35+'\x22':'';_0x4a7f8c=_0x4ea655(0x56f)+encodeURIComponent(_0x3abf4f['content'])+'\x22\x20'+_0x3c36ec+_0x4ea655(0x37f)+_0x1b470e+_0x4ea655(0xfa0)+_0x3544cb+_0x4ea655(0xdb9);}}else{if(_0x3abf4f['type']===_0x4ea655(0x566)){_0x590015['classList'][_0x4ea655(0xe13)]('is-transfer','is-card-like');let _0x4c6cc7,_0x4d8b5b;const _0x22c162=_0x26b0be[_0x4ea655(0x86e)]?_0x26b0be[_0x4ea655(0x81e)]['myNickname']||'我':'我',_0x10566a=_0xf33fb2(_0x26b0be,_0x3abf4f['senderName']),_0x13bebf=_0xf33fb2(_0x26b0be,_0x3abf4f[_0x4ea655(0x44a)]||_0x26b0be[_0x4ea655(0x234)]);if(_0x3b81cc){if(_0x3abf4f[_0x4ea655(0xaa5)])_0x4c6cc7='退款给\x20'+_0x13bebf,_0x4d8b5b=_0x4ea655(0xce0);else{_0x4c6cc7=_0x4ea655(0xf6d)+_0x13bebf;if(_0x3abf4f[_0x4ea655(0x12d3)]===_0x4ea655(0x42c))_0x4d8b5b=_0x4ea655(0x12ee);else{if(_0x3abf4f[_0x4ea655(0x12d3)]==='declined')_0x4d8b5b=_0x4ea655(0x86c);else _0x4d8b5b=_0x3abf4f[_0x4ea655(0xbb0)]||_0x4ea655(0xfdd);}}}else{if(_0x3abf4f[_0x4ea655(0xaa5)])_0x4c6cc7=_0x4ea655(0x12f0)+_0x10566a,_0x4d8b5b='转账已被拒收';else{if(_0x3abf4f[_0x4ea655(0x44a)]===_0x22c162){_0x4c6cc7=_0x4ea655(0xf6d)+_0x22c162;if(_0x3abf4f[_0x4ea655(0x12d3)]===_0x4ea655(0x42c))_0x4d8b5b=_0x4ea655(0xad3);else{if(_0x3abf4f[_0x4ea655(0x12d3)]===_0x4ea655(0xe65))_0x4d8b5b=_0x4ea655(0xc45);else _0x590015[_0x4ea655(0x1284)][_0x4ea655(0x98c)]=_0x4ea655(0xc28),_0x590015[_0x4ea655(0x999)][_0x4ea655(0x12d3)]=_0x4ea655(0x43a),_0x4d8b5b=_0x3abf4f[_0x4ea655(0xbb0)]||_0x4ea655(0x256);}}else _0x4c6cc7=_0x4ea655(0x36c)+_0x10566a+_0x4ea655(0x2d9)+_0x13bebf,_0x4d8b5b=_0x3abf4f[_0x4ea655(0xbb0)]||_0x4ea655(0x1fd);}}const _0x4cd5b2=_0x4ea655(0x79c);_0x4a7f8c=_0x4ea655(0xf72)+_0x4cd5b2+'\x20'+_0x4c6cc7+_0x4ea655(0x539)+Number(_0x3abf4f[_0x4ea655(0x1146)])['toFixed'](0x2)+'</div><div\x20class=\x22transfer-note\x22>'+_0x4d8b5b+'</div></div>';}else{if(_0x3abf4f['type']===_0x4ea655(0x1206)){_0x590015[_0x4ea655(0x1276)][_0x4ea655(0xe13)]('is-waimai-request','is-card-like');if(_0x3abf4f[_0x4ea655(0x12d3)]===_0x4ea655(0x2ea)||_0x3abf4f[_0x4ea655(0x12d3)]==='rejected')_0x590015['classList']['add']('status-'+_0x3abf4f[_0x4ea655(0x12d3)]);const _0x30ee19=_0xf33fb2(_0x26b0be,_0x3abf4f[_0x4ea655(0xbee)]),_0x149745=_0x4ea655(0x422)+_0x30ee19+_0x4ea655(0x853);let _0x12d76c='';_0x3abf4f[_0x4ea655(0x12d3)]===_0x4ea655(0x43a)&&!_0x3b81cc&&(_0x12d76c='<div\x20class=\x22waimai-user-actions\x22><button\x20class=\x22waimai-decline-btn\x22\x20data-choice=\x22rejected\x22>残忍拒绝</button><button\x20class=\x22waimai-pay-btn\x22\x20data-choice=\x22paid\x22>为Ta买单</button></div>'),_0x4a7f8c=_0x4ea655(0xe4c)+_0x149745+'</div><div\x20class=\x22payment-box\x22><div\x20class=\x22payment-label\x22>需付款</div><div\x20class=\x22amount\x22>¥'+Number(_0x3abf4f[_0x4ea655(0x1146)])['toFixed'](0x2)+_0x4ea655(0x4ac)+_0x3abf4f[_0x4ea655(0x827)]+_0x4ea655(0xcec)+_0x12d76c+_0x4ea655(0x864),setTimeout(()=>{const _0x10daf3=_0x4ea655;if(_0x3abf4f[_0x10daf3(0x12d3)]===_0x10daf3(0x43a)){const _0x397955=document[_0x10daf3(0x53a)](_0x10daf3(0x601)+_0x3abf4f[_0x10daf3(0x827)]);if(_0x397955){const _0x470328=_0x52f4c8(_0x397955,_0x3abf4f[_0x10daf3(0x8a8)]);_0x3faa3e[_0x3abf4f[_0x10daf3(0x827)]]=_0x470328;}}},0x0);}else{if(_0x3abf4f['type']===_0x4ea655(0x907)){_0x590015[_0x4ea655(0x1276)][_0x4ea655(0xe13)](_0x4ea655(0x586),_0x4ea655(0xcb2));const _0x5350f5=_0xf33fb2(_0x26b0be,_0x3abf4f['senderName']);let _0x5eff92='你';_0x26b0be['isGroup']&&(_0x5eff92=_0xf33fb2(_0x26b0be,_0x3abf4f[_0x4ea655(0x283)])),_0x4a7f8c=_0x4ea655(0x9fe)+_0x5350f5+_0x4ea655(0xd35)+_0x5eff92+_0x4ea655(0x2f7)+_0x3abf4f[_0x4ea655(0x13ce)]+_0x4ea655(0xda0)+Number(_0x3abf4f[_0x4ea655(0x1146)])[_0x4ea655(0x39e)](0x2)+_0x4ea655(0x1337);}else{if(_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0x10a0)){_0x590015['classList'][_0x4ea655(0xe13)](_0x4ea655(0x9ac),_0x4ea655(0xcb2));const _0x549d20=_0x53d851[_0x4ea655(0xa74)][_0x4ea655(0x1005)]||_0x4ea655(0x8ac),_0x2061fc=_0x3abf4f[_0x4ea655(0x70f)],_0x35060b=_0x3abf4f[_0x4ea655(0x115a)]&&_0x3abf4f[_0x4ea655(0x115a)][_0x549d20];let _0xb52e2c='',_0x4e483e='',_0x27f1d9=_0x4ea655(0x1336);_0x2061fc&&(_0xb52e2c='opened');if(_0x3abf4f[_0x4ea655(0x67e)]===_0x4ea655(0x985)){const _0x960220=_0xf33fb2(_0x26b0be,_0x3abf4f[_0x4ea655(0x44a)]);_0x27f1d9='专属红包:\x20给\x20'+_0x960220;if(Object[_0x4ea655(0x1350)](_0x3abf4f[_0x4ea655(0x115a)]||{})['length']>0x0)_0xb52e2c=_0x4ea655(0x132c);}if(_0x35060b){const _0x3684bc=_0x3abf4f[_0x4ea655(0x115a)][_0x549d20]||0x0;_0x4e483e=_0x4ea655(0x1031)+_0x3684bc[_0x4ea655(0x39e)](0x2)+_0x4ea655(0xa6f);}else{if(_0x2061fc)_0x4e483e='<div\x20class=\x22rp-claimed-info\x22>红包已被领完</div>';else{if(_0x3abf4f[_0x4ea655(0x67e)]===_0x4ea655(0x985)&&Object[_0x4ea655(0x1350)](_0x3abf4f[_0x4ea655(0x115a)]||{})['length']>0x0){const _0x1ab8dc=_0xf33fb2(_0x26b0be,_0x3abf4f[_0x4ea655(0x44a)]);_0x4e483e='<div\x20class=\x22rp-claimed-info\x22>已被\x20'+_0x1ab8dc+_0x4ea655(0xf0f);}}}_0x4a7f8c=_0x4ea655(0xca5)+_0xb52e2c+_0x4ea655(0xf0c)+(_0x3abf4f[_0x4ea655(0xfa8)]||_0x4ea655(0xf49))+_0x4ea655(0x976)+_0x27f1d9+_0x4ea655(0x864)+_0x4e483e+_0x4ea655(0x864);}else{if(_0x3abf4f[_0x4ea655(0x919)]===_0x4ea655(0xf2e)){_0x590015[_0x4ea655(0x1276)]['add'](_0x4ea655(0xcb9),'is-card-like');const _0x311292=_0x3abf4f['question']||_0x3abf4f['content']||_0x4ea655(0xe45);let _0x160199=0x0;const _0x4b99d9={};for(const _0x1e31f7 in _0x3abf4f[_0x4ea655(0x771)]){const _0x13b404=_0x3abf4f[_0x4ea655(0x771)][_0x1e31f7][_0x4ea655(0x29d)];_0x4b99d9[_0x1e31f7]=_0x13b404,_0x160199+=_0x13b404;}const _0xd4f5f1=_0x53d851['qzoneSettings']['nickname']||_0x4ea655(0x8ac);let _0x2c4f35=null;for(const _0x38a27b in _0x3abf4f[_0x4ea655(0x771)]){if(_0x3abf4f[_0x4ea655(0x771)][_0x38a27b][_0x4ea655(0x6e9)](_0xd4f5f1)){_0x2c4f35=_0x38a27b;break;}}let _0x580cf8=_0x4ea655(0x12cd);_0x3abf4f['options'][_0x4ea655(0xeaf)](_0x4f0328=>{const _0x3ee73c=_0x4ea655,_0x395b57=_0x4b99d9[_0x4f0328]||0x0,_0x5ab5c1=_0x160199>0x0?_0x395b57/_0x160199*0x64:0x0,_0x43795c=_0x2c4f35===_0x4f0328;_0x580cf8+=_0x3ee73c(0x512)+(_0x43795c?_0x3ee73c(0xc5d):'')+_0x3ee73c(0x1f2)+_0x4f0328+_0x3ee73c(0x1319)+_0x5ab5c1+_0x3ee73c(0x9d1)+_0x4f0328+'</span><span\x20class=\x22poll-option-votes\x22>'+_0x395b57+_0x3ee73c(0x10fe);}),_0x580cf8+=_0x4ea655(0x864);let _0x5f4a1c=_0x3abf4f[_0x4ea655(0xb1f)]?_0x4ea655(0x20e)+_0x160199+_0x4ea655(0xc2a):_0x4ea655(0x20e)+_0x160199+_0x4ea655(0xa63);_0x4a7f8c=_0x4ea655(0x315)+(_0x3abf4f[_0x4ea655(0xb1f)]?_0x4ea655(0x409):'')+'\x22\x20data-poll-timestamp=\x22'+_0x3abf4f[_0x4ea655(0x827)]+_0x4ea655(0xb32)+_0x311292+'</div>'+_0x580cf8+_0x5f4a1c+_0x4ea655(0x864);}else{if(_0x3abf4f['type']==='gift'){_0x590015[_0x4ea655(0x1276)]['add']('is-gift',_0x4ea655(0xcb2));let _0x231801;const _0x58b282=_0x26b0be['settings']['myNickname']||'我';if(_0x26b0be[_0x4ea655(0x86e)]){if(_0x3abf4f[_0x4ea655(0x134c)]&&_0x3abf4f[_0x4ea655(0x134c)][_0x4ea655(0x29d)]>0x0){const _0x3af775=_0x3abf4f[_0x4ea655(0x134c)][_0x4ea655(0xcb4)](_0x51666c=>_0xf33fb2(_0x26b0be,_0x51666c));_0x3af775[_0x4ea655(0x29d)]===0x1?_0x231801='送给\x20'+_0x3af775[0x0]+_0x4ea655(0x4ec):_0x231801=_0x4ea655(0x101f)+_0x3af775['slice'](0x0,0x2)[_0x4ea655(0x2c8)]('、')+'等人的礼物';}else _0x231801='送给大家的礼物';}else{if(_0x3b81cc)_0x231801=_0x4ea655(0x101f)+_0x26b0be['name']+_0x4ea655(0x4ec);else{const _0x572b6f=_0x26b0be[_0x4ea655(0x81e)][_0x4ea655(0x1303)]||'你';_0x231801=_0x4ea655(0x101f)+_0x572b6f+_0x4ea655(0x4ec);}}const _0x50a4e1=_0x3abf4f[_0x4ea655(0xa27)]['slice'](0x0,0x3);let _0x54b74d='';_0x50a4e1['forEach'](_0x16a14d=>{const _0xa40242=_0x4ea655;_0x54b74d+=_0xa40242(0x32a)+_0x16a14d[_0xa40242(0x97a)]+'\x22\x20class=\x22gift-preview-img\x22><span\x20class=\x22gift-preview-name\x22>'+_0x16a14d[_0xa40242(0x234)]+'</span><span\x20class=\x22gift-preview-quantity\x22>x'+_0x16a14d[_0xa40242(0xc26)]+'</span></div>';});let _0x3e0777='';_0x3abf4f[_0x4ea655(0xa27)]['length']>0x3&&(_0x3e0777='\x20等'+_0x3abf4f[_0x4ea655(0xa27)][_0x4ea655(0x29d)]+_0x4ea655(0x12ff)),_0x4a7f8c='<div\x20class=\x22gift-card\x22><div\x20class=\x22gift-header\x22><svg\x20class=\x22gift-header-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M20\x206h-2.18a4\x204\x200\x200\x200-7.64\x200H8a4\x204\x200\x200\x200-4\x204v2h20V10a4\x204\x200\x200\x200-4-4zM8\x204a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zm12\x200a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zM4\x2014v6a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2v-6H4z\x22></path></svg><span\x20class=\x22gift-header-text\x22>'+_0x231801+_0x4ea655(0x762)+_0x54b74d+_0x4ea655(0x13cf)+_0x3abf4f[_0x4ea655(0xa27)][_0x4ea655(0x29d)]+'件商品'+_0x3e0777+_0x4ea655(0xb6c);}}}}}}}}}}}}}}else{const _0xd7ff7=String(_0x2671d2);let _0x70947f=await _0xdae79d(_0xd7ff7,_0x26b0be['id']);if(_0x70947f!==_0xd7ff7)_0x4a7f8c=_0x70947f,_0x590015[_0x4ea655(0x1276)][_0x4ea655(0xe13)](_0x4ea655(0xcb2));else{if(Array[_0x4ea655(0xb31)](_0x3abf4f[_0x4ea655(0x73e)])&&_0x3abf4f[_0x4ea655(0x73e)][0x0]?.[_0x4ea655(0x919)]===_0x4ea655(0xc40)){const _0x16a2e0=_0x3abf4f[_0x4ea655(0x73e)][0x0][_0x4ea655(0xc40)][_0x4ea655(0xb36)];_0x4a7f8c='<img\x20src=\x22'+_0x16a2e0+'\x22\x20class=\x22chat-image\x22>';}else{if(_0x19cec7[_0x4ea655(0x7f2)](_0x70947f))_0x590015[_0x4ea655(0x1276)][_0x4ea655(0xe13)](_0x4ea655(0x62a),_0x4ea655(0xcb2)),_0x4a7f8c='<img\x20src=\x22'+_0x70947f+'\x22\x20alt=\x22'+(_0x3abf4f[_0x4ea655(0x75f)]||_0x4ea655(0xd55))+_0x4ea655(0x11bc);else{let _0x2ac7c8=_0x1cea24(_0x70947f,_0x26b0be);_0x4a7f8c=_0x46c503(_0x2ac7c8)['replace'](/\n/g,_0x4ea655(0x596));}}}}}_0x590015['innerHTML']=_0x4ea655(0x95c)+_0x4c1ac0+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x40ee34+_0x4ea655(0x26b)+_0x4a7f8c+_0x4ea655(0x11ec),_0x45755d[_0x4ea655(0x133d)](_0x590015),_0x45755d['appendChild'](_0x4854b1),_0x3146aa(_0x45755d,()=>_0x4833d4(_0x3abf4f['timestamp'])),_0x45755d['addEventListener'](_0x4ea655(0xb2b),()=>{if(_0x375e24)_0x272362(_0x3abf4f['timestamp']);});if(!_0x3b81cc){const _0x4a285a=_0x45755d[_0x4ea655(0x139c)](_0x4ea655(0x524));_0x4a285a&&(_0x4a285a['style'][_0x4ea655(0x98c)]=_0x4ea655(0xc28),!_0x26b0be['isGroup']?_0x4a285a[_0x4ea655(0x1086)]('click',_0x364b7a=>{const _0x46334a=_0x4ea655;_0x364b7a[_0x46334a(0xecc)](),_0x18159d(_0x26b0be['id']);}):_0x4a285a['addEventListener'](_0x4ea655(0x6a0),_0x412ddd=>{const _0x1e7927=_0x4ea655;_0x412ddd[_0x1e7927(0xecc)](),_0x394622(_0x26b0be['id'],_0x3abf4f['senderName']);}));}return _0x45755d;}async function _0x4fc3c0(_0x2c575d,_0x520b0f){const _0xd401ca=_0x13d875,_0x5dc552=document[_0xd401ca(0x53a)]('chat-messages'),_0x58952d=await _0x36bd8d(_0x2c575d,_0x520b0f);if(!_0x58952d)return;const _0x39ff51=document['getElementById'](_0xd401ca(0x5bc));_0x39ff51?_0x5dc552[_0xd401ca(0xc38)](_0x58952d,_0x39ff51[_0xd401ca(0xf03)]):_0x5dc552['prepend'](_0x58952d);}async function _0xa4d65(_0x1f9f4f,_0x5e56c5,_0x65871d=![]){const _0x57f57f=_0x13d875,_0x1da52a=document[_0x57f57f(0x53a)](_0x57f57f(0xa33)),_0x450382=document[_0x57f57f(0x53a)](_0x57f57f(0x89e)),_0x526f30=_0x5e56c5[_0x57f57f(0xe83)][_0x57f57f(0x2dd)](_0x3c8fd0=>!_0x3c8fd0['isHidden'])['pop']();if(_0x526f30&&_0x1f9f4f[_0x57f57f(0x827)]-_0x526f30['timestamp']>0x927c0){const _0x97c13d=_0x162b3f(_0x1f9f4f[_0x57f57f(0x827)]);_0x1da52a['insertBefore'](_0x97c13d,_0x450382);}const _0x4cf439=await _0x36bd8d(_0x1f9f4f,_0x5e56c5);if(!_0x4cf439)return;_0x1f9f4f[_0x57f57f(0xb4d)]===_0x57f57f(0xac5)&&!_0x65871d&&_0x1ac891(),!_0x65871d&&_0x4cf439[_0x57f57f(0x1276)][_0x57f57f(0xe13)]('animate-in'),_0x1da52a['insertBefore'](_0x4cf439,_0x450382),!_0x65871d&&(_0x1da52a[_0x57f57f(0xf68)]=_0x1da52a[_0x57f57f(0xaae)],_0x1122e4++);}async function _0x1e3a7c(_0xef8ef6){const _0x401624=_0x13d875;_0x53d851[_0x401624(0x13be)]=_0xef8ef6;const _0x116935=_0x53d851[_0x401624(0xaa3)][_0xef8ef6];if(!_0x116935)return;_0x116935[_0x401624(0x8ce)]>0x0&&(_0x116935[_0x401624(0x8ce)]=0x0,await _0xa62efb[_0x401624(0xaa3)][_0x401624(0x546)](_0x116935));_0x3b0963(_0x116935),_0x60f53f(_0xef8ef6),_0x541a81(_0x401624(0x10ba)),window[_0x401624(0x877)](_0x53d851[_0x401624(0x13be)]);const _0xeb7d1=_0x116935[_0x401624(0x86e)]||![];_0x5dd548(_0xeb7d1),document[_0x401624(0x53a)]('show-announcement-board-btn')['style'][_0x401624(0x11d9)]=_0xeb7d1?_0x401624(0x2f6):_0x401624(0xbf2);const _0x30c9c2=document[_0x401624(0x53a)](_0x401624(0x1301));_0x30c9c2&&(_0x30c9c2[_0x401624(0x1284)][_0x401624(0x11d9)]=_0xeb7d1?'none':'flex');const _0x414883=document[_0x401624(0x53a)](_0x401624(0xdb6)),_0x4f4fca=document[_0x401624(0x53a)]('open-shopping-btn'),_0x5a13cc=document[_0x401624(0x53a)](_0x401624(0x27c)),_0x179c6c=document[_0x401624(0x53a)](_0x401624(0x4ed));_0x4f4fca&&_0x5a13cc&&_0x179c6c&&_0x414883&&(_0x4f4fca[_0x401624(0x1284)][_0x401624(0x11d9)]='flex',_0x5a13cc['style'][_0x401624(0x11d9)]=_0xeb7d1?_0x401624(0xbf2):_0x401624(0x2f6),_0x179c6c[_0x401624(0x1284)][_0x401624(0x11d9)]=_0xeb7d1?_0x401624(0x2f6):_0x401624(0xbf2),_0x414883[_0x401624(0x1284)][_0x401624(0x11d9)]=_0xeb7d1?_0x401624(0xbf2):'flex'),_0x5983f0(),!_0x116935[_0x401624(0x86e)]&&_0x116935[_0x401624(0x1333)]?.['status']===_0x401624(0xf51)&&(console[_0x401624(0x1081)](_0x401624(0x10b3)+_0x116935[_0x401624(0x234)]+'\x22\x20自动触发AI响应...'),_0x5403b5()),document[_0x401624(0x53a)](_0x401624(0xa50))['style'][_0x401624(0x11d9)]=_0xeb7d1?'flex':_0x401624(0xbf2);}function _0x415ffa(_0x425fd5,_0x11292c){const _0x5931b0=_0x13d875,_0x3908b8=_0x11292c?_0x5931b0(0xe13):_0x5931b0(0x2d4),_0x2d7e63=_0x36ece7=>{const _0x18af05=_0x5931b0;_0x36ece7&&_0x36ece7[_0x18af05(0x1276)][_0x3908b8](_0x18af05(0x696));},_0x33eb0f=document[_0x5931b0(0x139c)](_0x5931b0(0x7c5)+_0x425fd5+_0x5931b0(0x1348));_0x2d7e63(_0x33eb0f);const _0x1cd326=document[_0x5931b0(0xc3d)](_0x5931b0(0x35c)+_0x425fd5+'\x22]');_0x1cd326[_0x5931b0(0xeaf)](_0x2d7e63);const _0xf69ff=document[_0x5931b0(0x139c)]('.participant-avatar[data-participant-id=\x22'+_0x425fd5+'\x22]');_0x2d7e63(_0xf69ff);}async function _0x2ef220(){const _0x181d16=_0x13d875;if(!_0x53d851[_0x181d16(0x13be)])return;const _0x42e10a=_0x53d851[_0x181d16(0x13be)],_0x4fca58=_0x53d851[_0x181d16(0xaa3)][_0x42e10a];lastRawAiResponse='',lastResponseTimestamps=[];const _0x42e95d=document[_0x181d16(0x53a)](_0x181d16(0xb5f));_0x42e95d&&(_0x42e95d['disabled']=!![],_0x42e95d[_0x181d16(0x34a)]=_0x181d16(0xc7f));_0x415ffa(_0x42e10a,!![]);try{const {proxyUrl:_0x557a85,apiKey:_0x43b2be,model:_0x2481f3}=_0x53d851[_0x181d16(0x80d)];if(!_0x557a85||!_0x43b2be||!_0x2481f3)throw new Error(_0x181d16(0xfa2));const _0x9d8dfa=parseInt(_0x4fca58[_0x181d16(0x81e)][_0x181d16(0x489)])||0xa,_0x282b37=_0x4fca58[_0x181d16(0xe83)][_0x181d16(0x1340)](-_0x9d8dfa);let _0x48ef18='';if(_0x4fca58['settings'][_0x181d16(0x4ab)]&&_0x4fca58[_0x181d16(0x81e)][_0x181d16(0x4ab)]['length']>0x0){const _0x2a2be1=_0x4fca58[_0x181d16(0x81e)][_0x181d16(0x4ab)][_0x181d16(0xcb4)](_0x178111=>{const _0x38963a=_0x181d16,_0x405c1d=_0x53d851['worldBooks']['find'](_0x549574=>_0x549574['id']===_0x178111);if(!_0x405c1d||!Array[_0x38963a(0xb31)](_0x405c1d[_0x38963a(0x73e)]))return'';const _0x402636=_0x405c1d[_0x38963a(0x73e)]['filter'](_0x33f90e=>_0x33f90e['enabled']!==![])['map'](_0x66d11=>{const _0x3841b8=_0x38963a;let _0x49a649='\x0a###\x20条目:\x20'+(_0x66d11[_0x3841b8(0x1445)]||_0x3841b8(0x4a4))+'\x0a';if(_0x66d11[_0x3841b8(0x1350)][_0x3841b8(0x29d)]>0x0)_0x49a649+=_0x3841b8(0x123d)+_0x66d11[_0x3841b8(0x1350)][_0x3841b8(0x2c8)](',\x20')+'\x0a';return _0x49a649+='**内容:**\x0a'+_0x66d11[_0x3841b8(0x73e)],_0x49a649;})[_0x38963a(0x2c8)]('');return _0x402636?_0x38963a(0xa7d)+_0x405c1d['name']+'\x0a'+_0x402636:'';})[_0x181d16(0x2dd)](Boolean)[_0x181d16(0x2c8)]('');_0x2a2be1&&(_0x48ef18=_0x181d16(0x11e4)+_0x2a2be1+_0x181d16(0xcc2));}let _0x485595=_0x181d16(0x140c),_0x491d4d=![];_0x4fca58[_0x181d16(0x3de)]['forEach'](_0x6d7d67=>{const _0x458355=_0x181d16,_0x44f39e=_0x53d851[_0x458355(0xaa3)][_0x6d7d67['id']];_0x44f39e&&_0x44f39e[_0x458355(0x1016)]&&_0x44f39e['longTermMemory'][_0x458355(0x29d)]>0x0&&(_0x485595+=_0x458355(0xe56)+_0x6d7d67[_0x458355(0x12bc)]+_0x458355(0x7d0),_0x485595+=_0x44f39e[_0x458355(0x1016)][_0x458355(0xcb4)](_0x1dce6c=>_0x458355(0xd87)+_0x272f9c(_0x1dce6c['timestamp'])+')\x20'+_0x1dce6c[_0x458355(0x73e)])[_0x458355(0x2c8)]('\x0a'),_0x491d4d=!![]);});!_0x491d4d&&(_0x485595+=_0x181d16(0xddc));let _0x1dbc5d='';const _0x224d53=_0x4fca58[_0x181d16(0x81e)][_0x181d16(0x90d)]||0xa;if(_0x4fca58[_0x181d16(0x81e)][_0x181d16(0x278)]&&_0x4fca58['settings'][_0x181d16(0x278)][_0x181d16(0x29d)]>0x0){}const _0x3c6f9a=_0x4fca58[_0x181d16(0x3de)][_0x181d16(0xcb4)](_0x421628=>'-\x20**'+_0x421628['groupNickname']+_0x181d16(0x96e)+_0x421628[_0x181d16(0x543)]+'):\x20'+_0x421628[_0x181d16(0x11fb)])[_0x181d16(0x2c8)]('\x0a'),_0x3382a9=_0x194105(_0x4fca58),_0x1b6e87=_0x181d16(0xb89)+_0x4fca58[_0x181d16(0x234)]+_0x181d16(0x1177)+_0x4fca58[_0x181d16(0x234)]+_0x181d16(0xb4c)+_0x485595+'\x0a'+_0x48ef18+'\x0a'+_0x1dbc5d+_0x181d16(0x1020)+_0x282b37[_0x181d16(0xcb4)](_0x160c91=>_0xf33fb2(_0x4fca58,_0x160c91[_0x181d16(0xbee)])+':\x20'+_0x160c91[_0x181d16(0x73e)])[_0x181d16(0x2c8)]('\x0a')+_0x181d16(0xc36)+_0x3c6f9a+_0x181d16(0x28e)+_0x3382a9+_0x181d16(0x259),_0x11db1e=_0x282b37[_0x181d16(0xcb4)](_0x58aed7=>({'role':_0x181d16(0x10ae),'content':_0xf33fb2(_0x4fca58,_0x58aed7[_0x181d16(0xbee)])+':\x20'+_0x58aed7[_0x181d16(0x73e)]}));let _0x4e060c=_0x557a85['includes']('generativelanguage.googleapis.com'),_0x4577a2;if(_0x4e060c){let _0x2807de=_0x1697e7(_0x2481f3,_0x43b2be,_0x1b6e87,_0x11db1e);_0x4577a2=await fetch(_0x2807de[_0x181d16(0xb36)],_0x2807de['data']);}else _0x4577a2=await fetch(_0x557a85+_0x181d16(0x434),{'method':_0x181d16(0xa4e),'headers':{'Content-Type':'application/json','Authorization':_0x181d16(0x841)+_0x43b2be},'body':JSON[_0x181d16(0xe1e)]({'model':_0x2481f3,'messages':[{'role':_0x181d16(0xab3),'content':_0x1b6e87},..._0x11db1e],'temperature':_0x53d851[_0x181d16(0x906)]['apiTemperature']||0.9})});if(!_0x4577a2['ok']){const _0x16e829=await _0x4577a2[_0x181d16(0xdc2)]()[_0x181d16(0x9cb)](()=>({'error':{'message':_0x4577a2[_0x181d16(0x5c1)]}}));throw new Error(_0x181d16(0x509)+_0x4577a2[_0x181d16(0x12d3)]+_0x181d16(0x122c)+(_0x16e829[_0x181d16(0x617)]?.['message']||'未知错误'));}const _0x535f73=await _0x4577a2[_0x181d16(0xdc2)](),_0xacb96b=getGeminiResponseText(_0x535f73);lastRawAiResponse=_0xacb96b;const _0x261fcd=_0x3e5855(_0xacb96b);let _0x22a6df=Date[_0x181d16(0x9c1)]();for(const _0x4ce387 of _0x261fcd){if(!_0x4ce387||!_0x4ce387[_0x181d16(0x919)]||!_0x4ce387['name'])continue;let _0x50e303=null;const _0x544af5=_0x22a6df++;lastResponseTimestamps['push'](_0x544af5);const _0x264a4e={'role':'assistant','senderName':_0x4ce387[_0x181d16(0x234)],'timestamp':_0x544af5};switch(_0x4ce387[_0x181d16(0x919)]){case _0x181d16(0x2e6):_0x50e303={..._0x264a4e,'content':_0x4ce387['content']};break;case _0x181d16(0x257):if(_0x4ce387[_0x181d16(0x75f)]){const _0x4a1507=_0x53d851[_0x181d16(0xf8f)][_0x181d16(0x397)](_0x141ad4=>_0x141ad4[_0x181d16(0x234)]===_0x4ce387[_0x181d16(0x75f)]);_0x4a1507?_0x50e303={..._0x264a4e,'type':_0x181d16(0x257),'content':_0x4a1507[_0x181d16(0xb36)],'meaning':_0x4a1507[_0x181d16(0x234)]}:(console[_0x181d16(0xad0)](_0x181d16(0x930)+_0x4ce387[_0x181d16(0x75f)]+'\x22'),_0x50e303={..._0x264a4e,'type':_0x181d16(0x2e6),'content':_0x181d16(0x6b1)+_0x4ce387['meaning']+']'});}else console['warn']('旁观模式AI发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。',_0x4ce387);break;case _0x181d16(0x2a5):_0x50e303={..._0x264a4e,'type':'ai_image','content':_0x4ce387[_0x181d16(0xa60)],'image_prompt':_0x4ce387['image_prompt']};break;case'voice_message':_0x50e303={..._0x264a4e,'type':_0x181d16(0x64f),'content':_0x4ce387[_0x181d16(0x73e)]};break;case _0x181d16(0x765):const _0x398b65=_0x4fca58['history']['find'](_0x2fb76d=>_0x2fb76d[_0x181d16(0x827)]===_0x4ce387['target_timestamp']);_0x398b65?_0x50e303={..._0x264a4e,'content':_0x4ce387[_0x181d16(0xf88)],'quote':{'timestamp':_0x398b65[_0x181d16(0x827)],'senderName':_0x398b65[_0x181d16(0xbee)],'content':String(_0x398b65[_0x181d16(0x73e)]||'')['substring'](0x0,0x32)}}:_0x50e303={..._0x264a4e,'content':_0x4ce387[_0x181d16(0xf88)]};break;default:console[_0x181d16(0xad0)](_0x181d16(0xa9e),_0x4ce387['type']);continue;}_0x50e303&&(_0x4fca58[_0x181d16(0xe83)][_0x181d16(0x7dd)](_0x50e303),_0xa4d65(_0x50e303,_0x4fca58),await new Promise(_0x5c1566=>setTimeout(_0x5c1566,Math[_0x181d16(0xac4)]()*0x4b0+0x320)));}await _0xa62efb[_0x181d16(0xaa3)]['put'](_0x4fca58),_0x5001a4();}catch(_0x45c3b3){console['error'](_0x181d16(0xc5a),_0x45c3b3),await _0x184397(_0x181d16(0xeac),_0x181d16(0xe75)+_0x45c3b3[_0x181d16(0x875)]);}finally{_0x42e95d&&(_0x42e95d[_0x181d16(0xb77)]=![],_0x42e95d[_0x181d16(0x34a)]=_0x181d16(0x1113)),_0x415ffa(_0x42e10a,![]);}}async function _0x5403b5(){const _0x42aa29=_0x13d875;if(!_0x53d851[_0x42aa29(0x13be)])return;const _0x1faca0=_0x53d851[_0x42aa29(0x13be)],_0x40c514=_0x53d851[_0x42aa29(0xaa3)][_0x53d851[_0x42aa29(0x13be)]],_0x4c9eba=document['getElementById'](_0x42aa29(0x10ba))[_0x42aa29(0x1276)][_0x42aa29(0x6a3)]('active')&&_0x53d851['activeChatId']===_0x1faca0;_0x415ffa(_0x1faca0,!![]);const _0x2f906f=document[_0x42aa29(0x53a)](_0x42aa29(0xba3)),_0x3a6045=document[_0x42aa29(0x53a)]('typing-indicator'),_0x38d5a0=document[_0x42aa29(0x139c)]('.chat-list-item[data-chat-id=\x22'+_0x1faca0+'\x22]'),_0x23f303=_0x38d5a0?_0x38d5a0[_0x42aa29(0x139c)](_0x42aa29(0xedf)):null;_0x23f303&&_0x23f303[_0x42aa29(0x1276)][_0x42aa29(0xe13)](_0x42aa29(0x696));_0x40c514['isGroup']?_0x3a6045&&(_0x3a6045[_0x42aa29(0x34a)]='成员们正在输入...',_0x3a6045[_0x42aa29(0x1284)][_0x42aa29(0x11d9)]='block'):_0x2f906f&&(_0x2f906f[_0x42aa29(0x1284)]['opacity']=0x0,setTimeout(()=>{const _0x4e837a=_0x42aa29;_0x2f906f[_0x4e837a(0x34a)]='对方正在输入...',_0x2f906f[_0x4e837a(0x1276)][_0x4e837a(0xe13)](_0x4e837a(0x67f)),_0x2f906f['style']['opacity']=0x1;},0xc8));let _0xd89d66=![];try{const {proxyUrl:_0x479f46,apiKey:_0x518c77,model:_0x348add}=_0x53d851[_0x42aa29(0x80d)];if(!_0x479f46||!_0x518c77||!_0x348add){alert(_0x42aa29(0xbdd));if(_0x40c514['isGroup']){if(_0x3a6045)_0x3a6045['style'][_0x42aa29(0x11d9)]=_0x42aa29(0xbf2);}else _0x2f906f&&_0x53d851['chats'][_0x1faca0]&&(_0x2f906f[_0x42aa29(0x34a)]=_0x53d851[_0x42aa29(0xaa3)][_0x1faca0]['name'],_0x2f906f[_0x42aa29(0x1276)][_0x42aa29(0x2d4)](_0x42aa29(0x67f)));return;}const _0x5dd522=_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x1340)](-0x1)[0x0],_0x5e791d=_0x5dd522&&_0x5dd522[_0x42aa29(0xb4d)]===_0x42aa29(0xab3)&&_0x5dd522[_0x42aa29(0x73e)][_0x42aa29(0x6e9)](_0x42aa29(0xac6));if(_0x5e791d){console['log'](_0x42aa29(0xbb5)+_0x40c514[_0x42aa29(0x234)]+'\x22\x20触发专属决策流程...');let _0x22042e;_0x40c514[_0x42aa29(0x86e)]?_0x22042e=_0x42aa29(0x10f5)+_0x40c514[_0x42aa29(0x3de)][_0x42aa29(0xcb4)](_0x4fcf3d=>'-\x20'+_0x4fcf3d[_0x42aa29(0x12bc)]+_0x42aa29(0xdb3)+_0x4fcf3d['originalName']+_0x42aa29(0x1108)+_0x4fcf3d['persona'])[_0x42aa29(0x2c8)]('\x0a')+_0x42aa29(0x8b4):_0x22042e=_0x42aa29(0xb0f)+_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x1216)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须且只能】是以下两种格式之一的JSON数组，绝对不能回复任何其他内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20接受:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20拒绝:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22reject\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即做出决策。';const _0x11e952=[{'role':_0x42aa29(0x10ae),'content':_0x22042e}];try{let _0x374951=_0x1697e7(_0x348add,_0x518c77,_0x22042e,_0x11e952),_0x40922f=_0x479f46===GEMINI_API_URL;const _0x3917ca=_0x40922f?await fetch(_0x374951[_0x42aa29(0xb36)],_0x374951['data']):await fetch(_0x479f46+_0x42aa29(0x434),{'method':'POST','headers':{'Content-Type':_0x42aa29(0x85b),'Authorization':_0x42aa29(0x841)+_0x518c77},'body':JSON[_0x42aa29(0xe1e)]({'model':_0x348add,'messages':_0x11e952,'temperature':0.7})});if(!_0x3917ca['ok'])throw new Error(_0x42aa29(0xbbb)+(await _0x3917ca[_0x42aa29(0xdc2)]())[_0x42aa29(0x617)][_0x42aa29(0x875)]);const _0x3301c6=await _0x3917ca[_0x42aa29(0xdc2)](),_0x11f857=getGeminiResponseText(_0x3301c6),_0x344654=_0x3e5855(_0x11f857);let _0x399517=![];for(const _0x542867 of _0x344654){if(_0x542867[_0x42aa29(0x919)]===_0x42aa29(0xb05)){_0x58a059[_0x42aa29(0xf9b)]=![];if(_0x542867[_0x42aa29(0x12e3)]==='accept')_0x56dfd3();else{const _0x5deee8={'role':_0x42aa29(0xac5),'content':_0x42aa29(0x102b),'timestamp':Date[_0x42aa29(0x9c1)]()};_0x40c514[_0x42aa29(0xe83)]['push'](_0x5deee8),await _0xa62efb['chats']['put'](_0x40c514),_0x541a81(_0x42aa29(0x10ba)),_0x60f53f(_0x1faca0);}_0x399517=!![];break;}if(_0x542867[_0x42aa29(0x919)]===_0x42aa29(0x2f1)){if(_0x542867[_0x42aa29(0x12e3)]==='join'){const _0x196f48=_0x40c514[_0x42aa29(0x3de)]['find'](_0x1fdd45=>_0x1fdd45[_0x42aa29(0x543)]===_0x542867[_0x42aa29(0x234)]);_0x196f48&&!_0x58a059[_0x42aa29(0x574)]['some'](_0x3b2ba2=>_0x3b2ba2['id']===_0x196f48['id'])&&_0x58a059['participants'][_0x42aa29(0x7dd)](_0x196f48);}_0x399517=!![];}}_0x399517&&_0x58a059[_0x42aa29(0x732)]&&(_0x58a059[_0x42aa29(0xf9b)]=![],_0x58a059[_0x42aa29(0x574)][_0x42aa29(0x29d)]>0x0?_0x56dfd3():(_0x58a059={..._0x58a059,'isAwaitingResponse':![],'participants':[]},_0x541a81(_0x42aa29(0x10ba)),alert(_0x42aa29(0x80a))));}catch(_0x458d6c){console[_0x42aa29(0x617)](_0x42aa29(0x2c7),_0x458d6c);const _0x520ec7=_0x40c514[_0x42aa29(0x86e)]?_0x40c514[_0x42aa29(0x3de)]['map'](_0x2eac1b=>({'type':_0x42aa29(0x2f1),'name':_0x2eac1b[_0x42aa29(0x543)],'decision':_0x42aa29(0x114a)})):[{'type':_0x42aa29(0xb05),'decision':_0x42aa29(0x32c)}];if(_0x40c514[_0x42aa29(0x86e)])_0x58a059['isAwaitingResponse']=![],_0x58a059['participants']=[],alert(_0x42aa29(0x80a)),_0x541a81(_0x42aa29(0x10ba));else{const _0x140f22={'role':_0x42aa29(0xac5),'content':_0x42aa29(0x102b),'timestamp':Date[_0x42aa29(0x9c1)]()};_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x7dd)](_0x140f22),await _0xa62efb[_0x42aa29(0xaa3)][_0x42aa29(0x546)](_0x40c514),_0x541a81(_0x42aa29(0x10ba)),_0x60f53f(_0x1faca0);}}finally{_0x415ffa(_0x1faca0,![]);return;}}if(!_0x40c514['isGroup']&&_0x40c514[_0x42aa29(0x1333)]?.[_0x42aa29(0x12d3)]===_0x42aa29(0xf51)){console[_0x42aa29(0x1081)](_0x42aa29(0xba0)+_0x40c514[_0x42aa29(0x234)]+_0x42aa29(0xa89));const _0x460d0a=_0x40c514['history'][_0x42aa29(0x2dd)](_0x27618e=>!_0x27618e[_0x42aa29(0x1032)])['slice'](-0xa,-0x5)[_0x42aa29(0xcb4)](_0x4fce90=>{const _0x482737=_0x42aa29,_0x991d77=_0x4fce90[_0x482737(0xb4d)]===_0x482737(0x10ae)?'用户':_0x40c514[_0x482737(0x234)];return _0x991d77+':\x20'+String(_0x4fce90[_0x482737(0x73e)])[_0x482737(0xad6)](0x0,0x32)+_0x482737(0x95d);})[_0x42aa29(0x2c8)]('\x0a'),_0x4c6a13=_0x42aa29(0x13e1)+_0x40c514[_0x42aa29(0x234)]+_0x42aa29(0x7d1)+_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x1216)]+_0x42aa29(0x8fa)+_0x40c514['relationship'][_0x42aa29(0xc1c)]+_0x42aa29(0xeb6)+(_0x460d0a||_0x42aa29(0x89a))+_0x42aa29(0xcd0);try{const _0x11783f=[{'role':'system','content':_0x4c6a13},{'role':_0x42aa29(0x10ae),'content':_0x42aa29(0xa47)}];let _0x58d1f1=_0x479f46===GEMINI_API_URL,_0x6663cd=_0x1697e7(_0x348add,_0x518c77,_0x4c6a13,[{'role':_0x42aa29(0x10ae),'content':'请根据以上设定，立即做出你的决定。'}]);const _0x5dcada=_0x58d1f1?await fetch(_0x6663cd[_0x42aa29(0xb36)],_0x6663cd[_0x42aa29(0xd7c)]):await fetch(_0x479f46+_0x42aa29(0x434),{'method':_0x42aa29(0xa4e),'headers':{'Content-Type':_0x42aa29(0x85b),'Authorization':_0x42aa29(0x841)+_0x518c77},'body':JSON[_0x42aa29(0xe1e)]({'model':_0x348add,'messages':_0x11783f,'temperature':_0x53d851['globalSettings'][_0x42aa29(0xaf8)]||0.8})});if(!_0x5dcada['ok'])throw new Error(_0x42aa29(0xbbb)+(await _0x5dcada['json']())[_0x42aa29(0x617)][_0x42aa29(0x875)]);const _0x4fe245=await _0x5dcada[_0x42aa29(0xdc2)](),_0x44f29f=getGeminiResponseText(_0x4fe245)[_0x42aa29(0x795)](/^```json\s*/,'')['replace'](/```$/,'')['trim'](),_0x10a08b=JSON[_0x42aa29(0x367)](_0x44f29f);if(_0x10a08b[_0x42aa29(0x12e3)]===_0x42aa29(0xe7a)){_0x40c514[_0x42aa29(0x1333)][_0x42aa29(0x12d3)]=_0x42aa29(0x10b1);const _0x5b3f5c={'role':'assistant','senderName':_0x40c514[_0x42aa29(0x234)],'content':_0x10a08b[_0x42aa29(0xd90)],'timestamp':Date[_0x42aa29(0x9c1)]()};_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x7dd)](_0x5b3f5c);}else{_0x40c514[_0x42aa29(0x1333)]['status']=_0x42aa29(0xfb8);const _0x3a52f2={'role':_0x42aa29(0xac5),'senderName':_0x40c514[_0x42aa29(0x234)],'content':_0x10a08b[_0x42aa29(0xd90)],'timestamp':Date[_0x42aa29(0x9c1)]()};_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x7dd)](_0x3a52f2);}_0x40c514['relationship']['applicationReason']='',await _0xa62efb['chats'][_0x42aa29(0x546)](_0x40c514),_0x60f53f(_0x1faca0),_0x5001a4();}catch(_0x138c66){_0x40c514[_0x42aa29(0x1333)][_0x42aa29(0x12d3)]=_0x42aa29(0xfb8),await _0xa62efb[_0x42aa29(0xaa3)][_0x42aa29(0x546)](_0x40c514),await _0x184397(_0x42aa29(0xe54),_0x42aa29(0xf3d)+_0x138c66['message']),_0x60f53f(_0x1faca0);}return;}let _0x53b4e3='';const _0x1cbd96=new Date(),_0x2a5c6a=_0x40c514['settings']['timeZone']||'Asia/Shanghai',_0x1ac2ca=_0x1cbd96[_0x42aa29(0x5ee)](_0x42aa29(0x42f),{'timeZone':_0x2a5c6a,'dateStyle':_0x42aa29(0xbcc),'timeStyle':_0x42aa29(0xa18)}),_0x4271bb=new Date(_0x1cbd96[_0x42aa29(0x5ee)](_0x42aa29(0x407),{'timeZone':_0x2a5c6a})),_0x17ad73=_0x49fe75(_0x4271bb);let _0x245df9,_0x6af879;const _0x3abb83=_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x2dd)](_0x22686f=>_0x22686f[_0x42aa29(0x1032)])[_0x42aa29(0x51a)]();if(_0x3abb83&&_0x3abb83['content']['includes'](_0x42aa29(0xf76))){const _0x1d2b0f=await _0xa62efb['callRecords'][_0x42aa29(0x57e)]('chatId')[_0x42aa29(0x12f6)](_0x1faca0)[_0x42aa29(0x9c0)]();if(_0x1d2b0f&&_0x1d2b0f[_0x42aa29(0x109a)]){console[_0x42aa29(0x1081)](_0x42aa29(0xabf));const _0x5f3c1e=_0x1d2b0f[_0x42aa29(0x109a)][_0x42aa29(0xcb4)](_0x19c62b=>{const _0x2614a9=_0x42aa29,_0x1e72b9=_0x19c62b[_0x2614a9(0xb4d)]==='user'?_0x40c514[_0x2614a9(0x81e)]['myNickname']||'我':_0x19c62b['senderName'];return _0x1e72b9+':\x20'+_0x19c62b[_0x2614a9(0x73e)];})[_0x42aa29(0x2c8)]('\x0a');_0x53b4e3=_0x42aa29(0xff4)+_0x5f3c1e+_0x42aa29(0x1215);}}const _0x623955=_0x18d781(_0x4b8524[_0x1faca0]);let _0x1210f5='';if(_0x40c514['settings'][_0x42aa29(0x4ab)]&&_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x4ab)][_0x42aa29(0x29d)]>0x0){const _0x5b63b2=_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x4ab)]['map'](_0x3162ad=>{const _0x5e9448=_0x42aa29,_0x541c5b=_0x53d851['worldBooks'][_0x5e9448(0x397)](_0x58246a=>_0x58246a['id']===_0x3162ad);if(!_0x541c5b||!Array[_0x5e9448(0xb31)](_0x541c5b['content']))return'';const _0x53b270=_0x541c5b[_0x5e9448(0x73e)][_0x5e9448(0x2dd)](_0x34482e=>_0x34482e[_0x5e9448(0xb3d)]!==![])['map'](_0x5b6b27=>{const _0x875791=_0x5e9448;let _0x168d8c=_0x875791(0xbc5)+(_0x5b6b27[_0x875791(0x1445)]||'无备注')+'\x0a';return _0x5b6b27['keys'][_0x875791(0x29d)]>0x0&&(_0x168d8c+='**关键词:**\x20'+_0x5b6b27[_0x875791(0x1350)]['join'](',\x20')+'\x0a'),_0x168d8c+='**内容:**\x0a'+_0x5b6b27[_0x875791(0x73e)],_0x168d8c;})[_0x5e9448(0x2c8)]('');return _0x53b270?'\x0a\x0a##\x20世界书:\x20'+_0x541c5b[_0x5e9448(0x234)]+'\x0a'+_0x53b270:'';})[_0x42aa29(0x2dd)](Boolean)[_0x42aa29(0x2c8)]('');_0x5b63b2&&(_0x1210f5=_0x42aa29(0x11e4)+_0x5b63b2+_0x42aa29(0xcc2));}let _0x411989='';if(_0x2eebda['isActive']&&_0x2eebda[_0x42aa29(0x13be)]===_0x1faca0){const _0x177f1f=_0x2eebda[_0x42aa29(0xe7d)]>-0x1?_0x2eebda['playlist'][_0x2eebda[_0x42aa29(0xe7d)]]:null,_0xe4e25c=_0x2eebda[_0x42aa29(0xc9a)][_0x42aa29(0xcb4)](_0x5ef7a6=>'\x22'+_0x5ef7a6[_0x42aa29(0x234)]+'\x22')[_0x42aa29(0x2c8)](',\x20');let _0x416ad8='';if(_0x177f1f&&_0x2eebda[_0x42aa29(0xd4b)]&&_0x2eebda[_0x42aa29(0xd4b)][_0x42aa29(0x29d)]>0x0&&_0x2eebda[_0x42aa29(0x10b2)]>-0x1){const _0x3ce079=_0x2eebda[_0x42aa29(0xd4b)][_0x2eebda[_0x42aa29(0x10b2)]],_0x41f9d5=_0x2eebda[_0x42aa29(0xd4b)]['slice'](_0x2eebda[_0x42aa29(0x10b2)]+0x1,_0x2eebda[_0x42aa29(0x10b2)]+0x3);_0x416ad8+=_0x42aa29(0x11e6)+_0x3ce079[_0x42aa29(0x2e6)]+'\x22\x0a',_0x41f9d5[_0x42aa29(0x29d)]>0x0&&(_0x416ad8+=_0x42aa29(0xb7a)+_0x41f9d5[_0x42aa29(0xcb4)](_0x333623=>'\x22'+_0x333623[_0x42aa29(0x2e6)]+'\x22')[_0x42aa29(0x2c8)]('\x20/\x20')+'\x0a');}_0x411989=_0x42aa29(0x573)+(_0x177f1f?'《'+_0x177f1f[_0x42aa29(0x234)]+_0x42aa29(0xf04)+_0x177f1f[_0x42aa29(0x7cc)]:'无')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**可用播放列表**:\x20['+_0xe4e25c+_0x42aa29(0x2a6)+_0x416ad8+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的任务**:\x20你可以根据对话内容和氛围，使用\x20\x22change_music\x22\x20指令切换到播放列表中的任何一首歌，以增强互动体验。\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}const _0x330262=parseInt(_0x40c514[_0x42aa29(0x81e)]['maxMemory'])||0xa,_0x2d2668=_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x1340)](-_0x330262);let _0x4dae20='';const _0x4cc01f=_0x40c514['history'][_0x42aa29(0xe26)](_0x67afbc=>_0x67afbc[_0x42aa29(0xb4d)]===_0x42aa29(0xac5)),_0xa82609=_0x40c514['history'][_0x42aa29(0x1340)](_0x4cc01f+0x1),_0x4647a7=_0xa82609[_0x42aa29(0x397)](_0x5509f9=>_0x5509f9[_0x42aa29(0x919)]===_0x42aa29(0xd32));if(_0x4647a7){const _0x4a1c1d=_0x4647a7['payload'],_0x4cf3b2=_0x4a1c1d[_0x42aa29(0xeed)]['map'](_0x3aa8a5=>{const _0x2d450c=_0x42aa29,_0x5e4c4=_0x3aa8a5[_0x2d450c(0xbee)]||(_0x3aa8a5[_0x2d450c(0xb4d)]==='user'?_0x40c514[_0x2d450c(0x81e)][_0x2d450c(0x1303)]||'我':_0x2d450c(0x125b));let _0x4fbbca='';if(_0x3aa8a5[_0x2d450c(0x919)]===_0x2d450c(0x64f))_0x4fbbca=_0x2d450c(0xcc4)+_0x3aa8a5['content']+']';else{if(_0x3aa8a5[_0x2d450c(0x919)]===_0x2d450c(0x2a5))_0x4fbbca=_0x2d450c(0x59c)+_0x3aa8a5[_0x2d450c(0xa60)]+']';else{if(_0x3aa8a5[_0x2d450c(0x919)]===_0x2d450c(0x357))_0x4fbbca=_0x2d450c(0x103b)+_0x3aa8a5['prompt']+']';else _0x4fbbca=String(_0x3aa8a5[_0x2d450c(0x73e)]);}}return _0x5e4c4+':\x20'+_0x4fbbca;})[_0x42aa29(0x2c8)]('\x0a');_0x4dae20=_0x42aa29(0x468)+_0x4a1c1d[_0x42aa29(0x137a)]+_0x42aa29(0x10ea)+_0x4cf3b2+_0x42aa29(0x12c2);}let _0x331ea4='';const _0x1f0e86=_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x90d)]||0xa;if(_0x40c514['settings']['linkedMemoryChatIds']&&_0x40c514[_0x42aa29(0x81e)]['linkedMemoryChatIds']['length']>0x0){const _0x48356b=_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x278)]['filter'](_0x1e9757=>_0x1e9757!==_0x1faca0);if(_0x48356b[_0x42aa29(0x29d)]>0x0){const _0x3a2b5f=_0x48356b[_0x42aa29(0xcb4)](_0x2b22cd=>{const _0x159591=_0x42aa29,_0x10bfb1=_0x53d851[_0x159591(0xaa3)][_0x2b22cd];if(!_0x10bfb1)return null;const _0x422392=_0x10bfb1[_0x159591(0xe83)][_0x159591(0x1340)](-0x1);return{'chat':_0x10bfb1,'latestTimestamp':_0x422392?_0x422392[_0x159591(0x827)]:0x0};})[_0x42aa29(0x2dd)](Boolean);_0x3a2b5f['sort']((_0x2fd05f,_0x39f574)=>_0x39f574['latestTimestamp']-_0x2fd05f[_0x42aa29(0x616)]),_0x331ea4+='\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a';for(const _0x1a1478 of _0x3a2b5f){const _0x301f03=_0x1a1478['chat'],_0x434451=_0x301f03[_0x42aa29(0x86e)]?_0x42aa29(0xbf8):'[私聊]',_0x30c261=_0x1a1478[_0x42aa29(0x616)]>0x0?_0x42aa29(0x125e)+_0x272f9c(_0x1a1478['latestTimestamp'])+')':'';_0x331ea4+='\x0a##\x20---\x20来自'+_0x434451+'“'+_0x301f03[_0x42aa29(0x234)]+_0x42aa29(0x8d5)+_0x30c261+'\x20---\x0a';const _0xad4d20=_0x301f03[_0x42aa29(0xe83)]['slice'](-_0x1f0e86),_0x1021c4=_0xad4d20[_0x42aa29(0x2dd)](_0x328d08=>!String(_0x328d08['content'])[_0x42aa29(0x6e9)](_0x42aa29(0x138c)));_0x1021c4[_0x42aa29(0x29d)]>0x0?_0x1021c4['forEach'](_0x3da1e8=>{const _0x1f7a0f=_0x42aa29,_0x489421=_0x3da1e8[_0x1f7a0f(0xb4d)]===_0x1f7a0f(0x10ae)?_0x301f03['settings'][_0x1f7a0f(0x1303)]||'我':_0x3da1e8[_0x1f7a0f(0xbee)]||_0x301f03[_0x1f7a0f(0x234)];let _0x15c370=String(_0x3da1e8[_0x1f7a0f(0x73e)]);if(_0x3da1e8[_0x1f7a0f(0x919)]===_0x1f7a0f(0x2a5)||_0x3da1e8[_0x1f7a0f(0x919)]===_0x1f7a0f(0x1053))_0x15c370=_0x1f7a0f(0xb22)+_0x3da1e8[_0x1f7a0f(0x73e)]+']';else _0x3da1e8['type']==='voice_message'&&(_0x15c370=_0x1f7a0f(0xd11)+_0x3da1e8['content']+']');const _0x11a785=_0x272f9c(_0x3da1e8[_0x1f7a0f(0x827)]);_0x331ea4+='('+_0x11a785+')\x20'+_0x489421+':\x20'+_0x15c370+'\x0a';}):_0x331ea4+='(暂无有效聊天记录)\x0a';}}}console[_0x42aa29(0x1081)](_0x42aa29(0x3ca),_0x331ea4);if(_0x40c514[_0x42aa29(0x86e)]){let _0x55b034='';const _0x57d2ef=_0x40c514[_0x42aa29(0x81e)]['linkedMemoryCount']||0xa;if(_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x278)]&&_0x40c514[_0x42aa29(0x81e)]['linkedMemoryChatIds'][_0x42aa29(0x29d)]>0x0){const _0x48e271=_0x40c514[_0x42aa29(0x81e)]['linkedMemoryChatIds']['filter'](_0x173192=>_0x173192!==_0x1faca0);if(_0x48e271[_0x42aa29(0x29d)]>0x0){const _0xd2880c=_0x48e271[_0x42aa29(0xcb4)](_0x4d0c12=>{const _0x46057f=_0x42aa29,_0x2c8bc4=_0x53d851[_0x46057f(0xaa3)][_0x4d0c12];if(!_0x2c8bc4)return null;const _0x57cf94=_0x2c8bc4['history'][_0x46057f(0x1340)](-0x1);return{'chat':_0x2c8bc4,'latestTimestamp':_0x57cf94?_0x57cf94[_0x46057f(0x827)]:0x0};})[_0x42aa29(0x2dd)](Boolean);_0xd2880c[_0x42aa29(0xdb0)]((_0x58f940,_0x5c64e5)=>_0x5c64e5[_0x42aa29(0x616)]-_0x58f940[_0x42aa29(0x616)]),_0x55b034+=_0x42aa29(0x3bf);for(const _0x52bc7f of _0xd2880c){const _0xdb4038=_0x52bc7f['chat'],_0x1ee902=_0xdb4038['isGroup']?_0x42aa29(0xbf8):'[私聊]',_0x2d3e74=_0x52bc7f[_0x42aa29(0x616)]>0x0?'\x20(最后互动于\x20'+_0x272f9c(_0x52bc7f[_0x42aa29(0x616)])+')':'';_0x55b034+=_0x42aa29(0x129a)+_0x1ee902+'“'+_0xdb4038[_0x42aa29(0x234)]+_0x42aa29(0x8d5)+_0x2d3e74+'\x20---\x0a';const _0x58bb70=_0xdb4038[_0x42aa29(0xe83)][_0x42aa29(0x1340)](-_0x57d2ef),_0x33afe1=_0x58bb70['filter'](_0x1068f9=>!String(_0x1068f9[_0x42aa29(0x73e)])[_0x42aa29(0x6e9)](_0x42aa29(0x138c)));_0x33afe1[_0x42aa29(0x29d)]>0x0?_0x33afe1[_0x42aa29(0xeaf)](_0x3756af=>{const _0x11ca49=_0x42aa29,_0x1765ea=_0x3756af['role']===_0x11ca49(0x10ae)?_0xdb4038[_0x11ca49(0x81e)][_0x11ca49(0x1303)]||'我':_0x3756af[_0x11ca49(0xbee)]||_0xdb4038['name'];let _0xb5a96=String(_0x3756af['content']);if(_0x3756af[_0x11ca49(0x919)]===_0x11ca49(0x2a5)||_0x3756af[_0x11ca49(0x919)]===_0x11ca49(0x1053))_0xb5a96='[发送了一张图片，描述为：'+_0x3756af[_0x11ca49(0x73e)]+']';else _0x3756af[_0x11ca49(0x919)]===_0x11ca49(0x64f)&&(_0xb5a96=_0x11ca49(0xd11)+_0x3756af[_0x11ca49(0x73e)]+']');_0x55b034+=_0x1765ea+':\x20'+_0xb5a96+'\x0a';}):_0x55b034+=_0x42aa29(0xa51);}}}let _0x5c69ea='#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a',_0x1a894f=![];_0x40c514[_0x42aa29(0x3de)][_0x42aa29(0xeaf)](_0xd0adf4=>{const _0x51bc90=_0x42aa29,_0x1cc3a8=_0x53d851['chats'][_0xd0adf4['id']];_0x1cc3a8&&_0x1cc3a8[_0x51bc90(0x1016)]&&_0x1cc3a8[_0x51bc90(0x1016)]['length']>0x0&&(_0x5c69ea+=_0x51bc90(0xe56)+_0xd0adf4[_0x51bc90(0x12bc)]+'”的记忆\x20---\x0a',_0x5c69ea+=_0x1cc3a8['longTermMemory'][_0x51bc90(0xcb4)](_0x493fe1=>_0x51bc90(0xd87)+_0x272f9c(_0x493fe1[_0x51bc90(0x827)])+')\x20'+_0x493fe1[_0x51bc90(0x73e)])[_0x51bc90(0x2c8)]('\x0a'),_0x1a894f=!![]);});!_0x1a894f&&(_0x5c69ea+=_0x42aa29(0xddc));let _0x28fcd0='',_0x57e2f8=![];if(_0x40c514['settings']['enableTimePerception']){const _0x5115b2=_0x2d2668[_0x42aa29(0x1340)](-0x1)[0x0];if(_0x5115b2){const _0x3a4ae5=_0x4e608d(_0x5115b2[_0x42aa29(0x827)]);_0x28fcd0=_0x42aa29(0x1228)+_0x3a4ae5+'。';const _0x8abf1d=(Date[_0x42aa29(0x9c1)]()-_0x5115b2['timestamp'])/(0x3e8*0x3c*0x3c);if(_0x8abf1d>0x3){_0x57e2f8=!![];const _0x43ebce=Math[_0x42aa29(0x7d5)](_0x8abf1d/0x18);_0x28fcd0+=_0x42aa29(0x29c)+(_0x43ebce>0x0?_0x43ebce+'天':Math[_0x42aa29(0x7d5)](_0x8abf1d)+'小时')+'。';}}else _0x28fcd0=_0x42aa29(0xf59);}const _0x239dde=await _0xa62efb[_0x42aa29(0x1257)][_0x42aa29(0xa73)]();let _0x1a796b='';_0x239dde['length']>0x0&&(_0x1a796b=_0x42aa29(0x69c),_0x239dde['forEach'](_0x2b90a9=>{const _0x2fed48=_0x42aa29;_0x1a796b+=_0x2fed48(0x924)+_0x2b90a9['id']+_0x2fed48(0x253)+_0x2b90a9['name']+_0x2fed48(0x1fb)+_0x2b90a9[_0x2fed48(0xbde)]['toFixed'](0x2)+'\x0a';}));let _0x46aae6=_0x40c514[_0x42aa29(0x3de)][_0x42aa29(0xcb4)](_0xf8c02b=>{const _0x418f0b=_0x42aa29,_0x708a77=_0x53d851[_0x418f0b(0xaa3)][_0xf8c02b['id']];let _0x506233='无共同好友';if(_0x708a77&&_0x708a77[_0x418f0b(0x608)]){const _0x155af4=Object[_0x418f0b(0x244)](_0x53d851[_0x418f0b(0xaa3)])[_0x418f0b(0x2dd)](_0x5aa817=>!_0x5aa817['isGroup']&&_0x5aa817['id']!==_0xf8c02b['id']&&_0x5aa817['groupId']===_0x708a77[_0x418f0b(0x608)]);_0x155af4['length']>0x0&&(_0x506233=_0x418f0b(0x143b)+_0x155af4['map'](_0x3c21f=>_0x3c21f[_0x418f0b(0x234)])[_0x418f0b(0x2c8)]('、\x20'));}return _0x418f0b(0x846)+_0xf8c02b[_0x418f0b(0x12bc)]+_0x418f0b(0x96e)+_0xf8c02b[_0x418f0b(0x543)]+_0x418f0b(0x1108)+_0xf8c02b[_0x418f0b(0x11fb)]+_0x418f0b(0xfb7)+_0x506233+']';})[_0x42aa29(0x2c8)]('\x0a');const _0x29ff3a=_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x1303)]||'我',_0x170f3e=_0x53d851[_0x42aa29(0xa74)]['nickname']||_0x42aa29(0x8ac);let _0x37ec14='';const _0xedf330=(_0x40c514[_0x42aa29(0x12db)]||[])[_0x42aa29(0x2dd)](_0x13e733=>_0x13e733[_0x42aa29(0x4d4)]);_0xedf330['length']>0x0&&(_0x37ec14+=_0x42aa29(0x130c),_0xedf330[_0x42aa29(0xeaf)](_0x1fe223=>{const _0x33a197=_0x42aa29,_0x2279f7=_0x40c514['history'][_0x33a197(0x397)](_0x16badb=>_0x16badb['timestamp']===_0x1fe223['messageTimestamp']);if(_0x2279f7){let _0x7deabb=String(_0x2279f7['content']||'');_0x2279f7[_0x33a197(0x919)]===_0x33a197(0x2a5)&&(_0x7deabb=_0x33a197(0x3f2)+_0x7deabb+']'),_0x37ec14+='-\x20公告内容:\x20\x22'+_0x7deabb+_0x33a197(0xb48)+_0x1fe223[_0x33a197(0x46e)]+_0x33a197(0xea5);}}),_0x37ec14+='---\x0a');const _0x5c1673=_0x40c514['members'][_0x42aa29(0xcb4)](_0x3c5d09=>_0x3c5d09[_0x42aa29(0x543)]),_0x4d6074='#\x20【【【群名修改铁律】】】\x0a在修改群名时，新的群名【绝对不能】与以下任何一个群成员的名字完全相同：['+_0x5c1673[_0x42aa29(0x2c8)]('、\x20')+']';let _0x1e4578=_0x42aa29(0x101a);_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x523)]&&_0x40c514['settings'][_0x42aa29(0x523)][_0x42aa29(0x29d)]>0x0?_0x1e4578+=_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x523)][_0x42aa29(0xcb4)](_0x58d7f0=>'-\x20'+_0x58d7f0[_0x42aa29(0x234)])[_0x42aa29(0x2c8)]('\x0a'):_0x1e4578+=_0x42aa29(0x12fd);const _0x5bb675=_0x187570(_0x1faca0),_0x421d0a=_0x32a9cb(_0x40c514,0x3,'hours'),_0x38f8e8=_0x32a9cb(_0x40c514,0x6,_0x42aa29(0x81f)),_0x5378de=_0x32a9cb(_0x40c514,0x9,'hours'),_0x37743b=_0x32a9cb(_0x40c514,0x1,_0x42aa29(0xc61)),_0x346c7a=_0x32a9cb(_0x40c514,0x3,_0x42aa29(0xc61)),_0x558253=_0x32a9cb(_0x40c514,0x7,_0x42aa29(0xc61));let _0x1b3aba='';if(_0x421d0a||_0x38f8e8||_0x5378de||_0x37743b||_0x346c7a||_0x558253){_0x1b3aba+=_0x42aa29(0x3fd);if(_0x421d0a)_0x1b3aba+=_0x421d0a;if(_0x38f8e8)_0x1b3aba+=_0x38f8e8;if(_0x5378de)_0x1b3aba+=_0x5378de;if(_0x421d0a||_0x38f8e8||_0x5378de)_0x1b3aba+='\x0a';if(_0x37743b)_0x1b3aba+=_0x37743b;if(_0x346c7a)_0x1b3aba+=_0x346c7a;if(_0x558253)_0x1b3aba+=_0x558253;}const _0x114a9e=_0x194105(_0x40c514);_0x245df9=_0x42aa29(0x123a)+_0x29ff3a+_0x42aa29(0xf58)+_0x170f3e+_0x42aa29(0x104c)+_0x29ff3a+_0x42aa29(0xe86)+_0x40c514['name']+'\x22\x20(群名)\x20的消息。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI或模型。严禁发展线下剧情。\x0a'+(_0x40c514['settings']['enableTimePerception']?_0x42aa29(0x1408)+_0x1ac2ca+_0x42aa29(0x10ca)+(_0x57e2f8?_0x42aa29(0x48b)+_0x28fcd0+_0x42aa29(0x1125):''):'')+_0x42aa29(0xaff)+(_0x5bb675?_0x42aa29(0x57a)+_0x5bb675:_0x42aa29(0xf2f))+_0x42aa29(0xb33)+_0x40c514[_0x42aa29(0x234)]+'\x0a'+(_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x558)]?_0x42aa29(0xd4f)+_0x28fcd0:'')+_0x42aa29(0x1376)+_0x46aae6+_0x42aa29(0x1447)+_0x29ff3a+'**:\x20'+_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0xab1)]+'\x0a\x0a#\x20世界观\x20(所有角色必须严格遵守)\x0a'+_0x1210f5+_0x42aa29(0xccf)+_0x5c69ea+'\x0a'+(_0x40c514[_0x42aa29(0x1016)]&&_0x40c514[_0x42aa29(0x1016)][_0x42aa29(0x29d)]>0x0?_0x40c514[_0x42aa29(0x1016)]['map'](_0x17fed5=>'-\x20'+_0x17fed5[_0x42aa29(0x73e)])[_0x42aa29(0x2c8)]('\x0a'):'-\x20(暂无)')+'\x0a'+_0x1b3aba+'\x0a'+_0x55b034+'\x0a'+_0x411989+'\x0a'+_0x4dae20+'\x0a'+_0x1e4578+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0x114a9e+'\x0a'+_0x4d6074+'\x0a'+_0x53b4e3+_0x42aa29(0xe43)+(localStorage[_0x42aa29(0xa14)](_0x42aa29(0xc18))===_0x42aa29(0x10cf)?'-\x20\x20\x20**NovelAI图片分享**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22name\x22:\x20\x22你的角色名\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20【禁止暴露这是novelai生成的图片!】\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20使用场景：当你想要基于当前对话情景、你的性格或上下文分享一张图片时使用。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。':'')+'\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发系统消息**:\x20`{\x22type\x22:\x20\x22system_message\x22,\x20\x22content\x22:\x20\x22系统文本\x22}`\x0a\x0a###\x20社交与互动\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22suffix\x22:\x20\x22(可选)\x22}`\x0a-\x20\x20\x20**@提及**:\x20在消息内容中使用\x20`@[[角色本名]]`\x20格式。\x0a-\x20\x20\x20**共享位置**:\x20`{\x22type\x22:\x20\x22location_share\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22位置名\x22}`\x0a\x0a###\x20群组管理\x0a-\x20\x20\x20**改群名**:\x20`{\x22type\x22:\x20\x22change_group_name\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22new_name\x22:\x20\x22新群名\x22}`\x0a-\x20\x20\x20**改群头像**:\x20`{\x22type\x22:\x20\x22change_group_avatar\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22avatar_name\x22:\x20\x22头像名\x22}`\x20(从头像库选)\x0a\x0a###\x20特殊功能与卡片\x0a-\x20\x20\x20**发起群视频**:\x20`{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}`\x0a-\x20\x20\x20**回应群视频**:\x20`{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22decision\x22:\x20\x22join\x22\x20or\x20\x22decline\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发拼手气红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22lucky\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x208.88,\x20\x22count\x22:\x205,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**发专属红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22direct\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x205.20,\x20\x22receiver\x22:\x20\x22接收者本名\x22,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**打开红包**:\x20`{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20红包时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2018}`\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22status\x22:\x20\x22paid\x22,\x20\x22for_timestamp\x22:\x20请求时间戳}`\x0a-\x20\x20\x20**发起投票**:\x20`{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22问题\x22,\x20\x22options\x22:\x20\x22选项A\x5cn选项B\x22}`\x0a-\x20\x20\x20**参与投票**:\x20`{\x22type\x22:\x20\x22vote\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22poll_timestamp\x22:\x20投票时间戳,\x20\x22choice\x22:\x20\x22选项文本\x22}`\x0a-\x20\x20\x20**送礼物\x20**:\x20\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送礼原因\x22,\x20\x22image_prompt\x22:\x20\x22礼物图片【英文】关键词\x22,\x20\x22recipients\x22:\x20[\x22收礼人本名A\x22,\x20\x22收礼人本名B\x22]}\x20`\x0a-\x20\x20\x20**为他人点外卖**:\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22name\x22:\x20\x22你的本名\x22,\x20\x22recipientName\x22:\x20\x22收礼者本名\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}`\x0a#\x20互动指南\x20(请严格遵守)\x0a-\x20\x20\x20**红包互动**:\x20抢红包后，你【必须】根据系统提示的结果（抢到多少钱、谁是手气王）发表符合人设的评论。\x0a-\x20\x20\x20**金额铁律**:\x20在发送红包或转账时，你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定金额。如果你的角色非常富有，你应该发送符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**音乐互动**:\x20【必须】围绕【用户的行为】进行评论。严禁将用户切歌等行为归因于其他AI成员。\x0a-\x20\x20\x20**外卖代付**:\x20仅当【你扮演的角色】想让【别人】付钱时才能发起。当订单被支付后，【绝对不能】再次支付。\x0a\x0a现在，请根据以上规则和下方的对话历史，继续这场群聊。',_0x6af879=_0x2d2668[_0x42aa29(0xcb4)](_0x1bcdb5=>{const _0x4eb6e9=_0x42aa29,_0x53429c=_0x1bcdb5['role']===_0x4eb6e9(0x10ae)?_0x29ff3a:_0x1bcdb5[_0x4eb6e9(0xbee)];let _0x4bdac2=''+_0x53429c;if(_0x1bcdb5[_0x4eb6e9(0x6a2)]){const _0x5225ef=String(_0x1bcdb5[_0x4eb6e9(0x6a2)][_0x4eb6e9(0x73e)]||'')[_0x4eb6e9(0xad6)](0x0,0x32);_0x4bdac2+=_0x4eb6e9(0x127b)+_0x1bcdb5[_0x4eb6e9(0x6a2)][_0x4eb6e9(0xbee)]+'\x20的消息:\x20\x22'+_0x5225ef+_0x4eb6e9(0x889);}_0x4bdac2+=':\x20';let _0x315be1;if(_0x1bcdb5[_0x4eb6e9(0x919)]==='user_photo')_0x315be1='['+_0x53429c+_0x4eb6e9(0xda6)+_0x1bcdb5[_0x4eb6e9(0x73e)]+'\x27]';else{if(_0x1bcdb5['type']===_0x4eb6e9(0x2a5))_0x315be1='['+_0x53429c+_0x4eb6e9(0xd6d)+_0x1bcdb5[_0x4eb6e9(0x73e)]+'\x27]';else{if(_0x1bcdb5['type']===_0x4eb6e9(0x357))_0x315be1='['+_0x53429c+_0x4eb6e9(0xbb2)+_0x1bcdb5[_0x4eb6e9(0x6d2)]+']';else{if(_0x1bcdb5[_0x4eb6e9(0x919)]===_0x4eb6e9(0x64f))_0x315be1='['+_0x53429c+_0x4eb6e9(0xb01)+_0x1bcdb5[_0x4eb6e9(0x73e)]+'\x27]';else{if(_0x1bcdb5[_0x4eb6e9(0x919)]===_0x4eb6e9(0x566))_0x315be1='['+_0x1bcdb5[_0x4eb6e9(0xbee)]+_0x4eb6e9(0xfe1)+_0x1bcdb5['receiverName']+_0x4eb6e9(0x71d)+_0x1bcdb5[_0x4eb6e9(0x1146)]+_0x4eb6e9(0xd3d)+_0x1bcdb5['note']+']';else{if(_0x1bcdb5[_0x4eb6e9(0x919)]==='location_share')_0x315be1='['+_0x53429c+_0x4eb6e9(0xc6f)+_0x1bcdb5['content']+'\x27]';else{if(_0x1bcdb5[_0x4eb6e9(0x919)]===_0x4eb6e9(0x784)){const _0x4a5996=_0x1bcdb5[_0x4eb6e9(0x113c)]?_0x4eb6e9(0x82e)+_0x1bcdb5[_0x4eb6e9(0x113c)]+'”':'';let _0x4bbd27='原作者';const _0x29002f=_0x1bcdb5[_0x4eb6e9(0x43c)][_0x4eb6e9(0xa59)];if(_0x29002f===_0x4eb6e9(0x10ae))_0x4bbd27=_0x53d851[_0x4eb6e9(0xa74)]['nickname'];else _0x53d851[_0x4eb6e9(0xaa3)][_0x29002f]&&(_0x4bbd27=_0x53d851[_0x4eb6e9(0xaa3)][_0x29002f][_0x4eb6e9(0x234)]);let _0x23cd55;const _0x5d8df8=_0x1bcdb5['originalPost'];if(_0x5d8df8[_0x4eb6e9(0x919)]==='text_image')_0x23cd55='[文字图]\x20'+(_0x5d8df8[_0x4eb6e9(0x678)]||'')+_0x4eb6e9(0xd1a)+(_0x5d8df8[_0x4eb6e9(0x319)]||'')[_0x4eb6e9(0xad6)](0x0,0x28)+_0x4eb6e9(0x118e);else _0x5d8df8[_0x4eb6e9(0x919)]===_0x4eb6e9(0x1242)?_0x23cd55=_0x4eb6e9(0xd9a)+(_0x5d8df8[_0x4eb6e9(0x678)]||'')+_0x4eb6e9(0xd1a)+(_0x5d8df8['imageDescription']||'')[_0x4eb6e9(0xad6)](0x0,0x28)+_0x4eb6e9(0x118e):_0x23cd55='“'+(_0x5d8df8['content']||'')[_0x4eb6e9(0xad6)](0x0,0x28)+_0x4eb6e9(0x124f);_0x315be1='['+_0x53429c+_0x4eb6e9(0xc0e)+_0x4bbd27+_0x4eb6e9(0x1321)+_0x4a5996+'【原动态内容:\x20'+_0x23cd55+'】]';}else{if(_0x1bcdb5[_0x4eb6e9(0x919)]==='waimai_request')_0x1bcdb5[_0x4eb6e9(0x12d3)]===_0x4eb6e9(0x2ea)?_0x315be1=_0x4eb6e9(0xd06)+_0x1bcdb5['paidBy']+_0x4eb6e9(0x144a)+_0x53429c+'\x20的外卖订单支付了\x20'+_0x1bcdb5[_0x4eb6e9(0x1146)]+_0x4eb6e9(0x3c4):_0x315be1='['+_0x53429c+_0x4eb6e9(0x604)+_0x1bcdb5[_0x4eb6e9(0x13ce)]+_0x4eb6e9(0xfbe)+_0x1bcdb5[_0x4eb6e9(0x1146)]+_0x4eb6e9(0xce6)+_0x1bcdb5[_0x4eb6e9(0x827)]+']';else{if(_0x1bcdb5[_0x4eb6e9(0x919)]===_0x4eb6e9(0x10a0)){const _0x57e203=_0x1bcdb5['senderName']===_0x29ff3a?_0x4eb6e9(0x7a1)+_0x29ff3a+')':_0x1bcdb5[_0x4eb6e9(0xbee)];let _0x1ef712;_0x1bcdb5['packetType']===_0x4eb6e9(0x985)?_0x1ef712=_0x4eb6e9(0xd06)+_0x57e203+'\x20发送了一个【专属红包】(时间戳:\x20'+_0x1bcdb5[_0x4eb6e9(0x827)]+_0x4eb6e9(0x207)+_0x1bcdb5[_0x4eb6e9(0x44a)]+_0x4eb6e9(0x1433)+_0x1bcdb5[_0x4eb6e9(0x44a)]+_0x4eb6e9(0x1344):_0x1ef712=_0x4eb6e9(0xd06)+_0x57e203+'\x20发送了一个【拼手气红包】(时间戳:\x20'+_0x1bcdb5['timestamp']+_0x4eb6e9(0xada)+_0x1bcdb5[_0x4eb6e9(0xfa8)]+_0x4eb6e9(0x3d1),_0x315be1=_0x1ef712;}else{if(_0x1bcdb5[_0x4eb6e9(0x919)]===_0x4eb6e9(0x205)){const _0x114576=_0x1bcdb5[_0x4eb6e9(0xb4d)]===_0x4eb6e9(0x10ae)?_0x29ff3a:_0xf33fb2(_0x40c514,_0x1bcdb5[_0x4eb6e9(0xbee)]),_0x32d8dc=_0x1bcdb5['items'][_0x4eb6e9(0xcb4)](_0x5c200c=>_0x5c200c[_0x4eb6e9(0x234)]+'\x20x'+_0x5c200c[_0x4eb6e9(0xc26)])[_0x4eb6e9(0x2c8)]('、\x20');let _0x1edb73='';if(_0x1bcdb5[_0x4eb6e9(0x134c)]&&_0x1bcdb5['recipients'][_0x4eb6e9(0x29d)]>0x0){const _0x5399e0=_0x1bcdb5[_0x4eb6e9(0x134c)][_0x4eb6e9(0xcb4)](_0x40047b=>_0xf33fb2(_0x40c514,_0x40047b))[_0x4eb6e9(0x2c8)]('、\x20');_0x1edb73=_0x4eb6e9(0xef9)+_0x5399e0;}else _0x1edb73=_0x4eb6e9(0xe32);return _0x315be1=_0x4eb6e9(0xd06)+_0x114576+'\x20'+_0x1edb73+_0x4eb6e9(0x93d)+_0x32d8dc+']',{'role':_0x4eb6e9(0x10ae),'content':_0x315be1};}else{if(_0x1bcdb5[_0x4eb6e9(0x919)]===_0x4eb6e9(0xf2e)){const _0x351865=Object[_0x4eb6e9(0x244)](_0x1bcdb5[_0x4eb6e9(0x771)]||{})[_0x4eb6e9(0xd75)]()[_0x4eb6e9(0x2c8)](',\x20')||'还没有人';_0x315be1=_0x4eb6e9(0xd06)+_0x1bcdb5[_0x4eb6e9(0xbee)]+_0x4eb6e9(0x2fb)+_0x1bcdb5[_0x4eb6e9(0x827)]+_0x4eb6e9(0x788)+_0x1bcdb5[_0x4eb6e9(0xd1d)]+'”，选项有：['+_0x1bcdb5[_0x4eb6e9(0x473)][_0x4eb6e9(0x2c8)](',\x20')+']。目前投票的人有：'+_0x351865+_0x4eb6e9(0xfb6);}else{if(_0x1bcdb5[_0x4eb6e9(0x75f)])_0x315be1=_0x53429c+_0x4eb6e9(0x43d)+_0x1bcdb5[_0x4eb6e9(0x75f)]+'\x27]';else{if(Array[_0x4eb6e9(0xb31)](_0x1bcdb5['content']))return{'role':_0x4eb6e9(0x10ae),'content':[..._0x1bcdb5['content'],{'type':_0x4eb6e9(0x2e6),'text':_0x4bdac2}]};else _0x315be1=''+_0x4bdac2+_0x1bcdb5[_0x4eb6e9(0x73e)];}}}}}}}}}}}}return{'role':'user','content':_0x315be1};})['filter'](Boolean);}else{const _0x10ae5d=_0x40c514[_0x42aa29(0x81e)]['isOfflineMode'],_0x4f5b56=_0x25c7bd(_0x40c514);let _0x407fc3='';_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0xe12)]&&_0x40c514[_0x42aa29(0x13cb)]&&!_0x10ae5d&&(_0x407fc3='\x0a#\x20你的内心独白\x20(上一轮的思考，仅你自己可见)\x0a-\x20心声:\x20'+_0x40c514[_0x42aa29(0x13cb)]+'\x0a-\x20散记:\x20'+_0x40c514[_0x42aa29(0xc35)]+'\x0a');let _0x58734a='';const _0x2f633a=_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x90d)]||0xa;if(_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x278)]&&_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x278)][_0x42aa29(0x29d)]>0x0){const _0x5d7dbe=_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x278)][_0x42aa29(0x2dd)](_0xa72eaf=>_0xa72eaf!==_0x1faca0);if(_0x5d7dbe['length']>0x0){const _0x2d8ae3=_0x5d7dbe[_0x42aa29(0xcb4)](_0x3b606b=>{const _0x13fab8=_0x42aa29,_0x13d62d=_0x53d851[_0x13fab8(0xaa3)][_0x3b606b];if(!_0x13d62d)return null;const _0x56b5d1=_0x13d62d[_0x13fab8(0xe83)][_0x13fab8(0x1340)](-0x1)[0x0];return{'chat':_0x13d62d,'latestTimestamp':_0x56b5d1?_0x56b5d1[_0x13fab8(0x827)]:0x0};})['filter'](Boolean);_0x2d8ae3[_0x42aa29(0xdb0)]((_0x5a84f5,_0x4d862b)=>_0x4d862b[_0x42aa29(0x616)]-_0x5a84f5[_0x42aa29(0x616)]),_0x58734a+=_0x42aa29(0x58c);for(const _0xe3681d of _0x2d8ae3){const _0x4c5eca=_0xe3681d[_0x42aa29(0x2d8)],_0x5d6b97=_0x4c5eca[_0x42aa29(0x86e)]?_0x42aa29(0xbf8):_0x42aa29(0x829),_0x52bd91=_0xe3681d[_0x42aa29(0x616)]>0x0?_0x42aa29(0x125e)+_0x272f9c(_0xe3681d['latestTimestamp'])+')':'';_0x58734a+=_0x42aa29(0x129a)+_0x5d6b97+'“'+_0x4c5eca['name']+_0x42aa29(0x8d5)+_0x52bd91+'\x20---\x0a';const _0x1121d8=_0x4c5eca[_0x42aa29(0xe83)]['slice'](-_0x2f633a),_0xb14c51=_0x1121d8[_0x42aa29(0x2dd)](_0x530cd5=>!String(_0x530cd5[_0x42aa29(0x73e)])[_0x42aa29(0x6e9)](_0x42aa29(0x138c)));_0xb14c51[_0x42aa29(0x29d)]>0x0?_0xb14c51[_0x42aa29(0xeaf)](_0xbda2f0=>{const _0x5a3cc5=_0x42aa29,_0x2c2966=_0xbda2f0['role']===_0x5a3cc5(0x10ae)?_0x4c5eca[_0x5a3cc5(0x81e)][_0x5a3cc5(0x1303)]||'我':_0xbda2f0[_0x5a3cc5(0xbee)]||_0x4c5eca[_0x5a3cc5(0x234)];let _0x164242=String(_0xbda2f0[_0x5a3cc5(0x73e)]);if(_0xbda2f0[_0x5a3cc5(0x919)]===_0x5a3cc5(0x2a5)||_0xbda2f0[_0x5a3cc5(0x919)]===_0x5a3cc5(0x1053))_0x164242='[发送了一张图片，描述为：'+_0xbda2f0[_0x5a3cc5(0x73e)]+']';else _0xbda2f0[_0x5a3cc5(0x919)]==='voice_message'&&(_0x164242=_0x5a3cc5(0xd11)+_0xbda2f0['content']+']');const _0x311364=_0x272f9c(_0xbda2f0[_0x5a3cc5(0x827)]);_0x58734a+='('+_0x311364+')\x20'+_0x2c2966+':\x20'+_0x164242+'\x0a';}):_0x58734a+=_0x42aa29(0xa51);}}}const _0x7d93ae=await _0xa62efb[_0x42aa29(0x1257)][_0x42aa29(0xa73)]();let _0x4e27ba='';_0x7d93ae['length']>0x0&&(_0x4e27ba=_0x42aa29(0x8fd),_0x7d93ae[_0x42aa29(0xeaf)](_0x222fca=>{const _0x45ec49=_0x42aa29;_0x4e27ba+=_0x45ec49(0x924)+_0x222fca['id']+_0x45ec49(0x253)+_0x222fca[_0x45ec49(0x234)]+_0x45ec49(0x1fb)+_0x222fca['price']['toFixed'](0x2)+'\x0a';}));if(_0x10ae5d){const _0x3f8a03=_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x804)]||0x64,_0x74c283=_0x40c514[_0x42aa29(0x81e)]['offlineMaxLength']||0x12c,_0x1bbeb4=_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x1303)]||'我';let _0x17709d='';if(_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x9e4)]){const _0x455eca=_0x53d851[_0x42aa29(0x13b8)][_0x42aa29(0x397)](_0x1cbef4=>_0x1cbef4['id']===_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x9e4)]);if(_0x455eca&&Array[_0x42aa29(0xb31)](_0x455eca[_0x42aa29(0x73e)])){const _0x1a39a=_0x455eca['content']['filter'](_0xbe8400=>_0xbe8400[_0x42aa29(0xb3d)]!==![])[_0x42aa29(0xcb4)](_0x13f2c2=>'-\x20'+_0x13f2c2[_0x42aa29(0x73e)])[_0x42aa29(0x2c8)]('\x0a');_0x1a39a&&(_0x17709d='\x0a#\x20【写作风格铁律\x20(最高优先级)】\x0a你【必须】严格遵守以下“预设”中的所有规则和风格来描写。它的优先级高于你的基础人设。\x0a---\x0a'+_0x1a39a+'\x0a---\x0a');}}_0x245df9=_0x42aa29(0x106a)+_0x40c514[_0x42aa29(0x543)]+_0x42aa29(0x1400)+_0x17709d+_0x42aa29(0x1411)+_0x40c514[_0x42aa29(0x81e)]['aiPersona']+_0x42aa29(0x13e5)+_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0xab1)]+'\x0a\x0a#\x20供你参考的信息\x0a'+(_0x40c514['settings'][_0x42aa29(0x558)]?'-\x20**当前时间**:\x20'+_0x1ac2ca+'\x20('+_0x17ad73+')':'')+_0x42aa29(0x500)+_0x1210f5+_0x42aa29(0x1106)+(_0x40c514['longTermMemory']&&_0x40c514[_0x42aa29(0x1016)][_0x42aa29(0x29d)]>0x0?_0x40c514[_0x42aa29(0x1016)]['map'](_0x2fb83b=>'-\x20'+_0x2fb83b[_0x42aa29(0x73e)])[_0x42aa29(0x2c8)]('\x0a'):_0x42aa29(0xddc))+'\x0a\x0a'+_0x58734a+_0x42aa29(0x86b)+_0x2d2668[_0x42aa29(0xcb4)](_0x5521cf=>{const _0x5ee154=_0x42aa29;let _0x531bf7=(_0x5521cf[_0x5ee154(0xb4d)]===_0x5ee154(0x10ae)?_0x1bbeb4:_0x40c514[_0x5ee154(0x234)])+':\x20';return _0x5521cf['type']===_0x5ee154(0x8c3)?_0x531bf7+='「'+(_0x5521cf[_0x5ee154(0x1266)]||'')+'」\x20'+(_0x5521cf[_0x5ee154(0xa60)]||''):_0x531bf7+=String(_0x5521cf['content']),_0x531bf7;})[_0x42aa29(0x2c8)]('\x0a')+'\x0a\x0a\x0a\x20#\x20【格式铁律\x20(最高优先级)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【永远只能包含一个】元素，格式如下:\x0a\x20\x20\x20\x20`[{\x22type\x22:\x20\x22offline_text\x22,\x20\x22content\x22:\x20\x22在这里写入你创作的、混合了对话和描写的完整段落。\x22}]`\x0a2.\x20\x20**【内容风格】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由地将对话穿插在描写的任何位置，实现自然分段。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a3.\x20\x20**【禁止】**:\x20绝对禁止在\x20`content`\x20字段中出现\x20\x22dialogue\x22\x20或\x20\x22description\x22\x20这两个词。\x0a\x0a#\x20【其他核心规则】\x0a1.\x20\x20**叙事视角**:\x20叙述人称【必须】严格遵循“预设”中的第一人称、第二人称或第三人称规定。\x0a2.\x20\x20**字数要求**:\x20你生成的\x20`content`\x20总内容应在\x20**'+_0x3f8a03+'到'+_0x74c283+'字**\x20之间。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI、模型，或提及“扮演”、“生成”等词语。\x0a\x0a\x0a\x0a现在，请根据以上所有规则和对话历史，继续这场线下互动。\x0a',_0x6af879=_0x2d2668[_0x42aa29(0xcb4)](_0x1410a0=>{const _0x1c5ef4=_0x42aa29;if(_0x1410a0[_0x1c5ef4(0x1032)])return null;if(_0x1410a0[_0x1c5ef4(0x919)]==='offline_text'){const _0x463102=_0x1410a0[_0x1c5ef4(0xb4d)]===_0x1c5ef4(0x10ae)?_0x40c514[_0x1c5ef4(0x81e)][_0x1c5ef4(0x1303)]||'我':_0x40c514['name'];let _0x287f6e='';if(_0x1410a0[_0x1c5ef4(0x73e)])_0x287f6e=_0x1410a0[_0x1c5ef4(0x73e)];else{const _0x471f36=_0x1410a0[_0x1c5ef4(0x1266)]?'「'+_0x1410a0[_0x1c5ef4(0x1266)]+'」':'',_0x5b0717=_0x1410a0[_0x1c5ef4(0xa60)]?'('+_0x1410a0[_0x1c5ef4(0xa60)]+')':'';_0x287f6e=(_0x471f36+'\x20'+_0x5b0717)[_0x1c5ef4(0x13bc)]();}return{'role':_0x1410a0['role'],'content':_0x463102+':\x20'+_0x287f6e};}if(_0x1410a0[_0x1c5ef4(0xb4d)]===_0x1c5ef4(0x10ae)){const _0x351f88=_0x1bbeb4+':\x20';let _0x5b35e0='';if(Array['isArray'](_0x1410a0[_0x1c5ef4(0x73e)])&&_0x1410a0['content'][0x0]?.['type']===_0x1c5ef4(0xc40))return{'role':_0x1c5ef4(0x10ae),'content':[{'type':_0x1c5ef4(0x2e6),'text':_0x351f88},..._0x1410a0[_0x1c5ef4(0x73e)]]};if(_0x1410a0[_0x1c5ef4(0x6a2)]){const _0x102064=String(_0x1410a0['quote'][_0x1c5ef4(0x73e)]||'')[_0x1c5ef4(0xad6)](0x0,0x32);_0x5b35e0+=_0x1c5ef4(0x1135)+_0x1410a0['quote'][_0x1c5ef4(0xbee)]+'\x20的消息:\x20\x22'+_0x102064+_0x1c5ef4(0x100e)+_0x1410a0[_0x1c5ef4(0x73e)];}else _0x5b35e0+=_0x1410a0[_0x1c5ef4(0x73e)];if(_0x1410a0[_0x1c5ef4(0x919)]===_0x1c5ef4(0x1053))return{'role':_0x1c5ef4(0x10ae),'content':_0x351f88+'[你发送了一张需要AI识别的图片，图片内容是：\x27'+_0x1410a0[_0x1c5ef4(0x73e)]+'\x27]'};if(_0x1410a0[_0x1c5ef4(0x919)]===_0x1c5ef4(0x64f))return{'role':'user','content':_0x351f88+'[你发送了一条语音消息，内容是：\x27'+_0x1410a0['content']+'\x27]'};if(_0x1410a0[_0x1c5ef4(0x919)]==='transfer')return{'role':_0x1c5ef4(0x10ae),'content':_0x351f88+_0x1c5ef4(0x328)+_0x1410a0[_0x1c5ef4(0x827)]+_0x1c5ef4(0x1ee)+_0x1410a0[_0x1c5ef4(0x1146)]+_0x1c5ef4(0xd3d)+_0x1410a0[_0x1c5ef4(0xbb0)]+'。等待对方处理。]'};if(_0x1410a0[_0x1c5ef4(0x919)]===_0x1c5ef4(0x1206))return{'role':_0x1c5ef4(0x10ae),'content':_0x351f88+'[系统提示：你于时间戳\x20'+_0x1410a0[_0x1c5ef4(0x827)]+_0x1c5ef4(0x604)+_0x1410a0['productInfo']+_0x1c5ef4(0xfbe)+_0x1410a0[_0x1c5ef4(0x1146)]+_0x1c5ef4(0xad9)};else{if(_0x1410a0['type']===_0x1c5ef4(0x205)){const _0xaabd90=_0x1410a0[_0x1c5ef4(0xa27)]['map'](_0x1de5b9=>_0x1de5b9['name']+'\x20x'+_0x1de5b9[_0x1c5ef4(0xc26)])[_0x1c5ef4(0x2c8)]('、\x20');let _0x1f78b4=_0x40c514[_0x1c5ef4(0x86e)]?_0x1c5ef4(0xef9)+_0x1410a0[_0x1c5ef4(0x134c)][_0x1c5ef4(0xcb4)](_0x1e639d=>_0xf33fb2(_0x40c514,_0x1e639d))[_0x1c5ef4(0x2c8)]('、\x20'):_0x1c5ef4(0xef9)+_0x40c514[_0x1c5ef4(0x234)];return{'role':'user','content':_0x351f88+'[系统提示：你\x20'+_0x1f78b4+_0x1c5ef4(0x93d)+_0xaabd90+']'};}}if(_0x1410a0[_0x1c5ef4(0x75f)])return{'role':_0x1c5ef4(0x10ae),'content':_0x351f88+_0x1c5ef4(0xa54)+_0x1410a0[_0x1c5ef4(0x75f)]+'\x27]'};return{'role':_0x1410a0['role'],'content':_0x351f88+_0x5b35e0};}else{if(_0x1410a0[_0x1c5ef4(0xb4d)]==='assistant'){let _0x2f288d={'type':_0x1410a0[_0x1c5ef4(0x919)]||_0x1c5ef4(0x2e6)};if(_0x1410a0['type']===_0x1c5ef4(0x257))_0x2f288d[_0x1c5ef4(0xb36)]=_0x1410a0[_0x1c5ef4(0x73e)],_0x2f288d['meaning']=_0x1410a0['meaning'];else{if(_0x1410a0[_0x1c5ef4(0x919)]===_0x1c5ef4(0x566))_0x2f288d['amount']=_0x1410a0[_0x1c5ef4(0x1146)],_0x2f288d[_0x1c5ef4(0xbb0)]=_0x1410a0[_0x1c5ef4(0xbb0)];else _0x1410a0[_0x1c5ef4(0x919)]===_0x1c5ef4(0x1206)?(_0x2f288d['productInfo']=_0x1410a0[_0x1c5ef4(0x13ce)],_0x2f288d[_0x1c5ef4(0x1146)]=_0x1410a0[_0x1c5ef4(0x1146)]):_0x1410a0['quote']?_0x2f288d[_0x1c5ef4(0x765)]={'target_sender':_0x1410a0[_0x1c5ef4(0x6a2)][_0x1c5ef4(0xbee)],'target_content':_0x1410a0[_0x1c5ef4(0x6a2)][_0x1c5ef4(0x73e)],'reply_content':_0x1410a0['content']}:_0x2f288d[_0x1c5ef4(0x73e)]=_0x1410a0[_0x1c5ef4(0x73e)];}const _0x4c2c19=JSON[_0x1c5ef4(0xe1e)]([_0x2f288d]);return{'role':_0x1c5ef4(0xac5),'content':_0x1c5ef4(0xac0)+_0x1410a0[_0x1c5ef4(0x827)]+')\x20'+_0x4c2c19};}}return null;})[_0x42aa29(0x2dd)](Boolean);}else{let _0x30a040='';_0x40c514[_0x42aa29(0x12ed)]&&_0x40c514[_0x42aa29(0x12ed)][_0x42aa29(0x29d)]>0x0&&(_0x30a040=_0x42aa29(0x671)+_0x40c514[_0x42aa29(0x12ed)][_0x42aa29(0x2c8)](',\x20')+']。当在对话历史中看到这些名字时，它们都指的是【你】自己。');let _0x3a0970='';const _0x5f23ab=_0x53d851[_0x42aa29(0xa74)][_0x42aa29(0x1005)]||'用户';_0x3a0970+=_0x42aa29(0xd30)+_0x5f23ab+_0x42aa29(0x7e7);const _0x5215e7=Object[_0x42aa29(0x244)](_0x53d851['chats']),_0x4ea573=_0x5215e7[_0x42aa29(0x2dd)](_0x4b4b27=>_0x4b4b27[_0x42aa29(0x86e)]&&_0x4b4b27[_0x42aa29(0x3de)][_0x42aa29(0xe0f)](_0x414585=>_0x414585['id']===_0x40c514['id']));_0x4ea573['length']>0x0&&(_0x3a0970+=_0x42aa29(0x1357),_0x4ea573[_0x42aa29(0xeaf)](_0x2de4fb=>{const _0xeec0cf=_0x42aa29,_0x44f20b=_0x2de4fb[_0xeec0cf(0x81e)][_0xeec0cf(0x1303)]||_0x5f23ab;_0x3a0970+=_0xeec0cf(0x86d)+_0x2de4fb[_0xeec0cf(0x234)]+_0xeec0cf(0xdae)+_0x44f20b+'”。\x0a';}));_0x3a0970+=_0x42aa29(0xf23);let _0x27fcac='';const _0x4dfcb2=_0x5215e7[_0x42aa29(0x2dd)](_0xadb129=>!_0xadb129['isGroup']&&_0xadb129['id']!==_0x40c514['id']&&_0xadb129[_0x42aa29(0x608)]===_0x40c514[_0x42aa29(0x608)]&&_0x40c514[_0x42aa29(0x608)]!==null);_0x4dfcb2[_0x42aa29(0x29d)]>0x0&&(_0x27fcac+=_0x42aa29(0xcf3),_0x4dfcb2[_0x42aa29(0xeaf)](_0x384ebb=>{const _0x2ce14d=_0x42aa29;_0x27fcac+=_0x2ce14d(0xdf4)+_0x384ebb[_0x2ce14d(0x234)]+_0x2ce14d(0x96e)+_0x384ebb[_0x2ce14d(0x543)]+')\x0a';}));const _0x30fc01=await _0xa62efb[_0x42aa29(0xfc2)][_0x42aa29(0x1064)]('timestamp')['reverse']()['limit'](0xa)['toArray'](),_0x4bf44d=_0xd757d6(_0x30fc01,_0x40c514);let _0x430bd7='';if(_0x4bf44d[_0x42aa29(0x29d)]>0x0){_0x430bd7=_0x42aa29(0x5b6);const _0x112edb=_0x40c514[_0x42aa29(0x543)];for(const _0x49b2e5 of _0x4bf44d){let _0x15e364;if(_0x49b2e5[_0x42aa29(0xa59)]===_0x42aa29(0x10ae))_0x15e364=_0x53d851[_0x42aa29(0xa74)][_0x42aa29(0x1005)];else{if(String(_0x49b2e5[_0x42aa29(0xa59)])['startsWith'](_0x42aa29(0xc78)))_0x15e364=_0x49b2e5[_0x42aa29(0xd2f)]||_0x42aa29(0x627);else{const _0x5e3696=_0x53d851[_0x42aa29(0xaa3)][_0x49b2e5[_0x42aa29(0xa59)]];_0x15e364=_0x5e3696?_0x5e3696[_0x42aa29(0x234)]:_0x42aa29(0x548);}}if(_0x49b2e5[_0x42aa29(0xa59)]===_0x1faca0)_0x15e364+=_0x42aa29(0x9ef);let _0x31ac99;if(_0x49b2e5[_0x42aa29(0x919)]==='repost'){const _0x2a75f2=_0x49b2e5[_0x42aa29(0x113c)]?_0x42aa29(0xb95)+_0x49b2e5[_0x42aa29(0x113c)]+'\x22':'';let _0x3d1aa6=_0x42aa29(0x101d);const _0x497222=_0x49b2e5[_0x42aa29(0x43c)][_0x42aa29(0xa59)];if(_0x497222==='user')_0x3d1aa6=_0x53d851[_0x42aa29(0xa74)][_0x42aa29(0x1005)];else _0x53d851[_0x42aa29(0xaa3)][_0x497222]&&(_0x3d1aa6=_0x53d851[_0x42aa29(0xaa3)][_0x497222][_0x42aa29(0x234)]);let _0x4e5c48;const _0x49b340=_0x49b2e5[_0x42aa29(0x43c)];if(_0x49b340[_0x42aa29(0x919)]===_0x42aa29(0xa9a))_0x4e5c48=_0x42aa29(0xa11)+(_0x49b340[_0x42aa29(0x678)]||'')+_0x42aa29(0x6be)+(_0x49b340[_0x42aa29(0x319)]||'')[_0x42aa29(0xad6)](0x0,0x28)+_0x42aa29(0x889);else _0x49b340['type']===_0x42aa29(0x1242)?_0x4e5c48=_0x42aa29(0xd9a)+(_0x49b340[_0x42aa29(0x678)]||'')+_0x42aa29(0x6be)+(_0x49b340[_0x42aa29(0x465)]||'')[_0x42aa29(0xad6)](0x0,0x28)+_0x42aa29(0x889):_0x4e5c48='\x22'+(_0x49b340[_0x42aa29(0x73e)]||'')[_0x42aa29(0xad6)](0x0,0x28)+'...\x22';_0x31ac99=_0x42aa29(0x2c0)+_0x3d1aa6+'\x20的动态\x20'+_0x2a75f2+_0x42aa29(0x4a8)+_0x4e5c48+'】';}else{if(_0x49b2e5['type']==='text_image')_0x31ac99=(_0x42aa29(0x61e)+_0x49b2e5[_0x42aa29(0x319)]+_0x42aa29(0xf61)+(_0x49b2e5[_0x42aa29(0x678)]||''))[_0x42aa29(0xad6)](0x0,0x32)+_0x42aa29(0x95d);else{if(_0x49b2e5[_0x42aa29(0x919)]==='image_post')_0x31ac99=(_0x42aa29(0x107f)+_0x49b2e5['imageDescription']+_0x42aa29(0xf61)+(_0x49b2e5[_0x42aa29(0x678)]||''))[_0x42aa29(0xad6)](0x0,0x32)+_0x42aa29(0x95d);else{if(_0x49b2e5[_0x42aa29(0x919)]==='naiimag'&&_0x49b2e5[_0x42aa29(0x6d2)]){const _0x343857=Array['isArray'](_0x49b2e5[_0x42aa29(0x6d2)])?_0x49b2e5[_0x42aa29(0x6d2)]:[_0x49b2e5[_0x42aa29(0x6d2)]];_0x31ac99=(_0x49b2e5['publicText']||'')+(_0x42aa29(0xc0f)+_0x343857[_0x42aa29(0x29d)]+_0x42aa29(0xdf0)+_0x343857[_0x42aa29(0x2c8)](',\x20')+']');}else _0x31ac99=String(_0x49b2e5[_0x42aa29(0x678)]||_0x49b2e5[_0x42aa29(0x73e)]||_0x42aa29(0x10ff))['substring'](0x0,0x32)+_0x42aa29(0x95d);}}}_0x430bd7+=_0x42aa29(0x924)+_0x49b2e5['id']+_0x42aa29(0x79f)+_0x15e364+_0x42aa29(0x9db)+_0x31ac99+'\x22\x0a';if(_0x49b2e5[_0x42aa29(0x11ed)]&&_0x49b2e5['comments'][_0x42aa29(0x29d)]>0x0)for(const _0x277576 of _0x49b2e5[_0x42aa29(0x11ed)]){if(typeof _0x277576==='object'&&_0x277576[_0x42aa29(0x3a7)]){const _0x491b49=_0x4b300d(_0x277576[_0x42aa29(0x3a7)]);let _0x501b50=_0x277576[_0x42aa29(0x75f)]?_0x42aa29(0x13d4)+_0x277576[_0x42aa29(0x75f)]+'\x27]':_0x277576[_0x42aa29(0x2e6)];_0x277576[_0x42aa29(0x3a7)]===_0x112edb?_0x430bd7+=_0x42aa29(0x1404)+_0x501b50+'\x0a':_0x430bd7+=_0x42aa29(0xcf9)+_0x491b49+_0x42aa29(0xdb3)+_0x277576[_0x42aa29(0x3a7)]+_0x42aa29(0x1108)+_0x501b50+'\x0a';}}}}const _0x24c57e=_0x40c514[_0x42aa29(0x81e)]['myNickname']||'我';let _0xefc14d='',_0x47f287=![];if(_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x558)]){const _0x162f60=_0x2d2668[_0x42aa29(0x12a2)](_0x385cd8=>_0x385cd8[_0x42aa29(0xb4d)]==='user'&&!_0x385cd8[_0x42aa29(0x1032)]),_0x580871=_0x2d2668[_0x42aa29(0x12a2)](_0x28e124=>_0x28e124[_0x42aa29(0xb4d)]==='assistant'&&!_0x28e124[_0x42aa29(0x1032)]);if(_0x162f60){const _0xeb7df6=_0x4e608d(_0x162f60[_0x42aa29(0x827)]);if(_0x580871){const _0xcff2ca=_0x4e608d(_0x580871[_0x42aa29(0x827)]);_0xefc14d=_0x42aa29(0x1415)+_0xcff2ca+'，用户刚刚在\x20'+_0xeb7df6+_0x42aa29(0x13f0);const _0x21f3ff=(_0x162f60[_0x42aa29(0x827)]-_0x580871[_0x42aa29(0x827)])/(0x3e8*0x3c*0x3c);if(_0x21f3ff>0x3){_0x47f287=!![];const _0x334998=Math['floor'](_0x21f3ff/0x18);_0xefc14d+=_0x42aa29(0xd72)+(_0x334998>0x0?_0x334998+'天':Math[_0x42aa29(0x7d5)](_0x21f3ff)+'小时')+'**没有聊天了。\x0a-\x20**行为铁律**:\x20你的首要任务是【回应这个时间差】。你【绝对不能】直接延续上一段对话的话题（比如昨天的饭菜）。\x0a-\x20**你的行动**:你【必须】主动开启一个全新的、符合当前时间（'+_0x17ad73+_0x42aa29(0xbff);}}else _0xefc14d=_0x42aa29(0x893)+_0xeb7df6+'。';}else _0xefc14d=_0x42aa29(0x52f);}const _0x5e9381=_0x187570(_0x1faca0),_0xf1bda7=_0x32a9cb(_0x40c514,0x3,_0x42aa29(0x81f)),_0x15136c=_0x32a9cb(_0x40c514,0x6,'hours'),_0xd12c4=_0x32a9cb(_0x40c514,0x9,_0x42aa29(0x81f)),_0x111166=_0x32a9cb(_0x40c514,0x1,_0x42aa29(0xc61)),_0xa5b496=_0x32a9cb(_0x40c514,0x3,_0x42aa29(0xc61)),_0x50f41d=_0x32a9cb(_0x40c514,0x7,'days');let _0x2389f5='';if(_0xf1bda7||_0x15136c||_0xd12c4||_0x111166||_0xa5b496||_0x50f41d){_0x2389f5+=_0x42aa29(0xb9a);if(_0xf1bda7)_0x2389f5+=_0xf1bda7;if(_0x15136c)_0x2389f5+=_0x15136c;if(_0xd12c4)_0x2389f5+=_0xd12c4;if(_0xf1bda7||_0x15136c||_0xd12c4)_0x2389f5+='\x0a';if(_0x111166)_0x2389f5+=_0x111166;if(_0xa5b496)_0x2389f5+=_0xa5b496;if(_0x50f41d)_0x2389f5+=_0x50f41d;}_0x245df9='\x0a#\x20身份与核心任务\x0a你正在扮演角色“'+_0x40c514[_0x42aa29(0x543)]+_0x42aa29(0x769)+_0x40c514['settings'][_0x42aa29(0x1216)]+'\x0a'+_0x407fc3+'\x0a#\x20对话者的角色设定\x0a'+_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0xab1)]+_0x42aa29(0x5cb)+(_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x558)]?_0x42aa29(0x84d)+_0x1ac2ca+'\x20('+_0x17ad73+')':'')+'\x0a'+_0xefc14d+_0x42aa29(0x11ce)+_0x1210f5+'\x0a'+_0x58734a+_0x42aa29(0x561)+(_0x40c514[_0x42aa29(0x1016)]&&_0x40c514[_0x42aa29(0x1016)]['length']>0x0?_0x40c514[_0x42aa29(0x1016)]['map'](_0x1b2e45=>'-\x20'+_0x1b2e45[_0x42aa29(0x73e)])[_0x42aa29(0x2c8)]('\x0a'):_0x42aa29(0xddc))+'\x0a'+_0x2389f5+_0x42aa29(0xb2c)+_0x40c514[_0x42aa29(0x543)]+_0x42aa29(0xeaa)+_0x40c514[_0x42aa29(0x234)]+'\x22\x20(你可以建议并修改)\x0a-\x20\x20\x20**你对用户的备注**:\x20“'+_0x24c57e+_0x42aa29(0x4a7)+_0x3a0970+'\x0a\x20\x20\x20\x20'+_0x30a040+_0x42aa29(0x28e)+_0x4f5b56+'\x0a'+_0x4dae20+'\x0a'+_0x53b4e3+_0x42aa29(0x245)+_0x27fcac+'\x0a'+_0x430bd7+_0x42aa29(0x111a)+(_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x558)]?_0x42aa29(0x1139)+_0x1ac2ca+'\x20('+_0x17ad73+')，并在对话中自然地体现出来。':'')+_0x42aa29(0x80c)+(_0x411989?_0x42aa29(0x100c)+_0x411989:_0x42aa29(0xb4b))+_0x42aa29(0xaff)+(_0x5e9381?'你们正在一起读书。'+_0x5e9381:'你们没有在读书。')+_0x42aa29(0x340)+(_0x40c514[_0x42aa29(0x81e)]['aiAvatarLibrary']&&_0x40c514['settings']['aiAvatarLibrary'][_0x42aa29(0x29d)]>0x0?_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x78e)][_0x42aa29(0xcb4)](_0x43ffa5=>'-\x20'+_0x43ffa5[_0x42aa29(0x234)])[_0x42aa29(0x2c8)]('\x0a'):'-\x20(空)')+'\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20'+(_0x40c514['settings'][_0x42aa29(0xd0e)]&&_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0xd0e)][_0x42aa29(0x29d)]>0x0?_0x40c514[_0x42aa29(0x81e)]['myAvatarLibrary'][_0x42aa29(0xcb4)](_0x596b22=>'-\x20'+_0x596b22['name'])[_0x42aa29(0x2c8)]('\x0a'):_0x42aa29(0x944))+_0x42aa29(0x288)+_0x623955+_0x42aa29(0xbc2)+(localStorage[_0x42aa29(0xa14)](_0x42aa29(0xc18))===_0x42aa29(0x10cf)?_0x42aa29(0x525):'')+_0x42aa29(0x9b5)+(localStorage[_0x42aa29(0xa14)](_0x42aa29(0xc18))==='true'?_0x42aa29(0xe20):'')+_0x42aa29(0x710)+_0x40c514[_0x42aa29(0x543)]+_0x42aa29(0x587)+_0x40c514[_0x42aa29(0x543)]+_0x42aa29(0x124e)+_0x40c514[_0x42aa29(0x543)]+_0x42aa29(0xba9)+_0x40c514[_0x42aa29(0x543)]+_0x42aa29(0x3ac),_0x6af879=_0x2d2668[_0x42aa29(0xcb4)](_0x15ac65=>{const _0x319bc1=_0x42aa29;if(_0x15ac65[_0x319bc1(0x1032)]&&_0x15ac65[_0x319bc1(0xb4d)]===_0x319bc1(0xab3))return{'role':_0x319bc1(0x10ae),'content':_0x15ac65[_0x319bc1(0x73e)]};else{if(_0x15ac65[_0x319bc1(0x1032)])return null;}if(_0x15ac65['type']==='offline_text'){const _0xaa6df0=_0x15ac65[_0x319bc1(0xb4d)]===_0x319bc1(0x10ae)?_0x40c514[_0x319bc1(0x81e)][_0x319bc1(0x1303)]||'我':_0x40c514[_0x319bc1(0x234)];let _0x4ad71a='';if(_0x15ac65['content'])_0x4ad71a=_0x15ac65[_0x319bc1(0x73e)];else{const _0x11b683=_0x15ac65[_0x319bc1(0x1266)]?'「'+_0x15ac65['dialogue']+'」':'',_0xc56453=_0x15ac65[_0x319bc1(0xa60)]?'('+_0x15ac65[_0x319bc1(0xa60)]+')':'';_0x4ad71a=(_0x11b683+'\x20'+_0xc56453)['trim']();}return{'role':_0x15ac65[_0x319bc1(0xb4d)],'content':'(Timestamp:\x20'+_0x15ac65['timestamp']+')\x20'+_0xaa6df0+':\x20'+_0x4ad71a};}if(_0x15ac65['role']==='user'){const _0x566498=_0x319bc1(0xac0)+_0x15ac65[_0x319bc1(0x827)]+')\x20';let _0x20b7f4='';if(Array[_0x319bc1(0xb31)](_0x15ac65[_0x319bc1(0x73e)])&&_0x15ac65[_0x319bc1(0x73e)][0x0]?.[_0x319bc1(0x919)]===_0x319bc1(0xc40))return{'role':'user','content':[{'type':_0x319bc1(0x2e6),'text':_0x566498},..._0x15ac65['content']]};if(_0x15ac65[_0x319bc1(0x6a2)]){const _0x5e2e13=String(_0x15ac65[_0x319bc1(0x6a2)][_0x319bc1(0x73e)]||'')[_0x319bc1(0xad6)](0x0,0x32);_0x20b7f4+=_0x319bc1(0x1135)+_0x15ac65['quote'][_0x319bc1(0xbee)]+'\x20的消息:\x20\x22'+_0x5e2e13+_0x319bc1(0x100e)+_0x15ac65[_0x319bc1(0x73e)];}else _0x20b7f4+=_0x15ac65['content'];if(_0x15ac65[_0x319bc1(0x919)]===_0x319bc1(0x1053))return{'role':'user','content':_0x566498+_0x319bc1(0xbcf)+_0x15ac65[_0x319bc1(0x73e)]+'\x27]'};if(_0x15ac65['type']===_0x319bc1(0x64f))return{'role':_0x319bc1(0x10ae),'content':_0x566498+_0x319bc1(0x8a3)+_0x15ac65[_0x319bc1(0x73e)]+'\x27]'};if(_0x15ac65[_0x319bc1(0x919)]===_0x319bc1(0x566))return{'role':'user','content':_0x566498+_0x319bc1(0x328)+_0x15ac65['timestamp']+_0x319bc1(0x1ee)+_0x15ac65['amount']+'元,\x20备注:\x20'+_0x15ac65[_0x319bc1(0xbb0)]+_0x319bc1(0x267)};if(_0x15ac65['type']==='waimai_request')return{'role':_0x319bc1(0x10ae),'content':_0x566498+_0x319bc1(0x328)+_0x15ac65[_0x319bc1(0x827)]+_0x319bc1(0x604)+_0x15ac65[_0x319bc1(0x13ce)]+_0x319bc1(0xfbe)+_0x15ac65[_0x319bc1(0x1146)]+_0x319bc1(0xad9)};else{if(_0x15ac65['type']===_0x319bc1(0x205)){const _0x1c2c50=_0x15ac65[_0x319bc1(0xa27)][_0x319bc1(0xcb4)](_0x26c2b1=>_0x26c2b1[_0x319bc1(0x234)]+'\x20x'+_0x26c2b1[_0x319bc1(0xc26)])[_0x319bc1(0x2c8)]('、\x20');let _0x29bbb9=_0x40c514[_0x319bc1(0x86e)]?_0x319bc1(0xef9)+_0x15ac65[_0x319bc1(0x134c)]['map'](_0x318c36=>_0xf33fb2(_0x40c514,_0x318c36))[_0x319bc1(0x2c8)]('、\x20'):_0x319bc1(0xef9)+_0x40c514[_0x319bc1(0x234)];return{'role':_0x319bc1(0x10ae),'content':_0x566498+_0x319bc1(0xb08)+_0x29bbb9+_0x319bc1(0x93d)+_0x1c2c50+']'};}}if(_0x15ac65[_0x319bc1(0x75f)])return{'role':_0x319bc1(0x10ae),'content':_0x566498+_0x319bc1(0xa54)+_0x15ac65[_0x319bc1(0x75f)]+'\x27]'};return{'role':_0x15ac65[_0x319bc1(0xb4d)],'content':_0x566498+_0x20b7f4};}else{if(_0x15ac65['role']===_0x319bc1(0xac5)){let _0x3edc16={'type':_0x15ac65['type']||_0x319bc1(0x2e6)};if(_0x15ac65[_0x319bc1(0x919)]===_0x319bc1(0x257))_0x3edc16[_0x319bc1(0xb36)]=_0x15ac65[_0x319bc1(0x73e)],_0x3edc16[_0x319bc1(0x75f)]=_0x15ac65[_0x319bc1(0x75f)];else{if(_0x15ac65[_0x319bc1(0x919)]===_0x319bc1(0x566))_0x3edc16[_0x319bc1(0x1146)]=_0x15ac65['amount'],_0x3edc16['note']=_0x15ac65['note'];else _0x15ac65['type']==='waimai_request'?(_0x3edc16[_0x319bc1(0x13ce)]=_0x15ac65[_0x319bc1(0x13ce)],_0x3edc16[_0x319bc1(0x1146)]=_0x15ac65[_0x319bc1(0x1146)]):_0x15ac65[_0x319bc1(0x6a2)]?_0x3edc16[_0x319bc1(0x765)]={'target_sender':_0x15ac65[_0x319bc1(0x6a2)][_0x319bc1(0xbee)],'target_content':_0x15ac65[_0x319bc1(0x6a2)][_0x319bc1(0x73e)],'reply_content':_0x15ac65['content']}:_0x3edc16[_0x319bc1(0x73e)]=_0x15ac65[_0x319bc1(0x73e)];}const _0x4593d3=JSON['stringify']([_0x3edc16]);return{'role':_0x319bc1(0xac5),'content':'(Timestamp:\x20'+_0x15ac65[_0x319bc1(0x827)]+')\x20'+_0x4593d3};}}return null;})['filter'](Boolean);if(!_0x40c514[_0x42aa29(0x86e)]&&_0x40c514['relationship']?.[_0x42aa29(0x12d3)]===_0x42aa29(0xf51)){const _0x407b97=_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x2dd)](_0x28a723=>!_0x28a723['isHidden'])[_0x42aa29(0x1340)](-0xa)['map'](_0x4963d6=>{const _0x3b2bbb=_0x42aa29,_0x3793c7=_0x4963d6[_0x3b2bbb(0xb4d)]===_0x3b2bbb(0x10ae)?'用户':_0x40c514[_0x3b2bbb(0x234)];return _0x3793c7+':\x20'+String(_0x4963d6[_0x3b2bbb(0x73e)])[_0x3b2bbb(0xad6)](0x0,0x32)+_0x3b2bbb(0x95d);})[_0x42aa29(0x2c8)]('\x0a'),_0x24a666={'role':_0x42aa29(0x10ae),'content':_0x42aa29(0x80b)+_0x40c514['relationship'][_0x42aa29(0xc1c)]+_0x42aa29(0x13a8)+_0x407b97+_0x42aa29(0xafa)};_0x6af879['push'](_0x24a666);}}}let _0xe3b2de=_0x479f46===GEMINI_API_URL,_0x12dd37=_0x1697e7(_0x348add,_0x518c77,_0x245df9,_0x6af879),_0x56e039;try{_0x56e039=_0xe3b2de?await fetch(_0x12dd37[_0x42aa29(0xb36)],_0x12dd37['data']):await fetch(_0x479f46+'/v1/chat/completions',{'method':_0x42aa29(0xa4e),'headers':{'Content-Type':_0x42aa29(0x85b),'Authorization':'Bearer\x20'+_0x518c77},'body':JSON[_0x42aa29(0xe1e)]({'model':_0x348add,'messages':[{'role':_0x42aa29(0xab3),'content':_0x245df9},..._0x6af879],'temperature':_0x53d851['globalSettings'][_0x42aa29(0xaf8)]||0.8,'stream':![]})});}catch(_0x3c0127){throw new Error(_0x42aa29(0x12fc)+_0x3c0127[_0x42aa29(0x875)]);}if(!_0x56e039['ok']){let _0x4bac1e=_0x42aa29(0xa70)+_0x56e039[_0x42aa29(0x12d3)]+'\x20'+_0x56e039['statusText'];try{const _0xa5410=await _0x56e039[_0x42aa29(0xdc2)]();_0xa5410[_0x42aa29(0x617)]&&_0xa5410[_0x42aa29(0x617)]['message']?_0x4bac1e+=_0x42aa29(0x122c)+_0xa5410['error'][_0x42aa29(0x875)]:_0x4bac1e+='\x20-\x20'+JSON[_0x42aa29(0xe1e)](_0xa5410);}catch(_0x3eee14){_0x4bac1e+=_0x42aa29(0x1273)+await _0x56e039[_0x42aa29(0x2e6)]();}throw new Error(_0x4bac1e);}const _0x2dd52e=await _0x56e039[_0x42aa29(0xdc2)](),_0x115891=getGeminiResponseText(_0x2dd52e);lastRawAiResponse=_0x115891,lastResponseTimestamps=[],_0x40c514[_0x42aa29(0xe83)]=_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x2dd)](_0x5245de=>!_0x5245de[_0x42aa29(0x980)]);const _0x474dba=_0x3e5855(_0x115891);let _0x439dfd=[];if(_0x40c514['settings'][_0x42aa29(0x9af)]){let _0x4b9f1e={'content':[],'dialogue':[],'description':[]};for(const _0x5149e1 of _0x474dba){if(_0x5149e1[_0x42aa29(0x919)]===_0x42aa29(0x8c3)){if(_0x5149e1[_0x42aa29(0x73e)])_0x4b9f1e[_0x42aa29(0x73e)][_0x42aa29(0x7dd)](_0x5149e1[_0x42aa29(0x73e)]);else{if(_0x5149e1[_0x42aa29(0x1266)])_0x4b9f1e['dialogue']['push'](_0x5149e1['dialogue']);if(_0x5149e1[_0x42aa29(0xa60)])_0x4b9f1e['description'][_0x42aa29(0x7dd)](_0x5149e1[_0x42aa29(0xa60)]);}}else(_0x4b9f1e[_0x42aa29(0x73e)][_0x42aa29(0x29d)]>0x0||_0x4b9f1e[_0x42aa29(0x1266)][_0x42aa29(0x29d)]>0x0||_0x4b9f1e[_0x42aa29(0xa60)][_0x42aa29(0x29d)]>0x0)&&(_0x4b9f1e['content'][_0x42aa29(0x29d)]>0x0&&_0x439dfd['push']({'type':_0x42aa29(0x8c3),'content':_0x4b9f1e[_0x42aa29(0x73e)]['join']('\x0a')}),(_0x4b9f1e[_0x42aa29(0x1266)][_0x42aa29(0x29d)]>0x0||_0x4b9f1e[_0x42aa29(0xa60)][_0x42aa29(0x29d)]>0x0)&&_0x439dfd[_0x42aa29(0x7dd)]({'type':_0x42aa29(0x8c3),'dialogue':_0x4b9f1e[_0x42aa29(0x1266)]['join']('\x0a'),'description':_0x4b9f1e[_0x42aa29(0xa60)][_0x42aa29(0x2c8)]('\x0a')}),_0x4b9f1e={'content':[],'dialogue':[],'description':[]}),_0x439dfd['push'](_0x5149e1);}_0x4b9f1e['content'][_0x42aa29(0x29d)]>0x0&&_0x439dfd['push']({'type':_0x42aa29(0x8c3),'content':_0x4b9f1e['content'][_0x42aa29(0x2c8)]('\x0a')}),(_0x4b9f1e[_0x42aa29(0x1266)][_0x42aa29(0x29d)]>0x0||_0x4b9f1e[_0x42aa29(0xa60)]['length']>0x0)&&_0x439dfd[_0x42aa29(0x7dd)]({'type':_0x42aa29(0x8c3),'dialogue':_0x4b9f1e[_0x42aa29(0x1266)][_0x42aa29(0x2c8)]('\x0a'),'description':_0x4b9f1e[_0x42aa29(0xa60)]['join']('\x0a')});}else _0x439dfd=_0x474dba;const _0x4a9ec9=_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x2dd)](_0x152b07=>_0x152b07['role']===_0x42aa29(0x10ae)&&!_0x152b07[_0x42aa29(0x1032)])[_0x42aa29(0x51a)]();if(_0x4a9ec9&&Array[_0x42aa29(0xb31)](_0x4a9ec9[_0x42aa29(0x73e)])&&_0x4a9ec9[_0x42aa29(0x73e)][0x0]?.['type']===_0x42aa29(0xc40)&&!_0x4a9ec9[_0x42aa29(0x491)]){const _0x866135=_0x474dba['find'](_0xec6f03=>_0xec6f03[_0x42aa29(0x919)]==='text');let _0x547293;_0x866135&&(_0x866135[_0x42aa29(0x73e)]||_0x866135[_0x42aa29(0x875)])?_0x547293=String(_0x866135[_0x42aa29(0x73e)]||_0x866135[_0x42aa29(0x875)])[_0x42aa29(0x13bc)]():_0x547293='AI已接收并理解了该图片的内容。';const _0x3624e3=_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x298)](_0x5bc984=>_0x5bc984['timestamp']===_0x4a9ec9[_0x42aa29(0x827)]);if(_0x3624e3>-0x1){console[_0x42aa29(0x1081)]('识图优化：正在将时间戳为\x20'+_0x4a9ec9[_0x42aa29(0x827)]+'\x20的图片消息替换为文字描述...');const _0x41bb22='[系统提示：用户之前发送了一张图片，AI对图片的首次回应（摘要）是：“'+_0x547293+'”]';_0x40c514[_0x42aa29(0xe83)][_0x3624e3]['content']=_0x41bb22,_0x40c514['history'][_0x3624e3]['imageProcessed']=!![],_0x40c514[_0x42aa29(0xe83)][_0x3624e3][_0x42aa29(0x919)]=_0x42aa29(0x2e6);}}const _0x19dae3=document[_0x42aa29(0x53a)]('chat-interface-screen')[_0x42aa29(0x1276)]['contains']('active')&&_0x53d851[_0x42aa29(0x13be)]===_0x1faca0;let _0x1be74f=![],_0x35d3d2=Date[_0x42aa29(0x9c1)](),_0x5292f5=[],_0x1fe643=![];for(const _0x45312a of _0x439dfd){_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x107c)]!==![]&&_0x45312a[_0x42aa29(0x919)]===_0x42aa29(0x2e6)&&typeof _0x45312a['content']===_0x42aa29(0xfc5)&&_0x45312a[_0x42aa29(0x73e)][_0x42aa29(0x13bc)]()[_0x42aa29(0x1200)]('[V]')&&(_0x45312a['type']=_0x42aa29(0x64f),_0x45312a['content']=_0x45312a[_0x42aa29(0x73e)]['replace'](_0x42aa29(0xef7),'')['trim']());if(_0x40c514['isGroup']&&_0x45312a['name']&&_0x45312a[_0x42aa29(0x234)]===_0x40c514[_0x42aa29(0x234)]){console[_0x42aa29(0x617)](_0x42aa29(0xae4)+_0x40c514[_0x42aa29(0x234)]+'\x22)\x20作为角色名。消息内容:',_0x45312a);continue;}if(!_0x45312a||typeof _0x45312a!==_0x42aa29(0xc74)){console[_0x42aa29(0xad0)](_0x42aa29(0x1095),_0x45312a);continue;}if(!_0x45312a['type']){if(_0x40c514['isGroup']&&_0x45312a[_0x42aa29(0x234)]&&_0x45312a[_0x42aa29(0x875)])_0x45312a[_0x42aa29(0x919)]=_0x42aa29(0x2e6);else{if(_0x45312a['content'])_0x45312a[_0x42aa29(0x919)]='text';else{console[_0x42aa29(0xad0)](_0x42aa29(0x1430),_0x45312a);continue;}}}if(_0x45312a[_0x42aa29(0x919)]===_0x42aa29(0xb05)){_0x58a059['isAwaitingResponse']=![];if(_0x45312a[_0x42aa29(0x12e3)]==='accept')_0x56dfd3();else{const _0x49244b={'role':_0x42aa29(0xac5),'content':'对方拒绝了你的视频通话请求。','timestamp':Date[_0x42aa29(0x9c1)]()};_0x40c514['history'][_0x42aa29(0x7dd)](_0x49244b),await _0xa62efb[_0x42aa29(0xaa3)][_0x42aa29(0x546)](_0x40c514),_0x541a81('chat-interface-screen'),_0x60f53f(_0x1faca0);}_0x1be74f=!![];break;}if(_0x45312a[_0x42aa29(0x919)]===_0x42aa29(0x2f1)){if(_0x45312a[_0x42aa29(0x12e3)]===_0x42aa29(0x2c8)){const _0x49cdf9=_0x40c514['members']['find'](_0x37512e=>_0x37512e[_0x42aa29(0x543)]===_0x45312a[_0x42aa29(0x234)]);_0x49cdf9&&!_0x58a059[_0x42aa29(0x574)][_0x42aa29(0xe0f)](_0x1777f0=>_0x1777f0['id']===_0x49cdf9['id'])&&_0x58a059[_0x42aa29(0x574)][_0x42aa29(0x7dd)](_0x49cdf9);}_0x1be74f=!![];continue;}if(_0x40c514['isGroup']&&_0x45312a[_0x42aa29(0x234)]&&_0x45312a[_0x42aa29(0x234)]===_0x40c514['name']){console[_0x42aa29(0x617)](_0x42aa29(0xae4)+_0x40c514[_0x42aa29(0x234)]+_0x42aa29(0xb5a),_0x45312a);continue;}if(_0x40c514[_0x42aa29(0x86e)]&&!_0x45312a[_0x42aa29(0x234)]){console[_0x42aa29(0x617)](_0x42aa29(0x1012),_0x45312a);continue;}let _0x38b8f8=null;const _0xcef6b8=_0x35d3d2++,_0xcef356={'role':_0x42aa29(0xac5),'senderName':_0x45312a[_0x42aa29(0x234)]||_0x40c514[_0x42aa29(0x234)],'timestamp':_0xcef6b8};lastResponseTimestamps[_0x42aa29(0x7dd)](_0xcef6b8);switch(_0x45312a[_0x42aa29(0x919)]){case _0x42aa29(0x7ed):if(!_0x40c514['isGroup']){_0x45312a['heartfelt_voice']&&(_0x40c514[_0x42aa29(0x13cb)]=String(_0x45312a[_0x42aa29(0x961)]));_0x45312a[_0x42aa29(0x82f)]&&(_0x40c514['randomJottings']=String(_0x45312a['random_jottings']));!Array[_0x42aa29(0xb31)](_0x40c514['thoughtsHistory'])&&(_0x40c514[_0x42aa29(0xf2c)]=[]);_0x40c514[_0x42aa29(0xf2c)][_0x42aa29(0x7dd)]({'heartfeltVoice':_0x40c514[_0x42aa29(0x13cb)],'randomJottings':_0x40c514[_0x42aa29(0xc35)],'timestamp':Date[_0x42aa29(0x9c1)]()});_0x40c514[_0x42aa29(0xf2c)][_0x42aa29(0x29d)]>0x32&&_0x40c514[_0x42aa29(0xf2c)][_0x42aa29(0x375)]();const _0x2f02b5=_0x42aa29(0x119e)+_0x40c514['heartfeltVoice']+_0x42aa29(0x1310)+_0x40c514[_0x42aa29(0xc35)],_0x2fd364={'role':_0x42aa29(0xab3),'content':_0x2f02b5,'timestamp':Date[_0x42aa29(0x9c1)](),'isHidden':!![]};}continue;case _0x42aa29(0xf35):if(!_0x40c514['isGroup']&&_0x45312a['new_name']){const _0x35cba3=_0x45312a['new_name'][_0x42aa29(0x13bc)]();if(_0x35cba3){_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x1303)]=_0x35cba3;const _0x199908={'role':_0x42aa29(0xab3),'type':'pat_message','content':'“'+_0x40c514[_0x42aa29(0x234)]+_0x42aa29(0x4be)+_0x35cba3+'”','timestamp':_0x35d3d2++};_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x7dd)](_0x199908);const _0x1563f7={'role':'system','content':_0x42aa29(0xa2c)+_0x35cba3+_0x42aa29(0xcef),'timestamp':_0x35d3d2++,'isHidden':!![]};_0x40c514['history'][_0x42aa29(0x7dd)](_0x1563f7),_0x19dae3&&_0xa4d65(_0x199908,_0x40c514);}}continue;case _0x42aa29(0x92a):if(!_0x40c514[_0x42aa29(0x86e)]&&_0x45312a[_0x42aa29(0x1151)]){const _0x33adb5=_0x40c514['name'],_0x14e0de=_0x45312a[_0x42aa29(0x1151)]['trim']();if(_0x14e0de&&_0x14e0de!==_0x33adb5){!_0x40c514['nameHistory']&&(_0x40c514[_0x42aa29(0x12ed)]=[]);!_0x40c514['nameHistory'][_0x42aa29(0x6e9)](_0x33adb5)&&_0x40c514[_0x42aa29(0x12ed)][_0x42aa29(0x7dd)](_0x33adb5);_0x40c514['name']=_0x14e0de;const _0xea27e0={'role':'system','type':_0x42aa29(0x109b),'content':'“'+_0x40c514[_0x42aa29(0x543)]+_0x42aa29(0x230)+_0x14e0de+'”','timestamp':_0x35d3d2++};_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x7dd)](_0xea27e0);const _0x5bba19={'role':_0x42aa29(0xab3),'content':_0x42aa29(0xc59)+_0x14e0de+'”。请自然地接受这个新名字，不要对此感到惊讶。]','timestamp':_0x35d3d2++,'isHidden':!![]};_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x7dd)](_0x5bba19),_0x19dae3&&(_0xa4d65(_0xea27e0,_0x40c514),document['getElementById'](_0x42aa29(0xba3))[_0x42aa29(0x34a)]=_0x14e0de),await _0x30a85e(_0x40c514);}}continue;case _0x42aa29(0xa2d):{const _0x18e3ee=_0x45312a[_0x42aa29(0x234)],_0x215477=_0x40c514['settings'][_0x42aa29(0x78e)][_0x42aa29(0x397)](_0x3ff150=>_0x3ff150[_0x42aa29(0x234)]===_0x18e3ee);if(_0x215477){_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x9e3)]=_0x215477[_0x42aa29(0xb36)];const _0x4c47c9={'role':_0x42aa29(0xab3),'type':_0x42aa29(0x109b),'content':'['+_0x40c514['name']+_0x42aa29(0x1250),'timestamp':Date['now']()};_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x7dd)](_0x4c47c9),await _0x55466c(_0x40c514),_0x19dae3&&(_0xa4d65(_0x4c47c9,_0x40c514),_0x60f53f(_0x1faca0));}continue;}case'change_user_avatar':{const _0x38739e=_0x45312a['name'],_0x2940b6=_0x40c514[_0x42aa29(0x81e)]['myAvatarLibrary'][_0x42aa29(0x397)](_0x323175=>_0x323175['name']===_0x38739e);if(_0x2940b6){_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x971)]=_0x2940b6[_0x42aa29(0xb36)];const _0xffb354={'role':'system','type':_0x42aa29(0x109b),'content':'['+_0x40c514['name']+'\x20更换了你的头像]','timestamp':Date[_0x42aa29(0x9c1)]()};_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x7dd)](_0xffb354),_0x19dae3&&(_0xa4d65(_0xffb354,_0x40c514),_0x60f53f(_0x1faca0));}continue;}case _0x42aa29(0x118d):{const _0x441574=parseInt(_0x45312a['x']),_0x421539=parseInt(_0x45312a['y']);!isNaN(_0x441574)&&!isNaN(_0x421539)?_0x5e0cf2({'x':_0x441574,'y':_0x421539}):console[_0x42aa29(0xad0)]('AI的五子棋移动指令包含无效坐标，已忽略:',_0x45312a);continue;}case _0x42aa29(0x3d9):const _0xd44e8b=_0x40c514[_0x42aa29(0xe83)]['findIndex'](_0xcf8ded=>_0xcf8ded[_0x42aa29(0x827)]===_0x45312a['for_timestamp']);if(_0xd44e8b>-0x1){const _0xe4555e=_0x40c514['history'][_0xd44e8b];_0xe4555e[_0x42aa29(0x12d3)]=_0x45312a[_0x42aa29(0x12d3)],_0xe4555e[_0x42aa29(0x738)]=_0x45312a[_0x42aa29(0x12d3)]===_0x42aa29(0x2ea)?_0x45312a[_0x42aa29(0x234)]:null;}continue;case _0x42aa29(0xc50):const _0x309966={'type':_0x45312a['postType'],'content':_0x45312a[_0x42aa29(0x73e)]||'','publicText':_0x45312a[_0x42aa29(0x678)]||'','hiddenContent':_0x45312a[_0x42aa29(0x319)]||'','image_prompt':_0x45312a[_0x42aa29(0xadb)]||'','timestamp':Date[_0x42aa29(0x9c1)](),'authorId':_0x1faca0,'authorGroupId':_0x40c514[_0x42aa29(0x608)],'visibleGroupIds':null};if(_0x45312a[_0x42aa29(0xc57)]===_0x42aa29(0x357)&&_0x45312a[_0x42aa29(0x6d2)])try{const _0x3ff7c4=Array[_0x42aa29(0xb31)](_0x45312a[_0x42aa29(0x6d2)])?_0x45312a['prompt']['slice'](0x0,0x2):[_0x45312a['prompt']];console[_0x42aa29(0x1081)](_0x42aa29(0x10a4)+_0x3ff7c4[_0x42aa29(0x29d)]+_0x42aa29(0x10ef));const _0x16075a=[];for(let _0x29bdab=0x0;_0x29bdab<_0x3ff7c4[_0x42aa29(0x29d)];_0x29bdab++){const _0x546c10=_0x3ff7c4[_0x29bdab];console[_0x42aa29(0x1081)](_0x42aa29(0x74f)+(_0x29bdab+0x1)+_0x42aa29(0xcfb),_0x546c10);const _0x7030d4=_0x33851e(_0x40c514['id']),_0x1975ba=_0x546c10+',\x20'+_0x7030d4[_0x42aa29(0x3cc)],_0x57d668=_0x7030d4[_0x42aa29(0xf30)];console[_0x42aa29(0x1081)]('📝\x20使用'+(_0x7030d4[_0x42aa29(0xda4)]===_0x42aa29(0xde1)?_0x42aa29(0x272):'系统')+_0x42aa29(0xd9f)),console[_0x42aa29(0x1081)]('最终正面提示词:',_0x1975ba),console[_0x42aa29(0x1081)](_0x42aa29(0xf75),_0x57d668);const _0x167219=localStorage[_0x42aa29(0xa14)]('novelai-api-key'),_0x58789e=localStorage[_0x42aa29(0xa14)](_0x42aa29(0x835))||_0x42aa29(0x479),_0x5dc04c=_0x2b389a();if(!_0x167219)throw new Error(_0x42aa29(0x4ca));const [_0x54aef4,_0x596882]=_0x5dc04c[_0x42aa29(0x9c9)][_0x42aa29(0x13e8)]('x')[_0x42aa29(0xcb4)](Number);let _0x1de731;_0x58789e[_0x42aa29(0x6e9)](_0x42aa29(0x138d))?_0x1de731={'input':_0x1975ba,'model':_0x58789e,'action':_0x42aa29(0x10f4),'parameters':{'params_version':0x3,'width':_0x54aef4,'height':_0x596882,'scale':_0x5dc04c[_0x42aa29(0x112c)],'sampler':_0x5dc04c[_0x42aa29(0x836)],'steps':_0x5dc04c[_0x42aa29(0xfbd)],'seed':_0x5dc04c['seed']===-0x1?Math['floor'](Math[_0x42aa29(0xac4)]()*0x2540be3ff):_0x5dc04c[_0x42aa29(0x36b)],'n_samples':0x1,'ucPreset':_0x5dc04c[_0x42aa29(0x85e)],'qualityToggle':_0x5dc04c[_0x42aa29(0xa41)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x42aa29(0xa43),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x1975ba,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x57d668,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x57d668,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x1de731={'input':_0x1975ba,'model':_0x58789e,'action':_0x42aa29(0x10f4),'parameters':{'width':_0x54aef4,'height':_0x596882,'scale':_0x5dc04c[_0x42aa29(0x112c)],'sampler':_0x5dc04c[_0x42aa29(0x836)],'steps':_0x5dc04c['steps'],'seed':_0x5dc04c[_0x42aa29(0x36b)]===-0x1?Math[_0x42aa29(0x7d5)](Math[_0x42aa29(0xac4)]()*0x2540be3ff):_0x5dc04c[_0x42aa29(0x36b)],'n_samples':0x1,'ucPreset':_0x5dc04c[_0x42aa29(0x85e)],'qualityToggle':_0x5dc04c[_0x42aa29(0xa41)],'sm':_0x5dc04c[_0x42aa29(0x63e)],'sm_dyn':_0x5dc04c[_0x42aa29(0x1268)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':'native','negative_prompt':_0x57d668}};console[_0x42aa29(0x1081)](_0x42aa29(0x9f6),_0x1de731);let _0x1b1b67;_0x58789e['includes']('nai-diffusion-4')?_0x1b1b67=_0x42aa29(0x6ef):_0x1b1b67=_0x42aa29(0x41b);let _0x546c41=_0x5dc04c[_0x42aa29(0x1167)];_0x546c41==='custom'&&(_0x546c41=_0x5dc04c[_0x42aa29(0xa38)]||'');_0x546c41&&_0x546c41!==''&&(_0x1b1b67=_0x546c41+encodeURIComponent(_0x1b1b67));const _0x59e66e=await fetch(_0x1b1b67,{'method':_0x42aa29(0xa4e),'headers':{'Content-Type':_0x42aa29(0x85b),'Authorization':_0x42aa29(0x841)+_0x167219},'body':JSON[_0x42aa29(0xe1e)](_0x1de731)});console['log']('Response\x20status:',_0x59e66e[_0x42aa29(0x12d3)]),console[_0x42aa29(0x1081)](_0x42aa29(0x62d),[..._0x59e66e[_0x42aa29(0x4df)][_0x42aa29(0xfdc)]()]);if(!_0x59e66e['ok']){const _0x2d425a=await _0x59e66e[_0x42aa29(0x2e6)]();console[_0x42aa29(0x617)]('API错误响应:',_0x2d425a);throw new Error(_0x42aa29(0x10c4)+_0x59e66e[_0x42aa29(0x12d3)]+_0x42aa29(0x1108)+_0x2d425a);}const _0x44e7b7=_0x59e66e[_0x42aa29(0x4df)][_0x42aa29(0x883)](_0x42aa29(0x459));console[_0x42aa29(0x1081)](_0x42aa29(0x9b1),_0x44e7b7);let _0x2c3716,_0x5866a0;if(_0x44e7b7&&_0x44e7b7[_0x42aa29(0x6e9)](_0x42aa29(0xc89))){console[_0x42aa29(0x1081)](_0x42aa29(0x782));const _0x509cac=await _0x59e66e[_0x42aa29(0x2e6)]();console[_0x42aa29(0x1081)]('收到\x20SSE\x20数据，大小:',_0x509cac['length']);const _0x5706d2=_0x509cac[_0x42aa29(0x13bc)]()['split']('\x0a');let _0x4152cf=null;for(let _0xd97092=_0x5706d2[_0x42aa29(0x29d)]-0x1;_0xd97092>=0x0;_0xd97092--){const _0x4f1e96=_0x5706d2[_0xd97092][_0x42aa29(0x13bc)]();if(_0x4f1e96[_0x42aa29(0x1200)]('data:\x20')&&_0x4f1e96!==_0x42aa29(0x1100)){const _0x5e49d3=_0x4f1e96[_0x42aa29(0xad6)](0x6);try{const _0x3f1e2e=JSON[_0x42aa29(0x367)](_0x5e49d3);if(_0x3f1e2e[_0x42aa29(0x1390)]===_0x42aa29(0xef1)&&_0x3f1e2e[_0x42aa29(0xace)]){_0x4152cf=_0x3f1e2e[_0x42aa29(0xace)],console[_0x42aa29(0x1081)]('✅\x20找到\x20final\x20事件的图片数据');break;}if(_0x3f1e2e[_0x42aa29(0xd7c)]){_0x4152cf=_0x3f1e2e[_0x42aa29(0xd7c)],console[_0x42aa29(0x1081)](_0x42aa29(0xdd1));break;}if(_0x3f1e2e[_0x42aa29(0xace)]){_0x4152cf=_0x3f1e2e[_0x42aa29(0xace)],console['log'](_0x42aa29(0xb79));break;}}catch(_0x386e3e){_0x4152cf=_0x5e49d3,console[_0x42aa29(0x1081)](_0x42aa29(0x22f));break;}}}if(!_0x4152cf)throw new Error('无法从\x20SSE\x20响应中提取图片数据');const _0x507f08=_0x4152cf[_0x42aa29(0x1200)](_0x42aa29(0x753)),_0x47f63a=_0x4152cf['startsWith'](_0x42aa29(0x545));if(_0x507f08||_0x47f63a){console[_0x42aa29(0x1081)]('✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)');const _0x26effb=atob(_0x4152cf),_0x1a3228=new Uint8Array(_0x26effb[_0x42aa29(0x29d)]);for(let _0x46b2c9=0x0;_0x46b2c9<_0x26effb[_0x42aa29(0x29d)];_0x46b2c9++){_0x1a3228[_0x46b2c9]=_0x26effb[_0x42aa29(0x24b)](_0x46b2c9);}const _0x965c2f=new Blob([_0x1a3228],{'type':_0x507f08?_0x42aa29(0xeb8):_0x42aa29(0x4b3)});console[_0x42aa29(0x1081)](_0x42aa29(0x398),_0x965c2f[_0x42aa29(0x38e)]);const _0x1cf3f1=new FileReader();_0x5866a0=await new Promise((_0xbd70b7,_0x15b28e)=>{const _0x40d909=_0x42aa29;_0x1cf3f1[_0x40d909(0x128f)]=()=>_0xbd70b7(_0x1cf3f1[_0x40d909(0xa2a)]),_0x1cf3f1[_0x40d909(0xdcc)]=_0x15b28e,_0x1cf3f1['readAsDataURL'](_0x965c2f);}),console[_0x42aa29(0x1081)](_0x42aa29(0x76d));}else{console['log'](_0x42aa29(0xb1b));const _0x2b4bf8=atob(_0x4152cf),_0x41a873=new Uint8Array(_0x2b4bf8[_0x42aa29(0x29d)]);for(let _0x33ca04=0x0;_0x33ca04<_0x2b4bf8[_0x42aa29(0x29d)];_0x33ca04++){_0x41a873[_0x33ca04]=_0x2b4bf8[_0x42aa29(0x24b)](_0x33ca04);}_0x2c3716=new Blob([_0x41a873]),console['log']('ZIP\x20Blob\x20大小:',_0x2c3716[_0x42aa29(0x38e)]);}}else _0x2c3716=await _0x59e66e[_0x42aa29(0xfa4)](),console['log']('收到数据，类型:',_0x2c3716['type'],_0x42aa29(0x131b),_0x2c3716[_0x42aa29(0x38e)]);if(!_0x5866a0&&_0x2c3716)try{if(typeof JSZip===_0x42aa29(0x131e))throw new Error(_0x42aa29(0xd6a));const _0x281df0=await JSZip['loadAsync'](_0x2c3716);console[_0x42aa29(0x1081)]('ZIP文件内容:',Object[_0x42aa29(0x1350)](_0x281df0[_0x42aa29(0x1413)]));let _0x4af568=null;for(let _0x7de579 in _0x281df0[_0x42aa29(0x1413)]){if(_0x7de579[_0x42aa29(0x1120)](/\.(png|jpg|jpeg|webp)$/i)){_0x4af568=_0x281df0[_0x42aa29(0x1413)][_0x7de579],console[_0x42aa29(0x1081)](_0x42aa29(0x75e),_0x7de579);break;}}if(!_0x4af568)throw new Error(_0x42aa29(0x4c7));const _0x80c855=await _0x4af568[_0x42aa29(0x11cb)](_0x42aa29(0xfa4));console[_0x42aa29(0x1081)](_0x42aa29(0xeab),_0x80c855['size']);const _0x1604fa=new FileReader();_0x5866a0=await new Promise((_0x4986c7,_0x25630d)=>{const _0x5919cc=_0x42aa29;_0x1604fa[_0x5919cc(0x128f)]=()=>_0x4986c7(_0x1604fa[_0x5919cc(0xa2a)]),_0x1604fa[_0x5919cc(0xdcc)]=_0x25630d,_0x1604fa[_0x5919cc(0x13b6)](_0x80c855);}),console[_0x42aa29(0x1081)](_0x42aa29(0x33f));}catch(_0x18e395){console[_0x42aa29(0x617)](_0x42aa29(0x2f8),_0x18e395);throw new Error(_0x42aa29(0x957)+_0x18e395[_0x42aa29(0x875)]);}console['log']('✅\x20NAI图片'+(_0x29bdab+0x1)+_0x42aa29(0xbfe)),_0x16075a[_0x42aa29(0x7dd)](_0x5866a0);}_0x309966[_0x42aa29(0x4ad)]=_0x16075a,_0x16075a[_0x42aa29(0x29d)]===0x1&&(_0x309966[_0x42aa29(0x97a)]=_0x16075a[0x0]),_0x309966[_0x42aa29(0x6d2)]=_0x45312a[_0x42aa29(0x6d2)],_0x309966[_0x42aa29(0x1e2)]=_0x16075a[_0x42aa29(0x29d)],console[_0x42aa29(0x1081)](_0x42aa29(0x8fc)+_0x16075a[_0x42aa29(0x29d)]+'张');}catch(_0x357a36){console[_0x42aa29(0x617)](_0x42aa29(0xb28),_0x357a36),_0x309966[_0x42aa29(0x73e)]=(_0x309966[_0x42aa29(0x73e)]||_0x309966[_0x42aa29(0x678)]||'')+(_0x42aa29(0x12d2)+_0x357a36[_0x42aa29(0x875)]+']');}await _0xa62efb[_0x42aa29(0xfc2)]['add'](_0x309966),_0x5bac35(_0x13cfad+0x1);_0x19dae3&&document['getElementById'](_0x42aa29(0x116e))[_0x42aa29(0x1276)][_0x42aa29(0x6a3)](_0x42aa29(0xdf6))&&await _0x3679f3();continue;case _0x42aa29(0x69e):{const _0x42a926=await _0xa62efb[_0x42aa29(0xfc2)]['get'](parseInt(_0x45312a[_0x42aa29(0xb09)]));if(_0x42a926){if(!_0x42a926[_0x42aa29(0x11ed)])_0x42a926['comments']=[];const _0x503886=_0x45312a[_0x42aa29(0x234)]||_0x40c514[_0x42aa29(0x543)],_0x6be568=(_0x4bfcf0,_0x2e02f6=null,_0x35f135=null)=>({'commenterName':_0x503886,'text':_0x1cea24(_0x4bfcf0,_0x40c514),'meaning':_0x2e02f6,'replyTo':_0x35f135,'timestamp':Date['now']()});if(_0x45312a[_0x42aa29(0xd02)]){const _0x2b17b2=_0x53d851[_0x42aa29(0xf8f)]['find'](_0xf8902c=>_0xf8902c[_0x42aa29(0x234)]===_0x45312a[_0x42aa29(0xd02)]);_0x2b17b2?_0x42a926[_0x42aa29(0x11ed)][_0x42aa29(0x7dd)](_0x6be568(_0x2b17b2['url'],_0x2b17b2[_0x42aa29(0x234)],_0x45312a[_0x42aa29(0x7fc)]||null)):(console[_0x42aa29(0xad0)]('AI\x20尝试评论一个不存在的表情:\x20\x22'+_0x45312a[_0x42aa29(0xd02)]+'\x22'),_0x42a926['comments'][_0x42aa29(0x7dd)](_0x6be568(_0x42aa29(0x6b1)+_0x45312a['stickerMeaning']+']',null,_0x45312a['replyTo']||null)));}else{if(Array[_0x42aa29(0xb31)](_0x45312a[_0x42aa29(0x11ed)]))_0x45312a['comments'][_0x42aa29(0xeaf)](_0x5f16cd=>{const _0x3b268f=_0x42aa29;typeof _0x5f16cd==='string'&&_0x5f16cd[_0x3b268f(0x13bc)]()&&_0x42a926[_0x3b268f(0x11ed)][_0x3b268f(0x7dd)](_0x6be568(_0x5f16cd,null,_0x45312a[_0x3b268f(0x7fc)]||null));});else typeof _0x45312a[_0x42aa29(0xc6d)]===_0x42aa29(0xfc5)&&_0x45312a[_0x42aa29(0xc6d)][_0x42aa29(0x13bc)]()&&_0x42a926[_0x42aa29(0x11ed)][_0x42aa29(0x7dd)](_0x6be568(_0x45312a[_0x42aa29(0xc6d)],null,_0x45312a['replyTo']||null));}await _0xa62efb[_0x42aa29(0xfc2)]['update'](_0x42a926['id'],{'comments':_0x42a926[_0x42aa29(0x11ed)]}),_0x5bac35(_0x13cfad+0x1),console[_0x42aa29(0x1081)](_0x42aa29(0x1089)+_0x40c514['name']+_0x42aa29(0xd36)+_0x45312a[_0x42aa29(0xb09)]);if(!_0x40c514[_0x42aa29(0xd47)])_0x40c514[_0x42aa29(0xd47)]={};_0x40c514[_0x42aa29(0xd47)][_0x45312a['postId']]=Date[_0x42aa29(0x9c1)]();}continue;}case'qzone_like':const _0x3f33bb=await _0xa62efb[_0x42aa29(0xfc2)]['get'](parseInt(_0x45312a['postId']));if(_0x3f33bb){if(!_0x3f33bb[_0x42aa29(0xf52)])_0x3f33bb[_0x42aa29(0xf52)]=[];!_0x3f33bb[_0x42aa29(0xf52)][_0x42aa29(0x6e9)](_0x40c514[_0x42aa29(0x234)])&&(_0x3f33bb[_0x42aa29(0xf52)][_0x42aa29(0x7dd)](_0x40c514['name']),await _0xa62efb[_0x42aa29(0xfc2)][_0x42aa29(0xc03)](_0x3f33bb['id'],{'likes':_0x3f33bb[_0x42aa29(0xf52)]}),_0x5bac35(_0x13cfad+0x1),_0x19dae3&&document['getElementById'](_0x42aa29(0x116e))[_0x42aa29(0x1276)]['contains'](_0x42aa29(0xdf6))&&await _0x3679f3());}continue;case _0x42aa29(0x784):{const _0x35b314=await _0xa62efb[_0x42aa29(0xfc2)]['get'](parseInt(_0x45312a[_0x42aa29(0xb09)]));if(_0x35b314){const _0x451272={'type':_0x42aa29(0x784),'timestamp':Date[_0x42aa29(0x9c1)](),'authorId':_0x1faca0,'authorGroupId':_0x40c514[_0x42aa29(0x608)],'repostComment':_0x45312a[_0x42aa29(0x1445)]||'','originalPost':_0x35b314,'visibleGroupIds':null};await _0xa62efb['qzonePosts']['add'](_0x451272),_0x5bac35(_0x13cfad+0x1),console[_0x42aa29(0x1081)](_0x42aa29(0x1089)+_0x40c514[_0x42aa29(0x234)]+_0x42aa29(0xe24)+_0x45312a[_0x42aa29(0xb09)]);}continue;}case _0x42aa29(0xb78):!_0x58a059[_0x42aa29(0x975)]&&!_0x58a059[_0x42aa29(0xf9b)]&&(_0x53d851[_0x42aa29(0x13be)]=_0x1faca0,_0x58a059['activeChatId']=_0x1faca0,_0x58a059[_0x42aa29(0xf9b)]=!![],_0x58a059[_0x42aa29(0x732)]=_0x40c514[_0x42aa29(0x86e)],_0x58a059[_0x42aa29(0xa0b)]=_0x45312a['name']||_0x40c514[_0x42aa29(0x234)],_0x525e26());continue;case _0x42aa29(0x13c9):!_0x58a059[_0x42aa29(0x975)]&&!_0x58a059['isAwaitingResponse']&&(_0x53d851[_0x42aa29(0x13be)]=_0x1faca0,_0x58a059[_0x42aa29(0xf9b)]=!![],_0x58a059['isGroupCall']=!![],_0x58a059['initiator']='ai',_0x58a059['callRequester']=_0x45312a[_0x42aa29(0x234)],_0x525e26());continue;case'pat_user':let _0x3e943a;if(_0x40c514[_0x42aa29(0x86e)]){const _0x523415=_0x40c514[_0x42aa29(0x3de)][_0x42aa29(0x397)](_0x249c2a=>_0x249c2a[_0x42aa29(0x543)]===_0x45312a[_0x42aa29(0x234)]);_0x3e943a=_0x523415?_0x523415['groupNickname']:_0x45312a[_0x42aa29(0x234)];}else _0x3e943a=_0x40c514[_0x42aa29(0x234)];const _0x10435d=_0x45312a[_0x42aa29(0x1017)]?'\x20'+_0x45312a[_0x42aa29(0x1017)][_0x42aa29(0x13bc)]():'',_0x576cc2=_0x3e943a+_0x42aa29(0x1154)+_0x10435d,_0x2abc1c={'role':'system','type':'pat_message','content':_0x576cc2,'timestamp':Date['now']()};_0x40c514['history']['push'](_0x2abc1c);if(_0x19dae3){const _0xe3995e=document[_0x42aa29(0x53a)](_0x42aa29(0xf87));_0xe3995e[_0x42aa29(0x1276)][_0x42aa29(0x2d4)](_0x42aa29(0x208)),void _0xe3995e[_0x42aa29(0xb6f)],_0xe3995e[_0x42aa29(0x1276)][_0x42aa29(0xe13)]('pat-animation'),setTimeout(()=>_0xe3995e['classList'][_0x42aa29(0x2d4)](_0x42aa29(0x208)),0x1f4),_0xa4d65(_0x2abc1c,_0x40c514);}else _0x23d2a1(_0x1faca0,_0x576cc2);continue;case _0x42aa29(0x739):_0x40c514['status']['text']=_0x45312a[_0x42aa29(0x10bd)],_0x40c514['status'][_0x42aa29(0x99f)]=_0x45312a[_0x42aa29(0x4b2)]||![],_0x40c514['status']['lastUpdate']=Date[_0x42aa29(0x9c1)]();const _0x4af84a={'role':'system','type':_0x42aa29(0x109b),'content':'['+_0x40c514[_0x42aa29(0x234)]+_0x42aa29(0x571)+_0x45312a['status_text']+']','timestamp':Date[_0x42aa29(0x9c1)]()};_0x40c514['history'][_0x42aa29(0x7dd)](_0x4af84a);_0x19dae3&&_0xa4d65(_0x4af84a,_0x40c514);_0x5001a4();continue;case _0x42aa29(0x68b):_0x38b8f8={..._0xcef356,'type':_0x42aa29(0x68b),'content':_0x45312a[_0x42aa29(0x73e)]};break;case _0x42aa29(0x3d7):if(_0x2eebda['isActive']&&_0x2eebda[_0x42aa29(0x13be)]===_0x1faca0){const _0x18cc97=_0x45312a['song_name']||_0x45312a[_0x42aa29(0x2e8)]||_0x45312a[_0x42aa29(0x234)];if(typeof _0x18cc97===_0x42aa29(0xfc5)&&_0x18cc97[_0x42aa29(0x13bc)]()){const _0x4da10a=_0x18cc97['replace'](/^\[?\d+\]?[\s.-]*/,'')[_0x42aa29(0x13bc)](),_0x2e4625=_0x2eebda[_0x42aa29(0xc9a)][_0x42aa29(0x298)](_0xb63180=>_0xb63180[_0x42aa29(0x234)][_0x42aa29(0x12b5)]()===_0x4da10a[_0x42aa29(0x12b5)]());if(_0x2e4625>-0x1){_0x2fd6d0(_0x2e4625);const _0x43abfd=_0x2eebda['playlist'][_0x2e4625];let _0x38c740;if(_0x40c514[_0x42aa29(0x86e)]){const _0x26d3b2=_0x40c514['members'][_0x42aa29(0x397)](_0x3ade1d=>_0x3ade1d[_0x42aa29(0x543)]===_0x45312a['name']);_0x38c740=_0x26d3b2?_0x26d3b2[_0x42aa29(0x12bc)]:_0x45312a['name'];}else _0x38c740=_0x40c514[_0x42aa29(0x234)];const _0x2e77bf={'role':'system','type':_0x42aa29(0x109b),'content':_0x42aa29(0x39d)+_0x38c740+_0x42aa29(0x1377)+_0x43abfd[_0x42aa29(0x234)]+_0x42aa29(0xf04)+_0x43abfd[_0x42aa29(0x7cc)]+']','timestamp':Date['now']()};_0x40c514[_0x42aa29(0xe83)]['push'](_0x2e77bf),_0x19dae3&&_0xa4d65(_0x2e77bf,_0x40c514);}else console[_0x42aa29(0xad0)](_0x42aa29(0xe02)+_0x18cc97+_0x42aa29(0x126f)+_0x4da10a+'\x22)\x20在播放列表中未找到。');}else console[_0x42aa29(0x617)]('AI返回的change_music指令中，歌曲名无效或缺失:',_0x45312a);}continue;case _0x42aa29(0x1082):const _0x47aae6={'chatId':_0x1faca0,'authorId':_0x1faca0,'description':_0x45312a['description'],'timestamp':Date[_0x42aa29(0x9c1)](),'type':_0x42aa29(0xb5d)};await _0xa62efb[_0x42aa29(0xbe7)][_0x42aa29(0xe13)](_0x47aae6),console[_0x42aa29(0x1081)]('AI\x20\x22'+_0x40c514['name']+'\x22\x20记录了一条新回忆:',_0x45312a['description']);continue;case _0x42aa29(0xed2):const _0x2db429=new Date(_0x45312a['date']);if(!isNaN(_0x2db429)&&_0x2db429>new Date()){const _0xb59c0d={'chatId':_0x1faca0,'authorId':_0x1faca0,'description':_0x45312a[_0x42aa29(0x667)],'timestamp':Date[_0x42aa29(0x9c1)](),'type':_0x42aa29(0x1178),'targetDate':_0x2db429[_0x42aa29(0x984)]()};await _0xa62efb['memories'][_0x42aa29(0xe13)](_0xb59c0d),console['log'](_0x42aa29(0x1091)+_0x40c514[_0x42aa29(0x234)]+'\x22\x20创建了一个新约定:',_0x45312a[_0x42aa29(0x667)]);}continue;case _0x42aa29(0x713):if(!_0x40c514[_0x42aa29(0x86e)]){_0x40c514[_0x42aa29(0x1333)]['status']=_0x42aa29(0xfb8);const _0x844227={'role':'system','content':_0x42aa29(0x1214),'timestamp':Date[_0x42aa29(0x9c1)](),'isHidden':!![]};_0x40c514['history'][_0x42aa29(0x7dd)](_0x844227),await _0xa62efb[_0x42aa29(0xaa3)][_0x42aa29(0x546)](_0x40c514);_0x19dae3&&_0x60f53f(_0x1faca0);_0x5001a4();break;}continue;case _0x42aa29(0x1144):!_0x40c514[_0x42aa29(0x86e)]&&_0x40c514[_0x42aa29(0x1333)]?.[_0x42aa29(0x12d3)]===_0x42aa29(0xf51)&&(_0x45312a[_0x42aa29(0x12e3)]===_0x42aa29(0xe7a)?(_0x40c514[_0x42aa29(0x1333)][_0x42aa29(0x12d3)]=_0x42aa29(0x10b1),_0x38b8f8={..._0xcef356,'content':_0x42aa29(0x995)}):(_0x40c514[_0x42aa29(0x1333)][_0x42aa29(0x12d3)]=_0x42aa29(0xfb8),_0x38b8f8={..._0xcef356,'content':'抱歉，我拒绝了你的好友申请。'}),_0x40c514[_0x42aa29(0x1333)][_0x42aa29(0xc1c)]='');break;case'poll':const _0x337c71=typeof _0x45312a[_0x42aa29(0x473)]===_0x42aa29(0xfc5)?_0x45312a['options'][_0x42aa29(0x13e8)]('\x0a')[_0x42aa29(0x2dd)](_0x2b61c7=>_0x2b61c7[_0x42aa29(0x13bc)]()):Array['isArray'](_0x45312a[_0x42aa29(0x473)])?_0x45312a[_0x42aa29(0x473)]:[];if(_0x337c71[_0x42aa29(0x29d)]<0x2)continue;_0x38b8f8={..._0xcef356,'type':_0x42aa29(0xf2e),'question':_0x45312a['question'],'options':_0x337c71,'votes':{},'isClosed':![]};break;case'gift':{const {itemName:_0x16d1b5,itemPrice:_0xde0ea2,image_prompt:_0x30b15f}=_0x45312a;if(_0x16d1b5&&!isNaN(parseFloat(_0xde0ea2))&&_0x30b15f){const _0x4c667b=_0x42aa29(0x9ce)+encodeURIComponent(_0x30b15f);_0x38b8f8={..._0xcef356,'type':_0x42aa29(0x205),'items':[{'name':_0x16d1b5,'price':parseFloat(_0xde0ea2),'imageUrl':_0x4c667b,'quantity':0x1}],'total':parseFloat(_0xde0ea2),'recipients':_0x45312a['recipients']||null};}else console[_0x42aa29(0xad0)](_0x42aa29(0xd27),_0x45312a);break;}case _0x42aa29(0xa9f):const _0x23e29e=_0x40c514['history']['find'](_0x21bd57=>_0x21bd57[_0x42aa29(0x827)]===_0x45312a[_0x42aa29(0xb18)]);_0x23e29e&&!_0x23e29e['isClosed']&&(Object['keys'](_0x23e29e['votes'])[_0x42aa29(0xeaf)](_0x3bb375=>{const _0x5eb76c=_0x42aa29,_0x444e56=_0x23e29e['votes'][_0x3bb375][_0x5eb76c(0x57c)](_0x45312a[_0x5eb76c(0x234)]);_0x444e56>-0x1&&_0x23e29e[_0x5eb76c(0x771)][_0x3bb375][_0x5eb76c(0x1331)](_0x444e56,0x1);}),!_0x23e29e['votes'][_0x45312a[_0x42aa29(0x60b)]]&&(_0x23e29e[_0x42aa29(0x771)][_0x45312a['choice']]=[]),!_0x23e29e[_0x42aa29(0x771)][_0x45312a['choice']]['includes'](_0x45312a[_0x42aa29(0x234)])&&_0x23e29e[_0x42aa29(0x771)][_0x45312a['choice']][_0x42aa29(0x7dd)](_0x45312a['name']),_0x19dae3&&_0x60f53f(_0x1faca0));continue;case _0x42aa29(0x10a0):_0x38b8f8={..._0xcef356,..._0x45312a,'totalAmount':_0x45312a[_0x42aa29(0x1146)],'claimedBy':{},'isFullyClaimed':![]};_0x45312a['receiver']&&(_0x38b8f8[_0x42aa29(0x44a)]=_0x45312a[_0x42aa29(0xd38)],delete _0x38b8f8[_0x42aa29(0xd38)]);break;case _0x42aa29(0x8f5):const _0xb2197d=_0x40c514['history'][_0x42aa29(0x397)](_0x224313=>_0x224313[_0x42aa29(0x827)]===_0x45312a[_0x42aa29(0x7fa)]),_0x4dce25=_0x45312a[_0x42aa29(0x234)],_0x32393d=_0x40c514[_0x42aa29(0x3de)][_0x42aa29(0xe0f)](_0x4c2cb7=>_0x4c2cb7['originalName']===_0x4dce25);if(!_0x32393d){console[_0x42aa29(0xad0)](_0x42aa29(0x30e)+_0x4dce25+'\x22\x20尝试领取不属于自己的群聊红包。操作已被拦截。');continue;}if(_0xb2197d&&_0xb2197d[_0x42aa29(0x67e)]===_0x42aa29(0x985)){if(_0xb2197d[_0x42aa29(0x44a)]!==_0x45312a[_0x42aa29(0x234)]){console[_0x42aa29(0xad0)](_0x42aa29(0x30e)+_0x45312a[_0x42aa29(0x234)]+_0x42aa29(0x1203)+_0xb2197d[_0x42aa29(0x44a)]+_0x42aa29(0x136c));continue;}}if(_0xb2197d&&!_0xb2197d['isFullyClaimed']&&!(_0xb2197d[_0x42aa29(0x115a)]&&_0xb2197d['claimedBy'][_0x45312a['name']])){let _0x4329d8=0x0;const _0x1f5ef8=_0xb2197d[_0x42aa29(0x820)]-Object[_0x42aa29(0x244)](_0xb2197d[_0x42aa29(0x115a)]||{})['reduce']((_0x233b77,_0x3dba04)=>_0x233b77+_0x3dba04,0x0),_0x41ee13=_0xb2197d[_0x42aa29(0x1003)]-Object[_0x42aa29(0x1350)](_0xb2197d[_0x42aa29(0x115a)]||{})[_0x42aa29(0x29d)];if(_0x41ee13>0x0){if(_0xb2197d[_0x42aa29(0x67e)]==='direct')_0x4329d8=_0xb2197d[_0x42aa29(0x820)];else{if(_0x41ee13===0x1)_0x4329d8=_0x1f5ef8;else{const _0x2d2321=0.01,_0xa807bc=_0x1f5ef8-(_0x41ee13-0x1)*_0x2d2321;_0x4329d8=Math['random']()*(_0xa807bc-_0x2d2321)+_0x2d2321;}}_0x4329d8=parseFloat(_0x4329d8[_0x42aa29(0x39e)](0x2));if(!_0xb2197d['claimedBy'])_0xb2197d[_0x42aa29(0x115a)]={};_0xb2197d[_0x42aa29(0x115a)][_0x45312a[_0x42aa29(0x234)]]=_0x4329d8;const _0x5c1650=_0x40c514[_0x42aa29(0x3de)][_0x42aa29(0x397)](_0x133332=>_0x133332['originalName']===_0x45312a['name']),_0x56d67a=_0x5c1650?_0x5c1650[_0x42aa29(0x12bc)]:_0x45312a[_0x42aa29(0x234)],_0x45a83f=_0xf33fb2(_0x40c514,_0xb2197d[_0x42aa29(0xbee)]),_0x39a401={'role':_0x42aa29(0xab3),'type':_0x42aa29(0x109b),'content':_0x56d67a+'\x20领取了\x20'+_0x45a83f+_0x42aa29(0x10b5),'timestamp':Date[_0x42aa29(0x9c1)]()};_0x40c514['history'][_0x42aa29(0x7dd)](_0x39a401);let _0x56dd6a='[系统提示：你\x20('+_0x56d67a+_0x42aa29(0xcca)+_0x4329d8['toFixed'](0x2)+_0x42aa29(0xaea);if(Object[_0x42aa29(0x1350)](_0xb2197d['claimedBy'])['length']>=_0xb2197d['count']){_0xb2197d[_0x42aa29(0x70f)]=!![];const _0x100fc3={'role':_0x42aa29(0xab3),'type':_0x42aa29(0x109b),'content':_0x45a83f+_0x42aa29(0x31d),'timestamp':Date[_0x42aa29(0x9c1)]()+0x1};_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x7dd)](_0x100fc3);let _0x2ae22e={'name':'','amount':-0x1};_0xb2197d['packetType']===_0x42aa29(0x87a)&&_0xb2197d['count']>0x1&&Object[_0x42aa29(0xfdc)](_0xb2197d['claimedBy'])[_0x42aa29(0xeaf)](([_0x41dcde,_0x112103])=>{_0x112103>_0x2ae22e['amount']&&(_0x2ae22e={'name':_0x41dcde,'amount':_0x112103});});if(_0x2ae22e['name']){const _0x4e85f3=_0x40c514[_0x42aa29(0x3de)][_0x42aa29(0x397)](_0x28069f=>_0x28069f['originalName']===_0x2ae22e['name']),_0x6cc414=_0x4e85f3?_0x4e85f3['groupNickname']:_0x2ae22e[_0x42aa29(0x234)];_0x56dd6a+=_0x42aa29(0xec5)+_0x6cc414+'！';}else _0x56dd6a+=_0x42aa29(0x11e2);}_0x56dd6a+=_0x42aa29(0x3f1);const _0x2944af={'role':_0x42aa29(0xab3),'content':_0x56dd6a,'timestamp':Date['now']()+0x2,'isHidden':!![]};_0x40c514[_0x42aa29(0xe83)]['push'](_0x2944af);}_0x19dae3&&(_0x60f53f(_0x1faca0),_0x5001a4());}continue;case'accept_transfer':{const _0x3d3b74=_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x298)](_0x4fea5a=>_0x4fea5a[_0x42aa29(0x827)]===_0x45312a[_0x42aa29(0xaba)]);if(_0x3d3b74>-0x1){const _0xf3f0d6=_0x40c514['history'][_0x3d3b74];_0xf3f0d6[_0x42aa29(0x12d3)]=_0x42aa29(0x42c);}continue;}case _0x42aa29(0x9e0):{const _0x555c25=_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x298)](_0x571791=>_0x571791[_0x42aa29(0x827)]===_0x45312a[_0x42aa29(0xaba)]);if(_0x555c25>-0x1){const _0x5293e9=_0x40c514['history'][_0x555c25];_0x5293e9['status']=_0x42aa29(0xe65);const _0x531fd0={'role':_0x42aa29(0xac5),'senderName':_0x40c514[_0x42aa29(0x234)],'type':_0x42aa29(0x566),'isRefund':!![],'amount':_0x5293e9[_0x42aa29(0x1146)],'note':'转账已被拒收','timestamp':_0x35d3d2++};_0x40c514[_0x42aa29(0xe83)]['push'](_0x531fd0),_0x19dae3&&(_0xa4d65(_0x531fd0,_0x40c514),_0x60f53f(_0x1faca0));}continue;}case _0x42aa29(0x144f):if(_0x40c514[_0x42aa29(0x86e)]&&_0x45312a[_0x42aa29(0x1151)]){const _0x43f6d3=_0x45312a['new_name']['trim'](),_0x153a6b=_0x40c514[_0x42aa29(0x3de)][_0x42aa29(0xcb4)](_0x2ee8ae=>_0x2ee8ae[_0x42aa29(0x543)]);if(_0x153a6b[_0x42aa29(0x6e9)](_0x43f6d3)){console[_0x42aa29(0xad0)](_0x42aa29(0x129c)+_0x45312a[_0x42aa29(0x234)]+')\x20试图将群名更改为成员名\x20(\x22'+_0x43f6d3+_0x42aa29(0x77d));continue;}_0x40c514[_0x42aa29(0x234)]=_0x43f6d3;const _0x17521f=_0x40c514[_0x42aa29(0x3de)][_0x42aa29(0x397)](_0x2e2902=>_0x2e2902[_0x42aa29(0x543)]===_0x45312a[_0x42aa29(0x234)]),_0x108309=_0x17521f?_0x17521f[_0x42aa29(0x12bc)]:_0x45312a['name'],_0x4cf090={'role':_0x42aa29(0xab3),'type':_0x42aa29(0x109b),'content':_0x108309+'\x20将群名修改为\x20“'+_0x40c514[_0x42aa29(0x234)]+'”','timestamp':_0x35d3d2++};_0x40c514['history'][_0x42aa29(0x7dd)](_0x4cf090),_0x19dae3&&(_0xa4d65(_0x4cf090,_0x40c514),document[_0x42aa29(0x53a)]('chat-header-title')['textContent']=_0x40c514['name']);}continue;case _0x42aa29(0x92a):if(!_0x40c514['isGroup']&&_0x45312a[_0x42aa29(0x1151)]){const _0x502837=_0x40c514[_0x42aa29(0x234)],_0x1bb10f=_0x45312a[_0x42aa29(0x1151)][_0x42aa29(0x13bc)]();if(_0x1bb10f&&_0x1bb10f!==_0x502837){!_0x40c514[_0x42aa29(0x12ed)]&&(_0x40c514[_0x42aa29(0x12ed)]=[]);!_0x40c514[_0x42aa29(0x12ed)][_0x42aa29(0x6e9)](_0x502837)&&_0x40c514['nameHistory'][_0x42aa29(0x7dd)](_0x502837);_0x40c514[_0x42aa29(0x234)]=_0x1bb10f;const _0x4f854b={'role':'system','type':'pat_message','content':'“'+_0x40c514[_0x42aa29(0x543)]+_0x42aa29(0x230)+_0x1bb10f+'”','timestamp':_0x35d3d2++};_0x40c514['history'][_0x42aa29(0x7dd)](_0x4f854b);const _0x254242={'role':_0x42aa29(0xab3),'content':'[系统提示：你刚刚成功将自己的备注名修改为了“'+_0x1bb10f+_0x42aa29(0xc69),'timestamp':_0x35d3d2++,'isHidden':!![]};_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x7dd)](_0x254242),_0x19dae3&&(_0xa4d65(_0x4f854b,_0x40c514),document[_0x42aa29(0x53a)]('chat-header-title')[_0x42aa29(0x34a)]=_0x1bb10f),await _0x30a85e(_0x40c514);}}continue;case'change_group_avatar':if(_0x40c514[_0x42aa29(0x86e)]&&_0x45312a[_0x42aa29(0x11be)]){const _0x2f07e8=_0x45312a[_0x42aa29(0x11be)],_0x3509b1=_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x523)]||[],_0x4dc745=_0x3509b1[_0x42aa29(0x397)](_0x803b09=>_0x803b09[_0x42aa29(0x234)]===_0x2f07e8);if(_0x4dc745){_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x629)]=_0x4dc745['url'];const _0x2bd292=_0x40c514[_0x42aa29(0x3de)][_0x42aa29(0x397)](_0x5e8f38=>_0x5e8f38[_0x42aa29(0x543)]===_0x45312a[_0x42aa29(0x234)]),_0x4b488d=_0x2bd292?_0x2bd292[_0x42aa29(0x12bc)]:_0x45312a[_0x42aa29(0x234)],_0x49b90e={'role':_0x42aa29(0xab3),'type':'pat_message','content':_0x4b488d+_0x42aa29(0xfc0),'timestamp':_0x35d3d2++};_0x40c514[_0x42aa29(0xe83)]['push'](_0x49b90e),_0x19dae3&&_0xa4d65(_0x49b90e,_0x40c514);}else console[_0x42aa29(0xad0)](_0x42aa29(0x8c9)+_0x2f07e8+'\x22');}continue;case _0x42aa29(0x350):_0x38b8f8={'role':_0x42aa29(0xab3),'type':_0x42aa29(0x109b),'content':_0x45312a['content'],'timestamp':Date[_0x42aa29(0x9c1)]()};break;case'share_link':_0x38b8f8={..._0xcef356,'type':_0x42aa29(0x631),'title':_0x45312a[_0x42aa29(0x667)],'description':_0x45312a[_0x42aa29(0xa60)],'source_name':_0x45312a[_0x42aa29(0x8a1)],'content':_0x45312a[_0x42aa29(0x73e)]};break;case _0x42aa29(0x765):const _0x511b89=_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x397)](_0xda3a5e=>_0xda3a5e[_0x42aa29(0x827)]===_0x45312a['target_timestamp']);if(_0x511b89){const _0x1a1093={'timestamp':_0x511b89[_0x42aa29(0x827)],'senderName':_0x511b89['senderName']||(_0x511b89[_0x42aa29(0xb4d)]==='user'?_0x40c514[_0x42aa29(0x81e)][_0x42aa29(0x1303)]||'我':_0x40c514[_0x42aa29(0x234)]),'content':String(_0x511b89[_0x42aa29(0x73e)]||'')['substring'](0x0,0x32)};_0x38b8f8={..._0xcef356,'content':_0x45312a[_0x42aa29(0xf88)],'quote':_0x1a1093};}else _0x38b8f8={..._0xcef356,'content':_0x45312a['reply_content']};break;case _0x42aa29(0x8ff):{if(!_0x19dae3)continue;const _0x3cc869={..._0xcef356,'content':_0x45312a['content']},_0x50db96=_0x36bd8d(_0x3cc869,_0x40c514);_0xa4d65(_0x3cc869,_0x40c514,!![]),await new Promise(_0x5a7b28=>setTimeout(_0x5a7b28,Math[_0x42aa29(0xac4)]()*0x3e8+0x5dc));const _0x332ca7=document[_0x42aa29(0x139c)](_0x42aa29(0x3a9)+_0x3cc869[_0x42aa29(0x827)]+'\x22]')?.[_0x42aa29(0x106f)](_0x42aa29(0x5fc));if(_0x332ca7){_0x332ca7[_0x42aa29(0x1276)][_0x42aa29(0xe13)]('recalled-animation'),await new Promise(_0x5d333a=>setTimeout(_0x5d333a,0x12c));const _0x198790={'role':_0x42aa29(0xac5),'senderName':_0x45312a[_0x42aa29(0x234)]||_0x40c514[_0x42aa29(0x234)],'type':'recalled_message','content':_0x42aa29(0x1143),'timestamp':_0x3cc869[_0x42aa29(0x827)],'recalledData':{'originalType':'text','originalContent':_0x45312a['content']}},_0x459820=_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x298)](_0x4cfd2f=>_0x4cfd2f[_0x42aa29(0x827)]===_0x3cc869['timestamp']);_0x459820>-0x1?_0x40c514[_0x42aa29(0xe83)][_0x459820]=_0x198790:_0x40c514[_0x42aa29(0xe83)][_0x42aa29(0x7dd)](_0x198790);const _0x2557fd=await _0x36bd8d(_0x198790,_0x40c514);document[_0x42aa29(0x53d)][_0x42aa29(0x6a3)](_0x332ca7)&&_0x332ca7['parentNode'][_0x42aa29(0xa1d)](_0x2557fd,_0x332ca7);}continue;}case _0x42aa29(0x2e6):_0x38b8f8={..._0xcef356,'content':String(_0x45312a[_0x42aa29(0x73e)]||_0x45312a[_0x42aa29(0x875)])};break;case'sticker':if(_0x45312a[_0x42aa29(0x75f)]){const _0x3ddcd4=_0x53d851[_0x42aa29(0xf8f)][_0x42aa29(0x397)](_0x1e1ee9=>_0x1e1ee9[_0x42aa29(0x234)]===_0x45312a['meaning']);_0x3ddcd4?_0x38b8f8={..._0xcef356,'type':_0x42aa29(0x257),'content':_0x3ddcd4[_0x42aa29(0xb36)],'meaning':_0x3ddcd4[_0x42aa29(0x234)]}:(console[_0x42aa29(0xad0)](_0x42aa29(0x9ee)+_0x45312a['meaning']+'\x22'),_0x38b8f8={..._0xcef356,'type':'text','content':_0x42aa29(0x6b1)+_0x45312a[_0x42aa29(0x75f)]+']'});}else console['warn'](_0x42aa29(0xd24),_0x45312a),_0x38b8f8={..._0xcef356,'type':'sticker','content':_0x45312a[_0x42aa29(0xb36)],'meaning':_0x42aa29(0x8ad)};break;case'ai_image':_0x38b8f8={..._0xcef356,'type':_0x42aa29(0x2a5),'content':_0x45312a['description'],'image_prompt':_0x45312a[_0x42aa29(0xadb)]};break;case _0x42aa29(0x64f):_0x38b8f8={..._0xcef356,'type':_0x42aa29(0x64f),'content':_0x45312a[_0x42aa29(0x73e)]};break;case _0x42aa29(0x566):_0x38b8f8={..._0xcef356,'type':_0x42aa29(0x566),'amount':_0x45312a[_0x42aa29(0x1146)],'note':_0x45312a['note'],'receiverName':_0x45312a['receiver']||'我'};break;case _0x42aa29(0x1206):_0x38b8f8={..._0xcef356,'type':_0x42aa29(0x1206),'productInfo':_0x45312a[_0x42aa29(0x13ce)],'amount':_0x45312a[_0x42aa29(0x1146)],'status':_0x42aa29(0x43a),'countdownEndTime':Date['now']()+0xf*0x3c*0x3e8};break;case'waimai_order':_0x38b8f8={..._0xcef356,'type':_0x42aa29(0x907),'productInfo':_0x45312a[_0x42aa29(0x13ce)],'amount':_0x45312a[_0x42aa29(0x1146)],'greeting':_0x45312a[_0x42aa29(0xfa8)],'recipientName':_0x45312a[_0x42aa29(0x283)]||null};break;case _0x42aa29(0x8c3):_0x38b8f8={..._0xcef356,..._0x45312a};break;case'naiimag':try{console[_0x42aa29(0x1081)](_0x42aa29(0xe40),_0x45312a[_0x42aa29(0x6d2)]);const _0x9bc3=_0x33851e(_0x40c514['id']),_0x5aa3d5=_0x45312a['prompt']||_0x42aa29(0x382),_0x597d6f=_0x5aa3d5+',\x20'+_0x9bc3['positive'],_0x2079b3=_0x9bc3['negative'];console[_0x42aa29(0x1081)]('📝\x20使用'+(_0x9bc3[_0x42aa29(0xda4)]==='character'?_0x42aa29(0x272):'系统')+_0x42aa29(0xd9f)),console['log'](_0x42aa29(0xbf1),_0x597d6f),console[_0x42aa29(0x1081)](_0x42aa29(0xf75),_0x2079b3);const _0x2f70ed=localStorage[_0x42aa29(0xa14)]('novelai-api-key'),_0x5733e8=localStorage[_0x42aa29(0xa14)](_0x42aa29(0x835))||_0x42aa29(0x479),_0x514394=_0x2b389a();if(!_0x2f70ed)throw new Error('NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。');const [_0x18d127,_0x486b8d]=_0x514394[_0x42aa29(0x9c9)][_0x42aa29(0x13e8)]('x')['map'](Number);let _0x4c1c8d;_0x5733e8[_0x42aa29(0x6e9)](_0x42aa29(0x138d))?_0x4c1c8d={'input':_0x597d6f,'model':_0x5733e8,'action':_0x42aa29(0x10f4),'parameters':{'params_version':0x3,'width':_0x18d127,'height':_0x486b8d,'scale':_0x514394['cfg_scale'],'sampler':_0x514394[_0x42aa29(0x836)],'steps':_0x514394[_0x42aa29(0xfbd)],'seed':_0x514394[_0x42aa29(0x36b)]===-0x1?Math[_0x42aa29(0x7d5)](Math[_0x42aa29(0xac4)]()*0x2540be3ff):_0x514394[_0x42aa29(0x36b)],'n_samples':0x1,'ucPreset':_0x514394[_0x42aa29(0x85e)],'qualityToggle':_0x514394[_0x42aa29(0xa41)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x42aa29(0xa43),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x597d6f,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x2079b3,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x2079b3,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x4c1c8d={'input':_0x597d6f,'model':_0x5733e8,'action':'generate','parameters':{'width':_0x18d127,'height':_0x486b8d,'scale':_0x514394[_0x42aa29(0x112c)],'sampler':_0x514394[_0x42aa29(0x836)],'steps':_0x514394['steps'],'seed':_0x514394[_0x42aa29(0x36b)]===-0x1?Math[_0x42aa29(0x7d5)](Math[_0x42aa29(0xac4)]()*0x2540be3ff):_0x514394['seed'],'n_samples':0x1,'ucPreset':_0x514394[_0x42aa29(0x85e)],'qualityToggle':_0x514394[_0x42aa29(0xa41)],'sm':_0x514394['smea'],'sm_dyn':_0x514394[_0x42aa29(0x1268)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x42aa29(0x940),'negative_prompt':_0x2079b3}};console[_0x42aa29(0x1081)](_0x42aa29(0x9f6),_0x4c1c8d);let _0x2cd299;_0x5733e8['includes']('nai-diffusion-4')?_0x2cd299=_0x42aa29(0x6ef):_0x2cd299=_0x42aa29(0x41b);let _0x7574a9=_0x514394['cors_proxy'];_0x7574a9===_0x42aa29(0xa86)&&(_0x7574a9=_0x514394[_0x42aa29(0xa38)]||'');_0x7574a9&&_0x7574a9!==''&&(_0x2cd299=_0x7574a9+encodeURIComponent(_0x2cd299));const _0x1c0493=await fetch(_0x2cd299,{'method':_0x42aa29(0xa4e),'headers':{'Content-Type':_0x42aa29(0x85b),'Authorization':_0x42aa29(0x841)+_0x2f70ed},'body':JSON[_0x42aa29(0xe1e)](_0x4c1c8d)});console['log'](_0x42aa29(0x10a8),_0x1c0493[_0x42aa29(0x12d3)]),console[_0x42aa29(0x1081)](_0x42aa29(0x62d),[..._0x1c0493[_0x42aa29(0x4df)][_0x42aa29(0xfdc)]()]);if(!_0x1c0493['ok']){const _0x4145e6=await _0x1c0493['text']();console['error'](_0x42aa29(0x4f4),_0x4145e6);throw new Error(_0x42aa29(0x10c4)+_0x1c0493[_0x42aa29(0x12d3)]+'):\x20'+_0x4145e6);}const _0xe83582=_0x1c0493[_0x42aa29(0x4df)][_0x42aa29(0x883)]('content-type');console[_0x42aa29(0x1081)](_0x42aa29(0x9b1),_0xe83582);let _0x36e8c3,_0x4d3cc0;if(_0xe83582&&_0xe83582[_0x42aa29(0x6e9)](_0x42aa29(0xc89))){console['log']('检测到\x20SSE\x20流式响应，开始解析...');const _0x1fb634=await _0x1c0493[_0x42aa29(0x2e6)]();console[_0x42aa29(0x1081)](_0x42aa29(0x125a),_0x1fb634[_0x42aa29(0x29d)]);const _0x49d6e6=_0x1fb634['trim']()[_0x42aa29(0x13e8)]('\x0a');let _0x31f837=null;for(let _0x4f4194=_0x49d6e6['length']-0x1;_0x4f4194>=0x0;_0x4f4194--){const _0xfa3c6b=_0x49d6e6[_0x4f4194][_0x42aa29(0x13bc)]();if(_0xfa3c6b[_0x42aa29(0x1200)](_0x42aa29(0x709))&&_0xfa3c6b!==_0x42aa29(0x1100)){const _0x241dfa=_0xfa3c6b[_0x42aa29(0xad6)](0x6);try{const _0x539173=JSON[_0x42aa29(0x367)](_0x241dfa);if(_0x539173[_0x42aa29(0x1390)]===_0x42aa29(0xef1)&&_0x539173[_0x42aa29(0xace)]){_0x31f837=_0x539173[_0x42aa29(0xace)],console[_0x42aa29(0x1081)](_0x42aa29(0xab8));break;}if(_0x539173[_0x42aa29(0xd7c)]){_0x31f837=_0x539173[_0x42aa29(0xd7c)],console['log'](_0x42aa29(0xdd1));break;}if(_0x539173[_0x42aa29(0xace)]){_0x31f837=_0x539173['image'],console['log'](_0x42aa29(0xb79));break;}}catch(_0x4eb4c9){_0x31f837=_0x241dfa,console['log'](_0x42aa29(0x22f));break;}}}if(!_0x31f837)throw new Error('无法从\x20SSE\x20响应中提取图片数据');const _0xb3636b=_0x31f837[_0x42aa29(0x1200)]('iVBORw0KGgo'),_0x308306=_0x31f837['startsWith'](_0x42aa29(0x545));if(_0xb3636b||_0x308306){console[_0x42aa29(0x1081)]('✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)');const _0x2c9994=atob(_0x31f837),_0x59fa13=new Uint8Array(_0x2c9994[_0x42aa29(0x29d)]);for(let _0x302038=0x0;_0x302038<_0x2c9994[_0x42aa29(0x29d)];_0x302038++){_0x59fa13[_0x302038]=_0x2c9994[_0x42aa29(0x24b)](_0x302038);}const _0x452d9b=new Blob([_0x59fa13],{'type':_0xb3636b?_0x42aa29(0xeb8):'image/jpeg'});console['log']('图片\x20Blob\x20创建成功，大小:',_0x452d9b[_0x42aa29(0x38e)]);const _0x437193=new FileReader();_0x4d3cc0=await new Promise((_0x545228,_0x4eb81e)=>{const _0x442148=_0x42aa29;_0x437193[_0x442148(0x128f)]=()=>_0x545228(_0x437193[_0x442148(0xa2a)]),_0x437193[_0x442148(0xdcc)]=_0x4eb81e,_0x437193['readAsDataURL'](_0x452d9b);}),console[_0x42aa29(0x1081)](_0x42aa29(0x76d));}else{console[_0x42aa29(0x1081)]('当作\x20ZIP\x20文件处理...');const _0x131d7d=atob(_0x31f837),_0x210057=new Uint8Array(_0x131d7d[_0x42aa29(0x29d)]);for(let _0x359dc1=0x0;_0x359dc1<_0x131d7d[_0x42aa29(0x29d)];_0x359dc1++){_0x210057[_0x359dc1]=_0x131d7d['charCodeAt'](_0x359dc1);}_0x36e8c3=new Blob([_0x210057]),console[_0x42aa29(0x1081)](_0x42aa29(0xc96),_0x36e8c3[_0x42aa29(0x38e)]);}}else _0x36e8c3=await _0x1c0493[_0x42aa29(0xfa4)](),console['log'](_0x42aa29(0x3cf),_0x36e8c3['type'],_0x42aa29(0x131b),_0x36e8c3[_0x42aa29(0x38e)]);if(!_0x4d3cc0&&_0x36e8c3)try{if(typeof JSZip==='undefined')throw new Error(_0x42aa29(0xd6a));const _0x256375=await JSZip['loadAsync'](_0x36e8c3);console[_0x42aa29(0x1081)](_0x42aa29(0x706),Object[_0x42aa29(0x1350)](_0x256375[_0x42aa29(0x1413)]));let _0x5ba447=null;for(let _0x39c0a3 in _0x256375[_0x42aa29(0x1413)]){if(_0x39c0a3[_0x42aa29(0x1120)](/\.(png|jpg|jpeg|webp)$/i)){_0x5ba447=_0x256375[_0x42aa29(0x1413)][_0x39c0a3],console[_0x42aa29(0x1081)](_0x42aa29(0x75e),_0x39c0a3);break;}}if(!_0x5ba447)throw new Error('ZIP文件中未找到图片');const _0x2f3c4d=await _0x5ba447[_0x42aa29(0x11cb)](_0x42aa29(0xfa4));console[_0x42aa29(0x1081)](_0x42aa29(0xeab),_0x2f3c4d[_0x42aa29(0x38e)]);const _0x51d57d=new FileReader();_0x4d3cc0=await new Promise((_0x515b91,_0x1e44f0)=>{const _0x5ee703=_0x42aa29;_0x51d57d['onloadend']=()=>_0x515b91(_0x51d57d[_0x5ee703(0xa2a)]),_0x51d57d['onerror']=_0x1e44f0,_0x51d57d[_0x5ee703(0x13b6)](_0x2f3c4d);}),console[_0x42aa29(0x1081)](_0x42aa29(0x33f));}catch(_0x36de51){console[_0x42aa29(0x617)](_0x42aa29(0x2f8),_0x36de51);throw new Error(_0x42aa29(0x957)+_0x36de51[_0x42aa29(0x875)]);}console['log'](_0x42aa29(0xd51)),_0x38b8f8={..._0xcef356,'type':_0x42aa29(0x357),'imageUrl':_0x4d3cc0,'prompt':_0x5aa3d5,'fullPrompt':_0x597d6f};}catch(_0x5dd486){console['error'](_0x42aa29(0xb12),_0x5dd486),_0x38b8f8={..._0xcef356,'content':_0x42aa29(0x909)+_0x5dd486[_0x42aa29(0x875)]+']'};}break;default:console['warn']('收到了未知的AI指令类型:',_0x45312a['type']);break;}if(_0x38b8f8){_0x40c514[_0x42aa29(0xe83)]['push'](_0x38b8f8);!_0x19dae3&&(_0x40c514['unreadCount']=(_0x40c514[_0x42aa29(0x8ce)]||0x0)+0x1);if(!_0x19dae3&&!_0x1fe643){let _0xf0d82b;switch(_0x38b8f8[_0x42aa29(0x919)]){case _0x42aa29(0x566):_0xf0d82b='[收到一笔转账]';break;case _0x42aa29(0x1206):_0xf0d82b=_0x42aa29(0x139d);break;case'ai_image':_0xf0d82b=_0x42aa29(0x1169);break;case'voice_message':_0xf0d82b=_0x42aa29(0xc72);break;case _0x42aa29(0x257):_0xf0d82b=_0x38b8f8[_0x42aa29(0x75f)]?_0x42aa29(0x6b1)+_0x38b8f8[_0x42aa29(0x75f)]+']':_0x42aa29(0xcb6);break;case'offline_text':_0xf0d82b=_0x38b8f8[_0x42aa29(0x1266)]?'「'+_0x38b8f8['dialogue']+'」':'['+_0x38b8f8['description'][_0x42aa29(0xad6)](0x0,0x14)+_0x42aa29(0x133a);break;default:_0xf0d82b=String(_0x38b8f8[_0x42aa29(0x73e)]||'');}const _0x7e72d6=_0x40c514[_0x42aa29(0x86e)]?_0x38b8f8[_0x42aa29(0xbee)]+':\x20'+_0xf0d82b:_0xf0d82b;_0x23d2a1(_0x1faca0,_0x7e72d6[_0x42aa29(0xad6)](0x0,0x28)+(_0x7e72d6['length']>0x28?'...':'')),_0x1fe643=!![];}_0x19dae3&&(_0xa4d65(_0x38b8f8,_0x40c514),await new Promise(_0x3db8ce=>setTimeout(_0x3db8ce,Math['random']()*0x708+0x3e8)));}}_0x1be74f&&_0x58a059[_0x42aa29(0x732)]&&(_0x58a059['isAwaitingResponse']=![],_0x58a059['participants']['length']>0x0?_0x56dfd3():(_0x58a059={..._0x58a059,'isAwaitingResponse':![],'participants':[]},_0x541a81(_0x42aa29(0x10ba)),alert(_0x42aa29(0x80a))));if(_0xd89d66){await _0x5403b5();return;}await _0xa62efb[_0x42aa29(0xaa3)][_0x42aa29(0x546)](_0x40c514);const _0xd516e6=_0x474dba[_0x42aa29(0xe0f)](_0x575734=>_0x575734[_0x42aa29(0x919)]==='qzone_post'||_0x575734[_0x42aa29(0x919)]===_0x42aa29(0x1de)||_0x575734['type']===_0x42aa29(0x69e)||_0x575734[_0x42aa29(0x919)]===_0x42aa29(0x784));_0xd516e6&&(console['log'](_0x42aa29(0x81d)),await _0x3679f3());}catch(_0x3c2b87){_0x40c514[_0x42aa29(0xe83)]=_0x40c514['history'][_0x42aa29(0x2dd)](_0x4dbd70=>!_0x4dbd70[_0x42aa29(0x980)]),!_0x40c514[_0x42aa29(0x86e)]&&_0x40c514[_0x42aa29(0x1333)]?.[_0x42aa29(0x12d3)]===_0x42aa29(0xf51)?(_0x40c514[_0x42aa29(0x1333)]['status']='blocked_by_ai',await _0x184397(_0x42aa29(0xe54),_0x42aa29(0xf3d)+_0x3c2b87['message'])):await _0x184397(_0x42aa29(0x7e4),_0x42aa29(0x715)+_0x3c2b87[_0x42aa29(0x875)]),!_0x40c514[_0x42aa29(0x86e)]&&_0x40c514[_0x42aa29(0x1333)]?.[_0x42aa29(0x12d3)]===_0x42aa29(0xfb8)&&await _0xa62efb[_0x42aa29(0xaa3)][_0x42aa29(0x546)](_0x40c514),_0x58a059['isAwaitingResponse']=![];}finally{_0x415ffa(_0x1faca0,![]),_0x40c514['isGroup']?_0x3a6045&&(_0x3a6045[_0x42aa29(0x1284)][_0x42aa29(0x11d9)]=_0x42aa29(0xbf2)):_0x2f906f&&_0x53d851[_0x42aa29(0xaa3)][_0x1faca0]&&(_0x2f906f['style'][_0x42aa29(0x751)]=0x0,setTimeout(()=>{const _0x46b7da=_0x42aa29;_0x2f906f[_0x46b7da(0x34a)]=_0x53d851[_0x46b7da(0xaa3)][_0x1faca0]['name'],_0x2f906f['classList'][_0x46b7da(0x2d4)](_0x46b7da(0x67f)),_0x2f906f[_0x46b7da(0x1284)]['opacity']=0x1;},0xc8)),_0x5001a4(),_0x4c9eba&&_0x47d433(_0x1faca0),_0x10331c();}}async function _0x8e135b(_0x42ae47){const _0x17d466=_0x13d875;if(!_0x53d851['activeChatId'])return;const _0x21b750=_0x53d851[_0x17d466(0xaa3)][_0x53d851[_0x17d466(0x13be)]],_0x51a8b5={'role':_0x17d466(0x10ae),'content':_0x42ae47[_0x17d466(0xb36)],'meaning':_0x42ae47[_0x17d466(0x234)],'timestamp':Date[_0x17d466(0x9c1)]()};_0x21b750['history'][_0x17d466(0x7dd)](_0x51a8b5),await _0xa62efb[_0x17d466(0xaa3)][_0x17d466(0x546)](_0x21b750),_0xa4d65(_0x51a8b5,_0x21b750),_0x5001a4(),document['getElementById'](_0x17d466(0x6e0))[_0x17d466(0x1276)][_0x17d466(0x2d4)](_0x17d466(0xaef));}async function _0x254ecc(){const _0x1c6143=_0x13d875;if(!_0x53d851['activeChatId'])return;const _0x1a26e7=document[_0x1c6143(0x53a)](_0x1c6143(0xf00)),_0x1a1fc9=document[_0x1c6143(0x53a)](_0x1c6143(0x332)),_0x4e2971=parseFloat(_0x1a26e7[_0x1c6143(0x11a2)]),_0x53afc9=_0x1a1fc9[_0x1c6143(0x11a2)][_0x1c6143(0x13bc)]();if(isNaN(_0x4e2971)||_0x4e2971<0x0){alert(_0x1c6143(0x1227));return;}const _0x450a43=_0x53d851[_0x1c6143(0xaa3)][_0x53d851[_0x1c6143(0x13be)]],_0x4cc977=_0x450a43['isGroup']?_0x450a43[_0x1c6143(0x81e)][_0x1c6143(0x1303)]||'我':'我',_0xc37b7a=_0x450a43[_0x1c6143(0x86e)]?'群聊':_0x450a43[_0x1c6143(0x234)],_0x1faa3f={'role':_0x1c6143(0x10ae),'type':'transfer','amount':_0x4e2971,'note':_0x53afc9,'senderName':_0x4cc977,'receiverName':_0xc37b7a,'timestamp':Date['now']()};_0x450a43['history'][_0x1c6143(0x7dd)](_0x1faa3f),await _0xa62efb['chats'][_0x1c6143(0x546)](_0x450a43),_0xa4d65(_0x1faa3f,_0x450a43),_0x5001a4(),document[_0x1c6143(0x53a)](_0x1c6143(0x6ff))[_0x1c6143(0x1276)]['remove']('visible'),_0x1a26e7[_0x1c6143(0x11a2)]='',_0x1a1fc9[_0x1c6143(0x11a2)]='';}async function _0x452481(){const _0x57e474=_0x13d875;if(!_0x53d851['activeChatId'])return;const _0x1bf83c=document[_0x57e474(0x53a)](_0x57e474(0x9fd)),_0x21137e=document['getElementById']('waimai-amount'),_0xba3e2e=_0x1bf83c['value'][_0x57e474(0x13bc)](),_0x5cb268=parseFloat(_0x21137e[_0x57e474(0x11a2)]);if(!_0xba3e2e||isNaN(_0x5cb268)||_0x5cb268<=0x0){alert('请填写有效的商品信息和金额！');return;}const _0x24aa29=_0x53d851[_0x57e474(0xaa3)][_0x53d851[_0x57e474(0x13be)]],_0x5a5828=Date[_0x57e474(0x9c1)](),_0x527460=_0x24aa29['isGroup']?_0x24aa29[_0x57e474(0x81e)][_0x57e474(0x1303)]||'我':'我',_0x2c3c00={'role':_0x57e474(0x10ae),'senderName':_0x527460,'type':_0x57e474(0x907),'productInfo':_0xba3e2e,'amount':_0x5cb268,'timestamp':_0x5a5828};_0x24aa29[_0x57e474(0xe83)][_0x57e474(0x7dd)](_0x2c3c00);const _0x435bd4={'role':_0x57e474(0xab3),'content':'[系统提示：用户('+_0x527460+_0x57e474(0xe70)+_0xba3e2e+_0x57e474(0xc54)+_0x5cb268+_0x57e474(0x6dc),'timestamp':_0x5a5828+0x1,'isHidden':!![]};_0x24aa29[_0x57e474(0xe83)][_0x57e474(0x7dd)](_0x435bd4),await _0xa62efb['chats']['put'](_0x24aa29),_0xa4d65(_0x2c3c00,_0x24aa29),_0x5001a4(),_0x1bf83c[_0x57e474(0x11a2)]='',_0x21137e[_0x57e474(0x11a2)]='',document[_0x57e474(0x53a)]('waimai-request-modal')[_0x57e474(0x1276)]['remove'](_0x57e474(0xaef));}async function _0x43605f(){const _0x2f83f5=_0x13d875;if(!_0x53d851[_0x2f83f5(0x13be)])return;const _0x2ec63d=await _0x4f6537(_0x2f83f5(0x9c4),_0x2f83f5(0x1407),'');if(!_0x2ec63d||!_0x2ec63d[_0x2f83f5(0x13bc)]())return;const _0x478981=_0x2f83f5(0xfe4),_0x427bd2=_0x53d851[_0x2f83f5(0xaa3)][_0x53d851[_0x2f83f5(0x13be)]],_0x2c5af1={'role':'user','type':'location_share','content':_0x2ec63d['trim'](),'imageUrl':_0x478981,'timestamp':Date[_0x2f83f5(0x9c1)]()};_0x427bd2['history']['push'](_0x2c5af1),await _0xa62efb[_0x2f83f5(0xaa3)][_0x2f83f5(0x546)](_0x427bd2),_0xa4d65(_0x2c5af1,_0x427bd2),_0x5001a4();}function _0x1e26c7(_0x827543){const _0x2995db=_0x13d875;if(_0x375e24)return;_0x375e24=!![],document['getElementById'](_0x2995db(0x10ba))['classList'][_0x2995db(0xe13)](_0x2995db(0x35f)),_0x272362(_0x827543);}function _0x3c73fa(){const _0x9a5d3b=_0x13d875;_0x3db1bf();if(!_0x375e24)return;_0x375e24=![],document[_0x9a5d3b(0x53a)](_0x9a5d3b(0x10ba))['classList'][_0x9a5d3b(0x2d4)]('selection-mode'),_0x373402[_0x9a5d3b(0xeaf)](_0x3d8565=>{const _0x4006d5=_0x9a5d3b,_0x3c7030=document[_0x4006d5(0x139c)](_0x4006d5(0x3a9)+_0x3d8565+'\x22]');if(_0x3c7030)_0x3c7030[_0x4006d5(0x1276)][_0x4006d5(0x2d4)]('selected');}),_0x373402['clear']();}function _0x272362(_0x4290f9){const _0x3be034=_0x13d875,_0x5bb641=document[_0x3be034(0x139c)](_0x3be034(0x3a9)+_0x4290f9+'\x22]');if(!_0x5bb641)return;_0x373402['has'](_0x4290f9)?(_0x373402[_0x3be034(0x121e)](_0x4290f9),_0x5bb641[_0x3be034(0x1276)][_0x3be034(0x2d4)]('selected')):(_0x373402[_0x3be034(0xe13)](_0x4290f9),_0x5bb641[_0x3be034(0x1276)]['add'](_0x3be034(0x1015))),document[_0x3be034(0x53a)](_0x3be034(0x2ed))['textContent']='已选\x20'+_0x373402['size']+'\x20条',_0x373402['size']===0x0&&_0x3c73fa();}function _0x3146aa(_0x252ab7,_0x6277f3){const _0xc73961=_0x13d875;let _0x11b0b4;const _0x40c5f7=_0x108a8c=>{const _0x5bc91d=_0x55b8;if(_0x375e24)return;_0x108a8c[_0x5bc91d(0x1013)](),_0x11b0b4=window[_0x5bc91d(0x5fa)](()=>_0x6277f3(_0x108a8c),0x1f4);},_0x51db0e=()=>clearTimeout(_0x11b0b4);_0x252ab7[_0xc73961(0x1086)](_0xc73961(0xff3),_0x40c5f7),_0x252ab7[_0xc73961(0x1086)](_0xc73961(0xacd),_0x51db0e),_0x252ab7[_0xc73961(0x1086)](_0xc73961(0x355),_0x51db0e),_0x252ab7[_0xc73961(0x1086)]('touchstart',_0x40c5f7,{'passive':!![]}),_0x252ab7[_0xc73961(0x1086)](_0xc73961(0xab6),_0x51db0e),_0x252ab7[_0xc73961(0x1086)](_0xc73961(0xd22),_0x51db0e);}async function _0x38ee3d(){const _0x485584=_0x13d875,_0x296a23=_0x53d851['activeChatId'];if(!_0x296a23)return;if(!_0x2eebda[_0x485584(0x975)]){_0x599a31(_0x296a23);return;}if(_0x2eebda[_0x485584(0x13be)]===_0x296a23)document[_0x485584(0x53a)]('music-player-overlay')[_0x485584(0x1276)][_0x485584(0xe13)](_0x485584(0xaef));else{const _0x34cdd0=_0x53d851[_0x485584(0xaa3)][_0x2eebda[_0x485584(0x13be)]]?.[_0x485584(0x234)]||'未知',_0x143cbf=_0x53d851['chats'][_0x296a23]?.[_0x485584(0x234)]||'当前',_0x27aa11=await _0x355fc0(_0x485584(0xec6),_0x485584(0x826)+_0x34cdd0+_0x485584(0xebb)+_0x143cbf+_0x485584(0xd81),{'confirmButtonClass':_0x485584(0x264)});_0x27aa11&&(await _0x3b9a16(!![]),await new Promise(_0x21382b=>setTimeout(_0x21382b,0x32)),_0x599a31(_0x296a23));}}async function _0x599a31(_0x1cb34e){const _0x5ea812=_0x13d875,_0x2e0d22=_0x53d851[_0x5ea812(0xaa3)][_0x1cb34e];if(!_0x2e0d22)return;_0x2eebda[_0x5ea812(0x13d1)]=_0x2e0d22[_0x5ea812(0x59d)]['totalTime']||0x0,_0x2eebda[_0x5ea812(0x975)]=!![],_0x2eebda['activeChatId']=_0x1cb34e;_0x2eebda[_0x5ea812(0xc9a)][_0x5ea812(0x29d)]>0x0?_0x2eebda['currentIndex']=0x0:_0x2eebda[_0x5ea812(0xe7d)]=-0x1;if(_0x2eebda['timerId'])clearInterval(_0x2eebda[_0x5ea812(0xa0e)]);_0x2eebda[_0x5ea812(0xa0e)]=setInterval(()=>{const _0x29a3e6=_0x5ea812;_0x2eebda[_0x29a3e6(0x5a4)]&&(_0x2eebda[_0x29a3e6(0x13d1)]++,_0x4696ee());},0x3e8),_0x1dfd4f(),_0x3c76c6(),document[_0x5ea812(0x53a)](_0x5ea812(0x424))['classList'][_0x5ea812(0xe13)](_0x5ea812(0xaef));}async function _0x3b9a16(_0x163668=!![]){const _0x282492=_0x13d875;if(!_0x2eebda[_0x282492(0x975)])return;const _0x46919e=_0x2eebda[_0x282492(0x13be)];document[_0x282492(0x53a)]('global-lyrics-bar')['classList']['remove'](_0x282492(0xaef));const _0x302c3b=async()=>{const _0x308b96=_0x282492;if(_0x2eebda[_0x308b96(0xa0e)])clearInterval(_0x2eebda[_0x308b96(0xa0e)]);if(_0x2eebda[_0x308b96(0x5a4)])_0x2a3e73[_0x308b96(0xd54)]();if(_0x163668&&_0x46919e&&_0x53d851['chats'][_0x46919e]){const _0x2f3e06=_0x53d851[_0x308b96(0xaa3)][_0x46919e];_0x2f3e06[_0x308b96(0x59d)][_0x308b96(0xc4f)]=_0x2eebda[_0x308b96(0x13d1)],await _0xa62efb['chats'][_0x308b96(0x546)](_0x2f3e06);}_0x2eebda['isActive']=![],_0x2eebda[_0x308b96(0x13be)]=null,_0x2eebda[_0x308b96(0x13d1)]=0x0,_0x2eebda[_0x308b96(0xa0e)]=null,_0x45f399(_0x46919e,!![]);};_0x21af99(_0x302c3b);}function _0x49a196(){_0x21af99();}function _0x45f399(_0x4578e4,_0x3757f7=![]){const _0x44e978=_0x13d875,_0x5a47a4=document[_0x44e978(0x139c)](_0x44e978(0xeea));if(!_0x5a47a4)return;if(_0x3757f7||!_0x2eebda[_0x44e978(0x975)]||_0x2eebda['activeChatId']!==_0x4578e4){_0x5a47a4[_0x44e978(0x7ff)]=_0x44e978(0x655),_0x5a47a4[_0x44e978(0x6de)]='';return;}_0x5a47a4[_0x44e978(0x7ff)]=_0x44e978(0x40b),_0x5a47a4[_0x44e978(0x1276)]['add'](_0x44e978(0x4fe));if(_0x2eebda[_0x44e978(0x5a4)])_0x5a47a4['classList'][_0x44e978(0x2d4)](_0x44e978(0x8c5));else _0x5a47a4[_0x44e978(0x1276)][_0x44e978(0xe13)](_0x44e978(0x8c5));}window[_0x13d875(0x877)]=_0x45f399;function _0x1dfd4f(){const _0x7bd6a2=_0x13d875;_0x45f399(_0x2eebda[_0x7bd6a2(0x13be)]),_0x4696ee();const _0x223fbc=document['getElementById']('music-player-song-title'),_0x1fac7b=document[_0x7bd6a2(0x53a)](_0x7bd6a2(0x1101)),_0x10992c=document[_0x7bd6a2(0x53a)](_0x7bd6a2(0x41a));if(_0x2eebda[_0x7bd6a2(0xe7d)]>-0x1&&_0x2eebda['playlist'][_0x7bd6a2(0x29d)]>0x0){const _0x2cc72e=_0x2eebda[_0x7bd6a2(0xc9a)][_0x2eebda['currentIndex']];_0x223fbc[_0x7bd6a2(0x34a)]=_0x2cc72e[_0x7bd6a2(0x234)],_0x1fac7b[_0x7bd6a2(0x34a)]=_0x2cc72e[_0x7bd6a2(0x7cc)];}else _0x223fbc['textContent']=_0x7bd6a2(0x8df),_0x1fac7b[_0x7bd6a2(0x34a)]='...';_0x10992c[_0x7bd6a2(0x34a)]=_0x2eebda['isPlaying']?'❚❚':'▶';}function _0x4696ee(){const _0x1638fc=_0x13d875,_0x40cba2=(_0x2eebda[_0x1638fc(0x13d1)]/0xe10)['toFixed'](0x1);document['getElementById'](_0x1638fc(0xcb3))[_0x1638fc(0x34a)]=_0x1638fc(0xf63)+_0x40cba2+'小时';}function _0x3c76c6(){const _0x4b8c38=_0x13d875,_0x49b0c0=document[_0x4b8c38(0x53a)]('playlist-body');_0x49b0c0[_0x4b8c38(0xaac)]='';if(_0x2eebda[_0x4b8c38(0xc9a)][_0x4b8c38(0x29d)]===0x0){_0x49b0c0[_0x4b8c38(0xaac)]=_0x4b8c38(0x10d8);return;}_0x2eebda[_0x4b8c38(0xc9a)][_0x4b8c38(0xeaf)]((_0x532a84,_0x15a7e2)=>{const _0x290815=_0x4b8c38,_0x25959b=document[_0x290815(0xd67)]('div');_0x25959b['className']='playlist-item';if(_0x15a7e2===_0x2eebda[_0x290815(0xe7d)])_0x25959b[_0x290815(0x1276)][_0x290815(0xe13)]('playing');_0x25959b['innerHTML']=_0x290815(0x9d0)+_0x532a84[_0x290815(0x234)]+_0x290815(0xdf7)+_0x532a84['artist']+_0x290815(0x1087)+_0x15a7e2+_0x290815(0x822)+_0x15a7e2+'\x22>词</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心新增】在这里添加“背景”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20bg-btn\x22\x20data-index=\x22'+_0x15a7e2+'\x22>背景</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20delete-track-btn\x22\x20data-index=\x22'+_0x15a7e2+_0x290815(0xb61),_0x25959b[_0x290815(0x139c)](_0x290815(0xce8))['addEventListener'](_0x290815(0xb2b),()=>_0x2fd6d0(_0x15a7e2)),_0x49b0c0[_0x290815(0x133d)](_0x25959b);});}async function _0x190c27(){const _0xa1148a=_0x13d875;if(_0x2a3e73[_0xa1148a(0x8c5)]){if(_0x2eebda['currentIndex']===-0x1&&_0x2eebda[_0xa1148a(0xc9a)][_0xa1148a(0x29d)]>0x0)_0x2fd6d0(0x0);else _0x2eebda[_0xa1148a(0xe7d)]>-0x1&&_0x2fd6d0(_0x2eebda[_0xa1148a(0xe7d)]);}else _0x2a3e73[_0xa1148a(0xd54)](),await _0x363eee(_0xa1148a(0xcd5));}function _0x3bf151(){const _0x9ce728=_0x13d875;if(_0x2eebda['playlist'][_0x9ce728(0x29d)]===0x0)return;let _0x290b71;switch(_0x2eebda[_0x9ce728(0x10d4)]){case'random':_0x290b71=Math[_0x9ce728(0x7d5)](Math[_0x9ce728(0xac4)]()*_0x2eebda[_0x9ce728(0xc9a)]['length']);break;case'single':_0x2fd6d0(_0x2eebda['currentIndex']);return;case _0x9ce728(0x6fe):default:_0x290b71=(_0x2eebda[_0x9ce728(0xe7d)]+0x1)%_0x2eebda['playlist'][_0x9ce728(0x29d)];break;}_0x2fd6d0(_0x290b71);}function _0x427712(){const _0x2c47e9=_0x13d875;if(_0x2eebda['playlist'][_0x2c47e9(0x29d)]===0x0)return;const _0x268812=(_0x2eebda[_0x2c47e9(0xe7d)]-0x1+_0x2eebda['playlist'][_0x2c47e9(0x29d)])%_0x2eebda[_0x2c47e9(0xc9a)][_0x2c47e9(0x29d)];_0x2fd6d0(_0x268812);}function _0x3bcc48(){const _0x1018d1=_0x13d875,_0x452653=[_0x1018d1(0x6fe),_0x1018d1(0xac4),_0x1018d1(0x129b)],_0x4d0bb9=_0x452653[_0x1018d1(0x57c)](_0x2eebda[_0x1018d1(0x10d4)]);_0x2eebda[_0x1018d1(0x10d4)]=_0x452653[(_0x4d0bb9+0x1)%_0x452653['length']],document[_0x1018d1(0x53a)](_0x1018d1(0x6d4))[_0x1018d1(0x34a)]={'order':'顺序','random':'随机','single':'单曲'}[_0x2eebda[_0x1018d1(0x10d4)]];}async function _0x954234(){const _0x244c8b=_0x13d875,_0xbc5594=await _0x4f6537('添加网络歌曲',_0x244c8b(0x4dd),'',_0x244c8b(0xb36));if(!_0xbc5594)return;const _0x1f43fa=await _0x4f6537(_0x244c8b(0x4c0),_0x244c8b(0xf60));if(!_0x1f43fa)return;const _0x4cd732=await _0x4f6537(_0x244c8b(0x4c0),_0x244c8b(0xccd));if(!_0x4cd732)return;_0x2eebda[_0x244c8b(0xc9a)]['push']({'name':_0x1f43fa,'artist':_0x4cd732,'src':_0xbc5594,'isLocal':![]}),await _0x4cf2f7(),_0x3c76c6(),_0x2eebda[_0x244c8b(0xe7d)]===-0x1&&(_0x2eebda['currentIndex']=_0x2eebda[_0x244c8b(0xc9a)][_0x244c8b(0x29d)]-0x1,_0x1dfd4f());}async function _0x4314b8(_0x4c1663){const _0x1896f5=_0x13d875,_0x1db03d=_0x4c1663['target'][_0x1896f5(0x1413)];if(!_0x1db03d[_0x1896f5(0x29d)])return;for(const _0x1db03b of _0x1db03d){let _0x3bbed2=_0x1db03b[_0x1896f5(0x234)][_0x1896f5(0x795)](/\.[^/.]+$/,'');_0x3bbed2=await _0x4f6537(_0x1896f5(0x4c0),_0x1896f5(0xf60),_0x3bbed2);if(_0x3bbed2===null)continue;const _0x275bf4=await _0x4f6537('歌曲信息',_0x1896f5(0xccd),'未知歌手');if(_0x275bf4===null)continue;const _0x757f24=await _0x1db03b['arrayBuffer']();let _0xd4b4fc='';const _0x195997=await _0x355fc0(_0x1896f5(0x7ca),'要为《'+_0x3bbed2+_0x1896f5(0x1103));_0x195997&&(_0xd4b4fc=await _0xa6573b()||''),_0x2eebda[_0x1896f5(0xc9a)][_0x1896f5(0x7dd)]({'name':_0x3bbed2,'artist':_0x275bf4,'src':_0x757f24,'fileType':_0x1db03b[_0x1896f5(0x919)],'isLocal':!![],'lrcContent':_0xd4b4fc,'cover':_0x1896f5(0x982)});}await _0x4cf2f7(),_0x3c76c6(),_0x2eebda['currentIndex']===-0x1&&_0x2eebda[_0x1896f5(0xc9a)][_0x1896f5(0x29d)]>0x0&&(_0x2eebda[_0x1896f5(0xe7d)]=0x0,_0x1dfd4f()),_0x4c1663[_0x1896f5(0x9c2)]['value']=null;}async function _0x2fd6d0(_0x562cbb){const _0x1e3148=_0x13d875;if(_0x562cbb<0x0||_0x562cbb>=_0x2eebda[_0x1e3148(0xc9a)][_0x1e3148(0x29d)])return;_0x2a3e73['pause'](),_0x2eebda[_0x1e3148(0xe7d)]=_0x562cbb;const _0xf417f2=_0x2eebda['playlist'][_0x562cbb],_0x13615f=_0x53d851['chats'][_0x2eebda[_0x1e3148(0x13be)]],_0x24fab2=document['getElementById'](_0x1e3148(0xb16));if(_0x13615f&&_0x24fab2){_0x24fab2['innerHTML']='';const _0x232cde=_0x13615f['isGroup']?_0x13615f[_0x1e3148(0x3de)][_0x1e3148(0x397)](_0x4c8e87=>_0x4c8e87[_0x1e3148(0x543)]===_0xf417f2[_0x1e3148(0x7cc)])?.[_0x1e3148(0x8cd)]||_0x5d06c0:_0x13615f[_0x1e3148(0x81e)][_0x1e3148(0x9e3)]||_0x5d06c0,_0x4194b6=_0x13615f['settings'][_0x1e3148(0x971)]||_0x5d06c0,_0x4423a5=document['createElement'](_0x1e3148(0xe5b));_0x4423a5[_0x1e3148(0x7ff)]=_0x232cde,_0x4423a5[_0x1e3148(0x6de)]=_0x1e3148(0x2cb),_0x4423a5[_0x1e3148(0xffb)]='Character\x20Avatar',_0x24fab2[_0x1e3148(0x133d)](_0x4423a5);const _0x570a5c=document[_0x1e3148(0xd67)](_0x1e3148(0xe5b));_0x570a5c[_0x1e3148(0x7ff)]=_0x4194b6,_0x570a5c['className']=_0x1e3148(0x2cb),_0x570a5c[_0x1e3148(0xffb)]=_0x1e3148(0xd58),_0x24fab2['appendChild'](_0x570a5c);}const _0x5307d3=document['querySelector'](_0x1e3148(0xb3c)),_0x39d1b6=document[_0x1e3148(0x53a)]('toggle-blur-btn');_0x5307d3&&(_0x5307d3['style'][_0x1e3148(0x5ed)](_0x1e3148(0x287),_0xf417f2[_0x1e3148(0x274)]?_0x1e3148(0xf22)+_0xf417f2[_0x1e3148(0x274)]+')':_0x1e3148(0xbf2)),_0x5307d3[_0x1e3148(0x1276)][_0x1e3148(0x4d7)](_0x1e3148(0x1416),!!_0xf417f2[_0x1e3148(0xf40)]));_0x39d1b6&&_0x39d1b6[_0x1e3148(0x1276)][_0x1e3148(0x4d7)](_0x1e3148(0xdf6),!!_0xf417f2[_0x1e3148(0xf40)]);document['getElementById'](_0x1e3148(0x1137))['classList']['remove']('lyrics-active');const _0x384363=document[_0x1e3148(0x53a)](_0x1e3148(0xa75));_0x384363&&(_0x384363['src']=_0xf417f2[_0x1e3148(0x100f)]||_0x1e3148(0x982));await _0x363eee('将歌曲切换为了《'+_0xf417f2[_0x1e3148(0x234)]+'》'),_0x2eebda[_0x1e3148(0xd4b)]=_0x5a24fc(_0xf417f2[_0x1e3148(0x917)]||''),_0x354707();const _0x861937=document[_0x1e3148(0x53a)]('single-lyric-display');_0x861937&&(!_0x2eebda[_0x1e3148(0xd4b)]||_0x2eebda[_0x1e3148(0xd4b)][_0x1e3148(0x29d)]===0x0?_0x861937[_0x1e3148(0x34a)]=_0x1e3148(0x22e):_0x861937[_0x1e3148(0x34a)]=_0x1e3148(0x59b));if(_0xf417f2[_0x1e3148(0xfe6)]&&_0xf417f2[_0x1e3148(0x7ff)]instanceof ArrayBuffer){const _0x29de9f=new Blob([_0xf417f2['src']],{'type':_0xf417f2[_0x1e3148(0xea7)]||_0x1e3148(0x1204)});_0x2a3e73['src']=URL['createObjectURL'](_0x29de9f);}else{if(_0xf417f2[_0x1e3148(0xfe6)]&&_0xf417f2['src']instanceof Blob)_0x2a3e73[_0x1e3148(0x7ff)]=URL[_0x1e3148(0xaa0)](_0xf417f2[_0x1e3148(0x7ff)]);else{if(!_0xf417f2['isLocal'])_0x2a3e73['src']=_0xf417f2['src'];else{console[_0x1e3148(0x617)](_0x1e3148(0xf8a),_0xf417f2);return;}}}const _0xb543ce=_0x2a3e73[_0x1e3148(0x116c)]();_0xb543ce!==undefined&&_0xb543ce[_0x1e3148(0x9cb)](_0x5908d1=>{const _0x569f37=_0x1e3148;if(_0x5908d1['name']===_0x569f37(0x3b1))console[_0x569f37(0xad0)](_0x569f37(0xa35)),_0x2a3e73[_0x569f37(0xd54)](),_0x184397('播放已暂停',_0x569f37(0xc8d));else _0x5908d1['name']!==_0x569f37(0x787)&&console[_0x569f37(0x617)](_0x569f37(0x9ae),_0x5908d1);});_0x3c76c6(),_0x1dfd4f(),_0x255c27();const _0x4d9f34=document[_0x1e3148(0x53a)](_0x1e3148(0x144c));_0x2eebda[_0x1e3148(0xd4b)]&&_0x2eebda['parsedLyrics']['length']>0x0?(_0x4d9f34[_0x1e3148(0x34a)]='♪',_0x4d9f34[_0x1e3148(0x1276)][_0x1e3148(0xe13)]('visible')):_0x4d9f34[_0x1e3148(0x1276)][_0x1e3148(0x2d4)](_0x1e3148(0xaef));}async function _0x4cd737(_0x7fb8a1){const _0x3ff004=_0x13d875;if(_0x7fb8a1<0x0||_0x7fb8a1>=_0x2eebda[_0x3ff004(0xc9a)][_0x3ff004(0x29d)])return;const _0x120f89=await _0x34ea2c(_0x3ff004(0x815),[{'text':_0x3ff004(0x1352),'value':_0x3ff004(0x3f3)},{'text':_0x3ff004(0x476),'value':_0x3ff004(0xb36)}]);let _0x633325=null;if(_0x120f89==='local')_0x633325=await _0x15351c();else _0x120f89===_0x3ff004(0xb36)&&(_0x633325=await _0x4f6537('输入图片URL',_0x3ff004(0x105b),'','url'));if(_0x633325&&_0x633325[_0x3ff004(0x13bc)]()){_0x2eebda[_0x3ff004(0xc9a)][_0x7fb8a1][_0x3ff004(0x274)]=_0x633325[_0x3ff004(0x13bc)](),await _0x4cf2f7();if(_0x2eebda[_0x3ff004(0xe7d)]===_0x7fb8a1){const _0x5d3e48=document[_0x3ff004(0x139c)](_0x3ff004(0xb3c));_0x5d3e48[_0x3ff004(0x1284)][_0x3ff004(0x5ed)](_0x3ff004(0x287),_0x3ff004(0xf22)+_0x633325[_0x3ff004(0x13bc)]()+')');}await _0x184397('成功','歌曲背景已更新！');}}async function _0x39ba5a(_0x496d1c){const _0x1e248b=_0x13d875;if(_0x496d1c<0x0||_0x496d1c>=_0x2eebda[_0x1e248b(0xc9a)][_0x1e248b(0x29d)])return;const _0x2c933b=await _0x34ea2c(_0x1e248b(0x6d9),[{'text':_0x1e248b(0x1352),'value':_0x1e248b(0x3f3)},{'text':'🌐\x20使用网络URL','value':_0x1e248b(0xb36)}]);let _0x50f7bc=null;if(_0x2c933b===_0x1e248b(0x3f3))_0x50f7bc=await _0x15351c();else _0x2c933b===_0x1e248b(0xb36)&&(_0x50f7bc=await _0x4f6537(_0x1e248b(0xdda),_0x1e248b(0x88e),'',_0x1e248b(0xb36)));if(_0x50f7bc&&_0x50f7bc[_0x1e248b(0x13bc)]()){_0x2eebda[_0x1e248b(0xc9a)][_0x496d1c][_0x1e248b(0x100f)]=_0x50f7bc[_0x1e248b(0x13bc)](),await _0x4cf2f7();if(_0x2eebda[_0x1e248b(0xe7d)]===_0x496d1c){document[_0x1e248b(0x53a)](_0x1e248b(0xa75))[_0x1e248b(0x7ff)]=_0x50f7bc['trim']();const _0x5c8491=document[_0x1e248b(0x139c)]('#vinyl-view\x20#music-player-cover');if(_0x5c8491)_0x5c8491[_0x1e248b(0x7ff)]=_0x50f7bc[_0x1e248b(0x13bc)]();}await _0x184397('成功',_0x1e248b(0xe8c));}}async function _0x3180d7(_0x5d64c0){const _0x3e1fcc=_0x13d875;if(_0x5d64c0<0x0||_0x5d64c0>=_0x2eebda[_0x3e1fcc(0xc9a)][_0x3e1fcc(0x29d)])return;const _0x501a5d=_0x2eebda[_0x3e1fcc(0xc9a)][_0x5d64c0],_0xbcbb6d=_0x2eebda[_0x3e1fcc(0x5a4)]&&_0x2eebda['currentIndex']===_0x5d64c0;if(_0x501a5d[_0x3e1fcc(0xfe6)]&&_0x2a3e73['src'][_0x3e1fcc(0x1200)]('blob:')&&_0x2eebda['currentIndex']===_0x5d64c0)URL[_0x3e1fcc(0x39b)](_0x2a3e73[_0x3e1fcc(0x7ff)]);_0x2eebda[_0x3e1fcc(0xc9a)][_0x3e1fcc(0x1331)](_0x5d64c0,0x1),await _0x4cf2f7();if(_0x2eebda[_0x3e1fcc(0xc9a)][_0x3e1fcc(0x29d)]===0x0){if(_0x2eebda[_0x3e1fcc(0x5a4)])_0x2a3e73[_0x3e1fcc(0xd54)]();_0x2a3e73[_0x3e1fcc(0x7ff)]='',_0x2eebda[_0x3e1fcc(0xe7d)]=-0x1,_0x2eebda[_0x3e1fcc(0x5a4)]=![];}else{if(_0xbcbb6d)_0x3bf151();else{if(_0x2eebda[_0x3e1fcc(0xe7d)]>=_0x5d64c0)_0x2eebda['currentIndex']=Math[_0x3e1fcc(0x69b)](0x0,_0x2eebda[_0x3e1fcc(0xe7d)]-0x1);}}_0x1dfd4f(),_0x3c76c6();}async function _0x4314b8(_0x48d78d){const _0x5e5f44=_0x13d875,_0x2afa1b=_0x48d78d['target']['files'];if(!_0x2afa1b[_0x5e5f44(0x29d)])return;for(const _0xf7c29d of _0x2afa1b){let _0x8187f=_0xf7c29d[_0x5e5f44(0x234)][_0x5e5f44(0x795)](/\.[^/.]+$/,'');_0x8187f=await _0x4f6537(_0x5e5f44(0x4c0),_0x5e5f44(0xf60),_0x8187f);if(_0x8187f===null)continue;const _0xb82869=await _0x4f6537(_0x5e5f44(0x4c0),'请输入歌手名',_0x5e5f44(0x246));if(_0xb82869===null)continue;let _0x498860='';const _0x5109ee=await _0x355fc0(_0x5e5f44(0x7ca),_0x5e5f44(0x349)+_0x8187f+_0x5e5f44(0x1103));_0x5109ee&&(_0x498860=await _0xa6573b()||''),_0x2eebda[_0x5e5f44(0xc9a)][_0x5e5f44(0x7dd)]({'name':_0x8187f,'artist':_0xb82869,'src':_0xf7c29d,'isLocal':!![],'lrcContent':_0x498860});}await _0x4cf2f7(),_0x3c76c6(),_0x2eebda['currentIndex']===-0x1&&_0x2eebda[_0x5e5f44(0xc9a)][_0x5e5f44(0x29d)]>0x0&&(_0x2eebda[_0x5e5f44(0xe7d)]=0x0,_0x1dfd4f()),_0x48d78d[_0x5e5f44(0x9c2)][_0x5e5f44(0x11a2)]=null;}async function _0x3180d7(_0x249059){const _0x3c1e57=_0x13d875;if(_0x249059<0x0||_0x249059>=_0x2eebda[_0x3c1e57(0xc9a)][_0x3c1e57(0x29d)])return;const _0x1f205c=_0x2eebda[_0x3c1e57(0xc9a)][_0x249059],_0x269da1=_0x2eebda[_0x3c1e57(0x5a4)]&&_0x2eebda['currentIndex']===_0x249059;if(_0x1f205c['isLocal']&&_0x2a3e73[_0x3c1e57(0x7ff)][_0x3c1e57(0x1200)](_0x3c1e57(0x842))&&_0x2eebda[_0x3c1e57(0xe7d)]===_0x249059)URL[_0x3c1e57(0x39b)](_0x2a3e73['src']);_0x2eebda['playlist'][_0x3c1e57(0x1331)](_0x249059,0x1),await _0x4cf2f7();if(_0x2eebda[_0x3c1e57(0xc9a)]['length']===0x0){if(_0x2eebda[_0x3c1e57(0x5a4)])_0x2a3e73[_0x3c1e57(0xd54)]();_0x2a3e73[_0x3c1e57(0x7ff)]='',_0x2eebda[_0x3c1e57(0xe7d)]=-0x1,_0x2eebda['isPlaying']=![];}else{if(_0x269da1)_0x3bf151();else{if(_0x2eebda['currentIndex']>=_0x249059)_0x2eebda['currentIndex']=Math['max'](0x0,_0x2eebda['currentIndex']-0x1);}}_0x1dfd4f(),_0x3c76c6();}const _0x4f6106=document[_0x13d875(0x53a)](_0x13d875(0x463)),_0x107b3e=document[_0x13d875(0x53a)](_0x13d875(0x719)),_0x167fbf=document['getElementById'](_0x13d875(0x122a));function _0x14b870(){const _0x55bd23=_0x13d875;_0x204819(),_0x4f6106['classList'][_0x55bd23(0xe13)](_0x55bd23(0xaef));}function _0x3d9862(){const _0x11bbec=_0x13d875;_0x4f6106[_0x11bbec(0x1276)][_0x11bbec(0x2d4)](_0x11bbec(0xaef));}function _0x204819(){const _0x50a595=_0x13d875,_0x32f394=document['getElementById'](_0x50a595(0xc12));_0x32f394[_0x50a595(0xaac)]='';if(_0x53d851[_0x50a595(0x7c7)][_0x50a595(0x29d)]===0x0){_0x32f394['innerHTML']=_0x50a595(0x2b2);return;}_0x53d851['personaPresets']['forEach'](_0x12f42b=>{const _0xee502a=_0x50a595,_0x194b37=document[_0xee502a(0xd67)](_0xee502a(0x1425));_0x194b37['className']='persona-preset-item',_0x194b37[_0xee502a(0x1284)][_0xee502a(0x2f2)]=_0xee502a(0xf22)+_0x12f42b['avatar']+')',_0x194b37['dataset'][_0xee502a(0x915)]=_0x12f42b['id'],_0x194b37[_0xee502a(0x1086)](_0xee502a(0xb2b),()=>_0x5b38c9(_0x12f42b['id'])),_0x3146aa(_0x194b37,()=>_0x1a15e4(_0x12f42b['id'])),_0x32f394[_0xee502a(0x133d)](_0x194b37);});}function _0x1a15e4(_0xa6fbbf){const _0x3bad11=_0x13d875;_0x445d67=_0xa6fbbf,_0x167fbf[_0x3bad11(0x1276)][_0x3bad11(0xe13)](_0x3bad11(0xaef));}function _0x2b4d91(){const _0x946117=_0x13d875;_0x167fbf[_0x946117(0x1276)]['remove'](_0x946117(0xaef)),_0x445d67=null;}function _0x5b38c9(_0x10a15f){const _0x994c8c=_0x13d875,_0x1251b0=_0x53d851['personaPresets'][_0x994c8c(0x397)](_0x3ead40=>_0x3ead40['id']===_0x10a15f);_0x1251b0&&(document[_0x994c8c(0x53a)](_0x994c8c(0xb96))['src']=_0x1251b0['avatar'],document[_0x994c8c(0x53a)](_0x994c8c(0x1264))[_0x994c8c(0x11a2)]=_0x1251b0[_0x994c8c(0x11fb)]),_0x3d9862();}function _0x1158a0(){const _0x5c5a87=_0x13d875;_0x445d67=null,document['getElementById']('persona-editor-title')[_0x5c5a87(0x34a)]=_0x5c5a87(0x1090),document[_0x5c5a87(0x53a)]('preset-avatar-preview')[_0x5c5a87(0x7ff)]=_0x5d06c0,document[_0x5c5a87(0x53a)](_0x5c5a87(0xb06))[_0x5c5a87(0x11a2)]='',_0x107b3e['classList'][_0x5c5a87(0xe13)]('visible');}function _0x36ec0a(){const _0x34d335=_0x13d875,_0x14d647=_0x53d851[_0x34d335(0x7c7)][_0x34d335(0x397)](_0x1bc644=>_0x1bc644['id']===_0x445d67);if(!_0x14d647)return;document['getElementById'](_0x34d335(0xadd))[_0x34d335(0x34a)]=_0x34d335(0x1367),document[_0x34d335(0x53a)](_0x34d335(0xa05))['src']=_0x14d647[_0x34d335(0x8cd)],document[_0x34d335(0x53a)](_0x34d335(0xb06))[_0x34d335(0x11a2)]=_0x14d647[_0x34d335(0x11fb)],_0x167fbf[_0x34d335(0x1276)]['remove'](_0x34d335(0xaef)),_0x107b3e[_0x34d335(0x1276)][_0x34d335(0xe13)](_0x34d335(0xaef));}async function _0x19f093(){const _0x3991c7=_0x13d875,_0x5d91ac=await _0x355fc0(_0x3991c7(0x1163),_0x3991c7(0x11aa),{'confirmButtonClass':'btn-danger'});_0x5d91ac&&_0x445d67&&(await _0xa62efb['personaPresets'][_0x3991c7(0x121e)](_0x445d67),_0x53d851[_0x3991c7(0x7c7)]=_0x53d851[_0x3991c7(0x7c7)][_0x3991c7(0x2dd)](_0x4ddcc7=>_0x4ddcc7['id']!==_0x445d67),_0x2b4d91(),_0x204819());}function _0x5c7035(){const _0x47fc9a=_0x13d875;_0x107b3e[_0x47fc9a(0x1276)][_0x47fc9a(0x2d4)](_0x47fc9a(0xaef)),_0x445d67=null;}async function _0xcf3fd5(){const _0x3a5d27=_0x13d875,_0xb1d72e=document['getElementById'](_0x3a5d27(0xa05))[_0x3a5d27(0x7ff)],_0x5c1a79=document[_0x3a5d27(0x53a)]('preset-persona-input')['value']['trim']();if(_0xb1d72e===_0x5d06c0&&!_0x5c1a79){alert(_0x3a5d27(0x793));return;}if(_0x445d67){const _0x4085f7=_0x53d851[_0x3a5d27(0x7c7)][_0x3a5d27(0x397)](_0x386c09=>_0x386c09['id']===_0x445d67);_0x4085f7&&(_0x4085f7[_0x3a5d27(0x8cd)]=_0xb1d72e,_0x4085f7[_0x3a5d27(0x11fb)]=_0x5c1a79,await _0xa62efb[_0x3a5d27(0x7c7)][_0x3a5d27(0x546)](_0x4085f7));}else{const _0xedf26a={'id':_0x3a5d27(0xb68)+Date[_0x3a5d27(0x9c1)](),'avatar':_0xb1d72e,'persona':_0x5c1a79};await _0xa62efb[_0x3a5d27(0x7c7)][_0x3a5d27(0xe13)](_0xedf26a),_0x53d851[_0x3a5d27(0x7c7)][_0x3a5d27(0x7dd)](_0xedf26a);}_0x204819(),_0x5c7035();}const _0x5b1904=document[_0x13d875(0x53a)](_0x13d875(0xc09));function _0x48eb59(_0x54b3c7,_0x4edeb1){const _0x1b2fd5=_0x13d875;clearTimeout(_0x181e60),document['getElementById'](_0x1b2fd5(0xd0f))[_0x1b2fd5(0x7ff)]=_0x54b3c7,document[_0x1b2fd5(0x53a)](_0x1b2fd5(0x59a))[_0x1b2fd5(0x34a)]=_0x4edeb1,_0x5b1904[_0x1b2fd5(0x1276)][_0x1b2fd5(0xe13)](_0x1b2fd5(0xaef));const _0x329622=()=>{const _0x3de6be=_0x1b2fd5;_0x5b1904[_0x3de6be(0x1276)][_0x3de6be(0x2d4)]('visible'),_0x5b1904[_0x3de6be(0x5ce)](_0x3de6be(0xb2b),_0x329622);};_0x5b1904['addEventListener'](_0x1b2fd5(0xb2b),_0x329622),_0x181e60=setTimeout(_0x329622,0x7d0);}function _0x27fdf0(_0x418da2){const _0x301c06=_0x13d875,_0x3fa28d=document[_0x301c06(0x53a)](_0x301c06(0xe89)),_0x4bc77e=_0x3fa28d[_0x301c06(0x139c)](_0x301c06(0x1041)),_0x559f1a=_0x3fa28d[_0x301c06(0x139c)]('.battery-text'),_0x28d98b=Math[_0x301c06(0x7d5)](_0x418da2[_0x301c06(0x6e1)]*0x64);_0x4bc77e[_0x301c06(0x1284)]['width']=_0x28d98b+'%',_0x559f1a[_0x301c06(0x34a)]=_0x28d98b+'%',_0x418da2['charging']?_0x3fa28d[_0x301c06(0x1276)][_0x301c06(0xe13)](_0x301c06(0x1342)):_0x3fa28d['classList'][_0x301c06(0x2d4)](_0x301c06(0x1342));}function _0x2f5510(_0x39221e){const _0x150ec3=_0x13d875;_0x27fdf0(_0x39221e);const _0x1f22dc=_0x39221e[_0x150ec3(0x6e1)];!_0x39221e[_0x150ec3(0x1342)]&&(_0x1f22dc<=0.4&&_0x2b784e>0.4&&!_0x3be265[_0x150ec3(0x54b)]&&(_0x48eb59(_0x150ec3(0x13cd),'有点饿了，可以去找充电器惹'),_0x3be265['hasShown40']=!![]),_0x1f22dc<=0.2&&_0x2b784e>0.2&&!_0x3be265['hasShown20']&&(_0x48eb59('https://i.postimg.cc/qB9zbKs9/20.jpg',_0x150ec3(0x88d)),_0x3be265[_0x150ec3(0x9ff)]=!![]),_0x1f22dc<=0.1&&_0x2b784e>0.1&&!_0x3be265[_0x150ec3(0x107b)]&&(_0x48eb59(_0x150ec3(0xa4f),_0x150ec3(0xa13)),_0x3be265['hasShown10']=!![]));if(_0x1f22dc>0.4)_0x3be265[_0x150ec3(0x54b)]=![];if(_0x1f22dc>0.2)_0x3be265['hasShown20']=![];if(_0x1f22dc>0.1)_0x3be265[_0x150ec3(0x107b)]=![];_0x2b784e=_0x1f22dc;}async function _0x26bf05(){const _0x5d0136=_0x13d875;if(_0x5d0136(0x1105)in navigator)try{const _0x4cfa45=await navigator[_0x5d0136(0x1105)]();_0x2b784e=_0x4cfa45['level'],_0x2f5510(_0x4cfa45),_0x4cfa45[_0x5d0136(0x1086)](_0x5d0136(0xaa2),()=>_0x2f5510(_0x4cfa45)),_0x4cfa45[_0x5d0136(0x1086)]('chargingchange',()=>{const _0x21bab1=_0x5d0136;_0x2f5510(_0x4cfa45),_0x4cfa45['charging']&&_0x48eb59(_0x21bab1(0xf4c),_0x21bab1(0xde3));});}catch(_0xaea41c){console[_0x5d0136(0x617)](_0x5d0136(0x6a7),_0xaea41c),document[_0x5d0136(0x139c)](_0x5d0136(0x1255))[_0x5d0136(0x34a)]=_0x5d0136(0x544);}else console[_0x5d0136(0x1081)](_0x5d0136(0xb53)),document[_0x5d0136(0x139c)](_0x5d0136(0x1255))[_0x5d0136(0x34a)]=_0x5d0136(0x544);}async function _0x4a3063(){const _0xf46451=_0x13d875,_0x2e9a56=document[_0xf46451(0x53a)](_0xf46451(0x1df));if(!_0x2e9a56)return;const _0x307f6f=await _0xa62efb[_0xf46451(0x7a3)][_0xf46451(0x1064)](_0xf46451(0xa67))[_0xf46451(0x843)]()[_0xf46451(0xa73)]();_0x2e9a56['innerHTML']='';if(_0x307f6f['length']===0x0){_0x2e9a56['innerHTML']=_0xf46451(0x102f);return;}_0x307f6f[_0xf46451(0xeaf)](_0x26f970=>{const _0x190201=_0xf46451,_0x2626b5=document['createElement'](_0x190201(0x1425));_0x2626b5['className']=_0x190201(0x9ad),_0x2626b5['innerHTML']=_0x190201(0x12c7)+_0x26f970[_0x190201(0x108e)]+_0x190201(0x7aa)+_0x26f970[_0x190201(0x234)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-count\x22>'+(_0x26f970[_0x190201(0x721)]||0x0)+'\x20张</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x2626b5[_0x190201(0x1086)](_0x190201(0xb2b),()=>{_0x4c786a(_0x26f970['id']);}),_0x3146aa(_0x2626b5,async()=>{const _0x44ebba=_0x190201,_0x57514f=await _0x355fc0(_0x44ebba(0x7e9),_0x44ebba(0x1150)+_0x26f970[_0x44ebba(0x234)]+_0x44ebba(0x11dd),{'confirmButtonClass':'btn-danger'});_0x57514f&&(await _0xa62efb[_0x44ebba(0x1272)][_0x44ebba(0x57e)](_0x44ebba(0x814))[_0x44ebba(0x12f6)](_0x26f970['id'])[_0x44ebba(0x121e)](),await _0xa62efb[_0x44ebba(0x7a3)][_0x44ebba(0x121e)](_0x26f970['id']),await _0x4a3063(),alert('相册已成功删除。'));}),_0x2e9a56[_0x190201(0x133d)](_0x2626b5);});}async function _0x4c786a(_0x289e1c){const _0x3c6dbb=_0x13d875;_0x53d851['activeAlbumId']=_0x289e1c,await _0x384a29(),_0x541a81(_0x3c6dbb(0x8bb));}async function _0x384a29(){const _0x35d9ab=_0x13d875;if(!_0x53d851[_0x35d9ab(0x96b)])return;const _0x14ee41=document[_0x35d9ab(0x53a)]('photos-grid-page'),_0x48a339=document[_0x35d9ab(0x53a)](_0x35d9ab(0x9d9)),_0x220d07=await _0xa62efb[_0x35d9ab(0x7a3)][_0x35d9ab(0x883)](_0x53d851[_0x35d9ab(0x96b)]);if(!_0x220d07){console[_0x35d9ab(0x617)](_0x35d9ab(0x83e),_0x53d851[_0x35d9ab(0x96b)]),_0x541a81(_0x35d9ab(0x638));return;}_0x48a339['textContent']=_0x220d07['name'];const _0x38e99a=await _0xa62efb[_0x35d9ab(0x1272)][_0x35d9ab(0x57e)](_0x35d9ab(0x814))[_0x35d9ab(0x12f6)](_0x53d851[_0x35d9ab(0x96b)])[_0x35d9ab(0xa73)]();_0x14ee41[_0x35d9ab(0xaac)]='',_0x38e99a['length']===0x0?_0x14ee41[_0x35d9ab(0xaac)]=_0x35d9ab(0x896):_0x38e99a['forEach'](_0x53a02e=>{const _0x3826cc=_0x35d9ab,_0x2a0b96=document['createElement'](_0x3826cc(0x1425));_0x2a0b96[_0x3826cc(0x6de)]=_0x3826cc(0x497),_0x2a0b96[_0x3826cc(0xaac)]=_0x3826cc(0x660)+_0x53a02e[_0x3826cc(0xb36)]+'\x22\x20class=\x22photo-thumb\x22\x20alt=\x22相册照片\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22photo-delete-btn\x22\x20data-photo-id=\x22'+_0x53a02e['id']+_0x3826cc(0x22b),_0x14ee41['appendChild'](_0x2a0b96);});}async function _0x58d1df(_0x238321){const _0x38624e=_0x13d875;if(!_0x53d851[_0x38624e(0x96b)])return;const _0x1111c0=await _0xa62efb['qzonePhotos'][_0x38624e(0x57e)](_0x38624e(0x814))[_0x38624e(0x12f6)](_0x53d851['activeAlbumId'])[_0x38624e(0xa73)]();_0x21503a['photos']=_0x1111c0[_0x38624e(0xcb4)](_0x5687f2=>_0x5687f2[_0x38624e(0xb36)]),_0x21503a[_0x38624e(0xe7d)]=_0x21503a['photos'][_0x38624e(0x298)](_0x4c6f8e=>_0x4c6f8e===_0x238321);if(_0x21503a[_0x38624e(0xe7d)]===-0x1)return;document[_0x38624e(0x53a)](_0x38624e(0xb47))['classList']['add'](_0x38624e(0xaef)),_0x45e92f(),_0x21503a[_0x38624e(0xb11)]=!![];}function _0x45e92f(){const _0x5d370a=_0x13d875;if(_0x21503a[_0x5d370a(0xe7d)]===-0x1)return;const _0x44b637=document[_0x5d370a(0x53a)](_0x5d370a(0xd2d)),_0x16b161=document[_0x5d370a(0x53a)](_0x5d370a(0x108c)),_0x40a32e=document['getElementById'](_0x5d370a(0x614));_0x44b637[_0x5d370a(0x1284)]['opacity']=0x0,setTimeout(()=>{const _0x19db10=_0x5d370a;_0x44b637[_0x19db10(0x7ff)]=_0x21503a['photos'][_0x21503a[_0x19db10(0xe7d)]],_0x44b637[_0x19db10(0x1284)]['opacity']=0x1;},0x64),_0x16b161[_0x5d370a(0xb77)]=_0x21503a[_0x5d370a(0xe7d)]===0x0,_0x40a32e[_0x5d370a(0xb77)]=_0x21503a['currentIndex']===_0x21503a['photos'][_0x5d370a(0x29d)]-0x1;}function _0xed7e51(){const _0x4c49bb=_0x13d875;_0x21503a[_0x4c49bb(0xe7d)]<_0x21503a[_0x4c49bb(0xd43)][_0x4c49bb(0x29d)]-0x1&&(_0x21503a[_0x4c49bb(0xe7d)]++,_0x45e92f());}function _0x67bb9e(){const _0x361817=_0x13d875;_0x21503a[_0x361817(0xe7d)]>0x0&&(_0x21503a[_0x361817(0xe7d)]--,_0x45e92f());}function _0x20ef11(){const _0x28bb23=_0x13d875;document[_0x28bb23(0x53a)]('photo-viewer-modal')[_0x28bb23(0x1276)]['remove'](_0x28bb23(0xaef)),_0x21503a[_0x28bb23(0xb11)]=![],_0x21503a[_0x28bb23(0xd43)]=[],_0x21503a[_0x28bb23(0xe7d)]=-0x1,document[_0x28bb23(0x53a)](_0x28bb23(0xd2d))[_0x28bb23(0x7ff)]='';}function _0x5bac35(_0x3c100f){const _0x227b98=_0x13d875;_0x13cfad=_0x3c100f,localStorage[_0x227b98(0xf64)](_0x227b98(0x958),_0x3c100f);const _0x370c07=document['querySelector']('.nav-item[data-view=\x22qzone-screen\x22]'),_0x4a3459=_0x370c07[_0x227b98(0x139c)](_0x227b98(0x5a3));let _0x273720=_0x370c07[_0x227b98(0x139c)](_0x227b98(0x9a7));_0x3c100f>0x0?(!_0x273720&&(_0x273720=document[_0x227b98(0xd67)](_0x227b98(0x5a3)),_0x273720[_0x227b98(0x6de)]=_0x227b98(0x10b6),_0x4a3459[_0x227b98(0x1284)][_0x227b98(0x5d3)]=_0x227b98(0xd9d),_0x4a3459[_0x227b98(0x133d)](_0x273720)),_0x273720[_0x227b98(0x34a)]=_0x3c100f>0x63?'99+':_0x3c100f,_0x273720['style'][_0x227b98(0x11d9)]='block'):_0x273720&&(_0x273720['style'][_0x227b98(0x11d9)]=_0x227b98(0xbf2)),_0x5983f0();}function _0x148146(){const _0x6c4965=_0x13d875;if(_0x70fcd)return;const _0x4dffab=_0x53d851[_0x6c4965(0x906)][_0x6c4965(0xf27)]||0x3c;_0x70fcd=setInterval(_0x165d06,_0x4dffab*0x3e8),_0x3c8ff9();}function _0xb50323(){_0x70fcd&&(clearInterval(_0x70fcd),_0x70fcd=null),_0x10331c();}async function _0x165d06(){const _0x4bc2ae=_0x13d875;console['log'](_0x4bc2ae(0x8d0));if(!_0x53d851[_0x4bc2ae(0x906)][_0x4bc2ae(0x527)]){_0xb50323();return;}const _0x293b5a=Object[_0x4bc2ae(0x244)](_0x53d851[_0x4bc2ae(0xaa3)])[_0x4bc2ae(0x2dd)](_0xd2099b=>!_0xd2099b[_0x4bc2ae(0x86e)]);_0x293b5a[_0x4bc2ae(0xeaf)](_0x1cc2c1=>{const _0x183495=_0x4bc2ae;if(_0x1cc2c1['relationship']?.[_0x183495(0x12d3)]===_0x183495(0x133c)){const _0x40ff4b=_0x1cc2c1[_0x183495(0x1333)][_0x183495(0xde7)];if(!_0x40ff4b)return;const _0x4b8019=Date[_0x183495(0x9c1)]()-_0x40ff4b,_0x53b3f6=(_0x53d851[_0x183495(0x906)]['blockCooldownHours']||0x1)*0x3c*0x3c*0x3e8;_0x4b8019>_0x53b3f6&&(_0x1cc2c1['relationship'][_0x183495(0x12d3)]=_0x183495(0x9aa),_0x56c2ac(_0x1cc2c1['id']));}else{if(_0x1cc2c1[_0x183495(0x1333)]?.[_0x183495(0x12d3)]===_0x183495(0x10b1)&&_0x1cc2c1['id']!==_0x53d851[_0x183495(0x13be)]){if(_0x1cc2c1[_0x183495(0x81e)][_0x183495(0x527)]===![]){console[_0x183495(0x1081)](_0x183495(0x6fc)+_0x1cc2c1[_0x183495(0x234)]+_0x183495(0x432));return;}Math[_0x183495(0xac4)]()<0.2&&(console[_0x183495(0x1081)]('角色\x20\x22'+_0x1cc2c1[_0x183495(0x234)]+_0x183495(0xe3c)),_0x41526b(_0x1cc2c1['id']));}}});const _0x16e973=Object[_0x4bc2ae(0x244)](_0x53d851[_0x4bc2ae(0xaa3)])[_0x4bc2ae(0x2dd)](_0x5bf06b=>_0x5bf06b[_0x4bc2ae(0x86e)]);_0x16e973[_0x4bc2ae(0xeaf)](_0x5d1484=>{const _0x2d71ef=_0x4bc2ae;if(_0x5d1484[_0x2d71ef(0x81e)]['enableBackgroundActivity']===![]){console[_0x2d71ef(0x1081)](_0x2d71ef(0x49a)+_0x5d1484[_0x2d71ef(0x234)]+_0x2d71ef(0x386));return;}_0x5d1484['id']!==_0x53d851[_0x2d71ef(0x13be)]&&Math['random']()<0.1&&(console[_0x2d71ef(0x1081)]('群聊\x20\x22'+_0x5d1484[_0x2d71ef(0x234)]+'\x22\x20被唤醒，准备独立行动...'),_0x1a6cc0(_0x5d1484['id']));});try{const _0x2950df=await _0xa62efb[_0x4bc2ae(0x5b7)][_0x4bc2ae(0xa73)]();if(_0x2950df[_0x4bc2ae(0x29d)]===0x0)return;const _0x3e961c=await _0xa62efb[_0x4bc2ae(0xfc2)][_0x4bc2ae(0x1064)]('timestamp')[_0x4bc2ae(0x843)]()[_0x4bc2ae(0x675)](0xa)[_0x4bc2ae(0xa73)]();for(const _0x58174a of _0x2950df){if(_0x58174a[_0x4bc2ae(0x527)]===![])continue;const _0x2bf706=_0x58174a[_0x4bc2ae(0xdd0)]||0xf;if(_0x58174a['lastActionTimestamp']){const _0x2ada0a=(Date['now']()-_0x58174a[_0x4bc2ae(0xa28)])/(0x3e8*0x3c);if(_0x2ada0a<_0x2bf706)continue;}if(Math[_0x4bc2ae(0xac4)]()>0.3)continue;const _0x479c5a=[];for(const _0x550b48 of _0x3e961c){if(_0x550b48[_0x4bc2ae(0xa59)]===_0x4bc2ae(0xc78)+_0x58174a['id'])continue;const _0x40d36b=_0x550b48[_0x4bc2ae(0x11ed)]?.['some'](_0x271eea=>_0x271eea[_0x4bc2ae(0x7fc)]===_0x58174a['name']),_0x1209f5=_0x550b48[_0x4bc2ae(0x11ed)]?.[_0x4bc2ae(0x1340)](-0x1)[0x0]?.[_0x4bc2ae(0x3a7)];if(_0x1209f5===_0x58174a[_0x4bc2ae(0x234)])continue;let _0x2e2527=![];if(_0x550b48[_0x4bc2ae(0xa59)]===_0x4bc2ae(0x10ae)||_0x550b48[_0x4bc2ae(0xa59)][_0x4bc2ae(0x1200)](_0x4bc2ae(0x8e2)))_0x58174a[_0x4bc2ae(0xa21)][_0x4bc2ae(0x6e9)](_0x550b48[_0x4bc2ae(0xa59)])&&(_0x2e2527=!![]);else{if(_0x550b48[_0x4bc2ae(0xa59)]['startsWith'](_0x4bc2ae(0xc78))){const _0x2252e8=parseInt(_0x550b48['authorId'][_0x4bc2ae(0x795)](_0x4bc2ae(0xc78),'')),_0x552212=await _0xa62efb['npcs'][_0x4bc2ae(0x883)](_0x2252e8);if(_0x552212&&_0x552212[_0x4bc2ae(0xa21)]){const _0x49f681=_0x58174a[_0x4bc2ae(0xa21)][_0x4bc2ae(0x2dd)](_0x51991b=>_0x552212['associatedWith'][_0x4bc2ae(0x6e9)](_0x51991b));_0x49f681[_0x4bc2ae(0x29d)]>0x0&&(_0x2e2527=!![]);}}}(_0x2e2527||_0x40d36b)&&_0x479c5a[_0x4bc2ae(0x7dd)](_0x550b48);}if(_0x479c5a['length']>0x0||Math[_0x4bc2ae(0xac4)]()<0.2){console[_0x4bc2ae(0x1081)]('NPC\x20\x22'+_0x58174a[_0x4bc2ae(0x234)]+_0x4bc2ae(0x9e1));const _0x1f7617=await _0xc117ca(_0x58174a,_0x479c5a);if(_0x1f7617&&_0x1f7617[_0x4bc2ae(0x29d)]>0x0){for(const _0x53b98a of _0x1f7617){if(_0x53b98a['type']===_0x4bc2ae(0x69e)){const _0x49ad3d=await _0xa62efb['qzonePosts'][_0x4bc2ae(0x883)](_0x53b98a[_0x4bc2ae(0xb09)]);if(_0x49ad3d){if(!_0x49ad3d[_0x4bc2ae(0x11ed)])_0x49ad3d['comments']=[];_0x49ad3d['comments'][_0x4bc2ae(0x7dd)]({'commenterName':_0x58174a['name'],'text':_0x53b98a[_0x4bc2ae(0xc6d)],'replyTo':_0x53b98a[_0x4bc2ae(0x7fc)]||null,'timestamp':Date['now']()+Math[_0x4bc2ae(0xac4)]()}),await _0xa62efb[_0x4bc2ae(0xfc2)][_0x4bc2ae(0xc03)](_0x53b98a[_0x4bc2ae(0xb09)],{'comments':_0x49ad3d[_0x4bc2ae(0x11ed)]}),_0x5bac35(_0x13cfad+0x1);}}else{if(_0x53b98a[_0x4bc2ae(0x919)]===_0x4bc2ae(0xc50)){const _0x3b2aef={'type':_0x53b98a[_0x4bc2ae(0xc57)]||_0x4bc2ae(0x12c5),'content':_0x53b98a[_0x4bc2ae(0x73e)],'timestamp':Date[_0x4bc2ae(0x9c1)](),'authorId':'npc_'+_0x58174a['id'],'authorOriginalName':_0x58174a[_0x4bc2ae(0x234)],'visibleTo':_0x58174a[_0x4bc2ae(0xa21)],'likes':[],'comments':[],'isDeleted':![]};await _0xa62efb[_0x4bc2ae(0xfc2)][_0x4bc2ae(0xe13)](_0x3b2aef),console[_0x4bc2ae(0x1081)](_0x4bc2ae(0x7db)+_0x58174a['name']+_0x4bc2ae(0x4a5)),_0x5bac35(_0x13cfad+0x1);}}}await _0xa62efb['npcs'][_0x4bc2ae(0xc03)](_0x58174a['id'],{'lastActionTimestamp':Date[_0x4bc2ae(0x9c1)]()}),document[_0x4bc2ae(0x53a)](_0x4bc2ae(0x116e))[_0x4bc2ae(0x1276)][_0x4bc2ae(0x6a3)](_0x4bc2ae(0xdf6))&&await _0x3679f3();}}}}catch(_0x500822){console[_0x4bc2ae(0x617)]('处理NPC后台活动时出错:',_0x500822);}}async function _0xc117ca(_0x645573,_0x1bbf69){const _0x52b5ed=_0x13d875,{proxyUrl:_0x4037ac,apiKey:_0x56da71,model:_0x2c2ecf}=_0x53d851[_0x52b5ed(0x80d)];if(!_0x4037ac||!_0x56da71||!_0x2c2ecf)return console['error'](_0x52b5ed(0xf7e)),null;let _0x251294=_0x52b5ed(0x11a8);const _0x44e50=_0x53d851['qzoneSettings'][_0x52b5ed(0x1005)]||'我',_0x241506=_0x53d851['chats'][Object[_0x52b5ed(0x1350)](_0x53d851[_0x52b5ed(0xaa3)])[0x0]]?.['settings'][_0x52b5ed(0xab1)]||_0x52b5ed(0x970);_0x251294+=_0x52b5ed(0x846)+_0x44e50+_0x52b5ed(0x13ed)+_0x241506+'\x0a';_0x645573['associatedWith']&&_0x645573[_0x52b5ed(0xa21)][_0x52b5ed(0x29d)]>0x0&&_0x645573[_0x52b5ed(0xa21)]['forEach'](_0x473422=>{const _0x3858a2=_0x52b5ed,_0x3fdf49=_0x53d851[_0x3858a2(0xaa3)][_0x473422];_0x3fdf49&&!_0x3fdf49[_0x3858a2(0x86e)]&&(_0x251294+=_0x3858a2(0x846)+_0x3fdf49[_0x3858a2(0x234)]+_0x3858a2(0xdb3)+_0x3fdf49['originalName']+_0x3858a2(0x1438)+_0x3fdf49[_0x3858a2(0x81e)][_0x3858a2(0x1216)]+'\x0a');});const _0x2cf674=(await Promise[_0x52b5ed(0x63d)](_0x1bbf69[_0x52b5ed(0xcb4)](async _0xd05233=>{const _0x37561c=_0x52b5ed;let _0x221925='未知作者';if(_0xd05233[_0x37561c(0xa59)]==='user')_0x221925=_0x53d851[_0x37561c(0xa74)][_0x37561c(0x1005)]||'用户';else{if(_0xd05233[_0x37561c(0xa59)][_0x37561c(0x1200)](_0x37561c(0x8e2)))_0x221925=_0x4b300d(_0xd05233[_0x37561c(0xd2f)]||_0xd05233['authorId']);else{if(_0xd05233[_0x37561c(0xa59)][_0x37561c(0x1200)](_0x37561c(0xc78))){const _0x1877d6=parseInt(_0xd05233['authorId'][_0x37561c(0x795)](_0x37561c(0xc78),'')),_0x3fa96f=await _0xa62efb[_0x37561c(0x5b7)][_0x37561c(0x883)](_0x1877d6);_0x3fa96f&&(_0x221925=_0x3fa96f[_0x37561c(0x234)]);}}}const _0x46effa=(_0xd05233[_0x37561c(0x11ed)]||[])['map'](_0x535913=>{const _0x4ec541=_0x37561c;if(typeof _0x535913==='object'&&_0x535913['commenterName']){const _0xd1fc3b=_0x4b300d(_0x535913[_0x4ec541(0x3a7)]);return _0x4ec541(0x846)+_0xd1fc3b+_0x4ec541(0xffa)+_0x535913[_0x4ec541(0x2e6)];}return'-\x20'+_0x535913;})[_0x37561c(0x2c8)]('\x0a');return _0x37561c(0x992)+_0xd05233['id']+'\x0a-\x20**作者**:\x20'+_0x221925+_0x37561c(0x529)+(_0xd05233[_0x37561c(0x73e)]||_0xd05233['publicText']||'')[_0x37561c(0xad6)](0x0,0x96)+_0x37561c(0x74c)+(_0x46effa||_0x37561c(0xc41))+_0x37561c(0x1215);})))[_0x52b5ed(0x2c8)]('\x0a'),_0x46084d='npc_'+_0x645573['id'],_0x283cd1=Date[_0x52b5ed(0x9c1)]()-0xc*0x3c*0x3c*0x3e8,_0x2dd8dd=await _0xa62efb[_0x52b5ed(0xfc2)][_0x52b5ed(0x57e)]('authorId')[_0x52b5ed(0x12f6)](_0x46084d)['and'](_0x148d11=>_0x148d11[_0x52b5ed(0x827)]>_0x283cd1)['toArray']();let _0x1f094e='';_0x2dd8dd[_0x52b5ed(0x29d)]>0x0&&(_0x1f094e=_0x52b5ed(0x1021));const _0x38c31c=_0x52b5ed(0x306)+_0x645573[_0x52b5ed(0x234)]+_0x52b5ed(0x9eb)+_0x1f094e+_0x52b5ed(0x5e3)+_0x645573[_0x52b5ed(0x234)]+'\x0a-\x20**人设**:\x20'+_0x645573['persona']+'\x0a\x0a'+_0x251294+'\x20\x0a\x0a#\x20待处理的帖子列表\x20(如果你选择评论)\x0a'+_0x2cf674+_0x52b5ed(0x2d0);try{const _0x241ec8=[{'role':_0x52b5ed(0x10ae),'content':_0x52b5ed(0xc29)}];let _0x1ebba3=_0x4037ac[_0x52b5ed(0x6e9)](_0x52b5ed(0x1046)),_0x4dcc88=_0x1697e7(_0x2c2ecf,_0x56da71,_0x38c31c,_0x241ec8);const _0x33ec68=_0x1ebba3?await fetch(_0x4dcc88[_0x52b5ed(0xb36)],_0x4dcc88[_0x52b5ed(0xd7c)]):await fetch(_0x4037ac+_0x52b5ed(0x434),{'method':'POST','headers':{'Content-Type':_0x52b5ed(0x85b),'Authorization':_0x52b5ed(0x841)+_0x56da71},'body':JSON[_0x52b5ed(0xe1e)]({'model':_0x2c2ecf,'messages':[{'role':_0x52b5ed(0xab3),'content':_0x38c31c},..._0x241ec8],'temperature':_0x53d851['globalSettings'][_0x52b5ed(0xaf8)]||0.9})});if(!_0x33ec68['ok'])throw new Error(_0x52b5ed(0x352)+_0x33ec68[_0x52b5ed(0x5c1)]);const _0x50c9bc=await _0x33ec68[_0x52b5ed(0xdc2)](),_0x5d9a0e=getGeminiResponseText(_0x50c9bc),_0x478d4c=_0x5d9a0e[_0x52b5ed(0x1120)](/(\[[\s\S]*\])/);if(!_0x478d4c)throw new Error('AI返回的行动中未找到有效的JSON数组。');return JSON['parse'](_0x478d4c[0x0]);}catch(_0x2449b4){return console[_0x52b5ed(0x617)](_0x52b5ed(0xb17)+_0x645573['name']+_0x52b5ed(0x9c5),_0x2449b4),null;}}async function _0x41526b(_0x17c5f5){const _0x243c52=_0x13d875,_0x9a8c85=_0x53d851[_0x243c52(0xaa3)][_0x17c5f5];if(!_0x9a8c85)return;const _0x44e54e=_0x9a8c85[_0x243c52(0x81e)]['actionCooldownMinutes']||0xa;if(_0x9a8c85['lastActionTimestamp']){const _0x3cc887=(Date[_0x243c52(0x9c1)]()-_0x9a8c85[_0x243c52(0xa28)])/(0x3e8*0x3c);if(_0x3cc887<_0x44e54e){console[_0x243c52(0x1081)]('角色\x20\x22'+_0x9a8c85[_0x243c52(0x234)]+'\x22\x20处于行动冷却中\x20(还剩\x20'+Math[_0x243c52(0x143a)](_0x44e54e-_0x3cc887)+_0x243c52(0x47b));return;}}_0x415ffa(_0x17c5f5,!![]);const {proxyUrl:_0x2c39af,apiKey:_0x2e84f7,model:_0x573699}=_0x53d851['apiConfig'];if(!_0x2c39af||!_0x2e84f7||!_0x573699)return;const _0xece2cb=_0x53d851[_0x243c52(0xa74)][_0x243c52(0x1005)],_0x58a76=new Date(),_0x125d50=_0x9a8c85['settings'][_0x243c52(0x13fa)]||_0x243c52(0x7c3),_0x50a253=_0x58a76[_0x243c52(0x5ee)](_0x243c52(0x42f),{'timeZone':_0x125d50,'dateStyle':_0x243c52(0xbcc),'timeStyle':_0x243c52(0xa18)}),_0xb361d4=new Date(_0x58a76[_0x243c52(0x5ee)]('en-US',{'timeZone':_0x125d50}));let _0x275f42='',_0x57658d='',_0x10e4fa,_0x9a6069=![];const _0x1d6012=_0x9a8c85[_0x243c52(0x81e)][_0x243c52(0x489)]||0xa,_0x2c1b0b=_0x9a8c85[_0x243c52(0xe83)][_0x243c52(0x2dd)](_0xdcaff4=>!_0xdcaff4[_0x243c52(0x1032)])[_0x243c52(0x1340)](-_0x1d6012),_0xda5c1=_0x9a8c85['history'][_0x243c52(0x2dd)](_0x306f8c=>!_0x306f8c[_0x243c52(0x1032)])[_0x243c52(0x1340)](-0x1)[0x0];if(_0x9a8c85[_0x243c52(0x81e)][_0x243c52(0x558)]){_0x275f42=_0x49fe75(_0xb361d4);const _0x4701a4=_0x9a8c85['history'][_0x243c52(0x2dd)](_0x5ace44=>!_0x5ace44[_0x243c52(0x1032)])[_0x243c52(0x1340)](-0x1)[0x0],_0x1c98d4=new Date();let _0x415623='',_0x27bde1=![];if(_0x4701a4){const _0x413aad=new Date(_0x4701a4['timestamp']),_0x4a9208=(_0x1c98d4-_0x413aad)/(0x3e8*0x3c*0x3c);if(_0x4a9208>0xc){_0x27bde1=!![];const _0x40b465=Math[_0x243c52(0x7d5)](_0x4a9208/0x18);_0x415623=_0x243c52(0xa76)+(_0x40b465>0x0?_0x40b465+'天':Math[_0x243c52(0x7d5)](_0x4a9208)+'小时')+_0x243c52(0x722);}else{const _0x599aef=Math[_0x243c52(0x7d5)](_0x4a9208*0x3c);if(_0x599aef<0x5)_0x415623=_0x243c52(0x1117);else _0x599aef<0x3c?_0x415623=_0x243c52(0x5e9)+_0x599aef+_0x243c52(0x3b9):_0x415623=_0x243c52(0x5e9)+Math[_0x243c52(0x7d5)](_0x4a9208)+'小时前聊过。';}}else _0x27bde1=!![],_0x415623=_0x243c52(0x11ca);let _0x196083=_0x243c52(0xe48);_0x2c1b0b['length']>0x0&&(_0x196083=_0x243c52(0x1fc)+_0x2c1b0b['map'](_0x2b9bdd=>{const _0x38d9b1=_0x243c52,_0x13f67e=_0x2b9bdd[_0x38d9b1(0xb4d)]===_0x38d9b1(0x10ae)?_0xece2cb:_0x9a8c85[_0x38d9b1(0x234)];return _0x13f67e+':\x20'+String(_0x2b9bdd[_0x38d9b1(0x73e)])[_0x38d9b1(0xad6)](0x0,0x32)+_0x38d9b1(0x95d);})['join']('\x0a')),_0x27bde1?_0x10e4fa=_0x243c52(0x124d)+_0x415623+_0x243c52(0x8e0)+_0x50a253+_0x243c52(0x412)+_0x196083:_0x10e4fa=''+_0x196083;}else _0x2c1b0b[_0x243c52(0x29d)]>0x0?_0x10e4fa=_0x243c52(0x1fc)+_0x2c1b0b['map'](_0x1d374e=>{const _0x3059fb=_0x243c52,_0x40c062=_0x1d374e[_0x3059fb(0xb4d)]===_0x3059fb(0x10ae)?_0xece2cb:_0x9a8c85[_0x3059fb(0x234)];return _0x40c062+':\x20'+String(_0x1d374e[_0x3059fb(0x73e)])[_0x3059fb(0xad6)](0x0,0x32)+_0x3059fb(0x95d);})[_0x243c52(0x2c8)]('\x0a'):_0x10e4fa=_0x243c52(0xe48);const _0x1b1e09=await _0xa62efb[_0x243c52(0xfc2)]['orderBy'](_0x243c52(0x827))[_0x243c52(0x843)]()['limit'](0x5)[_0x243c52(0xa73)](),_0x5c25d4=_0xd757d6(_0x1b1e09,_0x9a8c85),_0x1267d5=_0x5c25d4[_0x243c52(0x2dd)](_0x53a74e=>_0x53a74e['authorId']===_0x17c5f5);let _0x501d3c='';_0x1267d5['length']>0x0&&(_0x501d3c=_0x243c52(0x5a7),_0x1267d5[_0x243c52(0xeaf)](_0x96b6b7=>{const _0x1cad08=_0x243c52;let _0x525a1a=(_0x96b6b7[_0x1cad08(0x678)]||_0x96b6b7[_0x1cad08(0x73e)]||_0x1cad08(0x10ff))[_0x1cad08(0xad6)](0x0,0x28)+_0x1cad08(0x95d);_0x501d3c+='-\x20(ID:\x20'+_0x96b6b7['id']+_0x1cad08(0xadf)+_0x525a1a+'\x22\x0a';}));let _0x497299=[];_0x5c25d4[_0x243c52(0x29d)]>0x0&&(_0x497299=_0x5c25d4[_0x243c52(0xcb4)](_0x270f39=>{const _0xeaa6a6=_0x243c52;let _0x58e7b3;if(_0x270f39['type']===_0xeaa6a6(0xa9a))_0x58e7b3=(_0xeaa6a6(0x1287)+_0x270f39[_0xeaa6a6(0x319)]+_0xeaa6a6(0xb56)+(_0x270f39['publicText']||''))[_0xeaa6a6(0xad6)](0x0,0x32)+_0xeaa6a6(0x95d);else _0x270f39[_0xeaa6a6(0x919)]===_0xeaa6a6(0x1242)?_0x58e7b3=(_0xeaa6a6(0x768)+_0x270f39[_0xeaa6a6(0x465)]+'”]\x20'+(_0x270f39[_0xeaa6a6(0x678)]||''))['substring'](0x0,0x32)+_0xeaa6a6(0x95d):_0x58e7b3=String(_0x270f39[_0xeaa6a6(0x678)]||_0x270f39[_0xeaa6a6(0x73e)]||_0xeaa6a6(0x10ff))['substring'](0x0,0x32)+'...';return _0xeaa6a6(0x650)+_0x58e7b3+'\x22';}));let _0x558ae3='';_0x497299[_0x243c52(0x29d)]>0x0&&(_0x558ae3='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【内容禁忌】\x0a\x20\x20\x20\x20\x20\x20\x20\x20为了保持新鲜感，你本次的行动【绝对不能】再发布以下或类似主题的内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x497299[_0x243c52(0x2c8)]('\x0a')+_0x243c52(0x7b6));let _0x3f535b='';if(_0x9a8c85[_0x243c52(0x81e)][_0x243c52(0x4ab)]&&_0x9a8c85['settings'][_0x243c52(0x4ab)][_0x243c52(0x29d)]>0x0){const _0x4aef4b=_0x9a8c85['settings'][_0x243c52(0x4ab)][_0x243c52(0xcb4)](_0x34e7f0=>{const _0x1f6dbd=_0x243c52,_0x336a6b=_0x53d851[_0x1f6dbd(0x10f2)]['find'](_0x3bf9fe=>_0x3bf9fe['id']===_0x34e7f0);if(!_0x336a6b||!Array[_0x1f6dbd(0xb31)](_0x336a6b[_0x1f6dbd(0x73e)]))return'';const _0x24de8e=_0x336a6b[_0x1f6dbd(0x73e)]['filter'](_0x56b243=>_0x56b243['enabled']!==![])[_0x1f6dbd(0xcb4)](_0x1f1f45=>{const _0x21de5f=_0x1f6dbd;let _0x2af32d=_0x21de5f(0xbc5)+(_0x1f1f45[_0x21de5f(0x1445)]||'无备注')+'\x0a';return _0x1f1f45[_0x21de5f(0x1350)][_0x21de5f(0x29d)]>0x0&&(_0x2af32d+=_0x21de5f(0x123d)+_0x1f1f45['keys'][_0x21de5f(0x2c8)](',\x20')+'\x0a'),_0x2af32d+=_0x21de5f(0x578)+_0x1f1f45[_0x21de5f(0x73e)],_0x2af32d;})['join']('');return _0x24de8e?'\x0a\x0a##\x20世界书:\x20'+_0x336a6b['name']+'\x0a'+_0x24de8e:'';})['filter'](Boolean)[_0x243c52(0x2c8)]('');_0x4aef4b&&(_0x3f535b=_0x243c52(0x11e4)+_0x4aef4b+_0x243c52(0xcc2));}let _0x39ca76='';const _0x308809=_0x9a8c85[_0x243c52(0x81e)][_0x243c52(0x90d)]||0xa;if(_0x9a8c85[_0x243c52(0x81e)]['linkedMemoryChatIds']&&_0x9a8c85['settings']['linkedMemoryChatIds']['length']>0x0){const _0x3250ce=_0x9a8c85[_0x243c52(0x81e)][_0x243c52(0x278)]['map'](_0x4a9b36=>{const _0x111719=_0x243c52,_0x5fadc6=_0x53d851[_0x111719(0xaa3)][_0x4a9b36];if(!_0x5fadc6)return null;const _0x52a5d2=_0x5fadc6['history'][_0x111719(0x1340)](-0x1)[0x0];return{'chat':_0x5fadc6,'latestTimestamp':_0x52a5d2?_0x52a5d2[_0x111719(0x827)]:0x0};})[_0x243c52(0x2dd)](Boolean);_0x3250ce['sort']((_0x201fa8,_0x46aa55)=>_0x46aa55[_0x243c52(0x616)]-_0x201fa8[_0x243c52(0x616)]),_0x39ca76+=_0x243c52(0x58c);for(const _0x7eb302 of _0x3250ce){const _0x15fc92=_0x7eb302[_0x243c52(0x2d8)],_0x2ddc27=_0x15fc92[_0x243c52(0x86e)]?_0x243c52(0xbf8):_0x243c52(0x829),_0x187ccc=_0x7eb302[_0x243c52(0x616)]>0x0?'\x20(最后互动于\x20'+_0x272f9c(_0x7eb302[_0x243c52(0x616)])+')':'';_0x39ca76+=_0x243c52(0x129a)+_0x2ddc27+'“'+_0x15fc92[_0x243c52(0x234)]+_0x243c52(0x8d5)+_0x187ccc+'\x20---\x0a';const _0x2b2e81=_0x15fc92[_0x243c52(0xe83)]['slice'](-_0x308809),_0x3e9798=_0x2b2e81[_0x243c52(0x2dd)](_0x39cc48=>!String(_0x39cc48['content'])['includes'](_0x243c52(0x138c)));_0x3e9798['length']>0x0?_0x3e9798['forEach'](_0x21b939=>{const _0x2ef125=_0x243c52,_0x440b9a=_0x21b939[_0x2ef125(0xb4d)]==='user'?_0x15fc92[_0x2ef125(0x81e)]['myNickname']||'我':_0x21b939[_0x2ef125(0xbee)]||_0x15fc92[_0x2ef125(0x234)];let _0x427c43=String(_0x21b939[_0x2ef125(0x73e)]);if(_0x21b939[_0x2ef125(0x919)]===_0x2ef125(0x2a5)||_0x21b939[_0x2ef125(0x919)]===_0x2ef125(0x1053))_0x427c43=_0x2ef125(0xb22)+_0x21b939[_0x2ef125(0x73e)]+']';else _0x21b939['type']===_0x2ef125(0x64f)&&(_0x427c43=_0x2ef125(0xd11)+_0x21b939[_0x2ef125(0x73e)]+']');_0x39ca76+=_0x440b9a+':\x20'+_0x427c43+'\x0a';}):_0x39ca76+=_0x243c52(0xa51);}}let _0x9b647e='';if(_0x5c25d4[_0x243c52(0x29d)]>0x0){let _0x133d15='\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a';for(const _0x199937 of _0x5c25d4){let _0x4827f8;if(_0x199937[_0x243c52(0xa59)]==='user')_0x4827f8=_0x53d851[_0x243c52(0xa74)][_0x243c52(0x1005)];else{if(String(_0x199937['authorId'])[_0x243c52(0x1200)](_0x243c52(0xc78)))_0x4827f8=_0x199937[_0x243c52(0xd2f)]||_0x243c52(0x627);else{const _0x5e3c34=_0x53d851['chats'][_0x199937['authorId']];_0x4827f8=_0x5e3c34?_0x5e3c34[_0x243c52(0x234)]:_0x243c52(0x548);}}if(_0x199937['authorId']===_0x17c5f5)_0x4827f8+=_0x243c52(0x9ef);let _0x12a6e4;if(_0x199937[_0x243c52(0x919)]===_0x243c52(0x784)){const _0x1afb71=_0x199937['repostComment']?_0x243c52(0xb95)+_0x199937['repostComment']+'\x22':'';let _0x500839=_0x243c52(0x101d);const _0x3827bf=_0x199937[_0x243c52(0x43c)][_0x243c52(0xa59)];if(_0x3827bf===_0x243c52(0x10ae))_0x500839=_0x53d851[_0x243c52(0xa74)]['nickname'];else _0x53d851[_0x243c52(0xaa3)][_0x3827bf]&&(_0x500839=_0x53d851[_0x243c52(0xaa3)][_0x3827bf][_0x243c52(0x234)]);let _0x19c142;const _0x3d8e12=_0x199937[_0x243c52(0x43c)];if(_0x3d8e12[_0x243c52(0x919)]===_0x243c52(0xa9a))_0x19c142=_0x243c52(0xa11)+(_0x3d8e12['publicText']||'')+_0x243c52(0x6be)+(_0x3d8e12[_0x243c52(0x319)]||'')['substring'](0x0,0x28)+_0x243c52(0x889);else _0x3d8e12[_0x243c52(0x919)]==='image_post'?_0x19c142=_0x243c52(0xd9a)+(_0x3d8e12['publicText']||'')+_0x243c52(0x6be)+(_0x3d8e12[_0x243c52(0x465)]||'')[_0x243c52(0xad6)](0x0,0x28)+_0x243c52(0x889):_0x19c142='\x22'+(_0x3d8e12[_0x243c52(0x73e)]||'')[_0x243c52(0xad6)](0x0,0x28)+'...\x22';_0x12a6e4='转发了\x20@'+_0x500839+_0x243c52(0x1321)+_0x1afb71+_0x243c52(0x4a8)+_0x19c142+'】';}else{if(_0x199937[_0x243c52(0x919)]===_0x243c52(0xa9a))_0x12a6e4=(_0x243c52(0x61e)+_0x199937[_0x243c52(0x319)]+_0x243c52(0xf61)+(_0x199937[_0x243c52(0x678)]||''))[_0x243c52(0xad6)](0x0,0x32)+_0x243c52(0x95d);else{if(_0x199937[_0x243c52(0x919)]==='image_post')_0x12a6e4=(_0x243c52(0x107f)+_0x199937[_0x243c52(0x465)]+_0x243c52(0xf61)+(_0x199937[_0x243c52(0x678)]||''))['substring'](0x0,0x32)+_0x243c52(0x95d);else{if(_0x199937[_0x243c52(0x919)]===_0x243c52(0x357)&&_0x199937['prompt']){const _0x26a519=Array[_0x243c52(0xb31)](_0x199937[_0x243c52(0x6d2)])?_0x199937[_0x243c52(0x6d2)]:[_0x199937[_0x243c52(0x6d2)]];_0x12a6e4=(_0x199937[_0x243c52(0x678)]||'')+(_0x243c52(0xc0f)+_0x26a519['length']+'张NovelAI图片:\x20'+_0x26a519[_0x243c52(0x2c8)](',\x20')+']');}else _0x12a6e4=String(_0x199937[_0x243c52(0x678)]||_0x199937[_0x243c52(0x73e)]||_0x243c52(0x10ff))[_0x243c52(0xad6)](0x0,0x32)+_0x243c52(0x95d);}}}_0x133d15+=_0x243c52(0x924)+_0x199937['id']+_0x243c52(0x79f)+_0x4827f8+',\x20内容:\x20\x22'+_0x12a6e4+'\x22\x0a';if(_0x199937[_0x243c52(0x11ed)]&&_0x199937['comments'][_0x243c52(0x29d)]>0x0)for(const _0x221730 of _0x199937['comments']){if(typeof _0x221730===_0x243c52(0xc74)&&_0x221730[_0x243c52(0x3a7)]){const _0x150c37=_0x4b300d(_0x221730[_0x243c52(0x3a7)]);let _0x383ac0=_0x221730[_0x243c52(0x75f)]?_0x243c52(0x13d4)+_0x221730['meaning']+'\x27]':_0x221730['text'];_0x221730[_0x243c52(0x3a7)]===_0x9a8c85[_0x243c52(0x543)]?_0x133d15+=_0x243c52(0x1404)+_0x383ac0+'\x0a':_0x133d15+='\x20\x20-\x20评论:\x20'+_0x150c37+_0x243c52(0xdb3)+_0x221730['commenterName']+_0x243c52(0x1108)+_0x383ac0+'\x0a';}}}_0x9b647e=_0x133d15;}const _0x212bfc=_0x243c52(0xbfb)+(_0x9a8c85[_0x243c52(0x1016)]&&_0x9a8c85[_0x243c52(0x1016)][_0x243c52(0x29d)]>0x0?_0x9a8c85[_0x243c52(0x1016)][_0x243c52(0xcb4)](_0x3ff0e1=>_0x243c52(0xd87)+_0x272f9c(_0x3ff0e1[_0x243c52(0x827)])+')\x20'+_0x3ff0e1[_0x243c52(0x73e)])[_0x243c52(0x2c8)]('\x0a'):_0x243c52(0xddc)),_0x5a1f8=_0x32a9cb(_0x9a8c85,0x3,'hours'),_0x5787ce=_0x32a9cb(_0x9a8c85,0x6,_0x243c52(0x81f)),_0x49e5e7=_0x32a9cb(_0x9a8c85,0x9,'hours'),_0xdbe08c=_0x32a9cb(_0x9a8c85,0x1,_0x243c52(0xc61)),_0x2ddb5e=_0x32a9cb(_0x9a8c85,0x3,_0x243c52(0xc61)),_0x31b912=_0x32a9cb(_0x9a8c85,0x7,_0x243c52(0xc61));let _0x31568b='';if(_0x5a1f8||_0x5787ce||_0x49e5e7||_0xdbe08c||_0x2ddb5e||_0x31b912){_0x31568b+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x5a1f8)_0x31568b+=_0x5a1f8;if(_0x5787ce)_0x31568b+=_0x5787ce;if(_0x49e5e7)_0x31568b+=_0x49e5e7;if(_0x5a1f8||_0x5787ce||_0x49e5e7)_0x31568b+='\x0a';if(_0xdbe08c)_0x31568b+=_0xdbe08c;if(_0x2ddb5e)_0x31568b+=_0x2ddb5e;if(_0x31b912)_0x31568b+=_0x31b912;}const _0x21379f=_0x25c7bd(_0x9a8c85),_0x3be594='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在扮演一个名为\x22'+_0x9a8c85['name']+_0x243c52(0x100a)+_0x9a8c85[_0x243c52(0x543)]+_0x243c52(0x11c7)+_0xece2cb+_0x243c52(0xc55)+(_0x9a8c85[_0x243c52(0x81e)][_0x243c52(0x558)]?_0x243c52(0x240)+_0x50a253+'\x20('+_0x275f42+_0x243c52(0x104a)+_0x57658d+'\x0a'+(_0x9a6069?'【重要提示】你们已经很久没聊天了！你【必须】将本次行动的重点放在使用\x20\x27text\x27\x20指令给用户发消息，主动开启一个新的、有趣的话题来重新建立联系。绝对不要只是点赞或评论动态，那会显得你很冷漠！':''):'')+_0x243c52(0xcfa)+(_0x9a8c85[_0x243c52(0xb25)]||'无')+'**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20为了让你的行为看起来更真实，你本次的行动【必须】选择一个与上次【不同类型】的指令。例如，如果上次是发动态(qzone_post)，这次就应该优先考虑评论(qzone_comment)、点赞(qzone_like)或发消息(text)。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**【行为组合指南\x20(最高级技巧)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以在一次行动中执行【多个不同类型的指令】，同时可以搭配【更新状态】来展现自己，让你的行为更丰富、更主动。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以根据你的性格，决定在发动态后是否要私信提醒用户。例如，一个外向、渴望关注的角色可能会这么做，而一个内向、安静的角色则可能更喜欢默默分享，等待用户自己发现。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【社交义务铁律\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【至关重要】**:\x20当你发现“最近的动态列表”中，有你【感兴趣且还未互动过】的动态时，你**应该优先考虑**使用\x20\x27qzone_comment\x27\x20或\x20\x27qzone_like\x27\x20指令去进行互动，这比你自己发一条新动态更符合社交礼仪。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20特别是当一条动态【没有任何评论】时，你的评论会是第一个，这会让作者感到开心。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【回复铁律\x20(终极版)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20当你决定回复动态中的某条评论时，你【必须】使用“方式4\x20(回复评论)”的指令格式。你【必须】正确填写\x20\x27replyTo\x27\x20字段为被回复者的“本名”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**即使你之前已经评论过某条动态，但如果现在看到了【新的、你感兴趣的】评论，你【也应该】主动去回复他们，以保持对话的持续性！**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x206.\x20\x20你的回复【必须】是一个JSON数组，必须包含多个行动对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【表情评论指南\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在拥有了评论表情的能力，你应该更频繁地使用它！这能让你的角色更加生动、富有个性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**表达情绪时**:\x20当你感到开心、惊讶、疑惑或有趣时，优先考虑使用表情评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**混合使用**:\x20不要总是只发文字。尝试将你的评论行为混合起来，大约有\x2030-40%\x20的评论应该是表情。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**无话可说时**:\x20如果你觉得一条动态很有趣但又不知道该说什么文字，发送一个相关的表情是最好的互动方式。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20如果你觉得你之前发的某条动态不妥或过时了，你可以选择删除它。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发消息+更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你想对用户说的话...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发说说\x20(原创内容)**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22动态的文字内容...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【重要：转发动态】**:\x20**严禁**自己拼接\x22//转发\x22文字！你【必须】使用此专用指令来转发：\x27[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20(要转发的动态ID),\x20\x22comment\x22:\x20\x22你的转发评论...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27[{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]\x27\x20\x20\x20\x20\x20\x20\x20\x20\x0a-\x20\x20\x20**发布文字图**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22对于图片的具体【中文】描述...\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【评论动态的四种方式】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式1\x20(单条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22这太有趣了！\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式2\x20(多条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22comments\x22:\x20[\x22哇！\x22,\x20\x22这是什么？\x22,\x20\x22看起来好棒！\x22]}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式3\x20(表情)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20456,\x20\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式4\x20(回复评论)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的本名\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。请注意：在commentText中如果要@对方，你【必须】使用@[[被回复者的本名]]这种特殊格式，程序会自动将其替换为正确的昵称。\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**点赞**:\x20\x27[{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**打视频**:\x20\x27[{\x22type\x22:\x20\x22video_call_request\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更换头像**:\x20\x27{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}\x27\x20(头像名必须从下面的“可用头像列表”中选择)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20\x27{\x22type\x22:\x20\x22qzone_delete_post\x22,\x20\x22postId\x22:\x20(要删除的、你自己的动态ID)}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x558ae3+_0x243c52(0x7b6)+_0x501d3c+'\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的参考信息：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的角色设定**:\x20'+_0x9a8c85[_0x243c52(0x81e)][_0x243c52(0x1216)]+_0x243c52(0x7b6)+_0x3f535b+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x9a8c85[_0x243c52(0x1016)]&&_0x9a8c85[_0x243c52(0x1016)][_0x243c52(0x29d)]>0x0?_0x9a8c85[_0x243c52(0x1016)]['map'](_0x2478a1=>_0x243c52(0xd87)+_0x272f9c(_0x2478a1[_0x243c52(0x827)])+')\x20'+_0x2478a1[_0x243c52(0x73e)])[_0x243c52(0x2c8)]('\x0a'):'无')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x31568b+'\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x39ca76+_0x243c52(0x7b6)+(_0x9a8c85[_0x243c52(0x81e)][_0x243c52(0x558)]?_0x243c52(0xba5)+_0x50a253+'\x20('+_0x275f42+')':'')+_0x243c52(0x7b6)+(_0x9a8c85[_0x243c52(0x81e)][_0x243c52(0x558)]?_0x243c52(0xa68)+_0x57658d:'')+_0x243c52(0xad8)+_0x21379f+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你们最后的对话摘要**:\x20'+_0x10e4fa+_0x243c52(0x7b6)+_0x9b647e+'\x0a',_0x1f883c=[{'role':'system','content':_0x3be594},..._0x2c1b0b['map'](_0x5e82a3=>{const _0x12d599=_0x243c52,_0x5cca31=_0x5e82a3[_0x12d599(0xb4d)]===_0x12d599(0x10ae)?_0xece2cb:_0x9a8c85[_0x12d599(0x234)];let _0x388005=_0x5e82a3[_0x12d599(0x73e)];return typeof _0x388005!==_0x12d599(0xfc5)&&(_0x388005=JSON[_0x12d599(0xe1e)](_0x388005)),{'role':_0x5e82a3['role'],'content':_0x5cca31+':\x20'+_0x388005};})];try{const _0x33091c=[{'role':_0x243c52(0x10ae),'content':_0x3be594+'\x0a\x0a[系统指令：请根据你在上面读到的规则和以下最新信息，开始你的独立行动。]\x0a'+_0x9b647e}];console[_0x243c52(0x1081)](_0x243c52(0xbb1)+_0x9a8c85[_0x243c52(0x234)]+'\x22)');let _0x4b1e15=_0x2c39af===GEMINI_API_URL,_0x595ff7=_0x1697e7(_0x573699,_0x2e84f7,_0x3be594,_0x33091c);const _0x1ea2ad=_0x4b1e15?await fetch(_0x595ff7[_0x243c52(0xb36)],_0x595ff7[_0x243c52(0xd7c)]):await fetch(_0x2c39af+_0x243c52(0x434),{'method':_0x243c52(0xa4e),'headers':{'Content-Type':_0x243c52(0x85b),'Authorization':_0x243c52(0x841)+_0x2e84f7},'body':JSON[_0x243c52(0xe1e)]({'model':_0x573699,'messages':_0x33091c,'temperature':_0x53d851[_0x243c52(0x906)][_0x243c52(0xaf8)]||0.9})});if(!_0x1ea2ad['ok']){const _0x3193c2=await _0x1ea2ad[_0x243c52(0xdc2)]();throw new Error(_0x243c52(0x11a5)+_0x1ea2ad[_0x243c52(0x12d3)]+_0x243c52(0x122c)+JSON[_0x243c52(0xe1e)](_0x3193c2));}const _0x42e8af=await _0x1ea2ad[_0x243c52(0xdc2)](),_0x119109=_0x4b1e15?getGeminiResponseText(_0x42e8af):_0x42e8af[_0x243c52(0x12bf)][0x0]['message'][_0x243c52(0x73e)];if(!_0x119109||_0x119109[_0x243c52(0x13bc)]()===''){console[_0x243c52(0xad0)](_0x243c52(0x50b)+_0x9a8c85['name']+_0x243c52(0x1182));return;}const _0x482809=_0x3e5855(_0x119109);if(!_0x482809||_0x482809['length']===0x0){console[_0x243c52(0xad0)]('API格式不正确，角色\x20\x22'+_0x9a8c85['name']+_0x243c52(0xc58),_0x119109);return;}let _0xacd01a=Date[_0x243c52(0x9c1)](),_0x46d790=![];const _0x2595c0=[];for(const _0x3f201c of _0x482809){const _0x45f00a=String(_0x3f201c[_0x243c52(0x73e)]||''),_0xb5e436=_0x45f00a[_0x243c52(0x13bc)]()[_0x243c52(0x1200)]('<')&&_0x45f00a[_0x243c52(0x13bc)]()[_0x243c52(0xc31)]('>');if(_0x3f201c[_0x243c52(0x919)]==='text'&&!_0xb5e436&&_0x45f00a['includes']('\x0a')){const _0x113b16=_0x45f00a[_0x243c52(0x13e8)](/\n+/)[_0x243c52(0x2dd)](_0x3a2b3b=>_0x3a2b3b[_0x243c52(0x13bc)]());_0x113b16[_0x243c52(0xeaf)](_0x7430d0=>{_0x2595c0['push']({..._0x3f201c,'content':_0x7430d0});});}else _0x2595c0[_0x243c52(0x7dd)](_0x3f201c);}for(const _0x12f9de of _0x2595c0){_0x9a8c85['lastActionType']=_0x12f9de['type'],_0x9a8c85[_0x243c52(0xa28)]=_0xacd01a;let _0x230b3e=null;const _0x50dee0={'role':_0x243c52(0xac5),'senderName':_0x9a8c85['originalName'],'timestamp':_0xacd01a++};let _0x544feb=null;switch(_0x12f9de[_0x243c52(0x919)]){case'qzone_delete_post':{const _0x2bae04=parseInt(_0x12f9de[_0x243c52(0xb09)]),_0x34239d=await _0xa62efb[_0x243c52(0xfc2)][_0x243c52(0x883)](_0x2bae04);if(_0x34239d&&_0x34239d[_0x243c52(0xa59)]===_0x17c5f5){await _0xa62efb[_0x243c52(0xfc2)]['update'](_0x2bae04,{'isDeleted':!![]});document['getElementById'](_0x243c52(0x116e))[_0x243c52(0x1276)][_0x243c52(0x6a3)]('active')&&_0x3679f3();const _0x34e273={'role':_0x243c52(0xab3),'type':'post_deleted_notice','content':'['+_0x9a8c85[_0x243c52(0x234)]+_0x243c52(0x3f6),'postId':_0x2bae04,'timestamp':_0xacd01a++};_0x9a8c85['history'][_0x243c52(0x7dd)](_0x34e273),isViewingThisChat?_0xa4d65(_0x34e273,_0x9a8c85):(_0x9a8c85['unreadCount']=(_0x9a8c85[_0x243c52(0x8ce)]||0x0)+0x1,_0x23d2a1(_0x17c5f5,'['+_0x9a8c85['name']+'\x20删除了自己的一条动态]'),_0x46d790=!![]);}else console[_0x243c52(0xad0)](_0x243c52(0x1091)+_0x9a8c85[_0x243c52(0x234)]+'\x22\x20尝试删除一个不存在或不属于自己的动态\x20(ID:\x20'+_0x12f9de[_0x243c52(0xb09)]+')');continue;}case _0x243c52(0x2e6):_0x230b3e={..._0x50dee0,'content':_0x12f9de['content']};break;case'ai_image':_0x230b3e={..._0x50dee0,'type':'ai_image','content':_0x12f9de['description']};break;case _0x243c52(0x257):if(_0x12f9de[_0x243c52(0x75f)]){const _0x270b9d=_0x53d851[_0x243c52(0xf8f)]['find'](_0x5cfefd=>_0x5cfefd['name']===_0x12f9de[_0x243c52(0x75f)]);_0x270b9d?_0x230b3e={..._0x50dee0,'type':'sticker','content':_0x270b9d[_0x243c52(0xb36)],'meaning':_0x270b9d[_0x243c52(0x234)]}:(console['warn'](_0x243c52(0x467)+_0x12f9de['meaning']+'\x22'),_0x230b3e={..._0x50dee0,'type':_0x243c52(0x2e6),'content':_0x243c52(0x6b1)+_0x12f9de['meaning']+']'});}else console['warn'](_0x243c52(0x25e),_0x12f9de),_0x230b3e={..._0x50dee0,'type':'sticker','content':_0x12f9de[_0x243c52(0xb36)],'meaning':_0x243c52(0x8ad)};break;case _0x243c52(0x739):_0x9a8c85[_0x243c52(0x12d3)][_0x243c52(0x2e6)]=_0x12f9de[_0x243c52(0x10bd)],_0x9a8c85[_0x243c52(0x12d3)]['isBusy']=_0x12f9de[_0x243c52(0x4b2)]||![],_0x9a8c85[_0x243c52(0x12d3)][_0x243c52(0x6a6)]=Date[_0x243c52(0x9c1)]();break;case _0x243c52(0xc50):const _0x172391={'type':_0x12f9de[_0x243c52(0xc57)],'content':_0x12f9de[_0x243c52(0x73e)]||'','publicText':_0x12f9de['publicText']||'','hiddenContent':_0x12f9de[_0x243c52(0x319)]||'','image_prompt':_0x12f9de[_0x243c52(0xadb)]||'','timestamp':Date[_0x243c52(0x9c1)](),'authorId':_0x17c5f5,'authorOriginalName':_0x9a8c85[_0x243c52(0x543)],'authorGroupId':_0x9a8c85[_0x243c52(0x608)],'visibleGroupIds':null};await _0xa62efb[_0x243c52(0xfc2)]['add'](_0x172391),_0x5bac35(_0x13cfad+0x1),console[_0x243c52(0x1081)](_0x243c52(0x1089)+_0x9a8c85[_0x243c52(0x234)]+_0x243c52(0xd8a));break;case _0x243c52(0x784):const _0x49d7de=await _0xa62efb['qzonePosts'][_0x243c52(0x883)](parseInt(_0x12f9de[_0x243c52(0xb09)]));if(_0x49d7de){const _0x2f9fa9={'type':_0x243c52(0x784),'timestamp':Date[_0x243c52(0x9c1)](),'authorId':_0x17c5f5,'authorGroupId':_0x9a8c85['groupId'],'authorOriginalName':_0x9a8c85[_0x243c52(0x543)],'repostComment':_0x12f9de[_0x243c52(0x1445)]||'','originalPost':_0x49d7de,'visibleGroupIds':null};await _0xa62efb[_0x243c52(0xfc2)][_0x243c52(0xe13)](_0x2f9fa9),_0x5bac35(_0x13cfad+0x1),console[_0x243c52(0x1081)](_0x243c52(0x1089)+_0x9a8c85['name']+_0x243c52(0xe24)+_0x12f9de[_0x243c52(0xb09)]);}break;case _0x243c52(0x1de):const _0x572e65=await _0xa62efb[_0x243c52(0xfc2)][_0x243c52(0x883)](parseInt(_0x12f9de['postId']));if(_0x572e65){if(!_0x572e65[_0x243c52(0xf52)])_0x572e65[_0x243c52(0xf52)]=[];!_0x572e65['likes']['includes'](_0x9a8c85['originalName'])&&(_0x572e65[_0x243c52(0xf52)][_0x243c52(0x7dd)](_0x9a8c85[_0x243c52(0x543)]),await _0xa62efb[_0x243c52(0xfc2)][_0x243c52(0xc03)](_0x572e65['id'],{'likes':_0x572e65[_0x243c52(0xf52)]}),_0x5bac35(_0x13cfad+0x1),console[_0x243c52(0x1081)](_0x243c52(0x1089)+_0x9a8c85[_0x243c52(0x234)]+_0x243c52(0x11da)+_0x12f9de[_0x243c52(0xb09)]));}break;case _0x243c52(0x69e):{const _0x4a138d=await _0xa62efb[_0x243c52(0xfc2)][_0x243c52(0x883)](parseInt(_0x12f9de[_0x243c52(0xb09)]));if(_0x4a138d){if(!_0x4a138d['comments'])_0x4a138d[_0x243c52(0x11ed)]=[];const _0x4519d2=_0x12f9de[_0x243c52(0x234)]||_0x9a8c85[_0x243c52(0x543)],_0x1cc099=(_0x24fc5d,_0x41c99e=null,_0x397dff=null)=>({'commenterName':_0x4519d2,'text':_0x1cea24(_0x24fc5d,_0x9a8c85),'meaning':_0x41c99e,'replyTo':_0x397dff,'timestamp':Date[_0x243c52(0x9c1)]()});if(_0x12f9de[_0x243c52(0xd02)]){const _0x111db0=_0x53d851[_0x243c52(0xf8f)][_0x243c52(0x397)](_0xc6c9bb=>_0xc6c9bb[_0x243c52(0x234)]===_0x12f9de['stickerMeaning']);_0x111db0?_0x4a138d[_0x243c52(0x11ed)][_0x243c52(0x7dd)](_0x1cc099(_0x111db0[_0x243c52(0xb36)],_0x111db0[_0x243c52(0x234)],_0x12f9de['replyTo']||null)):(console[_0x243c52(0xad0)](_0x243c52(0x5d0)+_0x12f9de[_0x243c52(0xd02)]+'\x22'),_0x4a138d[_0x243c52(0x11ed)]['push'](_0x1cc099(_0x243c52(0x6b1)+_0x12f9de['stickerMeaning']+']',null,_0x12f9de[_0x243c52(0x7fc)]||null)));}else{if(Array[_0x243c52(0xb31)](_0x12f9de['comments']))_0x12f9de[_0x243c52(0x11ed)][_0x243c52(0xeaf)](_0x589bfa=>{const _0x1251ff=_0x243c52;typeof _0x589bfa===_0x1251ff(0xfc5)&&_0x589bfa[_0x1251ff(0x13bc)]()&&_0x4a138d['comments'][_0x1251ff(0x7dd)](_0x1cc099(_0x589bfa,null,_0x12f9de[_0x1251ff(0x7fc)]||null));});else typeof _0x12f9de[_0x243c52(0xc6d)]==='string'&&_0x12f9de[_0x243c52(0xc6d)][_0x243c52(0x13bc)]()&&_0x4a138d[_0x243c52(0x11ed)][_0x243c52(0x7dd)](_0x1cc099(_0x12f9de[_0x243c52(0xc6d)],null,_0x12f9de['replyTo']||null));}await _0xa62efb[_0x243c52(0xfc2)][_0x243c52(0xc03)](_0x4a138d['id'],{'comments':_0x4a138d[_0x243c52(0x11ed)]}),_0x5bac35(_0x13cfad+0x1),console[_0x243c52(0x1081)](_0x243c52(0x1089)+_0x9a8c85[_0x243c52(0x234)]+_0x243c52(0xd36)+_0x12f9de[_0x243c52(0xb09)]);if(!_0x9a8c85[_0x243c52(0xd47)])_0x9a8c85[_0x243c52(0xd47)]={};_0x9a8c85[_0x243c52(0xd47)][_0x12f9de[_0x243c52(0xb09)]]=Date[_0x243c52(0x9c1)]();}continue;}case _0x243c52(0xb78):!_0x58a059['isActive']&&!_0x58a059[_0x243c52(0xf9b)]&&(_0x58a059[_0x243c52(0xf9b)]=!![],_0x58a059[_0x243c52(0x13be)]=_0x17c5f5,_0x58a059[_0x243c52(0x732)]=![],_0x58a059[_0x243c52(0xa0b)]=_0x9a8c85[_0x243c52(0x234)],_0x525e26());break;default:console[_0x243c52(0xad0)](_0x243c52(0x6fc)+_0x9a8c85[_0x243c52(0x234)]+_0x243c52(0x1023),_0x12f9de[_0x243c52(0x919)]);break;case _0x243c52(0xa2d):{const _0x169945=_0x12f9de[_0x243c52(0x234)],_0x1f24ad=_0x9a8c85[_0x243c52(0x81e)][_0x243c52(0x78e)][_0x243c52(0x397)](_0x321438=>_0x321438[_0x243c52(0x234)]===_0x169945);_0x1f24ad&&(_0x9a8c85[_0x243c52(0x81e)][_0x243c52(0x9e3)]=_0x1f24ad[_0x243c52(0xb36)],await _0x55466c(_0x9a8c85),visibleSystemMessage={'content':'['+_0x9a8c85[_0x243c52(0x234)]+_0x243c52(0x1250)},console[_0x243c52(0x1081)](_0x243c52(0x1089)+_0x9a8c85[_0x243c52(0x234)]+'\x22\x20更换了头像'));break;}}if(_0x230b3e){_0x9a8c85[_0x243c52(0xe83)][_0x243c52(0x7dd)](_0x230b3e),_0x9a8c85[_0x243c52(0x8ce)]=(_0x9a8c85['unreadCount']||0x0)+0x1;if(!_0x46d790){let _0x5d9594=_0x230b3e[_0x243c52(0x919)]===_0x243c52(0x2a5)?_0x243c52(0x1169):_0x230b3e[_0x243c52(0x73e)]||'';_0x23d2a1(_0x17c5f5,_0x5d9594),_0x46d790=!![];}}}await _0xa62efb[_0x243c52(0xaa3)]['put'](_0x9a8c85);}catch(_0x365470){console['error'](_0x243c52(0x6fc)+_0x9a8c85[_0x243c52(0x234)]+_0x243c52(0x13c5),_0x365470);}finally{_0x415ffa(_0x17c5f5,![]),_0x5001a4(),document[_0x243c52(0x53a)](_0x243c52(0x116e))[_0x243c52(0x1276)][_0x243c52(0x6a3)](_0x243c52(0xdf6))&&_0x3679f3();}}async function _0x1a6cc0(_0x2d932f){const _0x519ec2=_0x13d875,_0xd7211f=_0x53d851[_0x519ec2(0xaa3)][_0x2d932f];if(!_0xd7211f||!_0xd7211f[_0x519ec2(0x86e)])return;const _0xa84421=_0xd7211f[_0x519ec2(0x81e)]['actionCooldownMinutes']||0xa;if(_0xd7211f['lastActionTimestamp']){const _0x378a26=(Date[_0x519ec2(0x9c1)]()-_0xd7211f[_0x519ec2(0xa28)])/(0x3e8*0x3c);if(_0x378a26<_0xa84421){console[_0x519ec2(0x1081)](_0x519ec2(0x49a)+_0xd7211f[_0x519ec2(0x234)]+_0x519ec2(0x113e));return;}}const {proxyUrl:_0x30155f,apiKey:_0x2ca441,model:_0x51462b}=_0x53d851[_0x519ec2(0x80d)];if(!_0x30155f||!_0x2ca441||!_0x51462b)return;const _0x1241ae=_0xd7211f[_0x519ec2(0x81e)][_0x519ec2(0x1303)]||'我',_0x5e4357=new Date();let _0x25dd2d;const _0x210d49=_0xd7211f[_0x519ec2(0xe83)][_0x519ec2(0x2dd)](_0x183b74=>!_0x183b74[_0x519ec2(0x1032)])[_0x519ec2(0x1340)](-0x5),_0x18a30f=_0x210d49[_0x519ec2(0x397)](_0x8a2af7=>_0x8a2af7[_0x519ec2(0x919)]===_0x519ec2(0x10a0)&&!_0x8a2af7[_0x519ec2(0x70f)]);if(_0x18a30f){const _0x28d5c7=_0xf33fb2(_0xd7211f,_0x18a30f[_0x519ec2(0xbee)]);console[_0x519ec2(0x1081)](_0x519ec2(0x144b)+_0xd7211f[_0x519ec2(0x234)]+_0x519ec2(0x85c)),_0x25dd2d='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的【【【最高优先级任务】】】\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中刚刚出现了一个由“'+_0x28d5c7+_0x519ec2(0xd59)+_0x18a30f[_0x519ec2(0x827)]+_0x519ec2(0xd77)+_0x18a30f[_0x519ec2(0x827)]+_0x519ec2(0x10d3);}else{let _0x241c7c='';const _0x185a77=_0xd7211f['settings'][_0x519ec2(0x13fa)]||_0x519ec2(0x7c3),_0x5ef29b=_0x5e4357[_0x519ec2(0x5ee)](_0x519ec2(0x42f),{'timeZone':_0x185a77,'dateStyle':_0x519ec2(0xbcc),'timeStyle':_0x519ec2(0xa18)}),_0x391f40=new Date(_0x5e4357[_0x519ec2(0x5ee)](_0x519ec2(0x407),{'timeZone':_0x185a77}));if(_0xd7211f['settings'][_0x519ec2(0x558)]){const _0x40cd98=_0xd7211f[_0x519ec2(0xe83)][_0x519ec2(0x2dd)](_0x45b157=>!_0x45b157[_0x519ec2(0x1032)])[_0x519ec2(0x1340)](-0x1)[0x0];if(_0x40cd98){const _0x5a05a3=new Date(_0x40cd98[_0x519ec2(0x827)]),_0x46d41e=(_0x5e4357-_0x5a05a3)/(0x3e8*0x3c);_0x46d41e>0x3c?_0x241c7c=_0x519ec2(0x1293)+Math[_0x519ec2(0x143a)](_0x46d41e/0x3c)+_0x519ec2(0x1434):_0x241c7c=_0x519ec2(0xcad)+Math[_0x519ec2(0x7d5)](_0x46d41e)+_0x519ec2(0x808);}else _0x241c7c=_0x519ec2(0x848);}let _0x330109='你们最近没有有效聊天记录。';const _0x4197b4=_0xd7211f['settings']['maxMemory']||0xa,_0xc8d8a6=_0xd7211f[_0x519ec2(0xe83)]['filter'](_0x5aed6a=>!_0x5aed6a['isHidden'])[_0x519ec2(0x1340)](-_0x4197b4);_0xc8d8a6['length']>0x0&&(_0x330109=_0x519ec2(0x1fc)+_0xc8d8a6['map'](_0x2448da=>{const _0x54aef5=_0x519ec2,_0x382444=_0x2448da[_0x54aef5(0xb4d)]==='user'?_0x1241ae:_0xf33fb2(_0xd7211f,_0x2448da[_0x54aef5(0xbee)]),_0x37d10d=String(_0x2448da[_0x54aef5(0x73e)]||_0x2448da['message']||'')['substring'](0x0,0x32);return _0x382444+':\x20'+_0x37d10d+'...';})['join']('\x0a'));const _0x1e46e2=_0xd7211f['members']['map'](_0x77849e=>_0x519ec2(0x846)+_0x77849e[_0x519ec2(0x12bc)]+_0x519ec2(0x96e)+_0x77849e['originalName']+'):\x20'+_0x77849e[_0x519ec2(0x11fb)])['join']('\x0a');let _0x4eb159='#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a',_0x175c3a=![];_0xd7211f[_0x519ec2(0x3de)]['forEach'](_0x135995=>{const _0x3ab767=_0x519ec2,_0x47ea74=_0x53d851[_0x3ab767(0xaa3)][_0x135995['id']];_0x47ea74&&_0x47ea74[_0x3ab767(0x1016)]&&_0x47ea74[_0x3ab767(0x1016)][_0x3ab767(0x29d)]>0x0&&(_0x4eb159+=_0x3ab767(0xe56)+_0x135995[_0x3ab767(0x12bc)]+_0x3ab767(0x7d0),_0x4eb159+=_0x47ea74[_0x3ab767(0x1016)]['map'](_0x310140=>'-\x20'+_0x310140['content'])[_0x3ab767(0x2c8)]('\x0a'),_0x175c3a=!![]);});!_0x175c3a&&(_0x4eb159+='-\x20(暂无)');let _0x373643='';if(_0xd7211f['settings'][_0x519ec2(0x4ab)]&&_0xd7211f['settings'][_0x519ec2(0x4ab)][_0x519ec2(0x29d)]>0x0){const _0x142230=_0xd7211f[_0x519ec2(0x81e)][_0x519ec2(0x4ab)][_0x519ec2(0xcb4)](_0x266ea4=>{const _0xe4c174=_0x519ec2,_0x27c2f5=_0x53d851[_0xe4c174(0x10f2)]['find'](_0x5a534e=>_0x5a534e['id']===_0x266ea4);if(!_0x27c2f5||!Array[_0xe4c174(0xb31)](_0x27c2f5[_0xe4c174(0x73e)]))return'';const _0x47b656=_0x27c2f5[_0xe4c174(0x73e)][_0xe4c174(0x2dd)](_0x59fc73=>_0x59fc73['enabled']!==![])['map'](_0x193809=>{const _0x1e6728=_0xe4c174;let _0x511fb8=_0x1e6728(0xbc5)+(_0x193809[_0x1e6728(0x1445)]||_0x1e6728(0x4a4))+'\x0a';return _0x193809['keys'][_0x1e6728(0x29d)]>0x0&&(_0x511fb8+='**关键词:**\x20'+_0x193809['keys'][_0x1e6728(0x2c8)](',\x20')+'\x0a'),_0x511fb8+='**内容:**\x0a'+_0x193809[_0x1e6728(0x73e)],_0x511fb8;})['join']('');return _0x47b656?_0xe4c174(0xa7d)+_0x27c2f5[_0xe4c174(0x234)]+'\x0a'+_0x47b656:'';})[_0x519ec2(0x2dd)](Boolean)[_0x519ec2(0x2c8)]('');_0x142230&&(_0x373643=_0x519ec2(0x11e4)+_0x142230+'\x0a#\x20---\x20世界书设定结束\x20---\x0a');}let _0x1e57b7='';const _0x3757ce=_0xd7211f[_0x519ec2(0x81e)]['linkedMemoryCount']||0xa;if(_0xd7211f[_0x519ec2(0x81e)][_0x519ec2(0x278)]&&_0xd7211f[_0x519ec2(0x81e)][_0x519ec2(0x278)]['length']>0x0){const _0x2d77c0=_0xd7211f[_0x519ec2(0x81e)][_0x519ec2(0x278)][_0x519ec2(0xcb4)](_0x1d66a9=>{const _0xa7ac9=_0x519ec2,_0x10d8a8=_0x53d851[_0xa7ac9(0xaa3)][_0x1d66a9];if(!_0x10d8a8)return null;const _0x1bae54=_0x10d8a8[_0xa7ac9(0xe83)][_0xa7ac9(0x1340)](-0x1)[0x0];return{'chat':_0x10d8a8,'latestTimestamp':_0x1bae54?_0x1bae54[_0xa7ac9(0x827)]:0x0};})[_0x519ec2(0x2dd)](Boolean);_0x2d77c0[_0x519ec2(0xdb0)]((_0x39f6ef,_0x30c50e)=>_0x30c50e[_0x519ec2(0x616)]-_0x39f6ef[_0x519ec2(0x616)]),_0x1e57b7+=_0x519ec2(0x3bf);for(const _0x1c7960 of _0x2d77c0){const _0x349679=_0x1c7960[_0x519ec2(0x2d8)],_0x3df166=_0x349679[_0x519ec2(0x86e)]?_0x519ec2(0xbf8):_0x519ec2(0x829),_0x93a033=_0x1c7960['latestTimestamp']>0x0?_0x519ec2(0x125e)+_0x272f9c(_0x1c7960[_0x519ec2(0x616)])+')':'';_0x1e57b7+=_0x519ec2(0x129a)+_0x3df166+'“'+_0x349679['name']+_0x519ec2(0x8d5)+_0x93a033+'\x20---\x0a';const _0x15c925=_0x349679[_0x519ec2(0xe83)][_0x519ec2(0x1340)](-_0x3757ce),_0x336696=_0x15c925[_0x519ec2(0x2dd)](_0x19e1ab=>!String(_0x19e1ab[_0x519ec2(0x73e)])['includes'](_0x519ec2(0x138c)));_0x336696[_0x519ec2(0x29d)]>0x0?_0x336696['forEach'](_0x5b2200=>{const _0xdff34e=_0x519ec2,_0x3edf78=_0x5b2200[_0xdff34e(0xb4d)]===_0xdff34e(0x10ae)?_0x349679['settings']['myNickname']||'我':_0x5b2200[_0xdff34e(0xbee)]||_0x349679[_0xdff34e(0x234)];let _0x5bc361=String(_0x5b2200[_0xdff34e(0x73e)]);if(_0x5b2200[_0xdff34e(0x919)]===_0xdff34e(0x2a5)||_0x5b2200[_0xdff34e(0x919)]===_0xdff34e(0x1053))_0x5bc361='[发送了一张图片，描述为：'+_0x5b2200['content']+']';else _0x5b2200[_0xdff34e(0x919)]===_0xdff34e(0x64f)&&(_0x5bc361=_0xdff34e(0xd11)+_0x5b2200[_0xdff34e(0x73e)]+']');_0x1e57b7+=_0x3edf78+':\x20'+_0x5bc361+'\x0a';}):_0x1e57b7+='(暂无有效聊天记录)\x0a';}}const _0x4139f2=await _0xa62efb[_0x519ec2(0xfc2)]['orderBy'](_0x519ec2(0x827))[_0x519ec2(0x843)]()[_0x519ec2(0x675)](0x5)[_0x519ec2(0xa73)]();let _0x533d5a='';const _0x1c6681=new Set();for(const _0x2e7e47 of _0xd7211f[_0x519ec2(0x3de)]){const _0xb3984d=_0x53d851['chats'][_0x2e7e47['id']];if(_0xb3984d){const _0xa82adc=_0xd757d6(_0x4139f2,_0xb3984d);_0xa82adc[_0x519ec2(0xeaf)](_0x32aec0=>_0x1c6681['add'](_0x32aec0));}}const _0x4b08d9=new Set(_0xd7211f[_0x519ec2(0x3de)]['map'](_0x26d7b0=>_0x26d7b0[_0x519ec2(0x543)])),_0x425fe8=[..._0x1c6681][_0x519ec2(0x2dd)](_0x37340f=>{const _0x2dae91=_0x519ec2,_0x166b15=_0x37340f['likes']&&_0x37340f['likes']['some'](_0x5e7a4a=>_0x4b08d9[_0x2dae91(0x11af)](_0x5e7a4a)),_0x1507f9=_0x37340f[_0x2dae91(0x11ed)]&&_0x37340f[_0x2dae91(0x11ed)][_0x2dae91(0xe0f)](_0x50dd65=>typeof _0x50dd65==='object'&&_0x4b08d9[_0x2dae91(0x11af)](_0x50dd65[_0x2dae91(0x3a7)]));return!_0x166b15&&!_0x1507f9;});if(_0x425fe8[_0x519ec2(0x29d)]>0x0){let _0x452ed3=_0x519ec2(0xefe);for(const _0x3700dd of _0x425fe8){let _0x3a1184=_0x3700dd[_0x519ec2(0xa59)]===_0x519ec2(0x10ae)?_0x1241ae:_0x53d851[_0x519ec2(0xaa3)][_0x3700dd[_0x519ec2(0xa59)]]?.[_0x519ec2(0x234)]||_0x519ec2(0x548),_0x5e8aa1;if(_0x3700dd['type']==='repost'){const _0x578244=_0x3700dd[_0x519ec2(0x113c)]?_0x519ec2(0x82e)+_0x3700dd[_0x519ec2(0x113c)]+'”':'';let _0x3c823b=_0x519ec2(0x101d);const _0xe75f88=_0x3700dd[_0x519ec2(0x43c)][_0x519ec2(0xa59)];if(_0xe75f88==='user')_0x3c823b=_0x53d851[_0x519ec2(0xa74)][_0x519ec2(0x1005)];else _0x53d851[_0x519ec2(0xaa3)][_0xe75f88]&&(_0x3c823b=_0x53d851['chats'][_0xe75f88][_0x519ec2(0x234)]);let _0x39c33d;const _0x318b92=_0x3700dd['originalPost'];if(_0x318b92[_0x519ec2(0x919)]===_0x519ec2(0xa9a))_0x39c33d='[文字图]\x20'+(_0x318b92[_0x519ec2(0x678)]||'')+_0x519ec2(0xd1a)+(_0x318b92['hiddenContent']||'')['substring'](0x0,0x28)+_0x519ec2(0x118e);else _0x318b92['type']==='image_post'?_0x39c33d=_0x519ec2(0xd9a)+(_0x318b92[_0x519ec2(0x678)]||'')+_0x519ec2(0xd1a)+(_0x318b92['imageDescription']||'')[_0x519ec2(0xad6)](0x0,0x28)+'...”)':_0x39c33d='“'+(_0x318b92[_0x519ec2(0x73e)]||'')[_0x519ec2(0xad6)](0x0,0x28)+'...”';_0x5e8aa1='转发了\x20@'+_0x3c823b+_0x519ec2(0x1321)+_0x578244+_0x519ec2(0x4a8)+_0x39c33d+'】';}else{if(_0x3700dd['type']===_0x519ec2(0xa9a))_0x5e8aa1=(_0x519ec2(0x1287)+_0x3700dd[_0x519ec2(0x319)]+'”]\x20'+(_0x3700dd[_0x519ec2(0x678)]||''))[_0x519ec2(0xad6)](0x0,0x32)+_0x519ec2(0x95d);else _0x3700dd['type']==='image_post'?_0x5e8aa1=(_0x519ec2(0x768)+_0x3700dd['imageDescription']+_0x519ec2(0xb56)+(_0x3700dd[_0x519ec2(0x678)]||''))[_0x519ec2(0xad6)](0x0,0x32)+'...':_0x5e8aa1=String(_0x3700dd['publicText']||_0x3700dd[_0x519ec2(0x73e)]||'一条动态')[_0x519ec2(0xad6)](0x0,0x32)+_0x519ec2(0x95d);}_0x452ed3+=_0x519ec2(0x924)+_0x3700dd['id']+_0x519ec2(0x79f)+_0x3a1184+_0x519ec2(0x9db)+_0x5e8aa1+'\x22\x0a';if(_0x3700dd[_0x519ec2(0x11ed)]&&_0x3700dd[_0x519ec2(0x11ed)]['length']>0x0)for(const _0x4fdbbb of _0x3700dd[_0x519ec2(0x11ed)]){if(typeof _0x4fdbbb===_0x519ec2(0xc74)&&_0x4fdbbb[_0x519ec2(0x3a7)]){const _0x3c47e6=_0x4b300d(_0x4fdbbb[_0x519ec2(0x3a7)]);let _0x1659f8=_0x4fdbbb[_0x519ec2(0x75f)]?_0x519ec2(0x13d4)+_0x4fdbbb[_0x519ec2(0x75f)]+'\x27]':_0x4fdbbb[_0x519ec2(0x2e6)];_0x452ed3+=_0x519ec2(0xcf9)+_0x3c47e6+_0x519ec2(0xdb3)+_0x4fdbbb['commenterName']+'):\x20'+_0x1659f8+'\x0a';}}}_0x533d5a=_0x452ed3;}const _0xd03bdf=_0x32a9cb(_0xd7211f,0x3,'hours'),_0x142d54=_0x32a9cb(_0xd7211f,0x6,'hours'),_0x41a03c=_0x32a9cb(_0xd7211f,0x9,_0x519ec2(0x81f)),_0xd34d0a=_0x32a9cb(_0xd7211f,0x1,_0x519ec2(0xc61)),_0x2c42ff=_0x32a9cb(_0xd7211f,0x3,_0x519ec2(0xc61)),_0x14a466=_0x32a9cb(_0xd7211f,0x7,_0x519ec2(0xc61));let _0xdfbb41='';if(_0xd03bdf||_0x142d54||_0x41a03c||_0xd34d0a||_0x2c42ff||_0x14a466){_0xdfbb41+=_0x519ec2(0x3fd);if(_0xd03bdf)_0xdfbb41+=_0xd03bdf;if(_0x142d54)_0xdfbb41+=_0x142d54;if(_0x41a03c)_0xdfbb41+=_0x41a03c;if(_0xd03bdf||_0x142d54||_0x41a03c)_0xdfbb41+='\x0a';if(_0xd34d0a)_0xdfbb41+=_0xd34d0a;if(_0x2c42ff)_0xdfbb41+=_0x2c42ff;if(_0x14a466)_0xdfbb41+=_0x14a466;}const _0x526a88=_0x194105(_0xd7211f);_0x25dd2d='\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊AI导演。你现在控制着一个名为“'+_0xd7211f[_0x519ec2(0x234)]+_0x519ec2(0x114c)+(_0xd7211f[_0x519ec2(0x81e)]['enableTimePerception']?_0x519ec2(0xc42)+_0x5ef29b+'。':'')+_0x519ec2(0x7b6)+(_0x241c7c?_0x241c7c+'\x20':'')+_0x519ec2(0xa6e)+_0x4eb159+_0x519ec2(0x66c)+_0x1241ae+'\x22\x20的消息。严格遵守每个角色的设定，禁止出戏。\x0a-请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送文本**:\x20\x27{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22文本内容\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送图片**:\x20\x27{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22图片的详细【中文】描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起投票**:\x20\x27{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22...\x22,\x20\x22options\x22:\x20\x22...\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起群视频**:\x20\x27{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-如何正确使用“引用回复”功能：\x0a-\x20当你想明确地针对群内【任何成员】（包括用户或其他AI角色）之前的某一句具体的话进行回复时，你就应该使用这个功能。\x0a-\x20这会让你的回复上方出现一个灰色的小框，里面是被你引用的那句话，这样对话就不会乱了。\x0a-\x20指令格式:\x20\x27{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20(你想引用的那句话的时间戳),\x20\x22reply_content\x22:\x20\x22你的回复内容\x22}\x27\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前群聊信息\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**群名称**:\x20'+_0xd7211f[_0x519ec2(0x234)]+_0x519ec2(0x7b6)+_0x373643+_0x519ec2(0xecd)+(_0xd7211f[_0x519ec2(0x1016)]&&_0xd7211f[_0x519ec2(0x1016)][_0x519ec2(0x29d)]>0x0?_0xd7211f[_0x519ec2(0x1016)][_0x519ec2(0xcb4)](_0x32efdf=>'-\x20'+_0x32efdf[_0x519ec2(0x73e)])[_0x519ec2(0x2c8)]('\x0a'):_0x519ec2(0xddc))+_0x519ec2(0xbef)+_0xdfbb41+_0x519ec2(0x7b6)+_0x1e57b7+_0x519ec2(0x5dd)+_0x1e46e2+_0x519ec2(0x56c)+_0x526a88+_0x519ec2(0x6da)+_0x1241ae+'**:\x20'+_0xd7211f[_0x519ec2(0x81e)][_0x519ec2(0xab1)]+_0x519ec2(0x1440)+_0x330109+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的动态列表\x20(供你参考和评论)\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x533d5a+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请开始你的导演工作，让群聊再次热闹起来吧！\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}const _0x136266=_0xd7211f[_0x519ec2(0xe83)][_0x519ec2(0x2dd)](_0x351fa2=>!_0x351fa2[_0x519ec2(0x1032)])['slice'](-0xa),_0x2932c7=[{'role':_0x519ec2(0xab3),'content':_0x25dd2d},..._0x136266[_0x519ec2(0xcb4)](_0x2b5a42=>{const _0x2189d0=_0x519ec2,_0x41b0e7=_0x2b5a42[_0x2189d0(0xb4d)]===_0x2189d0(0x10ae)?_0x1241ae:_0xf33fb2(_0xd7211f,_0x2b5a42[_0x2189d0(0xbee)]);let _0x420a40=_0x2b5a42[_0x2189d0(0x73e)];if(_0x2b5a42[_0x2189d0(0x919)]===_0x2189d0(0x2a5)||_0x2b5a42[_0x2189d0(0x919)]===_0x2189d0(0x1053))_0x420a40=_0x2189d0(0x89d)+_0x2b5a42['content']+'\x27]';else{if(_0x2b5a42[_0x2189d0(0x919)]===_0x2189d0(0x64f))_0x420a40=_0x2189d0(0xb1e)+_0x2b5a42['content']+'\x27]';else typeof _0x420a40!==_0x2189d0(0xfc5)&&(_0x420a40=_0x2189d0(0x1d9));}return{'role':_0x2189d0(0x10ae),'content':_0x41b0e7+':\x20'+_0x420a40};})];try{const _0x524db4=[{'role':'user','content':_0x25dd2d}];let _0x7dc8bd=_0x30155f===GEMINI_API_URL,_0x26c724=_0x1697e7(_0x51462b,_0x2ca441,_0x25dd2d,_0x524db4);const _0x35527c=_0x7dc8bd?await fetch(_0x26c724[_0x519ec2(0xb36)],_0x26c724[_0x519ec2(0xd7c)]):await fetch(_0x30155f+'/v1/chat/completions',{'method':_0x519ec2(0xa4e),'headers':{'Content-Type':_0x519ec2(0x85b),'Authorization':_0x519ec2(0x841)+_0x2ca441},'body':JSON[_0x519ec2(0xe1e)]({'model':_0x51462b,'messages':_0x524db4,'temperature':_0x53d851[_0x519ec2(0x906)][_0x519ec2(0xaf8)]||0.9})});if(!_0x35527c['ok'])throw new Error((await _0x35527c['json']())[_0x519ec2(0x617)][_0x519ec2(0x875)]);const _0x2368aa=await _0x35527c['json'](),_0x552d98=_0x7dc8bd?_0x2368aa['candidates'][0x0][_0x519ec2(0x73e)][_0x519ec2(0x8b3)][0x0]['text']:_0x2368aa['choices'][0x0][_0x519ec2(0x875)]['content'],_0x52830e=_0x3e5855(_0x552d98);if(!_0x52830e||_0x52830e[_0x519ec2(0x29d)]===0x0){console[_0x519ec2(0xad0)](_0x519ec2(0x49a)+_0xd7211f['name']+_0x519ec2(0x38d));return;}let _0x2be820=Date[_0x519ec2(0x9c1)](),_0x384acd=![],_0x1b3023='',_0x4ec9c2='';const _0x23280a=[];for(const _0x191b3d of _0x52830e){const _0x53ee50=String(_0x191b3d['content']||''),_0x348e20=_0x53ee50['trim']()[_0x519ec2(0x1200)]('<')&&_0x53ee50[_0x519ec2(0x13bc)]()[_0x519ec2(0xc31)]('>');if(_0x191b3d[_0x519ec2(0x919)]===_0x519ec2(0x2e6)&&!_0x348e20&&_0x53ee50[_0x519ec2(0x6e9)]('\x0a')){const _0x25c20e=_0x53ee50[_0x519ec2(0x13e8)](/\n+/)[_0x519ec2(0x2dd)](_0x32a65e=>_0x32a65e[_0x519ec2(0x13bc)]());_0x25c20e[_0x519ec2(0xeaf)](_0x1eba4e=>{_0x23280a['push']({..._0x191b3d,'content':_0x1eba4e});});}else _0x23280a[_0x519ec2(0x7dd)](_0x191b3d);}for(const _0x3345a4 of _0x23280a){if(!_0x3345a4||!_0x3345a4[_0x519ec2(0x919)]||!_0x3345a4[_0x519ec2(0x234)])continue;const _0x3062b8=_0xf33fb2(_0xd7211f,_0x3345a4[_0x519ec2(0x234)]);let _0x5d6367=null,_0x3a0f85=null;const _0x26537d={'role':'assistant','senderName':_0x3345a4[_0x519ec2(0x234)],'timestamp':_0x2be820++};if(_0x3345a4[_0x519ec2(0x919)]===_0x519ec2(0x8f5)){const _0x43201d=_0xd7211f[_0x519ec2(0xe83)][_0x519ec2(0x397)](_0x47a528=>_0x47a528['timestamp']===_0x3345a4[_0x519ec2(0x7fa)]);if(_0x43201d&&!_0x43201d[_0x519ec2(0x70f)]&&!(_0x43201d[_0x519ec2(0x115a)]&&_0x43201d[_0x519ec2(0x115a)][_0x3345a4[_0x519ec2(0x234)]])){let _0x36cbb3=0x0;const _0x342699=_0x43201d[_0x519ec2(0x820)]-Object[_0x519ec2(0x244)](_0x43201d[_0x519ec2(0x115a)]||{})[_0x519ec2(0xae0)]((_0x5c3097,_0x51b6ed)=>_0x5c3097+_0x51b6ed,0x0),_0x1edddd=_0x43201d[_0x519ec2(0x1003)]-Object[_0x519ec2(0x1350)](_0x43201d[_0x519ec2(0x115a)]||{})[_0x519ec2(0x29d)];if(_0x1edddd>0x0){if(_0x1edddd===0x1)_0x36cbb3=_0x342699;else{const _0x32d1f1=0.01,_0x1471cb=_0x342699-(_0x1edddd-0x1)*_0x32d1f1;_0x36cbb3=Math[_0x519ec2(0xac4)]()*(_0x1471cb-_0x32d1f1)+_0x32d1f1;}_0x36cbb3=parseFloat(_0x36cbb3[_0x519ec2(0x39e)](0x2));if(!_0x43201d['claimedBy'])_0x43201d[_0x519ec2(0x115a)]={};_0x43201d[_0x519ec2(0x115a)][_0x3345a4[_0x519ec2(0x234)]]=_0x36cbb3,_0xd7211f[_0x519ec2(0xe83)][_0x519ec2(0x7dd)]({'role':_0x519ec2(0xab3),'type':_0x519ec2(0x109b),'content':_0x3062b8+_0x519ec2(0x1148)+_0xf33fb2(_0xd7211f,_0x43201d[_0x519ec2(0xbee)])+_0x519ec2(0x10b5),'timestamp':Date[_0x519ec2(0x9c1)]()});let _0x478eb5=_0x519ec2(0xf5b)+_0x3062b8+_0x519ec2(0xcca)+_0x36cbb3[_0x519ec2(0x39e)](0x2)+_0x519ec2(0xaea);if(Object[_0x519ec2(0x1350)](_0x43201d['claimedBy'])['length']>=_0x43201d[_0x519ec2(0x1003)]){_0x43201d[_0x519ec2(0x70f)]=!![],_0xd7211f['history'][_0x519ec2(0x7dd)]({'role':_0x519ec2(0xab3),'type':_0x519ec2(0x109b),'content':_0xf33fb2(_0xd7211f,_0x43201d[_0x519ec2(0xbee)])+_0x519ec2(0x31d),'timestamp':Date['now']()+0x1});let _0x25ab48={'name':'','amount':-0x1};Object[_0x519ec2(0xfdc)](_0x43201d['claimedBy'])[_0x519ec2(0xeaf)](([_0x2ee1e9,_0x29e9cc])=>{const _0x302877=_0x519ec2;_0x29e9cc>_0x25ab48[_0x302877(0x1146)]&&(_0x25ab48={'name':_0x2ee1e9,'amount':_0x29e9cc});});if(_0x25ab48[_0x519ec2(0x234)]){const _0xf9bfdc=_0xf33fb2(_0xd7211f,_0x25ab48['name']);_0x478eb5+='\x20红包已被领完，手气王是\x20'+_0xf9bfdc+'！';}}_0x478eb5+=_0x519ec2(0x3f1),_0xd7211f['history'][_0x519ec2(0x7dd)]({'role':_0x519ec2(0xab3),'content':_0x478eb5,'timestamp':Date[_0x519ec2(0x9c1)]()+0x2,'isHidden':!![]});}}_0x384acd=!![];continue;}switch(_0x3345a4['type']){case _0x519ec2(0x257):if(_0x3345a4['meaning']){const _0x2f71a0=_0x53d851[_0x519ec2(0xf8f)][_0x519ec2(0x397)](_0x316e13=>_0x316e13[_0x519ec2(0x234)]===_0x3345a4[_0x519ec2(0x75f)]);_0x2f71a0?_0x3a0f85={..._0x26537d,'type':'sticker','content':_0x2f71a0[_0x519ec2(0xb36)],'meaning':_0x2f71a0[_0x519ec2(0x234)]}:(console[_0x519ec2(0xad0)](_0x519ec2(0xbd5)+_0x3345a4[_0x519ec2(0x75f)]+'\x22'),_0x3a0f85={..._0x26537d,'type':_0x519ec2(0x2e6),'content':_0x519ec2(0x6b1)+_0x3345a4[_0x519ec2(0x75f)]+']'});}else console[_0x519ec2(0xad0)](_0x519ec2(0xffc),_0x3345a4),_0x3a0f85={..._0x26537d,'type':_0x519ec2(0x257),'content':_0x3345a4[_0x519ec2(0xb36)],'meaning':_0x519ec2(0x8ad)};break;case _0x519ec2(0xc50):const _0x5d0158={'type':_0x3345a4[_0x519ec2(0xc57)]||_0x519ec2(0x12c5),'content':_0x3345a4[_0x519ec2(0x73e)],'timestamp':Date[_0x519ec2(0x9c1)](),'authorId':_0x53d851[_0x519ec2(0xaa3)][Object[_0x519ec2(0x1350)](_0x53d851[_0x519ec2(0xaa3)])[_0x519ec2(0x397)](_0x3b4198=>_0x53d851[_0x519ec2(0xaa3)][_0x3b4198][_0x519ec2(0x543)]===_0x3345a4['name'])]?.['id']||_0x3345a4[_0x519ec2(0x234)],'authorOriginalName':_0x3345a4[_0x519ec2(0x234)],'visibleGroupIds':null};await _0xa62efb[_0x519ec2(0xfc2)][_0x519ec2(0xe13)](_0x5d0158),_0x5bac35(_0x13cfad+0x1),_0x5d6367={'content':'['+_0x3062b8+'\x20发布了一条新动态]'};break;case _0x519ec2(0x69e):const _0x5b4c07=await _0xa62efb[_0x519ec2(0xfc2)][_0x519ec2(0x883)](parseInt(_0x3345a4[_0x519ec2(0xb09)]));if(_0x5b4c07){if(!_0x5b4c07[_0x519ec2(0x11ed)])_0x5b4c07[_0x519ec2(0x11ed)]=[];_0x5b4c07[_0x519ec2(0x11ed)]['push']({'commenterName':_0x3345a4['name'],'text':_0x3345a4[_0x519ec2(0xc6d)],'timestamp':Date[_0x519ec2(0x9c1)]()}),await _0xa62efb[_0x519ec2(0xfc2)][_0x519ec2(0xc03)](_0x5b4c07['id'],{'comments':_0x5b4c07[_0x519ec2(0x11ed)]}),_0x5bac35(_0x13cfad+0x1),_0x5d6367={'content':'['+_0x3062b8+_0x519ec2(0x6d3)};}break;case _0x519ec2(0x1de):const _0x2800c0=await _0xa62efb[_0x519ec2(0xfc2)][_0x519ec2(0x883)](parseInt(_0x3345a4[_0x519ec2(0xb09)]));if(_0x2800c0){if(!_0x2800c0[_0x519ec2(0xf52)])_0x2800c0['likes']=[];!_0x2800c0[_0x519ec2(0xf52)][_0x519ec2(0x6e9)](_0x3345a4[_0x519ec2(0x234)])&&(_0x2800c0['likes'][_0x519ec2(0x7dd)](_0x3345a4['name']),await _0xa62efb['qzonePosts'][_0x519ec2(0xc03)](_0x2800c0['id'],{'likes':_0x2800c0[_0x519ec2(0xf52)]}),_0x5bac35(_0x13cfad+0x1),_0x5d6367={'content':'['+_0x3062b8+_0x519ec2(0xaad)});}break;case _0x519ec2(0x2a5):_0x3a0f85={..._0x26537d,'type':_0x519ec2(0x2a5),'content':_0x3345a4[_0x519ec2(0xa60)],'image_prompt':msgData[_0x519ec2(0xadb)]};break;default:if(_0x3345a4['type']===_0x519ec2(0xf2e)){const _0x1cfbbe=typeof _0x3345a4['options']===_0x519ec2(0xfc5)?_0x3345a4[_0x519ec2(0x473)][_0x519ec2(0x13e8)]('\x0a')[_0x519ec2(0x2dd)](_0x198273=>_0x198273['trim']()):Array['isArray'](_0x3345a4[_0x519ec2(0x473)])?_0x3345a4[_0x519ec2(0x473)]:[];if(_0x1cfbbe[_0x519ec2(0x29d)]<0x2)continue;_0x3a0f85={..._0x26537d,..._0x3345a4,'options':_0x1cfbbe,'votes':{},'isClosed':![]};}else{const _0x3abe1c=_0x3345a4[_0x519ec2(0x73e)]||_0x3345a4['message'];_0x3a0f85={..._0x26537d,..._0x3345a4};if(_0x3abe1c)_0x3a0f85[_0x519ec2(0x73e)]=_0x3abe1c;}break;}if(_0x5d6367)_0xd7211f[_0x519ec2(0xe83)][_0x519ec2(0x7dd)]({'role':_0x519ec2(0xab3),'type':_0x519ec2(0x109b),'content':_0x5d6367[_0x519ec2(0x73e)],'timestamp':_0x2be820++});else _0x3a0f85&&(_0xd7211f[_0x519ec2(0xe83)][_0x519ec2(0x7dd)](_0x3a0f85),!_0x4ec9c2&&(_0x4ec9c2=_0x3062b8,_0x1b3023=_0x3a0f85[_0x519ec2(0x919)]===_0x519ec2(0x2a5)?_0x519ec2(0x1169):_0x3a0f85['content']||'['+_0x3a0f85[_0x519ec2(0x919)]+']'));_0x384acd=!![];}_0x384acd&&(_0xd7211f['lastActionTimestamp']=Date[_0x519ec2(0x9c1)](),_0xd7211f['unreadCount']=(_0xd7211f[_0x519ec2(0x8ce)]||0x0)+_0x52830e[_0x519ec2(0x2dd)](_0xfa2e92=>_0xfa2e92['type']!=='qzone_post'&&_0xfa2e92[_0x519ec2(0x919)]!=='qzone_comment'&&_0xfa2e92[_0x519ec2(0x919)]!==_0x519ec2(0x1de))[_0x519ec2(0x29d)],_0x4ec9c2&&_0x1b3023&&_0x23d2a1(_0x2d932f,_0x4ec9c2+':\x20'+_0x1b3023),await _0xa62efb['chats'][_0x519ec2(0x546)](_0xd7211f));}catch(_0x209fe7){console[_0x519ec2(0x617)](_0x519ec2(0x49a)+_0xd7211f[_0x519ec2(0x234)]+_0x519ec2(0x13c5),_0x209fe7);}finally{_0x5001a4();}}function _0x378258(_0x1b8309,_0x527d55,_0x1d2f09){const _0x2cf5c5=_0x13d875,_0xabe4b7=document[_0x2cf5c5(0x53a)](_0x1d2f09);if(!_0xabe4b7)return;if(!_0x1b8309||_0x1b8309[_0x2cf5c5(0x13bc)]()===''){_0xabe4b7[_0x2cf5c5(0xaac)]='';return;}const _0x1c370d=_0x1b8309[_0x2cf5c5(0x795)](/\s*\.message-bubble\.user\s+([^{]+\{)/g,_0x527d55+_0x2cf5c5(0xb9d))[_0x2cf5c5(0x795)](/\s*\.message-bubble\.ai\s+([^{]+\{)/g,_0x527d55+'\x20.message-bubble.ai\x20$1')[_0x2cf5c5(0x795)](/\s*\.message-bubble\s+([^{]+\{)/g,_0x527d55+_0x2cf5c5(0x10e4));_0xabe4b7[_0x2cf5c5(0xaac)]=_0x1c370d;}async function _0x574a7b(){const _0x107c01=_0x13d875;if(!_0x53d851[_0x107c01(0x13be)])return;const _0x527d59=_0x53d851['chats'][_0x53d851[_0x107c01(0x13be)]],_0x482e81=document['getElementById'](_0x107c01(0x4bd));if(!_0x482e81)return;const _0x2d8dc1=document[_0x107c01(0x139c)](_0x107c01(0xe05))?.['value']||'default',_0x4339fb=document[_0x107c01(0x53a)](_0x107c01(0x813))[_0x107c01(0x11a2)],_0x3d25db=document[_0x107c01(0x53a)]('custom-css-input')[_0x107c01(0x11a2)],_0x561534=_0x527d59[_0x107c01(0x81e)][_0x107c01(0x274)];_0x482e81[_0x107c01(0x999)][_0x107c01(0x1297)]=_0x2d8dc1,_0x482e81['style']['setProperty'](_0x107c01(0xb86),_0x4339fb+'px');_0x561534&&_0x561534[_0x107c01(0x1200)](_0x107c01(0xf48))?(_0x482e81[_0x107c01(0x1284)][_0x107c01(0x2f2)]=_0x107c01(0xf22)+_0x561534+')',_0x482e81['style'][_0x107c01(0x615)]=_0x107c01(0xb80)):(_0x482e81['style'][_0x107c01(0x2f2)]='none',_0x482e81[_0x107c01(0x1284)]['background']=_0x561534||_0x107c01(0xd5a));_0x482e81[_0x107c01(0xaac)]='';const _0x25e164={'role':'ai','content':'对方消息预览','timestamp':0x1,'senderName':_0x527d59['name']},_0x5ec39d=await _0x36bd8d(_0x25e164,_0x527d59);if(_0x5ec39d)_0x482e81[_0x107c01(0x133d)](_0x5ec39d);const _0x29622b={'role':_0x107c01(0x10ae),'content':_0x107c01(0x56e),'timestamp':0x2},_0x519a36=await _0x36bd8d(_0x29622b,_0x527d59);if(_0x519a36)_0x482e81[_0x107c01(0x133d)](_0x519a36);const _0xc4974f=document[_0x107c01(0xd67)](_0x107c01(0x1425));_0xc4974f[_0x107c01(0x1284)][_0x107c01(0x94d)]=_0x107c01(0x423),_0xc4974f['textContent']=_0x107c01(0x758),_0x482e81['appendChild'](_0xc4974f);const _0x50021c=document[_0x107c01(0x53a)]('lyrics-vertical-pos')['value'],_0x479cd6=document[_0x107c01(0x53a)]('lyrics-horizontal-pos')['value'],_0x476292=parseInt(document[_0x107c01(0x53a)]('lyrics-offset-input')[_0x107c01(0x11a2)])||0xa;_0x50021c===_0x107c01(0x624)?_0xc4974f[_0x107c01(0x1284)][_0x107c01(0x624)]=_0x476292+'px':_0xc4974f['style'][_0x107c01(0xee1)]=_0x476292+'px';switch(_0x479cd6){case _0x107c01(0xcd7):_0xc4974f[_0x107c01(0x1284)][_0x107c01(0xcd7)]=_0x107c01(0x12f7);break;case _0x107c01(0x4e3):_0xc4974f['style'][_0x107c01(0x4e3)]='15px';break;default:_0xc4974f[_0x107c01(0x1284)][_0x107c01(0xcd7)]=_0x107c01(0xff9),_0xc4974f[_0x107c01(0x1284)][_0x107c01(0xd91)]='translateX(-50%)';break;}_0x378258(_0x3d25db,_0x107c01(0x11db),_0x107c01(0x12d0));}async function _0x20126a(){const _0x76ee55=_0x13d875;await _0x539298(),document[_0x76ee55(0x53a)](_0x76ee55(0x740))[_0x76ee55(0x1276)][_0x76ee55(0xe13)](_0x76ee55(0xaef));}async function _0x539298(){const _0x4b83c9=_0x13d875,_0x2be5b1=document['getElementById'](_0x4b83c9(0x33d)),_0x3e0320=await _0xa62efb[_0x4b83c9(0x443)][_0x4b83c9(0xa73)]();_0x2be5b1[_0x4b83c9(0xaac)]='',_0x3e0320['length']===0x0&&(_0x2be5b1[_0x4b83c9(0xaac)]=_0x4b83c9(0x13e0)),_0x3e0320[_0x4b83c9(0xeaf)](_0x4e1257=>{const _0x4844a2=_0x4b83c9,_0x188177=document[_0x4844a2(0xd67)](_0x4844a2(0x1425));_0x188177[_0x4844a2(0x6de)]=_0x4844a2(0xebc),_0x188177[_0x4844a2(0xaac)]=_0x4844a2(0x12dc)+_0x4e1257['name']+_0x4844a2(0xb15)+_0x4e1257['id']+_0x4844a2(0x2b5),_0x2be5b1[_0x4844a2(0x133d)](_0x188177);});}async function _0x4eb228(){const _0x12320b=_0x13d875,_0x5f1190=document[_0x12320b(0x53a)]('new-group-name-input'),_0x21a147=_0x5f1190[_0x12320b(0x11a2)][_0x12320b(0x13bc)]();if(!_0x21a147){alert(_0x12320b(0x927));return;}const _0x5aa7b9=await _0xa62efb[_0x12320b(0x443)][_0x12320b(0x57e)](_0x12320b(0x234))[_0x12320b(0x12f6)](_0x21a147)['first']();if(_0x5aa7b9){alert(_0x12320b(0x1220)+_0x21a147+_0x12320b(0x11d0));return;}await _0xa62efb[_0x12320b(0x443)][_0x12320b(0xe13)]({'name':_0x21a147}),_0x5f1190[_0x12320b(0x11a2)]='',await _0x539298();}async function _0x31dd16(_0x46a73e){const _0x3fa9c5=_0x13d875,_0xaeb175=await _0x355fc0(_0x3fa9c5(0x69a),_0x3fa9c5(0xe27),{'confirmButtonClass':_0x3fa9c5(0x264)});if(_0xaeb175){await _0xa62efb[_0x3fa9c5(0x443)][_0x3fa9c5(0x121e)](_0x46a73e);const _0x4f358b=await _0xa62efb[_0x3fa9c5(0xaa3)][_0x3fa9c5(0x57e)]('groupId')[_0x3fa9c5(0x12f6)](_0x46a73e)['toArray']();for(const _0x5cc3d9 of _0x4f358b){_0x5cc3d9['groupId']=null,await _0xa62efb[_0x3fa9c5(0xaa3)][_0x3fa9c5(0x546)](_0x5cc3d9);if(_0x53d851[_0x3fa9c5(0xaa3)][_0x5cc3d9['id']])_0x53d851[_0x3fa9c5(0xaa3)][_0x5cc3d9['id']][_0x3fa9c5(0x608)]=null;}await _0x539298();}}function _0x4833d4(_0x5d92b6){const _0x43dc52=_0x13d875,_0x56a156=_0x53d851['chats'][_0x53d851[_0x43dc52(0x13be)]];document[_0x43dc52(0x53a)](_0x43dc52(0x1209))['style'][_0x43dc52(0x11d9)]=_0x56a156[_0x43dc52(0x86e)]?'block':_0x43dc52(0xbf2);if(_0x375e24)return;_0x3d3f39=_0x5d92b6,document['getElementById'](_0x43dc52(0x517))[_0x43dc52(0x1276)][_0x43dc52(0xe13)](_0x43dc52(0xaef));}function _0x294f69(){const _0x2547e3=_0x13d875;document[_0x2547e3(0x53a)]('message-actions-modal')[_0x2547e3(0x1276)][_0x2547e3(0x2d4)]('visible'),_0x3d3f39=null;}async function _0x3f94ac(){const _0x15c628=_0x13d875;if(!_0x3d3f39)return;const _0x33e545=_0x3d3f39,_0x36b3a0=_0x53d851[_0x15c628(0xaa3)][_0x53d851['activeChatId']],_0x595fd8=_0x36b3a0[_0x15c628(0xe83)][_0x15c628(0x397)](_0x2a8c1a=>_0x2a8c1a[_0x15c628(0x827)]===_0x33e545);if(!_0x595fd8)return;_0x294f69();let _0x5504ad;const _0x7f67d5=_0x595fd8[_0x15c628(0x919)]&&[_0x15c628(0x64f),_0x15c628(0x2a5),_0x15c628(0x566),'share_link'][_0x15c628(0x6e9)](_0x595fd8[_0x15c628(0x919)]);if(_0x7f67d5){let _0x31f447={'type':_0x595fd8[_0x15c628(0x919)]};if(_0x595fd8['type']===_0x15c628(0x64f))_0x31f447[_0x15c628(0x73e)]=_0x595fd8['content'];else{if(_0x595fd8[_0x15c628(0x919)]==='ai_image')_0x31f447['description']=_0x595fd8[_0x15c628(0x73e)];else{if(_0x595fd8[_0x15c628(0x919)]===_0x15c628(0x566))_0x31f447['amount']=_0x595fd8[_0x15c628(0x1146)],_0x31f447[_0x15c628(0xbb0)]=_0x595fd8[_0x15c628(0xbb0)];else _0x595fd8[_0x15c628(0x919)]===_0x15c628(0x631)&&(_0x31f447[_0x15c628(0x667)]=_0x595fd8[_0x15c628(0x667)],_0x31f447[_0x15c628(0xa60)]=_0x595fd8[_0x15c628(0xa60)],_0x31f447[_0x15c628(0x8a1)]=_0x595fd8['source_name'],_0x31f447['content']=_0x595fd8['content']);}}_0x5504ad=JSON['stringify'](_0x31f447,null,0x2);}else typeof _0x595fd8[_0x15c628(0x73e)]===_0x15c628(0xc74)?_0x5504ad=JSON['stringify'](_0x595fd8['content'],null,0x2):_0x5504ad=_0x595fd8[_0x15c628(0x73e)];const _0x1b5f50={'voice':{'type':_0x15c628(0x64f),'content':_0x15c628(0x998)},'image':{'type':_0x15c628(0x2a5),'description':'在这里输入图片描述'},'transfer':{'type':_0x15c628(0x566),'amount':5.2,'note':'一点心意'},'link':{'type':_0x15c628(0x631),'title':_0x15c628(0x95f),'description':_0x15c628(0x418),'source_name':'来源网站','content':_0x15c628(0xb73)}},_0x16993b='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x15c628(0xe1e)](_0x1b5f50[_0x15c628(0x3d0)])+_0x15c628(0x1134)+JSON[_0x15c628(0xe1e)](_0x1b5f50['image'])+_0x15c628(0x136f)+JSON[_0x15c628(0xe1e)](_0x1b5f50[_0x15c628(0x566)])+'\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x15c628(0xe1e)](_0x1b5f50[_0x15c628(0x105d)])+_0x15c628(0x98e),_0x5b6b3b=await _0x4f6537('编辑消息',_0x15c628(0x201),_0x5504ad,'textarea',_0x16993b);_0x5b6b3b!==null&&await _0x3080c3(_0x33e545,_0x5b6b3b,!![]);}async function _0x5caf6b(){const _0x511ae0=_0x13d875;if(!_0x3d3f39)return;const _0x47e625=_0x53d851['chats'][_0x53d851[_0x511ae0(0x13be)]],_0x108cfd=_0x47e625[_0x511ae0(0xe83)][_0x511ae0(0x397)](_0x537103=>_0x537103[_0x511ae0(0x827)]===_0x3d3f39);if(!_0x108cfd)return;let _0x3e2b96;typeof _0x108cfd['content']===_0x511ae0(0xc74)?_0x3e2b96=JSON[_0x511ae0(0xe1e)](_0x108cfd[_0x511ae0(0x73e)]):_0x3e2b96=String(_0x108cfd[_0x511ae0(0x73e)]);try{await navigator[_0x511ae0(0x551)]['writeText'](_0x3e2b96),await _0x184397(_0x511ae0(0xe50),'消息内容已复制到剪贴板。');}catch(_0x49def3){await _0x184397(_0x511ae0(0xf0e),_0x511ae0(0x12f5));}_0x294f69();}async function _0x49f969(){const _0x1834d2=_0x13d875;if(!_0x3d3f39)return;try{await navigator[_0x1834d2(0x551)][_0x1834d2(0xee3)](_0x3d3f39),await _0x184397(_0x1834d2(0xe50),_0x1834d2(0x23d)+_0x3d3f39+'\x20已复制到剪贴板。');}catch(_0x18c045){await _0x184397('复制失败',_0x1834d2(0x12f5));}_0x294f69();}function _0x3e3f54(_0xf93985=''){const _0x3dfadf=_0x13d875,_0x3aab95=document[_0x3dfadf(0xd67)](_0x3dfadf(0x1425));_0x3aab95[_0x3dfadf(0x6de)]=_0x3dfadf(0x595);const _0x5a2262={'voice':{'type':_0x3dfadf(0x64f),'content':_0x3dfadf(0x998)},'image':{'type':_0x3dfadf(0x2a5),'description':_0x3dfadf(0x4c6)},'transfer':{'type':_0x3dfadf(0x566),'amount':5.2,'note':_0x3dfadf(0x121a)},'link':{'type':_0x3dfadf(0x631),'title':'文章标题','description':_0x3dfadf(0x418),'source_name':'来源网站','content':_0x3dfadf(0xb73)},'offline':{'type':_0x3dfadf(0x8c3),'content':_0x3dfadf(0x362)},'quote':{'type':'quote_reply','target_timestamp':0x499602d2,'reply_content':'在这里输入回复内容'}};return _0x3aab95[_0x3dfadf(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>'+_0xf93985+_0x3dfadf(0xb9c)+JSON[_0x3dfadf(0xe1e)](_0x5a2262[_0x3dfadf(0x3d0)])+'\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x3dfadf(0xe1e)](_0x5a2262[_0x3dfadf(0xace)])+_0x3dfadf(0xb90)+JSON[_0x3dfadf(0xe1e)](_0x5a2262[_0x3dfadf(0x566)])+'\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x3dfadf(0xe1e)](_0x5a2262[_0x3dfadf(0x105d)])+_0x3dfadf(0x903)+JSON[_0x3dfadf(0xe1e)](_0x5a2262[_0x3dfadf(0x450)])+_0x3dfadf(0xc15)+JSON[_0x3dfadf(0xe1e)](_0x5a2262[_0x3dfadf(0x6a2)])+_0x3dfadf(0x746),_0x3aab95[_0x3dfadf(0x139c)]('.delete-block-btn')[_0x3dfadf(0x1086)](_0x3dfadf(0xb2b),()=>{const _0x4d30e8=_0x3dfadf;document[_0x4d30e8(0xc3d)]('.message-editor-block')['length']>0x1?_0x3aab95[_0x4d30e8(0x2d4)]():alert(_0x4d30e8(0x872));}),_0x3aab95[_0x3dfadf(0xc3d)](_0x3dfadf(0x12be))[_0x3dfadf(0xeaf)](_0x1996c1=>{_0x1996c1['addEventListener']('click',()=>{const _0x5377a0=_0x55b8,_0x124ef4=_0x1996c1['dataset']['template'],_0x5d6ff6=_0x3aab95['querySelector']('textarea');if(_0x124ef4&&_0x5d6ff6)try{const _0x55c209=JSON['parse'](_0x124ef4);_0x5d6ff6[_0x5377a0(0x11a2)]=JSON[_0x5377a0(0xe1e)](_0x55c209,null,0x2),_0x5d6ff6['focus']();}catch(_0xc63ae3){console[_0x5377a0(0x617)]('解析格式模板失败:',_0xc63ae3);}});}),_0x3aab95;}function _0x511fe1(){const _0x416675=_0x13d875;if(!_0x3d3f39)return;const _0x25e543=_0x3d3f39,_0x5452a4=_0x53d851[_0x416675(0xaa3)][_0x53d851[_0x416675(0x13be)]],_0x26f67f=_0x5452a4[_0x416675(0xe83)][_0x416675(0x397)](_0x44f120=>_0x44f120[_0x416675(0x827)]===_0x25e543);if(!_0x26f67f)return;_0x294f69();const _0x4595af=document[_0x416675(0x53a)](_0x416675(0x1030)),_0x5f50f4=document[_0x416675(0x53a)](_0x416675(0x682));_0x5f50f4[_0x416675(0xaac)]='';let _0x36cf31;if(_0x26f67f[_0x416675(0x6a2)]){const _0x43c602={'type':'quote_reply','target_timestamp':_0x26f67f[_0x416675(0x6a2)]['timestamp'],'reply_content':_0x26f67f[_0x416675(0x73e)]};_0x36cf31=JSON[_0x416675(0xe1e)](_0x43c602,null,0x2);}else{if(_0x26f67f['type']&&[_0x416675(0x64f),'ai_image',_0x416675(0x566),_0x416675(0x8c3),_0x416675(0x631)]['includes'](_0x26f67f[_0x416675(0x919)])){let _0x3db502={'type':_0x26f67f['type']};if(_0x26f67f[_0x416675(0x919)]==='voice_message')_0x3db502[_0x416675(0x73e)]=_0x26f67f[_0x416675(0x73e)];else{if(_0x26f67f['type']===_0x416675(0x2a5))_0x3db502[_0x416675(0xa60)]=_0x26f67f[_0x416675(0x73e)];else{if(_0x26f67f[_0x416675(0x919)]===_0x416675(0x566))_0x3db502[_0x416675(0x1146)]=_0x26f67f[_0x416675(0x1146)],_0x3db502[_0x416675(0xbb0)]=_0x26f67f[_0x416675(0xbb0)];else{if(_0x26f67f[_0x416675(0x919)]===_0x416675(0x8c3))_0x26f67f['content']?_0x3db502[_0x416675(0x73e)]=_0x26f67f[_0x416675(0x73e)]:(_0x3db502[_0x416675(0x1266)]=_0x26f67f[_0x416675(0x1266)],_0x3db502[_0x416675(0xa60)]=_0x26f67f[_0x416675(0xa60)]);else _0x26f67f[_0x416675(0x919)]===_0x416675(0x631)&&(_0x3db502['title']=_0x26f67f['title'],_0x3db502['description']=_0x26f67f[_0x416675(0xa60)],_0x3db502['source_name']=_0x26f67f['source_name'],_0x3db502['content']=_0x26f67f['content']);}}}_0x36cf31=JSON[_0x416675(0xe1e)](_0x3db502,null,0x2);}else typeof _0x26f67f['content']===_0x416675(0xc74)?_0x36cf31=JSON[_0x416675(0xe1e)](_0x26f67f[_0x416675(0x73e)],null,0x2):_0x36cf31=_0x26f67f['content'];}const _0x1f7aa5=_0x3e3f54(_0x36cf31);_0x5f50f4['appendChild'](_0x1f7aa5);const _0x4a366c=document[_0x416675(0x53a)]('add-message-editor-block-btn'),_0x8f771c=_0x4a366c['cloneNode'](!![]);_0x4a366c[_0x416675(0x9e8)][_0x416675(0xa1d)](_0x8f771c,_0x4a366c),_0x8f771c[_0x416675(0x1086)](_0x416675(0xb2b),()=>{const _0x40a79b=_0x416675,_0x430f85=_0x3e3f54();_0x5f50f4['appendChild'](_0x430f85),_0x430f85['querySelector'](_0x40a79b(0x728))[_0x40a79b(0x78d)]();});const _0x5312e5=document[_0x416675(0x53a)](_0x416675(0x109d)),_0x4fc52a=_0x5312e5[_0x416675(0x75a)](!![]);_0x5312e5[_0x416675(0x9e8)]['replaceChild'](_0x4fc52a,_0x5312e5),_0x4fc52a[_0x416675(0x1086)](_0x416675(0xb2b),()=>{const _0x557e53=_0x416675;_0x4595af[_0x557e53(0x1276)]['remove'](_0x557e53(0xaef));});const _0x216c16=document[_0x416675(0x53a)](_0x416675(0x3a8)),_0x50c75f=_0x216c16[_0x416675(0x75a)](!![]);_0x216c16[_0x416675(0x9e8)][_0x416675(0xa1d)](_0x50c75f,_0x216c16),_0x50c75f['addEventListener'](_0x416675(0xb2b),()=>{_0x3080c3(_0x25e543);}),_0x4595af['classList'][_0x416675(0xe13)]('visible');}async function _0x5caf6b(){const _0x3c00d3=_0x13d875;if(!_0x3d3f39)return;const _0x1be37e=_0x53d851[_0x3c00d3(0xaa3)][_0x53d851[_0x3c00d3(0x13be)]],_0x96581a=_0x1be37e[_0x3c00d3(0xe83)]['find'](_0x3ff7d8=>_0x3ff7d8[_0x3c00d3(0x827)]===_0x3d3f39);if(!_0x96581a)return;let _0xfb73b2;if(_0x96581a[_0x3c00d3(0x919)]===_0x3c00d3(0x8c3))_0x96581a['content']?_0xfb73b2=_0x96581a[_0x3c00d3(0x73e)]:_0xfb73b2='「'+(_0x96581a[_0x3c00d3(0x1266)]||'')+'」\x0a'+(_0x96581a[_0x3c00d3(0xa60)]||'');else typeof _0x96581a[_0x3c00d3(0x73e)]===_0x3c00d3(0xc74)?_0xfb73b2=JSON[_0x3c00d3(0xe1e)](_0x96581a[_0x3c00d3(0x73e)]):_0xfb73b2=String(_0x96581a[_0x3c00d3(0x73e)]);try{await navigator[_0x3c00d3(0x551)][_0x3c00d3(0xee3)](_0xfb73b2),await _0x184397(_0x3c00d3(0xe50),_0x3c00d3(0x9e9));}catch(_0x56013b){await _0x184397('复制失败',_0x3c00d3(0x12f5));}_0x294f69();}function _0x49155f(_0x23efb4){const _0x2a0ab0=_0x13d875,_0x58706e=_0x23efb4[_0x2a0ab0(0x13bc)]();if(_0x58706e['startsWith']('{')&&_0x58706e[_0x2a0ab0(0xc31)]('}'))try{const _0x19186f=JSON[_0x2a0ab0(0x367)](_0x58706e);if(_0x19186f[_0x2a0ab0(0x919)])return _0x19186f;}catch(_0x50c874){}if(_0x19cec7[_0x2a0ab0(0x7f2)](_0x58706e))return{'type':_0x2a0ab0(0x257),'content':_0x58706e};return{'type':_0x2a0ab0(0x2e6),'content':_0x58706e};}async function _0x3080c3(_0x40d329,_0x6ae4d=null){const _0x1e2483=_0x13d875;if(!_0x40d329)return;const _0x3feed2=_0x53d851[_0x1e2483(0xaa3)][_0x53d851['activeChatId']],_0x3af1b5=_0x3feed2[_0x1e2483(0xe83)][_0x1e2483(0x298)](_0x334885=>_0x334885[_0x1e2483(0x827)]===_0x40d329);if(_0x3af1b5===-0x1)return;const _0x2bedaa=_0x3feed2['history'][_0x3af1b5];let _0x2153df=[];const _0x1ad2ba=_0x6ae4d!==null?[_0x6ae4d]:Array[_0x1e2483(0xd97)](document[_0x1e2483(0xc3d)](_0x1e2483(0x113b)))[_0x1e2483(0xcb4)](_0x3e6fbb=>_0x3e6fbb[_0x1e2483(0x11a2)]);for(const _0x4a6f74 of _0x1ad2ba){if(!_0x4a6f74[_0x1e2483(0x13bc)]())continue;const _0xcce16f=_0x49155f(_0x4a6f74[_0x1e2483(0x13bc)]()),_0x17035c={'role':_0x2bedaa['role'],'senderName':_0x2bedaa[_0x1e2483(0xbee)],'timestamp':_0x2bedaa['timestamp']};switch(_0xcce16f['type']){case _0x1e2483(0x2e6):_0x17035c[_0x1e2483(0x919)]=_0x1e2483(0x2e6),_0x17035c['content']=_0xcce16f[_0x1e2483(0x73e)];break;case _0x1e2483(0x8c3):_0x17035c[_0x1e2483(0x919)]=_0x1e2483(0x8c3);_0xcce16f[_0x1e2483(0x73e)]?_0x17035c[_0x1e2483(0x73e)]=_0xcce16f[_0x1e2483(0x73e)]:(_0x17035c[_0x1e2483(0x1266)]=_0xcce16f[_0x1e2483(0x1266)],_0x17035c[_0x1e2483(0xa60)]=_0xcce16f['description']);break;case'quote_reply':_0x17035c[_0x1e2483(0x919)]=_0x1e2483(0x765),_0x17035c[_0x1e2483(0x73e)]=_0xcce16f[_0x1e2483(0xf88)];const _0x3ad0c2=_0x3feed2[_0x1e2483(0xe83)][_0x1e2483(0x397)](_0x4dfcdf=>_0x4dfcdf[_0x1e2483(0x827)]===_0xcce16f[_0x1e2483(0xfb5)]);if(_0x3ad0c2){let _0x2a5db4=_0x3ad0c2[_0x1e2483(0xbee)];_0x3ad0c2['role']===_0x1e2483(0x10ae)&&(_0x2a5db4=_0x53d851[_0x1e2483(0xa74)]['nickname']||_0x1e2483(0x8ac)),_0x17035c[_0x1e2483(0x6a2)]={'timestamp':_0xcce16f[_0x1e2483(0xfb5)],'senderName':_0x2a5db4,'content':String(_0x3ad0c2[_0x1e2483(0x73e)]||'')};}else _0x17035c[_0x1e2483(0x6a2)]={'timestamp':_0xcce16f['target_timestamp'],'senderName':_0x1e2483(0x126b),'content':_0x1e2483(0x588)};break;case _0x1e2483(0x64f):case _0x1e2483(0x2a5):case _0x1e2483(0x1053):_0x17035c[_0x1e2483(0x919)]=_0xcce16f[_0x1e2483(0x919)],_0x17035c['content']=_0xcce16f[_0x1e2483(0x73e)]||_0xcce16f[_0x1e2483(0xa60)];if(_0xcce16f[_0x1e2483(0x75f)])_0x17035c[_0x1e2483(0x75f)]=_0xcce16f[_0x1e2483(0x75f)];break;case _0x1e2483(0x257):{_0x17035c[_0x1e2483(0x919)]=_0x1e2483(0x257);let _0x19e5ec=![];if(_0xcce16f[_0x1e2483(0x75f)]){const _0x22102a=_0x53d851[_0x1e2483(0xf8f)][_0x1e2483(0x397)](_0x2ee58c=>_0x2ee58c[_0x1e2483(0x234)]===_0xcce16f[_0x1e2483(0x75f)]);_0x22102a?(_0x17035c[_0x1e2483(0x73e)]=_0x22102a[_0x1e2483(0xb36)],_0x17035c[_0x1e2483(0x75f)]=_0x22102a['name'],console[_0x1e2483(0x1081)]('导演/编辑模式保存(Sticker):\x20使用了\x20meaning\x20查找'),_0x19e5ec=!![]):(_0x17035c[_0x1e2483(0x919)]='text',_0x17035c['content']='[表情:\x20'+_0xcce16f[_0x1e2483(0x75f)]+']',console[_0x1e2483(0xad0)]('导演/编辑模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:',_0xcce16f['meaning']),_0x19e5ec=!![]);}if(!_0x19e5ec&&_0xcce16f['url']){_0x17035c[_0x1e2483(0x73e)]=_0xcce16f[_0x1e2483(0xb36)];const _0x2cfe0a=_0x53d851[_0x1e2483(0xf8f)][_0x1e2483(0x397)](_0x34f3db=>_0x34f3db[_0x1e2483(0xb36)]===_0xcce16f[_0x1e2483(0xb36)]);if(_0xcce16f['meaning']&&(!_0x2cfe0a||_0x2cfe0a['name']===_0xcce16f[_0x1e2483(0x75f)]))_0x17035c['meaning']=_0xcce16f[_0x1e2483(0x75f)];else _0x2cfe0a?_0x17035c[_0x1e2483(0x75f)]=_0x2cfe0a[_0x1e2483(0x234)]:_0x17035c['meaning']=_0x1e2483(0x8ad);console['log']('导演/编辑模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:',_0x17035c[_0x1e2483(0x75f)]),_0x19e5ec=!![];}if(!_0x19e5ec&&_0xcce16f[_0x1e2483(0x73e)]&&typeof _0xcce16f['content']===_0x1e2483(0xfc5)&&_0x19cec7[_0x1e2483(0x7f2)](_0xcce16f['content'])){_0x17035c[_0x1e2483(0x73e)]=_0xcce16f[_0x1e2483(0x73e)];const _0x24b564=_0x53d851['userStickers'][_0x1e2483(0x397)](_0xa629f2=>_0xa629f2[_0x1e2483(0xb36)]===_0xcce16f[_0x1e2483(0x73e)]);_0x17035c[_0x1e2483(0x75f)]=_0x24b564?_0x24b564[_0x1e2483(0x234)]:_0x1e2483(0x8ad),console[_0x1e2483(0x1081)](_0x1e2483(0x10b7),_0x17035c[_0x1e2483(0x75f)]),_0x19e5ec=!![];}if(!_0x19e5ec){console['error'](_0x1e2483(0x3ce),_0xcce16f);continue;}break;}case _0x1e2483(0x566):_0x17035c[_0x1e2483(0x919)]=_0x1e2483(0x566),_0x17035c[_0x1e2483(0x1146)]=_0xcce16f[_0x1e2483(0x1146)],_0x17035c[_0x1e2483(0xbb0)]=_0xcce16f[_0x1e2483(0xbb0)];break;case'share_link':_0x17035c['type']=_0x1e2483(0x631),_0x17035c[_0x1e2483(0x667)]=_0xcce16f['title'],_0x17035c[_0x1e2483(0xa60)]=_0xcce16f['description'],_0x17035c[_0x1e2483(0x8a1)]=_0xcce16f['source_name'],_0x17035c['content']=_0xcce16f['content'];break;default:Object['assign'](_0x17035c,_0xcce16f);break;}_0x2153df[_0x1e2483(0x7dd)](_0x17035c);}if(_0x2153df[_0x1e2483(0x29d)]===0x0){document[_0x1e2483(0x53a)](_0x1e2483(0x1030))['classList'][_0x1e2483(0x2d4)](_0x1e2483(0xaef));return;}_0x3feed2['history'][_0x1e2483(0x1331)](_0x3af1b5,0x1,..._0x2153df);let _0x2900b9=_0x40d329;for(let _0x3392cb=_0x3af1b5;_0x3392cb<_0x3feed2[_0x1e2483(0xe83)][_0x1e2483(0x29d)];_0x3392cb++){_0x3feed2[_0x1e2483(0xe83)][_0x3392cb][_0x1e2483(0x827)]=_0x2900b9,_0x2900b9++;}await _0xa62efb[_0x1e2483(0xaa3)][_0x1e2483(0x546)](_0x3feed2),document[_0x1e2483(0x53a)](_0x1e2483(0x1030))[_0x1e2483(0x1276)][_0x1e2483(0x2d4)](_0x1e2483(0xaef)),_0x60f53f(_0x53d851[_0x1e2483(0x13be)]),await _0x184397('成功',_0x1e2483(0xf1a));}function _0x328745(_0x302372){const _0x115728=_0x13d875;_0x418a9e=_0x302372,document[_0x115728(0x53a)]('post-actions-modal')['classList']['add'](_0x115728(0xaef));}function _0x20806a(){const _0x5783da=_0x13d875;document['getElementById'](_0x5783da(0x5e7))[_0x5783da(0x1276)]['remove'](_0x5783da(0xaef)),_0x418a9e=null;}async function _0x4bc790(){const _0x5298d9=_0x13d875;if(!_0x418a9e)return;const _0x5a547=_0x418a9e,_0x297706=await _0xa62efb[_0x5298d9(0xfc2)][_0x5298d9(0x883)](_0x5a547);if(!_0x297706)return;_0x20806a();let _0x394299;if(_0x297706['type']===_0x5298d9(0x12c5))_0x394299=_0x297706[_0x5298d9(0x73e)];else{const _0x299817={'type':_0x297706[_0x5298d9(0x919)],'publicText':_0x297706[_0x5298d9(0x678)]||''};if(_0x297706[_0x5298d9(0x919)]===_0x5298d9(0x1242))_0x299817[_0x5298d9(0x97a)]=_0x297706[_0x5298d9(0x97a)],_0x299817[_0x5298d9(0x465)]=_0x297706['imageDescription'];else _0x297706['type']===_0x5298d9(0xa9a)&&(_0x299817['hiddenContent']=_0x297706[_0x5298d9(0x319)]);_0x394299=JSON['stringify'](_0x299817,null,0x2);}const _0x42e4c8={'shuoshuo':_0x5298d9(0x567),'image':{'type':'image_post','publicText':'','imageUrl':_0x5298d9(0x52a),'imageDescription':''},'text_image':{'type':_0x5298d9(0xa9a),'publicText':'','hiddenContent':''}},_0xebd339=_0x5298d9(0xe62)+JSON['stringify'](_0x42e4c8[_0x5298d9(0xace)])+_0x5298d9(0xb3a)+JSON[_0x5298d9(0xe1e)](_0x42e4c8[_0x5298d9(0xa9a)])+_0x5298d9(0xb34),_0x54e824=await _0x4f6537(_0x5298d9(0xbb8),_0x5298d9(0x87b),_0x394299,_0x5298d9(0x728),_0xebd339);setTimeout(()=>{const _0x591785=_0x5298d9,_0x1abe09=document['querySelector'](_0x591785(0x39a));_0x1abe09&&_0x1abe09[_0x591785(0x1086)](_0x591785(0xb2b),()=>{const _0x43d233=_0x591785,_0x40780f=document['getElementById'](_0x43d233(0xe15));_0x40780f['value']=_0x42e4c8[_0x43d233(0x12c5)],_0x40780f[_0x43d233(0x78d)]();});},0x64),_0x54e824!==null&&await _0x37866e(_0x5a547,_0x54e824);}async function _0x37866e(_0x2e3b10,_0x1f3c15){const _0x287d24=_0x13d875,_0x3556bd=await _0xa62efb[_0x287d24(0xfc2)][_0x287d24(0x883)](_0x2e3b10);if(!_0x3556bd)return;const _0x39ebde=_0x1f3c15[_0x287d24(0x13bc)]();try{const _0x3949f4=JSON[_0x287d24(0x367)](_0x39ebde);_0x3556bd[_0x287d24(0x919)]=_0x3949f4[_0x287d24(0x919)]||_0x287d24(0x1242),_0x3556bd['publicText']=_0x3949f4[_0x287d24(0x678)]||'',_0x3556bd['imageUrl']=_0x3949f4[_0x287d24(0x97a)]||'',_0x3556bd['imageDescription']=_0x3949f4[_0x287d24(0x465)]||'',_0x3556bd[_0x287d24(0x319)]=_0x3949f4[_0x287d24(0x319)]||'',_0x3556bd[_0x287d24(0x73e)]='';}catch(_0x2daea5){_0x3556bd[_0x287d24(0x919)]=_0x287d24(0x12c5),_0x3556bd[_0x287d24(0x73e)]=_0x39ebde,_0x3556bd['publicText']='',_0x3556bd[_0x287d24(0x97a)]='',_0x3556bd[_0x287d24(0x465)]='',_0x3556bd[_0x287d24(0x319)]='';}await _0xa62efb[_0x287d24(0xfc2)]['put'](_0x3556bd),await _0x3679f3(),await _0x184397('成功',_0x287d24(0x102e));}async function _0x19fbe8(){const _0x405285=_0x13d875;if(!_0x418a9e)return;const _0x3e11d8=await _0xa62efb['qzonePosts'][_0x405285(0x883)](_0x418a9e);if(!_0x3e11d8)return;let _0x49d2a7=_0x3e11d8[_0x405285(0x73e)]||_0x3e11d8[_0x405285(0x678)]||_0x3e11d8[_0x405285(0x319)]||_0x3e11d8['imageDescription']||_0x405285(0xc83);try{await navigator[_0x405285(0x551)][_0x405285(0xee3)](_0x49d2a7),await _0x184397('复制成功',_0x405285(0xcf5));}catch(_0x2b1271){await _0x184397(_0x405285(0xf0e),'无法访问剪贴板。');}_0x20806a();}let _0x3da78a=new Set();async function _0x3b3d18(){const _0x362537=_0x13d875,_0x3aefe0=await _0x34ea2c(_0x362537(0x142b),[{'text':_0x362537(0x12e4),'value':_0x362537(0x109f)},{'text':_0x362537(0x528),'value':'spectator'}]);if(_0x3aefe0===_0x362537(0x109f)){_0x3da78a[_0x362537(0xfcf)]();const _0x261946=document[_0x362537(0x53a)](_0x362537(0x73a)),_0x6a65e8=_0x261946[_0x362537(0x75a)](!![]);_0x261946[_0x362537(0x9e8)][_0x362537(0xa1d)](_0x6a65e8,_0x261946),_0x6a65e8[_0x362537(0x1086)](_0x362537(0xb2b),_0x21a078),await _0x20917c(),_0x541a81(_0x362537(0x1122));}else _0x3aefe0==='spectator'&&_0x52c55c();}async function _0x52c55c(){const _0x1ff233=_0x13d875;_0x3da78a[_0x1ff233(0xfcf)]();const _0x470e50=document[_0x1ff233(0x53a)](_0x1ff233(0x73a)),_0x82fc67=_0x470e50[_0x1ff233(0x75a)](!![]);_0x470e50[_0x1ff233(0x9e8)]['replaceChild'](_0x82fc67,_0x470e50),_0x82fc67[_0x1ff233(0x1086)](_0x1ff233(0xb2b),_0x12900d),await _0x16e4cf(),_0x541a81(_0x1ff233(0x1122));}async function _0x16e4cf(){const _0x47d6c0=_0x13d875,_0xe521a4=document[_0x47d6c0(0x53a)](_0x47d6c0(0xbc1));_0xe521a4[_0x47d6c0(0xaac)]='';const _0x3afd81=Object[_0x47d6c0(0x244)](_0x53d851[_0x47d6c0(0xaa3)])[_0x47d6c0(0x2dd)](_0x3a2181=>!_0x3a2181[_0x47d6c0(0x86e)]),_0x29070e=await _0xa62efb['npcs'][_0x47d6c0(0xa73)]();if(_0x3afd81[_0x47d6c0(0x29d)]===0x0&&_0x29070e[_0x47d6c0(0x29d)]===0x0){_0xe521a4[_0x47d6c0(0xaac)]=_0x47d6c0(0x6b8);return;}_0x3afd81[_0x47d6c0(0xeaf)](_0x477ca4=>{const _0x1ded4d=_0x47d6c0,_0x3b6bd9=document[_0x1ded4d(0xd67)]('div');_0x3b6bd9['className']=_0x1ded4d(0xa94),_0x3b6bd9[_0x1ded4d(0x999)][_0x1ded4d(0xce7)]=_0x477ca4['id'],_0x3b6bd9[_0x1ded4d(0xaac)]=_0x1ded4d(0x968)+(_0x477ca4[_0x1ded4d(0x81e)][_0x1ded4d(0x9e3)]||_0x5d06c0)+_0x1ded4d(0x63a)+_0x477ca4[_0x1ded4d(0x234)]+_0x1ded4d(0x1450),_0xe521a4[_0x1ded4d(0x133d)](_0x3b6bd9);}),_0x29070e[_0x47d6c0(0xeaf)](_0x43af07=>{const _0x4e1b4e=_0x47d6c0,_0x3d9127=document[_0x4e1b4e(0xd67)](_0x4e1b4e(0x1425));_0x3d9127[_0x4e1b4e(0x6de)]=_0x4e1b4e(0xa94),_0x3d9127['dataset'][_0x4e1b4e(0xce7)]=_0x43af07['id'],_0x3d9127['dataset'][_0x4e1b4e(0x410)]=_0x4e1b4e(0x10cf),_0x3d9127['innerHTML']=_0x4e1b4e(0x968)+(_0x43af07[_0x4e1b4e(0x8cd)]||_0x434592)+_0x4e1b4e(0x63a)+_0x43af07[_0x4e1b4e(0x234)]+_0x4e1b4e(0xdb5),_0xe521a4['appendChild'](_0x3d9127);}),_0x2eaf02();}async function _0x12900d(){const _0x58ddfb=_0x13d875;if(_0x3da78a[_0x58ddfb(0x38e)]<0x2){alert(_0x58ddfb(0x8f0));return;}const _0x86b51a=await _0x4f6537(_0x58ddfb(0x12eb),_0x58ddfb(0xe1d),'AI们的茶话会');if(!_0x86b51a||!_0x86b51a['trim']())return;const _0x57eadc=_0x58ddfb(0xca2)+Date[_0x58ddfb(0x9c1)](),_0x4e071d=[],_0x1ce692=await _0xa62efb[_0x58ddfb(0x5b7)][_0x58ddfb(0xa73)]();for(const _0x10f99f of _0x3da78a){const _0x2b13b9=document[_0x58ddfb(0x139c)](_0x58ddfb(0x110c)+_0x10f99f+'\x22]')[_0x58ddfb(0x999)]['isNpc']==='true';if(_0x2b13b9){const _0x4ae0ee=_0x1ce692[_0x58ddfb(0x397)](_0x1d336a=>_0x1d336a['id']===parseInt(_0x10f99f));_0x4ae0ee&&_0x4e071d[_0x58ddfb(0x7dd)]({'id':'npc_'+_0x4ae0ee['id'],'originalName':_0x4ae0ee['name'],'groupNickname':_0x4ae0ee[_0x58ddfb(0x234)],'persona':_0x4ae0ee['persona'],'avatar':_0x4ae0ee[_0x58ddfb(0x8cd)]||_0x434592,'isNpc':!![]});}else{const _0x51834f=_0x53d851['chats'][_0x10f99f];_0x51834f&&_0x4e071d[_0x58ddfb(0x7dd)]({'id':_0x10f99f,'originalName':_0x51834f[_0x58ddfb(0x543)],'groupNickname':_0x51834f[_0x58ddfb(0x234)],'persona':_0x51834f[_0x58ddfb(0x81e)][_0x58ddfb(0x1216)],'avatar':_0x51834f[_0x58ddfb(0x81e)][_0x58ddfb(0x9e3)]||_0x5d06c0,'isNpc':![]});}}const _0x3784c4={'id':_0x57eadc,'name':_0x86b51a[_0x58ddfb(0x13bc)](),'isGroup':!![],'isSpectatorGroup':!![],'members':_0x4e071d,'settings':{'maxMemory':0xa,'groupAvatar':_0x29ae5b,'background':'','theme':_0x58ddfb(0xce2),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[{'role':_0x58ddfb(0xab3),'content':'[系统指令：这是一个没有用户参与的群聊，请你们根据各自的人设自由地开始对话。]','timestamp':Date[_0x58ddfb(0x9c1)](),'isHidden':!![]}],'musicData':{'totalTime':0x0}};_0x53d851[_0x58ddfb(0xaa3)][_0x57eadc]=_0x3784c4,await _0xa62efb[_0x58ddfb(0xaa3)][_0x58ddfb(0x546)](_0x3784c4),await _0x5001a4(),_0x541a81(_0x58ddfb(0xbca)),_0x1e3a7c(_0x57eadc);}async function _0x20917c(){const _0x2415a3=_0x13d875,_0x5b36b9=document[_0x2415a3(0x53a)](_0x2415a3(0xbc1));_0x5b36b9[_0x2415a3(0xaac)]='';const _0x1584dc=Object[_0x2415a3(0x244)](_0x53d851[_0x2415a3(0xaa3)])[_0x2415a3(0x2dd)](_0x1729f5=>!_0x1729f5[_0x2415a3(0x86e)]),_0xe9d257=await _0xa62efb[_0x2415a3(0x5b7)]['toArray']();if(_0x1584dc[_0x2415a3(0x29d)]===0x0&&_0xe9d257[_0x2415a3(0x29d)]===0x0){_0x5b36b9[_0x2415a3(0xaac)]=_0x2415a3(0x1370);return;}_0x1584dc[_0x2415a3(0xeaf)](_0x5cb869=>{const _0x491915=_0x2415a3,_0x24b6af=document[_0x491915(0xd67)](_0x491915(0x1425));_0x24b6af[_0x491915(0x6de)]=_0x491915(0xa94),_0x24b6af['dataset'][_0x491915(0xce7)]=_0x5cb869['id'],_0x24b6af['innerHTML']=_0x491915(0x968)+(_0x5cb869[_0x491915(0x81e)][_0x491915(0x9e3)]||_0x5d06c0)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x5cb869[_0x491915(0x234)]+'\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x5b36b9['appendChild'](_0x24b6af);}),_0xe9d257['forEach'](_0x26a9c7=>{const _0x579217=_0x2415a3,_0x3aba44=document['createElement']('div');_0x3aba44['className']=_0x579217(0xa94),_0x3aba44[_0x579217(0x999)][_0x579217(0xce7)]=_0x579217(0xc78)+_0x26a9c7['id'],_0x3aba44[_0x579217(0xaac)]=_0x579217(0x968)+(_0x26a9c7['avatar']||_0x434592)+_0x579217(0x63a)+_0x26a9c7[_0x579217(0x234)]+_0x579217(0xdb5),_0x5b36b9[_0x579217(0x133d)](_0x3aba44);}),_0x2eaf02();}function _0x2eaf02(){const _0x239e27=_0x13d875,_0xf1a543=document[_0x239e27(0x53a)](_0x239e27(0x73a));_0xf1a543[_0x239e27(0x34a)]=_0x239e27(0x7f4)+_0x3da78a[_0x239e27(0x38e)]+')',_0xf1a543[_0x239e27(0xb77)]=_0x3da78a[_0x239e27(0x38e)]<0x2;}async function _0x21a078(){const _0x7fd143=_0x13d875;if(_0x3da78a['size']<0x2){alert(_0x7fd143(0x417));return;}const _0x509b5f=await _0x4f6537(_0x7fd143(0x12eb),'请输入群聊的名字','我们的群聊');if(!_0x509b5f||!_0x509b5f[_0x7fd143(0x13bc)]())return;const _0x291638=_0x7fd143(0xca2)+Date['now'](),_0x4f0a8e=[],_0x414056=await _0xa62efb[_0x7fd143(0x5b7)][_0x7fd143(0xa73)]();for(const _0x1f22ae of _0x3da78a){if(_0x1f22ae[_0x7fd143(0x1200)](_0x7fd143(0xc78))){const _0x1a6add=parseInt(_0x1f22ae[_0x7fd143(0x795)](_0x7fd143(0xc78),'')),_0x4914a0=_0x414056[_0x7fd143(0x397)](_0x218056=>_0x218056['id']===_0x1a6add);_0x4914a0&&_0x4f0a8e[_0x7fd143(0x7dd)]({'id':_0x1f22ae,'originalName':_0x4914a0[_0x7fd143(0x234)],'groupNickname':_0x4914a0[_0x7fd143(0x234)],'persona':_0x4914a0[_0x7fd143(0x11fb)],'avatar':_0x4914a0[_0x7fd143(0x8cd)]||_0x434592,'isNpc':!![]});}else{const _0x762655=_0x53d851[_0x7fd143(0xaa3)][_0x1f22ae];_0x762655&&_0x4f0a8e[_0x7fd143(0x7dd)]({'id':_0x1f22ae,'originalName':_0x762655['originalName'],'groupNickname':_0x762655['name'],'persona':_0x762655[_0x7fd143(0x81e)]['aiPersona'],'avatar':_0x762655[_0x7fd143(0x81e)][_0x7fd143(0x9e3)]||_0x5d06c0,'isNpc':![]});}}const _0x18197c={'id':_0x291638,'name':_0x509b5f[_0x7fd143(0x13bc)](),'isGroup':!![],'members':_0x4f0a8e,'settings':{'myPersona':'我是谁呀。','myNickname':'我','maxMemory':0xa,'groupAvatar':_0x29ae5b,'myAvatar':_0x132d11,'background':'','theme':_0x7fd143(0xce2),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[],'musicData':{'totalTime':0x0}};_0x53d851[_0x7fd143(0xaa3)][_0x291638]=_0x18197c,await _0xa62efb[_0x7fd143(0xaa3)]['put'](_0x18197c),await _0x5001a4(),_0x541a81(_0x7fd143(0xbca)),_0x1e3a7c(_0x291638);}function _0x447e82(){const _0x31f19b=_0x13d875;if(!_0x53d851['activeChatId']||!_0x53d851[_0x31f19b(0xaa3)][_0x53d851['activeChatId']]['isGroup'])return;_0xb5cb9f(),_0x541a81(_0x31f19b(0x321));}function _0xb5cb9f(){const _0x869533=_0x13d875,_0x2dcb9f=document[_0x869533(0x53a)](_0x869533(0xc97)),_0x1f87ed=_0x53d851['chats'][_0x53d851[_0x869533(0x13be)]];_0x2dcb9f[_0x869533(0xaac)]='',_0x1f87ed['members'][_0x869533(0xeaf)](_0x3f7c88=>{const _0x3d906d=_0x869533,_0x63d9b1=document[_0x3d906d(0xd67)](_0x3d906d(0x1425));_0x63d9b1[_0x3d906d(0x6de)]=_0x3d906d(0x2de),_0x63d9b1[_0x3d906d(0xaac)]=_0x3d906d(0x36f)+_0x3f7c88[_0x3d906d(0x8cd)]+_0x3d906d(0x8c8)+_0x3f7c88[_0x3d906d(0x12bc)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-member-btn\x22\x20data-member-id=\x22'+_0x3f7c88['id']+_0x3d906d(0x122b),_0x2dcb9f[_0x3d906d(0x133d)](_0x63d9b1);});}async function _0x435b16(_0x44135d){const _0x2d3a4a=_0x13d875,_0x17b0c3=_0x53d851[_0x2d3a4a(0xaa3)][_0x53d851['activeChatId']],_0x55b268=_0x17b0c3[_0x2d3a4a(0x3de)][_0x2d3a4a(0x298)](_0x2edd50=>_0x2edd50['id']===_0x44135d);if(_0x55b268===-0x1)return;if(_0x17b0c3['members'][_0x2d3a4a(0x29d)]<=0x2){alert(_0x2d3a4a(0x1261));return;}const _0x543e3e=_0x17b0c3['members'][_0x55b268][_0x2d3a4a(0x12bc)],_0x2fda98=await _0x355fc0(_0x2d3a4a(0x9d2),_0x2d3a4a(0xb6e)+_0x543e3e+'”移出群聊吗？',{'confirmButtonClass':_0x2d3a4a(0x264)});_0x2fda98&&(_0x17b0c3['members']['splice'](_0x55b268,0x1),await _0xa62efb[_0x2d3a4a(0xaa3)]['put'](_0x17b0c3),_0xb5cb9f(),document['getElementById'](_0x2d3a4a(0x460))['click']());}async function _0x58b6b0(){const _0xf3d1c=_0x13d875,_0x21fa9b=document[_0xf3d1c(0x53a)](_0xf3d1c(0x73a)),_0x1c6097=_0x21fa9b[_0xf3d1c(0x75a)](!![]);_0x21fa9b[_0xf3d1c(0x9e8)][_0xf3d1c(0xa1d)](_0x1c6097,_0x21fa9b),_0x1c6097[_0xf3d1c(0x1086)](_0xf3d1c(0xb2b),_0x341252),await _0x491a6(),_0x541a81(_0xf3d1c(0x1122));}async function _0x491a6(){const _0x1e3c26=_0x13d875,_0x5aeec3=document[_0x1e3c26(0x53a)](_0x1e3c26(0xbc1));_0x5aeec3[_0x1e3c26(0xaac)]='',_0x3da78a[_0x1e3c26(0xfcf)]();const _0x3f7b71=_0x53d851[_0x1e3c26(0xaa3)][_0x53d851[_0x1e3c26(0x13be)]],_0x153476=new Set(_0x3f7b71['members'][_0x1e3c26(0xcb4)](_0x474857=>_0x474857['id'])),_0x346d3c=Object['values'](_0x53d851[_0x1e3c26(0xaa3)])[_0x1e3c26(0x2dd)](_0x170030=>!_0x170030[_0x1e3c26(0x86e)]&&!_0x153476['has'](_0x170030['id'])),_0x1c7678=(await _0xa62efb[_0x1e3c26(0x5b7)][_0x1e3c26(0xa73)]())[_0x1e3c26(0x2dd)](_0x2f6dbc=>!_0x153476['has']('npc_'+_0x2f6dbc['id']));_0x346d3c[_0x1e3c26(0x29d)]===0x0&&_0x1c7678[_0x1e3c26(0x29d)]===0x0?(_0x5aeec3['innerHTML']=_0x1e3c26(0xe0c),document[_0x1e3c26(0x53a)](_0x1e3c26(0x73a))[_0x1e3c26(0x1284)]['display']='none'):(document[_0x1e3c26(0x53a)](_0x1e3c26(0x73a))[_0x1e3c26(0x1284)][_0x1e3c26(0x11d9)]=_0x1e3c26(0x1ea),_0x346d3c[_0x1e3c26(0xeaf)](_0x3df887=>{const _0x120b3e=_0x1e3c26,_0x4547c0=document[_0x120b3e(0xd67)](_0x120b3e(0x1425));_0x4547c0['className']=_0x120b3e(0xa94),_0x4547c0[_0x120b3e(0x999)][_0x120b3e(0xce7)]=_0x3df887['id'],_0x4547c0[_0x120b3e(0x999)][_0x120b3e(0x1240)]=_0x120b3e(0xde1),_0x4547c0[_0x120b3e(0xaac)]=_0x120b3e(0xe25)+(_0x3df887[_0x120b3e(0x81e)][_0x120b3e(0x9e3)]||_0x5d06c0)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x3df887[_0x120b3e(0x234)]+'\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x5aeec3[_0x120b3e(0x133d)](_0x4547c0);}),_0x1c7678[_0x1e3c26(0xeaf)](_0x12b57a=>{const _0x4c56de=_0x1e3c26,_0x181ae1=document[_0x4c56de(0xd67)](_0x4c56de(0x1425));_0x181ae1[_0x4c56de(0x6de)]=_0x4c56de(0xa94),_0x181ae1['dataset']['contactId']='npc_'+_0x12b57a['id'],_0x181ae1[_0x4c56de(0x999)][_0x4c56de(0x1240)]=_0x4c56de(0x57d),_0x181ae1['dataset'][_0x4c56de(0x1007)]=_0x12b57a['id'],_0x181ae1[_0x4c56de(0xaac)]=_0x4c56de(0xe25)+(_0x12b57a[_0x4c56de(0x8cd)]||_0x434592)+_0x4c56de(0xa5f)+_0x12b57a['name']+_0x4c56de(0x13f5),_0x5aeec3['appendChild'](_0x181ae1);})),_0x2eaf02();}async function _0x341252(){const _0x165932=_0x13d875;if(_0x3da78a[_0x165932(0x38e)]===0x0){alert(_0x165932(0x7ee));return;}const _0x28cb03=_0x53d851['chats'][_0x53d851[_0x165932(0x13be)]],_0x288879=await _0xa62efb[_0x165932(0x5b7)][_0x165932(0xa73)]();for(const _0x513e5c of _0x3da78a){const _0x566ccd=document[_0x165932(0x139c)](_0x165932(0x110c)+_0x513e5c+'\x22]');if(!_0x566ccd)continue;const _0x490bd9=_0x566ccd[_0x165932(0x999)][_0x165932(0x1240)];if(_0x490bd9===_0x165932(0xde1)){const _0x29b6cf=_0x53d851[_0x165932(0xaa3)][_0x513e5c];_0x29b6cf&&_0x28cb03[_0x165932(0x3de)][_0x165932(0x7dd)]({'id':_0x513e5c,'originalName':_0x29b6cf[_0x165932(0x543)],'groupNickname':_0x29b6cf['name'],'persona':_0x29b6cf['settings'][_0x165932(0x1216)],'avatar':_0x29b6cf[_0x165932(0x81e)][_0x165932(0x9e3)]||_0x5d06c0,'isNpc':![]});}else{if(_0x490bd9===_0x165932(0x57d)){const _0x25e7af=parseInt(_0x566ccd[_0x165932(0x999)][_0x165932(0x1007)]),_0x70bc1c=_0x288879[_0x165932(0x397)](_0x46c501=>_0x46c501['id']===_0x25e7af);_0x70bc1c&&_0x28cb03['members']['push']({'id':_0x165932(0xc78)+_0x25e7af,'originalName':_0x70bc1c['name'],'groupNickname':_0x70bc1c[_0x165932(0x234)],'persona':_0x70bc1c[_0x165932(0x11fb)],'avatar':_0x70bc1c[_0x165932(0x8cd)]||_0x434592,'isNpc':!![]});}}}await _0xa62efb[_0x165932(0xaa3)][_0x165932(0x546)](_0x28cb03),_0x447e82();}function _0x2b2043(){_0x2f91e5=!![],_0x25fd0e(null);}function _0x52f4c8(_0x40ddfc,_0x2bbc46){const _0x2a1315=setInterval(()=>{const _0x230a26=_0x55b8,_0xa18cbf=Date[_0x230a26(0x9c1)](),_0x3579fc=_0x2bbc46-_0xa18cbf;if(_0x3579fc<0x0){clearInterval(_0x2a1315),_0x40ddfc['innerHTML']='<span>已</span><span>超</span><span>时</span>';return;}const _0xb8837b=Math[_0x230a26(0x7d5)](_0x3579fc%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x247ef3=Math['floor'](_0x3579fc%(0x3e8*0x3c)/0x3e8),_0x2e5194=String(_0xb8837b)[_0x230a26(0x117e)](0x2,'0'),_0x1fd79e=String(_0x247ef3)[_0x230a26(0x117e)](0x2,'0');_0x40ddfc['innerHTML']=_0x230a26(0x7b1)+_0x2e5194[_0x230a26(0xee7)](0x0)+_0x230a26(0xe8b)+_0x2e5194[_0x230a26(0xee7)](0x1)+'</span>\x20:\x20<span>'+_0x1fd79e[_0x230a26(0xee7)](0x0)+_0x230a26(0xe8b)+_0x1fd79e['charAt'](0x1)+_0x230a26(0xbec);},0x3e8);return _0x2a1315;}function _0x3db1bf(){for(const _0x31de71 in _0x3faa3e){clearInterval(_0x3faa3e[_0x31de71]);}_0x3faa3e={};}async function _0x3f4e63(_0x16acf9){const _0x1f2636=_0x13d875,_0x482712=_0x53d851[_0x1f2636(0xaa3)][_0x53d851[_0x1f2636(0x13be)]];if(!_0x482712)return;const _0x4325e5=_0x482712['history'][_0x1f2636(0x397)](_0x51b035=>_0x51b035['timestamp']===_0x16acf9);if(!_0x4325e5||![_0x1f2636(0x1206),_0x1f2636(0x907)][_0x1f2636(0x6e9)](_0x4325e5[_0x1f2636(0x919)])){console[_0x1f2636(0x617)]('showWaimaiDetails:\x20找不到消息或消息类型不正确',_0x16acf9);return;}let _0x1d915d='';if(_0x4325e5['type']===_0x1f2636(0x1206)){let _0x53f194;switch(_0x4325e5[_0x1f2636(0x12d3)]){case _0x1f2636(0x2ea):const _0x40e706=_0x4325e5['paidBy']||'对方',_0x25db42=_0xf33fb2(_0x482712,_0x40e706);_0x53f194='由\x20'+_0x25db42+_0x1f2636(0xf13);break;case'rejected':_0x53f194=_0x1f2636(0x1225);break;default:_0x53f194=_0x1f2636(0xae1);break;}_0x1d915d=_0x1f2636(0x142a)+_0x4325e5[_0x1f2636(0x13ce)]+_0x1f2636(0xf36)+Number(_0x4325e5['amount'])[_0x1f2636(0x39e)](0x2)+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>状态:</strong>\x20'+_0x53f194+_0x1f2636(0x13c3);}else{if(_0x4325e5[_0x1f2636(0x919)]===_0x1f2636(0x907)){let _0x465245,_0x1ba836;_0x482712['isGroup']?(_0x465245=_0xf33fb2(_0x482712,_0x4325e5['senderName']),_0x1ba836=_0xf33fb2(_0x482712,_0x4325e5[_0x1f2636(0x283)])):_0x4325e5[_0x1f2636(0xb4d)]===_0x1f2636(0x10ae)?(_0x465245=_0x482712[_0x1f2636(0x81e)][_0x1f2636(0x1303)]||'我',_0x1ba836=_0x482712[_0x1f2636(0x234)]):(_0x465245=_0x482712[_0x1f2636(0x234)],_0x1ba836=_0x482712[_0x1f2636(0x81e)][_0x1f2636(0x1303)]||'我'),_0x1d915d=_0x1f2636(0xf78)+_0x465245+_0x1f2636(0xd64)+_0x1ba836+_0x1f2636(0x1270)+_0x4325e5[_0x1f2636(0x13ce)]+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥'+Number(_0x4325e5[_0x1f2636(0x1146)])[_0x1f2636(0x39e)](0x2)+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}}await _0x184397(_0x1f2636(0x231),_0x1d915d);}async function _0x3d09cb(_0x19fa6d,_0x5f20a6){const _0x142db8=_0x13d875,_0x1de0e4=_0x53d851[_0x142db8(0xaa3)][_0x53d851[_0x142db8(0x13be)]];if(!_0x1de0e4)return;const _0x29e1cd=_0x1de0e4[_0x142db8(0xe83)]['findIndex'](_0x54cb6c=>_0x54cb6c[_0x142db8(0x827)]===_0x19fa6d);if(_0x29e1cd===-0x1)return;const _0x93ab7f=_0x1de0e4[_0x142db8(0xe83)][_0x29e1cd];_0x93ab7f[_0x142db8(0x12d3)]=_0x5f20a6;let _0x5f1cfc;const _0x525635=_0x1de0e4[_0x142db8(0x86e)]?_0x1de0e4[_0x142db8(0x81e)][_0x142db8(0x1303)]||'我':'我';_0x5f20a6===_0x142db8(0x2ea)?(_0x93ab7f['paidBy']=_0x525635,_0x5f1cfc=_0x142db8(0xf5b)+_0x525635+_0x142db8(0x20b)+_0x93ab7f['senderName']+_0x142db8(0x429)+_0x19fa6d+_0x142db8(0x131f)):_0x5f1cfc=_0x142db8(0xf5b)+_0x525635+_0x142db8(0xe80)+_0x93ab7f['senderName']+_0x142db8(0x988)+_0x19fa6d+_0x142db8(0x12a0);const _0x142066={'role':_0x142db8(0xab3),'content':_0x5f1cfc,'timestamp':Date[_0x142db8(0x9c1)](),'isHidden':!![]};_0x1de0e4['history'][_0x142db8(0x7dd)](_0x142066),await _0xa62efb[_0x142db8(0xaa3)]['put'](_0x1de0e4),_0x60f53f(_0x53d851[_0x142db8(0x13be)]);}let _0x58a059={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x436354=null;async function _0x19f550(){const _0x504a70=_0x13d875;if(!_0x53d851['activeChatId']||_0x58a059[_0x504a70(0x975)]||_0x58a059[_0x504a70(0xf9b)])return;const _0x17cfdd=_0x53d851[_0x504a70(0xaa3)][_0x53d851['activeChatId']];_0x58a059[_0x504a70(0x732)]=_0x17cfdd['isGroup'],_0x58a059[_0x504a70(0xf9b)]=!![],_0x58a059[_0x504a70(0xf71)]=_0x504a70(0x10ae),_0x58a059['activeChatId']=_0x17cfdd['id'],_0x58a059[_0x504a70(0x1402)]=!![];_0x17cfdd[_0x504a70(0x86e)]?(document[_0x504a70(0x53a)]('outgoing-call-avatar')[_0x504a70(0x7ff)]=_0x17cfdd['settings'][_0x504a70(0x971)]||_0x132d11,document[_0x504a70(0x53a)]('outgoing-call-name')[_0x504a70(0x34a)]=_0x17cfdd[_0x504a70(0x81e)][_0x504a70(0x1303)]||'我'):(document[_0x504a70(0x53a)](_0x504a70(0xdbd))[_0x504a70(0x7ff)]=_0x17cfdd['settings']['aiAvatar']||_0x5d06c0,document[_0x504a70(0x53a)](_0x504a70(0x270))[_0x504a70(0x34a)]=_0x17cfdd[_0x504a70(0x234)]);document[_0x504a70(0x139c)](_0x504a70(0x1168))['textContent']=_0x17cfdd[_0x504a70(0x86e)]?_0x504a70(0x9cc):_0x504a70(0xb21),_0x541a81(_0x504a70(0x389));const _0x24823f={'role':_0x504a70(0xab3),'content':_0x17cfdd['isGroup']?'[系统提示：用户\x20('+(_0x17cfdd[_0x504a70(0x81e)][_0x504a70(0x1303)]||'我')+')\x20发起了群视频通话请求。请你们各自决策，并使用\x20\x22group_call_response\x22\x20指令，设置\x20\x22decision\x22\x20为\x20\x22join\x22\x20或\x20\x22decline\x22\x20来回应。]':'[系统提示：用户向你发起了视频通话请求。请根据你的人设，使用\x20\x22video_call_response\x22\x20指令，并设置\x20\x22decision\x22\x20为\x20\x22accept\x22\x20或\x20\x22reject\x22\x20来回应。]','timestamp':Date[_0x504a70(0x9c1)](),'isHidden':!![]};_0x17cfdd[_0x504a70(0xe83)][_0x504a70(0x7dd)](_0x24823f),await _0xa62efb['chats'][_0x504a70(0x546)](_0x17cfdd),await _0x5403b5();}function _0x56dfd3(){const _0x5a768e=_0x13d875,_0x1064af=_0x53d851['chats'][_0x58a059[_0x5a768e(0x13be)]];if(!_0x1064af)return;_0x58a059[_0x5a768e(0x975)]=!![],_0x58a059['isAwaitingResponse']=![],_0x58a059['startTime']=Date[_0x5a768e(0x9c1)](),_0x58a059[_0x5a768e(0x506)]=[];const _0xb446f0=_0x1064af[_0x5a768e(0xe83)][_0x5a768e(0x1340)](-0xa);_0x58a059[_0x5a768e(0xd9c)]=_0xb446f0[_0x5a768e(0xcb4)](_0x4580a5=>{const _0x4b99de=_0x5a768e,_0x5c3038=_0x4580a5[_0x4b99de(0xb4d)]===_0x4b99de(0x10ae)?_0x1064af['settings'][_0x4b99de(0x1303)]||'我':_0x4580a5['senderName']||_0x1064af[_0x4b99de(0x234)];return _0x5c3038+':\x20'+String(_0x4580a5[_0x4b99de(0x73e)])['substring'](0x0,0x32)+_0x4b99de(0x95d);})[_0x5a768e(0x2c8)]('\x0a'),_0x1f5712(),document[_0x5a768e(0x53a)](_0x5a768e(0xee2))['innerHTML']=_0x5a768e(0x508)+(_0x58a059[_0x5a768e(0x732)]?'群聊已建立...':_0x5a768e(0x7a7))+'</em>',_0x541a81(_0x5a768e(0x966)),document[_0x5a768e(0x53a)](_0x5a768e(0xa98))[_0x5a768e(0x1284)]['display']=_0x58a059[_0x5a768e(0x1402)]?_0x5a768e(0x1ea):'none',document[_0x5a768e(0x53a)](_0x5a768e(0xfe5))[_0x5a768e(0x1284)][_0x5a768e(0x11d9)]=_0x58a059[_0x5a768e(0x1402)]?_0x5a768e(0xbf2):_0x5a768e(0x1ea);if(_0x436354)clearInterval(_0x436354);_0x436354=setInterval(_0x2d185d,0x3e8),_0x2d185d(),_0x2b8205();}async function _0x492cea(){const _0x2f337d=_0x13d875;if(!_0x58a059[_0x2f337d(0x975)])return;const _0x178d6b=Math[_0x2f337d(0x7d5)]((Date[_0x2f337d(0x9c1)]()-_0x58a059[_0x2f337d(0x1286)])/0x3e8),_0x5195f4=Math[_0x2f337d(0x7d5)](_0x178d6b/0x3c)+'分'+_0x178d6b%0x3c+'秒',_0x51c9f2=_0x2f337d(0x1294)+_0x5195f4,_0xc7d89=_0x53d851[_0x2f337d(0xaa3)][_0x58a059[_0x2f337d(0x13be)]];if(_0xc7d89){const _0x4babf4=[];_0x58a059[_0x2f337d(0x732)]?(_0x58a059['participants'][_0x2f337d(0xeaf)](_0x2d2201=>_0x4babf4[_0x2f337d(0x7dd)]({'name':_0x2d2201['originalName'],'avatar':_0x2d2201['avatar']})),_0x58a059['isUserParticipating']&&_0x4babf4[_0x2f337d(0xdb8)]({'name':_0xc7d89['settings'][_0x2f337d(0x1303)]||'我','avatar':_0xc7d89[_0x2f337d(0x81e)][_0x2f337d(0x971)]||_0x132d11})):(_0x4babf4['push']({'name':_0xc7d89[_0x2f337d(0x234)],'avatar':_0xc7d89[_0x2f337d(0x81e)][_0x2f337d(0x9e3)]||_0x5d06c0}),_0x4babf4[_0x2f337d(0xdb8)]({'name':'我','avatar':_0xc7d89[_0x2f337d(0x81e)][_0x2f337d(0x971)]||_0x5d06c0}));const _0x4929b2={'chatId':_0x58a059[_0x2f337d(0x13be)],'timestamp':Date['now'](),'duration':_0x178d6b,'participants':_0x4babf4,'transcript':[..._0x58a059[_0x2f337d(0x506)]]};await _0xa62efb[_0x2f337d(0x346)][_0x2f337d(0xe13)](_0x4929b2),console[_0x2f337d(0x1081)](_0x2f337d(0x10be),_0x4929b2);let _0x310adc={'role':_0x58a059['initiator']===_0x2f337d(0x10ae)?_0x2f337d(0x10ae):'assistant','content':_0x51c9f2,'timestamp':Date[_0x2f337d(0x9c1)]()};_0xc7d89[_0x2f337d(0x86e)]&&_0x310adc[_0x2f337d(0xb4d)]===_0x2f337d(0xac5)&&(_0x310adc['senderName']=_0x58a059['callRequester']||_0xc7d89['members'][0x0]?.[_0x2f337d(0x543)]||_0xc7d89[_0x2f337d(0x234)]);_0xc7d89['history'][_0x2f337d(0x7dd)](_0x310adc);const _0x2a96f3=_0x58a059['callHistory']['map'](_0x20a5a9=>{const _0x3e1fe4=_0x2f337d,_0x4fc0a0=_0x20a5a9[_0x3e1fe4(0xb4d)]===_0x3e1fe4(0x10ae)?_0xc7d89['settings'][_0x3e1fe4(0x1303)]||'我':_0x20a5a9['senderName'];return _0x4fc0a0+':\x20'+_0x20a5a9[_0x3e1fe4(0x73e)];})[_0x2f337d(0x2c8)]('\x0a');_0x49b3fd(_0xc7d89['id'],_0x2a96f3);const _0x225135={'role':_0x2f337d(0xab3),'content':_0x2f337d(0x284),'timestamp':Date['now']()+0x1,'isHidden':!![]};_0xc7d89[_0x2f337d(0xe83)][_0x2f337d(0x7dd)](_0x225135),await _0xa62efb[_0x2f337d(0xaa3)][_0x2f337d(0x546)](_0xc7d89);}clearInterval(_0x436354),_0x436354=null,_0x58a059={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0xc7d89&&(_0x1e3a7c(_0xc7d89['id']),_0x5403b5());}function _0x1f5712(){const _0x2f2483=_0x13d875,_0x5503b2=document[_0x2f2483(0x53a)](_0x2f2483(0xb1d));_0x5503b2[_0x2f2483(0xaac)]='';const _0x3378cc=_0x53d851[_0x2f2483(0xaa3)][_0x58a059[_0x2f2483(0x13be)]];if(!_0x3378cc)return;let _0x1e5e60=[];_0x58a059['isGroupCall']?(_0x1e5e60=[..._0x58a059[_0x2f2483(0x574)]],_0x58a059[_0x2f2483(0x1402)]&&_0x1e5e60[_0x2f2483(0xdb8)]({'id':_0x2f2483(0x10ae),'name':_0x3378cc[_0x2f2483(0x81e)]['myNickname']||'我','avatar':_0x3378cc['settings'][_0x2f2483(0x971)]||_0x132d11})):_0x1e5e60[_0x2f2483(0x7dd)]({'id':'ai','name':_0x3378cc[_0x2f2483(0x234)],'avatar':_0x3378cc['settings'][_0x2f2483(0x9e3)]||_0x5d06c0}),_0x1e5e60[_0x2f2483(0xeaf)](_0x3d3bb1=>{const _0x98f5ef=_0x2f2483,_0x492068=document[_0x98f5ef(0xd67)](_0x98f5ef(0x1425));_0x492068['className']='participant-avatar-wrapper',_0x492068[_0x98f5ef(0x999)]['participantId']=_0x3d3bb1['id'];const _0x404c85=_0x3d3bb1[_0x98f5ef(0x12bc)]||_0x3d3bb1[_0x98f5ef(0x234)];_0x492068[_0x98f5ef(0xaac)]=_0x98f5ef(0xc75)+_0x3d3bb1['avatar']+_0x98f5ef(0xdcf)+_0x404c85+_0x98f5ef(0x12aa)+_0x404c85+_0x98f5ef(0xca8),_0x5503b2[_0x98f5ef(0x133d)](_0x492068);});}function _0x3a29e8(){const _0x313189=_0x13d875;if(!_0x58a059['isActive']||_0x58a059[_0x313189(0x1402)])return;_0x58a059[_0x313189(0x1402)]=!![],_0x1f5712(),document['getElementById'](_0x313189(0xa98))[_0x313189(0x1284)][_0x313189(0x11d9)]=_0x313189(0x1ea),document[_0x313189(0x53a)](_0x313189(0xfe5))[_0x313189(0x1284)][_0x313189(0x11d9)]=_0x313189(0xbf2),_0x2b8205(_0x313189(0x956));}function _0x2d185d(){const _0x79d6fe=_0x13d875;if(!_0x58a059['isActive'])return;const _0x1cd96b=Math['floor']((Date['now']()-_0x58a059[_0x79d6fe(0x1286)])/0x3e8),_0x380800=Math[_0x79d6fe(0x7d5)](_0x1cd96b/0x3c),_0x1300ee=_0x1cd96b%0x3c;document[_0x79d6fe(0x53a)]('call-timer')['textContent']=String(_0x380800)[_0x79d6fe(0x117e)](0x2,'0')+':'+String(_0x1300ee)[_0x79d6fe(0x117e)](0x2,'0');}function _0x525e26(){const _0x4e40b7=_0x13d875,_0x133682=_0x53d851[_0x4e40b7(0xaa3)][_0x53d851['activeChatId']];if(!_0x133682)return;if(_0x133682[_0x4e40b7(0x86e)]){const _0x77469c=_0x58a059[_0x4e40b7(0xa0b)]||_0x133682[_0x4e40b7(0x3de)][0x0]?.[_0x4e40b7(0x234)]||_0x4e40b7(0x9bb);document[_0x4e40b7(0x53a)]('caller-avatar')[_0x4e40b7(0x7ff)]=_0x133682[_0x4e40b7(0x81e)][_0x4e40b7(0x629)]||_0x29ae5b,document[_0x4e40b7(0x53a)](_0x4e40b7(0x2ef))['textContent']=_0x133682[_0x4e40b7(0x234)],document[_0x4e40b7(0x139c)](_0x4e40b7(0x10dc))[_0x4e40b7(0x34a)]=_0x77469c+_0x4e40b7(0x439);}else document[_0x4e40b7(0x53a)](_0x4e40b7(0x141a))[_0x4e40b7(0x7ff)]=_0x133682[_0x4e40b7(0x81e)][_0x4e40b7(0x9e3)]||_0x5d06c0,document[_0x4e40b7(0x53a)](_0x4e40b7(0x2ef))['textContent']=_0x133682['name'],document[_0x4e40b7(0x139c)](_0x4e40b7(0x10dc))[_0x4e40b7(0x34a)]=_0x4e40b7(0xb85);document[_0x4e40b7(0x53a)](_0x4e40b7(0x77f))['classList']['add']('visible');}function _0x5bd3ef(){const _0xa2541f=_0x13d875;document[_0xa2541f(0x53a)](_0xa2541f(0x77f))['classList'][_0xa2541f(0x2d4)](_0xa2541f(0xaef));}async function _0x2b8205(_0x5f34f9=null){const _0x263608=_0x13d875;if(!_0x58a059[_0x263608(0x975)])return;const _0x29f41f=_0x53d851[_0x263608(0xaa3)][_0x58a059[_0x263608(0x13be)]],{proxyUrl:_0x24d345,apiKey:_0x21a4fa,model:_0x4d509a}=_0x53d851[_0x263608(0x80d)],_0x45a9d6=document[_0x263608(0x53a)]('video-call-main'),_0x3d966e=_0x29f41f[_0x263608(0x81e)][_0x263608(0x1303)]||'我';let _0x5cf5ba='';if(_0x29f41f[_0x263608(0x81e)]['linkedWorldBookIds']&&_0x29f41f[_0x263608(0x81e)][_0x263608(0x4ab)][_0x263608(0x29d)]>0x0){const _0x5a9590=_0x29f41f[_0x263608(0x81e)][_0x263608(0x4ab)][_0x263608(0xcb4)](_0x1a94c1=>{const _0x25eb56=_0x263608,_0x11c0f1=_0x53d851[_0x25eb56(0x10f2)][_0x25eb56(0x397)](_0x3d012d=>_0x3d012d['id']===_0x1a94c1);return _0x11c0f1&&_0x11c0f1['content']?_0x25eb56(0xa7d)+_0x11c0f1[_0x25eb56(0x234)]+'\x0a'+_0x11c0f1[_0x25eb56(0x73e)]:'';})[_0x263608(0x2dd)](Boolean)[_0x263608(0x2c8)]('');_0x5a9590&&(_0x5cf5ba='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x5a9590+_0x263608(0xcc2));}if(_0x5f34f9&&_0x58a059[_0x263608(0x1402)]){const _0x5bc560=Date['now'](),_0x4961f1=document['createElement'](_0x263608(0x1425));_0x4961f1['className']=_0x263608(0xdbb),_0x4961f1[_0x263608(0x34a)]=_0x5f34f9,_0x4961f1[_0x263608(0x999)]['timestamp']=_0x5bc560,_0x3146aa(_0x4961f1,()=>_0x3ae13d(_0x5bc560)),_0x45a9d6[_0x263608(0x133d)](_0x4961f1),_0x45a9d6['scrollTop']=_0x45a9d6[_0x263608(0xaae)],_0x58a059[_0x263608(0x506)][_0x263608(0x7dd)]({'role':'user','content':_0x5f34f9,'timestamp':_0x5bc560});}let _0x109eae;if(_0x58a059[_0x263608(0x732)]){const _0x5d5828=_0x58a059[_0x263608(0x574)][_0x263608(0xcb4)](_0x4477ee=>_0x4477ee[_0x263608(0x234)]);_0x58a059['isUserParticipating']&&_0x5d5828['unshift'](_0x3d966e),_0x109eae=_0x263608(0x967)+_0x3d966e+'】。你【绝对不能】生成\x20`name`\x20字段为\x20**\x22'+_0x3d966e+_0x263608(0xac2)+_0x58a059[_0x263608(0xd9c)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20**当前参与者**:\x20'+_0x5d5828['join']('、\x20')+_0x263608(0x114b)+_0x5cf5ba+_0x263608(0x744);}else{let _0x103268=_0x58a059[_0x263608(0xf71)]===_0x263608(0x10ae)?_0x263608(0xab0):_0x263608(0xb7f);_0x109eae=_0x263608(0xbe8)+_0x29f41f['name']+'\x20('+_0x29f41f[_0x263608(0x81e)][_0x263608(0x1216)]+')，并以【第三人称旁观视角】来描述TA在视频通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。必须使用第三人称，如“他”、“她”、或直接使用角色名“'+_0x29f41f[_0x263608(0x234)]+_0x263608(0x1e7)+_0x3d966e+_0x263608(0x209)+_0x29f41f[_0x263608(0x81e)][_0x263608(0xab1)]+_0x263608(0x45a)+_0x103268+_0x263608(0x12b4)+_0x58a059['preCallContext']+_0x263608(0x13fd);}const _0x318c65=[{'role':_0x263608(0xab3),'content':_0x109eae},..._0x58a059[_0x263608(0x506)][_0x263608(0xcb4)](_0x1a22ff=>({'role':_0x1a22ff[_0x263608(0xb4d)],'content':_0x1a22ff['content']}))];if(_0x58a059['callHistory'][_0x263608(0x29d)]===0x0){const _0x7eca07=_0x58a059[_0x263608(0xf71)]==='user'?'*你按下了接听键...*':_0x263608(0x4e6);_0x318c65[_0x263608(0x7dd)]({'role':_0x263608(0x10ae),'content':_0x7eca07});}try{let _0x2cd59d=_0x24d345===GEMINI_API_URL,_0x3ccc40=_0x1697e7(_0x4d509a,_0x21a4fa,_0x109eae,_0x318c65);const _0x2d9c0d=_0x2cd59d?await fetch(_0x3ccc40['url'],_0x3ccc40[_0x263608(0xd7c)]):await fetch(_0x24d345+_0x263608(0x434),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x263608(0x841)+_0x21a4fa},'body':JSON['stringify']({'model':_0x4d509a,'messages':_0x318c65,'temperature':_0x53d851[_0x263608(0x906)][_0x263608(0xaf8)]||0.8})});if(!_0x2d9c0d['ok'])throw new Error((await _0x2d9c0d[_0x263608(0xdc2)]())[_0x263608(0x617)][_0x263608(0x875)]);const _0x4e85be=await _0x2d9c0d[_0x263608(0xdc2)](),_0x4989ec=_0x2cd59d?_0x4e85be[_0x263608(0x21d)][0x0][_0x263608(0x73e)][_0x263608(0x8b3)][0x0][_0x263608(0x2e6)]:_0x4e85be['choices'][0x0]['message']['content'],_0xce59e3=_0x45a9d6[_0x263608(0x139c)]('em');if(_0xce59e3)_0xce59e3['remove']();if(_0x58a059[_0x263608(0x732)]){const _0x27c583=_0x3e5855(_0x4989ec);_0x27c583[_0x263608(0xeaf)](_0x4d7f35=>{const _0x2ee024=_0x263608;if(!_0x4d7f35[_0x2ee024(0x234)]||_0x4d7f35[_0x2ee024(0x234)]===_0x3d966e||!_0x4d7f35['speech'])return;const _0x20ac8f=Date[_0x2ee024(0x9c1)]()+Math[_0x2ee024(0xac4)](),_0x554462=document[_0x2ee024(0xd67)](_0x2ee024(0x1425));_0x554462['className']='call-message-bubble\x20ai-speech',_0x554462[_0x2ee024(0xaac)]=_0x2ee024(0x26e)+_0x4d7f35['name']+_0x2ee024(0x13d6)+_0x4d7f35[_0x2ee024(0xa1f)],_0x554462[_0x2ee024(0x999)][_0x2ee024(0x827)]=_0x20ac8f,_0x3146aa(_0x554462,()=>_0x3ae13d(_0x20ac8f)),_0x45a9d6[_0x2ee024(0x133d)](_0x554462),_0x58a059['callHistory'][_0x2ee024(0x7dd)]({'role':_0x2ee024(0xac5),'content':_0x4d7f35[_0x2ee024(0x234)]+':\x20'+_0x4d7f35['speech'],'timestamp':_0x20ac8f});const _0x481e89=_0x58a059[_0x2ee024(0x574)][_0x2ee024(0x397)](_0x436093=>_0x436093[_0x2ee024(0x234)]===_0x4d7f35[_0x2ee024(0x234)]);if(_0x481e89){const _0x2c7df3=document[_0x2ee024(0x139c)](_0x2ee024(0x92c)+_0x481e89['id']+_0x2ee024(0xeba));_0x2c7df3&&(_0x2c7df3[_0x2ee024(0x1276)][_0x2ee024(0xe13)](_0x2ee024(0x94e)),setTimeout(()=>_0x2c7df3[_0x2ee024(0x1276)][_0x2ee024(0x2d4)](_0x2ee024(0x94e)),0x7d0));}});}else{const _0x2dbfa3=Date[_0x263608(0x9c1)](),_0x5194f5=document['createElement'](_0x263608(0x1425));_0x5194f5[_0x263608(0x6de)]=_0x263608(0x652),_0x5194f5[_0x263608(0x34a)]=_0x4989ec,_0x5194f5[_0x263608(0x999)][_0x263608(0x827)]=_0x2dbfa3,_0x3146aa(_0x5194f5,()=>_0x3ae13d(_0x2dbfa3)),_0x45a9d6[_0x263608(0x133d)](_0x5194f5),_0x58a059[_0x263608(0x506)]['push']({'role':'assistant','content':_0x4989ec,'timestamp':_0x2dbfa3});const _0x32bbe6=document[_0x263608(0x139c)](_0x263608(0x1075));_0x32bbe6&&(_0x32bbe6[_0x263608(0x1276)][_0x263608(0xe13)](_0x263608(0x94e)),setTimeout(()=>_0x32bbe6[_0x263608(0x1276)][_0x263608(0x2d4)](_0x263608(0x94e)),0x7d0));}_0x45a9d6[_0x263608(0xf68)]=_0x45a9d6[_0x263608(0xaae)];}catch(_0xcf0d33){const _0x9c5b54=document['createElement'](_0x263608(0x1425));_0x9c5b54[_0x263608(0x6de)]='call-message-bubble\x20ai-speech',_0x9c5b54['style'][_0x263608(0xb27)]=_0x263608(0x4e4),_0x9c5b54[_0x263608(0x34a)]=_0x263608(0x1099)+_0xcf0d33[_0x263608(0x875)]+']',_0x45a9d6[_0x263608(0x133d)](_0x9c5b54),_0x45a9d6[_0x263608(0xf68)]=_0x45a9d6[_0x263608(0xaae)],_0x58a059['callHistory']['push']({'role':_0x263608(0xac5),'content':_0x263608(0x1099)+_0xcf0d33[_0x263608(0x875)]+']'});}}function _0x5dd548(_0xfa2527){const _0x4c7404=_0x13d875;document[_0x4c7404(0x53a)](_0x4c7404(0xa62))['style'][_0x4c7404(0x11d9)]=_0xfa2527?_0x4c7404(0xbf2):_0x4c7404(0x2f6),document['getElementById'](_0x4c7404(0x797))['style'][_0x4c7404(0x11d9)]=_0xfa2527?_0x4c7404(0x2f6):_0x4c7404(0xbf2);}async function _0x3d09cb(_0x5ce9c4,_0x4bd54a){const _0x5c0b5c=_0x13d875,_0x33fb1b=_0x53d851['chats'][_0x53d851[_0x5c0b5c(0x13be)]];if(!_0x33fb1b)return;const _0x385fa6=_0x33fb1b[_0x5c0b5c(0xe83)]['findIndex'](_0xc5cd34=>_0xc5cd34['timestamp']===_0x5ce9c4);if(_0x385fa6===-0x1)return;const _0x2dde68=_0x33fb1b[_0x5c0b5c(0xe83)][_0x385fa6];_0x2dde68[_0x5c0b5c(0x12d3)]=_0x4bd54a;let _0x8a4440;const _0x2863d0=_0x33fb1b[_0x5c0b5c(0x86e)]?_0x33fb1b[_0x5c0b5c(0x81e)][_0x5c0b5c(0x1303)]||'我':'我';_0x4bd54a===_0x5c0b5c(0x2ea)?(_0x2dde68[_0x5c0b5c(0x738)]=_0x2863d0,_0x8a4440=_0x5c0b5c(0xf5b)+_0x2863d0+_0x5c0b5c(0x20b)+_0x2dde68[_0x5c0b5c(0xbee)]+_0x5c0b5c(0x429)+_0x5ce9c4+_0x5c0b5c(0x131f)):_0x8a4440=_0x5c0b5c(0xf5b)+_0x2863d0+_0x5c0b5c(0xe80)+_0x2dde68[_0x5c0b5c(0xbee)]+'\x20的外卖代付请求（时间戳:\x20'+_0x5ce9c4+_0x5c0b5c(0x12a0);const _0x1a886b={'role':_0x5c0b5c(0xab3),'content':_0x8a4440,'timestamp':Date[_0x5c0b5c(0x9c1)](),'isHidden':!![]};_0x33fb1b[_0x5c0b5c(0xe83)][_0x5c0b5c(0x7dd)](_0x1a886b),await _0xa62efb[_0x5c0b5c(0xaa3)][_0x5c0b5c(0x546)](_0x33fb1b),_0x60f53f(_0x53d851['activeChatId']),_0x4bd54a===_0x5c0b5c(0x2ea)&&_0x5403b5();}async function _0x394622(_0x564f40,_0x54cce2){const _0x423e70=_0x13d875,_0x224de5=_0x53d851[_0x423e70(0xaa3)][_0x564f40];if(!_0x224de5)return;let _0x262f6d;_0x224de5[_0x423e70(0x86e)]?_0x262f6d=_0xf33fb2(_0x224de5,_0x54cce2):_0x262f6d=_0x224de5[_0x423e70(0x234)];const _0x2637bd=document[_0x423e70(0x53a)](_0x423e70(0xf87));_0x2637bd['classList']['remove'](_0x423e70(0x208)),void _0x2637bd[_0x423e70(0xb6f)],_0x2637bd[_0x423e70(0x1276)][_0x423e70(0xe13)]('pat-animation');const _0x3c94dd=await _0x4f6537(_0x423e70(0xf0d)+_0x262f6d+'”',_0x423e70(0x5e4),'',_0x423e70(0x2e6));if(_0x3c94dd===null)return;const _0x3e87d1=_0xf33fb2(_0x224de5,_0x53d851[_0x423e70(0xa74)][_0x423e70(0x1005)]),_0x2efc9b=_0x3e87d1+'\x20拍了拍\x20“'+_0x262f6d+'”\x20'+_0x3c94dd[_0x423e70(0x13bc)](),_0x29036c={'role':_0x423e70(0xab3),'type':_0x423e70(0x109b),'content':_0x2efc9b,'timestamp':Date[_0x423e70(0x9c1)]()};_0x224de5[_0x423e70(0xe83)]['push'](_0x29036c);const _0x5a66b7=_0x423e70(0x41c)+_0x3e87d1+'）刚刚拍了拍你（'+_0x54cce2+'）'+_0x3c94dd[_0x423e70(0x13bc)]()+'。请你对此作出回应。]',_0x15ad98={'role':'system','content':_0x5a66b7,'timestamp':Date[_0x423e70(0x9c1)]()+0x1,'isHidden':!![]};_0x224de5[_0x423e70(0xe83)]['push'](_0x15ad98),await _0xa62efb['chats'][_0x423e70(0x546)](_0x224de5),_0x53d851[_0x423e70(0x13be)]===_0x564f40&&_0xa4d65(_0x29036c,_0x224de5),await _0x5001a4();}let _0x5ed43d=null,_0x5a5ea7=![],_0x4648e0=new Set();function _0x3ae13d(_0x3fe728){const _0x4de995=_0x13d875;_0x5ed43d=_0x3fe728,document[_0x4de995(0x53a)](_0x4de995(0x297))[_0x4de995(0x1276)][_0x4de995(0xe13)]('visible');}function _0x582162(){const _0x125482=_0x13d875;document[_0x125482(0x53a)](_0x125482(0x297))[_0x125482(0x1276)][_0x125482(0x2d4)]('visible'),_0x5ed43d=null;}async function _0xd27b0f(){const _0x1fbdfc=_0x13d875;if(!_0x5ed43d)return;const _0x267d9a=_0x5ed43d,_0xe4a0a5=_0x58a059['callHistory'][_0x1fbdfc(0x397)](_0x2b99ed=>_0x2b99ed[_0x1fbdfc(0x827)]===_0x267d9a);if(!_0xe4a0a5)return;_0x582162();let _0x4d59b7=_0xe4a0a5[_0x1fbdfc(0x73e)];if(_0x58a059['isGroupCall']&&_0xe4a0a5[_0x1fbdfc(0xb4d)]===_0x1fbdfc(0xac5)){const _0x298763=_0xe4a0a5['content'][_0x1fbdfc(0x13e8)](':\x20');_0x298763[_0x1fbdfc(0x29d)]>0x1&&(_0x4d59b7=_0x298763[_0x1fbdfc(0x1340)](0x1)[_0x1fbdfc(0x2c8)](':\x20'));}const _0x314efb=await _0x4f6537(_0x1fbdfc(0xc1a),_0x1fbdfc(0x87b),_0x4d59b7,_0x1fbdfc(0x728));_0x314efb!==null&&await _0x4f2bcc(_0x267d9a,_0x314efb);}async function _0x4f2bcc(_0x329d12,_0x2881c6){const _0x24b3dd=_0x13d875,_0x48733a=_0x58a059[_0x24b3dd(0x506)][_0x24b3dd(0x397)](_0x3fbc5e=>_0x3fbc5e['timestamp']===_0x329d12);if(_0x48733a){let _0x1af834=_0x2881c6;if(_0x58a059[_0x24b3dd(0x732)]&&_0x48733a[_0x24b3dd(0xb4d)]==='assistant'){const _0x47c688=_0x48733a[_0x24b3dd(0x73e)]['split'](':\x20'),_0x2be9f5=_0x47c688[0x0];_0x1af834=_0x2be9f5+':\x20'+_0x2881c6;}_0x48733a[_0x24b3dd(0x73e)]=_0x1af834;const _0x32f036=document['querySelector'](_0x24b3dd(0xf4d)+_0x329d12+'\x22]');if(_0x32f036){if(_0x58a059[_0x24b3dd(0x732)]&&_0x48733a['role']==='assistant'){const _0x41917f=_0x48733a[_0x24b3dd(0x73e)]['split'](':\x20'),_0xc9fa8e=_0x41917f[0x0];_0x32f036['innerHTML']=_0x24b3dd(0x26e)+_0xc9fa8e+_0x24b3dd(0x13d6)+_0x2881c6;}else _0x32f036[_0x24b3dd(0x34a)]=_0x2881c6;}}await _0x184397('成功',_0x24b3dd(0xb0c));}async function _0x31ac69(){const _0x5e31fd=_0x13d875;if(!_0x5ed43d)return;const _0x3ed85e=await _0x355fc0(_0x5e31fd(0xccc),'确定要删除这条通话消息吗？',{'confirmButtonClass':'btn-danger'});if(_0x3ed85e){const _0x5544e3=_0x5ed43d;_0x582162();const _0x13b0aa=_0x58a059[_0x5e31fd(0x506)][_0x5e31fd(0x298)](_0x4a1322=>_0x4a1322[_0x5e31fd(0x827)]===_0x5544e3);_0x13b0aa>-0x1&&_0x58a059[_0x5e31fd(0x506)]['splice'](_0x13b0aa,0x1);const _0x1c22cc=document['querySelector'](_0x5e31fd(0xf4d)+_0x5544e3+'\x22]');_0x1c22cc&&_0x1c22cc[_0x5e31fd(0x2d4)]();}else _0x582162();}function _0x2014ee(_0x2128a2){const _0x2c3bbf=_0x13d875;_0x398891=_0x2128a2;const _0x306b8d=_0x53d851['chats'][_0x53d851[_0x2c3bbf(0x13be)]],_0x301eb5=_0x306b8d['history'][_0x2c3bbf(0x397)](_0x318c4e=>_0x318c4e['timestamp']===_0x2128a2);_0x301eb5&&(document[_0x2c3bbf(0x53a)](_0x2c3bbf(0x1351))['textContent']=_0x301eb5[_0x2c3bbf(0xbee)]),document[_0x2c3bbf(0x53a)]('transfer-actions-modal')[_0x2c3bbf(0x1276)][_0x2c3bbf(0xe13)]('visible');}function _0x11ada4(){const _0x43ac73=_0x13d875;document[_0x43ac73(0x53a)](_0x43ac73(0xd6c))[_0x43ac73(0x1276)]['remove'](_0x43ac73(0xaef)),_0x398891=null;}async function _0x59d079(_0x59013f){const _0x5b38ca=_0x13d875;if(!_0x398891)return;const _0x3b89a8=_0x398891,_0x38dc32=_0x53d851['chats'][_0x53d851[_0x5b38ca(0x13be)]],_0x5691f1=_0x38dc32[_0x5b38ca(0xe83)][_0x5b38ca(0x298)](_0xa47588=>_0xa47588[_0x5b38ca(0x827)]===_0x3b89a8);if(_0x5691f1===-0x1)return;const _0x532510=_0x38dc32['history'][_0x5691f1];_0x532510[_0x5b38ca(0x12d3)]=_0x59013f;let _0xb479d3;if(_0x59013f===_0x5b38ca(0xe65)){const _0x5796b0={'role':'user','type':_0x5b38ca(0x566),'isRefund':!![],'amount':_0x532510[_0x5b38ca(0x1146)],'note':_0x5b38ca(0xce0),'timestamp':Date[_0x5b38ca(0x9c1)]()};_0x38dc32[_0x5b38ca(0xe83)][_0x5b38ca(0x7dd)](_0x5796b0),_0xb479d3=_0x5b38ca(0x13e2)+_0x532510[_0x5b38ca(0xbee)]+_0x5b38ca(0xcd1);}else _0xb479d3=_0x5b38ca(0x3b0)+_0x532510[_0x5b38ca(0xbee)]+_0x5b38ca(0xcd1);const _0x38e2ad={'role':_0x5b38ca(0xab3),'content':_0xb479d3,'timestamp':Date[_0x5b38ca(0x9c1)]()+0x1,'isHidden':!![]};_0x38dc32[_0x5b38ca(0xe83)][_0x5b38ca(0x7dd)](_0x38e2ad),await _0xa62efb[_0x5b38ca(0xaa3)][_0x5b38ca(0x546)](_0x38dc32),_0x11ada4(),_0x60f53f(_0x53d851[_0x5b38ca(0x13be)]),_0x5001a4();}function _0x1bc9e6(_0x7af650){const _0x400c86=_0x13d875;_0x5e91f3=null;if(_0x7af650){const _0x494a37=_0x7af650[_0x400c86(0x139c)](_0x400c86(0xc94));_0x494a37&&(_0x494a37[_0x400c86(0x140d)]=_0x400c86(0x90c));}}async function _0x326e05(){const _0x20ca6f=_0x13d875,_0x46665e=document['getElementById'](_0x20ca6f(0x135a));_0x46665e['innerHTML']='';const _0x2820f8=await _0xa62efb['memories'][_0x20ca6f(0x1064)]('timestamp')[_0x20ca6f(0x843)]()[_0x20ca6f(0xa73)]();if(_0x2820f8[_0x20ca6f(0x29d)]===0x0){_0x46665e[_0x20ca6f(0xaac)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有共同的回忆和约定呢~</p>';return;}_0x2820f8[_0x20ca6f(0xdb0)]((_0x56293b,_0x5560bc)=>{const _0x43aa70=_0x20ca6f,_0x4d070c=_0x56293b['type']===_0x43aa70(0x1178)&&_0x56293b[_0x43aa70(0x4f1)]>Date[_0x43aa70(0x9c1)](),_0x141e8d=_0x5560bc['type']===_0x43aa70(0x1178)&&_0x5560bc['targetDate']>Date['now']();if(_0x4d070c&&!_0x141e8d)return-0x1;if(!_0x4d070c&&_0x141e8d)return 0x1;if(_0x4d070c&&_0x141e8d)return _0x56293b[_0x43aa70(0x4f1)]-_0x5560bc[_0x43aa70(0x4f1)];return 0x0;}),_0x2820f8[_0x20ca6f(0xeaf)](_0x24930a=>{const _0xedf4da=_0x20ca6f;let _0x180454;_0x24930a[_0xedf4da(0x919)]==='countdown'&&_0x24930a[_0xedf4da(0x4f1)]>Date[_0xedf4da(0x9c1)]()?_0x180454=_0x40047f(_0x24930a):_0x180454=_0x57cfb7(_0x24930a),_0x46665e['appendChild'](_0x180454);}),_0x522b1c();}function _0x57cfb7(_0x8d4d2){const _0x4294e4=_0x13d875,_0x3a3471=document[_0x4294e4(0xd67)](_0x4294e4(0x1425));_0x3a3471[_0x4294e4(0x6de)]='memory-card';const _0x6e2632=new Date(_0x8d4d2['timestamp']),_0x559fed=_0x6e2632['getFullYear']()+'-'+String(_0x6e2632['getMonth']()+0x1)['padStart'](0x2,'0')+'-'+String(_0x6e2632[_0x4294e4(0xfae)]())[_0x4294e4(0x117e)](0x2,'0')+'\x20'+String(_0x6e2632[_0x4294e4(0x659)]())[_0x4294e4(0x117e)](0x2,'0')+':'+String(_0x6e2632['getMinutes']())['padStart'](0x2,'0');let _0x5252c6,_0x3afa69;if(_0x8d4d2[_0x4294e4(0x919)]===_0x4294e4(0x1178)&&_0x8d4d2['targetDate'])_0x5252c6=_0x4294e4(0x121b)+_0x8d4d2[_0x4294e4(0xa60)],_0x3afa69=_0x46c503('在\x20'+new Date(_0x8d4d2[_0x4294e4(0x4f1)])[_0x4294e4(0x5ee)]()+_0x4294e4(0xc23))[_0x4294e4(0x795)](/\n/g,'<br>');else{let _0x2e6467='我们的回忆';if(_0x8d4d2[_0x4294e4(0xa59)]){const _0x25c424=_0x53d851[_0x4294e4(0xaa3)][_0x8d4d2[_0x4294e4(0xa59)]];_0x25c424?_0x2e6467=_0x25c424[_0x4294e4(0x234)]:_0x2e6467=_0x8d4d2['authorName']||'一位朋友';}else _0x8d4d2['authorName']&&(_0x2e6467=_0x8d4d2[_0x4294e4(0x3dd)]);_0x5252c6=_0x2e6467+_0x4294e4(0x6ed),_0x3afa69=_0x46c503(_0x8d4d2['description']);}return _0x3a3471[_0x4294e4(0xaac)]=_0x4294e4(0xa92)+_0x559fed+_0x4294e4(0xd71)+_0x5252c6+_0x4294e4(0x1236)+_0x3afa69+_0x4294e4(0x1133),_0x3146aa(_0x3a3471,async()=>{const _0xebb276=_0x4294e4,_0x4ae703=await _0x355fc0(_0xebb276(0xd17),_0xebb276(0x603),{'confirmButtonClass':'btn-danger'});_0x4ae703&&(await _0xa62efb[_0xebb276(0xbe7)]['delete'](_0x8d4d2['id']),_0x326e05());}),_0x3a3471;}function _0x40047f(_0x277904){const _0x6a4700=_0x13d875,_0x258d2c=document[_0x6a4700(0xd67)]('div');_0x258d2c[_0x6a4700(0x6de)]=_0x6a4700(0xb0e);const _0x2e6138=new Date(_0x277904[_0x6a4700(0x4f1)]),_0xb6fb1b=_0x2e6138[_0x6a4700(0x5ee)]('zh-CN',{'dateStyle':_0x6a4700(0xbcc),'timeStyle':_0x6a4700(0xa18)});return _0x258d2c[_0x6a4700(0xaac)]=_0x6a4700(0x789)+_0x277904[_0x6a4700(0xa60)]+_0x6a4700(0xacb)+_0x277904['targetDate']+_0x6a4700(0x12c0)+_0xb6fb1b+_0x6a4700(0x1133),_0x3146aa(_0x258d2c,async()=>{const _0x5d0b41=_0x6a4700,_0x4df3c6=await _0x355fc0(_0x5d0b41(0x13c2),_0x5d0b41(0x13f1),{'confirmButtonClass':_0x5d0b41(0x264)});_0x4df3c6&&(await _0xa62efb[_0x5d0b41(0xbe7)]['delete'](_0x277904['id']),_0x326e05());}),_0x258d2c;}let _0x3a8252=[];function _0x522b1c(){const _0x50566f=_0x13d875;_0x3a8252[_0x50566f(0xeaf)](_0x5d787d=>clearInterval(_0x5d787d)),_0x3a8252=[],document['querySelectorAll'](_0x50566f(0x251))[_0x50566f(0xeaf)](_0x31d44d=>{const _0x1261dd=_0x50566f,_0xce7c65=parseInt(_0x31d44d['dataset'][_0x1261dd(0x4f1)]);let _0x4166f4;const _0x18347a=()=>{const _0x512257=_0x1261dd,_0x3380f2=Date[_0x512257(0x9c1)](),_0x345ec8=_0xce7c65-_0x3380f2;if(_0x345ec8<0x0){_0x31d44d['textContent']='约定达成！',clearInterval(_0x4166f4),setTimeout(()=>_0x326e05(),0x7d0);return;}const _0x19c03a=Math[_0x512257(0x7d5)](_0x345ec8/(0x3e8*0x3c*0x3c*0x18)),_0xdd2c1d=Math[_0x512257(0x7d5)](_0x345ec8%(0x3e8*0x3c*0x3c*0x18)/(0x3e8*0x3c*0x3c)),_0x4cea82=Math['floor'](_0x345ec8%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x14024a=Math[_0x512257(0x7d5)](_0x345ec8%(0x3e8*0x3c)/0x3e8);_0x31d44d[_0x512257(0x34a)]=_0x19c03a+'天\x20'+_0xdd2c1d+'时\x20'+_0x4cea82+'分\x20'+_0x14024a+'秒';};_0x18347a(),_0x4166f4=setInterval(_0x18347a,0x3e8),_0x3a8252[_0x1261dd(0x7dd)](_0x4166f4);});}async function _0x56c2ac(_0x6d36c9){const _0xe019a5=_0x13d875,_0x1f5cd2=_0x53d851[_0xe019a5(0xaa3)][_0x6d36c9];if(!_0x1f5cd2)return;await _0x184397(_0xe019a5(0xcb1),_0xe019a5(0x12d6)+_0x1f5cd2[_0xe019a5(0x234)]+_0xe019a5(0xd18));const {proxyUrl:_0x541974,apiKey:_0x57c424,model:_0x2cec1f}=_0x53d851['apiConfig'];if(!_0x541974||!_0x57c424||!_0x2cec1f){await _0x184397(_0xe019a5(0xa19),_0xe019a5(0xd56));return;}const _0x5e04ba=_0x1f5cd2['history'][_0xe019a5(0x1340)](-0x5)['map'](_0x41c5fc=>{const _0x2dc1d7=_0xe019a5,_0x2b36a8=_0x41c5fc[_0x2dc1d7(0xb4d)]===_0x2dc1d7(0x10ae)?_0x1f5cd2[_0x2dc1d7(0x81e)][_0x2dc1d7(0x1303)]||'我':_0x41c5fc[_0x2dc1d7(0xbee)]||_0x1f5cd2[_0x2dc1d7(0x234)];return _0x2b36a8+':\x20'+String(_0x41c5fc[_0x2dc1d7(0x73e)])[_0x2dc1d7(0xad6)](0x0,0x32)+'...';})[_0xe019a5(0x2c8)]('\x0a');let _0x3acb31='';if(_0x1f5cd2[_0xe019a5(0x81e)][_0xe019a5(0x4ab)]&&_0x1f5cd2[_0xe019a5(0x81e)][_0xe019a5(0x4ab)][_0xe019a5(0x29d)]>0x0){const _0x3ce50a=_0x1f5cd2[_0xe019a5(0x81e)]['linkedWorldBookIds']['map'](_0x2f00b5=>{const _0x1a543f=_0xe019a5,_0x336512=_0x53d851[_0x1a543f(0x10f2)][_0x1a543f(0x397)](_0x76041c=>_0x76041c['id']===_0x2f00b5);if(!_0x336512||!Array[_0x1a543f(0xb31)](_0x336512[_0x1a543f(0x73e)]))return'';const _0x245778=_0x336512['content'][_0x1a543f(0xcb4)](_0x9a527d=>{const _0x493ee3=_0x1a543f;let _0x11bbad=_0x493ee3(0xbc5)+(_0x9a527d['comment']||_0x493ee3(0x4a4))+'\x0a';return _0x9a527d[_0x493ee3(0x1350)]['length']>0x0&&(_0x11bbad+='**关键词:**\x20'+_0x9a527d['keys'][_0x493ee3(0x2c8)](',\x20')+'\x0a'),_0x11bbad+=_0x493ee3(0x578)+_0x9a527d['content'],_0x11bbad;})['join']('\x0a');return _0x245778?'\x0a\x0a##\x20世界书:\x20'+_0x336512[_0x1a543f(0x234)]+'\x0a'+_0x245778:'';})[_0xe019a5(0x2dd)](Boolean)['join']('');_0x3ce50a&&(_0x3acb31=_0xe019a5(0x833)+_0x3ce50a+'\x0a');}const _0x321c43=_0xe019a5(0x13e1)+_0x1f5cd2[_0xe019a5(0x234)]+_0xe019a5(0xb8a)+_0x1f5cd2[_0xe019a5(0x81e)][_0xe019a5(0x1216)]+_0xe019a5(0x7b6)+_0x3acb31+_0xe019a5(0xe81)+_0x5e04ba+_0xe019a5(0x4da);try{const _0x8fc3=[{'role':'system','content':_0x321c43},{'role':_0xe019a5(0x10ae),'content':_0xe019a5(0x1379)}];let _0x49b711=_0x541974===GEMINI_API_URL,_0x29494a=_0x1697e7(_0x2cec1f,_0x57c424,_0x321c43,_0x8fc3);const _0xb532af=_0x49b711?await fetch(_0x29494a['url'],_0x29494a[_0xe019a5(0xd7c)]):await fetch(_0x541974+'/v1/chat/completions',{'method':_0xe019a5(0xa4e),'headers':{'Content-Type':'application/json','Authorization':_0xe019a5(0x841)+_0x57c424},'body':JSON['stringify']({'model':_0x2cec1f,'messages':_0x8fc3,'temperature':_0x53d851[_0xe019a5(0x906)][_0xe019a5(0xaf8)]||0.9})});if(!_0xb532af['ok']){const _0x595cdf=await _0xb532af[_0xe019a5(0xdc2)]();throw new Error(_0xe019a5(0x509)+_0xb532af[_0xe019a5(0x12d3)]+_0xe019a5(0x122c)+_0x595cdf['error'][_0xe019a5(0x875)]);}const _0x545b42=await _0xb532af[_0xe019a5(0xdc2)]();let _0x1066f0=_0x49b711?_0x545b42[_0xe019a5(0x21d)][0x0][_0xe019a5(0x73e)][_0xe019a5(0x8b3)][0x0][_0xe019a5(0x2e6)]:_0x545b42[_0xe019a5(0x12bf)][0x0][_0xe019a5(0x875)][_0xe019a5(0x73e)];_0x1066f0=_0x1066f0[_0xe019a5(0x795)](/^```json\s*/,'')[_0xe019a5(0x795)](/```$/,'');const _0x5eb10d=_0x1066f0[_0xe019a5(0x13bc)](),_0x227d7a=JSON[_0xe019a5(0x367)](_0x5eb10d);_0x227d7a[_0xe019a5(0x12e3)]===_0xe019a5(0x4e7)&&_0x227d7a[_0xe019a5(0xd90)]?(_0x1f5cd2[_0xe019a5(0x1333)][_0xe019a5(0x12d3)]=_0xe019a5(0x1382),_0x1f5cd2[_0xe019a5(0x1333)][_0xe019a5(0xc1c)]=_0x227d7a['reason'],_0x53d851['chats'][_0x6d36c9]=_0x1f5cd2,_0x5001a4(),await _0x184397(_0xe019a5(0x2fc),'“'+_0x1f5cd2[_0xe019a5(0x234)]+'”已向你发送好友申请。请返回聊天列表查看。')):(await _0x184397('AI决策','“'+_0x1f5cd2[_0xe019a5(0x234)]+'”思考后决定暂时不发送好友申请，将重置冷静期。'),_0x1f5cd2[_0xe019a5(0x1333)]['status']='blocked_by_user',_0x1f5cd2[_0xe019a5(0x1333)][_0xe019a5(0xde7)]=Date[_0xe019a5(0x9c1)]());}catch(_0xee957){await _0x184397(_0xe019a5(0xa7e),'为“'+_0x1f5cd2[_0xe019a5(0x234)]+_0xe019a5(0xffd)+_0xee957[_0xe019a5(0x875)]+_0xe019a5(0x7cb)),_0x1f5cd2['relationship'][_0xe019a5(0x12d3)]=_0xe019a5(0x133c),_0x1f5cd2[_0xe019a5(0x1333)]['blockedTimestamp']=Date[_0xe019a5(0x9c1)]();}finally{await _0xa62efb[_0xe019a5(0xaa3)]['put'](_0x1f5cd2),_0x60f53f(_0x6d36c9);}}function _0x19d4d9(){const _0xd1ae69=_0x13d875;if(!_0x53d851[_0xd1ae69(0x13be)])return;const _0x4721da=_0x53d851[_0xd1ae69(0xaa3)][_0x53d851[_0xd1ae69(0x13be)]];_0x4721da[_0xd1ae69(0x86e)]?_0x374dfd():document[_0xd1ae69(0x53a)](_0xd1ae69(0x6ff))[_0xd1ae69(0x1276)][_0xd1ae69(0xe13)](_0xd1ae69(0xaef));}function _0x374dfd(){const _0x5c592e=_0x13d875,_0x4431bb=document['getElementById'](_0x5c592e(0x76b)),_0x455586=_0x53d851[_0x5c592e(0xaa3)][_0x53d851['activeChatId']];document[_0x5c592e(0x53a)](_0x5c592e(0x327))['value']='',document['getElementById'](_0x5c592e(0x6e6))['value']='',document[_0x5c592e(0x53a)](_0x5c592e(0x6b0))[_0x5c592e(0x11a2)]='',document[_0x5c592e(0x53a)](_0x5c592e(0xa3f))[_0x5c592e(0x11a2)]='',document[_0x5c592e(0x53a)]('rp-direct-greeting')[_0x5c592e(0x11a2)]='',document['getElementById'](_0x5c592e(0x9b8))[_0x5c592e(0x34a)]=_0x5c592e(0x13aa),document[_0x5c592e(0x53a)]('rp-direct-total')['textContent']=_0x5c592e(0x13aa);const _0xd20e32=document[_0x5c592e(0x53a)](_0x5c592e(0xd4c));_0xd20e32[_0x5c592e(0xaac)]='',_0x455586[_0x5c592e(0x3de)][_0x5c592e(0xeaf)](_0x2db82c=>{const _0x49e755=_0x5c592e,_0xea3ef9=document[_0x49e755(0xd67)](_0x49e755(0xa1e));_0xea3ef9['value']=_0x2db82c[_0x49e755(0x543)],_0xea3ef9[_0x49e755(0x34a)]=_0x2db82c[_0x49e755(0x12bc)],_0xd20e32[_0x49e755(0x133d)](_0xea3ef9);}),document[_0x5c592e(0x53a)](_0x5c592e(0x338))[_0x5c592e(0xb2b)](),_0x4431bb[_0x5c592e(0x1276)][_0x5c592e(0xe13)]('visible');}async function _0x5dbd2c(){const _0x430468=_0x13d875,_0x31035f=_0x53d851[_0x430468(0xaa3)][_0x53d851[_0x430468(0x13be)]],_0x468c7b=parseFloat(document[_0x430468(0x53a)]('rp-group-amount')[_0x430468(0x11a2)]),_0x3af830=parseInt(document[_0x430468(0x53a)](_0x430468(0x6e6))[_0x430468(0x11a2)]),_0x210084=document[_0x430468(0x53a)]('rp-group-greeting')[_0x430468(0x11a2)][_0x430468(0x13bc)]();if(isNaN(_0x468c7b)||_0x468c7b<=0x0){alert(_0x430468(0x878));return;}if(isNaN(_0x3af830)||_0x3af830<=0x0){alert(_0x430468(0xe9d));return;}if(_0x468c7b/_0x3af830<0.01){alert(_0x430468(0x1205));return;}const _0x20b637=_0x31035f[_0x430468(0x81e)][_0x430468(0x1303)]||'我',_0x1c6693={'role':'user','senderName':_0x20b637,'type':_0x430468(0x10a0),'packetType':'lucky','timestamp':Date[_0x430468(0x9c1)](),'totalAmount':_0x468c7b,'count':_0x3af830,'greeting':_0x210084||_0x430468(0xf49),'claimedBy':{},'isFullyClaimed':![]};_0x31035f[_0x430468(0xe83)][_0x430468(0x7dd)](_0x1c6693),await _0xa62efb[_0x430468(0xaa3)][_0x430468(0x546)](_0x31035f),_0xa4d65(_0x1c6693,_0x31035f),_0x5001a4(),document[_0x430468(0x53a)](_0x430468(0x76b))['classList']['remove'](_0x430468(0xaef));}async function _0xa2eff4(){const _0xcd749a=_0x13d875,_0x3d6995=_0x53d851[_0xcd749a(0xaa3)][_0x53d851[_0xcd749a(0x13be)]],_0x16c738=parseFloat(document[_0xcd749a(0x53a)](_0xcd749a(0xa3f))[_0xcd749a(0x11a2)]),_0x425725=document['getElementById']('rp-direct-receiver')[_0xcd749a(0x11a2)],_0x2a54bf=document[_0xcd749a(0x53a)](_0xcd749a(0xed3))['value'][_0xcd749a(0x13bc)]();if(isNaN(_0x16c738)||_0x16c738<=0x0){alert(_0xcd749a(0x1018));return;}if(!_0x425725){alert('请选择一个接收人！');return;}const _0x1b217c=_0x3d6995[_0xcd749a(0x81e)][_0xcd749a(0x1303)]||'我',_0x195ffa={'role':_0xcd749a(0x10ae),'senderName':_0x1b217c,'type':'red_packet','packetType':_0xcd749a(0x985),'timestamp':Date['now'](),'totalAmount':_0x16c738,'count':0x1,'greeting':_0x2a54bf||_0xcd749a(0xd21),'receiverName':_0x425725,'claimedBy':{},'isFullyClaimed':![]};_0x3d6995[_0xcd749a(0xe83)][_0xcd749a(0x7dd)](_0x195ffa),await _0xa62efb['chats'][_0xcd749a(0x546)](_0x3d6995),_0xa4d65(_0x195ffa,_0x3d6995),_0x5001a4(),document[_0xcd749a(0x53a)]('red-packet-modal')[_0xcd749a(0x1276)][_0xcd749a(0x2d4)](_0xcd749a(0xaef));}async function _0x5273c3(_0x2f2701){const _0x58083f=_0x13d875,_0x4f6cde=_0x53d851['activeChatId'],_0x178a09=await _0xa62efb['chats'][_0x58083f(0x883)](_0x4f6cde);if(!_0x178a09)return;_0x53d851['chats'][_0x4f6cde]=_0x178a09;const _0x44c2fb=_0x178a09[_0x58083f(0xe83)]['find'](_0x34962f=>_0x34962f[_0x58083f(0x827)]===_0x2f2701);if(!_0x44c2fb)return;const _0x16fb59=_0x53d851[_0x58083f(0xa74)][_0x58083f(0x1005)]||_0x58083f(0x8ac),_0x3c4bd2=_0x44c2fb[_0x58083f(0x115a)]&&_0x44c2fb[_0x58083f(0x115a)][_0x16fb59];if(_0x44c2fb[_0x58083f(0x67e)]===_0x58083f(0x985)&&_0x44c2fb[_0x58083f(0x44a)]!==_0x16fb59&&Object[_0x58083f(0x1350)](_0x44c2fb['claimedBy'])[_0x58083f(0x29d)]>0x0||_0x44c2fb[_0x58083f(0x70f)]||_0x3c4bd2){_0x59dbb8(_0x44c2fb);return;}const _0x18092d=await _0x5d3c77(_0x44c2fb);_0x18092d!==null&&(await _0x60f53f(_0x4f6cde),await _0x184397(_0x58083f(0x1420),_0x58083f(0x10c6)+_0xf33fb2(_0x178a09,_0x44c2fb[_0x58083f(0xbee)])+'\x20的红包，金额为\x20'+_0x18092d[_0x58083f(0x39e)](0x2)+_0x58083f(0xaea)));const _0x3fc19c=_0x53d851[_0x58083f(0xaa3)][_0x4f6cde][_0x58083f(0xe83)][_0x58083f(0x397)](_0x412834=>_0x412834['timestamp']===_0x2f2701);_0x3fc19c&&_0x59dbb8(_0x3fc19c);}async function _0x5d3c77(_0x1b9261){const _0x268e23=_0x13d875,_0x5d5b09=_0x53d851[_0x268e23(0xaa3)][_0x53d851[_0x268e23(0x13be)]];let _0x237336=Date[_0x268e23(0x9c1)]();const _0x28a9ef=_0x53d851[_0x268e23(0xa74)][_0x268e23(0x1005)]||'{{user}}',_0x43c284=_0x1b9261[_0x268e23(0x1003)]-Object['keys'](_0x1b9261[_0x268e23(0x115a)]||{})[_0x268e23(0x29d)];if(_0x43c284<=0x0)return _0x1b9261['isFullyClaimed']=!![],await _0xa62efb[_0x268e23(0xaa3)][_0x268e23(0x546)](_0x5d5b09),await _0x184397(_0x268e23(0x656),'红包已被领完！'),null;let _0x2e1ce6=0x0;const _0x3b74ed=_0x1b9261[_0x268e23(0x820)]-Object[_0x268e23(0x244)](_0x1b9261[_0x268e23(0x115a)]||{})['reduce']((_0x1c0fe7,_0x3a1e40)=>_0x1c0fe7+_0x3a1e40,0x0);if(_0x1b9261[_0x268e23(0x67e)]==='lucky'){if(_0x43c284===0x1)_0x2e1ce6=_0x3b74ed;else{const _0x1e6c4a=0.01,_0x4c0af0=_0x3b74ed-(_0x43c284-0x1)*_0x1e6c4a;_0x2e1ce6=Math[_0x268e23(0xac4)]()*(_0x4c0af0-_0x1e6c4a)+_0x1e6c4a;}}else _0x2e1ce6=_0x1b9261['totalAmount'];_0x2e1ce6=parseFloat(_0x2e1ce6['toFixed'](0x2));if(!_0x1b9261['claimedBy'])_0x1b9261['claimedBy']={};_0x1b9261[_0x268e23(0x115a)][_0x28a9ef]=_0x2e1ce6;const _0x2785e1=Object[_0x268e23(0x1350)](_0x1b9261['claimedBy'])['length']>=_0x1b9261[_0x268e23(0x1003)];_0x2785e1&&(_0x1b9261[_0x268e23(0x70f)]=!![]);const _0x1a1b43=_0xf33fb2(_0x5d5b09,_0x28a9ef),_0x1faf4d=_0xf33fb2(_0x5d5b09,_0x1b9261['senderName']),_0xd35a0d={'role':_0x268e23(0xab3),'type':'pat_message','content':_0x268e23(0x10c6)+_0x1faf4d+_0x268e23(0x10b5),'timestamp':_0x237336++};_0x5d5b09[_0x268e23(0xe83)]['push'](_0xd35a0d);let _0xd9764c;if(_0x2785e1){const _0x4622e4={'role':_0x268e23(0xab3),'type':'pat_message','content':_0x1faf4d+_0x268e23(0x31d),'timestamp':_0x237336++};_0x5d5b09['history'][_0x268e23(0x7dd)](_0x4622e4);let _0x3de76e={'name':'','amount':-0x1};_0x1b9261[_0x268e23(0x67e)]===_0x268e23(0x87a)&&_0x1b9261[_0x268e23(0x1003)]>0x1&&Object[_0x268e23(0xfdc)](_0x1b9261[_0x268e23(0x115a)])[_0x268e23(0xeaf)](([_0x57c2cc,_0x43bf04])=>{const _0x42060e=_0x268e23;_0x43bf04>_0x3de76e[_0x42060e(0x1146)]&&(_0x3de76e={'name':_0x57c2cc,'amount':_0x43bf04});});const _0x183967=_0x3de76e['name']?_0xf33fb2(_0x5d5b09,_0x3de76e[_0x268e23(0x234)]):'无';_0xd9764c='[系统提示：用户\x20('+_0x1a1b43+_0x268e23(0x134d)+_0x183967+'！请对此事件发表评论。]';}else _0xd9764c=_0x268e23(0x6cc)+_0x1a1b43+_0x268e23(0x56d)+_0x1b9261['timestamp']+_0x268e23(0x104e);const _0x5b602d={'role':_0x268e23(0xab3),'content':_0xd9764c,'timestamp':_0x237336++,'isHidden':!![]};return _0x5d5b09['history'][_0x268e23(0x7dd)](_0x5b602d),await _0xa62efb[_0x268e23(0xaa3)][_0x268e23(0x546)](_0x5d5b09),_0x2e1ce6;}async function _0x59dbb8(_0x1ae3fa){const _0x59f4ec=_0x13d875;if(!_0x1ae3fa){console['error'](_0x59f4ec(0xf70));return;}const _0x30f8d0=_0x53d851['chats'][_0x53d851[_0x59f4ec(0x13be)]];if(!_0x30f8d0)return;const _0x3037bc=document['getElementById']('red-packet-details-modal'),_0x484ffb=_0x53d851[_0x59f4ec(0xa74)][_0x59f4ec(0x1005)]||_0x59f4ec(0x8ac),_0x199a5d=_0xf33fb2(_0x30f8d0,_0x1ae3fa[_0x59f4ec(0xbee)]);document[_0x59f4ec(0x53a)](_0x59f4ec(0x8a4))['textContent']=_0x199a5d,document[_0x59f4ec(0x53a)](_0x59f4ec(0xe6f))['textContent']=_0x1ae3fa[_0x59f4ec(0xfa8)]||_0x59f4ec(0xf49);const _0x4732e0=document[_0x59f4ec(0x53a)]('rp-details-my-amount');_0x1ae3fa['claimedBy']&&_0x1ae3fa[_0x59f4ec(0x115a)][_0x484ffb]?(_0x4732e0[_0x59f4ec(0x139c)]('span:first-child')[_0x59f4ec(0x34a)]=_0x1ae3fa[_0x59f4ec(0x115a)][_0x484ffb][_0x59f4ec(0x39e)](0x2),_0x4732e0[_0x59f4ec(0x1284)][_0x59f4ec(0x11d9)]='block'):_0x4732e0[_0x59f4ec(0x1284)]['display']=_0x59f4ec(0xbf2);const _0x496b90=Object[_0x59f4ec(0x1350)](_0x1ae3fa[_0x59f4ec(0x115a)]||{})[_0x59f4ec(0x29d)],_0x4377d0=Object['values'](_0x1ae3fa['claimedBy']||{})[_0x59f4ec(0xae0)]((_0x107655,_0xe99669)=>_0x107655+_0xe99669,0x0);let _0x1a1c93=_0x496b90+'/'+_0x1ae3fa[_0x59f4ec(0x1003)]+_0x59f4ec(0x2e0)+_0x4377d0['toFixed'](0x2)+'/'+_0x1ae3fa[_0x59f4ec(0x820)][_0x59f4ec(0x39e)](0x2)+'元。';if(!_0x1ae3fa['isFullyClaimed']&&_0x496b90<_0x1ae3fa[_0x59f4ec(0x1003)]){const _0x36944c=Math[_0x59f4ec(0x7d5)]((_0x1ae3fa['timestamp']+0x18*0x3c*0x3c*0x3e8-Date[_0x59f4ec(0x9c1)]())/(0x3e8*0x3c*0x3c));if(_0x36944c>0x0)_0x1a1c93+=_0x59f4ec(0x7d3)+_0x36944c+'小时内退还。';}document[_0x59f4ec(0x53a)](_0x59f4ec(0x6f4))[_0x59f4ec(0x34a)]=_0x1a1c93;const _0x35894a=document[_0x59f4ec(0x53a)](_0x59f4ec(0x348));_0x35894a[_0x59f4ec(0xaac)]='';const _0x446f6d=Object[_0x59f4ec(0xfdc)](_0x1ae3fa[_0x59f4ec(0x115a)]||{});let _0x2504c7={'name':'','amount':-0x1};_0x1ae3fa[_0x59f4ec(0x67e)]==='lucky'&&_0x1ae3fa[_0x59f4ec(0x70f)]&&_0x446f6d[_0x59f4ec(0x29d)]>0x1&&_0x446f6d[_0x59f4ec(0xeaf)](([_0x5d3225,_0x5b85b0])=>{const _0x368609=_0x59f4ec;_0x5b85b0>_0x2504c7[_0x368609(0x1146)]&&(_0x2504c7={'name':_0x5d3225,'amount':_0x5b85b0});}),_0x446f6d['sort']((_0x1cbf88,_0x2ba0dc)=>_0x2ba0dc[0x1]-_0x1cbf88[0x1]),_0x446f6d['forEach'](([_0x3979ff,_0x146de3])=>{const _0x436360=_0x59f4ec,_0x1f6568=document['createElement']('div');_0x1f6568['className']=_0x436360(0x239);let _0x2c8808='';_0x2504c7[_0x436360(0x234)]&&_0x3979ff===_0x2504c7['name']&&(_0x2c8808=_0x436360(0x69d));const _0x58039f=_0xf33fb2(_0x30f8d0,_0x3979ff);_0x1f6568[_0x436360(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x58039f+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>'+_0x146de3[_0x436360(0x39e)](0x2)+_0x436360(0x1375)+_0x2c8808+_0x436360(0x95c),_0x35894a['appendChild'](_0x1f6568);}),_0x3037bc['classList'][_0x59f4ec(0xe13)](_0x59f4ec(0xaef));}document[_0x13d875(0x53a)]('close-rp-details-btn')['addEventListener'](_0x13d875(0xb2b),()=>{const _0x6551fe=_0x13d875;document[_0x6551fe(0x53a)](_0x6551fe(0x10e0))['classList'][_0x6551fe(0x2d4)](_0x6551fe(0xaef));}),window[_0x13d875(0x5ca)]=_0x5273c3;function _0x1750bb(){const _0x3a82ca=_0x13d875,_0x10264d=document['getElementById'](_0x3a82ca(0x98d));document['getElementById'](_0x3a82ca(0xfd0))['value']='';const _0x13c4d8=document[_0x3a82ca(0x53a)](_0x3a82ca(0xc66));_0x13c4d8[_0x3a82ca(0xaac)]='',_0x2f736e(),_0x2f736e(),_0x10264d['classList'][_0x3a82ca(0xe13)]('visible');}function _0x2f736e(){const _0x275c31=_0x13d875,_0x44a497=document[_0x275c31(0x53a)](_0x275c31(0xc66)),_0x429133=document[_0x275c31(0xd67)]('div');_0x429133[_0x275c31(0x6de)]=_0x275c31(0x12af),_0x429133[_0x275c31(0xaac)]=_0x275c31(0xd2b),_0x429133[_0x275c31(0x139c)]('.remove-option-btn')[_0x275c31(0x1086)]('click',()=>{const _0x4b5436=_0x275c31;_0x44a497[_0x4b5436(0x6cd)][_0x4b5436(0x29d)]>0x2?_0x429133[_0x4b5436(0x2d4)]():alert(_0x4b5436(0xeeb));}),_0x44a497[_0x275c31(0x133d)](_0x429133);}async function _0xd1d89(){const _0x30a691=_0x13d875;if(!_0x53d851['activeChatId'])return;const _0x4b685d=document[_0x30a691(0x53a)](_0x30a691(0xfd0))[_0x30a691(0x11a2)][_0x30a691(0x13bc)]();if(!_0x4b685d){alert(_0x30a691(0xb26));return;}const _0x43d7d1=Array[_0x30a691(0xd97)](document['querySelectorAll'](_0x30a691(0x83c)))['map'](_0x52f4ef=>_0x52f4ef[_0x30a691(0x11a2)][_0x30a691(0x13bc)]())[_0x30a691(0x2dd)](_0x3d3dc6=>_0x3d3dc6);if(_0x43d7d1[_0x30a691(0x29d)]<0x2){alert(_0x30a691(0xcee));return;}const _0x1b6c55=_0x53d851['chats'][_0x53d851[_0x30a691(0x13be)]],_0x217b29=_0x1b6c55[_0x30a691(0x86e)]?_0x1b6c55[_0x30a691(0x81e)][_0x30a691(0x1303)]||'我':'我',_0x138b9d={'role':'user','senderName':_0x217b29,'type':_0x30a691(0xf2e),'timestamp':Date[_0x30a691(0x9c1)](),'question':_0x4b685d,'options':_0x43d7d1,'votes':{},'isClosed':![]};_0x1b6c55[_0x30a691(0xe83)][_0x30a691(0x7dd)](_0x138b9d),await _0xa62efb[_0x30a691(0xaa3)]['put'](_0x1b6c55),_0xa4d65(_0x138b9d,_0x1b6c55),_0x5001a4(),document['getElementById']('create-poll-modal')['classList'][_0x30a691(0x2d4)](_0x30a691(0xaef));}async function _0x23575e(_0x5f08d5,_0x3d556e){const _0x28e566=_0x13d875,_0x2f6c08=_0x53d851[_0x28e566(0xaa3)][_0x53d851[_0x28e566(0x13be)]],_0x87a961=_0x2f6c08[_0x28e566(0xe83)][_0x28e566(0x397)](_0x8602bd=>_0x8602bd['timestamp']===_0x5f08d5),_0x1f0295=_0x2f6c08[_0x28e566(0x86e)]?_0x2f6c08[_0x28e566(0x81e)]['myNickname']||'我':'我';if(!_0x87a961||_0x87a961[_0x28e566(0xb1f)]){_0x87a961&&_0x87a961[_0x28e566(0xb1f)]&&_0x5f4404(_0x5f08d5);return;}const _0x170b77=_0x87a961[_0x28e566(0x771)][_0x3d556e]&&_0x87a961[_0x28e566(0x771)][_0x3d556e][_0x28e566(0x6e9)](_0x1f0295);if(!_0x170b77){for(const _0x55e977 in _0x87a961[_0x28e566(0x771)]){const _0x26de5b=_0x87a961['votes'][_0x55e977]['indexOf'](_0x1f0295);_0x26de5b>-0x1&&_0x87a961[_0x28e566(0x771)][_0x55e977]['splice'](_0x26de5b,0x1);}!_0x87a961['votes'][_0x3d556e]&&(_0x87a961[_0x28e566(0x771)][_0x3d556e]=[]),_0x87a961[_0x28e566(0x771)][_0x3d556e][_0x28e566(0x7dd)](_0x1f0295);}let _0x35d76c=null;!_0x170b77&&(_0x35d76c=_0x28e566(0x6cc)+_0x1f0295+_0x28e566(0x416)+_0x3d556e+_0x28e566(0xcef));if(_0x35d76c){const _0x2ab5f0={'role':_0x28e566(0xab3),'content':_0x35d76c,'timestamp':Date['now'](),'isHidden':!![]};_0x2f6c08[_0x28e566(0xe83)][_0x28e566(0x7dd)](_0x2ab5f0);}await _0xa62efb['chats'][_0x28e566(0x546)](_0x2f6c08),_0x60f53f(_0x53d851[_0x28e566(0x13be)]);}async function _0x4f7223(_0x3f6a48){const _0x436b2f=_0x13d875,_0x58eee4=_0x53d851[_0x436b2f(0xaa3)][_0x53d851['activeChatId']],_0x393f0f=_0x58eee4[_0x436b2f(0xe83)][_0x436b2f(0x397)](_0x2a1825=>_0x2a1825[_0x436b2f(0x827)]===_0x3f6a48);if(!_0x393f0f||_0x393f0f['isClosed'])return;const _0x182c28=await _0x355fc0(_0x436b2f(0xbc7),_0x436b2f(0x81a));if(_0x182c28){_0x393f0f['isClosed']=!![];const _0x192539=_0x393f0f['options'][_0x436b2f(0xcb4)](_0x596142=>'“'+_0x596142+'”('+(_0x393f0f['votes'][_0x596142]?.[_0x436b2f(0x29d)]||0x0)+'票)')[_0x436b2f(0x2c8)]('，'),_0x4a3b7f=_0x436b2f(0x1044)+_0x192539+'。]',_0x962e0a={'role':'system','content':_0x4a3b7f,'timestamp':Date[_0x436b2f(0x9c1)](),'isHidden':!![]};_0x58eee4[_0x436b2f(0xe83)]['push'](_0x962e0a),await _0xa62efb[_0x436b2f(0xaa3)][_0x436b2f(0x546)](_0x58eee4),_0x60f53f(_0x53d851[_0x436b2f(0x13be)]);}}function _0x5f4404(_0x3b46e0){const _0x503eae=_0x13d875,_0x57af85=_0x53d851[_0x503eae(0xaa3)][_0x53d851[_0x503eae(0x13be)]],_0x498f83=_0x57af85[_0x503eae(0xe83)]['find'](_0x5196fe=>_0x5196fe[_0x503eae(0x827)]===_0x3b46e0);if(!_0x498f83||!_0x498f83[_0x503eae(0xb1f)])return;let _0x2dc226=_0x503eae(0x12f9)+_0x498f83[_0x503eae(0xd1d)]+_0x503eae(0x1f1);Object[_0x503eae(0x1350)](_0x498f83[_0x503eae(0x771)])['length']===0x0?_0x2dc226+=_0x503eae(0xed0):_0x498f83[_0x503eae(0x473)][_0x503eae(0xeaf)](_0x1be830=>{const _0x54c56d=_0x503eae,_0xd07790=_0x498f83[_0x54c56d(0x771)][_0x1be830]||[],_0x4dff46=_0xd07790[_0x54c56d(0xcb4)](_0x4e32a8=>_0xf33fb2(_0x57af85,_0x4e32a8))[_0x54c56d(0x2c8)]('、\x20');_0x2dc226+=_0x54c56d(0x531)+_0x1be830+'\x20('+_0xd07790[_0x54c56d(0x29d)]+_0x54c56d(0xdfe)+(_0xd07790['length']>0x0?_0x4dff46:_0x54c56d(0x56b))+_0x54c56d(0x570);}),_0x184397('投票结果',_0x2dc226);}function _0x305fab(){const _0x270961=_0x13d875;if(!_0x53d851[_0x270961(0x13be)])return;const _0x5d0f48=_0x53d851[_0x270961(0xaa3)][_0x53d851['activeChatId']];document[_0x270961(0x53a)]('ai-avatar-library-title')[_0x270961(0x34a)]='“'+_0x5d0f48[_0x270961(0x234)]+_0x270961(0x7c6),_0x4ebba7(),document[_0x270961(0x53a)](_0x270961(0xc4a))[_0x270961(0x1276)][_0x270961(0xe13)](_0x270961(0xaef));}function _0x4ebba7(){const _0x1a7a0f=_0x13d875,_0x562ce2=document['getElementById'](_0x1a7a0f(0x247));_0x562ce2[_0x1a7a0f(0xaac)]='';const _0x78e6b8=_0x53d851[_0x1a7a0f(0xaa3)][_0x53d851[_0x1a7a0f(0x13be)]],_0x47e9e6=_0x78e6b8[_0x1a7a0f(0x81e)][_0x1a7a0f(0x78e)]||[];if(_0x47e9e6[_0x1a7a0f(0x29d)]===0x0){_0x562ce2[_0x1a7a0f(0xaac)]=_0x1a7a0f(0x142e);return;}_0x47e9e6[_0x1a7a0f(0xeaf)]((_0x7d99f6,_0x2b6050)=>{const _0x1ca7b3=_0x1a7a0f,_0x20651e=document[_0x1ca7b3(0xd67)](_0x1ca7b3(0x1425));_0x20651e[_0x1ca7b3(0x6de)]='sticker-item',_0x20651e['title']=_0x7d99f6[_0x1ca7b3(0x234)],_0x20651e['innerHTML']=_0x1ca7b3(0x865)+_0x7d99f6[_0x1ca7b3(0xb36)]+_0x1ca7b3(0x1296)+_0x7d99f6[_0x1ca7b3(0x234)]+_0x1ca7b3(0x1378);const _0x16e01f=document[_0x1ca7b3(0xd67)]('div');_0x16e01f[_0x1ca7b3(0x6de)]=_0x1ca7b3(0x2e3),_0x16e01f['innerHTML']='×',_0x16e01f[_0x1ca7b3(0x1284)]['display']=_0x1ca7b3(0x1ea),_0x16e01f[_0x1ca7b3(0x12f2)]=async _0x5d8e9e=>{const _0x1a4954=_0x1ca7b3;_0x5d8e9e[_0x1a4954(0xecc)]();const _0x4bc57d=await _0x355fc0(_0x1a4954(0x8f1),_0x1a4954(0x81b)+_0x7d99f6[_0x1a4954(0x234)]+_0x1a4954(0x342),{'confirmButtonClass':_0x1a4954(0x264)});_0x4bc57d&&(_0x78e6b8[_0x1a4954(0x81e)][_0x1a4954(0x78e)][_0x1a4954(0x1331)](_0x2b6050,0x1),await _0xa62efb[_0x1a4954(0xaa3)][_0x1a4954(0x546)](_0x78e6b8),_0x4ebba7());},_0x20651e[_0x1ca7b3(0x133d)](_0x16e01f),_0x562ce2[_0x1ca7b3(0x133d)](_0x20651e);});}async function _0x4c840e(){const _0x478095=_0x13d875,_0x2c022c=await _0x4f6537('添加头像','请为这个头像起个名字（例如：开心、哭泣）');if(!_0x2c022c||!_0x2c022c[_0x478095(0x13bc)]())return;const _0x41d784=await _0x4f6537(_0x478095(0x13df),_0x478095(0x87c),'',_0x478095(0xb36));if(!_0x41d784||!_0x41d784[_0x478095(0x13bc)]()[_0x478095(0x1200)]('http')){alert(_0x478095(0x851));return;}const _0x6fa76f=_0x53d851[_0x478095(0xaa3)][_0x53d851[_0x478095(0x13be)]];!_0x6fa76f['settings']['aiAvatarLibrary']&&(_0x6fa76f['settings'][_0x478095(0x78e)]=[]),_0x6fa76f[_0x478095(0x81e)]['aiAvatarLibrary'][_0x478095(0x7dd)]({'name':_0x2c022c[_0x478095(0x13bc)](),'url':_0x41d784[_0x478095(0x13bc)]()}),await _0xa62efb[_0x478095(0xaa3)][_0x478095(0x546)](_0x6fa76f),_0x4ebba7();}function _0x4a890d(){const _0x4dcfe4=_0x13d875;document[_0x4dcfe4(0x53a)](_0x4dcfe4(0xc4a))['classList'][_0x4dcfe4(0x2d4)](_0x4dcfe4(0xaef));}function _0x25be2c(){const _0x4174f5=_0x13d875;if(!_0x53d851[_0x4174f5(0x13be)])return;const _0x36411a=_0x53d851[_0x4174f5(0xaa3)][_0x53d851[_0x4174f5(0x13be)]];document['getElementById'](_0x4174f5(0x8c4))[_0x4174f5(0x34a)]='“'+(_0x36411a[_0x4174f5(0x81e)]['myNickname']||'我')+_0x4174f5(0x7c6),_0x4e118b(),document[_0x4174f5(0x53a)]('my-avatar-library-modal')[_0x4174f5(0x1276)][_0x4174f5(0xe13)](_0x4174f5(0xaef));}function _0x4e118b(){const _0x5d609c=_0x13d875,_0x4dd45b=document[_0x5d609c(0x53a)](_0x5d609c(0xc68));_0x4dd45b[_0x5d609c(0xaac)]='';const _0x5115cf=_0x53d851[_0x5d609c(0xaa3)][_0x53d851['activeChatId']],_0xf793=_0x5115cf[_0x5d609c(0x81e)][_0x5d609c(0xd0e)]||[];if(_0xf793[_0x5d609c(0x29d)]===0x0){_0x4dd45b[_0x5d609c(0xaac)]=_0x5d609c(0x142e);return;}_0xf793[_0x5d609c(0xeaf)]((_0x5e7daa,_0x2a5210)=>{const _0x908494=_0x5d609c,_0x23666d=document['createElement']('div');_0x23666d[_0x908494(0x6de)]=_0x908494(0x73f),_0x23666d[_0x908494(0x667)]=_0x5e7daa[_0x908494(0x234)],_0x23666d[_0x908494(0xaac)]=_0x908494(0x865)+_0x5e7daa[_0x908494(0xb36)]+_0x908494(0x1296)+_0x5e7daa[_0x908494(0x234)]+_0x908494(0x1378);const _0x356b8d=document[_0x908494(0xd67)]('div');_0x356b8d[_0x908494(0x6de)]=_0x908494(0x2e3),_0x356b8d[_0x908494(0xaac)]='×',_0x356b8d['style']['display']=_0x908494(0x1ea),_0x356b8d[_0x908494(0x12f2)]=async _0x298034=>{const _0x176122=_0x908494;_0x298034[_0x176122(0xecc)]();const _0x571982=await _0x355fc0('删除头像',_0x176122(0xf09)+_0x5e7daa['name']+'”吗？',{'confirmButtonClass':_0x176122(0x264)});_0x571982&&(_0x5115cf[_0x176122(0x81e)][_0x176122(0xd0e)]['splice'](_0x2a5210,0x1),await _0xa62efb['chats'][_0x176122(0x546)](_0x5115cf),_0x4e118b());},_0x23666d[_0x908494(0x133d)](_0x356b8d),_0x4dd45b['appendChild'](_0x23666d);});}async function _0x753a66(){const _0x4d01e1=_0x13d875,_0x2a3907=await _0x4f6537(_0x4d01e1(0x13df),_0x4d01e1(0x582));if(!_0x2a3907||!_0x2a3907[_0x4d01e1(0x13bc)]())return;const _0x1bb762=await _0x4f6537(_0x4d01e1(0x13df),_0x4d01e1(0x87c),'',_0x4d01e1(0xb36));if(!_0x1bb762||!_0x1bb762[_0x4d01e1(0x13bc)]()[_0x4d01e1(0x1200)](_0x4d01e1(0xbdc))){alert(_0x4d01e1(0x851));return;}const _0x138368=_0x53d851['chats'][_0x53d851['activeChatId']];!_0x138368[_0x4d01e1(0x81e)]['myAvatarLibrary']&&(_0x138368[_0x4d01e1(0x81e)][_0x4d01e1(0xd0e)]=[]),_0x138368['settings']['myAvatarLibrary'][_0x4d01e1(0x7dd)]({'name':_0x2a3907['trim'](),'url':_0x1bb762[_0x4d01e1(0x13bc)]()}),await _0xa62efb[_0x4d01e1(0xaa3)][_0x4d01e1(0x546)](_0x138368),_0x4e118b();}async function _0x139e68(_0x2c5080){const _0x4568e3=_0x13d875,_0x1f7a03=_0x2c5080['target'][_0x4568e3(0x1413)][0x0];if(!_0x1f7a03)return;const _0x392ee8=await new Promise(_0x1e2aa0=>{const _0x5d24e0=_0x4568e3,_0x521a1a=new FileReader();_0x521a1a[_0x5d24e0(0x110f)]=()=>_0x1e2aa0(_0x521a1a[_0x5d24e0(0xa2a)]),_0x521a1a[_0x5d24e0(0x13b6)](_0x1f7a03);}),_0x5c6d0b=await _0x4f6537(_0x4568e3(0x13f2),'请为这个新头像命名');if(!_0x5c6d0b||!_0x5c6d0b[_0x4568e3(0x13bc)]())return;const _0x377e54=_0x53d851['chats'][_0x53d851[_0x4568e3(0x13be)]];!_0x377e54[_0x4568e3(0x81e)][_0x4568e3(0xd0e)]&&(_0x377e54[_0x4568e3(0x81e)]['myAvatarLibrary']=[]),_0x377e54[_0x4568e3(0x81e)][_0x4568e3(0xd0e)][_0x4568e3(0x7dd)]({'name':_0x5c6d0b[_0x4568e3(0x13bc)](),'url':_0x392ee8}),await _0xa62efb[_0x4568e3(0xaa3)][_0x4568e3(0x546)](_0x377e54),_0x4e118b(),_0x2c5080['target'][_0x4568e3(0x11a2)]=null;}async function _0x5dd556(_0x39c9ad){const _0x4b16dc=_0x13d875,_0x36ae96=_0x53d851[_0x4b16dc(0xaa3)][_0x53d851[_0x4b16dc(0x13be)]];if(!_0x36ae96)return;const _0x9fe591=_0x39c9ad[_0x4b16dc(0x13bc)]()[_0x4b16dc(0x13e8)]('\x0a'),_0x43a7b1=[],_0x1ecbc3=_0x4b16dc(0xa09);let _0x353924=0x0;for(const _0x59a759 of _0x9fe591){const _0x78cae3=_0x59a759[_0x4b16dc(0x13bc)]();if(!_0x78cae3||_0x78cae3[_0x4b16dc(0x6e9)]('http')||_0x78cae3[_0x4b16dc(0x6e9)]('填入'))continue;let _0x512d40=null,_0x4963ba=null;const _0x225f4e=_0x78cae3[_0x4b16dc(0x1120)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x225f4e)_0x512d40=_0x225f4e[0x1],_0x4963ba=_0x225f4e[0x2];else{const _0x1dc6ae=_0x78cae3[_0x4b16dc(0x13e8)](/\s+/);_0x1dc6ae[_0x4b16dc(0x29d)]>=0x2&&(_0x4963ba=_0x1dc6ae['pop'](),_0x512d40=_0x1dc6ae[_0x4b16dc(0x2c8)]('\x20'));}_0x512d40&&_0x4963ba&&_0x4963ba[_0x4b16dc(0x6e9)]('.')?_0x43a7b1[_0x4b16dc(0x7dd)]({'name':_0x512d40,'url':_0x1ecbc3+_0x4963ba}):_0x353924++;}if(_0x353924>0x0)await _0x184397(_0x4b16dc(0xe2a),'有\x20'+_0x353924+_0x4b16dc(0xc8e));if(_0x43a7b1[_0x4b16dc(0x29d)]>0x0){if(!_0x36ae96[_0x4b16dc(0x81e)][_0x4b16dc(0xd0e)])_0x36ae96[_0x4b16dc(0x81e)][_0x4b16dc(0xd0e)]=[];_0x36ae96['settings'][_0x4b16dc(0xd0e)][_0x4b16dc(0x7dd)](..._0x43a7b1),await _0xa62efb[_0x4b16dc(0xaa3)][_0x4b16dc(0x546)](_0x36ae96),_0x4e118b(),await _0x184397('导入成功',_0x4b16dc(0x1364)+_0x43a7b1[_0x4b16dc(0x29d)]+'\x20个新头像！');}else _0x353924===0x0&&alert('没有找到可导入的内容。');}function _0x5516fa(){const _0x4567c8=_0x13d875;document['getElementById']('my-avatar-library-modal')[_0x4567c8(0x1276)][_0x4567c8(0x2d4)](_0x4567c8(0xaef));}function _0x1342f6(){const _0x4e3c42=_0x13d875;if(!_0x53d851['activeChatId'])return;const _0x47e9df=_0x53d851['chats'][_0x53d851['activeChatId']];document[_0x4e3c42(0x53a)]('group-avatar-library-title')[_0x4e3c42(0x34a)]='“'+_0x47e9df['name']+'”的头像库',_0x179606(),document[_0x4e3c42(0x53a)](_0x4e3c42(0x13ef))[_0x4e3c42(0x1276)]['add']('visible');}function _0x179606(){const _0x2664fd=_0x13d875,_0x317999=document['getElementById'](_0x2664fd(0x518));_0x317999[_0x2664fd(0xaac)]='';const _0x5115f5=_0x53d851[_0x2664fd(0xaa3)][_0x53d851[_0x2664fd(0x13be)]],_0x233af3=_0x5115f5[_0x2664fd(0x81e)][_0x2664fd(0x523)]||[];if(_0x233af3['length']===0x0){_0x317999[_0x2664fd(0xaac)]=_0x2664fd(0x142e);return;}_0x233af3['forEach']((_0x49cdaa,_0x107fa0)=>{const _0xb0f1e2=_0x2664fd,_0x4417da=document[_0xb0f1e2(0xd67)](_0xb0f1e2(0x1425));_0x4417da[_0xb0f1e2(0x6de)]=_0xb0f1e2(0x73f),_0x4417da[_0xb0f1e2(0x667)]=_0x49cdaa['name'],_0x4417da[_0xb0f1e2(0xaac)]=_0xb0f1e2(0x865)+_0x49cdaa[_0xb0f1e2(0xb36)]+');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>'+_0x49cdaa['name']+_0xb0f1e2(0x1378);const _0x35be26=document[_0xb0f1e2(0xd67)](_0xb0f1e2(0x1425));_0x35be26['className']='delete-btn',_0x35be26[_0xb0f1e2(0xaac)]='×',_0x35be26[_0xb0f1e2(0x1284)][_0xb0f1e2(0x11d9)]='block',_0x35be26[_0xb0f1e2(0x12f2)]=async _0x4a32f9=>{const _0x404c3a=_0xb0f1e2;_0x4a32f9[_0x404c3a(0xecc)]();const _0x5e86f0=await _0x355fc0(_0x404c3a(0x8f1),'确定要从头像库中删除“'+_0x49cdaa[_0x404c3a(0x234)]+'”吗？',{'confirmButtonClass':_0x404c3a(0x264)});_0x5e86f0&&(_0x5115f5[_0x404c3a(0x81e)]['groupAvatarLibrary'][_0x404c3a(0x1331)](_0x107fa0,0x1),await _0xa62efb[_0x404c3a(0xaa3)][_0x404c3a(0x546)](_0x5115f5),_0x179606());},_0x4417da['appendChild'](_0x35be26),_0x317999[_0xb0f1e2(0x133d)](_0x4417da);});}async function _0x298615(){const _0x3913fb=_0x13d875,_0x3213e8=await _0x4f6537(_0x3913fb(0x13df),'请为这个头像起个名字（例如：春日野餐、学习时间）');if(!_0x3213e8||!_0x3213e8[_0x3913fb(0x13bc)]())return;const _0x11364d=await _0x4f6537(_0x3913fb(0x13df),'请输入头像的图片URL','','url');if(!_0x11364d||!_0x11364d[_0x3913fb(0x13bc)]()[_0x3913fb(0x1200)](_0x3913fb(0xbdc))){alert(_0x3913fb(0x851));return;}const _0x38c81c=_0x53d851[_0x3913fb(0xaa3)][_0x53d851[_0x3913fb(0x13be)]];!_0x38c81c['settings'][_0x3913fb(0x523)]&&(_0x38c81c['settings']['groupAvatarLibrary']=[]),_0x38c81c[_0x3913fb(0x81e)][_0x3913fb(0x523)][_0x3913fb(0x7dd)]({'name':_0x3213e8[_0x3913fb(0x13bc)](),'url':_0x11364d['trim']()}),await _0xa62efb[_0x3913fb(0xaa3)][_0x3913fb(0x546)](_0x38c81c),_0x179606();}function _0x8ec3a8(){const _0x5b79b6=_0x13d875;document[_0x5b79b6(0x53a)](_0x5b79b6(0x13ef))['classList'][_0x5b79b6(0x2d4)](_0x5b79b6(0xaef));}async function _0x47027b(_0x93aef6){const _0x2c6834=_0x13d875,_0x53a0ea=_0x2c6834(0xd5b),_0x1606b=await _0x4f6537('批量导入头像',_0x53a0ea,'',_0x2c6834(0x728));_0x1606b&&_0x1606b['trim']()&&await _0x27d9cb(_0x93aef6,_0x1606b);}async function _0x27d9cb(_0x55eb19,_0x407671){const _0x2d32a7=_0x13d875,_0x2be8f2=_0x53d851[_0x2d32a7(0xaa3)][_0x53d851[_0x2d32a7(0x13be)]];if(!_0x2be8f2)return;const _0x2b94d5=_0x407671[_0x2d32a7(0x13bc)]()[_0x2d32a7(0x13e8)]('\x0a'),_0x4cd4aa=[],_0x4099fa='https://files.catbox.moe/';let _0xe1f1ad=0x0;for(const _0x41186d of _0x2b94d5){const _0x4c130c=_0x41186d[_0x2d32a7(0x13bc)]();if(!_0x4c130c||_0x4c130c[_0x2d32a7(0x6e9)](_0x2d32a7(0xbdc))||_0x4c130c[_0x2d32a7(0x6e9)]('填入'))continue;let _0x5b65ea=null,_0x51fcb4=null;const _0x51674c=_0x4c130c['match'](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x51674c)_0x5b65ea=_0x51674c[0x1],_0x51fcb4=_0x51674c[0x2];else{const _0x432267=_0x4c130c[_0x2d32a7(0x13e8)](/\s+/);_0x432267[_0x2d32a7(0x29d)]>=0x2&&(_0x51fcb4=_0x432267[_0x2d32a7(0x51a)](),_0x5b65ea=_0x432267[_0x2d32a7(0x2c8)]('\x20'));}_0x5b65ea&&_0x51fcb4&&_0x51fcb4[_0x2d32a7(0x6e9)]('.')?_0x4cd4aa['push']({'name':_0x5b65ea,'url':_0x4099fa+_0x51fcb4}):(_0xe1f1ad++,console['warn'](_0x2d32a7(0x8d8),_0x4c130c));}_0xe1f1ad>0x0&&await _0x184397(_0x2d32a7(0xe2a),'有\x20'+_0xe1f1ad+_0x2d32a7(0x1093));if(_0x4cd4aa[_0x2d32a7(0x29d)]>0x0){if(_0x55eb19==='ai'){if(!_0x2be8f2[_0x2d32a7(0x81e)][_0x2d32a7(0x78e)])_0x2be8f2[_0x2d32a7(0x81e)][_0x2d32a7(0x78e)]=[];_0x2be8f2[_0x2d32a7(0x81e)][_0x2d32a7(0x78e)][_0x2d32a7(0x7dd)](..._0x4cd4aa),await _0xa62efb[_0x2d32a7(0xaa3)][_0x2d32a7(0x546)](_0x2be8f2),_0x4ebba7();}else{if(_0x55eb19==='group'){if(!_0x2be8f2[_0x2d32a7(0x81e)][_0x2d32a7(0x523)])_0x2be8f2['settings'][_0x2d32a7(0x523)]=[];_0x2be8f2['settings']['groupAvatarLibrary'][_0x2d32a7(0x7dd)](..._0x4cd4aa),await _0xa62efb['chats'][_0x2d32a7(0x546)](_0x2be8f2),_0x179606();}}await _0x184397(_0x2d32a7(0x11c0),_0x2d32a7(0x1364)+_0x4cd4aa[_0x2d32a7(0x29d)]+'\x20个新头像！');}else _0xe1f1ad===0x0&&alert('没有找到可导入的内容。请检查您粘贴的格式是否正确。');}async function _0x2033c3(){const _0x31c528=_0x13d875,_0x14c9a3=await _0x4f6537(_0x31c528(0x13df),'请为这个头像起个名字（例如：春日野餐、学习时间）');if(!_0x14c9a3||!_0x14c9a3[_0x31c528(0x13bc)]())return;const _0x3dce7b=await _0x4f6537(_0x31c528(0x13df),_0x31c528(0x87c),'',_0x31c528(0xb36));if(!_0x3dce7b||!_0x3dce7b[_0x31c528(0x13bc)]()['startsWith'](_0x31c528(0xbdc))){alert(_0x31c528(0x851));return;}const _0xebe086=_0x53d851[_0x31c528(0xaa3)][_0x53d851[_0x31c528(0x13be)]];!_0xebe086[_0x31c528(0x81e)][_0x31c528(0x523)]&&(_0xebe086[_0x31c528(0x81e)][_0x31c528(0x523)]=[]),_0xebe086[_0x31c528(0x81e)][_0x31c528(0x523)]['push']({'name':_0x14c9a3['trim'](),'url':_0x3dce7b[_0x31c528(0x13bc)]()}),await _0xa62efb[_0x31c528(0xaa3)][_0x31c528(0x546)](_0xebe086),_0x179606();}function _0x39a025(_0x5799d2){return new Promise(_0x314ac7=>{const _0x25d189=_0x55b8,_0x3472a0=document['getElementById'](_0x25d189(0x4f2)),_0x113ea6=document['getElementById'](_0x25d189(0xb70)),_0x6d19b3=document[_0x25d189(0x53a)](_0x25d189(0xa15)),_0x22d4ea=document[_0x25d189(0x53a)](_0x25d189(0xbfc));_0x113ea6[_0x25d189(0x34a)]=_0x5799d2['isPinned']?_0x25d189(0xb03):'置顶聊天';const _0x594477=_0x113ea6[_0x25d189(0x75a)](!![]);_0x113ea6[_0x25d189(0x9e8)]['replaceChild'](_0x594477,_0x113ea6),_0x594477[_0x25d189(0x12f2)]=()=>{const _0x157d78=_0x25d189;_0x3472a0['classList'][_0x157d78(0x2d4)](_0x157d78(0xaef)),_0x314ac7('pin');};const _0x40e0a8=_0x6d19b3['cloneNode'](!![]);_0x6d19b3['parentNode'][_0x25d189(0xa1d)](_0x40e0a8,_0x6d19b3),_0x40e0a8[_0x25d189(0x12f2)]=()=>{const _0xddbaf6=_0x25d189;_0x3472a0[_0xddbaf6(0x1276)]['remove'](_0xddbaf6(0xaef)),_0x314ac7('delete');};const _0x41a592=_0x22d4ea[_0x25d189(0x75a)](!![]);_0x22d4ea[_0x25d189(0x9e8)][_0x25d189(0xa1d)](_0x41a592,_0x22d4ea),_0x41a592[_0x25d189(0x12f2)]=()=>{const _0x19c414=_0x25d189;_0x3472a0['classList']['remove'](_0x19c414(0xaef)),_0x314ac7(null);},_0x3472a0[_0x25d189(0x1276)]['add']('visible');});}function _0x4b6d38(){const _0x3d5d89=_0x13d875,_0x3b23ba=document[_0x3d5d89(0x53a)](_0x3d5d89(0x932)),_0x22d168=_0x53d851['globalSettings'][_0x3d5d89(0x227)];_0x22d168?_0x3b23ba[_0x3d5d89(0x1284)][_0x3d5d89(0x2f2)]=_0x3d5d89(0xf22)+_0x22d168+')':_0x3b23ba[_0x3d5d89(0x1284)][_0x3d5d89(0x2f2)]='linear-gradient(135deg,\x20#f6d365,\x20#fda085)';}function _0x201b82(){const _0xf60e22=_0x13d875;if(!_0x53d851[_0xf60e22(0x906)][_0xf60e22(0xaee)])return;for(const _0x23b2ac in _0x53d851[_0xf60e22(0x906)][_0xf60e22(0xaee)]){const _0x11d59c=document[_0xf60e22(0x53a)](_0xf60e22(0xa36)+_0x23b2ac);_0x11d59c&&(_0x11d59c[_0xf60e22(0x7ff)]=_0x53d851[_0xf60e22(0x906)][_0xf60e22(0xaee)][_0x23b2ac]);}}function _0x16c8db(){const _0x56a397=_0x13d875,_0x1a7584=document[_0x56a397(0x53a)]('cphone-icon-settings-grid');if(!_0x1a7584)return;_0x1a7584[_0x56a397(0xaac)]='';const _0x6f292d={'qq':'QQ','album':'相册','browser':_0x56a397(0xf7f),'taobao':'淘宝','memo':_0x56a397(0x777),'diary':'日记','amap':_0x56a397(0x138f),'usage':_0x56a397(0xd1b),'music':_0x56a397(0x623),'ephone':'Ephone'};for(const _0x5932c2 in _0x53d851[_0x56a397(0x906)][_0x56a397(0xaee)]){const _0x234b3b=_0x53d851[_0x56a397(0x906)][_0x56a397(0xaee)][_0x5932c2],_0x41d074=_0x6f292d[_0x5932c2]||_0x56a397(0x71e),_0x50d654=document[_0x56a397(0xd67)](_0x56a397(0x1425));_0x50d654[_0x56a397(0x6de)]=_0x56a397(0x228),_0x50d654[_0x56a397(0x999)][_0x56a397(0x10eb)]=_0x5932c2,_0x50d654['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22'+_0x234b3b+_0x56a397(0xa65)+_0x41d074+_0x56a397(0x51f),_0x1a7584[_0x56a397(0x133d)](_0x50d654);}}function _0x40e495(){const _0x160d53=_0x13d875;if(!_0x53d851['globalSettings'][_0x160d53(0xb97)])return;for(const _0x12a5f9 in _0x53d851[_0x160d53(0x906)][_0x160d53(0xb97)]){const _0x1370aa=document[_0x160d53(0x53a)]('icon-img-'+_0x12a5f9);_0x1370aa&&(_0x1370aa[_0x160d53(0x7ff)]=_0x53d851[_0x160d53(0x906)][_0x160d53(0xb97)][_0x12a5f9]);}}function _0x4fe752(){const _0xb0536f=_0x13d875,_0x4006ea=document[_0xb0536f(0x53a)](_0xb0536f(0xf1c));if(!_0x4006ea)return;_0x4006ea[_0xb0536f(0xaac)]='';const _0x449201={'qq':'QQ','world-book':_0xb0536f(0xad1),'wallpaper':_0xb0536f(0x98a),'renderer':_0xb0536f(0x979),'api-settings':_0xb0536f(0xe88),'font':'字体','char-phone':_0xb0536f(0xe4a),'douban':_0xb0536f(0x1369),'preset':'预设','tutorial':'教程','werewolf':_0xb0536f(0x2cd),'x':'X'};for(const _0x3ba0f2 in _0x53d851[_0xb0536f(0x906)]['appIcons']){const _0x5adfeb=_0x53d851[_0xb0536f(0x906)][_0xb0536f(0xb97)][_0x3ba0f2],_0x47116a=_0x449201[_0x3ba0f2]||_0xb0536f(0xe4a),_0x39ae57=document[_0xb0536f(0xd67)](_0xb0536f(0x1425));_0x39ae57['className']=_0xb0536f(0x228),_0x39ae57[_0xb0536f(0x999)][_0xb0536f(0x10eb)]=_0x3ba0f2,_0x39ae57[_0xb0536f(0xaac)]=_0xb0536f(0x10f0)+_0x5adfeb+_0xb0536f(0xa65)+_0x47116a+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4006ea[_0xb0536f(0x133d)](_0x39ae57);}}function _0x56ddbe(_0x2f7f8a){const _0x26835e=_0x13d875;if(!_0x53d851[_0x26835e(0x13be)])return;const _0x202b4b=_0x53d851[_0x26835e(0xaa3)][_0x53d851[_0x26835e(0x13be)]];if(!_0x202b4b||!_0x202b4b[_0x26835e(0xe83)])return;const _0x381d4b=_0x202b4b[_0x26835e(0xe83)][_0x26835e(0x397)](_0x59f092=>_0x59f092[_0x26835e(0x827)]===_0x2f7f8a);if(!_0x381d4b||_0x381d4b[_0x26835e(0x919)]!==_0x26835e(0x631)){console['error']('无法找到或消息类型不匹配的分享链接:',_0x2f7f8a);return;}document['getElementById'](_0x26835e(0x12e9))[_0x26835e(0x34a)]=_0x381d4b['source_name']||_0x26835e(0x1201);const _0x185975=document[_0x26835e(0x53a)]('browser-content');_0x185975[_0x26835e(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1\x20class=\x22article-title\x22>'+(_0x381d4b[_0x26835e(0x667)]||'无标题')+_0x26835e(0x7f5)+(_0x381d4b[_0x26835e(0x8a1)]||'未知')+_0x26835e(0x117f)+(_0x381d4b[_0x26835e(0x73e)]||_0x26835e(0xe3a))[_0x26835e(0x795)](/\n/g,'</p><p>')+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x541a81('browser-screen');}function _0x4d6595(){const _0x1af1d2=_0x13d875;_0x541a81(_0x1af1d2(0x10ba));}function _0x4d6595(){const _0x96ba9a=_0x13d875;_0x541a81(_0x96ba9a(0x10ba));}function _0x12e1d1(){const _0x8a882c=_0x13d875;if(!_0x53d851[_0x8a882c(0x13be)])return;document['getElementById'](_0x8a882c(0x1230))[_0x8a882c(0x11a2)]='',document[_0x8a882c(0x53a)](_0x8a882c(0xbd3))[_0x8a882c(0x11a2)]='',document[_0x8a882c(0x53a)]('link-source-input')[_0x8a882c(0x11a2)]='',document[_0x8a882c(0x53a)](_0x8a882c(0x6d0))['value']='',document['getElementById'](_0x8a882c(0xd7a))[_0x8a882c(0x1276)]['add']('visible');}async function _0x246c46(){const _0x32313d=_0x13d875;if(!_0x53d851[_0x32313d(0x13be)])return;const _0x54208d=document['getElementById'](_0x32313d(0x1230))[_0x32313d(0x11a2)][_0x32313d(0x13bc)]();if(!_0x54208d){alert('标题是必填项哦！');return;}const _0x3ef7c0=document[_0x32313d(0x53a)](_0x32313d(0xbd3))[_0x32313d(0x11a2)][_0x32313d(0x13bc)](),_0x147f1b=document[_0x32313d(0x53a)](_0x32313d(0xe69))[_0x32313d(0x11a2)]['trim'](),_0x402bd2=document[_0x32313d(0x53a)](_0x32313d(0x6d0))['value'][_0x32313d(0x13bc)](),_0x1f1060=_0x53d851[_0x32313d(0xaa3)][_0x53d851['activeChatId']],_0x5be957={'role':_0x32313d(0x10ae),'type':_0x32313d(0x631),'timestamp':Date['now'](),'title':_0x54208d,'description':_0x3ef7c0,'source_name':_0x147f1b,'content':_0x402bd2,'thumbnail_url':null};_0x1f1060[_0x32313d(0xe83)][_0x32313d(0x7dd)](_0x5be957),await _0xa62efb['chats']['put'](_0x1f1060),_0xa4d65(_0x5be957,_0x1f1060),_0x5001a4(),document[_0x32313d(0x53a)]('share-link-modal')[_0x32313d(0x1276)][_0x32313d(0x2d4)](_0x32313d(0xaef));}function _0xd757d6(_0x243df3,_0x403514){const _0x58e29a=_0x13d875;if(!_0x403514||!_0x403514['id'])return[];const _0x4005bd=_0x403514[_0x58e29a(0x608)],_0x173680=_0x403514['id'];return _0x243df3[_0x58e29a(0x2dd)](_0x21f4e4=>{const _0x452a4e=_0x58e29a;if(_0x21f4e4[_0x452a4e(0xa59)]===_0x452a4e(0x10ae)){if(_0x21f4e4[_0x452a4e(0x879)]&&_0x21f4e4['visibleGroupIds'][_0x452a4e(0x29d)]>0x0)return _0x4005bd&&_0x21f4e4[_0x452a4e(0x879)][_0x452a4e(0x6e9)](_0x4005bd);return!![];}if(String(_0x21f4e4[_0x452a4e(0xa59)])[_0x452a4e(0x1200)](_0x452a4e(0xc78))){if(Array[_0x452a4e(0xb31)](_0x21f4e4[_0x452a4e(0x3df)]))return _0x21f4e4[_0x452a4e(0x3df)]['includes'](_0x173680);return![];}const _0x3a8eca=_0x53d851[_0x452a4e(0xaa3)][_0x21f4e4[_0x452a4e(0xa59)]];if(!_0x3a8eca)return![];const _0x56c910=_0x3a8eca[_0x452a4e(0x608)],_0x4b3165=_0x56c910&&_0x4005bd&&_0x56c910===_0x4005bd,_0x100362=!_0x56c910&&!_0x4005bd;return _0x4b3165||_0x100362;});}function _0x3bde11(_0x3e37ae){const _0x370fbc=_0x13d875,_0x36e73c=document[_0x370fbc(0x53a)](_0x370fbc(0xf87)),_0xbe5df9=document[_0x370fbc(0x53a)](_0x370fbc(0x219)),_0x11bddb=_0x3e37ae===_0x370fbc(0x9b6);_0x36e73c[_0x370fbc(0x1276)][_0x370fbc(0x4d7)](_0x370fbc(0xfb9),_0x11bddb),_0xbe5df9&&(_0xbe5df9[_0x370fbc(0x1077)]=_0x11bddb),localStorage['setItem'](_0x370fbc(0x1197),_0x3e37ae);}function _0x269e8d(){const _0x34a460=_0x13d875,_0x5d0e4a=document['getElementById'](_0x34a460(0x219)),_0x3d9c30=_0x5d0e4a[_0x34a460(0x1077)]?_0x34a460(0x9b6):'light';_0x3bde11(_0x3d9c30);}function _0x44f259(){const _0xe1924=_0x13d875;if(!_0x53d851[_0xe1924(0x13be)])return;_0x11fbd6(),_0x541a81('long-term-memory-screen');}function _0x11fbd6(){const _0xb12de1=_0x13d875,_0x5f311c=document[_0xb12de1(0x53a)]('memory-list-container'),_0x3f9964=_0x53d851['chats'][_0x53d851[_0xb12de1(0x13be)]];_0x5f311c[_0xb12de1(0xaac)]='';let _0x538b08=[];_0x3f9964['isGroup']?_0x3f9964[_0xb12de1(0x3de)]['forEach'](_0x52a770=>{const _0x4c24e3=_0xb12de1,_0x476eab=_0x53d851['chats'][_0x52a770['id']];if(_0x476eab&&_0x476eab[_0x4c24e3(0x1016)]){const _0x41b488=_0x476eab[_0x4c24e3(0x1016)][_0x4c24e3(0xcb4)](_0x52749d=>({..._0x52749d,'authorName':_0x52a770['groupNickname'],'authorChatId':_0x52a770['id']}));_0x538b08[_0x4c24e3(0x7dd)](..._0x41b488);}}):_0x3f9964[_0xb12de1(0x1016)]&&(_0x538b08=_0x3f9964[_0xb12de1(0x1016)]['map'](_0x486099=>({..._0x486099,'authorName':_0x3f9964[_0xb12de1(0x234)],'authorChatId':_0x3f9964['id']})));if(_0x538b08['length']===0x0){_0x5f311c[_0xb12de1(0xaac)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这里还没有任何长期记忆。</p>';return;}_0x538b08[_0xb12de1(0xdb0)]((_0x4b3f65,_0x5f3bbf)=>_0x5f3bbf[_0xb12de1(0x827)]-_0x4b3f65[_0xb12de1(0x827)]),_0x538b08[_0xb12de1(0xeaf)]((_0x224f0a,_0x336a62)=>{const _0x22822b=_0xb12de1,_0x1dfa92=document[_0x22822b(0xd67)](_0x22822b(0x1425));_0x1dfa92['className']=_0x22822b(0x387),_0x1dfa92[_0x22822b(0x1284)][_0x22822b(0x98c)]=_0x22822b(0xce2),_0x1dfa92[_0x22822b(0xaac)]=_0x22822b(0x13ab)+_0x224f0a['authorName']+_0x22822b(0x5d5)+_0x224f0a['content'][_0x22822b(0x795)](/\n/g,'<br>')+_0x22822b(0x12ef)+_0x224f0a['authorChatId']+'\x22\x20data-memory-timestamp=\x22'+_0x224f0a[_0x22822b(0x827)]+'\x22\x20title=\x22编辑\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M11\x204H4a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2v-7\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M18.5\x202.5a2.121\x202.121\x200\x200\x201\x203\x203L12\x2015l-4\x201\x201-4\x209.5-9.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20delete-memory-btn\x22\x20data-author-id=\x22'+_0x224f0a[_0x22822b(0x5cd)]+_0x22822b(0x6cb)+_0x224f0a[_0x22822b(0x827)]+_0x22822b(0x107a),_0x5f311c[_0x22822b(0x133d)](_0x1dfa92);});}async function _0x4b04e3(){const _0x2ae75b=_0x13d875,_0x5575d8=_0x53d851[_0x2ae75b(0xaa3)][_0x53d851[_0x2ae75b(0x13be)]];if(!_0x5575d8)return;let _0x328235=_0x5575d8;if(_0x5575d8[_0x2ae75b(0x86e)]){const _0x39b176=_0x5575d8[_0x2ae75b(0x3de)][_0x2ae75b(0xcb4)](_0x488404=>({'text':'为“'+_0x488404[_0x2ae75b(0x12bc)]+'”添加记忆','value':_0x488404['id']})),_0x4cbcd5=await _0x34ea2c(_0x2ae75b(0x108b),_0x39b176);if(!_0x4cbcd5)return;_0x328235=_0x53d851[_0x2ae75b(0xaa3)][_0x4cbcd5];if(!_0x328235){alert(_0x2ae75b(0x12da));return;}}const _0x20d8a8=await _0x4f6537('为“'+_0x328235[_0x2ae75b(0x234)]+_0x2ae75b(0xf57),_0x2ae75b(0xab4),'','textarea');if(_0x20d8a8&&_0x20d8a8[_0x2ae75b(0x13bc)]()){if(!_0x328235['longTermMemory'])_0x328235[_0x2ae75b(0x1016)]=[];_0x328235[_0x2ae75b(0x1016)][_0x2ae75b(0x7dd)]({'content':_0x20d8a8[_0x2ae75b(0x13bc)](),'timestamp':Date[_0x2ae75b(0x9c1)](),'source':_0x2ae75b(0x55f)}),await _0xa62efb['chats']['put'](_0x328235),_0x11fbd6();}}async function _0xfec2b7(_0x248545,_0x5f1415){const _0xf90438=_0x13d875,_0x372367=_0x53d851['chats'][_0x248545];if(!_0x372367||!_0x372367[_0xf90438(0x1016)])return;const _0x224b93=_0x372367[_0xf90438(0x1016)][_0xf90438(0x298)](_0x5795c4=>_0x5795c4[_0xf90438(0x827)]===_0x5f1415);if(_0x224b93===-0x1)return;const _0x3cea47=_0x372367['longTermMemory'][_0x224b93],_0x220c95=await _0x4f6537('编辑记忆',_0xf90438(0x1427),_0x3cea47['content'],_0xf90438(0x728));_0x220c95&&_0x220c95[_0xf90438(0x13bc)]()&&(_0x3cea47[_0xf90438(0x73e)]=_0x220c95[_0xf90438(0x13bc)](),await _0xa62efb[_0xf90438(0xaa3)][_0xf90438(0x546)](_0x372367),_0x11fbd6());}async function _0x432b32(_0x441662,_0x56f6e0){const _0x590629=_0x13d875,_0x33a577=await _0x355fc0(_0x590629(0x69a),_0x590629(0xf20),{'confirmButtonClass':_0x590629(0x264)});if(_0x33a577){const _0x139a19=_0x53d851[_0x590629(0xaa3)][_0x441662];if(!_0x139a19||!_0x139a19[_0x590629(0x1016)])return;_0x139a19['longTermMemory']=_0x139a19[_0x590629(0x1016)][_0x590629(0x2dd)](_0x5237a4=>_0x5237a4[_0x590629(0x827)]!==_0x56f6e0),await _0xa62efb[_0x590629(0xaa3)][_0x590629(0x546)](_0x139a19),_0x11fbd6();}}async function _0x476fd3(){const _0xc125fb=_0x13d875,_0x53dc0c=await _0x355fc0(_0xc125fb(0x911),'这将提取最近的对话内容发送给AI进行总结，会消耗API额度。确定要继续吗？');_0x53dc0c&&await _0x42f2f6(_0x53d851['activeChatId'],!![]);}async function _0x47d433(_0x2f8c41){const _0x3565ec=_0x13d875,_0x362079=_0x53d851[_0x3565ec(0xaa3)][_0x2f8c41];if(!_0x362079||!_0x362079[_0x3565ec(0x81e)][_0x3565ec(0xe1a)])return;const _0x2afab4=_0x362079['lastMemorySummaryTimestamp']||0x0,_0xa55532=_0x362079[_0x3565ec(0xe83)][_0x3565ec(0x2dd)](_0x134916=>_0x134916['timestamp']>_0x2afab4&&!_0x134916[_0x3565ec(0x1032)]);_0xa55532[_0x3565ec(0x29d)]>=_0x362079['settings'][_0x3565ec(0x645)]&&(console['log']('达到自动总结阈值\x20('+_0xa55532[_0x3565ec(0x29d)]+'/'+_0x362079['settings'][_0x3565ec(0x645)]+_0x3565ec(0x5c5)),await _0x42f2f6(_0x2f8c41));}async function _0x49b3fd(_0x408cb2,_0x143513){const _0x3f8ffd=_0x13d875,_0x7df4fb=_0x53d851[_0x3f8ffd(0xaa3)][_0x408cb2];if(!_0x7df4fb||!_0x143513)throw new Error(_0x3f8ffd(0xebd));const _0x6c8d01=_0x53d851[_0x3f8ffd(0xa74)][_0x3f8ffd(0x1005)]||'用户';let _0x1685db,_0x3795c6=_0x7df4fb;const _0x415f46=new Date()['toLocaleDateString']('zh-CN',{'year':'numeric','month':'long','day':_0x3f8ffd(0xcbe)});if(_0x7df4fb[_0x3f8ffd(0x86e)]){let _0x483e25=null;_0x58a059['callRequester']&&(_0x483e25=_0x7df4fb[_0x3f8ffd(0x3de)][_0x3f8ffd(0x397)](_0x1491c3=>_0x1491c3[_0x3f8ffd(0x543)]===_0x58a059['callRequester']));!_0x483e25&&(_0x483e25=_0x7df4fb[_0x3f8ffd(0x3de)]['find'](_0xb460cb=>_0xb460cb['id']!==_0x3f8ffd(0x10ae)&&_0x58a059['participants'][_0x3f8ffd(0xe0f)](_0x36a129=>_0x36a129['id']===_0xb460cb['id'])));!_0x483e25&&(_0x483e25=_0x7df4fb['members'][_0x3f8ffd(0x397)](_0x1007f6=>_0x1007f6['id']!==_0x3f8ffd(0x10ae)));if(!_0x483e25)throw new Error(_0x3f8ffd(0x9e7));const _0x21bc50=_0x53d851[_0x3f8ffd(0xaa3)][_0x483e25['id']];if(!_0x21bc50)throw new Error(_0x3f8ffd(0x236)+_0x483e25[_0x3f8ffd(0x12bc)]+_0x3f8ffd(0x390));const _0x13ed9a=_0x7df4fb[_0x3f8ffd(0x81e)][_0x3f8ffd(0xab1)]||_0x3f8ffd(0x970);_0x1685db=_0x3f8ffd(0x53c)+_0x483e25[_0x3f8ffd(0x543)]+'”。请你回顾一下刚才和\x20“'+_0x6c8d01+'”\x20以及其他群成员的【群组视频通话】，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：'+_0x415f46+'**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们在群聊通话里讨论了哪些核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是'+_0x415f46+_0x3f8ffd(0x54e)+_0x21bc50[_0x3f8ffd(0x81e)]['aiPersona']+'\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x13ed9a+_0x3f8ffd(0x5c2)+_0x143513+_0x3f8ffd(0x125c)+_0x483e25['originalName']+'”的身份，开始你的客观总结。',_0x3795c6=_0x21bc50;}else _0x1685db=_0x3f8ffd(0x53c)+_0x7df4fb[_0x3f8ffd(0x543)]+'”。请你回顾一下刚才和“'+_0x6c8d01+_0x3f8ffd(0xd20)+_0x415f46+_0x3f8ffd(0x7fe)+_0x415f46+_0x3f8ffd(0x6c4)+_0x7df4fb[_0x3f8ffd(0x81e)][_0x3f8ffd(0x1216)]+_0x3f8ffd(0x49d)+_0x7df4fb[_0x3f8ffd(0x81e)][_0x3f8ffd(0xab1)]+'\x0a\x0a#\x20待总结的视频通话记录\x0a'+_0x143513+_0x3f8ffd(0x125c)+_0x7df4fb[_0x3f8ffd(0x543)]+_0x3f8ffd(0xe3b);try{const _0x40f30a=_0x53d851['apiConfig'][_0x3f8ffd(0x11f4)]&&_0x53d851[_0x3f8ffd(0x80d)][_0x3f8ffd(0x8ec)]&&_0x53d851['apiConfig'][_0x3f8ffd(0x112b)],{proxyUrl:_0x41f84d,apiKey:_0x2c0f95,model:_0x36ff4d}=_0x40f30a?{'proxyUrl':_0x53d851[_0x3f8ffd(0x80d)][_0x3f8ffd(0x11f4)],'apiKey':_0x53d851[_0x3f8ffd(0x80d)][_0x3f8ffd(0x8ec)],'model':_0x53d851[_0x3f8ffd(0x80d)][_0x3f8ffd(0x112b)]}:_0x53d851[_0x3f8ffd(0x80d)];if(!_0x41f84d||!_0x2c0f95||!_0x36ff4d)throw new Error(_0x3f8ffd(0xcbd));let _0x21e102=_0x41f84d[_0x3f8ffd(0x6e9)]('generativelanguage'),_0x3c556a=_0x1697e7(_0x36ff4d,_0x2c0f95,_0x1685db,[{'role':'user','content':_0x3f8ffd(0x3aa)}]);const _0x4f7598=_0x21e102?await fetch(_0x3c556a[_0x3f8ffd(0xb36)],_0x3c556a['data']):await fetch(_0x41f84d+_0x3f8ffd(0x434),{'method':_0x3f8ffd(0xa4e),'headers':{'Content-Type':_0x3f8ffd(0x85b),'Authorization':_0x3f8ffd(0x841)+_0x2c0f95},'body':JSON['stringify']({'model':_0x36ff4d,'messages':[{'role':_0x3f8ffd(0xab3),'content':_0x1685db},{'role':_0x3f8ffd(0x10ae),'content':'请开始总结。'}],'temperature':0.1})});if(!_0x4f7598['ok']){const _0x2111af=await _0x4f7598[_0x3f8ffd(0xdc2)]()['catch'](()=>({'error':{'message':_0x4f7598[_0x3f8ffd(0x5c1)]}}));throw new Error('API\x20请求失败:\x20'+_0x4f7598[_0x3f8ffd(0x12d3)]+'\x20-\x20'+_0x2111af[_0x3f8ffd(0x617)]['message']);}const _0x352654=await _0x4f7598[_0x3f8ffd(0xdc2)]();let _0x547cf6=_0x21e102?getGeminiResponseText(_0x352654):_0x352654[_0x3f8ffd(0x12bf)][0x0]['message'][_0x3f8ffd(0x73e)];_0x547cf6=_0x547cf6[_0x3f8ffd(0x795)](/^```json\s*/,'')[_0x3f8ffd(0x795)](/```$/,'')[_0x3f8ffd(0x13bc)]();const _0x45982a=JSON[_0x3f8ffd(0x367)](_0x547cf6);if(_0x45982a[_0x3f8ffd(0xee5)]&&_0x45982a['summary']['trim']()){const _0x3c8874={'content':_0x3f8ffd(0x42a)+(_0x7df4fb[_0x3f8ffd(0x86e)]?'群聊':'')+_0x3f8ffd(0xa2e)+_0x45982a['summary'][_0x3f8ffd(0x13bc)]()+')','timestamp':Date[_0x3f8ffd(0x9c1)](),'source':_0x7df4fb['isGroup']?'group_call_summary':_0x3f8ffd(0xd41)};if(!_0x3795c6[_0x3f8ffd(0x1016)])_0x3795c6[_0x3f8ffd(0x1016)]=[];return _0x3795c6[_0x3f8ffd(0x1016)][_0x3f8ffd(0x7dd)](_0x3c8874),await _0xa62efb[_0x3f8ffd(0xaa3)]['put'](_0x3795c6),console[_0x3f8ffd(0x1081)](_0x3f8ffd(0x1019)+_0x3795c6[_0x3f8ffd(0x234)]+_0x3f8ffd(0x936)),!![];}else throw new Error(_0x3f8ffd(0x125d));}catch(_0x455c6d){console['error'](_0x3f8ffd(0xefd),_0x455c6d);throw _0x455c6d;}}function _0x390438(_0x224c29){const _0x76c2e0=_0x13d875,_0x26d788=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯','什么','怎么',_0x76c2e0(0xa9b),'哪个','一些','这个','那个','还有']),_0x13cab1=_0x224c29['match'](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x255ffe=new Map();let _0x503706=0x0;_0x13cab1[_0x76c2e0(0xeaf)](_0x4795be=>{const _0x355fcf=_0x76c2e0;if(_0x4795be[_0x355fcf(0x29d)]>0x1&&!_0x26d788[_0x355fcf(0x11af)](_0x4795be)){const _0x38691e=(_0x255ffe[_0x355fcf(0x883)](_0x4795be)||0x0)+0x1;_0x255ffe['set'](_0x4795be,_0x38691e);if(_0x38691e>_0x503706)_0x503706=_0x38691e;}});const _0x37aa8e=[],_0x50b5fc=[],_0x14535d=_0x503706*0.9,_0x23a7d1=_0x503706*0.6;_0x255ffe[_0x76c2e0(0xeaf)]((_0x334afe,_0x4a3b23)=>{const _0x50d537=_0x76c2e0;if(_0x334afe>=_0x14535d)_0x37aa8e['push'](_0x4a3b23);else _0x334afe>=_0x23a7d1&&_0x50b5fc[_0x50d537(0x7dd)](_0x4a3b23);});const _0x54456d=new Set(_0x37aa8e),_0x29908c=_0x50b5fc[_0x76c2e0(0x2dd)](_0x2bbc63=>!_0x54456d[_0x76c2e0(0x11af)](_0x2bbc63))[_0x76c2e0(0x1340)](0x0,0x5);return{'coreKeywords':_0x37aa8e[_0x76c2e0(0x1340)](0x0,0x3),'situationalKeywords':_0x29908c};}function _0x32a9cb(_0x52851e,_0x83c778,_0x4a211e){const _0xc2dbe7=_0x13d875;let _0x4c6fbe;_0x4a211e===_0xc2dbe7(0x81f)?_0x4c6fbe=Date[_0xc2dbe7(0x9c1)]()-_0x83c778*0x3c*0x3c*0x3e8:_0x4c6fbe=Date[_0xc2dbe7(0x9c1)]()-_0x83c778*0x18*0x3c*0x3c*0x3e8;const _0x3e5c53=_0x52851e[_0xc2dbe7(0xe83)][_0xc2dbe7(0x2dd)](_0xf97ecb=>_0xf97ecb['timestamp']>_0x4c6fbe&&!_0xf97ecb[_0xc2dbe7(0x1032)]);if(_0x3e5c53['length']<0x3)return'';const _0x595469=_0x3e5c53[_0xc2dbe7(0xcb4)](_0x46b248=>{const _0x1bdbdc=_0xc2dbe7;if(typeof _0x46b248[_0x1bdbdc(0x73e)]===_0x1bdbdc(0xfc5))return _0x46b248[_0x1bdbdc(0x73e)];if(_0x46b248[_0x1bdbdc(0x919)]===_0x1bdbdc(0x64f))return _0x46b248[_0x1bdbdc(0x73e)];if(_0x46b248['type']===_0x1bdbdc(0x8c3))return(_0x46b248['dialogue']||'')+'\x20'+(_0x46b248[_0x1bdbdc(0xa60)]||'');return'';})[_0xc2dbe7(0x2c8)]('\x20'),_0x3520d4=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯']),_0x4522d8=_0x595469['match'](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x5d3c3c=new Map();_0x4522d8['forEach'](_0x87c9ac=>{const _0x2b73a0=_0xc2dbe7;_0x87c9ac['length']>0x1&&!_0x3520d4[_0x2b73a0(0x11af)](_0x87c9ac)&&_0x5d3c3c[_0x2b73a0(0xf2b)](_0x87c9ac,(_0x5d3c3c[_0x2b73a0(0x883)](_0x87c9ac)||0x0)+0x1);});const _0x26d6df=[..._0x5d3c3c[_0xc2dbe7(0xfdc)]()][_0xc2dbe7(0xdb0)]((_0xd5bee,_0x2a137e)=>_0x2a137e[0x1]-_0xd5bee[0x1])[_0xc2dbe7(0xcb4)](_0x23abdc=>_0x23abdc[0x0]);if(_0x26d6df['length']===0x0)return'';let _0xe5e7be;return _0x4a211e===_0xc2dbe7(0x81f)?_0xe5e7be='最近'+_0x83c778+_0xc2dbe7(0xd26):_0x83c778===0x1?_0xe5e7be=_0xc2dbe7(0xce3):_0xe5e7be='最近'+_0x83c778+_0xc2dbe7(0xff8),_0xc2dbe7(0xadc)+_0xe5e7be+_0xc2dbe7(0x7d8)+_0x26d6df[_0xc2dbe7(0x1340)](0x0,0x3)[_0xc2dbe7(0x2c8)]('、\x20')+_0xc2dbe7(0x1232);}function _0x6516f2(_0x312483){const _0x3ccaf2=_0x13d875;if(!_0x312483||typeof _0x312483!==_0x3ccaf2(0xfc5))return null;const _0x5be771=_0x312483[_0x3ccaf2(0x795)](/^```json\s*/,'')[_0x3ccaf2(0x795)](/```$/,'')['trim'](),_0x48e4d6=_0x5be771[_0x3ccaf2(0x1120)](/{[\s\S]*}/);if(_0x48e4d6)try{const _0x5b5228=JSON[_0x3ccaf2(0x367)](_0x48e4d6[0x0]);return console[_0x3ccaf2(0x1081)](_0x3ccaf2(0xf42)),_0x5b5228;}catch(_0x2a0a3f){console[_0x3ccaf2(0xad0)](_0x3ccaf2(0x114f));}const _0x52d827=_0x5be771[_0x3ccaf2(0x1120)](/"summary"\s*:\s*"((?:[^"\\]|\\.)*)"/);if(_0x52d827&&_0x52d827[0x1])return console[_0x3ccaf2(0x1081)]('容错解析：策略2成功\x20(提取了summary字段内容)'),{'summary':_0x52d827[0x1]['replace'](/\\"/g,'\x22')};if(_0x5be771)return console[_0x3ccaf2(0x1081)]('容错解析：策略3成功\x20(将整个返回文本作为摘要)'),{'summary':_0x5be771};return null;}async function _0x32670c(_0x76887c){const _0x4e0f75=_0x13d875;let _0x24e949=_0x53d851[_0x4e0f75(0xaa3)][_0x76887c];if(!_0x24e949)return;let _0x252881=_0x24e949;if(_0x24e949[_0x4e0f75(0x86e)]){const _0x280b73=_0x24e949[_0x4e0f75(0x3de)][_0x4e0f75(0xcb4)](_0xc63fbf=>{const _0x495eab=_0x4e0f75,_0x11959a=_0x53d851[_0x495eab(0xaa3)][_0xc63fbf['id']];if(_0x11959a&&_0x11959a[_0x495eab(0x1016)]&&_0x11959a[_0x495eab(0x1016)][_0x495eab(0x29d)]>=0x2)return{'text':_0x495eab(0x832)+_0xc63fbf[_0x495eab(0x12bc)]+_0x495eab(0x10af)+_0x11959a[_0x495eab(0x1016)]['length']+'条)','value':_0xc63fbf['id']};return null;})[_0x4e0f75(0x2dd)](Boolean);if(_0x280b73[_0x4e0f75(0x29d)]===0x0){alert(_0x4e0f75(0x10dd));return;}const _0x11a51d=await _0x34ea2c(_0x4e0f75(0x6e3),_0x280b73);if(!_0x11a51d)return;_0x252881=_0x53d851[_0x4e0f75(0xaa3)][_0x11a51d];}if(!_0x252881['longTermMemory']||_0x252881[_0x4e0f75(0x1016)][_0x4e0f75(0x29d)]<0x2){alert('“'+_0x252881[_0x4e0f75(0x234)]+'”的长期记忆少于2条，无需进行精炼。');return;}const _0x20046e=_0x252881['longTermMemory']['length'],_0x14517f=await _0x34ea2c(_0x4e0f75(0xfea),[{'text':'全部记忆\x20('+_0x20046e+'条)','value':_0x4e0f75(0x63d)},{'text':_0x4e0f75(0xcba),'value':'20'},{'text':_0x4e0f75(0x1373),'value':'50'},{'text':'最近\x20100\x20条','value':_0x4e0f75(0xbb4)},{'text':_0x4e0f75(0x10d5),'value':_0x4e0f75(0xa86)}][_0x4e0f75(0x2dd)](_0x326055=>_0x326055[_0x4e0f75(0x11a2)]==='all'||_0x326055[_0x4e0f75(0x11a2)]===_0x4e0f75(0xa86)||parseInt(_0x326055['value'])<_0x20046e));if(_0x14517f===null)return;let _0x329ea1,_0x2ee101=_0x20046e;if(_0x14517f===_0x4e0f75(0x63d))_0x329ea1=[..._0x252881[_0x4e0f75(0x1016)]];else{if(_0x14517f==='custom'){const _0x1792d0=await _0x4f6537(_0x4e0f75(0x26c),_0x4e0f75(0xb3f)+_0x20046e+_0x4e0f75(0xa1c));if(_0x1792d0===null)return;const _0x593887=parseInt(_0x1792d0);if(isNaN(_0x593887)||_0x593887<0x2||_0x593887>_0x20046e){alert(_0x4e0f75(0x621)+_0x20046e+_0x4e0f75(0x5f6));return;}_0x2ee101=_0x593887,_0x329ea1=_0x252881['longTermMemory'][_0x4e0f75(0x1340)](-_0x2ee101);}else _0x2ee101=parseInt(_0x14517f),_0x2ee101>=_0x20046e?(_0x329ea1=[..._0x252881[_0x4e0f75(0x1016)]],_0x2ee101=_0x20046e):_0x329ea1=_0x252881[_0x4e0f75(0x1016)][_0x4e0f75(0x1340)](-_0x2ee101);}const _0x5aa071=await _0x4f6537(_0x4e0f75(0x1111),_0x4e0f75(0x881),_0x4e0f75(0xe49));if(_0x5aa071===null)return;const _0xf8bcfe=parseInt(_0x5aa071);if(isNaN(_0xf8bcfe)||_0xf8bcfe<0x14){alert('请输入一个有效的数字（建议大于20）。');return;}const _0x1d9b5d=await _0x355fc0(_0x4e0f75(0x662),_0x4e0f75(0xa23)+_0x2ee101+_0x4e0f75(0xd99)+_0xf8bcfe+_0x4e0f75(0x93a),{'confirmButtonClass':_0x4e0f75(0x264),'confirmText':_0x4e0f75(0x12d4)});if(!_0x1d9b5d)return;const _0xf96d41=_0x329ea1[_0x4e0f75(0xcb4)](_0x1fe5d6=>'-\x20'+_0x1fe5d6[_0x4e0f75(0x73e)])[_0x4e0f75(0x2c8)]('\x0a'),_0x2d3177=_0x53d851['qzoneSettings'][_0x4e0f75(0x1005)]||'用户',_0x2a5bf6=new Date()[_0x4e0f75(0xc76)](_0x4e0f75(0x42f),{'year':_0x4e0f75(0xcbe),'month':_0x4e0f75(0x11bd),'day':_0x4e0f75(0xcbe)}),_0x3a6928='\x0a#\x20你的任务\x0a你就是角色“'+_0x252881[_0x4e0f75(0x543)]+_0x4e0f75(0xb69)+_0x2d3177+'”的所有长期记忆，然后将它们梳理、整合并精炼成一段更加连贯、客观的核心记忆摘要。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：'+_0x2a5bf6+_0x4e0f75(0x9fa)+_0x2a5bf6+_0x4e0f75(0xfc9)+_0xf8bcfe+'\x20字左右**。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a'+_0x252881[_0x4e0f75(0x81e)][_0x4e0f75(0x1216)]+_0x4e0f75(0x49d)+_0x252881['settings']['myPersona']+_0x4e0f75(0xd63)+_0xf96d41+_0x4e0f75(0x125c)+_0x252881[_0x4e0f75(0x543)]+_0x4e0f75(0xa8c);await _0x184397(_0x4e0f75(0x11d7),_0x4e0f75(0xb5e));try{const _0x2278cb=_0x53d851[_0x4e0f75(0x80d)][_0x4e0f75(0x11f4)]&&_0x53d851[_0x4e0f75(0x80d)][_0x4e0f75(0x8ec)]&&_0x53d851['apiConfig'][_0x4e0f75(0x112b)],{proxyUrl:_0x3147fd,apiKey:_0x2abd3e,model:_0x37d7af}=_0x2278cb?{'proxyUrl':_0x53d851[_0x4e0f75(0x80d)][_0x4e0f75(0x11f4)],'apiKey':_0x53d851[_0x4e0f75(0x80d)][_0x4e0f75(0x8ec)],'model':_0x53d851[_0x4e0f75(0x80d)][_0x4e0f75(0x112b)]}:_0x53d851[_0x4e0f75(0x80d)];if(!_0x3147fd||!_0x2abd3e||!_0x37d7af)throw new Error(_0x4e0f75(0x1355));let _0x38b6d2=_0x3147fd[_0x4e0f75(0x6e9)](_0x4e0f75(0x1046)),_0x3e9000=_0x1697e7(_0x37d7af,_0x2abd3e,_0x3a6928,[{'role':_0x4e0f75(0x10ae),'content':_0x4e0f75(0xcea)}]);const _0x203efa=_0x38b6d2?await fetch(_0x3e9000['url'],_0x3e9000[_0x4e0f75(0xd7c)]):await fetch(_0x3147fd+'/v1/chat/completions',{'method':_0x4e0f75(0xa4e),'headers':{'Content-Type':_0x4e0f75(0x85b),'Authorization':'Bearer\x20'+_0x2abd3e},'body':JSON[_0x4e0f75(0xe1e)]({'model':_0x37d7af,'messages':[{'role':_0x4e0f75(0xab3),'content':_0x3a6928},{'role':_0x4e0f75(0x10ae),'content':_0x4e0f75(0xcea)}],'temperature':0.2})});if(!_0x203efa['ok'])throw new Error(_0x4e0f75(0x352)+_0x203efa[_0x4e0f75(0x5c1)]);const _0x169723=await _0x203efa[_0x4e0f75(0xdc2)]();let _0x178bc4=_0x38b6d2?getGeminiResponseText(_0x169723):_0x169723[_0x4e0f75(0x12bf)][0x0]['message'][_0x4e0f75(0x73e)];const _0x31434f=_0x6516f2(_0x178bc4);if(_0x31434f&&_0x31434f[_0x4e0f75(0xee5)]&&typeof _0x31434f[_0x4e0f75(0xee5)]===_0x4e0f75(0xfc5)&&_0x31434f['summary'][_0x4e0f75(0x13bc)]()){const _0x3bf5b3=await _0x355fc0(_0x4e0f75(0x77e),_0x4e0f75(0xc04)+_0x2ee101+_0x4e0f75(0x26f)+_0x31434f[_0x4e0f75(0xee5)][_0x4e0f75(0x13bc)]()+'</div><br>是否用这条新记忆替换掉这些旧记忆？',{'confirmText':_0x4e0f75(0xa97),'cancelText':'保留旧的','confirmButtonClass':_0x4e0f75(0x264)});if(_0x3bf5b3){const _0x5b818f={'content':_0x31434f['summary'][_0x4e0f75(0x13bc)](),'timestamp':Date[_0x4e0f75(0x9c1)](),'source':_0x4e0f75(0x774)},_0x1d1cc8=_0x20046e-_0x2ee101,_0x2b0621=_0x1d1cc8>0x0?_0x252881[_0x4e0f75(0x1016)][_0x4e0f75(0x1340)](0x0,_0x1d1cc8):[];_0x252881['longTermMemory']=[..._0x2b0621,_0x5b818f],_0x252881[_0x4e0f75(0xa95)]=Date['now'](),await _0xa62efb['chats'][_0x4e0f75(0x546)](_0x252881),document['getElementById']('long-term-memory-screen')[_0x4e0f75(0x1276)][_0x4e0f75(0x6a3)](_0x4e0f75(0xdf6))&&_0x11fbd6(),await _0x184397(_0x4e0f75(0x2fd),_0x4e0f75(0x54d)+_0x2ee101+_0x4e0f75(0x109e));}else await _0x184397('操作已取消',_0x4e0f75(0x693));}else throw new Error('AI返回了空的或格式不正确的总结内容。');}catch(_0x20f142){console[_0x4e0f75(0x617)](_0x4e0f75(0x3c7),_0x20f142),await _0x184397(_0x4e0f75(0x7e2),_0x4e0f75(0x679)+_0x20f142['message']);}}async function _0x42f2f6(_0x5f25da,_0x3058c6=![]){const _0x101ec1=_0x13d875,_0x18f579=_0x53d851['chats'][_0x5f25da];if(!_0x18f579)return;const _0x1fd7e2=_0x18f579[_0x101ec1(0xa95)]||0x0,_0x15e70d=_0x3058c6?_0x18f579[_0x101ec1(0xe83)][_0x101ec1(0x2dd)](_0x595148=>!_0x595148['isHidden']||_0x595148[_0x101ec1(0xb4d)]==='system'&&_0x595148[_0x101ec1(0x73e)]['includes'](_0x101ec1(0xdff)))[_0x101ec1(0x1340)](-(_0x18f579[_0x101ec1(0x81e)]['autoMemoryInterval']||0x14)):_0x18f579['history'][_0x101ec1(0x2dd)](_0x14150b=>_0x14150b[_0x101ec1(0x827)]>_0x1fd7e2&&(!_0x14150b['isHidden']||_0x14150b[_0x101ec1(0xb4d)]===_0x101ec1(0xab3)&&_0x14150b[_0x101ec1(0x73e)][_0x101ec1(0x6e9)](_0x101ec1(0xdff))));if(_0x15e70d[_0x101ec1(0x29d)]<0x5){if(_0x3058c6)alert(_0x101ec1(0x3e4));return;}const _0x29992c=_0x53d851['qzoneSettings'][_0x101ec1(0x1005)]||'用户',_0x4dfb23=_0x15e70d[_0x101ec1(0xcb4)](_0x16effa=>{const _0x2a3228=_0x101ec1;if(_0x16effa[_0x2a3228(0x1032)]&&_0x16effa[_0x2a3228(0xb4d)]==='system'&&_0x16effa[_0x2a3228(0x73e)][_0x2a3228(0x6e9)](_0x2a3228(0xdff)))return _0x16effa[_0x2a3228(0x73e)];let _0x100026;_0x16effa[_0x2a3228(0xb4d)]===_0x2a3228(0x10ae)?_0x100026=_0x29992c:_0x100026=_0x16effa['senderName']||_0x18f579[_0x2a3228(0x543)];let _0x21ea73='';if(_0x16effa[_0x2a3228(0x919)]==='offline_text'){if(_0x16effa[_0x2a3228(0x73e)])_0x21ea73=_0x16effa[_0x2a3228(0x73e)];else{const _0x3350f8=_0x16effa[_0x2a3228(0x1266)]?'「'+_0x16effa[_0x2a3228(0x1266)]+'」':'',_0x16ba5b=_0x16effa[_0x2a3228(0xa60)]?'('+_0x16effa[_0x2a3228(0xa60)]+')':'';_0x21ea73=(_0x3350f8+'\x20'+_0x16ba5b)[_0x2a3228(0x13bc)]();}}else _0x21ea73=String(_0x16effa[_0x2a3228(0x73e)]);return _0x100026+':\x20'+_0x21ea73;})['join']('\x0a');let _0x14d8a3;if(_0x18f579[_0x101ec1(0x86e)])_0x14d8a3=_0x101ec1(0xdad)+_0x29992c+_0x101ec1(0xf29)+_0x4dfb23+_0x101ec1(0x268)+_0x18f579['members'][_0x101ec1(0xcb4)](_0x11f661=>'-\x20'+_0x11f661[_0x101ec1(0x12bc)]+_0x101ec1(0xdb3)+_0x11f661[_0x101ec1(0x543)]+')')[_0x101ec1(0x2c8)]('\x0a')+_0x101ec1(0xbe3);else{const _0x259eac=new Date()[_0x101ec1(0xc76)]('zh-CN',{'year':_0x101ec1(0xcbe),'month':_0x101ec1(0x11bd),'day':_0x101ec1(0xcbe)});_0x14d8a3=_0x101ec1(0x53c)+_0x18f579[_0x101ec1(0x543)]+_0x101ec1(0xb0a)+_0x29992c+_0x101ec1(0xce4)+_0x259eac+_0x101ec1(0xeb5)+_0x259eac+_0x101ec1(0x1e8)+new Date(Date[_0x101ec1(0x9c1)]()+0x5265c00)['toLocaleDateString'](_0x101ec1(0x42f),{'month':'long','day':_0x101ec1(0xcbe)})+_0x101ec1(0x10f3)+_0x18f579[_0x101ec1(0x81e)][_0x101ec1(0x1216)]+_0x101ec1(0xf19)+_0x18f579[_0x101ec1(0x81e)][_0x101ec1(0xab1)]+_0x101ec1(0x82c)+_0x4dfb23+'\x0a\x0a现在，请以“'+_0x18f579['originalName']+_0x101ec1(0xe3b);}try{const _0x4a4f2a=_0x53d851[_0x101ec1(0x80d)]['secondaryProxyUrl']&&_0x53d851[_0x101ec1(0x80d)][_0x101ec1(0x8ec)]&&_0x53d851['apiConfig'][_0x101ec1(0x112b)],{proxyUrl:_0x1ae8da,apiKey:_0x522945,model:_0x2144b3}=_0x4a4f2a?{'proxyUrl':_0x53d851['apiConfig']['secondaryProxyUrl'],'apiKey':_0x53d851['apiConfig'][_0x101ec1(0x8ec)],'model':_0x53d851[_0x101ec1(0x80d)][_0x101ec1(0x112b)]}:_0x53d851['apiConfig'];if(!_0x1ae8da||!_0x522945||!_0x2144b3)throw new Error('API未配置');let _0x2ef248=_0x1ae8da['includes'](_0x101ec1(0x1046)),_0x51cc6d=_0x1697e7(_0x2144b3,_0x522945,_0x14d8a3,[{'role':_0x101ec1(0x10ae),'content':'请开始总结。'}]);const _0xd27dd8=_0x2ef248?await fetch(_0x51cc6d[_0x101ec1(0xb36)],_0x51cc6d[_0x101ec1(0xd7c)]):await fetch(_0x1ae8da+_0x101ec1(0x434),{'method':_0x101ec1(0xa4e),'headers':{'Content-Type':_0x101ec1(0x85b),'Authorization':'Bearer\x20'+_0x522945},'body':JSON['stringify']({'model':_0x2144b3,'messages':[{'role':_0x101ec1(0xab3),'content':_0x14d8a3},{'role':_0x101ec1(0x10ae),'content':_0x101ec1(0x3aa)}],'temperature':0.2})});if(!_0xd27dd8['ok'])throw new Error('API\x20错误:\x20'+_0xd27dd8[_0x101ec1(0x5c1)]);const _0x539a51=await _0xd27dd8[_0x101ec1(0xdc2)]();let _0x40e185=_0x2ef248?getGeminiResponseText(_0x539a51):_0x539a51[_0x101ec1(0x12bf)][0x0][_0x101ec1(0x875)]['content'];_0x40e185=_0x40e185[_0x101ec1(0x795)](/^```json\s*/,'')['replace'](/```$/,'')['trim']();const _0x31ddaf=JSON['parse'](_0x40e185);if(_0x18f579['isGroup']){if(_0x31ddaf['summaries']&&typeof _0x31ddaf[_0x101ec1(0x144d)]===_0x101ec1(0xc74)){let _0x164384=0x0;for(const _0x205374 in _0x31ddaf['summaries']){const _0x3c3139=_0x31ddaf['summaries'][_0x205374];if(_0x3c3139&&_0x3c3139[_0x101ec1(0x13bc)]()){const _0x30834d=Object[_0x101ec1(0x244)](_0x53d851[_0x101ec1(0xaa3)])['find'](_0x50101f=>_0x50101f['originalName']===_0x205374);if(_0x30834d){const _0x2bcfc7={'content':_0x3c3139[_0x101ec1(0x13bc)](),'timestamp':Date[_0x101ec1(0x9c1)](),'source':_0x101ec1(0xb07)+_0x18f579[_0x101ec1(0x234)]};if(!_0x30834d[_0x101ec1(0x1016)])_0x30834d[_0x101ec1(0x1016)]=[];_0x30834d[_0x101ec1(0x1016)][_0x101ec1(0x7dd)](_0x2bcfc7),await _0xa62efb[_0x101ec1(0xaa3)][_0x101ec1(0x546)](_0x30834d),_0x164384++;}}}if(_0x164384>0x0)console['log'](_0x101ec1(0xee0)+_0x164384+_0x101ec1(0xb67));else throw new Error(_0x101ec1(0x125d));}else throw new Error(_0x101ec1(0xc06));}else{if(_0x31ddaf[_0x101ec1(0xee5)]&&_0x31ddaf['summary'][_0x101ec1(0x13bc)]()){const _0x193441={'content':_0x31ddaf[_0x101ec1(0xee5)][_0x101ec1(0x13bc)](),'timestamp':Date[_0x101ec1(0x9c1)](),'source':_0x101ec1(0x1157)};_0x18f579[_0x101ec1(0x1016)][_0x101ec1(0x7dd)](_0x193441),await _0xa62efb[_0x101ec1(0xaa3)][_0x101ec1(0x546)](_0x18f579),console[_0x101ec1(0x1081)](_0x101ec1(0xa88));}else throw new Error('AI返回了空的或格式不正确的总结内容。');}_0x18f579[_0x101ec1(0xa95)]=_0x15e70d[_0x101ec1(0x1340)](-0x1)[0x0][_0x101ec1(0x827)],await _0xa62efb[_0x101ec1(0xaa3)]['put'](_0x18f579),document[_0x101ec1(0x53a)]('long-term-memory-screen')[_0x101ec1(0x1276)][_0x101ec1(0x6a3)]('active')&&_0x11fbd6();}catch(_0x49b18d){console[_0x101ec1(0x617)]('总结长期记忆时出错:',_0x49b18d),await _0x184397('总结失败','操作失败:\x20'+_0x49b18d['message']);}}function _0x557ca2(){const _0x57e520=_0x13d875;if(!_0x3d3f39)return;const _0x463b23=_0x53d851[_0x57e520(0xaa3)][_0x53d851[_0x57e520(0x13be)]],_0x46a120=_0x463b23[_0x57e520(0xe83)][_0x57e520(0x397)](_0x5f2f13=>_0x5f2f13[_0x57e520(0x827)]===_0x3d3f39);if(!_0x46a120)return;let _0x45431e;_0x46a120[_0x57e520(0xb4d)]===_0x57e520(0x10ae)?_0x45431e=_0x463b23['isGroup']?_0x463b23['settings'][_0x57e520(0x1303)]||'我':'我':_0x463b23['isGroup']?_0x45431e=_0xf33fb2(_0x463b23,_0x46a120[_0x57e520(0xbee)]):_0x45431e=_0x463b23[_0x57e520(0x234)];const _0x53e4f2=String(_0x46a120[_0x57e520(0x73e)]||'');let _0x343037='';if(typeof _0x46a120[_0x57e520(0x73e)]===_0x57e520(0xfc5)&&_0x19cec7['test'](_0x46a120[_0x57e520(0x73e)]))_0x343037=_0x57e520(0xcb6);else{if(_0x46a120[_0x57e520(0x919)]===_0x57e520(0x2a5)||_0x46a120[_0x57e520(0x919)]===_0x57e520(0x1053))_0x343037='[图片]';else _0x46a120[_0x57e520(0x919)]===_0x57e520(0x64f)?_0x343037=_0x57e520(0xc72):_0x343037=_0x53e4f2[_0x57e520(0xad6)](0x0,0x32)+(_0x53e4f2[_0x57e520(0x29d)]>0x32?_0x57e520(0x95d):'');}_0x25ec6e={'timestamp':_0x46a120[_0x57e520(0x827)],'senderName':_0x45431e,'content':_0x53e4f2};const _0x541587=document[_0x57e520(0x53a)]('reply-preview-bar');_0x541587[_0x57e520(0x139c)](_0x57e520(0x1314))[_0x57e520(0x34a)]=_0x57e520(0x1399)+_0x25ec6e['senderName']+':',_0x541587[_0x57e520(0x139c)](_0x57e520(0xdb2))[_0x57e520(0x34a)]=_0x343037,_0x541587[_0x57e520(0x1284)][_0x57e520(0x11d9)]=_0x57e520(0x1ea),_0x294f69(),document['getElementById'](_0x57e520(0x2b1))['focus']();}function _0x33fd8c(){const _0x2fbbfd=_0x13d875;_0x25ec6e=null,document[_0x2fbbfd(0x53a)](_0x2fbbfd(0x1403))['style'][_0x2fbbfd(0x11d9)]=_0x2fbbfd(0xbf2);}let _0x398891=null;function _0x2014ee(_0x294f5d){const _0x33bac7=_0x13d875;_0x398891=_0x294f5d;const _0x3373e1=_0x53d851[_0x33bac7(0xaa3)][_0x53d851[_0x33bac7(0x13be)]],_0x5a317c=_0x3373e1[_0x33bac7(0xe83)][_0x33bac7(0x397)](_0x454be2=>_0x454be2[_0x33bac7(0x827)]===_0x294f5d);_0x5a317c&&(document['getElementById'](_0x33bac7(0x1351))[_0x33bac7(0x34a)]=_0x5a317c[_0x33bac7(0xbee)]),document[_0x33bac7(0x53a)]('transfer-actions-modal')[_0x33bac7(0x1276)][_0x33bac7(0xe13)](_0x33bac7(0xaef));}function _0x11ada4(){const _0xfd3401=_0x13d875;document[_0xfd3401(0x53a)]('transfer-actions-modal')[_0xfd3401(0x1276)][_0xfd3401(0x2d4)](_0xfd3401(0xaef)),_0x398891=null;}async function _0x59d079(_0x21c092){const _0x91c853=_0x13d875;if(!_0x398891)return;const _0x3d926b=_0x398891,_0x538d6a=_0x53d851[_0x91c853(0xaa3)][_0x53d851['activeChatId']],_0x3b53d0=_0x538d6a[_0x91c853(0xe83)]['findIndex'](_0x177b5b=>_0x177b5b[_0x91c853(0x827)]===_0x3d926b);if(_0x3b53d0===-0x1)return;const _0x531b02=_0x538d6a['history'][_0x3b53d0];_0x531b02['status']=_0x21c092;let _0x23f1a0;if(_0x21c092===_0x91c853(0xe65)){const _0x5b3ec5={'role':'user','type':_0x91c853(0x566),'isRefund':!![],'amount':_0x531b02[_0x91c853(0x1146)],'note':_0x91c853(0xce0),'timestamp':Date[_0x91c853(0x9c1)]()};_0x538d6a[_0x91c853(0xe83)][_0x91c853(0x7dd)](_0x5b3ec5),_0x23f1a0='[系统提示：你拒绝并退还了“'+_0x531b02[_0x91c853(0xbee)]+'”的转账。]';}else _0x23f1a0=_0x91c853(0x3b0)+_0x531b02[_0x91c853(0xbee)]+_0x91c853(0xcd1);const _0xeb03f2={'role':_0x91c853(0xab3),'content':_0x23f1a0,'timestamp':Date[_0x91c853(0x9c1)]()+0x1,'isHidden':!![]};_0x538d6a['history'][_0x91c853(0x7dd)](_0xeb03f2),await _0xa62efb[_0x91c853(0xaa3)][_0x91c853(0x546)](_0x538d6a),_0x11ada4(),_0x60f53f(_0x53d851[_0x91c853(0x13be)]),_0x5001a4();}async function _0x141945(){const _0x259b30=_0x13d875;_0x541a81(_0x259b30(0x770));const _0x20a2f1=document['getElementById'](_0x259b30(0xe7e)),_0x5ddb39=document[_0x259b30(0x53a)]('call-history-title');_0x20a2f1[_0x259b30(0xaac)]='',_0x5ddb39[_0x259b30(0x34a)]=_0x259b30(0xd7f);const _0x2f05cd=await _0xa62efb[_0x259b30(0x346)][_0x259b30(0x1064)](_0x259b30(0x827))[_0x259b30(0x843)]()[_0x259b30(0xa73)]();if(_0x2f05cd[_0x259b30(0x29d)]===0x0){_0x20a2f1[_0x259b30(0xaac)]=_0x259b30(0x11a0);return;}_0x2f05cd['forEach'](_0x30add8=>{const _0x67525d=_0x259b30,_0x1cf35b=_0x39b1fb(_0x30add8);_0x3146aa(_0x1cf35b,async()=>{const _0x4f0cda=_0x55b8,_0x1569b1=await _0x4f6537(_0x4f0cda(0x220),_0x4f0cda(0xecf),_0x30add8[_0x4f0cda(0xf7b)]||'');if(_0x1569b1===null)return;await _0xa62efb[_0x4f0cda(0x346)][_0x4f0cda(0xc03)](_0x30add8['id'],{'customName':_0x1569b1[_0x4f0cda(0x13bc)]()}),await _0x141945(),await _0x184397('成功','通话名称已更新！');}),_0x20a2f1[_0x67525d(0x133d)](_0x1cf35b);});}function _0x39b1fb(_0x5ec652){const _0x46cf91=_0x13d875,_0x498c20=document['createElement'](_0x46cf91(0x1425));_0x498c20['className']=_0x46cf91(0xbf5),_0x498c20[_0x46cf91(0x999)][_0x46cf91(0x26a)]=_0x5ec652['id'];const _0x1e1a0d=_0x53d851[_0x46cf91(0xaa3)][_0x5ec652[_0x46cf91(0x1054)]],_0x4da698=_0x1e1a0d?_0x1e1a0d[_0x46cf91(0x234)]:_0x46cf91(0x11d6),_0x4bb237=new Date(_0x5ec652[_0x46cf91(0x827)]),_0x3259f2=_0x4bb237['getFullYear']()+'-'+String(_0x4bb237[_0x46cf91(0x255)]()+0x1)[_0x46cf91(0x117e)](0x2,'0')+'-'+String(_0x4bb237[_0x46cf91(0xfae)]())[_0x46cf91(0x117e)](0x2,'0')+'\x20'+String(_0x4bb237[_0x46cf91(0x659)]())[_0x46cf91(0x117e)](0x2,'0')+':'+String(_0x4bb237[_0x46cf91(0xa77)]())['padStart'](0x2,'0'),_0x2c6500=Math[_0x46cf91(0x7d5)](_0x5ec652[_0x46cf91(0xb6a)]/0x3c)+'分'+_0x5ec652[_0x46cf91(0xb6a)]%0x3c+'秒',_0x5cdb18=_0x5ec652[_0x46cf91(0x574)][_0x46cf91(0xcb4)](_0x53dcab=>_0x46cf91(0x88b)+_0x53dcab['avatar']+_0x46cf91(0xa65)+_0x53dcab[_0x46cf91(0x234)]+_0x46cf91(0x1290)+_0x53dcab[_0x46cf91(0x234)]+'\x22>')[_0x46cf91(0x2c8)]('');return _0x498c20['innerHTML']=_0x46cf91(0x84a)+_0x3259f2+_0x46cf91(0xfc6)+_0x2c6500+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改】在这里新增一个标题行\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x5ec652[_0x46cf91(0xf7b)]?_0x46cf91(0x9ca)+_0x5ec652['customName']+'</div>':'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-info\x22>\x20<!--\x20新增一个容器方便布局\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-avatars\x22>'+_0x5cdb18+_0x46cf91(0x133b)+_0x4da698+_0x46cf91(0x98b),_0x498c20;}async function _0x41ff1f(_0x39851b){const _0x1641a6=_0x13d875,_0x4772fb=await _0xa62efb['callRecords'][_0x1641a6(0x883)](_0x39851b);if(!_0x4772fb)return;const _0x31f1a4=document[_0x1641a6(0x53a)]('call-transcript-modal'),_0x37b3d5=document[_0x1641a6(0x53a)](_0x1641a6(0x433)),_0x3f34d2=document['getElementById'](_0x1641a6(0x1176));_0x37b3d5[_0x1641a6(0x34a)]=_0x1641a6(0xa5d)+new Date(_0x4772fb[_0x1641a6(0x827)])[_0x1641a6(0x5ee)]()+_0x1641a6(0x110a)+Math[_0x1641a6(0x7d5)](_0x4772fb[_0x1641a6(0xb6a)]/0x3c)+'分'+_0x4772fb[_0x1641a6(0xb6a)]%0x3c+'秒)',_0x3f34d2[_0x1641a6(0xaac)]='';const _0x14bce0=document[_0x1641a6(0x53a)](_0x1641a6(0x1277)),_0x14e44e=document['getElementById']('manual-summarize-btn');!_0x4772fb[_0x1641a6(0x109a)]||_0x4772fb[_0x1641a6(0x109a)][_0x1641a6(0x29d)]===0x0?(_0x3f34d2[_0x1641a6(0xaac)]=_0x1641a6(0xe84),_0x14e44e[_0x1641a6(0x1284)][_0x1641a6(0x11d9)]='none'):(_0x14e44e[_0x1641a6(0x1284)]['display']=_0x1641a6(0x1ea),_0x4772fb['transcript']['forEach'](_0x288ce2=>{const _0x27ca3f=_0x1641a6,_0x1a564e=document['createElement'](_0x27ca3f(0x1425));_0x1a564e['className']='transcript-entry\x20'+_0x288ce2[_0x27ca3f(0xb4d)],_0x1a564e['textContent']=_0x288ce2['content'],_0x3f34d2[_0x27ca3f(0x133d)](_0x1a564e);}));const _0xa9a159=_0x14bce0['cloneNode'](!![]);_0x14bce0[_0x1641a6(0x9e8)][_0x1641a6(0xa1d)](_0xa9a159,_0x14bce0);const _0x31fae0=_0x14e44e[_0x1641a6(0x75a)](!![]);_0x14e44e[_0x1641a6(0x9e8)][_0x1641a6(0xa1d)](_0x31fae0,_0x14e44e),_0xa9a159[_0x1641a6(0x1086)](_0x1641a6(0xb2b),async()=>{const _0x10d994=_0x1641a6,_0x2d9c70=await _0x355fc0(_0x10d994(0x69a),_0x10d994(0x5bf),{'confirmButtonClass':_0x10d994(0x264)});_0x2d9c70&&(_0x31f1a4[_0x10d994(0x1276)]['remove'](_0x10d994(0xaef)),await _0xa62efb[_0x10d994(0x346)]['delete'](_0x39851b),await _0x141945(),alert(_0x10d994(0x1437)));}),_0x31fae0[_0x1641a6(0x1086)](_0x1641a6(0xb2b),async()=>{const _0x20110c=_0x1641a6,_0x5691e4=await _0x355fc0(_0x20110c(0x911),_0x20110c(0x12b2),{'confirmText':_0x20110c(0x1158)});if(!_0x5691e4)return;_0x31f1a4['classList']['remove'](_0x20110c(0xaef));const _0x6ec4f1=_0x53d851['chats'][_0x4772fb[_0x20110c(0x1054)]];if(!_0x6ec4f1){alert(_0x20110c(0x22a));return;}await _0x184397(_0x20110c(0x11d7),_0x20110c(0x132e));try{const _0x4f5f8c=_0x4772fb[_0x20110c(0x109a)]['map'](_0x304596=>{const _0x30bd99=_0x20110c,_0x167dca=_0x304596[_0x30bd99(0xb4d)]===_0x30bd99(0x10ae)?_0x6ec4f1[_0x30bd99(0x81e)]['myNickname']||'我':_0x304596[_0x30bd99(0xbee)]||_0x6ec4f1[_0x30bd99(0x234)];return _0x167dca+':\x20'+_0x304596[_0x30bd99(0x73e)];})['join']('\x0a');await _0x49b3fd(_0x4772fb[_0x20110c(0x1054)],_0x4f5f8c),await _0x184397(_0x20110c(0x258),_0x20110c(0x447)+_0x6ec4f1[_0x20110c(0x234)]+_0x20110c(0x936));}catch(_0x536778){await _0x184397('总结失败',_0x20110c(0xffe)+_0x536778['message']);}});const _0x25fd5a=document['getElementById'](_0x1641a6(0x2f5)),_0xe2a2b0=_0x25fd5a[_0x1641a6(0x75a)](!![]);_0x25fd5a['parentNode']['replaceChild'](_0xe2a2b0,_0x25fd5a),_0xe2a2b0['addEventListener']('click',()=>{const _0x10df81=_0x1641a6;_0x31f1a4[_0x10df81(0x1276)][_0x10df81(0x2d4)](_0x10df81(0xaef));}),_0x31f1a4['classList'][_0x1641a6(0xe13)](_0x1641a6(0xaef));}async function _0x30011f(){const _0x50fffe=_0x13d875;if(!_0x53d851['activeChatId']||_0x53d851[_0x50fffe(0xaa3)][_0x53d851[_0x50fffe(0x13be)]][_0x50fffe(0x86e)])return;const _0x3fa6b8=_0x53d851['chats'][_0x53d851[_0x50fffe(0x13be)]],_0x3f2711=await _0x4f6537(_0x50fffe(0xa79),_0x50fffe(0x63b),_0x3fa6b8[_0x50fffe(0x12d3)]['text']);_0x3f2711!==null&&(_0x3fa6b8['status'][_0x50fffe(0x2e6)]=_0x3f2711[_0x50fffe(0x13bc)]()||'在线',_0x3fa6b8[_0x50fffe(0x12d3)][_0x50fffe(0x99f)]=![],_0x3fa6b8[_0x50fffe(0x12d3)]['lastUpdate']=Date[_0x50fffe(0x9c1)](),await _0xa62efb[_0x50fffe(0xaa3)]['put'](_0x3fa6b8),_0x60f53f(_0x53d851['activeChatId']),_0x5001a4(),await _0x184397('状态已更新','“'+_0x3fa6b8[_0x50fffe(0x234)]+_0x50fffe(0x6c5)+_0x3fa6b8[_0x50fffe(0x12d3)][_0x50fffe(0x2e6)]));}async function _0x3f7155(){const _0x53e3c6=_0x13d875,_0x42e4d4=document[_0x53e3c6(0x53a)](_0x53e3c6(0x10de)),_0x48528c=document[_0x53e3c6(0x53a)](_0x53e3c6(0xcac));_0x48528c[_0x53e3c6(0xaac)]='';const _0x580fc4=Object[_0x53e3c6(0x244)](_0x53d851[_0x53e3c6(0xaa3)]);_0x580fc4[_0x53e3c6(0xeaf)](_0x4450cd=>{const _0x13902c=_0x53e3c6,_0x123cdf=document[_0x13902c(0xd67)]('div');_0x123cdf[_0x13902c(0x6de)]=_0x13902c(0xa94),_0x123cdf['innerHTML']=_0x13902c(0x102d)+_0x4450cd['id']+'\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x4450cd[_0x13902c(0x86e)]?_0x4450cd[_0x13902c(0x81e)]['groupAvatar']:_0x4450cd[_0x13902c(0x81e)]['aiAvatar']||_0x5d06c0)+_0x13902c(0x8c8)+_0x4450cd[_0x13902c(0x234)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x48528c[_0x13902c(0x133d)](_0x123cdf);}),_0x42e4d4[_0x53e3c6(0x1276)][_0x53e3c6(0xe13)](_0x53e3c6(0xaef));}function _0x21af99(_0x5716f4){const _0x1ead8a=_0x13d875,_0x30c349=document[_0x1ead8a(0x53a)](_0x1ead8a(0x424));if(!_0x30c349[_0x1ead8a(0x1276)][_0x1ead8a(0x6a3)](_0x1ead8a(0xaef))){if(_0x5716f4)_0x5716f4();return;}_0x30c349[_0x1ead8a(0x1276)][_0x1ead8a(0x2d4)](_0x1ead8a(0xaef)),setTimeout(()=>{const _0x93b144=_0x1ead8a;document[_0x93b144(0x53a)](_0x93b144(0xc01))[_0x93b144(0x1276)][_0x93b144(0x2d4)](_0x93b144(0xaef));if(_0x5716f4)_0x5716f4();},0x190);}function _0x5a24fc(_0x3ededf){const _0x298a62=_0x13d875;if(!_0x3ededf)return[];const _0xb2b1dc=String(_0x3ededf)[_0x298a62(0x13e8)](/\r\n?|\n/),_0x4037a8=[],_0x3902eb=/\[(\d{2}):(\d{2})[.:](\d{2,3})\]/g;for(const _0x210e90 of _0xb2b1dc){const _0x37c3f8=_0x210e90[_0x298a62(0x795)](_0x3902eb,'')[_0x298a62(0x13bc)]();if(!_0x37c3f8)continue;_0x3902eb[_0x298a62(0xe5e)]=0x0;let _0x983cfe;while((_0x983cfe=_0x3902eb[_0x298a62(0x2a8)](_0x210e90))!==null){const _0xdb4e27=parseInt(_0x983cfe[0x1],0xa),_0x494efb=parseInt(_0x983cfe[0x2],0xa),_0x9c8d02=parseInt(_0x983cfe[0x3][_0x298a62(0x6f2)](0x3,'0'),0xa),_0x38e64d=_0xdb4e27*0x3c+_0x494efb+_0x9c8d02/0x3e8;_0x4037a8[_0x298a62(0x7dd)]({'time':_0x38e64d,'text':_0x37c3f8});}}return _0x4037a8[_0x298a62(0xdb0)]((_0x40b6c3,_0x1357c3)=>_0x40b6c3[_0x298a62(0x1311)]-_0x1357c3['time']);}function _0x354707(){const _0x332673=_0x13d875,_0x481b8e=document[_0x332673(0x53a)](_0x332673(0x13bf));_0x481b8e['innerHTML']='';if(!_0x2eebda[_0x332673(0xd4b)]||_0x2eebda[_0x332673(0xd4b)][_0x332673(0x29d)]===0x0){_0x481b8e[_0x332673(0xaac)]=_0x332673(0xd33);return;}_0x2eebda[_0x332673(0xd4b)][_0x332673(0xeaf)]((_0x28cbf9,_0x3ff886)=>{const _0x401ea6=_0x332673,_0x5770fb=document[_0x401ea6(0xd67)](_0x401ea6(0x1425));_0x5770fb['className']='lyric-line',_0x5770fb[_0x401ea6(0x34a)]=_0x28cbf9[_0x401ea6(0x2e6)],_0x5770fb[_0x401ea6(0x999)]['index']=_0x3ff886,_0x481b8e['appendChild'](_0x5770fb);}),_0x481b8e[_0x332673(0x1284)][_0x332673(0xd91)]=_0x332673(0xcaa);}function _0x3b7731(_0x252a34){const _0x4a57e7=_0x13d875;if(_0x2eebda['parsedLyrics'][_0x4a57e7(0x29d)]===0x0)return;let _0x4a45d4=-0x1;for(let _0x56b13b=0x0;_0x56b13b<_0x2eebda[_0x4a57e7(0xd4b)][_0x4a57e7(0x29d)];_0x56b13b++){if(_0x252a34>=_0x2eebda[_0x4a57e7(0xd4b)][_0x56b13b]['time'])_0x4a45d4=_0x56b13b;else break;}if(_0x4a45d4===_0x2eebda[_0x4a57e7(0x10b2)])return;_0x2eebda[_0x4a57e7(0x10b2)]=_0x4a45d4,_0x216b10();const _0x5a760c=document['getElementById'](_0x4a57e7(0x1085));_0x5a760c&&(_0x4a45d4>-0x1&&_0x2eebda[_0x4a57e7(0xd4b)][_0x4a45d4]?_0x5a760c[_0x4a57e7(0x34a)]=_0x2eebda[_0x4a57e7(0xd4b)][_0x4a45d4][_0x4a57e7(0x2e6)]:_0x5a760c['textContent']=_0x4a57e7(0x59b));const _0x2be4e7=document['getElementById']('global-lyrics-bar');_0x2be4e7[_0x4a57e7(0x1276)]['contains'](_0x4a57e7(0xaef))&&(_0x4a45d4>-0x1&&_0x2eebda['parsedLyrics'][_0x4a45d4]?_0x2be4e7[_0x4a57e7(0x34a)]=_0x2eebda[_0x4a57e7(0xd4b)][_0x4a45d4][_0x4a57e7(0x2e6)]:_0x2be4e7[_0x4a57e7(0x34a)]='♪');}function _0x216b10(_0x1bd611=![]){const _0x1c097e=_0x13d875,_0x262251=_0x1bd611?_0x1c097e(0x25f):_0x1c097e(0x1299),_0x4f0072=_0x1bd611?_0x1c097e(0x1248):_0x1c097e(0x3e0),_0x5b01a3=document['querySelector'](_0x262251),_0x77aace=document[_0x1c097e(0x139c)](_0x4f0072);if(!_0x5b01a3||!_0x77aace)return;const _0x4eeabb=_0x5b01a3['querySelectorAll'](_0x1c097e(0x12a7));_0x4eeabb[_0x1c097e(0xeaf)](_0x1b99e9=>_0x1b99e9['classList']['remove']('active'));if(_0x2eebda[_0x1c097e(0x10b2)]===-0x1){_0x5b01a3[_0x1c097e(0x1284)][_0x1c097e(0xd91)]=_0x1c097e(0xcaa);return;}const _0x11452f=_0x5b01a3['querySelector'](_0x1c097e(0xaa6)+_0x2eebda['currentLyricIndex']+'\x22]');if(_0x11452f){_0x11452f[_0x1c097e(0x1276)][_0x1c097e(0xe13)](_0x1c097e(0xdf6));const _0x17c1b1=_0x77aace[_0x1c097e(0x127d)],_0x30a4f0=_0x17c1b1/2.2-_0x11452f['offsetTop']-_0x11452f[_0x1c097e(0x127d)]/0x2;_0x5b01a3[_0x1c097e(0x1284)][_0x1c097e(0xd91)]='translateY('+_0x30a4f0+_0x1c097e(0xe19);}}function _0x27d8fc(_0x2b8b65){const _0x5b32ae=_0x13d875;if(isNaN(_0x2b8b65)||_0x2b8b65<0x0)return _0x5b32ae(0x475);const _0x4e1e6b=Math[_0x5b32ae(0x7d5)](_0x2b8b65/0x3c),_0x1e3974=Math['floor'](_0x2b8b65%0x3c);return _0x4e1e6b+':'+String(_0x1e3974)[_0x5b32ae(0x117e)](0x2,'0');}let _0x5cd0b3=0x0,_0xb0fd9f;function _0x255c27(){_0xb0fd9f&&cancelAnimationFrame(_0xb0fd9f);function _0xbcb9f7(){const _0x1df479=_0x55b8;if(!_0x2eebda[_0x1df479(0x5a4)]||!_0x2a3e73[_0x1df479(0xb6a)])return;const _0x51cd8d=performance[_0x1df479(0x9c1)](),_0x12d64b=_0x2a3e73[_0x1df479(0x13d0)],_0x128678=_0x2a3e73['duration'],_0x39784a=_0x12d64b/_0x128678*0x64;document['getElementById'](_0x1df479(0x5ff))[_0x1df479(0x1284)]['width']=_0x39784a+'%',_0x51cd8d-_0x5cd0b3>0x3e8&&(document[_0x1df479(0x53a)](_0x1df479(0x4e2))[_0x1df479(0x34a)]=_0x27d8fc(_0x12d64b),document[_0x1df479(0x53a)](_0x1df479(0xdbf))['textContent']=_0x27d8fc(_0x128678),_0x5cd0b3=_0x51cd8d),_0x3b7731(_0x12d64b),_0xb0fd9f=requestAnimationFrame(_0xbcb9f7);}_0xb0fd9f=requestAnimationFrame(_0xbcb9f7);}function _0x13426b(){const _0x4d96ed=_0x13d875;if(!lastRawAiResponse){alert('还没有可供编辑的AI响应。请先让AI回复一次。');return;}const _0x2620ad=document[_0x4d96ed(0x53a)](_0x4d96ed(0x210)),_0x270b32=document['getElementById']('ai-response-editor-container');_0x270b32['innerHTML']='';const _0x2fb001=lastRawAiResponse[_0x4d96ed(0x1120)](/{[^{}]*}/g);if(_0x2fb001)_0x2fb001[_0x4d96ed(0xeaf)](_0x238df8=>{const _0x12ece9=_0x4d96ed;try{const _0x58c29c=JSON[_0x12ece9(0x367)](_0x238df8),_0x1b5587=JSON[_0x12ece9(0xe1e)](_0x58c29c,null,0x2),_0x3806f8=_0x2e41c7(_0x1b5587);_0x270b32[_0x12ece9(0x133d)](_0x3806f8);}catch(_0x2ec5dc){const _0x5a0dab=_0x2e41c7(_0x238df8);_0x270b32[_0x12ece9(0x133d)](_0x5a0dab),console['warn'](_0x12ece9(0xba7),_0x238df8);}});else{const _0x4096d6=_0x2e41c7(lastRawAiResponse);_0x270b32[_0x4d96ed(0x133d)](_0x4096d6);}_0x2620ad[_0x4d96ed(0x1276)][_0x4d96ed(0xe13)](_0x4d96ed(0xaef));}function _0x2e41c7(_0x4283f5=''){const _0x1b1234=_0x13d875,_0x524b7b=document[_0x1b1234(0xd67)](_0x1b1234(0x1425));_0x524b7b[_0x1b1234(0x6de)]='ai-response-editor-block';const _0x263972={'text':{'type':'text','content':_0x1b1234(0xefa)},'sticker':{'type':_0x1b1234(0x257),'url':_0x1b1234(0x52a),'meaning':_0x1b1234(0xcaf)},'image':{'type':'ai_image','description':_0x1b1234(0x399)},'voice':{'type':_0x1b1234(0x64f),'content':'在这里输入语音内容...'},'transfer':{'type':_0x1b1234(0x566),'amount':5.2,'note':_0x1b1234(0x121a)},'offline':{'type':_0x1b1234(0x8c3),'content':_0x1b1234(0x1316)},'quote':{'type':'quote_reply','target_timestamp':0x499602d2,'reply_content':_0x1b1234(0xd93)}};return _0x524b7b['innerHTML']=_0x1b1234(0x831)+_0x4283f5+_0x1b1234(0xb9c)+JSON['stringify'](_0x263972[_0x1b1234(0x2e6)])+'\x27>文本</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x1b1234(0xe1e)](_0x263972[_0x1b1234(0x257)])+_0x1b1234(0xbbf)+JSON['stringify'](_0x263972[_0x1b1234(0xace)])+'\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x1b1234(0xe1e)](_0x263972[_0x1b1234(0x3d0)])+_0x1b1234(0x886)+JSON[_0x1b1234(0xe1e)](_0x263972[_0x1b1234(0x566)])+_0x1b1234(0x104d)+JSON[_0x1b1234(0xe1e)](_0x263972[_0x1b1234(0x450)])+'\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改2】在这里添加新的“引用”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x1b1234(0xe1e)](_0x263972[_0x1b1234(0x6a2)])+_0x1b1234(0x746),_0x524b7b[_0x1b1234(0x139c)](_0x1b1234(0x425))[_0x1b1234(0x1086)](_0x1b1234(0xb2b),()=>{const _0x4f4c28=_0x1b1234;_0x524b7b[_0x4f4c28(0x2d4)]();}),_0x524b7b[_0x1b1234(0xc3d)](_0x1b1234(0x12be))['forEach'](_0xbcddd8=>{const _0x3fbe9e=_0x1b1234;_0xbcddd8[_0x3fbe9e(0x1086)](_0x3fbe9e(0xb2b),()=>{const _0x5b5d89=_0x3fbe9e,_0x4118cd=_0xbcddd8['dataset']['template'],_0x519549=_0x524b7b['querySelector'](_0x5b5d89(0x728));if(_0x4118cd&&_0x519549)try{const _0x4787d6=JSON[_0x5b5d89(0x367)](_0x4118cd);_0x519549[_0x5b5d89(0x11a2)]=JSON[_0x5b5d89(0xe1e)](_0x4787d6,null,0x2),_0x519549['focus']();}catch(_0x99a76f){console['error'](_0x5b5d89(0x674),_0x99a76f);}});}),_0x524b7b;}async function _0x5aa38b(){const _0xcec9a7=_0x13d875,_0x23718d=_0x53d851[_0xcec9a7(0xaa3)][_0x53d851[_0xcec9a7(0x13be)]];if(!_0x23718d)return;const _0x32c969=document['getElementById']('ai-response-editor-container'),_0x36272f=_0x32c969[_0xcec9a7(0xc3d)](_0xcec9a7(0x728)),_0x57fe9a=Array['from'](_0x36272f)[_0xcec9a7(0xcb4)](_0x4ef85e=>_0x4ef85e[_0xcec9a7(0x11a2)]['trim']())['filter'](Boolean);if(_0x57fe9a[_0xcec9a7(0x29d)]===0x0){_0x23718d[_0xcec9a7(0xe83)]=_0x23718d[_0xcec9a7(0xe83)][_0xcec9a7(0x2dd)](_0x4e6ae7=>!lastResponseTimestamps[_0xcec9a7(0x6e9)](_0x4e6ae7[_0xcec9a7(0x827)])),await _0xa62efb[_0xcec9a7(0xaa3)]['put'](_0x23718d),_0x60f53f(_0x53d851['activeChatId']),_0x5001a4(),document[_0xcec9a7(0x53a)](_0xcec9a7(0x210))[_0xcec9a7(0x1276)][_0xcec9a7(0x2d4)]('visible'),lastRawAiResponse='',lastResponseTimestamps=[];return;}let _0x499b5c=[];for(const _0x4a3ccd of _0x57fe9a){try{const _0x2e97d0=JSON[_0xcec9a7(0x367)](_0x4a3ccd);_0x499b5c[_0xcec9a7(0x7dd)](_0x2e97d0);}catch(_0x395b2a){console[_0xcec9a7(0xad0)](_0xcec9a7(0x1247),_0x4a3ccd);}}_0x23718d[_0xcec9a7(0xe83)]=_0x23718d[_0xcec9a7(0xe83)][_0xcec9a7(0x2dd)](_0x2e7729=>!lastResponseTimestamps[_0xcec9a7(0x6e9)](_0x2e7729[_0xcec9a7(0x827)]));let _0x7b9b65=[],_0x54d31e=Date[_0xcec9a7(0x9c1)]();for(const _0x55e7ef of _0x499b5c){if(!_0x55e7ef||typeof _0x55e7ef!==_0xcec9a7(0xc74)||!_0x55e7ef[_0xcec9a7(0x919)]){console['warn'](_0xcec9a7(0xb63),_0x55e7ef);continue;}let _0x316fe6=null;const _0x36b9cd={'role':_0xcec9a7(0xac5),'senderName':_0x55e7ef[_0xcec9a7(0x234)]||_0x23718d['originalName'],'timestamp':_0x54d31e++};switch(_0x55e7ef[_0xcec9a7(0x919)]){case _0xcec9a7(0x2e6):_0x316fe6={..._0x36b9cd,'content':String(_0x55e7ef['content']||_0x55e7ef['message'])};break;case'sticker':{let _0x3c1b58=![];if(_0x55e7ef['url']&&_0x55e7ef[_0xcec9a7(0x75f)])_0x316fe6={..._0x36b9cd,'type':_0xcec9a7(0x257),'content':_0x55e7ef[_0xcec9a7(0xb36)],'meaning':_0x55e7ef[_0xcec9a7(0x75f)]},console[_0xcec9a7(0x1081)](_0xcec9a7(0x266)),_0x3c1b58=!![];else{if(_0x55e7ef['meaning']){const _0xc0368b=_0x53d851[_0xcec9a7(0xf8f)][_0xcec9a7(0x397)](_0x29aa50=>_0x29aa50['name']===_0x55e7ef['meaning']);_0xc0368b?(_0x316fe6={..._0x36b9cd,'type':_0xcec9a7(0x257),'content':_0xc0368b[_0xcec9a7(0xb36)],'meaning':_0xc0368b[_0xcec9a7(0x234)]},console[_0xcec9a7(0x1081)](_0xcec9a7(0x704)),_0x3c1b58=!![]):(_0x316fe6={..._0x36b9cd,'type':_0xcec9a7(0x2e6),'content':_0xcec9a7(0x6b1)+_0x55e7ef[_0xcec9a7(0x75f)]+']'},console[_0xcec9a7(0xad0)]('导演模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:',_0x55e7ef[_0xcec9a7(0x75f)]),_0x3c1b58=!![]);}else{if(_0x55e7ef[_0xcec9a7(0xb36)]){_0x316fe6={..._0x36b9cd,'type':_0xcec9a7(0x257),'content':_0x55e7ef[_0xcec9a7(0xb36)]};const _0x4c0f2a=_0x53d851[_0xcec9a7(0xf8f)]['find'](_0x5962be=>_0x5962be[_0xcec9a7(0xb36)]===_0x55e7ef[_0xcec9a7(0xb36)]);_0x316fe6[_0xcec9a7(0x75f)]=_0x4c0f2a?_0x4c0f2a[_0xcec9a7(0x234)]:_0xcec9a7(0x8ad),console[_0xcec9a7(0x1081)](_0xcec9a7(0x2f3),_0x316fe6[_0xcec9a7(0x75f)]),_0x3c1b58=!![];}else{if(_0x55e7ef[_0xcec9a7(0x73e)]&&typeof _0x55e7ef[_0xcec9a7(0x73e)]===_0xcec9a7(0xfc5)&&_0x19cec7[_0xcec9a7(0x7f2)](_0x55e7ef[_0xcec9a7(0x73e)])){_0x316fe6={..._0x36b9cd,'type':'sticker','content':_0x55e7ef[_0xcec9a7(0x73e)]};const _0x3f6ec1=_0x53d851['userStickers'][_0xcec9a7(0x397)](_0x3c6088=>_0x3c6088['url']===_0x55e7ef[_0xcec9a7(0x73e)]);_0x316fe6[_0xcec9a7(0x75f)]=_0x3f6ec1?_0x3f6ec1[_0xcec9a7(0x234)]:_0xcec9a7(0x8ad),console['log']('导演模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:',_0x316fe6[_0xcec9a7(0x75f)]),_0x3c1b58=!![];}}}}if(!_0x3c1b58){console[_0xcec9a7(0x617)](_0xcec9a7(0x90b),_0x55e7ef);continue;}break;}case _0xcec9a7(0x2a5):_0x316fe6={..._0x36b9cd,'type':_0xcec9a7(0x2a5),'content':_0x55e7ef[_0xcec9a7(0xa60)]};break;case _0xcec9a7(0x64f):_0x316fe6={..._0x36b9cd,'type':_0xcec9a7(0x64f),'content':_0x55e7ef['content']};break;case _0xcec9a7(0x566):_0x316fe6={..._0x36b9cd,'type':_0xcec9a7(0x566),'amount':_0x55e7ef[_0xcec9a7(0x1146)],'note':_0x55e7ef[_0xcec9a7(0xbb0)],'receiverName':_0x55e7ef[_0xcec9a7(0xd38)]||'我'};break;case _0xcec9a7(0x1206):_0x316fe6={..._0x36b9cd,'type':_0xcec9a7(0x1206),'productInfo':_0x55e7ef['productInfo'],'amount':_0x55e7ef[_0xcec9a7(0x1146)],'status':_0xcec9a7(0x43a),'countdownEndTime':Date[_0xcec9a7(0x9c1)]()+0xf*0x3c*0x3e8};break;case _0xcec9a7(0x8c3):_0x316fe6={..._0x36b9cd,..._0x55e7ef};break;case _0xcec9a7(0x118d):{const _0x2b2b37=_0x4b8524[_0x23718d['id']];if(_0x2b2b37){const _0x3b452b=_0x2b2b37[_0xcec9a7(0xe83)]['findLastIndex'](_0x233fe4=>_0x233fe4['player']===0x2);if(_0x3b452b>-0x1){const _0x42555a=_0x2b2b37[_0xcec9a7(0xe83)][_0x3b452b];_0x2b2b37[_0xcec9a7(0x3be)][_0x42555a['y']][_0x42555a['x']]=0x0,_0x2b2b37[_0xcec9a7(0xe83)][_0xcec9a7(0x1331)](_0x3b452b,0x1),console['log']('导演模式悔棋：已撤销AI在\x20('+_0x42555a['x']+',\x20'+_0x42555a['y']+_0xcec9a7(0x27e));}}const _0x1442a6=parseInt(_0x55e7ef['x']),_0x25b75f=parseInt(_0x55e7ef['y']);!isNaN(_0x1442a6)&&!isNaN(_0x25b75f)?_0x5e0cf2({'x':_0x1442a6,'y':_0x25b75f},!![]):console[_0xcec9a7(0xad0)]('导演模式保存了一个无效的五子棋移动指令:',_0x55e7ef);continue;}case _0xcec9a7(0x7ed):{if(!_0x23718d[_0xcec9a7(0x86e)]){_0x55e7ef[_0xcec9a7(0x961)]&&(_0x23718d[_0xcec9a7(0x13cb)]=String(_0x55e7ef[_0xcec9a7(0x961)]));_0x55e7ef['random_jottings']&&(_0x23718d[_0xcec9a7(0xc35)]=String(_0x55e7ef['random_jottings']));!Array['isArray'](_0x23718d[_0xcec9a7(0xf2c)])&&(_0x23718d['thoughtsHistory']=[]);_0x23718d['thoughtsHistory']['push']({'heartfeltVoice':_0x23718d[_0xcec9a7(0x13cb)],'randomJottings':_0x23718d['randomJottings'],'timestamp':Date['now']()});_0x23718d['thoughtsHistory'][_0xcec9a7(0x29d)]>0x32&&_0x23718d['thoughtsHistory']['shift']();const _0xfa1cc1=_0xcec9a7(0x119e)+_0x23718d[_0xcec9a7(0x13cb)]+'\x0a-\x20散记:\x20'+_0x23718d[_0xcec9a7(0xc35)],_0x2fa771={'role':_0xcec9a7(0xab3),'content':_0xfa1cc1,'timestamp':Date[_0xcec9a7(0x9c1)](),'isHidden':!![]};}continue;}case _0xcec9a7(0x765):{const _0x52ddeb=_0x23718d[_0xcec9a7(0xe83)]['find'](_0x2941f3=>_0x2941f3['timestamp']===_0x55e7ef['target_timestamp']);let _0x2beed2=null;if(_0x52ddeb){let _0x2f9d9b=_0x52ddeb[_0xcec9a7(0xbee)];_0x52ddeb[_0xcec9a7(0xb4d)]===_0xcec9a7(0x10ae)&&(_0x2f9d9b=_0x23718d['isGroup']?_0x23718d[_0xcec9a7(0x81e)][_0xcec9a7(0x1303)]||'我':_0x53d851['qzoneSettings'][_0xcec9a7(0x1005)]||_0xcec9a7(0x8ac)),_0x2beed2={'timestamp':_0x55e7ef[_0xcec9a7(0xfb5)],'senderName':_0x2f9d9b,'content':String(_0x52ddeb[_0xcec9a7(0x73e)]||'')};}else _0x2beed2={'timestamp':_0x55e7ef[_0xcec9a7(0xfb5)],'senderName':_0xcec9a7(0x126b),'content':'原始消息已删除或不存在'};_0x316fe6={..._0x36b9cd,'content':_0x55e7ef[_0xcec9a7(0xf88)],'quote':_0x2beed2};break;}default:console[_0xcec9a7(0xad0)](_0xcec9a7(0x639),_0x55e7ef[_0xcec9a7(0x919)]);break;}_0x316fe6&&(_0x23718d[_0xcec9a7(0xe83)][_0xcec9a7(0x7dd)](_0x316fe6),_0x7b9b65[_0xcec9a7(0x7dd)](_0x316fe6[_0xcec9a7(0x827)]));}await _0xa62efb[_0xcec9a7(0xaa3)][_0xcec9a7(0x546)](_0x23718d),_0x60f53f(_0x53d851[_0xcec9a7(0x13be)]),_0x5001a4(),document[_0xcec9a7(0x53a)](_0xcec9a7(0x210))[_0xcec9a7(0x1276)][_0xcec9a7(0x2d4)]('visible'),lastRawAiResponse=_0x57fe9a['join']('\x0a\x0a'),lastResponseTimestamps=_0x7b9b65,await _0x184397(_0xcec9a7(0x1065),_0xcec9a7(0xa0d));}async function _0x2455b5(){const _0x4809e2=_0x13d875;if(!_0x3d3f39)return;const _0x47f509=0x2*0x3c*0x3e8,_0x263f49=_0x3d3f39,_0x863343=Date[_0x4809e2(0x9c1)]();if(_0x863343-_0x263f49>_0x47f509){_0x294f69(),await _0x184397(_0x4809e2(0xeac),_0x4809e2(0xa7f));return;}await _0x322911(_0x263f49,!![]),_0x294f69();}async function _0x322911(_0x32bf3c,_0x56fa53){const _0x484bec=_0x13d875,_0x521d34=_0x53d851['chats'][_0x53d851[_0x484bec(0x13be)]];if(!_0x521d34)return;const _0x374875=_0x521d34[_0x484bec(0xe83)]['findIndex'](_0x5ea46a=>_0x5ea46a[_0x484bec(0x827)]===_0x32bf3c);if(_0x374875===-0x1)return;const _0x428aa9=_0x521d34[_0x484bec(0xe83)][_0x374875],_0x1a2959={'originalType':_0x428aa9[_0x484bec(0x919)]||'text','originalContent':_0x428aa9[_0x484bec(0x73e)],'originalMeaning':_0x428aa9[_0x484bec(0x75f)],'originalQuote':_0x428aa9[_0x484bec(0x6a2)]};_0x428aa9[_0x484bec(0x919)]=_0x484bec(0x5cf),_0x428aa9['content']=_0x56fa53?_0x484bec(0x9ea):_0x484bec(0x1143),_0x428aa9[_0x484bec(0x138a)]=_0x1a2959,delete _0x428aa9['meaning'],delete _0x428aa9[_0x484bec(0x6a2)];if(_0x56fa53){const _0x568b12=_0x521d34['isGroup']?_0x521d34[_0x484bec(0x81e)][_0x484bec(0x1303)]||'我':'我';let _0x533082='';if(_0x1a2959[_0x484bec(0x1384)]==='sticker')_0x533082=_0x484bec(0x1e9)+(_0x1a2959['originalMeaning']||'未知')+']';else _0x1a2959[_0x484bec(0x1384)]===_0x484bec(0x2a5)||_0x1a2959[_0x484bec(0x1384)]===_0x484bec(0x1053)?_0x533082=_0x484bec(0x8b1)+_0x1a2959[_0x484bec(0x124b)]+']':_0x533082='“'+String(_0x1a2959[_0x484bec(0x124b)])+'”';const _0x1174c7={'role':_0x484bec(0xab3),'content':_0x484bec(0x41c)+_0x568b12+_0x484bec(0x8cc)+_0x533082+_0x484bec(0x44c),'timestamp':Date[_0x484bec(0x9c1)](),'isHidden':!![]};_0x521d34['history'][_0x484bec(0x7dd)](_0x1174c7);}await _0xa62efb[_0x484bec(0xaa3)][_0x484bec(0x546)](_0x521d34),_0x60f53f(_0x53d851['activeChatId']),_0x56fa53&&(_0x5001a4(),_0x5403b5());}async function _0x2c8734(){const _0xe41b63=_0x13d875;await _0x4eff64(),document[_0xe41b63(0x53a)]('world-book-category-manager-modal')['classList'][_0xe41b63(0xe13)]('visible');}async function _0x4eff64(){const _0x33cac2=_0x13d875,_0xda0687=document['getElementById'](_0x33cac2(0xcd2)),_0x1f8729=await _0xa62efb['worldBookCategories'][_0x33cac2(0xa73)]();_0xda0687[_0x33cac2(0xaac)]='',_0x1f8729[_0x33cac2(0x29d)]===0x0&&(_0xda0687[_0x33cac2(0xaac)]=_0x33cac2(0xa16)),_0x1f8729['forEach'](_0x305e39=>{const _0x3a7296=_0x33cac2,_0x22beeb=document[_0x3a7296(0xd67)](_0x3a7296(0x1425));_0x22beeb[_0x3a7296(0x6de)]=_0x3a7296(0xebc),_0x22beeb[_0x3a7296(0xaac)]=_0x3a7296(0x12dc)+_0x305e39[_0x3a7296(0x234)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x305e39['id']+'\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xda0687[_0x3a7296(0x133d)](_0x22beeb);});}async function _0x380bc9(){const _0x568c49=_0x13d875,_0x7a5bd3=document[_0x568c49(0x53a)](_0x568c49(0x504)),_0x42772b=_0x7a5bd3['value']['trim']();if(!_0x42772b){alert(_0x568c49(0x1000));return;}const _0x4575c0=await _0xa62efb[_0x568c49(0xf5d)][_0x568c49(0x57e)](_0x568c49(0x234))[_0x568c49(0x12f6)](_0x42772b)[_0x568c49(0x7e6)]();if(_0x4575c0){alert('分类\x20\x22'+_0x42772b+'\x22\x20已经存在了！');return;}await _0xa62efb[_0x568c49(0xf5d)]['add']({'name':_0x42772b}),_0x7a5bd3[_0x568c49(0x11a2)]='',await _0x4eff64();}async function _0x11a111(_0x446a37){const _0x35b3d6=_0x13d875,_0x5038b1=await _0x355fc0('确认删除',_0x35b3d6(0x766),{'confirmButtonClass':'btn-danger'});if(_0x5038b1){await _0xa62efb[_0x35b3d6(0xf5d)]['delete'](_0x446a37);const _0x257c10=await _0xa62efb['worldBooks'][_0x35b3d6(0x57e)](_0x35b3d6(0xbcd))['equals'](_0x446a37)[_0x35b3d6(0xa73)]();for(const _0x3e1741 of _0x257c10){_0x3e1741[_0x35b3d6(0xbcd)]=null,await _0xa62efb[_0x35b3d6(0x10f2)][_0x35b3d6(0x546)](_0x3e1741);const _0x137459=_0x53d851[_0x35b3d6(0x10f2)][_0x35b3d6(0x397)](_0x353047=>_0x353047['id']===_0x3e1741['id']);if(_0x137459)_0x137459[_0x35b3d6(0xbcd)]=null;}await _0x4eff64();}}async function _0x3e6712(){const _0x9845a5=_0x13d875;if(!_0x3d3f39)return;const _0x246cce=_0x3d3f39;_0x294f69();const _0x3e6230=_0x53d851['chats'][_0x53d851['activeChatId']],_0x4c13bf=_0x3e6230[_0x9845a5(0xe83)][_0x9845a5(0x397)](_0x269714=>_0x269714[_0x9845a5(0x827)]===_0x246cce);if(!_0x4c13bf)return;let _0x453803=String(_0x4c13bf[_0x9845a5(0x73e)]||'')['substring'](0x0,0x32)+_0x9845a5(0x95d);if(_0x4c13bf['type']==='ai_image')_0x453803=_0x9845a5(0xd9a)+_0x453803;const _0x56e6bf=await _0x355fc0(_0x9845a5(0x4eb),'确定要将以下消息发布到公告板吗？\x0a\x0a“'+_0x453803+'”',{'confirmText':_0x9845a5(0xe3d)});if(_0x56e6bf){const _0x50999f=_0x3e6230['settings'][_0x9845a5(0x1303)]||'我';!Array[_0x9845a5(0xb31)](_0x3e6230['announcements'])&&(_0x3e6230['announcements']=[]);const _0x467f21={'id':_0x9845a5(0x1307)+Date[_0x9845a5(0x9c1)](),'messageTimestamp':_0x246cce,'publisher':_0x50999f,'publishedAt':Date['now'](),'isPinned':![]};_0x3e6230[_0x9845a5(0x12db)][_0x9845a5(0x7dd)](_0x467f21);const _0x378a20={'role':_0x9845a5(0xab3),'type':_0x9845a5(0x109b),'content':_0x50999f+'\x20发布了一条新公告','timestamp':Date[_0x9845a5(0x9c1)]()};_0x3e6230[_0x9845a5(0xe83)]['push'](_0x378a20),await _0xa62efb[_0x9845a5(0xaa3)][_0x9845a5(0x546)](_0x3e6230),_0xa4d65(_0x378a20,_0x3e6230),_0x5001a4(),await _0x184397('成功','公告已发布！');}}async function _0x3a1384(){const _0x3e431f=_0x13d875,_0x13d7e4=_0x53d851[_0x3e431f(0xaa3)][_0x53d851[_0x3e431f(0x13be)]],_0x1a25ed=_0x13d7e4['announcements']||[];if(!_0x13d7e4||_0x1a25ed[_0x3e431f(0x29d)]===0x0){_0x184397('提示',_0x3e431f(0x1028));return;}const _0x386160=document['getElementById']('announcement-board-content');_0x386160[_0x3e431f(0xaac)]='',_0x1a25ed[_0x3e431f(0xdb0)]((_0x19d31a,_0x2d5536)=>(_0x2d5536['isPinned']?0x1:0x0)-(_0x19d31a[_0x3e431f(0x4d4)]?0x1:0x0));for(const _0x5bc4cb of _0x1a25ed){const _0x2bd3bf=_0x13d7e4['history'][_0x3e431f(0x397)](_0xc4b66f=>_0xc4b66f[_0x3e431f(0x827)]===_0x5bc4cb[_0x3e431f(0xd65)]),_0x4df4d9=document[_0x3e431f(0xd67)](_0x3e431f(0x1425));_0x4df4d9[_0x3e431f(0x6de)]=_0x3e431f(0xa20);if(_0x2bd3bf){const _0x5e6baa=await _0x36bd8d(_0x2bd3bf,_0x13d7e4);_0x5e6baa&&_0x4df4d9['appendChild'](_0x5e6baa);}else _0x4df4d9[_0x3e431f(0xaac)]=_0x3e431f(0x8a9);_0x5bc4cb[_0x3e431f(0x4d4)]&&(_0x4df4d9['innerHTML']+=_0x3e431f(0x1ef)),_0x4df4d9['innerHTML']+=_0x3e431f(0x1062)+_0x5bc4cb['id']+_0x3e431f(0x686),_0x386160[_0x3e431f(0x133d)](_0x4df4d9);}document[_0x3e431f(0x53a)](_0x3e431f(0x385))[_0x3e431f(0x1276)]['add'](_0x3e431f(0xaef));}let _0x5764a3=null;function _0x2ff9f4(_0x17db27){const _0x207ce2=_0x13d875;_0x5764a3=_0x17db27;const _0x4cdf5c=_0x53d851[_0x207ce2(0xaa3)][_0x53d851[_0x207ce2(0x13be)]],_0x535e35=_0x4cdf5c[_0x207ce2(0x12db)][_0x207ce2(0x397)](_0x5ab4a1=>_0x5ab4a1['id']===_0x17db27);if(!_0x535e35)return;const _0x1c37c5=document['getElementById'](_0x207ce2(0x4b9));_0x1c37c5[_0x207ce2(0x34a)]=_0x535e35[_0x207ce2(0x4d4)]?'取消置顶':_0x207ce2(0x48f),document[_0x207ce2(0x53a)]('announcement-actions-modal')[_0x207ce2(0x1276)][_0x207ce2(0xe13)](_0x207ce2(0xaef));}async function _0x3356ac(){const _0x2d95bd=_0x13d875;if(!_0x5764a3)return;const _0xe441ac=_0x53d851[_0x2d95bd(0xaa3)][_0x53d851[_0x2d95bd(0x13be)]],_0x5e1f75=_0xe441ac[_0x2d95bd(0x12db)]['find'](_0x49dbd7=>_0x49dbd7['id']===_0x5764a3);_0x5e1f75&&(_0x5e1f75['isPinned']=!_0x5e1f75['isPinned'],await _0xa62efb[_0x2d95bd(0xaa3)][_0x2d95bd(0x546)](_0xe441ac),_0x3a1384()),document[_0x2d95bd(0x53a)](_0x2d95bd(0xf33))[_0x2d95bd(0x1276)][_0x2d95bd(0x2d4)](_0x2d95bd(0xaef));}async function _0x37a131(){const _0x387fcc=_0x13d875;if(!_0x5764a3)return;const _0x19757d=await _0x355fc0(_0x387fcc(0x69a),_0x387fcc(0xf39),{'confirmButtonClass':_0x387fcc(0x264)});if(_0x19757d){const _0x2685c7=_0x53d851[_0x387fcc(0xaa3)][_0x53d851[_0x387fcc(0x13be)]];_0x2685c7[_0x387fcc(0x12db)]=_0x2685c7[_0x387fcc(0x12db)][_0x387fcc(0x2dd)](_0x52d68d=>_0x52d68d['id']!==_0x5764a3),await _0xa62efb['chats']['put'](_0x2685c7),_0x3a1384();}document[_0x387fcc(0x53a)]('announcement-actions-modal')[_0x387fcc(0x1276)][_0x387fcc(0x2d4)](_0x387fcc(0xaef));}let _0x2c46d1=![],_0x515ef1={'ai':null,'my':null};function _0x3ef259(_0xb2f845=_0x13d875(0x2d8)){const _0x2d2138=_0x13d875,_0x4b2667=document[_0x2d2138(0x53a)](_0x2d2138(0x1084));if(!_0x53d851['activeChatId'])return;const _0xe35d4b=_0x53d851[_0x2d2138(0xaa3)][_0x53d851['activeChatId']];_0x2c46d1=_0xb2f845===_0x2d2138(0x111f);if(_0x2c46d1){const _0x3e85f6=_0xe35d4b['members']['find'](_0x5091fd=>_0x5091fd['id']===_0x4283ff);if(!_0x3e85f6)return;_0x515ef1['my']=_0x3e85f6[_0x2d2138(0x1069)]||'',_0x2a4fbf(!![],_0x3e85f6['avatar'],_0x3e85f6[_0x2d2138(0x1069)]);}else _0x515ef1['ai']=_0xe35d4b[_0x2d2138(0x81e)][_0x2d2138(0x2bf)]||'',_0x515ef1['my']=_0xe35d4b['settings'][_0x2d2138(0xf77)]||'',_0x2a4fbf(![]);_0x4b2667[_0x2d2138(0x1276)][_0x2d2138(0xe13)](_0x2d2138(0xaef));}function _0x2a4fbf(_0x3687f3=![],_0x4ad83e=null,_0x5b0dbb=null){const _0x4dc973=_0x13d875,_0x36f1b3=document[_0x4dc973(0x53a)](_0x4dc973(0x640)),_0x1c33e5=document[_0x4dc973(0x53a)](_0x4dc973(0x1037)),_0x4e5073=_0x53d851[_0x4dc973(0xaa3)][_0x53d851[_0x4dc973(0x13be)]];_0x36f1b3['innerHTML']='',_0x1c33e5[_0x4dc973(0xaac)]='',document[_0x4dc973(0x139c)](_0x4dc973(0x3a0))['style']['display']=_0x3687f3?'none':'flex',document[_0x4dc973(0x53a)](_0x4dc973(0x676))[_0x4dc973(0x1284)][_0x4dc973(0x11d9)]=_0x4dc973(0x1ea),document[_0x4dc973(0x53a)](_0x4dc973(0x7b7))['style'][_0x4dc973(0x11d9)]=_0x4dc973(0xbf2),document[_0x4dc973(0x53a)]('ai-frame-tab')['classList'][_0x4dc973(0xe13)](_0x4dc973(0xdf6)),document[_0x4dc973(0x53a)](_0x4dc973(0x126e))[_0x4dc973(0x1276)]['remove'](_0x4dc973(0xdf6));if(_0x3687f3)_0x903668['forEach'](_0x4c94f5=>{const _0x33cd76=_0x4dc973,_0x33e174=_0x47a309(_0x4c94f5,'my',_0x4ad83e);_0x4c94f5[_0x33cd76(0xb36)]===_0x5b0dbb&&_0x33e174[_0x33cd76(0x1276)][_0x33cd76(0xe13)](_0x33cd76(0x1015)),_0x36f1b3['appendChild'](_0x33e174);});else{const _0x5355dc=_0x4e5073['settings'][_0x4dc973(0x9e3)]||_0x5d06c0,_0x344730=_0x4e5073[_0x4dc973(0x81e)][_0x4dc973(0x971)]||(_0x4e5073['isGroup']?_0x132d11:_0x5d06c0);_0x903668[_0x4dc973(0xeaf)](_0x39ca64=>{const _0x182420=_0x4dc973,_0x490249=_0x47a309(_0x39ca64,'ai',_0x5355dc);if(_0x39ca64['url']===_0x515ef1['ai'])_0x490249[_0x182420(0x1276)][_0x182420(0xe13)](_0x182420(0x1015));_0x36f1b3[_0x182420(0x133d)](_0x490249);const _0x4ae7e6=_0x47a309(_0x39ca64,'my',_0x344730);if(_0x39ca64['url']===_0x515ef1['my'])_0x4ae7e6[_0x182420(0x1276)]['add'](_0x182420(0x1015));_0x1c33e5['appendChild'](_0x4ae7e6);});}}function _0x47a309(_0x40d61a,_0x26579c,_0x3c64af){const _0x829423=_0x13d875,_0x453314=document['createElement']('div');return _0x453314[_0x829423(0x6de)]=_0x829423(0x9b7),_0x453314[_0x829423(0x999)][_0x829423(0x2f0)]=_0x40d61a[_0x829423(0xb36)],_0x453314[_0x829423(0x667)]=_0x40d61a[_0x829423(0x234)],_0x453314[_0x829423(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x3c64af+_0x829423(0x9bd)+(_0x40d61a[_0x829423(0xb36)]?'<img\x20src=\x22'+_0x40d61a[_0x829423(0xb36)]+_0x829423(0xc9f):'')+_0x829423(0x495),_0x453314[_0x829423(0x1086)](_0x829423(0xb2b),()=>{const _0x235c5e=_0x829423;_0x515ef1[_0x26579c]=_0x40d61a['url'];const _0x50e90b=_0x26579c==='ai'?document[_0x235c5e(0x53a)]('ai-frame-grid'):document[_0x235c5e(0x53a)]('my-frame-grid');_0x50e90b[_0x235c5e(0xc3d)]('.frame-item')[_0x235c5e(0xeaf)](_0x211d14=>_0x211d14[_0x235c5e(0x1276)][_0x235c5e(0x2d4)](_0x235c5e(0x1015))),_0x453314[_0x235c5e(0x1276)][_0x235c5e(0xe13)](_0x235c5e(0x1015));}),_0x453314;}async function _0x464936(){const _0x430463=_0x13d875;if(!_0x53d851[_0x430463(0x13be)])return;const _0x55ed04=_0x53d851[_0x430463(0xaa3)][_0x53d851['activeChatId']];if(_0x2c46d1){const _0x4bdc0b=_0x55ed04['members'][_0x430463(0x397)](_0x2e77f9=>_0x2e77f9['id']===_0x4283ff);_0x4bdc0b&&(_0x4bdc0b[_0x430463(0x1069)]=_0x515ef1['my']);}else _0x55ed04[_0x430463(0x81e)][_0x430463(0x2bf)]=_0x515ef1['ai'],_0x55ed04[_0x430463(0x81e)]['myAvatarFrame']=_0x515ef1['my'];await _0xa62efb['chats'][_0x430463(0x546)](_0x55ed04);if(!_0x2c46d1&&!_0x55ed04[_0x430463(0x86e)]){const _0x4fca1b=_0x55ed04['id'];for(const _0x345204 of Object[_0x430463(0x244)](_0x53d851['chats'])){if(_0x345204['isGroup']&&_0x345204[_0x430463(0x3de)]){const _0x590f19=_0x345204[_0x430463(0x3de)][_0x430463(0x397)](_0xb62fc1=>_0xb62fc1['id']===_0x4fca1b);_0x590f19&&(_0x590f19[_0x430463(0x1069)]=_0x55ed04[_0x430463(0x81e)][_0x430463(0x2bf)],await _0xa62efb[_0x430463(0xaa3)][_0x430463(0x546)](_0x345204),console[_0x430463(0x1081)](_0x430463(0x136d)+_0x4fca1b+_0x430463(0x6f6)+_0x345204[_0x430463(0x234)]+'\x22'));}}}document['getElementById']('avatar-frame-modal')['classList'][_0x430463(0x2d4)](_0x430463(0xaef)),_0x60f53f(_0x53d851[_0x430463(0x13be)]),alert(_0x430463(0xf53)),_0x2c46d1=![];}function _0x1bedf7(){const _0x1d25ec=_0x13d875;_0x5a5ea7=!_0x5a5ea7;const _0x5e5653=document[_0x1d25ec(0x53a)](_0x1d25ec(0x1058)),_0x2bd2ca=document[_0x1d25ec(0x53a)](_0x1d25ec(0xcae)),_0x410ce3=document['getElementById'](_0x1d25ec(0x67c));document[_0x1d25ec(0xc3d)](_0x1d25ec(0x89c))[_0x1d25ec(0xeaf)](_0x5af615=>{const _0x3aa1eb=_0x1d25ec;_0x5af615[_0x3aa1eb(0x1276)]['toggle']('management-mode',_0x5a5ea7);}),_0x5a5ea7?(_0x5e5653[_0x1d25ec(0x34a)]='完成',_0x2bd2ca['style'][_0x1d25ec(0x11d9)]='flex',_0x4648e0[_0x1d25ec(0xfcf)](),_0x410ce3[_0x1d25ec(0x1077)]=![],_0x94bdcf()):(_0x5e5653[_0x1d25ec(0x34a)]='管理',_0x2bd2ca[_0x1d25ec(0x1284)][_0x1d25ec(0x11d9)]=_0x1d25ec(0xbf2),document[_0x1d25ec(0xc3d)](_0x1d25ec(0xd0d))['forEach'](_0x3e8b01=>{const _0x249153=_0x1d25ec;_0x3e8b01[_0x249153(0x1276)]['remove'](_0x249153(0x1015));}));}function _0x94bdcf(){const _0x2263a4=_0x13d875,_0x4469ee=document[_0x2263a4(0x53a)](_0x2263a4(0x130f));_0x4469ee[_0x2263a4(0x34a)]=_0x2263a4(0xf3c)+_0x4648e0['size']+')';}function _0x4f03b1(){const _0x101aee=_0x13d875,_0x5ea604=document[_0x101aee(0x53a)]('select-all-frames-checkbox')[_0x101aee(0x1077)],_0x54ba64=document[_0x101aee(0x139c)](_0x101aee(0x9f0));if(!_0x54ba64)return;_0x54ba64[_0x101aee(0xc3d)](_0x101aee(0xb9f))['forEach'](_0x4a5cfe=>{const _0x47ee73=_0x101aee,_0x4ac13d=parseInt(_0x4a5cfe[_0x47ee73(0x139c)](_0x47ee73(0xbd4))[_0x47ee73(0x999)]['id']);if(isNaN(_0x4ac13d))return;_0x4a5cfe[_0x47ee73(0x1276)][_0x47ee73(0x4d7)]('selected',_0x5ea604),_0x5ea604?_0x4648e0[_0x47ee73(0xe13)](_0x4ac13d):_0x4648e0[_0x47ee73(0x121e)](_0x4ac13d);}),_0x94bdcf();}async function _0x3dbc54(){const _0xf16bbf=_0x13d875;if(_0x4648e0[_0xf16bbf(0x38e)]===0x0)return;const _0x1561ec=await _0x355fc0(_0xf16bbf(0x69a),_0xf16bbf(0x2b0)+_0x4648e0[_0xf16bbf(0x38e)]+'\x20个自定义头像框吗？',{'confirmButtonClass':'btn-danger'});if(_0x1561ec){const _0x4c7c96=[..._0x4648e0];await _0xa62efb[_0xf16bbf(0xbdf)][_0xf16bbf(0x12e5)](_0x4c7c96),_0x1bedf7(),_0x2a4fbf(_0x2c46d1),await _0x184397('删除成功',_0xf16bbf(0xc1f));}}function _0x1c3306(_0x27efb5){const _0x51d7b7=_0x13d875,_0x5b6212=document['getElementById']('global-custom-style');_0x5b6212&&(_0x5b6212[_0x51d7b7(0xaac)]=_0x27efb5||'');}async function _0x363eee(_0x2a3e36){const _0x44293f=_0x13d875;if(!_0x2eebda[_0x44293f(0x975)]||!_0x2eebda[_0x44293f(0x13be)])return;const _0x54b614=_0x53d851[_0x44293f(0xaa3)][_0x2eebda[_0x44293f(0x13be)]];if(!_0x54b614)return;const _0x1f9223=_0x54b614[_0x44293f(0x86e)]?_0x54b614[_0x44293f(0x81e)][_0x44293f(0x1303)]||'我':'我',_0x4261e8='[系统提示：用户\x20('+_0x1f9223+')\x20'+_0x2a3e36+']',_0x44468a={'role':_0x44293f(0xab3),'content':_0x4261e8,'timestamp':Date[_0x44293f(0x9c1)](),'isHidden':!![]};_0x54b614['history'][_0x44293f(0x7dd)](_0x44468a),await _0xa62efb['chats'][_0x44293f(0x546)](_0x54b614);}async function _0x16a6f1(){const _0x5f31e6=_0x13d875;if(_0x373402[_0x5f31e6(0x38e)]===0x0)return;const _0x53b69f=_0x53d851['chats'][_0x53d851[_0x5f31e6(0x13be)]];if(!_0x53b69f)return;const _0x38ede1=document[_0x5f31e6(0x53a)](_0x5f31e6(0x67a)),_0x4c261f=_0x38ede1['textContent'];_0x38ede1[_0x5f31e6(0x34a)]='生成中...',_0x38ede1[_0x5f31e6(0xb77)]=!![];const _0x551dfa=document[_0x5f31e6(0xd67)]('div'),_0x3cff4d=document['getElementById'](_0x5f31e6(0xf87));_0x551dfa[_0x5f31e6(0x1284)]['width']=_0x3cff4d[_0x5f31e6(0xb6f)]+'px',_0x551dfa[_0x5f31e6(0x1284)][_0x5f31e6(0x5d3)]='absolute',_0x551dfa[_0x5f31e6(0x1284)][_0x5f31e6(0x624)]='-9999px',_0x551dfa[_0x5f31e6(0x1284)][_0x5f31e6(0xcd7)]=_0x5f31e6(0xf7c),_0x551dfa[_0x5f31e6(0x1284)][_0x5f31e6(0x11d9)]=_0x5f31e6(0x2f6),_0x551dfa[_0x5f31e6(0x1284)][_0x5f31e6(0xa02)]=_0x5f31e6(0xaf9),_0x551dfa[_0x5f31e6(0x1284)][_0x5f31e6(0xfeb)]=_0x5f31e6(0x1157);const _0x47f7c2=document['getElementById'](_0x5f31e6(0x10ba));_0x551dfa['style']['backgroundImage']=_0x47f7c2[_0x5f31e6(0x1284)][_0x5f31e6(0x2f2)],_0x551dfa[_0x5f31e6(0x1284)]['backgroundColor']=_0x47f7c2[_0x5f31e6(0x1284)][_0x5f31e6(0x615)]||(document[_0x5f31e6(0x53a)](_0x5f31e6(0xf87))['classList']['contains']('dark-mode')?_0x5f31e6(0x8f6):'#f0f2f5');const _0x1f40f8=document['createElement'](_0x5f31e6(0x1284));_0x1f40f8[_0x5f31e6(0xaac)]=_0x5f31e6(0x121d),document['head'][_0x5f31e6(0x133d)](_0x1f40f8);try{const _0x10e585=_0x47f7c2[_0x5f31e6(0x139c)](_0x5f31e6(0x76f))[_0x5f31e6(0x75a)](!![]);_0x10e585['classList'][_0x5f31e6(0xe13)](_0x5f31e6(0xed1));const _0x4f144b=document['createElement']('div'),_0x24327e=document['getElementById'](_0x5f31e6(0xa33));_0x4f144b[_0x5f31e6(0x1284)]['display']=_0x5f31e6(0x2f6),_0x4f144b[_0x5f31e6(0x1284)]['flexDirection']=_0x5f31e6(0xaf9),_0x4f144b[_0x5f31e6(0x1284)][_0x5f31e6(0xb44)]=_0x5f31e6(0x1217),_0x4f144b[_0x5f31e6(0x1284)][_0x5f31e6(0x847)]=_0x5f31e6(0xa4d),_0x4f144b[_0x5f31e6(0x1284)]['width']=_0x5f31e6(0x12d5),_0x4f144b[_0x5f31e6(0x1284)][_0x5f31e6(0xd1c)]=_0x5f31e6(0x759),_0x4f144b[_0x5f31e6(0x999)][_0x5f31e6(0x1297)]=_0x24327e[_0x5f31e6(0x999)][_0x5f31e6(0x1297)],_0x4f144b[_0x5f31e6(0x1284)]['setProperty'](_0x5f31e6(0xb86),_0x24327e[_0x5f31e6(0x1284)]['getPropertyValue'](_0x5f31e6(0xb86)));const _0x6a0c93=_0x47f7c2[_0x5f31e6(0x139c)](_0x5f31e6(0xb55))[_0x5f31e6(0x75a)](!![]),_0x213f89=[..._0x373402][_0x5f31e6(0xdb0)]((_0x52fd98,_0x29923d)=>_0x52fd98-_0x29923d);_0x213f89[_0x5f31e6(0xeaf)](_0x20eed9=>{const _0x226ef1=_0x5f31e6,_0x38ca5a=document['querySelector'](_0x226ef1(0x3a9)+_0x20eed9+'\x22]');if(_0x38ca5a){const _0x263b15=_0x38ca5a[_0x226ef1(0x106f)](_0x226ef1(0x5fc));_0x263b15&&_0x4f144b['appendChild'](_0x263b15[_0x226ef1(0x75a)](!![]));}}),_0x551dfa[_0x5f31e6(0x133d)](_0x10e585),_0x551dfa[_0x5f31e6(0x133d)](_0x4f144b),_0x551dfa[_0x5f31e6(0x133d)](_0x6a0c93),document[_0x5f31e6(0x53d)][_0x5f31e6(0x133d)](_0x551dfa);const _0x26fb11=Array['from'](_0x551dfa[_0x5f31e6(0x2a0)]('img')),_0x2b5e91=_0x26fb11['map'](_0x39d192=>new Promise((_0xa46dfc,_0x527470)=>{const _0x48e59f=_0x5f31e6;if(_0x39d192['src']['startsWith'](_0x48e59f(0xc95))){_0xa46dfc();return;}const _0x125435=new Image();_0x125435[_0x48e59f(0xbe0)]=_0x48e59f(0x6b2),_0x125435[_0x48e59f(0x110f)]=_0xa46dfc,_0x125435[_0x48e59f(0xdcc)]=_0xa46dfc,_0x125435[_0x48e59f(0x7ff)]=_0x39d192[_0x48e59f(0x7ff)];}));await Promise[_0x5f31e6(0x63d)](_0x2b5e91);const _0xe74d46=await html2canvas(_0x551dfa,{'allowTaint':!![],'useCORS':!![],'backgroundColor':null,'scale':window['devicePixelRatio']||0x2});_0xe74d46[_0x5f31e6(0xd82)](function(_0x2a2742){const _0x332393=_0x5f31e6,_0x58ca4e=URL[_0x332393(0xaa0)](_0x2a2742),_0x178eb2=document[_0x332393(0xd67)]('a');_0x178eb2[_0x332393(0x888)]='EPhone-长截图-'+_0x53b69f[_0x332393(0x234)]+'-'+Date[_0x332393(0x9c1)]()+_0x332393(0x1335),_0x178eb2[_0x332393(0xf0b)]=_0x58ca4e,document[_0x332393(0x53d)][_0x332393(0x133d)](_0x178eb2),_0x178eb2[_0x332393(0xb2b)](),document[_0x332393(0x53d)][_0x332393(0x592)](_0x178eb2),URL[_0x332393(0x39b)](_0x58ca4e);},_0x5f31e6(0xeb8));}catch(_0x2286ea){console[_0x5f31e6(0x617)]('长截图生成失败:',_0x2286ea),await _0x184397('生成失败','生成截图时发生错误，请检查控制台获取详情。');}finally{document[_0x5f31e6(0x53d)][_0x5f31e6(0x592)](_0x551dfa),document[_0x5f31e6(0x66b)][_0x5f31e6(0x592)](_0x1f40f8),_0x38ede1[_0x5f31e6(0x34a)]=_0x4c261f,_0x38ede1['disabled']=![],_0x3c73fa();}}function _0x46c503(_0x57bb7f){const _0x2260df=_0x13d875;if(!_0x57bb7f||typeof _0x57bb7f!==_0x2260df(0xfc5))return'';return _0x57bb7f=_0x57bb7f['replace'](/!h\{(.*?)\}/g,_0x2260df(0xdfa)),_0x57bb7f=_0x57bb7f[_0x2260df(0x795)](/!u\{(.*?)\}/g,_0x2260df(0x6f9)),_0x57bb7f=_0x57bb7f['replace'](/!e\{(.*?)\}/g,'<span\x20class=\x22diary-emphasis\x22>$1</span>'),_0x57bb7f=_0x57bb7f[_0x2260df(0x795)](/!w\{(.*?)\}/g,_0x2260df(0x8d7)),_0x57bb7f=_0x57bb7f[_0x2260df(0x795)](/!m\{(.*?)\}/g,'<span\x20class=\x22diary-messy\x22>$1</span>'),_0x57bb7f=_0x57bb7f[_0x2260df(0x795)](/\|\|(.*?)\|\|/g,'<span\x20class=\x22spoiler\x22>$1</span>'),_0x57bb7f=_0x57bb7f[_0x2260df(0x795)](/\*\*(.*?)\*\*/g,_0x2260df(0xe67)),_0x57bb7f=_0x57bb7f[_0x2260df(0x795)](/\~\~(.*?)\~\~/g,_0x2260df(0x83b)),_0x57bb7f=_0x57bb7f['replace'](/\*(.*?)\*/g,'<em>$1</em>'),_0x57bb7f;}async function _0x14a77a(){const _0x1e064a=_0x13d875;console[_0x1e064a(0x1081)](_0x1e064a(0x8fb));let _0x434438=0x0;const _0x170da8=Object[_0x1e064a(0x244)](_0x53d851[_0x1e064a(0xaa3)]);for(const _0x3e6aae of _0x170da8){let _0x3ca08e=![];for(const _0x3e7b37 of _0x3e6aae['history']){_0x3e7b37[_0x1e064a(0x919)]==='red_packet'&&_0x3e7b37[_0x1e064a(0x67e)]==='direct'&&_0x3e7b37['role']===_0x1e064a(0xac5)&&_0x3e7b37['hasOwnProperty'](_0x1e064a(0xd38))&&!_0x3e7b37['hasOwnProperty'](_0x1e064a(0x44a))&&(_0x3e7b37[_0x1e064a(0x44a)]=_0x3e7b37['receiver'],delete _0x3e7b37[_0x1e064a(0xd38)],_0x3ca08e=!![],_0x434438++);}_0x3ca08e&&(console[_0x1e064a(0x1081)](_0x1e064a(0xedd)+_0x3e6aae[_0x1e064a(0x234)]+_0x1e064a(0xb62)),await _0xa62efb[_0x1e064a(0xaa3)][_0x1e064a(0x546)](_0x3e6aae));}_0x434438>0x0?(console['log']('数据迁移完成！总共修复了\x20'+_0x434438+_0x1e064a(0x828)),alert(_0x1e064a(0x82d)+_0x434438+_0x1e064a(0xdd9)),location[_0x1e064a(0x648)]()):console[_0x1e064a(0x1081)](_0x1e064a(0x1050));}function _0x18159d(_0x17892f){const _0x58def3=_0x13d875,_0x21969d=_0x53d851[_0x58def3(0xaa3)][_0x17892f];if(!_0x21969d||_0x21969d['isGroup'])return;document['getElementById'](_0x58def3(0x1055))[_0x58def3(0x34a)]=_0x21969d[_0x58def3(0x13cb)]||_0x58def3(0x95d),document[_0x58def3(0x53a)]('profile-random-jottings')[_0x58def3(0x34a)]=_0x21969d[_0x58def3(0xc35)]||_0x58def3(0x95d);const _0x18739b=document[_0x58def3(0x53a)](_0x58def3(0x8e9));_0x18739b['classList'][_0x58def3(0xe13)](_0x58def3(0xaef));}function _0x65758c(){const _0x56b2f1=_0x13d875;document[_0x56b2f1(0x53a)]('profile-main-content')[_0x56b2f1(0x1284)][_0x56b2f1(0x11d9)]=_0x56b2f1(0xbf2),document[_0x56b2f1(0x53a)]('profile-thoughts-history-view')[_0x56b2f1(0x1284)]['display']='flex',_0x3f70aa();}function _0x12cd02(){const _0x5386ea=_0x13d875;document[_0x5386ea(0x53a)]('profile-thoughts-history-view')[_0x5386ea(0x1284)][_0x5386ea(0x11d9)]=_0x5386ea(0xbf2),document[_0x5386ea(0x53a)]('profile-main-content')[_0x5386ea(0x1284)][_0x5386ea(0x11d9)]=_0x5386ea(0x2f6);}function _0x3f70aa(){const _0x2153da=_0x13d875,_0x11dc2c=document[_0x2153da(0x53a)]('thoughts-history-list'),_0x258168=_0x53d851['chats'][_0x53d851[_0x2153da(0x13be)]];_0x11dc2c['innerHTML']='';if(!_0x258168||!_0x258168['thoughtsHistory']||_0x258168[_0x2153da(0xf2c)]['length']===0x0){_0x11dc2c['innerHTML']=_0x2153da(0xdc4);return;}const _0x29d893=[..._0x258168['thoughtsHistory']]['reverse'](),_0x58d3ff=_0x29d893[_0x2153da(0x1340)](0x0,_0x3cc0f9);_0x58d3ff[_0x2153da(0xeaf)](_0x58a192=>{const _0x62b754=_0x2153da,_0x3219c9=_0x4ca78c(_0x58a192);_0x11dc2c[_0x62b754(0x133d)](_0x3219c9);}),_0x4800fb=_0x58d3ff[_0x2153da(0x29d)],_0x29d893[_0x2153da(0x29d)]>_0x4800fb&&appendLoadMoreThoughtsButton(_0x11dc2c);}async function _0x58a02b(){const _0x5d5acc=_0x13d875;if(_0x4e50f1)return;_0x4e50f1=!![];const _0xd36599=document[_0x5d5acc(0x53a)](_0x5d5acc(0x92f)),_0x199a4c=_0x53d851[_0x5d5acc(0xaa3)][_0x53d851[_0x5d5acc(0x13be)]];if(!_0x199a4c){_0x4e50f1=![];return;}_0x1e432c(_0xd36599,_0x5d5acc(0xee1)),await new Promise(_0x3af29b=>setTimeout(_0x3af29b,0x1f4));const _0x3fac72=[..._0x199a4c[_0x5d5acc(0xf2c)]][_0x5d5acc(0x843)](),_0x42525e=_0x3fac72[_0x5d5acc(0x29d)],_0x23a44c=_0x4800fb,_0x263157=_0x4800fb+_0x3cc0f9,_0x45e262=_0x3fac72[_0x5d5acc(0x1340)](_0x23a44c,_0x263157);_0x41b779(_0xd36599),_0x45e262[_0x5d5acc(0xeaf)](_0xf87280=>{const _0x176b77=_0x5d5acc,_0x149cb5=_0x4ca78c(_0xf87280);_0xd36599[_0x176b77(0x133d)](_0x149cb5);}),_0x4800fb+=_0x45e262['length'],_0x4e50f1=![];}function _0x4ca78c(_0x2981cb){const _0x3748b9=_0x13d875,_0x72e7ab=document[_0x3748b9(0xd67)](_0x3748b9(0x1425));_0x72e7ab[_0x3748b9(0x6de)]='thought-card';const _0x295a91=new Date(_0x2981cb['timestamp']),_0x412927=_0x295a91[_0x3748b9(0xf14)]()+'-'+String(_0x295a91['getMonth']()+0x1)[_0x3748b9(0x117e)](0x2,'0')+'-'+String(_0x295a91[_0x3748b9(0xfae)]())[_0x3748b9(0x117e)](0x2,'0')+'\x20'+String(_0x295a91[_0x3748b9(0x659)]())[_0x3748b9(0x117e)](0x2,'0')+':'+String(_0x295a91[_0x3748b9(0xa77)]())[_0x3748b9(0x117e)](0x2,'0');return _0x72e7ab[_0x3748b9(0xaac)]=_0x3748b9(0xbc9)+_0x2981cb['timestamp']+_0x3748b9(0x10c0)+_0x412927+_0x3748b9(0x1004)+_0x2981cb[_0x3748b9(0x13cb)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22jottings\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M12\x2019l7-7\x203\x203-7\x207-3-3z\x22></path><path\x20d=\x22M18\x2013l-1.5-7.5L2\x202l3.5\x2014.5L13\x2018l5-5z\x22></path><path\x20d=\x22M2\x202l7.586\x207.586\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20散记\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>'+_0x2981cb['randomJottings']+_0x3748b9(0x1339),_0x72e7ab;}async function _0x3a604e(_0x2a65d8){const _0x1c5a47=_0x13d875,_0x82b1b8=_0x2a65d8['target']['files'][0x0];if(!_0x82b1b8)return;try{let _0x273256,_0x31a36d=null;if(_0x82b1b8['name'][_0x1c5a47(0xc31)](_0x1c5a47(0xbed))){const _0x281b36=await _0x82b1b8[_0x1c5a47(0x2e6)]();_0x273256=JSON[_0x1c5a47(0x367)](_0x281b36);}else{if(_0x82b1b8[_0x1c5a47(0x234)][_0x1c5a47(0xc31)]('.png')){const _0x2d3c13=await _0x82b1b8[_0x1c5a47(0x55a)]();_0x273256=await _0x2d85f8(_0x2d3c13),_0x31a36d=await new Promise(_0x5a569c=>{const _0x5d3e26=_0x1c5a47,_0x54e903=new FileReader();_0x54e903[_0x5d3e26(0x110f)]=()=>_0x5a569c(_0x54e903[_0x5d3e26(0xa2a)]),_0x54e903[_0x5d3e26(0x13b6)](_0x82b1b8);});}else throw new Error(_0x1c5a47(0x1074));}await _0xdcc048(_0x273256,_0x31a36d);}catch(_0x2e2680){console[_0x1c5a47(0x617)]('角色卡导入失败:',_0x2e2680),await _0x184397('导入失败','无法解析角色卡文件。\x0a错误:\x20'+_0x2e2680[_0x1c5a47(0x875)]);}finally{_0x2a65d8[_0x1c5a47(0x9c2)][_0x1c5a47(0x11a2)]=null;}}function _0x2d85f8(_0x5aba35){return new Promise((_0x9e100f,_0xef30ec)=>{const _0xfd6ada=_0x55b8,_0x54d306=new DataView(_0x5aba35);if(_0x54d306[_0xfd6ada(0x535)](0x0)!==0x89504e47||_0x54d306[_0xfd6ada(0x535)](0x4)!==0xd0a1a0a)return _0xef30ec(new Error(_0xfd6ada(0x120e)));let _0xd5e7be=0x8;const _0x8ee62a=new TextDecoder();while(_0xd5e7be<_0x54d306[_0xfd6ada(0x904)]){const _0x472cab=_0x54d306['getUint32'](_0xd5e7be),_0x22461a=_0x8ee62a[_0xfd6ada(0x2bc)](_0x5aba35[_0xfd6ada(0x1340)](_0xd5e7be+0x4,_0xd5e7be+0x8));if(_0x22461a===_0xfd6ada(0x6d7)){const _0x3d3fc6=new Uint8Array(_0x5aba35,_0xd5e7be+0x8,_0x472cab),_0x1a6e43=_0x3d3fc6[_0xfd6ada(0x57c)](0x0);if(_0x1a6e43!==-0x1){const _0x58f541=_0x8ee62a[_0xfd6ada(0x2bc)](_0x3d3fc6[_0xfd6ada(0x1340)](0x0,_0x1a6e43));if(_0x58f541===_0xfd6ada(0x426)){const _0x187c01=_0x8ee62a[_0xfd6ada(0x2bc)](_0x3d3fc6[_0xfd6ada(0x1340)](_0x1a6e43+0x1));try{const _0x576f1e=atob(_0x187c01),_0x371c60=new Uint8Array(_0x576f1e[_0xfd6ada(0x29d)]);for(let _0x293f70=0x0;_0x293f70<_0x576f1e[_0xfd6ada(0x29d)];_0x293f70++){_0x371c60[_0x293f70]=_0x576f1e[_0xfd6ada(0x24b)](_0x293f70);}const _0x926615=new TextDecoder(_0xfd6ada(0xbe9))[_0xfd6ada(0x2bc)](_0x371c60);_0x9e100f(JSON[_0xfd6ada(0x367)](_0x926615));return;}catch(_0x31d938){return _0xef30ec(new Error(_0xfd6ada(0xbad)+_0x31d938['message']));}}}}_0xd5e7be+=0x4+0x4+_0x472cab+0x4;}_0xef30ec(new Error(_0xfd6ada(0xd74)));});}function _0x153b5a(_0x434d07){const _0x2575e3=_0x13d875;if(_0x434d07['data']?.[_0x2575e3(0x1320)]?.['entries']?.[_0x2575e3(0x29d)]>0x0)return console['log'](_0x2575e3(0x10f7)),_0x434d07[_0x2575e3(0xd7c)][_0x2575e3(0x1320)][_0x2575e3(0xfdc)];if(_0x434d07[_0x2575e3(0x29f)]?.['character_book']?.[_0x2575e3(0xfdc)]?.[_0x2575e3(0x29d)]>0x0)return console[_0x2575e3(0x1081)]('诊断：在\x20extensions.character_book\x20中找到世界书。'),_0x434d07[_0x2575e3(0x29f)][_0x2575e3(0x1320)]['entries'];if(_0x434d07[_0x2575e3(0xd7c)]?.[_0x2575e3(0x29f)]?.[_0x2575e3(0x1320)]?.[_0x2575e3(0xfdc)]?.['length']>0x0)return console[_0x2575e3(0x1081)]('诊断：在\x20data.extensions.character_book\x20中找到世界书。'),_0x434d07[_0x2575e3(0xd7c)][_0x2575e3(0x29f)][_0x2575e3(0x1320)][_0x2575e3(0xfdc)];const _0x3f2f42=[_0x2575e3(0x1320),'lorebook','world_info',_0x2575e3(0x1115)];for(const _0x13916c of _0x3f2f42){if(_0x434d07[_0x13916c]?.[_0x2575e3(0xfdc)]?.[_0x2575e3(0x29d)]>0x0)return console['log'](_0x2575e3(0xc11)+_0x13916c+_0x2575e3(0xcdd)),_0x434d07[_0x13916c][_0x2575e3(0xfdc)];}return console[_0x2575e3(0x1081)](_0x2575e3(0x990)),null;}async function _0xdcc048(_0x1da143,_0x2005d5=null){const _0x5bcb06=_0x13d875,_0xc10d2=_0x1da143['data']||_0x1da143;if(!_0xc10d2[_0x5bcb06(0x234)])throw new Error(_0x5bcb06(0x1008));let _0x4a37c=null;const _0x1fb80c=_0x153b5a(_0x1da143);if(_0x1fb80c){const _0x1d6be6=_0x1fb80c[_0x5bcb06(0x2dd)](_0x3e6e4b=>_0x3e6e4b[_0x5bcb06(0xb3d)]&&_0x3e6e4b[_0x5bcb06(0x73e)])[_0x5bcb06(0xcb4)](_0x548fb8=>({'keys':_0x548fb8['keys']||[],'comment':_0x548fb8[_0x5bcb06(0x1445)]||'','content':_0x548fb8[_0x5bcb06(0x73e)][_0x5bcb06(0x795)](/<memory>|<\/memory>/g,'')[_0x5bcb06(0x13bc)]()}));if(_0x1d6be6[_0x5bcb06(0x29d)]>0x0){const _0x51cd44={'id':'wb_'+Date[_0x5bcb06(0x9c1)](),'name':_0xc10d2[_0x5bcb06(0x234)]+_0x5bcb06(0xd0b),'content':_0x1d6be6,'categoryId':null};await _0xa62efb[_0x5bcb06(0x10f2)][_0x5bcb06(0xe13)](_0x51cd44),_0x53d851['worldBooks']['push'](_0x51cd44),_0x4a37c=_0x51cd44['id'];}}let _0x127734=_0xc10d2['description']||_0x1da143['description']||'无';_0x127734=_0x127734[_0x5bcb06(0x795)](/```yaml/g,'')[_0x5bcb06(0x795)](/```/g,'')[_0x5bcb06(0x795)](/<\/?info>/g,'')['replace'](/<\/?character>/g,'')['replace'](/<\/?writing_rule>/g,'')[_0x5bcb06(0x795)](/\[OOC：.*?\]/g,'')['trim']();let _0x586c9f=_0x5bcb06(0x33e)+_0x127734+'\x0a\x0a';if(_0xc10d2[_0x5bcb06(0xc0a)])_0x586c9f+=_0x5bcb06(0xa72)+_0xc10d2[_0x5bcb06(0xc0a)]+'\x0a\x0a';if(_0xc10d2[_0x5bcb06(0x942)])_0x586c9f+=_0x5bcb06(0xe07)+_0xc10d2['scenario']+'\x0a\x0a';if(_0xc10d2['mes_example'])_0x586c9f+='#\x20对话示例\x0a'+_0xc10d2[_0x5bcb06(0x29b)]+'\x0a\x0a';const _0x1a738d=_0xc10d2[_0x5bcb06(0x234)],_0x488a06=_0xc10d2['name'],_0x3fccb2=_0x5bcb06(0x8e2)+Date[_0x5bcb06(0x9c1)](),_0x35d401={'id':_0x3fccb2,'name':_0x1a738d[_0x5bcb06(0x13bc)](),'originalName':_0x488a06[_0x5bcb06(0x13bc)](),'isGroup':![],'relationship':{'status':_0x5bcb06(0x10b1)},'status':{'text':'在线','lastUpdate':Date[_0x5bcb06(0x9c1)](),'isBusy':![]},'settings':{'aiPersona':_0x586c9f,'myPersona':'我是谁呀。','maxMemory':0xa,'aiAvatar':_0x5d06c0,'myAvatar':_0x5d06c0,'background':'','theme':_0x5bcb06(0xce2),'fontSize':0xd,'customCss':'','linkedWorldBookIds':_0x4a37c?[_0x4a37c]:[],'aiAvatarLibrary':[]},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[]};_0x2005d5&&(_0x35d401[_0x5bcb06(0x81e)][_0x5bcb06(0x9e3)]=_0x2005d5,_0x35d401[_0x5bcb06(0x81e)][_0x5bcb06(0x78e)]['push']({'name':'默认头像','url':_0x2005d5}));const _0xd539b=_0xc10d2['first_mes']||_0x1da143[_0x5bcb06(0x21c)];if(_0xd539b&&typeof _0xd539b===_0x5bcb06(0xfc5)){const _0x32180f=document[_0x5bcb06(0xd67)](_0x5bcb06(0x1425));_0x32180f[_0x5bcb06(0xaac)]=_0xd539b;const _0x32e8f4=(_0x32180f[_0x5bcb06(0x34a)]||_0x32180f[_0x5bcb06(0x9a9)]||'')[_0x5bcb06(0x795)](/原作者UR.*?开局/s,'')[_0x5bcb06(0x13bc)]();_0x32e8f4&&_0x35d401[_0x5bcb06(0xe83)][_0x5bcb06(0x7dd)]({'role':_0x5bcb06(0xac5),'senderName':_0x35d401['originalName'],'content':_0x32e8f4,'timestamp':Date[_0x5bcb06(0x9c1)]()});}_0x53d851[_0x5bcb06(0xaa3)][_0x3fccb2]=_0x35d401,await _0xa62efb[_0x5bcb06(0xaa3)]['put'](_0x35d401),_0x5001a4();let _0x528b65=_0x5bcb06(0x47a)+_0x35d401[_0x5bcb06(0x234)]+_0x5bcb06(0x438);_0x4a37c&&(_0x528b65+=_0x5bcb06(0xb92)),await _0x184397(_0x5bcb06(0xd0a),_0x528b65);}async function _0x4fd454(){const _0x1dfa77=_0x13d875;if(!_0x53d851[_0x1dfa77(0x13be)])return;const _0x1a4809=_0x53d851[_0x1dfa77(0xaa3)][_0x53d851[_0x1dfa77(0x13be)]],_0x524cfb=_0x1a4809[_0x1dfa77(0x81e)][_0x1dfa77(0x311)];if(!_0x524cfb||_0x524cfb[_0x1dfa77(0x29d)]===0x0){alert('这个角色没有可用的备选开场白。');return;}const _0x2dc7ea=_0x524cfb[_0x1dfa77(0xcb4)]((_0x3d9efe,_0x49ca83)=>{const _0x4f3f36=_0x1dfa77,_0x39d5f5=_0x3d9efe['replace'](/<[^>]*>/g,'')[_0x4f3f36(0x13bc)]()[_0x4f3f36(0xad6)](0x0,0x14);return{'text':_0x4f3f36(0x293)+(_0x49ca83+0x1)+':\x20'+_0x39d5f5+_0x4f3f36(0x95d),'value':_0x49ca83};}),_0x1267c7=await _0x34ea2c(_0x1dfa77(0xce9),_0x2dc7ea);if(_0x1267c7!==null){const _0x588d4c=await _0x355fc0(_0x1dfa77(0x911),'切换开场将会【清空并替换】当前的所有聊天记录。确定要继续吗？',{'confirmButtonClass':_0x1dfa77(0x264),'confirmText':'确定切换'});if(_0x588d4c){const _0xa23c28=_0x524cfb[_0x1267c7],_0x4cf6eb={'role':_0x1dfa77(0xac5),'senderName':_0x1a4809[_0x1dfa77(0x543)],'content':_0xa23c28,'timestamp':Date[_0x1dfa77(0x9c1)]()};_0x1a4809[_0x1dfa77(0xe83)]=[_0x4cf6eb],await _0xa62efb[_0x1dfa77(0xaa3)]['put'](_0x1a4809),_0x60f53f(_0x1a4809['id']),document[_0x1dfa77(0x53a)](_0x1dfa77(0xe1c))['classList'][_0x1dfa77(0x2d4)](_0x1dfa77(0xaef)),await _0x184397('成功',_0x1dfa77(0x63f));}}}function _0x3571ed(_0x694308={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x92ef7e=_0x13d875,_0x4f4560=document['createElement']('div');_0x4f4560[_0x92ef7e(0x6de)]=_0x92ef7e(0x595);const _0x4422c6=_0x694308[_0x92ef7e(0xb3d)]!==![]?_0x92ef7e(0x1077):'';return _0x4f4560['innerHTML']=_0x92ef7e(0x3d5)+_0x4422c6+_0x92ef7e(0xa6a)+(_0x694308[_0x92ef7e(0x1445)]||'')+_0x92ef7e(0x6bf)+(_0x694308[_0x92ef7e(0x1350)]||[])[_0x92ef7e(0x2c8)](',\x20')+_0x92ef7e(0x6ba)+(_0x694308[_0x92ef7e(0x73e)]||'')+_0x92ef7e(0x10b8),_0x4f4560['querySelector'](_0x92ef7e(0x425))[_0x92ef7e(0x1086)](_0x92ef7e(0xb2b),()=>{const _0x521bd6=_0x92ef7e;_0x4f4560[_0x521bd6(0x2d4)]();}),_0x4f4560;}async function _0x3a1dfe(){const _0x1e965c=_0x13d875;if(!_0x53d851[_0x1e965c(0x13be)])return;const _0x8da10a=_0x53d851['activeChatId'],_0x5bd19f=document['getElementById'](_0x1e965c(0x783));if(!_0x5bd19f[_0x1e965c(0x1276)][_0x1e965c(0x6a3)](_0x1e965c(0xaef))){const _0x2dd3e8=document[_0x1e965c(0x139c)](_0x1e965c(0x605));_0x5bd19f[_0x1e965c(0x1284)]['top']=_0x2dd3e8['offsetHeight']+'px',_0x5bd19f['style'][_0x1e965c(0x11d9)]=_0x1e965c(0x1ea),(!_0x4b8524[_0x8da10a]||!_0x4b8524[_0x8da10a][_0x1e965c(0x975)])&&_0x438971(_0x8da10a),_0x276755(_0x8da10a),setTimeout(async()=>{const _0x288b09=_0x1e965c;_0x5bd19f[_0x288b09(0x1276)]['add'](_0x288b09(0xaef));const _0x70e3bb={'role':_0x288b09(0xab3),'content':_0x288b09(0x4b8),'timestamp':Date['now'](),'isHidden':!![]};_0x53d851[_0x288b09(0xaa3)][_0x8da10a][_0x288b09(0xe83)][_0x288b09(0x7dd)](_0x70e3bb),await _0xa62efb[_0x288b09(0xaa3)][_0x288b09(0x546)](_0x53d851[_0x288b09(0xaa3)][_0x8da10a]);},0xa);}else await _0x13cecc();}async function _0x13cecc(){const _0xf1209b=_0x13d875;if(!_0x53d851[_0xf1209b(0x13be)])return;const _0x5e8d85=_0x53d851['activeChatId'],_0x44a73e=document['getElementById']('gomoku-overlay');_0x44a73e[_0xf1209b(0x1276)][_0xf1209b(0x2d4)](_0xf1209b(0xaef)),setTimeout(()=>{const _0x2cdb3c=_0xf1209b;_0x44a73e[_0x2cdb3c(0x1284)][_0x2cdb3c(0x11d9)]=_0x2cdb3c(0xbf2);},0x12c);if(_0x4b8524[_0x5e8d85]){_0x4b8524[_0x5e8d85][_0xf1209b(0x975)]=![];const _0x28a81d={'role':_0xf1209b(0xab3),'content':'[系统提示：用户关闭了五子棋棋盘，游戏结束了。]','timestamp':Date[_0xf1209b(0x9c1)](),'isHidden':!![]};_0x53d851[_0xf1209b(0xaa3)][_0x5e8d85][_0xf1209b(0xe83)][_0xf1209b(0x7dd)](_0x28a81d),await _0xa62efb[_0xf1209b(0xaa3)][_0xf1209b(0x546)](_0x53d851[_0xf1209b(0xaa3)][_0x5e8d85]);}}function _0x438971(_0x3020a5){const _0x32c992=_0x13d875,_0x3cb240=document[_0x32c992(0x53a)](_0x32c992(0x11ee)),_0x586065=document['getElementById'](_0x32c992(0x783)),_0x11bd61=document['getElementById'](_0x32c992(0xfb4)),_0x52cfcc=_0x586065['offsetWidth']-0x28,_0x340876=_0x586065[_0x32c992(0x127d)]-_0x11bd61[_0x32c992(0x127d)]-0x28,_0x2bddb1=Math['floor'](Math[_0x32c992(0x683)](_0x52cfcc,_0x340876)),_0x3269f4=0xf,_0x2babf5=Math[_0x32c992(0x7d5)](_0x2bddb1/_0x3269f4),_0x1b6ffa=_0x2babf5*_0x3269f4;_0x3cb240[_0x32c992(0xd10)]=_0x1b6ffa,_0x3cb240[_0x32c992(0xfeb)]=_0x1b6ffa,_0x4b8524[_0x3020a5]={'isActive':!![],'board':Array(_0x3269f4)[_0x32c992(0x1165)](0x0)['map'](()=>Array(_0x3269f4)[_0x32c992(0x1165)](0x0)),'currentPlayer':0x1,'history':[],'isGameOver':![],'GRID_SIZE':_0x3269f4,'CELL_SIZE':_0x2babf5};}function _0x276755(_0x257638){const _0x574cec=_0x13d875,_0x41b030=_0x4b8524[_0x257638];if(!_0x41b030)return;const _0x47c6c1=document['getElementById']('gomoku-board'),_0x5c9934=_0x47c6c1[_0x574cec(0x363)]('2d'),{GRID_SIZE:_0x1c9251,CELL_SIZE:_0x28f9d6}=_0x41b030,_0x3fefd8=_0x28f9d6/0x2;_0x5c9934[_0x574cec(0x457)](0x0,0x0,_0x47c6c1[_0x574cec(0xd10)],_0x47c6c1['height']),_0x5c9934[_0x574cec(0x115d)]=_0x574cec(0xa7c),_0x5c9934[_0x574cec(0xd1e)](0x0,0x0,_0x47c6c1[_0x574cec(0xd10)],_0x47c6c1[_0x574cec(0xfeb)]),_0x5c9934[_0x574cec(0xbaa)]=_0x574cec(0x844),_0x5c9934['lineWidth']=0x1;for(let _0x10a839=0x0;_0x10a839<_0x1c9251;_0x10a839++){_0x5c9934[_0x574cec(0x211)](),_0x5c9934[_0x574cec(0x5e0)](_0x3fefd8,_0x3fefd8+_0x10a839*_0x28f9d6),_0x5c9934[_0x574cec(0x11d2)](_0x47c6c1[_0x574cec(0xd10)]-_0x3fefd8,_0x3fefd8+_0x10a839*_0x28f9d6),_0x5c9934[_0x574cec(0x27a)](),_0x5c9934[_0x574cec(0x211)](),_0x5c9934[_0x574cec(0x5e0)](_0x3fefd8+_0x10a839*_0x28f9d6,_0x3fefd8),_0x5c9934['lineTo'](_0x3fefd8+_0x10a839*_0x28f9d6,_0x47c6c1['height']-_0x3fefd8),_0x5c9934['stroke']();}for(let _0x47e149=0x0;_0x47e149<_0x1c9251;_0x47e149++){for(let _0x412f18=0x0;_0x412f18<_0x1c9251;_0x412f18++){_0x41b030[_0x574cec(0x3be)][_0x47e149][_0x412f18]!==0x0&&_0xf0d8d6(_0x5c9934,_0x412f18,_0x47e149,_0x41b030[_0x574cec(0x3be)][_0x47e149][_0x412f18],_0x41b030);}}}function _0xf0d8d6(_0x39e106,_0x186c23,_0x5ef500,_0x3bd7cd,_0x66cb83){const _0xc8649=_0x13d875,{CELL_SIZE:_0x1452fe}=_0x66cb83,_0xa75c3b=_0x1452fe/0x2,_0x2d0869=_0x1452fe/0x2-0x2;_0x39e106['beginPath'](),_0x39e106['arc'](_0xa75c3b+_0x186c23*_0x1452fe,_0xa75c3b+_0x5ef500*_0x1452fe,_0x2d0869,0x0,0x2*Math['PI']),_0x3bd7cd===0x1?_0x39e106['fillStyle']=_0xc8649(0x37e):_0x39e106[_0xc8649(0x115d)]=_0xc8649(0x492),_0x39e106[_0xc8649(0x1165)]();}function _0x38f514(_0xc3f0b1){const _0x13a2d3=_0x13d875,_0x1463c7=_0x53d851['activeChatId'],_0x22887b=_0x4b8524[_0x1463c7];if(!_0x22887b||_0x22887b[_0x13a2d3(0x862)]||_0x22887b['currentPlayer']!==0x1)return;const _0x1e27bb=document[_0x13a2d3(0x53a)](_0x13a2d3(0x11ee)),_0x5a7c99=_0x1e27bb[_0x13a2d3(0x363)]('2d'),_0x5a2010=_0x1e27bb[_0x13a2d3(0xde9)](),_0x5a5798=_0xc3f0b1[_0x13a2d3(0x1251)]-_0x5a2010['left'],_0x560eac=_0xc3f0b1[_0x13a2d3(0xe71)]-_0x5a2010[_0x13a2d3(0x624)],_0x391218=Math[_0x13a2d3(0x143a)]((_0x5a5798-_0x22887b[_0x13a2d3(0xc08)]/0x2)/_0x22887b[_0x13a2d3(0xc08)]),_0x57f97c=Math[_0x13a2d3(0x143a)]((_0x560eac-_0x22887b['CELL_SIZE']/0x2)/_0x22887b[_0x13a2d3(0xc08)]);_0x276755(_0x1463c7);if(_0x391218>=0x0&&_0x391218<_0x22887b[_0x13a2d3(0x8c7)]&&_0x57f97c>=0x0&&_0x57f97c<_0x22887b[_0x13a2d3(0x8c7)]&&_0x22887b[_0x13a2d3(0x3be)][_0x57f97c][_0x391218]===0x0){const _0x2f78e7=_0x22887b[_0x13a2d3(0xc08)]/0x2-0x2;_0x5a7c99[_0x13a2d3(0x211)](),_0x5a7c99['arc'](_0x22887b[_0x13a2d3(0xc08)]/0x2+_0x391218*_0x22887b['CELL_SIZE'],_0x22887b[_0x13a2d3(0xc08)]/0x2+_0x57f97c*_0x22887b['CELL_SIZE'],_0x2f78e7,0x0,0x2*Math['PI']),_0x5a7c99[_0x13a2d3(0x115d)]='rgba(0,\x200,\x200,\x200.4)',_0x5a7c99['fill']();}}function _0x101879(_0x1bccc5){const _0x522a3a=_0x13d875,_0x1e28ac=_0x53d851[_0x522a3a(0x13be)],_0x281e57=_0x4b8524[_0x1e28ac];if(!_0x281e57||_0x281e57[_0x522a3a(0x862)]||_0x281e57['currentPlayer']!==0x1)return;const _0x363731=document[_0x522a3a(0x53a)](_0x522a3a(0x11ee)),_0x40a1e7=_0x363731[_0x522a3a(0xde9)](),_0x3ed096=_0x1bccc5[_0x522a3a(0x1251)]-_0x40a1e7[_0x522a3a(0xcd7)],_0x47cef2=_0x1bccc5[_0x522a3a(0xe71)]-_0x40a1e7[_0x522a3a(0x624)],_0x368691=Math[_0x522a3a(0x143a)]((_0x3ed096-_0x281e57[_0x522a3a(0xc08)]/0x2)/_0x281e57[_0x522a3a(0xc08)]),_0x941793=Math[_0x522a3a(0x143a)]((_0x47cef2-_0x281e57[_0x522a3a(0xc08)]/0x2)/_0x281e57[_0x522a3a(0xc08)]);_0x368691>=0x0&&_0x368691<_0x281e57[_0x522a3a(0x8c7)]&&_0x941793>=0x0&&_0x941793<_0x281e57[_0x522a3a(0x8c7)]&&_0x281e57[_0x522a3a(0x3be)][_0x941793][_0x368691]===0x0&&(_0x281e57[_0x522a3a(0x3be)][_0x941793][_0x368691]=0x1,_0x281e57[_0x522a3a(0xe83)]['push']({'x':_0x368691,'y':_0x941793,'player':0x1}),_0x276755(_0x1e28ac),_0x5e48b7(_0x368691,_0x941793,0x1,_0x281e57)?(_0x281e57['isGameOver']=!![],setTimeout(()=>alert(_0x522a3a(0x1088)),0x64),_0x4a7f05(_0x522a3a(0x10ae))):_0x281e57[_0x522a3a(0x5a0)]=0x2);}function _0x5e0cf2(_0x630422,_0x33916e=![]){const _0x5eddaa=_0x13d875,_0x525b9c=_0x53d851[_0x5eddaa(0x13be)],_0x543c7a=_0x4b8524[_0x525b9c];if(!_0x543c7a||_0x543c7a['isGameOver'])return;if(!_0x33916e&&_0x543c7a['currentPlayer']!==0x2)return;const {x:_0x2ecf4b,y:_0x146621}=_0x630422;_0x2ecf4b>=0x0&&_0x2ecf4b<_0x543c7a[_0x5eddaa(0x8c7)]&&_0x146621>=0x0&&_0x146621<_0x543c7a[_0x5eddaa(0x8c7)]&&_0x543c7a[_0x5eddaa(0x3be)][_0x146621][_0x2ecf4b]===0x0?(_0x543c7a[_0x5eddaa(0x3be)][_0x146621][_0x2ecf4b]=0x2,_0x543c7a['history']['push']({'x':_0x2ecf4b,'y':_0x146621,'player':0x2}),_0x276755(_0x525b9c),_0x5e48b7(_0x2ecf4b,_0x146621,0x2,_0x543c7a)?(_0x543c7a[_0x5eddaa(0x862)]=!![],setTimeout(()=>alert(_0x5eddaa(0xc92)),0x64),_0x4a7f05('ai')):_0x543c7a[_0x5eddaa(0x5a0)]=0x1):(console[_0x5eddaa(0xad0)](_0x5eddaa(0x1112),_0x630422),_0x543c7a[_0x5eddaa(0x5a0)]=0x1);}function _0x5e48b7(_0x144060,_0x5b5c82,_0x1f17bf,_0x47fafc){const {board:_0x599fc6,GRID_SIZE:_0x5073c3}=_0x47fafc,_0x264316=[[0x1,0x0],[0x0,0x1],[0x1,0x1],[0x1,-0x1]];for(const [_0x553350,_0x5ab50d]of _0x264316){let _0x43a32a=0x1;for(let _0x5a5f9e=0x1;_0x5a5f9e<0x5;_0x5a5f9e++){const _0x39b8b7=_0x144060+_0x5a5f9e*_0x553350,_0x1892b3=_0x5b5c82+_0x5a5f9e*_0x5ab50d;if(_0x39b8b7>=0x0&&_0x39b8b7<_0x5073c3&&_0x1892b3>=0x0&&_0x1892b3<_0x5073c3&&_0x599fc6[_0x1892b3][_0x39b8b7]===_0x1f17bf)_0x43a32a++;else break;}for(let _0x320ba8=0x1;_0x320ba8<0x5;_0x320ba8++){const _0xee1c67=_0x144060-_0x320ba8*_0x553350,_0x2e33ba=_0x5b5c82-_0x320ba8*_0x5ab50d;if(_0xee1c67>=0x0&&_0xee1c67<_0x5073c3&&_0x2e33ba>=0x0&&_0x2e33ba<_0x5073c3&&_0x599fc6[_0x2e33ba][_0xee1c67]===_0x1f17bf)_0x43a32a++;else break;}if(_0x43a32a>=0x5)return!![];}return![];}function _0x18d781(_0x3fa3b4){const _0x3a4840=_0x13d875;if(!_0x3fa3b4||!_0x3fa3b4['isActive'])return'';let _0x22885a=_0x3a4840(0x9dc);_0x22885a+=_0x3fa3b4[_0x3a4840(0x3be)][_0x3a4840(0xcb4)](_0x515c15=>_0x515c15['join']('\x20'))[_0x3a4840(0x2c8)]('\x0a');let _0x1274ef='下棋历史\x20(x,y坐标均从0开始):\x0a';return _0x1274ef+=_0x3fa3b4[_0x3a4840(0xe83)]['map'](_0xb17ed7=>'玩家'+_0xb17ed7[_0x3a4840(0xd5d)]+_0x3a4840(0xcd6)+_0xb17ed7['x']+','+_0xb17ed7['y']+')')[_0x3a4840(0x2c8)]('\x20->\x20'),'\x0a#\x20当前五子棋局势\x0a'+_0x22885a+_0x3a4840(0xf66)+_0x1274ef+_0x3a4840(0x1235);}async function _0x4a7f05(_0x421322){const _0x4804e2=_0x13d875,_0x73dc5c=_0x53d851[_0x4804e2(0x13be)],_0xf41835=_0x53d851[_0x4804e2(0xaa3)][_0x73dc5c];if(!_0xf41835)return;const _0x5dabf9=_0xf41835[_0x4804e2(0x86e)]?_0xf41835[_0x4804e2(0x81e)][_0x4804e2(0x1303)]||'我':'我',_0x4e09ad=_0xf41835[_0x4804e2(0x86e)]?'AI方':_0xf41835[_0x4804e2(0x234)],_0x5b135f=_0x421322==='user'?_0x5dabf9:_0x4e09ad,_0x35bc9e=_0x421322===_0x4804e2(0x10ae)?_0x4804e2(0xf0a):_0x4804e2(0x503),_0x59d43c=_0x4804e2(0x908)+_0x5b135f+'\x20获胜。也就是说，'+_0x35bc9e+'。]',_0x2886f9={'role':'system','content':_0x59d43c,'timestamp':Date[_0x4804e2(0x9c1)](),'isHidden':!![]};_0xf41835[_0x4804e2(0xe83)][_0x4804e2(0x7dd)](_0x2886f9),await _0xa62efb[_0x4804e2(0xaa3)][_0x4804e2(0x546)](_0xf41835),console[_0x4804e2(0x1081)](_0x4804e2(0x1231)+_0x421322);}let _0x5e4a35=![];async function _0x568252(){const _0x442033=_0x13d875,_0x5e1bd3=document[_0x442033(0x53a)](_0x442033(0x1f6)),_0x26d332=document['getElementById']('product-category-tabs'),_0x3082b=document['getElementById'](_0x442033(0xd46));_0x5e1bd3[_0x442033(0xaac)]='',_0x26d332[_0x442033(0xaac)]='';const [_0x591129,_0xd33ded]=await Promise[_0x442033(0x63d)]([_0xa62efb[_0x442033(0x1257)][_0x442033(0xa73)](),_0xa62efb[_0x442033(0x44b)]['orderBy'](_0x442033(0x234))['toArray']()]);_0x3082b[_0x442033(0x1276)]['toggle']('management-mode',_0x5e4a35);const _0x254323=document[_0x442033(0xd67)](_0x442033(0x59e));_0x254323[_0x442033(0x6de)]=_0x442033(0x8e8),_0x254323[_0x442033(0x34a)]='全部',_0x254323['dataset'][_0x442033(0xbcd)]=_0x442033(0x63d);if(activeShoppingCategoryId==='all')_0x254323['classList'][_0x442033(0xe13)]('active');_0x26d332[_0x442033(0x133d)](_0x254323),_0xd33ded['forEach'](_0x1a2f8f=>{const _0x44e69c=_0x442033,_0x4ed2f4=document[_0x44e69c(0xd67)](_0x44e69c(0x59e));_0x4ed2f4[_0x44e69c(0x6de)]=_0x44e69c(0x8e8),_0x4ed2f4[_0x44e69c(0x34a)]=_0x1a2f8f[_0x44e69c(0x234)],_0x4ed2f4['dataset'][_0x44e69c(0xbcd)]=_0x1a2f8f['id'];if(activeShoppingCategoryId===_0x1a2f8f['id'])_0x4ed2f4[_0x44e69c(0x1276)][_0x44e69c(0xe13)](_0x44e69c(0xdf6));_0x26d332[_0x44e69c(0x133d)](_0x4ed2f4);});let _0x347b34;activeShoppingCategoryId===_0x442033(0x63d)?_0x347b34=_0x591129:_0x347b34=_0x591129[_0x442033(0x2dd)](_0x1f6164=>_0x1f6164['categoryId']===activeShoppingCategoryId);if(_0x347b34['length']===0x0){const _0x347d6d=activeShoppingCategoryId===_0x442033(0x63d)?_0x442033(0x61a):_0x442033(0x11ae);_0x5e1bd3[_0x442033(0xaac)]=_0x442033(0x8a0)+_0x347d6d+_0x442033(0x12e2);return;}_0x347b34[_0x442033(0xeaf)](_0x5078c1=>{const _0x292a80=_0x442033,_0x8d9f5a=document[_0x292a80(0xd67)](_0x292a80(0x1425));_0x8d9f5a[_0x292a80(0x6de)]=_0x292a80(0x2ae),_0x8d9f5a[_0x292a80(0x999)]['id']=_0x5078c1['id'];const _0x256b45='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x8d9f5a[_0x292a80(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x256b45+_0x292a80(0x36f)+_0x5078c1['imageUrl']+_0x292a80(0x461)+_0x5078c1[_0x292a80(0x234)]+_0x292a80(0x130a)+_0x5078c1[_0x292a80(0xbde)][_0x292a80(0x39e)](0x2)+_0x292a80(0x12ba),_0x5e1bd3[_0x292a80(0x133d)](_0x8d9f5a);});}function _0x5ede0a(_0x3d3380){activeShoppingCategoryId=_0x3d3380,_0x568252(),_0x2d8c6d();}function _0x2d8c6d(){const _0x5a3eb7=_0x13d875,_0x22b21e=document['getElementById'](_0x5a3eb7(0xacf));if(!_0x22b21e)return;const _0x9ea85b=_0x5e4a35&&activeShoppingCategoryId!==_0x5a3eb7(0x63d);_0x22b21e[_0x5a3eb7(0x1284)][_0x5a3eb7(0x11d9)]=_0x9ea85b?_0x5a3eb7(0x2f6):_0x5a3eb7(0xbf2);}async function _0xe0e6ca(){const _0x3e369c=_0x13d875;if(activeShoppingCategoryId===_0x3e369c(0x63d))return;const _0x18a8b9=activeShoppingCategoryId,_0x1e5f5e=await _0xa62efb[_0x3e369c(0x44b)][_0x3e369c(0x883)](_0x18a8b9);if(!_0x1e5f5e){alert(_0x3e369c(0x6d1));return;}const _0xd1ea57=_0x3e369c(0x902)+_0x1e5f5e['name']+_0x3e369c(0xdcd),_0x32ce82=await _0x355fc0(_0x3e369c(0x65a),_0xd1ea57,{'confirmButtonClass':_0x3e369c(0x264),'confirmText':'确认删除'});_0x32ce82&&(await _0x2e84dc(_0x18a8b9),activeShoppingCategoryId='all',await _0x568252(),_0x2d8c6d(),await _0x184397('成功','分类\x20“'+_0x1e5f5e[_0x3e369c(0x234)]+_0x3e369c(0xfab)));}async function _0x48f141(){const _0x32af2e=_0x13d875;activeShoppingCategoryId=_0x32af2e(0x63d),await _0x568252(),_0x541a81(_0x32af2e(0xd46)),_0x2d8c6d();}async function _0x568252(){const _0x2d90f0=_0x13d875,_0x6d9614=document[_0x2d90f0(0x53a)]('product-grid'),_0x265433=document[_0x2d90f0(0x53a)](_0x2d90f0(0xa2f)),_0x1792f=document[_0x2d90f0(0x53a)]('shopping-screen');_0x6d9614[_0x2d90f0(0xaac)]='',_0x265433[_0x2d90f0(0xaac)]='';const [_0x53b123,_0x4575fe]=await Promise[_0x2d90f0(0x63d)]([_0xa62efb['shoppingProducts'][_0x2d90f0(0xa73)](),_0xa62efb[_0x2d90f0(0x44b)]['orderBy'](_0x2d90f0(0x234))['toArray']()]);_0x1792f[_0x2d90f0(0x1276)][_0x2d90f0(0x4d7)](_0x2d90f0(0x5df),_0x5e4a35);const _0x49b9d8=document[_0x2d90f0(0xd67)](_0x2d90f0(0x59e));_0x49b9d8[_0x2d90f0(0x6de)]='product-category-tab',_0x49b9d8[_0x2d90f0(0x34a)]='全部',_0x49b9d8[_0x2d90f0(0x999)]['categoryId']=_0x2d90f0(0x63d);if(activeShoppingCategoryId===_0x2d90f0(0x63d))_0x49b9d8[_0x2d90f0(0x1276)][_0x2d90f0(0xe13)](_0x2d90f0(0xdf6));_0x265433[_0x2d90f0(0x133d)](_0x49b9d8),_0x4575fe[_0x2d90f0(0xeaf)](_0x356979=>{const _0x3bbf93=_0x2d90f0,_0x2e57d6=document[_0x3bbf93(0xd67)](_0x3bbf93(0x59e));_0x2e57d6[_0x3bbf93(0x6de)]=_0x3bbf93(0x8e8),_0x2e57d6[_0x3bbf93(0x34a)]=_0x356979[_0x3bbf93(0x234)],_0x2e57d6[_0x3bbf93(0x999)]['categoryId']=_0x356979['id'];if(activeShoppingCategoryId===_0x356979['id'])_0x2e57d6[_0x3bbf93(0x1276)][_0x3bbf93(0xe13)](_0x3bbf93(0xdf6));_0x265433[_0x3bbf93(0x133d)](_0x2e57d6);});let _0xe96a05;activeShoppingCategoryId===_0x2d90f0(0x63d)?_0xe96a05=_0x53b123:_0xe96a05=_0x53b123[_0x2d90f0(0x2dd)](_0x47431f=>_0x47431f[_0x2d90f0(0xbcd)]===activeShoppingCategoryId);if(_0xe96a05[_0x2d90f0(0x29d)]===0x0){const _0x868b11=activeShoppingCategoryId===_0x2d90f0(0x63d)?_0x2d90f0(0x61a):_0x2d90f0(0x11ae);_0x6d9614[_0x2d90f0(0xaac)]=_0x2d90f0(0x8a0)+_0x868b11+_0x2d90f0(0x12e2);return;}_0xe96a05[_0x2d90f0(0xeaf)](_0x15bf8d=>{const _0x11d1d1=_0x2d90f0,_0x4ae425=document[_0x11d1d1(0xd67)]('div');_0x4ae425[_0x11d1d1(0x6de)]=_0x11d1d1(0x2ae),_0x4ae425['dataset']['id']=_0x15bf8d['id'];const _0x14d9a1=_0x5e4a35?'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20':'';_0x4ae425[_0x11d1d1(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x14d9a1+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x15bf8d[_0x11d1d1(0x97a)]+_0x11d1d1(0xded)+_0x15bf8d['name']+_0x11d1d1(0x4c5)+_0x15bf8d['price'][_0x11d1d1(0x39e)](0x2)+_0x11d1d1(0x76e),_0x6d9614[_0x11d1d1(0x133d)](_0x4ae425);});}async function _0x151669(_0x92e966,_0x277665=0x1,_0x1066e1=null){const _0x2355e8=_0x13d875,_0x15baa6=_0x1066e1?_0x3db08a[_0x2355e8(0x397)](_0x2c59ed=>_0x2c59ed[_0x2355e8(0x7ac)]===_0x92e966&&_0x2c59ed[_0x2355e8(0x6a1)]?.['name']===_0x1066e1[_0x2355e8(0x234)]):_0x3db08a[_0x2355e8(0x397)](_0x148563=>_0x148563['productId']===_0x92e966&&!_0x148563[_0x2355e8(0x6a1)]);if(_0x15baa6)_0x15baa6['quantity']+=_0x277665;else{const _0x59833c=await _0xa62efb[_0x2355e8(0x1257)][_0x2355e8(0x883)](_0x92e966);_0x59833c&&_0x3db08a[_0x2355e8(0x7dd)]({'productId':_0x59833c['id'],'quantity':_0x277665,'variation':_0x1066e1});}_0x575b6f();}function _0x1827c5(_0x3db635,_0x451c15){const _0x42b12d=_0x13d875,_0x435f16=_0x3db08a[_0x42b12d(0x298)](_0x216f3c=>_0x216f3c[_0x42b12d(0x7ac)]===_0x3db635);_0x435f16>-0x1&&(_0x3db08a[_0x435f16][_0x42b12d(0xc26)]+=_0x451c15,_0x3db08a[_0x435f16]['quantity']<=0x0&&_0x3db08a['splice'](_0x435f16,0x1),_0x575b6f(),_0x3b6dc1());}function _0x575b6f(){const _0x29a219=_0x13d875,_0x765d3d=_0x3db08a[_0x29a219(0xae0)]((_0x392282,_0x40fec4)=>_0x392282+_0x40fec4[_0x29a219(0xc26)],0x0);document[_0x29a219(0x53a)](_0x29a219(0x11a3))[_0x29a219(0x34a)]=_0x765d3d,document[_0x29a219(0x53a)]('cart-title')[_0x29a219(0x34a)]=_0x29a219(0xd3f)+_0x765d3d+')',document[_0x29a219(0x53a)](_0x29a219(0x50c))[_0x29a219(0x34a)]=_0x29a219(0x1123)+_0x765d3d+')';}function _0x341fe5(){_0x3b6dc1(),_0x541a81('cart-screen');}async function _0x3b6dc1(){const _0x55a0aa=_0x13d875,_0x2bc17c=document[_0x55a0aa(0x53a)](_0x55a0aa(0x336));_0x2bc17c[_0x55a0aa(0xaac)]='';let _0xf2a2d0=0x0;if(_0x3db08a[_0x55a0aa(0x29d)]===0x0)_0x2bc17c[_0x55a0aa(0xaac)]=_0x55a0aa(0x7df);else{const _0x2b372b=_0x3db08a[_0x55a0aa(0xcb4)](_0x301e68=>_0x301e68['productId']),_0x4f9a32=await _0xa62efb['shoppingProducts']['where']('id')['anyOf'](_0x2b372b)[_0x55a0aa(0xa73)](),_0x5b03fe=new Map(_0x4f9a32[_0x55a0aa(0xcb4)](_0x285a73=>[_0x285a73['id'],_0x285a73]));_0x3db08a[_0x55a0aa(0xeaf)](_0x3ad211=>{const _0x2e71e9=_0x55a0aa,_0x25753f=_0x5b03fe[_0x2e71e9(0x883)](_0x3ad211[_0x2e71e9(0x7ac)]);if(_0x25753f){const _0x5bde07=document[_0x2e71e9(0xd67)](_0x2e71e9(0x1425));_0x5bde07[_0x2e71e9(0x6de)]=_0x2e71e9(0xf6b);const _0x36e9f6=_0x3ad211['variation']?_0x2e71e9(0xf3f)+_0x3ad211[_0x2e71e9(0x6a1)][_0x2e71e9(0x234)]+_0x2e71e9(0x864):'';_0x5bde07[_0x2e71e9(0xaac)]=_0x2e71e9(0x132d)+_0x25753f['id']+_0x2e71e9(0xcf4)+(_0x3ad211[_0x2e71e9(0x6a1)]?.[_0x2e71e9(0x97a)]||_0x25753f[_0x2e71e9(0x97a)])+_0x2e71e9(0x50d)+_0x25753f[_0x2e71e9(0x234)]+_0x2e71e9(0xfc1)+_0x36e9f6+_0x2e71e9(0x482)+(_0x3ad211[_0x2e71e9(0x6a1)]?.['price']||_0x25753f[_0x2e71e9(0xbde)])['toFixed'](0x2)+_0x2e71e9(0xda5)+_0x25753f['id']+_0x2e71e9(0x4ce)+_0x3ad211[_0x2e71e9(0xc26)]+_0x2e71e9(0x1fa)+_0x25753f['id']+_0x2e71e9(0xc53),_0x2bc17c[_0x2e71e9(0x133d)](_0x5bde07);}});}_0x184c57();}async function _0x184c57(){const _0x2fd101=_0x13d875;let _0x2cacbd=0x0;const _0x42f307=document[_0x2fd101(0xc3d)](_0x2fd101(0x72d)),_0x2de22a=Array[_0x2fd101(0xd97)](_0x42f307)[_0x2fd101(0xcb4)](_0x57c81f=>parseInt(_0x57c81f[_0x2fd101(0x999)]['id']));if(_0x2de22a[_0x2fd101(0x29d)]>0x0){const _0x37d30b=await _0xa62efb['shoppingProducts'][_0x2fd101(0x57e)]('id')[_0x2fd101(0x1265)](_0x2de22a)[_0x2fd101(0xa73)](),_0x15e53a=new Map(_0x37d30b[_0x2fd101(0xcb4)](_0x295925=>[_0x295925['id'],_0x295925]));_0x3db08a['forEach'](_0x564f07=>{const _0x3e43d8=_0x2fd101;if(_0x2de22a['includes'](_0x564f07[_0x3e43d8(0x7ac)])){const _0x25f2dd=_0x15e53a['get'](_0x564f07[_0x3e43d8(0x7ac)]);if(_0x25f2dd){const _0x181073=_0x564f07[_0x3e43d8(0x6a1)]?_0x564f07[_0x3e43d8(0x6a1)][_0x3e43d8(0xbde)]:_0x25f2dd[_0x3e43d8(0xbde)];_0x2cacbd+=_0x181073*_0x564f07[_0x3e43d8(0xc26)];}}});}document['getElementById'](_0x2fd101(0x141e))[_0x2fd101(0x34a)]='合计:\x20¥'+_0x2cacbd['toFixed'](0x2);}async function _0x469c7a(){const _0x565ad0=_0x13d875,_0x2b9b98=_0x53d851['chats'][_0x53d851[_0x565ad0(0x13be)]];if(!_0x2b9b98||!_0x2b9b98['isGroup'])return;const _0x28eea7=document[_0x565ad0(0x53a)](_0x565ad0(0xae6)),_0x32ea61=document['getElementById'](_0x565ad0(0x1306));_0x32ea61[_0x565ad0(0xaac)]='';const _0x23db84=_0x2b9b98['settings'][_0x565ad0(0x1303)]||'我',_0x1290d9=_0x2b9b98['members']['filter'](_0x29de6f=>_0x29de6f[_0x565ad0(0x12bc)]!==_0x23db84);_0x1290d9[_0x565ad0(0xeaf)](_0x45243a=>{const _0x22377f=_0x565ad0,_0xf47226=document[_0x22377f(0xd67)](_0x22377f(0x1425));_0xf47226['className']=_0x22377f(0xa94),_0xf47226['dataset'][_0x22377f(0x283)]=_0x45243a[_0x22377f(0x543)],_0xf47226['innerHTML']=_0x22377f(0x139a)+(_0x45243a['avatar']||_0x434592)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x45243a[_0x22377f(0x12bc)]+_0x22377f(0x12a5),_0x32ea61[_0x22377f(0x133d)](_0xf47226);}),document['getElementById']('select-all-recipients')[_0x565ad0(0x1077)]=![],_0x28eea7[_0x565ad0(0x1276)]['add'](_0x565ad0(0xaef));}async function _0x34ed36(){const _0x180aee=_0x13d875,_0x4d0d3d=_0x53d851['chats'][_0x53d851[_0x180aee(0x13be)]],_0x1548ca=_0x3db08a['filter'](_0x496ba2=>document[_0x180aee(0x139c)](_0x180aee(0x85a)+_0x496ba2[_0x180aee(0x7ac)]+_0x180aee(0x10c5)));if(_0x1548ca[_0x180aee(0x29d)]===0x0){alert(_0x180aee(0x218));return;}if(_0x4d0d3d[_0x180aee(0x86e)])_0x469c7a();else{const _0x25d73e=await _0x355fc0(_0x180aee(0x926),_0x180aee(0x35d),{'confirmText':_0x180aee(0x72b)});_0x25d73e&&await _0x329a69(_0x1548ca);}}async function _0x329a69(_0x52fa63,_0x46fdc2=null){const _0x16a79a=_0x13d875;if(!_0x53d851[_0x16a79a(0x13be)])return;const _0x294d68=_0x53d851[_0x16a79a(0xaa3)][_0x53d851[_0x16a79a(0x13be)]],_0x24228b=_0x52fa63[_0x16a79a(0xcb4)](_0x331c5f=>_0x331c5f[_0x16a79a(0x7ac)]),_0x3ff40c=await _0xa62efb[_0x16a79a(0x1257)][_0x16a79a(0x57e)]('id')['anyOf'](_0x24228b)[_0x16a79a(0xa73)](),_0x520455=new Map(_0x3ff40c[_0x16a79a(0xcb4)](_0xfe3595=>[_0xfe3595['id'],_0xfe3595])),_0x1b964c=_0x52fa63[_0x16a79a(0xcb4)](_0x9f1cee=>{const _0x1f9f4c=_0x16a79a,_0x1e1959=_0x520455['get'](_0x9f1cee['productId']);return _0x9f1cee['variation']?{'name':_0x1e1959[_0x1f9f4c(0x234)]+_0x1f9f4c(0x122c)+_0x9f1cee[_0x1f9f4c(0x6a1)][_0x1f9f4c(0x234)],'price':_0x9f1cee[_0x1f9f4c(0x6a1)]['price'],'imageUrl':_0x9f1cee[_0x1f9f4c(0x6a1)]['imageUrl']||_0x1e1959[_0x1f9f4c(0x97a)],'quantity':_0x9f1cee['quantity']}:{'name':_0x1e1959[_0x1f9f4c(0x234)],'price':_0x1e1959[_0x1f9f4c(0xbde)],'imageUrl':_0x1e1959['imageUrl'],'quantity':_0x9f1cee['quantity']};}),_0x4e938d={'role':_0x16a79a(0x10ae),'type':_0x16a79a(0x205),'timestamp':Date[_0x16a79a(0x9c1)](),'items':_0x1b964c,'total':_0x1b964c[_0x16a79a(0xae0)]((_0x11e884,_0x5d36f2)=>_0x11e884+_0x5d36f2[_0x16a79a(0xbde)]*_0x5d36f2[_0x16a79a(0xc26)],0x0),'recipients':_0x46fdc2};_0x294d68[_0x16a79a(0xe83)][_0x16a79a(0x7dd)](_0x4e938d);if(_0x46fdc2&&_0x46fdc2[_0x16a79a(0x29d)]>0x0){const _0x5da75d=_0x46fdc2[_0x16a79a(0xcb4)](_0x1815e1=>_0xf33fb2(_0x294d68,_0x1815e1))['join']('、'),_0x5315e2={'role':'system','content':'[系统提示：用户\x20('+(_0x294d68['settings'][_0x16a79a(0x1303)]||'我')+')\x20送出了一份礼物，收礼人是：'+_0x5da75d+'。请收礼的角色表示感谢，其他角色可以自由发挥。]','timestamp':Date[_0x16a79a(0x9c1)]()+0x1,'isHidden':!![]};_0x294d68[_0x16a79a(0xe83)][_0x16a79a(0x7dd)](_0x5315e2);}await _0xa62efb['chats'][_0x16a79a(0x546)](_0x294d68),_0xa4d65(_0x4e938d,_0x294d68),_0x5001a4(),_0x3db08a=_0x3db08a[_0x16a79a(0x2dd)](_0x461996=>!_0x52fa63[_0x16a79a(0xe0f)](_0x2d221b=>_0x2d221b[_0x16a79a(0x7ac)]===_0x461996[_0x16a79a(0x7ac)])),_0x575b6f(),_0x541a81(_0x16a79a(0x10ba)),await _0x184397('成功',_0x16a79a(0xebf));}function _0x40bff8(_0x1efcd6){const _0xe3beb9=_0x13d875,_0x3a3f64=_0x53d851[_0xe3beb9(0xaa3)][_0x53d851[_0xe3beb9(0x13be)]],_0x48993f=_0x3a3f64[_0xe3beb9(0xe83)][_0xe3beb9(0x397)](_0x1fe9c6=>_0x1fe9c6[_0xe3beb9(0x827)]===_0x1efcd6);if(!_0x48993f||_0x48993f[_0xe3beb9(0x919)]!==_0xe3beb9(0x205))return;const _0x4082af=document[_0xe3beb9(0x53a)](_0xe3beb9(0xe55));let _0x1310b5='';_0x48993f[_0xe3beb9(0xa27)]['forEach'](_0x5532d8=>{const _0x26b190=_0xe3beb9;_0x1310b5+=_0x26b190(0x1374)+_0x5532d8[_0x26b190(0x234)]+_0x26b190(0x53e)+_0x5532d8[_0x26b190(0xc26)]+'</td><td\x20class=\x22item-price\x22>¥'+_0x5532d8[_0x26b190(0xbde)][_0x26b190(0x39e)](0x2)+_0x26b190(0x643)+(_0x5532d8[_0x26b190(0xbde)]*_0x5532d8['quantity'])[_0x26b190(0x39e)](0x2)+'</td></tr>';}),_0x4082af[_0xe3beb9(0xaac)]=_0xe3beb9(0x5ef)+new Date(_0x48993f[_0xe3beb9(0x827)])[_0xe3beb9(0x5ee)]()+_0xe3beb9(0x388)+_0x1310b5+_0xe3beb9(0xb81)+_0x48993f[_0xe3beb9(0x7c0)][_0xe3beb9(0x39e)](0x2)+_0xe3beb9(0x3e1),document[_0xe3beb9(0x53a)](_0xe3beb9(0x6c9))[_0xe3beb9(0x1276)][_0xe3beb9(0xe13)](_0xe3beb9(0xaef));}async function _0x5da4a1(_0x1295e1=null){const _0x501c8a=_0x13d875;_0x69ac40=_0x1295e1;const _0x9066cd=document['getElementById']('product-editor-modal'),_0x4d0b68=document['getElementById']('product-editor-title'),_0xbde06c=document[_0x501c8a(0x53a)](_0x501c8a(0x800)),_0x3c8b35=document[_0x501c8a(0x53a)](_0x501c8a(0x7f9)),_0x43ef96=document[_0x501c8a(0x53a)](_0x501c8a(0x13c8)),_0x55e4cc=document['getElementById'](_0x501c8a(0x1f5)),_0x1b2eb4=document['getElementById'](_0x501c8a(0x41d)),_0x4e51cf=document[_0x501c8a(0x53a)](_0x501c8a(0x314));_0x4e51cf[_0x501c8a(0xaac)]='',_0x1b2eb4[_0x501c8a(0xaac)]=_0x501c8a(0x5d8);const _0x4bde14=await _0xa62efb[_0x501c8a(0x44b)][_0x501c8a(0xa73)]();_0x4bde14['forEach'](_0x4711f5=>{const _0x293057=_0x501c8a,_0x53466e=document[_0x293057(0xd67)](_0x293057(0xa1e));_0x53466e[_0x293057(0x11a2)]=_0x4711f5['id'],_0x53466e['textContent']=_0x4711f5[_0x293057(0x234)],_0x1b2eb4['appendChild'](_0x53466e);});if(_0x1295e1){_0x4d0b68[_0x501c8a(0x34a)]=_0x501c8a(0x2c9);const _0x49e94a=await _0xa62efb[_0x501c8a(0x1257)][_0x501c8a(0x883)](_0x1295e1);_0xbde06c[_0x501c8a(0x11a2)]=_0x49e94a['name'],_0x3c8b35['value']=_0x49e94a[_0x501c8a(0xbde)],_0x43ef96[_0x501c8a(0x11a2)]=_0x49e94a['description']||'',_0x55e4cc['src']=_0x49e94a[_0x501c8a(0x97a)],_0x1b2eb4[_0x501c8a(0x11a2)]=_0x49e94a[_0x501c8a(0xbcd)]||'',_0x49e94a[_0x501c8a(0xfdb)]&&_0x49e94a[_0x501c8a(0xfdb)]['length']>0x0&&_0x49e94a[_0x501c8a(0xfdb)][_0x501c8a(0xeaf)](_0x1fa57d=>_0x23b682(_0x1fa57d));}else _0x4d0b68[_0x501c8a(0x34a)]=_0x501c8a(0x74a),_0xbde06c[_0x501c8a(0x11a2)]='',_0x3c8b35['value']='',_0x43ef96[_0x501c8a(0x11a2)]='',_0x55e4cc[_0x501c8a(0x7ff)]='https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756206115802_qdqqd_0c99bh.jpeg',_0x1b2eb4[_0x501c8a(0x11a2)]='';_0x9066cd['classList'][_0x501c8a(0xe13)](_0x501c8a(0xaef));}async function _0x3d1c1b(){const _0x3aae3b=_0x13d875,_0xe08acd=document[_0x3aae3b(0x53a)](_0x3aae3b(0x800))['value']['trim'](),_0x21b986=parseFloat(document['getElementById'](_0x3aae3b(0x7f9))[_0x3aae3b(0x11a2)]),_0x42031f=document[_0x3aae3b(0x53a)](_0x3aae3b(0x13c8))['value'][_0x3aae3b(0x13bc)](),_0xfd27f7=document[_0x3aae3b(0x53a)](_0x3aae3b(0x1f5))[_0x3aae3b(0x7ff)],_0x1d9be5=parseInt(document['getElementById'](_0x3aae3b(0x41d))[_0x3aae3b(0x11a2)])||null;if(!_0xe08acd){alert('商品名称不能为空！');return;}if(isNaN(_0x21b986)||_0x21b986<0x0){alert('请输入有效的默认价格！');return;}const _0x4131ba=[];document['querySelectorAll'](_0x3aae3b(0x82b))[_0x3aae3b(0xeaf)](_0xbba1b4=>{const _0x374b1a=_0x3aae3b,_0x5e789c=_0xbba1b4[_0x374b1a(0x139c)]('.variation-name-input')['value']['trim'](),_0x425852=parseFloat(_0xbba1b4['querySelector']('.variation-price-input')[_0x374b1a(0x11a2)]),_0x2c8ec2=_0xbba1b4['querySelector'](_0x374b1a(0x8e3))[_0x374b1a(0x7ff)];_0x5e789c&&!isNaN(_0x425852)&&_0x425852>=0x0&&_0x4131ba[_0x374b1a(0x7dd)]({'name':_0x5e789c,'price':_0x425852,'imageUrl':_0x2c8ec2[_0x374b1a(0x6e9)](_0x374b1a(0xba4))?null:_0x2c8ec2});});const _0x54c509={'name':_0xe08acd,'price':_0x21b986,'description':_0x42031f,'imageUrl':_0xfd27f7,'categoryId':_0x1d9be5,'variations':_0x4131ba};_0x69ac40?await _0xa62efb['shoppingProducts'][_0x3aae3b(0xc03)](_0x69ac40,_0x54c509):await _0xa62efb[_0x3aae3b(0x1257)][_0x3aae3b(0xe13)](_0x54c509),document[_0x3aae3b(0x53a)](_0x3aae3b(0xddf))[_0x3aae3b(0x1276)][_0x3aae3b(0x2d4)](_0x3aae3b(0xaef)),await _0x568252();}async function _0x4e194f(){const _0x483774=_0x13d875;await _0x155e3a(),_0x541a81(_0x483774(0xe03));}async function _0x155e3a(){const _0x226b3c=_0x13d875,_0x722c17=document[_0x226b3c(0x53a)](_0x226b3c(0x115e)),_0x3996a8=document[_0x226b3c(0x53a)](_0x226b3c(0xf8c));_0x722c17['innerHTML']='',_0x3996a8[_0x226b3c(0xaac)]='';const _0x8c6ab3=await _0xa62efb[_0x226b3c(0xb23)][_0x226b3c(0xa73)]();if(_0x8c6ab3[_0x226b3c(0x29d)]===0x0){_0x3996a8[_0x226b3c(0xaac)]=_0x226b3c(0x1256);return;}const _0x17e740=document[_0x226b3c(0xd67)](_0x226b3c(0x59e));_0x17e740[_0x226b3c(0x6de)]=_0x226b3c(0x7c8),_0x17e740[_0x226b3c(0x34a)]=_0x226b3c(0x112f),_0x17e740['dataset'][_0x226b3c(0xbcd)]=_0x226b3c(0x131a),_0x722c17[_0x226b3c(0x133d)](_0x17e740);const _0x2e4380=document[_0x226b3c(0xd67)](_0x226b3c(0x1425));_0x2e4380['className']='rules-category-pane\x20active',_0x2e4380[_0x226b3c(0x999)][_0x226b3c(0xbcd)]=_0x226b3c(0x131a),_0x3996a8[_0x226b3c(0x133d)](_0x2e4380);const _0x314de1=Object[_0x226b3c(0x244)](_0x53d851[_0x226b3c(0xaa3)])[_0x226b3c(0x2dd)](_0x5c3d0e=>!_0x5c3d0e[_0x226b3c(0x86e)]&&_0x8c6ab3[_0x226b3c(0xe0f)](_0x435167=>_0x435167[_0x226b3c(0x1054)]===_0x5c3d0e['id']));_0x314de1[_0x226b3c(0xeaf)](_0x475e68=>{const _0x889c5e=_0x226b3c,_0xfa80bd=document[_0x889c5e(0xd67)](_0x889c5e(0x59e));_0xfa80bd['className']=_0x889c5e(0xc8f),_0xfa80bd[_0x889c5e(0x34a)]=_0x475e68[_0x889c5e(0x234)],_0xfa80bd['dataset'][_0x889c5e(0xbcd)]=_0x475e68['id'],_0x722c17[_0x889c5e(0x133d)](_0xfa80bd);const _0x543fcc=document[_0x889c5e(0xd67)](_0x889c5e(0x1425));_0x543fcc[_0x889c5e(0x6de)]=_0x889c5e(0x6bd),_0x543fcc['dataset'][_0x889c5e(0xbcd)]=_0x475e68['id'],_0x3996a8[_0x889c5e(0x133d)](_0x543fcc);}),_0x8c6ab3[_0x226b3c(0xeaf)](_0x3870a2=>{const _0x5f4b4f=_0x226b3c,_0x2299e4=_0x54dd79(_0x3870a2),_0x30f47a=_0x3996a8[_0x5f4b4f(0x139c)]('.rules-category-pane[data-category-id=\x22'+_0x3870a2[_0x5f4b4f(0x1054)]+'\x22]');_0x30f47a&&_0x30f47a['appendChild'](_0x2299e4);}),document['querySelectorAll'](_0x226b3c(0xf81))[_0x226b3c(0xeaf)](_0x25c6e6=>{const _0x3c354d=_0x226b3c;_0x25c6e6[_0x3c354d(0x1086)](_0x3c354d(0xb2b),()=>_0x22b4ff(_0x25c6e6['dataset'][_0x3c354d(0xbcd)]));});}function _0x54dd79(_0x1d323b){const _0xcb1d9f=_0x13d875,_0x496c6c=document[_0xcb1d9f(0xd67)](_0xcb1d9f(0x1425));return _0x496c6c[_0xcb1d9f(0x6de)]=_0xcb1d9f(0x1341)+(_0x1d323b[_0xcb1d9f(0x71c)]?_0xcb1d9f(0xb3d):''),_0x496c6c[_0xcb1d9f(0x999)]['ruleId']=_0x1d323b['id'],_0x496c6c[_0xcb1d9f(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x1d323b[_0xcb1d9f(0x234)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>'+_0x1d323b[_0xcb1d9f(0x7bc)]+_0xcb1d9f(0x1133),_0x496c6c[_0xcb1d9f(0x1086)](_0xcb1d9f(0xb2b),()=>_0x5bd706(_0x1d323b['id'])),_0x3146aa(_0x496c6c,()=>_0x2ef73c(_0x1d323b['id'])),_0x496c6c;}async function _0x5bd706(_0x53047d=null){const _0x11e34b=_0x13d875;_0xe2b162=_0x53047d;const _0x6896a3=document[_0x11e34b(0x53a)](_0x11e34b(0x1334)),_0x2ce5ff=document[_0x11e34b(0x53a)](_0x11e34b(0xb50)),_0x51a678=document[_0x11e34b(0x53a)](_0x11e34b(0x1057)),_0x5cb004=document['getElementById'](_0x11e34b(0x1195)),_0x2b15eb=document[_0x11e34b(0x53a)](_0x11e34b(0x215)),_0x2e9411=document[_0x11e34b(0x53a)](_0x11e34b(0xc9c)),_0x42c36e=document[_0x11e34b(0x53a)]('rule-enabled-switch');_0x5cb004['innerHTML']=_0x11e34b(0x10b0),Object['values'](_0x53d851['chats'])['filter'](_0x229460=>!_0x229460[_0x11e34b(0x86e)])[_0x11e34b(0xeaf)](_0x4bff2f=>{const _0x341c55=_0x11e34b;_0x5cb004['innerHTML']+=_0x341c55(0xd1f)+_0x4bff2f['id']+'\x22>'+_0x4bff2f[_0x341c55(0x234)]+_0x341c55(0x9a8);});if(_0x53047d){_0x2ce5ff[_0x11e34b(0x34a)]=_0x11e34b(0x3b6);const _0x955508=await _0xa62efb[_0x11e34b(0xb23)][_0x11e34b(0x883)](_0x53047d);_0x51a678[_0x11e34b(0x11a2)]=_0x955508[_0x11e34b(0x234)],_0x5cb004['value']=_0x955508[_0x11e34b(0x1054)],_0x2b15eb[_0x11e34b(0x11a2)]=_0x955508[_0x11e34b(0x7bc)],_0x2e9411['value']=_0x955508[_0x11e34b(0x5ba)],_0x42c36e[_0x11e34b(0x1077)]=_0x955508[_0x11e34b(0x71c)];}else _0x2ce5ff[_0x11e34b(0x34a)]=_0x11e34b(0x7e1),_0x51a678[_0x11e34b(0x11a2)]='',_0x5cb004[_0x11e34b(0x11a2)]='global',_0x2b15eb[_0x11e34b(0x11a2)]='',_0x2e9411[_0x11e34b(0x11a2)]='',_0x42c36e['checked']=!![];_0x6896a3[_0x11e34b(0x1276)][_0x11e34b(0xe13)](_0x11e34b(0xaef));}async function _0x206abc(){const _0x56cbed=_0x13d875,_0x5c4518=document['getElementById'](_0x56cbed(0x1057))[_0x56cbed(0x11a2)][_0x56cbed(0x13bc)](),_0x5ea922=document[_0x56cbed(0x53a)](_0x56cbed(0x215))[_0x56cbed(0x11a2)][_0x56cbed(0x13bc)]();if(!_0x5c4518||!_0x5ea922){alert('规则名称和正则表达式不能为空！');return;}try{new RegExp(_0x5ea922);}catch(_0x2b9ec3){alert(_0x56cbed(0xde0)+_0x2b9ec3[_0x56cbed(0x875)]);return;}const _0x4a18e1={'name':_0x5c4518,'chatId':document[_0x56cbed(0x53a)](_0x56cbed(0x1195))[_0x56cbed(0x11a2)],'regex':_0x5ea922,'template':document[_0x56cbed(0x53a)](_0x56cbed(0xc9c))[_0x56cbed(0x11a2)],'isEnabled':document[_0x56cbed(0x53a)](_0x56cbed(0xaf7))[_0x56cbed(0x1077)]};_0xe2b162?await _0xa62efb[_0x56cbed(0xb23)]['update'](_0xe2b162,_0x4a18e1):await _0xa62efb[_0x56cbed(0xb23)][_0x56cbed(0xe13)](_0x4a18e1),document[_0x56cbed(0x53a)](_0x56cbed(0x1334))[_0x56cbed(0x1276)][_0x56cbed(0x2d4)](_0x56cbed(0xaef)),await _0x155e3a();}async function _0x2ef73c(_0x13606c){const _0xc7209b=_0x13d875,_0x5aa879=await _0x355fc0(_0xc7209b(0x794),_0xc7209b(0xc7a),{'confirmButtonClass':'btn-danger'});_0x5aa879&&(await _0xa62efb[_0xc7209b(0xb23)][_0xc7209b(0x121e)](_0x13606c),await _0x155e3a());}async function _0xdae79d(_0x10df3a,_0x361078){const _0x165b50=_0x13d875;if(_0x10df3a[_0x165b50(0x13bc)]()[_0x165b50(0x1200)]('<')||!_0x10df3a[_0x165b50(0x6e9)]('[')&&!_0x10df3a[_0x165b50(0x6e9)]('{'))return _0x10df3a;const _0x12223b=await _0xa62efb[_0x165b50(0xb23)][_0x165b50(0x57e)]('chatId')[_0x165b50(0x12f6)](_0x165b50(0x131a))['or'](_0x165b50(0x1054))[_0x165b50(0x12f6)](_0x361078)[_0x165b50(0xa73)]();let _0x51ce79=_0x10df3a;for(const _0x111a2c of _0x12223b['filter'](_0x3b9e18=>_0x3b9e18[_0x165b50(0x71c)])){try{const _0x62b9c2=new RegExp(_0x111a2c['regex'],'g');_0x62b9c2['test'](_0x51ce79)&&(_0x51ce79=_0x51ce79[_0x165b50(0x795)](_0x62b9c2,_0x111a2c[_0x165b50(0x5ba)]));}catch(_0x4d0f2a){console[_0x165b50(0x617)](_0x165b50(0x8da)+_0x111a2c[_0x165b50(0x234)]+_0x165b50(0xf7a),_0x4d0f2a);}}return _0x51ce79;}async function _0x4e194f(){await _0x155e3a(),_0x541a81('rendering-rules-screen');}async function _0x155e3a(){const _0x111cb8=_0x13d875,_0xec1365=document[_0x111cb8(0x53a)](_0x111cb8(0x115e)),_0x26c59c=document['getElementById'](_0x111cb8(0xf8c));_0xec1365[_0x111cb8(0xaac)]='',_0x26c59c['innerHTML']='';const _0x1063bd=await _0xa62efb[_0x111cb8(0xb23)][_0x111cb8(0xa73)]();if(_0x1063bd['length']===0x0){_0x26c59c[_0x111cb8(0xaac)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>';return;}const _0x55723a=document[_0x111cb8(0xd67)]('button');_0x55723a[_0x111cb8(0x6de)]='rules-tab\x20active',_0x55723a['textContent']=_0x111cb8(0x112f),_0x55723a['dataset']['categoryId']=_0x111cb8(0x131a),_0xec1365['appendChild'](_0x55723a);const _0x33b357=document[_0x111cb8(0xd67)](_0x111cb8(0x1425));_0x33b357[_0x111cb8(0x6de)]='rules-category-pane\x20active',_0x33b357[_0x111cb8(0x999)][_0x111cb8(0xbcd)]='global',_0x26c59c[_0x111cb8(0x133d)](_0x33b357);const _0x59774c=Object['values'](_0x53d851['chats'])['filter'](_0x26df9e=>!_0x26df9e[_0x111cb8(0x86e)]&&_0x1063bd[_0x111cb8(0xe0f)](_0x2a9575=>_0x2a9575['chatId']===_0x26df9e['id']));_0x59774c[_0x111cb8(0xeaf)](_0x255a36=>{const _0x369be5=_0x111cb8,_0x4fa909=document[_0x369be5(0xd67)]('button');_0x4fa909[_0x369be5(0x6de)]=_0x369be5(0xc8f),_0x4fa909['textContent']=_0x255a36[_0x369be5(0x234)],_0x4fa909[_0x369be5(0x999)][_0x369be5(0xbcd)]=_0x255a36['id'],_0xec1365[_0x369be5(0x133d)](_0x4fa909);const _0x48e231=document[_0x369be5(0xd67)]('div');_0x48e231[_0x369be5(0x6de)]=_0x369be5(0x6bd),_0x48e231[_0x369be5(0x999)][_0x369be5(0xbcd)]=_0x255a36['id'],_0x26c59c[_0x369be5(0x133d)](_0x48e231);}),_0x1063bd[_0x111cb8(0xeaf)](_0x59c75f=>{const _0x42ab44=_0x111cb8,_0x4b8ac7=_0x54dd79(_0x59c75f),_0x52e3f6=_0x26c59c['querySelector'](_0x42ab44(0x880)+_0x59c75f[_0x42ab44(0x1054)]+'\x22]');_0x52e3f6&&_0x52e3f6['appendChild'](_0x4b8ac7);}),document[_0x111cb8(0xc3d)](_0x111cb8(0xf81))['forEach'](_0x3bf216=>{const _0x3843da=_0x111cb8;_0x3bf216['addEventListener'](_0x3843da(0xb2b),()=>_0x22b4ff(_0x3bf216[_0x3843da(0x999)]['categoryId']));});}function _0x54dd79(_0x5e1022){const _0x587580=_0x13d875,_0x4439a7=document[_0x587580(0xd67)](_0x587580(0x1425));return _0x4439a7[_0x587580(0x6de)]=_0x587580(0x1341)+(_0x5e1022['isEnabled']?_0x587580(0xb3d):''),_0x4439a7[_0x587580(0x999)][_0x587580(0x11fd)]=_0x5e1022['id'],_0x4439a7[_0x587580(0xaac)]=_0x587580(0x3c1)+_0x5e1022[_0x587580(0x234)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>'+_0x5e1022['regex']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4439a7[_0x587580(0x1086)](_0x587580(0xb2b),()=>_0x5bd706(_0x5e1022['id'])),_0x3146aa(_0x4439a7,()=>_0x2ef73c(_0x5e1022['id'])),_0x4439a7;}async function _0x5bd706(_0x4bec0b=null){const _0x503ad1=_0x13d875;_0xe2b162=_0x4bec0b;const _0x1497ab=document[_0x503ad1(0x53a)](_0x503ad1(0x1334)),_0x5642ea=document['getElementById']('rule-editor-title'),_0x17bc65=document[_0x503ad1(0x53a)]('rule-name-input'),_0x25cfe6=document[_0x503ad1(0x53a)](_0x503ad1(0x1195)),_0x8784fa=document[_0x503ad1(0x53a)](_0x503ad1(0x215)),_0x433381=document[_0x503ad1(0x53a)](_0x503ad1(0xc9c)),_0x174b62=document['getElementById'](_0x503ad1(0xaf7));_0x25cfe6[_0x503ad1(0xaac)]=_0x503ad1(0x10b0),Object[_0x503ad1(0x244)](_0x53d851[_0x503ad1(0xaa3)])[_0x503ad1(0x2dd)](_0x516d8b=>!_0x516d8b[_0x503ad1(0x86e)])[_0x503ad1(0xeaf)](_0xc49d5b=>{const _0x52c68f=_0x503ad1;_0x25cfe6[_0x52c68f(0xaac)]+=_0x52c68f(0xd1f)+_0xc49d5b['id']+'\x22>'+_0xc49d5b[_0x52c68f(0x234)]+_0x52c68f(0x9a8);});if(_0x4bec0b){_0x5642ea[_0x503ad1(0x34a)]=_0x503ad1(0x3b6);const _0x4856c3=await _0xa62efb[_0x503ad1(0xb23)][_0x503ad1(0x883)](_0x4bec0b);_0x17bc65[_0x503ad1(0x11a2)]=_0x4856c3[_0x503ad1(0x234)],_0x25cfe6[_0x503ad1(0x11a2)]=_0x4856c3[_0x503ad1(0x1054)],_0x8784fa[_0x503ad1(0x11a2)]=_0x4856c3['regex'],_0x433381[_0x503ad1(0x11a2)]=_0x4856c3[_0x503ad1(0x5ba)],_0x174b62['checked']=_0x4856c3[_0x503ad1(0x71c)];}else _0x5642ea[_0x503ad1(0x34a)]=_0x503ad1(0x7e1),_0x17bc65[_0x503ad1(0x11a2)]='',_0x25cfe6[_0x503ad1(0x11a2)]=_0x503ad1(0x131a),_0x8784fa[_0x503ad1(0x11a2)]='',_0x433381['value']='',_0x174b62[_0x503ad1(0x1077)]=!![];_0x1497ab[_0x503ad1(0x1276)][_0x503ad1(0xe13)]('visible');}async function _0x206abc(){const _0x4dd3a2=_0x13d875,_0x27354d=document[_0x4dd3a2(0x53a)](_0x4dd3a2(0x1057))[_0x4dd3a2(0x11a2)][_0x4dd3a2(0x13bc)](),_0xfa02ab=document[_0x4dd3a2(0x53a)](_0x4dd3a2(0x215))[_0x4dd3a2(0x11a2)]['trim']();if(!_0x27354d||!_0xfa02ab){alert('规则名称和正则表达式不能为空！');return;}try{new RegExp(_0xfa02ab);}catch(_0x56dac2){alert(_0x4dd3a2(0xde0)+_0x56dac2[_0x4dd3a2(0x875)]);return;}const _0x2820b8={'name':_0x27354d,'chatId':document['getElementById']('rule-chat-id-select')['value'],'regex':_0xfa02ab,'template':document[_0x4dd3a2(0x53a)](_0x4dd3a2(0xc9c))['value'],'isEnabled':document['getElementById'](_0x4dd3a2(0xaf7))[_0x4dd3a2(0x1077)]};_0xe2b162?await _0xa62efb[_0x4dd3a2(0xb23)][_0x4dd3a2(0xc03)](_0xe2b162,_0x2820b8):await _0xa62efb[_0x4dd3a2(0xb23)][_0x4dd3a2(0xe13)](_0x2820b8),document[_0x4dd3a2(0x53a)](_0x4dd3a2(0x1334))[_0x4dd3a2(0x1276)][_0x4dd3a2(0x2d4)]('visible'),await _0x155e3a();}async function _0x2ef73c(_0x234463){const _0x1931e5=_0x13d875,_0x121c17=await _0x355fc0(_0x1931e5(0x794),_0x1931e5(0xc7a),{'confirmButtonClass':'btn-danger'});_0x121c17&&(await _0xa62efb[_0x1931e5(0xb23)][_0x1931e5(0x121e)](_0x234463),await _0x155e3a());}async function _0xdae79d(_0x4efc27,_0xc5750a){const _0x27a55a=_0x13d875;if(_0x4efc27[_0x27a55a(0x13bc)]()['startsWith']('<')||!_0x4efc27[_0x27a55a(0x6e9)]('[')&&!_0x4efc27[_0x27a55a(0x6e9)]('{'))return _0x4efc27;if(!_0x5dbfcd[_0xc5750a]){console[_0x27a55a(0x1081)](_0x27a55a(0x24c)+_0xc5750a);const _0x11f7c5=await _0xa62efb[_0x27a55a(0xb23)][_0x27a55a(0x57e)](_0x27a55a(0x1054))[_0x27a55a(0x12f6)](_0x27a55a(0x131a))['or']('chatId')['equals'](_0xc5750a)[_0x27a55a(0xa73)]();_0x5dbfcd[_0xc5750a]=_0x11f7c5[_0x27a55a(0x2dd)](_0xb32430=>_0xb32430[_0x27a55a(0x71c)]);}const _0x3b425e=_0x5dbfcd[_0xc5750a];let _0x5c72da=_0x4efc27;for(const _0x1568b9 of _0x3b425e){try{const _0x54e01d=new RegExp(_0x1568b9[_0x27a55a(0x7bc)],'g');let _0x159c4f=_0x5c72da;_0x54e01d[_0x27a55a(0x7f2)](_0x159c4f)&&(_0x5c72da=_0x5c72da[_0x27a55a(0x795)](_0x54e01d,_0x1568b9[_0x27a55a(0x5ba)]));}catch(_0x3b8d7f){console[_0x27a55a(0x617)](_0x27a55a(0x8da)+_0x1568b9[_0x27a55a(0x234)]+_0x27a55a(0xf7a),_0x3b8d7f);}}return _0x5c72da;}function _0x190172(_0x348c76){const _0x4c85f5=_0x13d875;if(!_0x348c76)return'';const _0x2b0cbf=new Date(),_0x3ff5c1=new Date(_0x348c76),_0x3a6c6d=String(_0x3ff5c1[_0x4c85f5(0x659)]())[_0x4c85f5(0x117e)](0x2,'0'),_0x106889=String(_0x3ff5c1[_0x4c85f5(0xa77)]())[_0x4c85f5(0x117e)](0x2,'0'),_0x15cf68=_0x3a6c6d+':'+_0x106889;if(_0x2b0cbf[_0x4c85f5(0x2bb)]()===_0x3ff5c1[_0x4c85f5(0x2bb)]())return _0x15cf68;const _0x1b565e=new Date();_0x1b565e[_0x4c85f5(0x1129)](_0x2b0cbf[_0x4c85f5(0xfae)]()-0x1);if(_0x1b565e[_0x4c85f5(0x2bb)]()===_0x3ff5c1['toDateString']())return _0x4c85f5(0xd16)+_0x15cf68;const _0xb3ad6b=_0x3ff5c1[_0x4c85f5(0xf14)](),_0x4c581c=String(_0x3ff5c1[_0x4c85f5(0x255)]()+0x1)[_0x4c85f5(0x117e)](0x2,'0'),_0x226f59=String(_0x3ff5c1[_0x4c85f5(0xfae)]())['padStart'](0x2,'0');return _0x2b0cbf[_0x4c85f5(0xf14)]()===_0xb3ad6b?_0x4c581c+'月'+_0x226f59+'日\x20'+_0x15cf68:_0xb3ad6b+'年'+_0x4c581c+'月'+_0x226f59+'日\x20'+_0x15cf68;}function _0x162b3f(_0xc765eb){const _0x66a6a2=_0x13d875,_0x204643=document[_0x66a6a2(0xd67)](_0x66a6a2(0x1425));_0x204643[_0x66a6a2(0x6de)]=_0x66a6a2(0xa87);const _0x4cbe85=document[_0x66a6a2(0xd67)](_0x66a6a2(0x1425));return _0x4cbe85[_0x66a6a2(0x6de)]=_0x66a6a2(0xfe9),_0x4cbe85[_0x66a6a2(0x34a)]=_0x190172(_0xc765eb),_0x204643[_0x66a6a2(0x133d)](_0x4cbe85),_0x204643;}async function _0x40e7bf(){const _0x40a80b=_0x13d875,_0x2da74c=_0x53d851[_0x40a80b(0xaa3)][_0x53d851['activeChatId']];if(!_0x2da74c||!lastResponseTimestamps||lastResponseTimestamps['length']===0x0){alert(_0x40a80b(0xa90));return;}_0x2da74c[_0x40a80b(0xe83)]=_0x2da74c[_0x40a80b(0xe83)][_0x40a80b(0x2dd)](_0x370ec7=>!lastResponseTimestamps['includes'](_0x370ec7['timestamp'])),await _0xa62efb['chats'][_0x40a80b(0x546)](_0x2da74c),await _0x60f53f(_0x53d851[_0x40a80b(0x13be)]),_0x2ef220();}async function _0x511546(){const _0x511701=_0x13d875,_0x4443b7=_0x53d851[_0x511701(0xaa3)][_0x53d851[_0x511701(0x13be)]];if(!_0x4443b7)return;const _0x46c5ca=_0x4443b7['history']['findLastIndex'](_0x30b9b4=>_0x30b9b4['role']===_0x511701(0x10ae)&&!_0x30b9b4[_0x511701(0x1032)]);if(_0x46c5ca===-0x1){alert(_0x511701(0x50f));return;}const _0x4fcbf4=_0x4443b7[_0x511701(0xe83)][_0x511701(0xe26)](_0x16d515=>_0x16d515[_0x511701(0xb4d)]===_0x511701(0xac5));if(_0x4fcbf4<_0x46c5ca){alert(_0x511701(0x499));return;}_0x4443b7['history'][_0x511701(0x1331)](_0x46c5ca+0x1),await _0xa62efb[_0x511701(0xaa3)]['put'](_0x4443b7),await _0x60f53f(_0x53d851['activeChatId']),await _0x5403b5();}async function _0x30decf(){const _0x1dc539=_0x13d875;if(!_0x58a059[_0x1dc539(0x975)])return;const _0x73f5e3=_0x58a059['callHistory'][_0x1dc539(0xe26)](_0x65c2a3=>_0x65c2a3[_0x1dc539(0xb4d)]===_0x1dc539(0x10ae));if(_0x73f5e3===-0x1){alert(_0x1dc539(0x4cd));return;}_0x58a059[_0x1dc539(0x506)][_0x1dc539(0x1331)](_0x73f5e3+0x1);const _0x523b5d=document[_0x1dc539(0x53a)](_0x1dc539(0xee2));_0x523b5d[_0x1dc539(0xaac)]='',_0x58a059[_0x1dc539(0x506)][_0x1dc539(0xeaf)](_0x50b9ca=>{const _0x44336b=_0x1dc539,_0x2e798c=document['createElement'](_0x44336b(0x1425));_0x2e798c[_0x44336b(0x6de)]=_0x44336b(0xd08)+_0x50b9ca[_0x44336b(0xb4d)]+_0x44336b(0x13ae),_0x2e798c[_0x44336b(0x999)][_0x44336b(0x827)]=_0x50b9ca['timestamp'],_0x50b9ca[_0x44336b(0xb4d)]==='user'?_0x2e798c[_0x44336b(0x34a)]=_0x50b9ca[_0x44336b(0x73e)]:_0x2e798c[_0x44336b(0xaac)]=_0x50b9ca[_0x44336b(0x73e)],_0x3146aa(_0x2e798c,()=>_0x3ae13d(_0x50b9ca['timestamp'])),_0x523b5d[_0x44336b(0x133d)](_0x2e798c);}),_0x523b5d[_0x1dc539(0xf68)]=_0x523b5d[_0x1dc539(0xaae)],_0x2b8205(null);}async function _0x1bef42(){const _0x49053d=_0x13d875,_0x368f29=_0x53d851[_0x49053d(0xaa3)][_0x53d851['activeChatId']];if(!_0x368f29)return;_0x415ffa(_0x368f29['id'],!![]);const _0x98fca2=document['getElementById'](_0x49053d(0xba3));!_0x368f29[_0x49053d(0x86e)]&&(_0x98fca2[_0x49053d(0x1284)][_0x49053d(0x751)]=0x0,setTimeout(()=>{const _0x48d104=_0x49053d;_0x98fca2[_0x48d104(0x34a)]='对方正在输入...',_0x98fca2[_0x48d104(0x1276)][_0x48d104(0xe13)](_0x48d104(0x67f)),_0x98fca2[_0x48d104(0x1284)][_0x48d104(0x751)]=0x1;},0xc8));try{const {proxyUrl:_0x4df545,apiKey:_0x4a0eea,model:_0x44aa73}=_0x53d851[_0x49053d(0x80d)];if(!_0x4df545||!_0x4a0eea||!_0x44aa73)throw new Error(_0x49053d(0x65f));const _0x466a39=parseInt(_0x368f29[_0x49053d(0x81e)][_0x49053d(0x489)])||0xa,_0x4a9f5=_0x368f29['history'][_0x49053d(0x1340)](-_0x466a39),_0xd8d584=new Date(),_0xf1b654=new Date(_0xd8d584['getTime']()+_0xd8d584['getTimezoneOffset']()*0xea60+0x36ee80*0x8),_0x390eca=_0xf1b654[_0x49053d(0x5ee)](_0x49053d(0x42f),{'timeZone':_0x49053d(0x7c3),'dateStyle':_0x49053d(0xbcc),'timeStyle':_0x49053d(0xa18)}),_0x4c854=_0x49fe75(_0xf1b654),_0x1f0b7d=_0x368f29[_0x49053d(0x81e)][_0x49053d(0x1303)]||'我';let _0x5dee61='';if(_0x368f29[_0x49053d(0x81e)][_0x49053d(0x4ab)]&&_0x368f29[_0x49053d(0x81e)][_0x49053d(0x4ab)]['length']>0x0){const _0x187c88=_0x368f29[_0x49053d(0x81e)][_0x49053d(0x4ab)]['map'](_0x31e8da=>{const _0x54b75b=_0x49053d,_0x56943b=_0x53d851[_0x54b75b(0x10f2)][_0x54b75b(0x397)](_0x47344d=>_0x47344d['id']===_0x31e8da);if(!_0x56943b||!Array[_0x54b75b(0xb31)](_0x56943b['content']))return'';const _0x57da30=_0x56943b[_0x54b75b(0x73e)][_0x54b75b(0x2dd)](_0x224a45=>_0x224a45[_0x54b75b(0xb3d)]!==![])['map'](_0x45a3e1=>{const _0x2ab85d=_0x54b75b;let _0x461a48=_0x2ab85d(0xbc5)+(_0x45a3e1[_0x2ab85d(0x1445)]||_0x2ab85d(0x4a4))+'\x0a';if(_0x45a3e1['keys'][_0x2ab85d(0x29d)]>0x0)_0x461a48+=_0x2ab85d(0x123d)+_0x45a3e1[_0x2ab85d(0x1350)][_0x2ab85d(0x2c8)](',\x20')+'\x0a';return _0x461a48+='**内容:**\x0a'+_0x45a3e1[_0x2ab85d(0x73e)],_0x461a48;})['join']('');return _0x57da30?'\x0a\x0a##\x20世界书:\x20'+_0x56943b[_0x54b75b(0x234)]+'\x0a'+_0x57da30:'';})[_0x49053d(0x2dd)](Boolean)[_0x49053d(0x2c8)]('');_0x187c88&&(_0x5dee61=_0x49053d(0x11e4)+_0x187c88+_0x49053d(0xcc2));}let _0x5f3c95='';if(_0x2eebda['isActive']&&_0x2eebda['activeChatId']===_0x368f29['id']){const _0xde8a15=_0x2eebda[_0x49053d(0xe7d)]>-0x1?_0x2eebda[_0x49053d(0xc9a)][_0x2eebda[_0x49053d(0xe7d)]]:null;_0x5f3c95=_0x49053d(0xa96);}const _0x3abb8e=_0x18d781(_0x4b8524[_0x368f29['id']]);let _0x2a1504='';_0x368f29[_0x49053d(0x12ed)]&&_0x368f29[_0x49053d(0x12ed)][_0x49053d(0x29d)]>0x0&&(_0x2a1504=_0x49053d(0x671)+_0x368f29[_0x49053d(0x12ed)][_0x49053d(0x2c8)](',\x20')+_0x49053d(0x11a1));let _0x1312bf='';const _0x448004=_0x53d851['qzoneSettings'][_0x49053d(0x1005)]||'用户';_0x1312bf+=_0x49053d(0xd30)+_0x448004+_0x49053d(0x7e7);const _0x254a13=Object[_0x49053d(0x244)](_0x53d851[_0x49053d(0xaa3)])['filter'](_0x2cbf7c=>_0x2cbf7c[_0x49053d(0x86e)]&&_0x2cbf7c[_0x49053d(0x3de)][_0x49053d(0xe0f)](_0x263cb4=>_0x263cb4['id']===_0x368f29['id']));_0x254a13[_0x49053d(0x29d)]>0x0&&(_0x1312bf+=_0x49053d(0x1357),_0x254a13[_0x49053d(0xeaf)](_0x3fecf4=>{const _0x35eac3=_0x49053d,_0x133132=_0x3fecf4[_0x35eac3(0x81e)][_0x35eac3(0x1303)]||_0x448004;_0x1312bf+=_0x35eac3(0x86d)+_0x3fecf4[_0x35eac3(0x234)]+'”中，用户的昵称是“'+_0x133132+'”。\x0a';}));_0x1312bf+='当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。';const _0x249303=_0x25c7bd(_0x368f29),_0x5a555b='\x0a#\x20身份与核心任务\x0a你正在扮演角色“'+_0x368f29[_0x49053d(0x543)]+_0x49053d(0x12e1)+_0x390eca+'\x20('+_0x4c854+_0x49053d(0xc24)+(_0x5f3c95?'你们正在一起听歌，'+_0x5f3c95:_0x49053d(0xb4b))+_0x49053d(0x734)+(_0x368f29[_0x49053d(0x1016)]&&_0x368f29[_0x49053d(0x1016)][_0x49053d(0x29d)]>0x0?_0x368f29[_0x49053d(0x1016)][_0x49053d(0xcb4)](_0x29d6a9=>'-\x20'+_0x29d6a9[_0x49053d(0x73e)])[_0x49053d(0x2c8)]('\x0a'):_0x49053d(0xddc))+_0x49053d(0x5e2)+_0x368f29[_0x49053d(0x81e)][_0x49053d(0x1216)]+_0x49053d(0x369)+_0x368f29[_0x49053d(0x543)]+'\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22'+_0x368f29[_0x49053d(0x234)]+_0x49053d(0xc6e)+_0x1f0b7d+'”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20'+_0x1312bf+_0x49053d(0x4cc)+_0x2a1504+'\x0a\x20\x20\x20\x20'+_0x5dee61+_0x49053d(0x260)+_0x249303+_0x49053d(0x1076)+(_0x368f29['settings'][_0x49053d(0x78e)]&&_0x368f29[_0x49053d(0x81e)]['aiAvatarLibrary'][_0x49053d(0x29d)]>0x0?_0x368f29['settings'][_0x49053d(0x78e)][_0x49053d(0xcb4)](_0x195f96=>'-\x20'+_0x195f96['name'])[_0x49053d(0x2c8)]('\x0a'):_0x49053d(0x944))+_0x49053d(0x3b7)+(_0x368f29[_0x49053d(0x81e)][_0x49053d(0xd0e)]&&_0x368f29[_0x49053d(0x81e)][_0x49053d(0xd0e)][_0x49053d(0x29d)]>0x0?_0x368f29[_0x49053d(0x81e)][_0x49053d(0xd0e)]['map'](_0x31722b=>'-\x20'+_0x31722b[_0x49053d(0x234)])[_0x49053d(0x2c8)]('\x0a'):_0x49053d(0x944))+_0x49053d(0x780)+_0x368f29[_0x49053d(0x81e)][_0x49053d(0xab1)]+_0x49053d(0x4a3),_0x59e405=_0x4a9f5['map'](_0x25dab6=>({'role':_0x25dab6[_0x49053d(0xb4d)],'content':String(_0x25dab6[_0x49053d(0x73e)])}));_0x59e405[_0x49053d(0x7dd)]({'role':_0x49053d(0x10ae),'content':_0x49053d(0x1f0)});let _0x104f03=_0x4df545===GEMINI_API_URL,_0x2e4989=_0x1697e7(_0x44aa73,_0x4a0eea,_0x5a555b,_0x59e405);const _0x170f86=_0x104f03?await fetch(_0x2e4989[_0x49053d(0xb36)],_0x2e4989[_0x49053d(0xd7c)]):await fetch(_0x4df545+_0x49053d(0x434),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x49053d(0x841)+_0x4a0eea},'body':JSON[_0x49053d(0xe1e)]({'model':_0x44aa73,'messages':[{'role':_0x49053d(0xab3),'content':_0x5a555b},..._0x59e405],'temperature':_0x53d851[_0x49053d(0x906)][_0x49053d(0xaf8)]||0.8})});if(!_0x170f86['ok']){const _0x2d957e=await _0x170f86[_0x49053d(0xdc2)]();throw new Error('API\x20请求失败:\x20'+_0x2d957e[_0x49053d(0x617)][_0x49053d(0x875)]);}const _0x56beed=await _0x170f86[_0x49053d(0xdc2)](),_0x4f0adf=getGeminiResponseText(_0x56beed),_0x495906=_0x3e5855(_0x4f0adf),_0x5ba47c=[];for(const _0x3622df of _0x495906){if(_0x3622df[_0x49053d(0x919)]==='text'&&typeof _0x3622df[_0x49053d(0x73e)]===_0x49053d(0xfc5)&&_0x3622df[_0x49053d(0x73e)]['includes']('\x0a')){const _0x209d61=_0x3622df[_0x49053d(0x73e)][_0x49053d(0x13e8)](/\n+/)['filter'](_0x100e9d=>_0x100e9d[_0x49053d(0x13bc)]());_0x209d61['forEach'](_0x33f9c7=>{_0x5ba47c['push']({..._0x3622df,'content':_0x33f9c7});});}else _0x5ba47c['push'](_0x3622df);}let _0x382a7b=Date[_0x49053d(0x9c1)]();for(const _0x2bb82c of _0x5ba47c){const _0x3fe7bc={'role':_0x49053d(0xac5),'senderName':_0x368f29[_0x49053d(0x543)],'timestamp':_0x382a7b++,'content':_0x2bb82c['content']||_0x2bb82c['message'],'type':_0x2bb82c[_0x49053d(0x919)]||_0x49053d(0x2e6)};if(_0x2bb82c[_0x49053d(0x919)]===_0x49053d(0x7ed)){if(!_0x368f29['isGroup']){if(_0x2bb82c[_0x49053d(0x961)])_0x368f29[_0x49053d(0x13cb)]=String(_0x2bb82c[_0x49053d(0x961)]);if(_0x2bb82c[_0x49053d(0x82f)])_0x368f29[_0x49053d(0xc35)]=String(_0x2bb82c[_0x49053d(0x82f)]);}continue;}_0x368f29[_0x49053d(0xe83)][_0x49053d(0x7dd)](_0x3fe7bc),_0xa4d65(_0x3fe7bc,_0x368f29),await new Promise(_0x115b3a=>setTimeout(_0x115b3a,Math[_0x49053d(0xac4)]()*0x3e8+0x320));}await _0xa62efb[_0x49053d(0xaa3)][_0x49053d(0x546)](_0x368f29),_0x5001a4();}catch(_0x2b90c5){console['error'](_0x49053d(0x1092),_0x2b90c5),await _0x184397(_0x49053d(0xeac),_0x49053d(0xe75)+_0x2b90c5[_0x49053d(0x875)]);}finally{_0x415ffa(_0x368f29['id'],![]);if(!_0x368f29[_0x49053d(0x86e)]&&document[_0x49053d(0x53a)](_0x49053d(0xba3))){const _0x19ebad=document[_0x49053d(0x53a)](_0x49053d(0xba3));_0x19ebad['style'][_0x49053d(0x751)]=0x0,setTimeout(()=>{const _0x150366=_0x49053d;_0x19ebad['textContent']=_0x368f29['name'],_0x19ebad[_0x150366(0x1276)][_0x150366(0x2d4)](_0x150366(0x67f)),_0x19ebad[_0x150366(0x1284)][_0x150366(0x751)]=0x1;},0xc8);}}}function _0x1ac891(){const _0x34d373=_0x13d875,_0x3c7fd8=document['getElementById'](_0x34d373(0x925)),_0x132a31=_0x53d851[_0x34d373(0x906)][_0x34d373(0x1159)]||_0x480f21;_0x132a31&&_0x132a31['trim']()&&(_0x3c7fd8['src']=_0x132a31,_0x3c7fd8[_0x34d373(0x116c)]()[_0x34d373(0x9cb)](_0x49ad73=>console[_0x34d373(0x1081)](_0x34d373(0x1e3),_0x49ad73)));}function _0x3ec9da(){const _0x16e154=_0x13d875;if(!_0x53d851[_0x16e154(0x906)][_0x16e154(0x585)])return;for(const _0x2a2a3f in _0x53d851[_0x16e154(0x906)][_0x16e154(0x585)]){const _0xc284ce=document[_0x16e154(0x53a)](_0x2a2a3f),_0xaf1d55=_0x53d851[_0x16e154(0x906)][_0x16e154(0x585)][_0x2a2a3f];_0xc284ce&&(_0xc284ce[_0x16e154(0xfcc)]==='IMG'?_0xc284ce[_0x16e154(0x7ff)]=_0xaf1d55:_0xc284ce['textContent']=_0xaf1d55);}}function _0x15351c(){return new Promise(_0x496e4b=>{const _0x3abe4d=_0x55b8,_0x22c2a4=document[_0x3abe4d(0xd67)](_0x3abe4d(0x1174));_0x22c2a4[_0x3abe4d(0x919)]=_0x3abe4d(0xa45),_0x22c2a4[_0x3abe4d(0xe7a)]=_0x3abe4d(0x1036),_0x22c2a4['onchange']=_0x12d1ed=>{const _0x59e7d9=_0x3abe4d,_0x1e6743=_0x12d1ed['target']['files'][0x0];if(_0x1e6743){const _0x87fe35=new FileReader();_0x87fe35['onload']=_0x4ace9d=>{const _0x3479d8=_0x55b8;_0x496e4b(_0x4ace9d[_0x3479d8(0x9c2)][_0x3479d8(0xa2a)]);},_0x87fe35[_0x59e7d9(0x13b6)](_0x1e6743);}else _0x496e4b(null);},_0x22c2a4[_0x3abe4d(0xb2b)]();});}async function _0x2fa338(_0x1f27af){const _0x24d2b3=_0x13d875,_0x19fb0c=_0x1f27af['id'],_0xff3e00=_0x1f27af['textContent'],_0x5617df=await _0x4f6537(_0x24d2b3(0xd79),_0x24d2b3(0xb40),_0xff3e00);if(_0x5617df!==null&&_0x5617df[_0x24d2b3(0x13bc)]()!==''){const _0x2371d9=_0x5617df[_0x24d2b3(0x13bc)]();_0x1f27af[_0x24d2b3(0x34a)]=_0x2371d9,_0x53d851[_0x24d2b3(0x906)][_0x24d2b3(0x585)][_0x19fb0c]=_0x2371d9,await _0xa62efb[_0x24d2b3(0x906)]['put'](_0x53d851['globalSettings']),alert('文字已更新！');}}async function _0x27fa51(_0x2912a0){const _0x1b06fc=_0x13d875,_0x19900a=_0x2912a0['id'],_0x3f0357=await _0x34ea2c(_0x1b06fc(0xc0d),[{'text':_0x1b06fc(0x1352),'value':_0x1b06fc(0x3f3)},{'text':_0x1b06fc(0x476),'value':_0x1b06fc(0xb36)}]);let _0x2a695b=null;if(_0x3f0357==='local')_0x2a695b=await _0x15351c();else _0x3f0357==='url'&&(_0x2a695b=await _0x4f6537(_0x1b06fc(0xc0d),_0x1b06fc(0x10a5),_0x2912a0[_0x1b06fc(0x7ff)],_0x1b06fc(0xb36)));if(_0x2a695b&&_0x2a695b[_0x1b06fc(0x13bc)]()){const _0x55e58d=_0x2a695b[_0x1b06fc(0x13bc)]();_0x2912a0[_0x1b06fc(0x7ff)]=_0x55e58d,_0x53d851['globalSettings'][_0x1b06fc(0x585)][_0x19900a]=_0x55e58d,await _0xa62efb[_0x1b06fc(0x906)]['put'](_0x53d851[_0x1b06fc(0x906)]),alert(_0x1b06fc(0x10a1));}else _0x3f0357===_0x1b06fc(0xb36)&&_0x2a695b!==null&&alert(_0x1b06fc(0xa0c));}const _0xd5d6b0={'getSongCache'(_0x1df379,_0x2974e5){const _0x4d7c5d=_0x13d875,_0x2f89aa=(_0x2974e5||'all')+':'+_0x1df379;if(_0x53d851[_0x4d7c5d(0x10bc)]&&_0x53d851['cache'][_0x4d7c5d(0x300)]){const _0x197f92=_0x53d851[_0x4d7c5d(0x10bc)][_0x4d7c5d(0x300)][_0x4d7c5d(0x883)](_0x2f89aa);if(_0x197f92&&Date[_0x4d7c5d(0x9c1)]()-_0x197f92[_0x4d7c5d(0x827)]<0x36ee80)return _0x197f92[_0x4d7c5d(0xd7c)];}return null;},'setSongCache'(_0x46e535,_0x1244b4,_0x5db7aa){const _0x221108=_0x13d875,_0x5712d1=(_0x5db7aa||_0x221108(0x63d))+':'+_0x46e535;if(!_0x53d851[_0x221108(0x10bc)])_0x53d851[_0x221108(0x10bc)]={};if(!_0x53d851[_0x221108(0x10bc)][_0x221108(0x300)])_0x53d851[_0x221108(0x10bc)][_0x221108(0x300)]=new Map();_0x53d851[_0x221108(0x10bc)][_0x221108(0x300)][_0x221108(0xf2b)](_0x5712d1,{'data':_0x1244b4,'timestamp':Date[_0x221108(0x9c1)]()});}};typeof Http_Get_External==='undefined'&&(window[_0x13d875(0x138e)]=function(_0x1782ce){return new Promise(_0x1ff536=>{const _0x4d986f=_0x55b8;fetch(_0x1782ce)[_0x4d986f(0x299)](_0x433862=>_0x433862['json']()[_0x4d986f(0x9cb)](()=>_0x433862['text']()))['then'](_0x1ff536)['catch'](()=>_0x1ff536(null));});});async function _0x1698ad(_0x1fc3e1){return await Http_Get_External(_0x1fc3e1);}function _0xa84f88(_0x217bc9){return new Promise(_0xa95b1b=>{const _0x30134f=_0x55b8,_0x4899f7=new Audio();_0x4899f7[_0x30134f(0x1086)]('loadedmetadata',()=>_0xa95b1b(!![]),{'once':!![]}),_0x4899f7[_0x30134f(0x1086)](_0x30134f(0x617),()=>_0xa95b1b(![]),{'once':!![]}),_0x4899f7['src']=_0x217bc9;});}async function _0x56468e(_0x3a0338,_0x49de6a){const _0x5c5307=_0x13d875;try{let _0x4eedab=_0x3a0338[_0x5c5307(0x795)](/\s/g,'');_0x49de6a&&(_0x4eedab+='\x20'+_0x49de6a['replace'](/\s/g,''));const _0xbe1e5f='https://api.vkeys.cn/v2/music/netease?word='+encodeURIComponent(_0x4eedab);console[_0x5c5307(0x1081)](_0x5c5307(0x13e6),_0xbe1e5f);const _0x44d7b5=await fetch(_0xbe1e5f);if(!_0x44d7b5['ok'])throw new Error(_0x5c5307(0x55e)+_0x44d7b5[_0x5c5307(0x12d3)]);const _0x4303f9=await _0x44d7b5[_0x5c5307(0xdc2)]();if(_0x4303f9['code']!==0xc8||!_0x4303f9[_0x5c5307(0xd7c)]||_0x4303f9['data']['length']===0x0)return console[_0x5c5307(0x1081)](_0x5c5307(0x1040),_0x4303f9),[];return _0x4303f9[_0x5c5307(0xd7c)][_0x5c5307(0xcb4)](_0x393223=>({'name':_0x393223[_0x5c5307(0x2e8)],'artist':_0x393223[_0x5c5307(0x9b9)],'id':_0x393223['id'],'cover':_0x393223[_0x5c5307(0x100f)]||_0x5c5307(0xca7),'source':'netease'}))[_0x5c5307(0x1340)](0x0,0x1e);}catch(_0x39839a){return console['error']('网易云音乐搜索失败:',_0x39839a),[];}}async function _0x3fd404(_0x22609b){const _0x4bdbdc=_0x13d875;try{_0x22609b=_0x22609b[_0x4bdbdc(0x795)](/\s/g,'');const _0x33b2da=await _0x1698ad(_0x4bdbdc(0x10ec)+encodeURIComponent(_0x22609b));if(!_0x33b2da?.[_0x4bdbdc(0xd7c)]?.[_0x4bdbdc(0x29d)])return[];return _0x33b2da['data'][_0x4bdbdc(0xcb4)](_0x306e54=>({'name':_0x306e54[_0x4bdbdc(0x2e8)],'artist':_0x306e54[_0x4bdbdc(0x9b9)],'id':_0x306e54['id'],'cover':_0x306e54[_0x4bdbdc(0x100f)]||_0x4bdbdc(0x982),'source':_0x4bdbdc(0xbe6)}))[_0x4bdbdc(0x1340)](0x0,0x1e);}catch(_0x343b21){return console[_0x4bdbdc(0x617)](_0x4bdbdc(0x3e2),_0x343b21),[];}}async function _0x254455(){const _0x5bdce9=_0x13d875,_0x4d5c34=await _0x4f6537('搜索歌曲','请输入\x20歌名\x20或\x20歌名-歌手');if(!_0x4d5c34||!_0x4d5c34[_0x5bdce9(0x13bc)]())return;await _0x184397(_0x5bdce9(0x11d7),_0x5bdce9(0x120c));let _0x56b11d=_0x4d5c34[_0x5bdce9(0x13bc)](),_0x393b75='';if(_0x4d5c34[_0x5bdce9(0x6e9)]('-')||_0x4d5c34[_0x5bdce9(0x6e9)]('–')){const _0x207f29=_0x4d5c34[_0x5bdce9(0x13e8)](/[-–]/);_0x56b11d=_0x207f29[0x0][_0x5bdce9(0x13bc)](),_0x393b75=_0x207f29[_0x5bdce9(0x1340)](0x1)[_0x5bdce9(0x2c8)]('\x20')[_0x5bdce9(0x13bc)]();}const [_0x539f47,_0x228038]=await Promise['all']([_0x56468e(_0x56b11d,_0x393b75),_0x3fd404(_0x56b11d)]),_0x433375=[..._0x539f47,..._0x228038];if(_0x433375[_0x5bdce9(0x29d)]===0x0){await _0x184397('无结果',_0x5bdce9(0x462));return;}const _0x255692=document[_0x5bdce9(0x53a)](_0x5bdce9(0x576)),_0x33c31a=document[_0x5bdce9(0x53a)]('search-results-list');_0x33c31a[_0x5bdce9(0xaac)]='',document[_0x5bdce9(0x53a)](_0x5bdce9(0xe4b))[_0x5bdce9(0x1077)]=![],_0x433375['forEach'](_0x457dd5=>{const _0x482114=_0x5bdce9,_0x5a19fb=document[_0x482114(0xd67)](_0x482114(0x1425));_0x5a19fb[_0x482114(0x6de)]='search-result-item',_0x5a19fb[_0x482114(0x999)][_0x482114(0xef2)]=JSON[_0x482114(0xe1e)](_0x457dd5),_0x5a19fb[_0x482114(0xaac)]=_0x482114(0x105f)+_0x457dd5[_0x482114(0x234)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>'+_0x457dd5[_0x482114(0x7cc)]+'\x20<span\x20class=\x22source\x22>'+(_0x457dd5[_0x482114(0xda4)]===_0x482114(0x2b4)?_0x482114(0x623):'QQ音乐')+_0x482114(0x5d6),_0x33c31a[_0x482114(0x133d)](_0x5a19fb);}),_0x255692['classList'][_0x5bdce9(0xe13)](_0x5bdce9(0xaef));}async function _0x4f9833(_0x4071fb){const _0x574cfd=_0x13d875;let _0x381d7a=null,_0x115758=_0x4071fb['source'];const _0x2dc02a=_0x4071fb[_0x574cfd(0xda4)]==='netease'?'https://api.vkeys.cn/v2/music/netease?id='+_0x4071fb['id']:_0x574cfd(0x119c)+_0x4071fb['id'];let _0x467ab6=await _0x1698ad(_0x2dc02a);_0x467ab6?.[_0x574cfd(0xd7c)]?.[_0x574cfd(0xb36)]&&(_0x381d7a={'url':_0x467ab6['data'][_0x574cfd(0xb36)],'id':_0x4071fb['id'],'source':_0x4071fb['source']});if(!_0x381d7a){const _0x5018d8=_0x4071fb[_0x574cfd(0xda4)]===_0x574cfd(0x2b4)?'tencent':'netease',_0x142655=_0x5018d8==='tencent'?await _0x3fd404(_0x4071fb[_0x574cfd(0x234)]):await _0x56468e(_0x4071fb[_0x574cfd(0x234)],_0x4071fb[_0x574cfd(0x7cc)]);if(_0x142655['length']>0x0){const _0x23914d=_0x5018d8==='netease'?_0x574cfd(0x541)+_0x142655[0x0]['id']:_0x574cfd(0x119c)+_0x142655[0x0]['id'],_0x97da0d=await _0x1698ad(_0x23914d);_0x97da0d?.[_0x574cfd(0xd7c)]?.[_0x574cfd(0xb36)]&&(_0x381d7a={'url':_0x97da0d['data']['url'],'id':_0x142655[0x0]['id'],'source':_0x5018d8},_0x115758=_0x5018d8);}}if(_0x381d7a){_0x381d7a[_0x574cfd(0xb36)]&&typeof _0x381d7a[_0x574cfd(0xb36)]==='string'&&(_0x381d7a['url']=_0x381d7a['url'][_0x574cfd(0x795)](/^http:\/\//i,_0x574cfd(0x743)));_0x4071fb[_0x574cfd(0x100f)]&&typeof _0x4071fb[_0x574cfd(0x100f)]==='string'&&(_0x4071fb[_0x574cfd(0x100f)]=_0x4071fb[_0x574cfd(0x100f)][_0x574cfd(0x795)](/^http:\/\//i,_0x574cfd(0x743)));const _0x339a6e=await _0x4ac29d(_0x381d7a['id'],_0x115758)||'';return{'name':_0x4071fb[_0x574cfd(0x234)],'artist':_0x4071fb[_0x574cfd(0x7cc)],'src':_0x381d7a[_0x574cfd(0xb36)],'cover':_0x4071fb[_0x574cfd(0x100f)],'isLocal':![],'lrcContent':_0x339a6e};}return null;}async function _0x4ac29d(_0x2b3153,_0x557686){const _0x5ddab1=_0x13d875,_0x426254=_0x557686==='netease'?_0x5ddab1(0x1059)+_0x2b3153:_0x5ddab1(0x1436)+_0x2b3153,_0x4f30a6=await _0x1698ad(_0x426254);if(_0x4f30a6?.[_0x5ddab1(0xd7c)]){const _0x1181ce=_0x4f30a6['data'][_0x5ddab1(0x3f0)]||_0x4f30a6[_0x5ddab1(0xd7c)][_0x5ddab1(0x921)]||'',_0x155e93=_0x4f30a6[_0x5ddab1(0xd7c)][_0x5ddab1(0x502)]||_0x4f30a6[_0x5ddab1(0xd7c)]['tlyric']||'';return _0x1181ce+'\x0a'+_0x155e93;}return'';}async function _0x517cd7(_0x237d3f){const _0x935f11=_0x13d875;if(_0x237d3f<0x0||_0x237d3f>=_0x2eebda[_0x935f11(0xc9a)][_0x935f11(0x29d)])return;const _0x5d32df=await _0x34ea2c(_0x935f11(0x598),[{'text':_0x935f11(0x74d),'value':_0x935f11(0xa45)},{'text':_0x935f11(0x1406),'value':'paste'}]);let _0xd12ea2=null;if(_0x5d32df===_0x935f11(0xa45))_0xd12ea2=await new Promise(_0x55c3ba=>{const _0x5a03c6=_0x935f11,_0x595f6e=document['getElementById'](_0x5a03c6(0x1172)),_0x441c2f=_0x42c7c3=>{const _0x596545=_0x5a03c6,_0x45b5ee=_0x42c7c3[_0x596545(0x9c2)][_0x596545(0x1413)][0x0];if(_0x45b5ee){const _0x468b9d=new FileReader();_0x468b9d[_0x596545(0x110f)]=_0xe58b9c=>_0x55c3ba(_0xe58b9c[_0x596545(0x9c2)][_0x596545(0xa2a)]),_0x468b9d['onerror']=()=>_0x55c3ba(null),_0x468b9d[_0x596545(0x303)](_0x45b5ee);}else _0x55c3ba(null);_0x595f6e[_0x596545(0x5ce)](_0x596545(0x325),_0x441c2f),_0x595f6e['value']='';};_0x595f6e[_0x5a03c6(0x1086)](_0x5a03c6(0x325),_0x441c2f,{'once':!![]}),_0x595f6e[_0x5a03c6(0xb2b)]();});else{if(_0x5d32df===_0x935f11(0x143f)){const _0x2967f1=await _0x4f6537(_0x935f11(0x49c),_0x935f11(0x49e),'',_0x935f11(0x728));if(_0x2967f1)_0xd12ea2=_0x2967f1[_0x935f11(0x795)](/\[/g,'\x0a[')[_0x935f11(0x13bc)]();}}_0xd12ea2!==null&&(_0x2eebda['playlist'][_0x237d3f][_0x935f11(0x917)]=_0xd12ea2,await _0x4cf2f7(),_0x2eebda[_0x935f11(0xe7d)]===_0x237d3f&&(_0x2eebda[_0x935f11(0xd4b)]=_0x5a24fc(_0xd12ea2),_0x354707(),_0x216b10()),await _0x184397('成功','《'+_0x2eebda[_0x935f11(0xc9a)][_0x237d3f][_0x935f11(0x234)]+'》的歌词已成功保存！'));}async function _0x3cdab5(){const _0x4a47d9=_0x13d875;if(_0x2eebda[_0x4a47d9(0xe7d)]===-0x1)return;const _0x38511d=_0x2eebda['playlist'][_0x2eebda[_0x4a47d9(0xe7d)]];if(!_0x38511d)return;_0x38511d[_0x4a47d9(0xf40)]=!_0x38511d['isBgClear'],await _0x4cf2f7();const _0x293e36=document[_0x4a47d9(0x139c)]('.music-player-window'),_0x3ba5b7=document[_0x4a47d9(0x53a)](_0x4a47d9(0x1429));_0x293e36[_0x4a47d9(0x1276)][_0x4a47d9(0x4d7)](_0x4a47d9(0x1416),_0x38511d['isBgClear']),_0x3ba5b7[_0x4a47d9(0x1276)]['toggle'](_0x4a47d9(0xdf6),_0x38511d[_0x4a47d9(0xf40)]);}function _0x40bf4d(){const _0x1d016c=_0x13d875,_0x20a6bd=document[_0x1d016c(0x53a)]('music-player-avatar-display'),_0xfb88c0=document[_0x1d016c(0x53a)](_0x1d016c(0xc1d));_0x20a6bd&&_0xfb88c0&&(_0x20a6bd['classList']['toggle'](_0x1d016c(0xaef)),_0xfb88c0[_0x1d016c(0x1276)]['toggle'](_0x1d016c(0xdf6)));}function _0x23f578(){const _0x264ce1=_0x13d875,_0x554983=document[_0x264ce1(0x139c)](_0x264ce1(0xb3c)),_0x488d64=document[_0x264ce1(0x53a)]('music-player-overlay');_0x554983&&_0x488d64&&(_0x554983['classList'][_0x264ce1(0x4d7)](_0x264ce1(0x1241)),_0x488d64[_0x264ce1(0x1276)][_0x264ce1(0x4d7)](_0x264ce1(0x58d)));}window[_0x13d875(0xfda)]=_0x23f578;async function _0xde2393(){const _0x4fe352=_0x13d875;if(_0x2eebda['playlist'][_0x4fe352(0x29d)]===0x0){alert(_0x4fe352(0x871));return;}const _0x4fce01=await _0x355fc0(_0x4fe352(0x143c),_0x4fe352(0xa9d),{'confirmText':_0x4fe352(0xfd1)});if(!_0x4fce01)return;await _0x184397('请稍候...',_0x4fe352(0x1184)+_0x2eebda[_0x4fe352(0xc9a)][_0x4fe352(0x29d)]+_0x4fe352(0xaa1));const _0x4c3afa=_0x2eebda[_0x4fe352(0xc9a)][_0x4fe352(0x29d)],_0x44f6ca=[],_0xadea67=[],_0x176594=_0x2eebda[_0x4fe352(0xc9a)]['map'](async _0x10a20e=>{const _0x2d267b=_0x4fe352;if(_0x10a20e[_0x2d267b(0xfe6)]){_0x44f6ca['push'](_0x10a20e);return;}const _0xde5dc8=await _0xa84f88(_0x10a20e[_0x2d267b(0x7ff)]);_0xde5dc8?_0x44f6ca['push'](_0x10a20e):(_0xadea67[_0x2d267b(0x7dd)](_0x10a20e[_0x2d267b(0x234)]),console[_0x2d267b(0xad0)](_0x2d267b(0xc70)+_0x10a20e[_0x2d267b(0x234)]+_0x2d267b(0x122c)+_0x10a20e[_0x2d267b(0x7ff)]));});await Promise[_0x4fe352(0x63d)](_0x176594);const _0x279e19=_0x4c3afa-_0x44f6ca['length'];if(_0x279e19>0x0){const _0x827e16=_0x2eebda[_0x4fe352(0xc9a)][_0x2eebda[_0x4fe352(0xe7d)]],_0x316457=_0xadea67[_0x4fe352(0x6e9)](_0x827e16?.['name']);_0x2eebda[_0x4fe352(0xc9a)]=_0x44f6ca,await _0x4cf2f7();if(_0x316457)_0x2a3e73[_0x4fe352(0xd54)](),_0x2a3e73[_0x4fe352(0x7ff)]='',_0x2eebda[_0x4fe352(0xe7d)]=_0x2eebda[_0x4fe352(0xc9a)]['length']>0x0?0x0:-0x1,_0x2eebda[_0x4fe352(0x5a4)]=![];else _0x827e16&&(_0x2eebda[_0x4fe352(0xe7d)]=_0x2eebda[_0x4fe352(0xc9a)][_0x4fe352(0x298)](_0x11234b=>_0x11234b['src']===_0x827e16[_0x4fe352(0x7ff)]));_0x3c76c6(),_0x1dfd4f(),await _0x184397(_0x4fe352(0xd2a),_0x4fe352(0x1027)+_0x279e19+'\x20首无效歌曲:\x0a\x0a-\x20'+_0xadea67[_0x4fe352(0x2c8)](_0x4fe352(0xf07)));}else await _0x184397('检查完成',_0x4fe352(0x12ce));}function _0x39c21c(){const _0x25281d=_0x13d875,_0x1e2817=document[_0x25281d(0x53a)](_0x25281d(0xf87));_0x1e2817[_0x25281d(0x1276)]['toggle'](_0x25281d(0xa6d),!!_0x53d851['globalSettings'][_0x25281d(0xab5)]);}async function _0x447d81(){const _0x5d4fd4=_0x13d875,_0x23d87f=document[_0x5d4fd4(0x53a)]('clear-posts-modal'),_0x2a0107=document[_0x5d4fd4(0x53a)](_0x5d4fd4(0x720));_0x2a0107[_0x5d4fd4(0xaac)]='';const _0x1af7e6=[];_0x1af7e6[_0x5d4fd4(0x7dd)]({'text':'清空所有动态\x20(危险)','value':_0x5d4fd4(0x63d),'isDanger':!![]});const _0x5ef7b4=_0x53d851[_0x5d4fd4(0xa74)][_0x5d4fd4(0x1005)]||'我';_0x1af7e6[_0x5d4fd4(0x7dd)]({'text':_0x5d4fd4(0x111b)+_0x5ef7b4+_0x5d4fd4(0x144e),'value':'user'}),Object[_0x5d4fd4(0x244)](_0x53d851[_0x5d4fd4(0xaa3)])[_0x5d4fd4(0xeaf)](_0x5b29d9=>{const _0x5d5066=_0x5d4fd4;!_0x5b29d9[_0x5d5066(0x86e)]&&_0x1af7e6[_0x5d5066(0x7dd)]({'text':'仅清空\x20'+_0x5b29d9[_0x5d5066(0x234)]+_0x5d5066(0xdfd),'value':_0x5b29d9['id']});});try{const _0x2b562a=await _0xa62efb[_0x5d4fd4(0x5b7)]['toArray']();_0x2b562a[_0x5d4fd4(0x29d)]>0x0&&(_0x1af7e6['push']({'isSeparator':!![],'text':_0x5d4fd4(0xd0c)}),_0x2b562a[_0x5d4fd4(0xeaf)](_0x54e53c=>{const _0x598147=_0x5d4fd4;_0x1af7e6[_0x598147(0x7dd)]({'text':_0x598147(0x111b)+_0x54e53c[_0x598147(0x234)]+'\x20的动态\x20(NPC)','value':_0x598147(0xc78)+_0x54e53c['id']});}));}catch(_0x4c204f){console[_0x5d4fd4(0x617)](_0x5d4fd4(0x4b1),_0x4c204f);}_0x1af7e6['forEach'](_0x4ebc27=>{const _0x186fa9=_0x5d4fd4;if(_0x4ebc27['isSeparator']){const _0x440fa9=document[_0x186fa9(0xd67)](_0x186fa9(0x1425));_0x440fa9[_0x186fa9(0x34a)]=_0x4ebc27[_0x186fa9(0x2e6)],_0x440fa9['style']['cssText']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2018px\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#f0f2f5;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-top:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x2a0107[_0x186fa9(0x133d)](_0x440fa9);return;}const _0x9b93b9=document['createElement'](_0x186fa9(0x1425));_0x9b93b9[_0x186fa9(0x6de)]=_0x186fa9(0xaaf),_0x4ebc27[_0x186fa9(0x54f)]&&_0x9b93b9[_0x186fa9(0x1276)][_0x186fa9(0xe13)]('danger-option'),_0x9b93b9['dataset']['targetId']=_0x4ebc27['value'],_0x9b93b9[_0x186fa9(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x4ebc27[_0x186fa9(0x2e6)]+_0x186fa9(0x1378),_0x2a0107[_0x186fa9(0x133d)](_0x9b93b9);}),_0x23d87f['classList'][_0x5d4fd4(0xe13)]('visible');}async function _0x55211c(){const _0x4fa505=_0x13d875,_0x19bb12=document[_0x4fa505(0xc3d)](_0x4fa505(0xaa4));if(_0x19bb12[_0x4fa505(0x29d)]===0x0){alert(_0x4fa505(0x5fe));return;}const _0x119212=Array[_0x4fa505(0xd97)](_0x19bb12)['map'](_0x5e99a3=>_0x5e99a3[_0x4fa505(0x999)][_0x4fa505(0x952)]);let _0x2bce22=[];_0x119212[_0x4fa505(0x6e9)]('all')?_0x2bce22[_0x4fa505(0x7dd)]('所有动态'):(_0x119212[_0x4fa505(0x6e9)]('user')&&_0x2bce22[_0x4fa505(0x7dd)]('“'+_0x53d851[_0x4fa505(0xa74)][_0x4fa505(0x1005)]+'”'),_0x119212[_0x4fa505(0xeaf)](_0x36c312=>{const _0x12dba7=_0x4fa505,_0x529624=_0x53d851[_0x12dba7(0xaa3)][_0x36c312];_0x529624&&_0x2bce22[_0x12dba7(0x7dd)]('“'+_0x529624[_0x12dba7(0x234)]+'”');}));const _0x58219f=_0x4fa505(0x114e)+_0x2bce22[_0x4fa505(0x2c8)]('、\x20')+_0x4fa505(0x7fd),_0x248199=await _0x355fc0(_0x4fa505(0x13a7),_0x58219f,{'confirmButtonClass':'btn-danger','confirmText':_0x4fa505(0xc43)});if(!_0x248199)return;try{_0x119212[_0x4fa505(0x6e9)](_0x4fa505(0x63d))?await _0xa62efb[_0x4fa505(0xfc2)][_0x4fa505(0xfcf)]():await _0xa62efb[_0x4fa505(0xfc2)][_0x4fa505(0x57e)](_0x4fa505(0xa59))['anyOf'](_0x119212)[_0x4fa505(0x121e)](),_0x2ec44e=await _0xa62efb['qzonePosts']['orderBy']('timestamp')[_0x4fa505(0x843)]()[_0x4fa505(0xa73)](),_0x379b3d=0x0,await _0x3679f3(),document[_0x4fa505(0x53a)](_0x4fa505(0x572))[_0x4fa505(0x1276)][_0x4fa505(0x2d4)]('visible'),await _0x184397('操作成功',_0x4fa505(0x949));}catch(_0x24bd1d){console[_0x4fa505(0x617)](_0x4fa505(0x1072),_0x24bd1d),await _0x184397(_0x4fa505(0xeac),_0x4fa505(0xa34)+_0x24bd1d[_0x4fa505(0x875)]);}}async function _0x50646c(_0x2c2956){const _0x561127=_0x13d875,_0x240c8e=await _0x355fc0(_0x561127(0x69a),'确定要永久删除这条心声记录吗？此操作不可恢复。',{'confirmButtonClass':_0x561127(0x264),'confirmText':_0x561127(0x69a)});if(_0x240c8e){const _0xbd4557=_0x53d851['chats'][_0x53d851[_0x561127(0x13be)]];if(!_0xbd4557||!_0xbd4557[_0x561127(0xf2c)])return;const _0x537580=_0xbd4557['thoughtsHistory'][_0x561127(0x298)](_0x38727b=>_0x38727b[_0x561127(0x827)]===_0x2c2956);if(_0x537580===-0x1)return;const _0x1c7cce=_0x537580===_0xbd4557[_0x561127(0xf2c)][_0x561127(0x29d)]-0x1;_0xbd4557[_0x561127(0xf2c)]=_0xbd4557[_0x561127(0xf2c)][_0x561127(0x2dd)](_0x4d0e98=>_0x4d0e98[_0x561127(0x827)]!==_0x2c2956);if(_0x1c7cce){if(_0xbd4557[_0x561127(0xf2c)][_0x561127(0x29d)]>0x0){const _0x5d41ce=_0xbd4557['thoughtsHistory'][_0xbd4557['thoughtsHistory']['length']-0x1];_0xbd4557[_0x561127(0x13cb)]=_0x5d41ce[_0x561127(0x13cb)],_0xbd4557[_0x561127(0xc35)]=_0x5d41ce[_0x561127(0xc35)];const _0x12dd9e=document[_0x561127(0x53a)](_0x561127(0x1055)),_0x5424aa=document[_0x561127(0x53a)](_0x561127(0x1173));if(_0x12dd9e)_0x12dd9e['textContent']=_0xbd4557['heartfeltVoice'];if(_0x5424aa)_0x5424aa[_0x561127(0x34a)]=_0xbd4557[_0x561127(0xc35)];console[_0x561127(0x1081)](_0x561127(0x1ff));}else{_0xbd4557[_0x561127(0x13cb)]=_0x561127(0x95d),_0xbd4557[_0x561127(0xc35)]=_0x561127(0x95d);const _0x1a3129=document['getElementById']('profile-heartfelt-voice'),_0x391727=document['getElementById'](_0x561127(0x1173));if(_0x1a3129)_0x1a3129[_0x561127(0x34a)]=_0xbd4557[_0x561127(0x13cb)];if(_0x391727)_0x391727['textContent']=_0xbd4557['randomJottings'];console[_0x561127(0x1081)](_0x561127(0x6b6));}}await _0xa62efb['chats'][_0x561127(0x546)](_0xbd4557),_0x3f70aa(),await _0x184397('成功','该条记录已成功删除。');}}document[_0x13d875(0x53a)](_0x13d875(0x92f))[_0x13d875(0x1086)](_0x13d875(0xb2b),_0x466fd4=>{const _0x42803f=_0x13d875,_0x2f39f2=_0x466fd4[_0x42803f(0x9c2)][_0x42803f(0x106f)](_0x42803f(0x29e));if(_0x2f39f2){const _0x190702=parseInt(_0x2f39f2[_0x42803f(0x999)][_0x42803f(0x827)]);!isNaN(_0x190702)&&_0x50646c(_0x190702);}});async function _0x2e2a39(){const _0xf08689=_0x13d875,_0x389da0=document['getElementById'](_0xf08689(0xbcb));_0x389da0[_0xf08689(0xaac)]=_0xf08689(0x8fe);const _0x4e9577=await _0xa62efb[_0xf08689(0x51d)]['where'](_0xf08689(0x919))[_0xf08689(0x12f6)]('global_css')['toArray']();_0x4e9577['forEach'](_0x5de465=>{const _0x48f388=_0xf08689,_0x28cb38=document[_0x48f388(0xd67)](_0x48f388(0xa1e));_0x28cb38[_0x48f388(0x11a2)]=_0x5de465['id'],_0x28cb38[_0x48f388(0x34a)]=_0x5de465[_0x48f388(0x234)],_0x389da0['appendChild'](_0x28cb38);});}async function _0x3928a1(){const _0x72e97=_0x13d875,_0x310c06=document[_0x72e97(0x53a)](_0x72e97(0xbcb)),_0x16c746=parseInt(_0x310c06[_0x72e97(0x11a2)]);if(isNaN(_0x16c746))return;const _0x33bf43=await _0xa62efb[_0x72e97(0x51d)][_0x72e97(0x883)](_0x16c746);if(_0x33bf43){const _0xc72727=document[_0x72e97(0x53a)]('global-css-input');_0xc72727[_0x72e97(0x11a2)]=_0x33bf43[_0x72e97(0x11a2)],_0x1c3306(_0x33bf43[_0x72e97(0x11a2)]);}}async function _0x5d36a0(){const _0x36559f=_0x13d875,_0x316c31=await _0x4f6537(_0x36559f(0x105a),'请输入预设名称');if(!_0x316c31||!_0x316c31[_0x36559f(0x13bc)]())return;const _0xb22315=document['getElementById']('global-css-input')[_0x36559f(0x11a2)],_0x39e35a=await _0xa62efb[_0x36559f(0x51d)][_0x36559f(0x57e)]({'name':_0x316c31[_0x36559f(0x13bc)](),'type':_0x36559f(0x2fe)})[_0x36559f(0x7e6)]();if(_0x39e35a){const _0x4cce49=await _0x355fc0('覆盖预设',_0x36559f(0x130b)+_0x316c31[_0x36559f(0x13bc)]()+_0x36559f(0x501),{'confirmButtonClass':_0x36559f(0x264)});if(!_0x4cce49)return;await _0xa62efb[_0x36559f(0x51d)]['update'](_0x39e35a['id'],{'value':_0xb22315});}else await _0xa62efb['appearancePresets']['add']({'name':_0x316c31['trim'](),'type':_0x36559f(0x2fe),'value':_0xb22315});await _0x2e2a39(),alert(_0x36559f(0x10d6));}async function _0x2e7a4b(){const _0x1b2c1a=_0x13d875,_0x5a2055=document[_0x1b2c1a(0x53a)](_0x1b2c1a(0xbcb)),_0x15a9a6=parseInt(_0x5a2055[_0x1b2c1a(0x11a2)]);if(isNaN(_0x15a9a6)){alert(_0x1b2c1a(0x10cc));return;}const _0x1ba27b=await _0xa62efb[_0x1b2c1a(0x51d)]['get'](_0x15a9a6);if(!_0x1ba27b)return;const _0x3f1596=await _0x355fc0(_0x1b2c1a(0x1163),'确定要删除预设\x20“'+_0x1ba27b['name']+_0x1b2c1a(0x2ec),{'confirmButtonClass':'btn-danger'});_0x3f1596&&(await _0xa62efb['appearancePresets'][_0x1b2c1a(0x121e)](_0x15a9a6),await _0x2e2a39(),alert(_0x1b2c1a(0x30f)));}async function _0x104652(){const _0xdc464e=_0x13d875,_0x5364ea=document['getElementById'](_0xdc464e(0x857));_0x5364ea[_0xdc464e(0xaac)]=_0xdc464e(0x8fe);const _0x5abcc0=await _0xa62efb[_0xdc464e(0x51d)][_0xdc464e(0x57e)](_0xdc464e(0x919))[_0xdc464e(0x12f6)](_0xdc464e(0x8f3))[_0xdc464e(0xa73)]();_0x5abcc0[_0xdc464e(0xeaf)](_0x1359aa=>{const _0x36bdfd=_0xdc464e,_0x510b82=document[_0x36bdfd(0xd67)](_0x36bdfd(0xa1e));_0x510b82['value']=_0x1359aa['id'],_0x510b82[_0x36bdfd(0x34a)]=_0x1359aa[_0x36bdfd(0x234)],_0x5364ea[_0x36bdfd(0x133d)](_0x510b82);});}async function _0x202f54(){const _0x5de5a4=_0x13d875,_0x2e4148=document[_0x5de5a4(0x53a)](_0x5de5a4(0x857)),_0x10e636=parseInt(_0x2e4148['value']);if(isNaN(_0x10e636))return;const _0xa1fdf7=await _0xa62efb['appearancePresets'][_0x5de5a4(0x883)](_0x10e636);if(_0xa1fdf7){const _0x1f54c1=document['getElementById']('font-url-input');_0x1f54c1[_0x5de5a4(0x11a2)]=_0xa1fdf7[_0x5de5a4(0x11a2)],_0x281d80(_0xa1fdf7[_0x5de5a4(0x11a2)],!![]);}}async function _0x28aef0(){const _0x2b7027=_0x13d875,_0x376f31=await _0x4f6537('保存字体预设','请输入预设名称');if(!_0x376f31||!_0x376f31[_0x2b7027(0x13bc)]())return;const _0x78e55e=document[_0x2b7027(0x53a)](_0x2b7027(0x9a2))['value'][_0x2b7027(0x13bc)]();if(!_0x78e55e){alert(_0x2b7027(0x13d2));return;}const _0x3f3b19=await _0xa62efb[_0x2b7027(0x51d)]['where']({'name':_0x376f31[_0x2b7027(0x13bc)](),'type':_0x2b7027(0x8f3)})['first']();if(_0x3f3b19){const _0x5a7890=await _0x355fc0(_0x2b7027(0x811),_0x2b7027(0x130b)+_0x376f31[_0x2b7027(0x13bc)]()+_0x2b7027(0x501),{'confirmButtonClass':_0x2b7027(0x264)});if(!_0x5a7890)return;await _0xa62efb['appearancePresets'][_0x2b7027(0xc03)](_0x3f3b19['id'],{'value':_0x78e55e});}else await _0xa62efb['appearancePresets'][_0x2b7027(0xe13)]({'name':_0x376f31[_0x2b7027(0x13bc)](),'type':_0x2b7027(0x8f3),'value':_0x78e55e});await _0x104652(),alert(_0x2b7027(0x2e9));}async function _0x5f3845(){const _0xb03064=_0x13d875,_0x1178fe=document[_0xb03064(0x53a)](_0xb03064(0x857)),_0x29a926=parseInt(_0x1178fe[_0xb03064(0x11a2)]);if(isNaN(_0x29a926)){alert(_0xb03064(0x10cc));return;}const _0x16cd66=await _0xa62efb[_0xb03064(0x51d)][_0xb03064(0x883)](_0x29a926);if(!_0x16cd66)return;const _0x2ec66d=await _0x355fc0(_0xb03064(0x1163),_0xb03064(0x1267)+_0x16cd66['name']+_0xb03064(0x2ec),{'confirmButtonClass':_0xb03064(0x264)});_0x2ec66d&&(await _0xa62efb[_0xb03064(0x51d)][_0xb03064(0x121e)](_0x29a926),await _0x104652(),alert('预设已删除。'));}async function _0x5614ad(){const _0x3f7fed=_0x13d875,_0xdaa48f=document[_0x3f7fed(0x53a)]('appearance-preset-select');_0xdaa48f['innerHTML']=_0x3f7fed(0x8fe);const _0x1bdcca=await _0xa62efb[_0x3f7fed(0x51d)][_0x3f7fed(0x57e)](_0x3f7fed(0x919))[_0x3f7fed(0x12f6)](_0x3f7fed(0x11f0))['toArray']();_0x1bdcca[_0x3f7fed(0xeaf)](_0x29de55=>{const _0x5a0fa1=_0x3f7fed,_0x1570d9=document['createElement'](_0x5a0fa1(0xa1e));_0x1570d9['value']=_0x29de55['id'],_0x1570d9[_0x5a0fa1(0x34a)]=_0x29de55[_0x5a0fa1(0x234)],_0xdaa48f[_0x5a0fa1(0x133d)](_0x1570d9);});const _0x4c432d={'wallpaper':_0x53d851['globalSettings'][_0x3f7fed(0x8ee)],'cphoneWallpaper':_0x53d851[_0x3f7fed(0x906)][_0x3f7fed(0x227)],'globalChatBackground':_0x53d851[_0x3f7fed(0x906)][_0x3f7fed(0xbc0)],'appIcons':_0x53d851[_0x3f7fed(0x906)][_0x3f7fed(0xb97)],'cphoneAppIcons':_0x53d851[_0x3f7fed(0x906)]['cphoneAppIcons'],'chatActionButtonsOrder':_0x53d851[_0x3f7fed(0x906)]['chatActionButtonsOrder'],'theme':localStorage['getItem'](_0x3f7fed(0x1197))||_0x3f7fed(0x8ef),'showStatusBar':_0x53d851['globalSettings']['showStatusBar'],'notificationSoundUrl':_0x53d851[_0x3f7fed(0x906)]['notificationSoundUrl'],'widgetData':_0x53d851[_0x3f7fed(0x906)]['widgetData']};let _0x42f7a9=null;for(const _0x149d2a of _0x1bdcca){if(JSON[_0x3f7fed(0xe1e)](_0x149d2a[_0x3f7fed(0x11a2)])===JSON[_0x3f7fed(0xe1e)](_0x4c432d)){_0x42f7a9=_0x149d2a['id'];break;}}_0x42f7a9?_0xdaa48f[_0x3f7fed(0x11a2)]=_0x42f7a9:_0xdaa48f[_0x3f7fed(0x11a2)]='';}async function _0x24cd67(){const _0x5bbb8c=_0x13d875,_0x24c418=document[_0x5bbb8c(0x53a)](_0x5bbb8c(0x132a)),_0x4f06a6=parseInt(_0x24c418['value']);if(isNaN(_0x4f06a6))return;const _0x496ebd=await _0xa62efb[_0x5bbb8c(0x51d)][_0x5bbb8c(0x883)](_0x4f06a6);if(_0x496ebd&&_0x496ebd[_0x5bbb8c(0x11a2)]){const _0x278159=_0x496ebd['value'];Object['assign'](_0x53d851[_0x5bbb8c(0x906)],_0x278159),_0x3bde11(_0x278159[_0x5bbb8c(0x1297)]||_0x5bbb8c(0x8ef)),await _0xa62efb['globalSettings'][_0x5bbb8c(0x546)](_0x53d851[_0x5bbb8c(0x906)]),_0x1ce9d9(),_0x4b6d38(),_0x40e495(),_0x201b82(),_0x39c21c(),_0x3ec9da(),_0x24b0a8(),alert(_0x5bbb8c(0x80f)+_0x496ebd[_0x5bbb8c(0x234)]+'”');}}async function _0x5e2c34(){const _0x4dff6b=_0x13d875,_0x4e29a1=await _0x4f6537(_0x4dff6b(0x1199),_0x4dff6b(0xf12));if(!_0x4e29a1||!_0x4e29a1[_0x4dff6b(0x13bc)]())return;const _0xef5889={'wallpaper':_0x53d851[_0x4dff6b(0x906)][_0x4dff6b(0x8ee)],'cphoneWallpaper':_0x53d851[_0x4dff6b(0x906)]['cphoneWallpaper'],'globalChatBackground':_0x53d851[_0x4dff6b(0x906)][_0x4dff6b(0xbc0)],'appIcons':_0x53d851[_0x4dff6b(0x906)]['appIcons'],'cphoneAppIcons':_0x53d851[_0x4dff6b(0x906)][_0x4dff6b(0xaee)],'chatActionButtonsOrder':_0x53d851[_0x4dff6b(0x906)][_0x4dff6b(0x951)],'theme':localStorage[_0x4dff6b(0xa14)](_0x4dff6b(0x1197))||'light','showStatusBar':_0x53d851[_0x4dff6b(0x906)][_0x4dff6b(0xab5)],'notificationSoundUrl':_0x53d851[_0x4dff6b(0x906)][_0x4dff6b(0x1159)],'widgetData':_0x53d851[_0x4dff6b(0x906)][_0x4dff6b(0x585)]},_0x484d75=await _0xa62efb[_0x4dff6b(0x51d)][_0x4dff6b(0x57e)]({'name':_0x4e29a1[_0x4dff6b(0x13bc)](),'type':_0x4dff6b(0x11f0)})[_0x4dff6b(0x7e6)]();if(_0x484d75){const _0x268ece=await _0x355fc0(_0x4dff6b(0x811),_0x4dff6b(0x130b)+_0x4e29a1[_0x4dff6b(0x13bc)]()+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':_0x4dff6b(0x264)});if(!_0x268ece)return;await _0xa62efb['appearancePresets']['update'](_0x484d75['id'],{'value':_0xef5889});}else await _0xa62efb[_0x4dff6b(0x51d)][_0x4dff6b(0xe13)]({'name':_0x4e29a1[_0x4dff6b(0x13bc)](),'type':_0x4dff6b(0x11f0),'value':_0xef5889});await _0x5614ad(),alert(_0x4dff6b(0x4c4));}async function _0x58ac6d(){const _0x14c75d=_0x13d875,_0x524427=document[_0x14c75d(0x53a)]('appearance-preset-select'),_0x4cd286=parseInt(_0x524427[_0x14c75d(0x11a2)]);if(isNaN(_0x4cd286)){alert('请先从下拉框中选择一个要删除的预设。');return;}const _0x4e112c=await _0xa62efb[_0x14c75d(0x51d)][_0x14c75d(0x883)](_0x4cd286);if(!_0x4e112c)return;const _0x5170e4=await _0x355fc0('删除预设','确定要删除预设\x20“'+_0x4e112c[_0x14c75d(0x234)]+_0x14c75d(0x2ec),{'confirmButtonClass':_0x14c75d(0x264)});_0x5170e4&&(await _0xa62efb[_0x14c75d(0x51d)]['delete'](_0x4cd286),await _0x5614ad(),alert('预设已删除。'));}async function _0x273dd7(){const _0x14e4af=_0x13d875,_0x1cb6f8=document['getElementById'](_0x14e4af(0x11e0));_0x1cb6f8[_0x14e4af(0xaac)]=_0x14e4af(0x8fe);const _0x346bf3=await _0xa62efb['appearancePresets']['where'](_0x14e4af(0x919))['equals'](_0x14e4af(0xa8b))['toArray']();_0x346bf3[_0x14e4af(0xeaf)](_0x3960a6=>{const _0x1754a0=_0x14e4af,_0x5a08af=document[_0x1754a0(0xd67)](_0x1754a0(0xa1e));_0x5a08af[_0x1754a0(0x11a2)]=_0x3960a6['id'],_0x5a08af[_0x1754a0(0x34a)]=_0x3960a6[_0x1754a0(0x234)],_0x1cb6f8['appendChild'](_0x5a08af);});}async function _0x5973fc(){const _0x1e6057=_0x13d875,_0x320ca6=document[_0x1e6057(0x53a)](_0x1e6057(0x11e0)),_0x586d52=parseInt(_0x320ca6[_0x1e6057(0x11a2)]);if(isNaN(_0x586d52))return;const _0x2dac4b=await _0xa62efb[_0x1e6057(0x51d)][_0x1e6057(0x883)](_0x586d52);if(_0x2dac4b){const _0xa096ec=_0x2dac4b[_0x1e6057(0x11a2)][_0x1e6057(0x7b4)]||_0x1e6057(0xce2),_0x87e86c=_0x2dac4b[_0x1e6057(0x11a2)][_0x1e6057(0xa86)]||'',_0x309cde=document[_0x1e6057(0x139c)](_0x1e6057(0xa6c)+_0xa096ec+'\x22]');_0x309cde&&(_0x309cde[_0x1e6057(0x1077)]=!![]);const _0x26604c=document[_0x1e6057(0x53a)]('custom-css-input');_0x26604c[_0x1e6057(0x11a2)]=_0x87e86c,_0x574a7b();}}async function _0x568b99(){const _0x7f16c=_0x13d875,_0x550667=await _0x4f6537(_0x7f16c(0x6eb),'请输入预设名称');if(!_0x550667||!_0x550667[_0x7f16c(0x13bc)]())return;const _0x2baa00=document['querySelector'](_0x7f16c(0xe05)),_0x285150=_0x2baa00?_0x2baa00['value']:_0x7f16c(0xce2),_0x273927=document['getElementById'](_0x7f16c(0xb8b))['value'][_0x7f16c(0x13bc)](),_0x5459ea={'base':_0x285150,'custom':_0x273927},_0x5aca9a=await _0xa62efb[_0x7f16c(0x51d)]['where']({'name':_0x550667['trim'](),'type':_0x7f16c(0xa8b)})[_0x7f16c(0x7e6)]();if(_0x5aca9a){const _0x208b64=await _0x355fc0(_0x7f16c(0x811),'名为\x20“'+_0x550667[_0x7f16c(0x13bc)]()+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':_0x7f16c(0x264)});if(!_0x208b64)return;await _0xa62efb[_0x7f16c(0x51d)][_0x7f16c(0xc03)](_0x5aca9a['id'],{'value':_0x5459ea});}else await _0xa62efb['appearancePresets'][_0x7f16c(0xe13)]({'name':_0x550667['trim'](),'type':_0x7f16c(0xa8b),'value':_0x5459ea});await _0x273dd7(),alert(_0x7f16c(0x87e));}async function _0x5ca98d(){const _0x2d2023=_0x13d875,_0x1eb68c=document[_0x2d2023(0x53a)]('theme-preset-select'),_0x567279=parseInt(_0x1eb68c[_0x2d2023(0x11a2)]);if(isNaN(_0x567279)){alert(_0x2d2023(0x10cc));return;}const _0x7c12c7=await _0xa62efb[_0x2d2023(0x51d)][_0x2d2023(0x883)](_0x567279);if(!_0x7c12c7)return;const _0x5374a2=await _0x355fc0(_0x2d2023(0x1163),_0x2d2023(0x1267)+_0x7c12c7[_0x2d2023(0x234)]+_0x2d2023(0x2ec),{'confirmButtonClass':_0x2d2023(0x264)});_0x5374a2&&(await _0xa62efb[_0x2d2023(0x51d)]['delete'](_0x567279),await _0x273dd7(),alert(_0x2d2023(0x30f)));}async function _0x2d7ead(){const _0x2edd82=_0x13d875;await _0xe4a21b(),document['getElementById'](_0x2edd82(0xf6e))[_0x2edd82(0x1276)][_0x2edd82(0xe13)](_0x2edd82(0xaef));}async function _0xe4a21b(){const _0x3442a1=_0x13d875,_0x16497c=document[_0x3442a1(0x53a)](_0x3442a1(0xef6)),_0x3be99f=await _0xa62efb['stickerCategories'][_0x3442a1(0xa73)]();_0x16497c[_0x3442a1(0xaac)]='';if(_0x3be99f[_0x3442a1(0x29d)]===0x0){_0x16497c[_0x3442a1(0xaac)]=_0x3442a1(0xa16);return;}_0x3be99f[_0x3442a1(0xeaf)](_0x29ff0d=>{const _0x216af4=_0x3442a1,_0x5e642e=document[_0x216af4(0xd67)]('div');_0x5e642e[_0x216af4(0x6de)]=_0x216af4(0xebc),_0x5e642e[_0x216af4(0xaac)]=_0x216af4(0x12dc)+_0x29ff0d[_0x216af4(0x234)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x29ff0d['id']+_0x216af4(0x2b5),_0x16497c[_0x216af4(0x133d)](_0x5e642e);});}async function _0x1345ab(){const _0x339771=_0x13d875,_0x2a7edb=document[_0x339771(0x53a)]('new-sticker-category-name-input'),_0x50c9da=_0x2a7edb['value'][_0x339771(0x13bc)]();if(!_0x50c9da){alert(_0x339771(0x1000));return;}const _0x371125=await _0xa62efb[_0x339771(0xa9c)][_0x339771(0x57e)](_0x339771(0x234))['equals'](_0x50c9da)[_0x339771(0x7e6)]();if(_0x371125){alert(_0x339771(0x7dc)+_0x50c9da+_0x339771(0x2a7));return;}await _0xa62efb[_0x339771(0xa9c)][_0x339771(0xe13)]({'name':_0x50c9da}),_0x2a7edb[_0x339771(0x11a2)]='',await _0xe4a21b();}async function _0x185c81(_0x43a940){const _0x20d0ab=_0x13d875,_0x16d214=await _0xa62efb[_0x20d0ab(0xa9c)][_0x20d0ab(0x883)](_0x43a940);if(!_0x16d214)return;const _0x13a02d=await _0xa62efb['userStickers'][_0x20d0ab(0x57e)](_0x20d0ab(0xbcd))[_0x20d0ab(0x12f6)](_0x43a940)['count'](),_0x2f01f8=_0x13a02d>0x0?_0x20d0ab(0x11c4)+_0x16d214[_0x20d0ab(0x234)]+_0x20d0ab(0xa49)+_0x13a02d+_0x20d0ab(0xd8b):_0x20d0ab(0x11c4)+_0x16d214[_0x20d0ab(0x234)]+_0x20d0ab(0x1452),_0x3a2f0d=await _0x355fc0(_0x20d0ab(0x65a),_0x2f01f8,{'confirmButtonClass':_0x20d0ab(0x264)});if(_0x3a2f0d)try{await _0xa62efb['transaction']('rw',_0xa62efb['stickerCategories'],_0xa62efb['userStickers'],async()=>{const _0x4c92bd=_0x20d0ab,_0x4b9449=await _0xa62efb[_0x4c92bd(0xf8f)][_0x4c92bd(0x57e)](_0x4c92bd(0xbcd))[_0x4c92bd(0x12f6)](_0x43a940)[_0x4c92bd(0x13dc)]();_0x4b9449[_0x4c92bd(0x29d)]>0x0&&await _0xa62efb[_0x4c92bd(0xf8f)][_0x4c92bd(0x12e5)](_0x4b9449),await _0xa62efb['stickerCategories'][_0x4c92bd(0x121e)](_0x43a940);}),_0x53d851[_0x20d0ab(0xf8f)]=await _0xa62efb['userStickers'][_0x20d0ab(0xa73)](),_0x2d0790===_0x43a940&&(_0x2d0790=_0x20d0ab(0x63d)),await _0xe4a21b(),await _0x590e2b(),alert(_0x20d0ab(0xbd7)+_0x16d214[_0x20d0ab(0x234)]+'》及其下的表情已成功删除。');}catch(_0x25a436){console['error'](_0x20d0ab(0xae8),_0x25a436),alert('删除失败，请查看控制台错误信息。');}}function _0x4eeba4(_0xb7e2dd){const _0xf61fd=_0x13d875;_0x2d0790=_0xb7e2dd,document['querySelectorAll'](_0xf61fd(0x88a))['forEach'](_0x56d00c=>{const _0x547fd2=_0xf61fd;_0x56d00c['classList'][_0x547fd2(0x4d7)](_0x547fd2(0xdf6),String(_0x56d00c[_0x547fd2(0x999)][_0x547fd2(0xbcd)])===String(_0xb7e2dd));}),_0x590e2b(![]);const _0x17fce3=document[_0xf61fd(0x53a)](_0xf61fd(0x1175));if(_0x17fce3)_0x17fce3['checked']=![];}async function _0x28601a(){const _0x136945=_0x13d875;if(!_0x53d851[_0x136945(0x13be)])return;const _0x4c9ba4=_0x53d851[_0x136945(0xaa3)][_0x53d851['activeChatId']];if(!_0x4c9ba4)return;try{const _0x6e60eb={'type':_0x136945(0x589),'version':0x1,'chatData':_0x4c9ba4},_0x41a5ce=new Blob([JSON[_0x136945(0xe1e)](_0x6e60eb,null,0x2)],{'type':'application/json'}),_0xd2fde6=URL[_0x136945(0xaa0)](_0x41a5ce),_0x5bdd56=document['createElement']('a');_0x5bdd56[_0x136945(0xf0b)]=_0xd2fde6,_0x5bdd56['download']=_0x136945(0x3c5)+_0x4c9ba4[_0x136945(0x234)]+'-'+new Date()[_0x136945(0x747)]()['split']('T')[0x0]+_0x136945(0xbed),_0x5bdd56[_0x136945(0xb2b)](),URL['revokeObjectURL'](_0xd2fde6),await _0x184397(_0x136945(0x4e0),'与“'+_0x4c9ba4[_0x136945(0x234)]+_0x136945(0xc0b));}catch(_0x7412ac){console[_0x136945(0x617)](_0x136945(0x4dc),_0x7412ac),await _0x184397(_0x136945(0x484),_0x136945(0x3b8)+_0x7412ac[_0x136945(0x875)]);}}async function _0x440ab7(_0x4f8c01){const _0x31271c=_0x13d875;if(!_0x4f8c01||!_0x53d851[_0x31271c(0x13be)])return;const _0x2003bb=_0x53d851[_0x31271c(0x13be)],_0x5768f9=_0x53d851[_0x31271c(0xaa3)][_0x2003bb];try{const _0x2b4a96=await _0x4f8c01['text'](),_0xf8eec6=JSON['parse'](_0x2b4a96);if(_0xf8eec6[_0x31271c(0x919)]!==_0x31271c(0x589)||!_0xf8eec6[_0x31271c(0x123f)])throw new Error('文件格式不正确，这不是一个有效的单聊备份文件。');const _0x110efe=await _0x355fc0(_0x31271c(0x870),_0x31271c(0xbd8)+_0x5768f9[_0x31271c(0x234)]+_0x31271c(0x62f),{'confirmButtonClass':_0x31271c(0x264),'confirmText':_0x31271c(0xfe8)});if(!_0x110efe)return;const _0x2fe6e5=_0xf8eec6[_0x31271c(0x123f)];_0x2fe6e5['id']=_0x2003bb,await _0xa62efb[_0x31271c(0xaa3)][_0x31271c(0x546)](_0x2fe6e5),_0x53d851[_0x31271c(0xaa3)][_0x2003bb]=_0x2fe6e5,await _0x184397(_0x31271c(0x11c0),'聊天记录已成功覆盖！正在刷新界面...'),_0x60f53f(_0x2003bb),_0x5001a4(),document[_0x31271c(0x53a)](_0x31271c(0x460))['click']();}catch(_0x517a47){console[_0x31271c(0x617)](_0x31271c(0x1289),_0x517a47),await _0x184397(_0x31271c(0x3a1),'文件解析或应用失败:\x20'+_0x517a47[_0x31271c(0x875)]);}}function _0x2e9332(){const _0x315715=_0x13d875;_0x2169f3(),_0x541a81(_0x315715(0x5f3));}function _0x2169f3(){const _0x548fdf=_0x13d875,_0x746ea7=document[_0x548fdf(0x53a)](_0x548fdf(0x950));_0x746ea7['innerHTML']='';const _0x3220f0=Object[_0x548fdf(0x244)](_0x53d851[_0x548fdf(0xaa3)])[_0x548fdf(0x2dd)](_0x2847ba=>!_0x2847ba[_0x548fdf(0x86e)]);if(_0x3220f0[_0x548fdf(0x29d)]===0x0){_0x746ea7[_0x548fdf(0xaac)]=_0x548fdf(0x52d);return;}_0x3220f0[_0x548fdf(0xeaf)](_0x2194de=>{const _0x266114=_0x548fdf,_0x4c6cc2=document[_0x266114(0xd67)]('div');_0x4c6cc2[_0x266114(0x6de)]=_0x266114(0x12a1),_0x4c6cc2[_0x266114(0xaac)]=_0x266114(0xc75)+(_0x2194de[_0x266114(0x81e)][_0x266114(0x9e3)]||_0x5d06c0)+_0x266114(0x63a)+_0x2194de[_0x266114(0x234)]+_0x266114(0x1378),_0x4c6cc2[_0x266114(0x1086)](_0x266114(0xb2b),()=>_0x5065a7(_0x2194de['id'])),_0x746ea7[_0x266114(0x133d)](_0x4c6cc2);});}async function _0x5065a7(_0x53361a){const _0x4dc041=_0x13d875;_0x3f6485=_0x53361a,console['log'](_0x4dc041(0x4c1)+_0x53361a+'\x20的手机'),_0x4b6d38(),_0x201b82(),_0x513d7c(),_0x541a81('character-phone-screen');}function _0x388ce3(){const _0x1cddac=_0x13d875;_0x3f6485=null,console[_0x1cddac(0x1081)](_0x1cddac(0xc73)),_0x541a81('home-screen');}function _0x513d7c(){const _0x46684a=_0x13d875,_0x2908d8=new Date(),_0xf42e00=_0x2908d8['toLocaleTimeString'](_0x46684a(0x42f),{'hour':_0x46684a(0x1371),'minute':_0x46684a(0x1371)}),_0x273205=_0x2908d8[_0x46684a(0xc76)](_0x46684a(0x42f),{'weekday':_0x46684a(0x11bd),'month':_0x46684a(0x11bd),'day':'numeric'});document[_0x46684a(0x53a)](_0x46684a(0x6ec))[_0x46684a(0x34a)]=_0xf42e00,document['getElementById'](_0x46684a(0x997))['textContent']=_0x273205,_0x1805e5(_0x46684a(0xc85));}function _0x1805e5(_0x25f646){const _0x23602f=_0x13d875;document[_0x23602f(0xc3d)](_0x23602f(0x918))[_0x23602f(0xeaf)](_0x403650=>_0x403650['classList'][_0x23602f(0x2d4)](_0x23602f(0xdf6))),document[_0x23602f(0x53a)](_0x25f646)[_0x23602f(0x1276)]['add'](_0x23602f(0xdf6));}window[_0x13d875(0x1011)]=_0x1805e5;async function _0x589f97(_0x3e9860){const _0x26ca5f=_0x13d875;if(!_0x3f6485)return;const _0x128fbf=_0x53d851[_0x26ca5f(0xaa3)][_0x3f6485];await _0x24d6ab(_0x3f6485,_0x3e9860);switch(_0x3e9860){case'qq':_0xa41038(),_0x1805e5(_0x26ca5f(0x83f));break;case'album':_0x67fdf1(),_0x1805e5(_0x26ca5f(0x5f5));break;case _0x26ca5f(0x953):_0x4572ac(),_0x1805e5(_0x26ca5f(0x725));break;case _0x26ca5f(0xcdc):_0x1f9961(),_0x1805e5(_0x26ca5f(0x27f));break;case _0x26ca5f(0x790):_0x1c8c9c(),_0x1805e5(_0x26ca5f(0xafe));break;case _0x26ca5f(0x1010):_0x441e18(),_0x1805e5(_0x26ca5f(0x1f4));break;case _0x26ca5f(0x273):_0x480caa(),_0x1805e5('char-amap-screen');break;case'music':_0x1e77b6(),_0x1805e5(_0x26ca5f(0xfbb));break;case _0x26ca5f(0x290):_0x184b88(),_0x1805e5(_0x26ca5f(0x3c3));break;}}async function _0x67fdf1(){const _0x37d6c7=_0x13d875,_0x226aa3=document[_0x37d6c7(0x53a)]('char-album-grid');_0x226aa3[_0x37d6c7(0xaac)]='';if(!_0x3f6485)return;const _0x1178f7=_0x53d851['chats'][_0x3f6485],_0x1f97e5=_0x1178f7['simulatedAlbum']||[];if(_0x1f97e5[_0x37d6c7(0x29d)]===0x0){_0x226aa3['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>';return;}const _0x58a202=_0x37d6c7(0xbbd);_0x1f97e5['forEach'](_0x47069d=>{const _0x1329b6=_0x37d6c7,_0x18c1cb=document['createElement']('div');_0x18c1cb[_0x1329b6(0x6de)]=_0x1329b6(0xc22),_0x18c1cb[_0x1329b6(0x999)][_0x1329b6(0xa60)]=_0x47069d[_0x1329b6(0xa60)],_0x226aa3['appendChild'](_0x18c1cb);if(_0x53d851[_0x1329b6(0x906)]['enableAiDrawing']){_0x18c1cb[_0x1329b6(0x1284)][_0x1329b6(0x615)]=_0x1329b6(0x42d);const _0x2da45d=/[^\x00-\x7F]/[_0x1329b6(0x7f2)](_0x47069d[_0x1329b6(0xadb)]),_0x5ab442=_0x47069d[_0x1329b6(0xadb)]&&_0x47069d[_0x1329b6(0xadb)][_0x1329b6(0x13bc)]()&&!_0x2da45d,_0xaf1161=_0x5ab442?_0x47069d[_0x1329b6(0xadb)]:'a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting',_0x109105=_0x1329b6(0x9ce)+encodeURIComponent(_0xaf1161),_0x5a68e5=new Image();_0x5a68e5[_0x1329b6(0x110f)]=function(){const _0x9b785d=_0x1329b6;_0x18c1cb[_0x9b785d(0x1284)]['backgroundImage']=_0x9b785d(0xf22)+this['src']+')';},_0x5a68e5[_0x1329b6(0xdcc)]=function(){const _0x135f8f=_0x1329b6;_0x18c1cb[_0x135f8f(0x1284)]['backgroundImage']=_0x135f8f(0xf22)+_0x58a202+')';},_0x5a68e5[_0x1329b6(0x7ff)]=_0x109105;}else{_0x18c1cb[_0x1329b6(0x1284)][_0x1329b6(0x615)]=_0x1329b6(0xd5a),_0x18c1cb['style'][_0x1329b6(0xb24)]=_0x1329b6(0x1229);const _0x260124=document[_0x1329b6(0xd67)]('p');_0x260124[_0x1329b6(0x6de)]=_0x1329b6(0x52e),_0x260124['textContent']=_0x47069d['description']||_0x1329b6(0x7c2),_0x18c1cb[_0x1329b6(0x133d)](_0x260124);}});}function _0x4572ac(){const _0x325b1f=_0x13d875,_0x485e75=document[_0x325b1f(0x53a)]('char-browser-history');_0x485e75[_0x325b1f(0xaac)]='';if(!_0x3f6485)return;const _0x353d04=_0x53d851[_0x325b1f(0xaa3)][_0x3f6485],_0x27ac8c=[_0x353d04[_0x325b1f(0x234)],'爱好','旅游','美食','新闻',..._0x353d04['settings']['aiPersona'][_0x325b1f(0x13e8)](/，|。|\s/)[_0x325b1f(0x1340)](0x0,0x5)],_0x568d05=['知乎',_0x325b1f(0xd5f),_0x325b1f(0x77b),'微博',_0x325b1f(0xb8d)];for(let _0xf74d3c=0x0;_0xf74d3c<0xf;_0xf74d3c++){const _0x40e8a9=_0x27ac8c[Math[_0x325b1f(0x7d5)](Math['random']()*_0x27ac8c['length'])],_0xae4527=_0x568d05[Math[_0x325b1f(0x7d5)](Math[_0x325b1f(0xac4)]()*_0x568d05[_0x325b1f(0x29d)])],_0x297ebd=document[_0x325b1f(0xd67)](_0x325b1f(0x1425));_0x297ebd[_0x325b1f(0x6de)]='char-browser-item',_0x297ebd[_0x325b1f(0xaac)]=_0x325b1f(0x1323)+_0x40e8a9+_0x325b1f(0x122c)+_0xae4527+_0x325b1f(0x960)+_0xae4527['toLowerCase']()+_0x325b1f(0xede)+_0x40e8a9+_0x325b1f(0xca8),_0x485e75[_0x325b1f(0x133d)](_0x297ebd);}}function _0x1f9961(){const _0x4c9f93=_0x13d875,_0x417baf=document['getElementById'](_0x4c9f93(0xaca));_0x417baf[_0x4c9f93(0xaac)]='';if(!_0x3f6485)return;const _0x1184e1=_0x53d851[_0x4c9f93(0xaa3)][_0x3f6485],_0x179293=_0x1184e1[_0x4c9f93(0xfc8)]?.[_0x4c9f93(0x490)]||[];if(_0x179293[_0x4c9f93(0x29d)]===0x0){_0x417baf[_0x4c9f93(0xaac)]=_0x4c9f93(0xb76);return;}_0x179293[_0x4c9f93(0xeaf)](_0x809f73=>{const _0x4ab394=_0x4c9f93,_0xc847de=document['createElement']('div');_0xc847de[_0x4ab394(0x6de)]='char-product-item',_0xc847de['dataset'][_0x4ab394(0xd90)]=_0x809f73[_0x4ab394(0xd90)];let _0x5812e1;if(_0x53d851['globalSettings'][_0x4ab394(0x128d)]){const _0x333469='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x809f73[_0x4ab394(0xadb)]||_0x4ab394(0x103f));_0x5812e1=_0x4ab394(0x88b)+_0x333469+_0x4ab394(0xa5e);}else _0x5812e1=_0x4ab394(0x402)+(_0x809f73[_0x4ab394(0xd90)]||_0x4ab394(0xf1f))+_0x4ab394(0x1185);_0xc847de['innerHTML']=_0x4ab394(0x26b)+_0x5812e1+_0x4ab394(0xa4b)+_0x809f73[_0x4ab394(0x823)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-top:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>'+(_0x809f73['price']||0x0)['toFixed'](0x2)+_0x4ab394(0x101e)+_0x809f73['status']+_0x4ab394(0x237),_0x417baf[_0x4ab394(0x133d)](_0xc847de);});}function _0x45e04d(){_0x1805e5('char-home-screen');}function _0x301e0d(){const _0x2422e1=_0x13d875,_0x5ecc12=document['getElementById'](_0x2422e1(0xcbc));_0x5ecc12[_0x2422e1(0xaac)]='';if(!_0x3f6485)return;const _0x3bf816=Object[_0x2422e1(0x244)](_0x53d851[_0x2422e1(0xaa3)])[_0x2422e1(0x2dd)](_0x4070a8=>{const _0x191876=_0x2422e1;if(_0x4070a8['id']===_0x3f6485)return!![];if(_0x4070a8[_0x191876(0x86e)]&&_0x4070a8[_0x191876(0x3de)][_0x191876(0xe0f)](_0x2acf58=>_0x2acf58['id']===_0x3f6485))return!![];return![];});_0x3bf816[_0x2422e1(0xeaf)](_0x11660f=>{const _0x2aa4fc=_0x2422e1,_0x217647=_0x20f385(_0x11660f);_0x5ecc12[_0x2aa4fc(0x133d)](_0x217647);});}async function _0x24d6ab(_0x519e25,_0x117fac){const _0x168e86=_0x13d875,_0x59800d=_0x53d851[_0x168e86(0xaa3)][_0x519e25];if(!_0x59800d)return;!_0x59800d[_0x168e86(0x8b8)]&&(_0x59800d['appUsageLog']=[]),_0x59800d[_0x168e86(0x8b8)][_0x168e86(0x7dd)]({'appName':_0x117fac,'timestamp':Date['now']()}),_0x59800d[_0x168e86(0x8b8)][_0x168e86(0x29d)]>0x32&&_0x59800d[_0x168e86(0x8b8)][_0x168e86(0x375)](),await _0xa62efb[_0x168e86(0xaa3)][_0x168e86(0x546)](_0x59800d);}function _0x184b88(){const _0x206b71=_0x13d875,_0x4723ba=document['getElementById'](_0x206b71(0x5da));_0x4723ba[_0x206b71(0xaac)]='';const _0x522124=_0x53d851[_0x206b71(0xaa3)][_0x3f6485],_0x237219=(_0x522124[_0x206b71(0x8b8)]||[])[_0x206b71(0x1340)]()[_0x206b71(0x843)]();if(_0x237219['length']===0x0){_0x4723ba[_0x206b71(0xaac)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有任何使用记录。</p>';return;}const _0x2fc028={'qq':'QQ','album':'相册','browser':_0x206b71(0xf7f),'taobao':'淘宝','memo':_0x206b71(0x777),'diary':'日记','amap':_0x206b71(0x138f),'usage':_0x206b71(0xd1b)};_0x237219[_0x206b71(0xeaf)](_0x253299=>{const _0x32e6b8=_0x206b71,_0x463006=document[_0x32e6b8(0xd67)](_0x32e6b8(0x1425));_0x463006['className']=_0x32e6b8(0x44d),_0x463006[_0x32e6b8(0xaac)]=_0x32e6b8(0xe35)+new Date(_0x253299['timestamp'])[_0x32e6b8(0x5ee)]()+_0x32e6b8(0x3da)+(_0x2fc028[_0x253299[_0x32e6b8(0x7bd)]]||_0x253299[_0x32e6b8(0x7bd)])+'</strong></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x4723ba['appendChild'](_0x463006);});}async function _0x14224e(_0x5dce5b){const _0x263c0e=_0x13d875,_0x8eb9a0=_0x53d851[_0x263c0e(0xaa3)][_0x3f6485];if(!_0x8eb9a0)return;const _0x5e037b={'role':_0x263c0e(0xac5),'senderName':_0x8eb9a0[_0x263c0e(0x543)],'type':_0x263c0e(0x68b),'content':_0x5dce5b,'imageUrl':_0x263c0e(0xfe4),'timestamp':Date[_0x263c0e(0x9c1)]()};_0x8eb9a0[_0x263c0e(0xe83)][_0x263c0e(0x7dd)](_0x5e037b),await _0xa62efb['chats'][_0x263c0e(0x546)](_0x8eb9a0),_0x53d851[_0x263c0e(0x13be)]===_0x3f6485&&_0xa4d65(_0x5e037b,_0x8eb9a0),await _0x184397(_0x263c0e(0xe4f),'“'+_0x8eb9a0[_0x263c0e(0x234)]+_0x263c0e(0xfa1));}async function _0x210cce(_0x490c53){const _0x1c29d2=_0x13d875,_0x4059af=_0x53d851[_0x1c29d2(0xaa3)][_0x3f6485];if(!_0x4059af||!_0x4059af[_0x1c29d2(0x32f)])return;const _0x359130=_0x4059af[_0x1c29d2(0x32f)][_0x1c29d2(0x397)](_0x2bf8f7=>_0x2bf8f7['id']===_0x490c53);if(_0x359130){_0x3e7b3a=_0x359130;const _0x438a43=document[_0x1c29d2(0x53a)](_0x1c29d2(0x10c9)),_0x47cee7=document[_0x1c29d2(0x53a)](_0x1c29d2(0x380)),_0x3ef770=document[_0x1c29d2(0x53a)]('favorite-memo-btn');if(_0x438a43)_0x438a43[_0x1c29d2(0x34a)]=_0x359130[_0x1c29d2(0x667)];if(_0x47cee7)_0x47cee7[_0x1c29d2(0x11a2)]=_0x359130[_0x1c29d2(0x73e)];const _0xe2173=await _0xa62efb[_0x1c29d2(0xb51)][_0x1c29d2(0x57e)]({'type':'char_memo','content.id':_0x490c53})[_0x1c29d2(0x7e6)]();_0x3ef770[_0x1c29d2(0x1276)][_0x1c29d2(0x4d7)](_0x1c29d2(0xdf6),!!_0xe2173),_0x1805e5(_0x1c29d2(0x8ed));}}function _0x1c8c9c(){const _0x429bde=_0x13d875,_0x4160d7=document[_0x429bde(0x53a)](_0x429bde(0x3dc));_0x4160d7[_0x429bde(0xaac)]='';const _0x199f05=_0x53d851['chats'][_0x3f6485],_0x586e55=(_0x199f05[_0x429bde(0x32f)]||[])[_0x429bde(0x1340)]()['reverse']();if(_0x586e55[_0x429bde(0x29d)]===0x0){_0x4160d7[_0x429bde(0xaac)]=_0x429bde(0x4a6);return;}_0x586e55[_0x429bde(0xeaf)](_0x379255=>{const _0x4f7702=_0x429bde,_0x3fe3b6=document[_0x4f7702(0xd67)]('div');_0x3fe3b6[_0x4f7702(0x6de)]=_0x4f7702(0x292),_0x3fe3b6[_0x4f7702(0xaac)]=_0x4f7702(0x4d2)+_0x379255[_0x4f7702(0x667)]+_0x4f7702(0x845)+(_0x379255[_0x4f7702(0x73e)]||'')['split']('\x0a')[0x0]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x3fe3b6[_0x4f7702(0x1086)](_0x4f7702(0xb2b),()=>_0x210cce(_0x379255['id'])),_0x3146aa(_0x3fe3b6,()=>deleteMemo(_0x379255['id'])),_0x4160d7[_0x4f7702(0x133d)](_0x3fe3b6);});}async function _0x5d8c1d(_0x419da5=null){const _0x4ff7b0=_0x13d875;_0x4c1382=null;const _0x47c366=await _0x4f6537(_0x4ff7b0(0xae5),_0x4ff7b0(0x103e));if(_0x47c366===null||!_0x47c366[_0x4ff7b0(0x13bc)]())return;const _0x5301bc=await _0x4f6537(_0x4ff7b0(0x7c4)+_0x47c366,_0x4ff7b0(0x322),'',_0x4ff7b0(0x728));_0x5301bc!==null&&(await _0x158f3e({'title':_0x47c366[_0x4ff7b0(0x13bc)](),'content':_0x5301bc}),_0x1805e5(_0x4ff7b0(0xafe)));}async function _0x158f3e(_0x2f6261){const _0x18966b=_0x13d875,_0x132d9a=_0x53d851[_0x18966b(0xaa3)][_0x3f6485];if(!_0x132d9a[_0x18966b(0x32f)])_0x132d9a[_0x18966b(0x32f)]=[];_0x132d9a[_0x18966b(0x32f)][_0x18966b(0x7dd)]({'id':Date[_0x18966b(0x9c1)](),'title':_0x2f6261[_0x18966b(0x667)],'content':_0x2f6261[_0x18966b(0x73e)]}),await _0xa62efb[_0x18966b(0xaa3)][_0x18966b(0x546)](_0x132d9a),_0x1c8c9c();}async function _0x158f3e(_0x1e0daa){const _0x35fddc=_0x13d875,_0x56a8c9=_0x53d851['chats'][_0x3f6485];if(!_0x56a8c9['memos'])_0x56a8c9['memos']=[];if(_0x4c1382){const _0x27c9b2=_0x56a8c9[_0x35fddc(0x32f)][_0x35fddc(0x397)](_0x3df448=>_0x3df448['id']===_0x4c1382);if(_0x27c9b2)_0x27c9b2[_0x35fddc(0x73e)]=_0x1e0daa;}else _0x56a8c9[_0x35fddc(0x32f)][_0x35fddc(0x7dd)]({'id':Date[_0x35fddc(0x9c1)](),'content':_0x1e0daa});await _0xa62efb[_0x35fddc(0xaa3)][_0x35fddc(0x546)](_0x56a8c9),_0x1c8c9c(),_0x4c1382=null;}async function _0x2dec4e(){const _0x5d007d=_0x13d875;if(!_0x3f6485)return;const _0x4a6638=_0x53d851[_0x5d007d(0xaa3)][_0x3f6485];if(!_0x4a6638)return;await _0x184397(_0x5d007d(0x11d7),'正在请求“'+_0x4a6638[_0x5d007d(0x234)]+'”翻开TA的日记本...');const {proxyUrl:_0x1ae840,apiKey:_0x1dd5a1,model:_0x33a8c0}=_0x53d851['apiConfig'];if(!_0x1ae840||!_0x1dd5a1||!_0x33a8c0){alert(_0x5d007d(0x3ed));return;}const _0x14b316=_0x53d851['qzoneSettings'][_0x5d007d(0x1005)]===_0x5d007d(0x8ac)||!_0x53d851['qzoneSettings'][_0x5d007d(0x1005)]?'用户':_0x53d851[_0x5d007d(0xa74)][_0x5d007d(0x1005)],_0x459320=_0x4a6638[_0x5d007d(0x1016)]&&_0x4a6638[_0x5d007d(0x1016)][_0x5d007d(0x29d)]>0x0?_0x4a6638[_0x5d007d(0x1016)][_0x5d007d(0xcb4)](_0x17551f=>_0x5d007d(0xd87)+_0x272f9c(_0x17551f[_0x5d007d(0x827)])+')\x20'+_0x17551f[_0x5d007d(0x73e)])['join']('\x0a'):'无',_0x3eef18=_0x4a6638['settings'][_0x5d007d(0x489)]||0xa,_0x478bb3=_0x4a6638[_0x5d007d(0xe83)][_0x5d007d(0x1340)](-_0x3eef18)[_0x5d007d(0xcb4)](_0x5137a2=>(_0x5137a2['role']==='user'?_0x14b316:_0x4a6638[_0x5d007d(0x234)])+':\x20'+String(_0x5137a2[_0x5d007d(0x73e)])[_0x5d007d(0xad6)](0x0,0x1e)+_0x5d007d(0x95d))[_0x5d007d(0x2c8)]('\x0a'),_0x167f0e=(_0x4a6638[_0x5d007d(0x81e)]['linkedWorldBookIds']||[])[_0x5d007d(0xcb4)](_0x295165=>_0x53d851[_0x5d007d(0x10f2)][_0x5d007d(0x397)](_0x211b4e=>_0x211b4e['id']===_0x295165))[_0x5d007d(0x2dd)](Boolean)[_0x5d007d(0xcb4)](_0x1d52e0=>'\x0a##\x20世界书《'+_0x1d52e0[_0x5d007d(0x234)]+_0x5d007d(0xd29)+_0x1d52e0[_0x5d007d(0x73e)]['filter'](_0x3f2a0f=>_0x3f2a0f[_0x5d007d(0xb3d)])[_0x5d007d(0xcb4)](_0x3a031f=>'-\x20'+_0x3a031f[_0x5d007d(0x73e)])[_0x5d007d(0x2c8)]('\x0a'))['join'](''),_0x52acb9=_0x32a9cb(_0x4a6638,0x3,_0x5d007d(0x81f)),_0x33abf6=_0x32a9cb(_0x4a6638,0x6,'hours'),_0x3c85c3=_0x32a9cb(_0x4a6638,0x9,_0x5d007d(0x81f)),_0x2a8dd9=_0x32a9cb(_0x4a6638,0x1,_0x5d007d(0xc61)),_0x1c722d=_0x32a9cb(_0x4a6638,0x3,_0x5d007d(0xc61)),_0x4a6ffd=_0x32a9cb(_0x4a6638,0x7,_0x5d007d(0xc61));let _0x1d5bde='';if(_0x52acb9||_0x33abf6||_0x3c85c3||_0x2a8dd9||_0x1c722d||_0x4a6ffd){_0x1d5bde+=_0x5d007d(0xb9a);if(_0x52acb9)_0x1d5bde+=_0x52acb9;if(_0x33abf6)_0x1d5bde+=_0x33abf6;if(_0x3c85c3)_0x1d5bde+=_0x3c85c3;if(_0x52acb9||_0x33abf6||_0x3c85c3)_0x1d5bde+='\x0a';if(_0x2a8dd9)_0x1d5bde+=_0x2a8dd9;if(_0x1c722d)_0x1d5bde+=_0x1c722d;if(_0x4a6ffd)_0x1d5bde+=_0x4a6ffd;}const _0x37ce50=_0x4a6638[_0x5d007d(0x81e)][_0x5d007d(0xab1)]||_0x5d007d(0x970),_0x5493d8=_0x5d007d(0xc4d)+_0x4a6638[_0x5d007d(0x234)]+_0x5d007d(0x368)+new Date()[_0x5d007d(0xc76)](_0x5d007d(0x42f))+_0x5d007d(0x2ba)+_0x14b316+_0x5d007d(0x12a3)+_0x4a6638[_0x5d007d(0x81e)][_0x5d007d(0x1216)]+_0x5d007d(0xf69)+_0x37ce50+_0x5d007d(0x6cf)+_0x459320+'\x0a'+_0x167f0e+'\x0a'+_0x1d5bde+_0x5d007d(0x513)+_0x14b316+'”的对话摘要**:\x0a'+_0x478bb3+_0x5d007d(0xeb1);try{const _0x236b3d=[{'role':_0x5d007d(0x10ae),'content':'请根据你的设定，生成你的日记内容。'}];let _0x4844e6=_0x1ae840[_0x5d007d(0x6e9)](_0x5d007d(0x1046)),_0xe4d1ae=_0x1697e7(_0x33a8c0,_0x1dd5a1,_0x5493d8,_0x236b3d);const _0x278717=_0x4844e6?await fetch(_0xe4d1ae[_0x5d007d(0xb36)],_0xe4d1ae['data']):await fetch(_0x1ae840+_0x5d007d(0x434),{'method':_0x5d007d(0xa4e),'headers':{'Content-Type':_0x5d007d(0x85b),'Authorization':'Bearer\x20'+_0x1dd5a1},'body':JSON[_0x5d007d(0xe1e)]({'model':_0x33a8c0,'messages':[{'role':_0x5d007d(0xab3),'content':_0x5493d8},..._0x236b3d],'temperature':_0x53d851[_0x5d007d(0x906)][_0x5d007d(0xaf8)]||0.95})});if(!_0x278717['ok'])throw new Error(_0x5d007d(0x352)+_0x278717[_0x5d007d(0x5c1)]);const _0x272802=await _0x278717['json'](),_0x3f7518=getGeminiResponseText(_0x272802),_0x57dc71=_0x3f7518['match'](/(\[[\s\S]*\])/);if(!_0x57dc71||!_0x57dc71[0x0])throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x3f7518);const _0x1914b5=_0x57dc71[0x0];let _0x3d990b;try{_0x3d990b=JSON['parse'](_0x1914b5);}catch(_0x5f2f98){throw new Error(_0x5d007d(0x7a4)+_0x5f2f98[_0x5d007d(0x875)]+_0x5d007d(0xa01)+_0x3f7518);}_0x4a6638[_0x5d007d(0x1010)]=_0x3d990b[_0x5d007d(0xcb4)](_0x53123d=>({'id':Date[_0x5d007d(0x9c1)]()+Math[_0x5d007d(0xac4)](),'title':_0x53123d[_0x5d007d(0x667)],'content':_0x53123d[_0x5d007d(0x73e)],'timestamp':Date[_0x5d007d(0x9c1)]()})),await _0xa62efb[_0x5d007d(0xaa3)][_0x5d007d(0x546)](_0x4a6638),await _0x441e18();}catch(_0x4301f6){console['error'](_0x5d007d(0x689),_0x4301f6),await _0x184397(_0x5d007d(0x3eb),'无法生成日记，请检查API配置或稍后再试。\x0a错误:\x20'+_0x4301f6['message']);}}async function _0x166899(){const _0x3fe843=_0x13d875;if(!_0x3f6485)return;const _0x39dcbd=_0x53d851[_0x3fe843(0xaa3)][_0x3f6485];if(!_0x39dcbd)return;await _0x184397(_0x3fe843(0x11d7),_0x3fe843(0x217)+_0x39dcbd[_0x3fe843(0x234)]+'”写一篇新日记...');const {proxyUrl:_0x228c7c,apiKey:_0x15349e,model:_0x3866e8}=_0x53d851['apiConfig'];if(!_0x228c7c||!_0x15349e||!_0x3866e8)return;const _0x417c58=_0x53d851[_0x3fe843(0xa74)][_0x3fe843(0x1005)]===_0x3fe843(0x8ac)||!_0x53d851[_0x3fe843(0xa74)][_0x3fe843(0x1005)]?'用户':_0x53d851[_0x3fe843(0xa74)]['nickname'],_0x5de521=_0x39dcbd[_0x3fe843(0x1016)]&&_0x39dcbd['longTermMemory'][_0x3fe843(0x29d)]>0x0?_0x39dcbd[_0x3fe843(0x1016)][_0x3fe843(0xcb4)](_0x585e6e=>'-\x20(记录于\x20'+_0x272f9c(_0x585e6e[_0x3fe843(0x827)])+')\x20'+_0x585e6e[_0x3fe843(0x73e)])['join']('\x0a'):'无',_0x1baa46=_0x39dcbd[_0x3fe843(0x81e)][_0x3fe843(0x489)]||0xa,_0x10d00e=_0x39dcbd[_0x3fe843(0xe83)][_0x3fe843(0x1340)](-_0x1baa46)[_0x3fe843(0xcb4)](_0x139486=>(_0x139486[_0x3fe843(0xb4d)]===_0x3fe843(0x10ae)?_0x417c58:_0x39dcbd[_0x3fe843(0x234)])+':\x20'+String(_0x139486[_0x3fe843(0x73e)])[_0x3fe843(0xad6)](0x0,0x1e)+_0x3fe843(0x95d))[_0x3fe843(0x2c8)]('\x0a'),_0x593f70=(_0x39dcbd['settings'][_0x3fe843(0x4ab)]||[])[_0x3fe843(0xcb4)](_0x339d40=>_0x53d851['worldBooks'][_0x3fe843(0x397)](_0x488406=>_0x488406['id']===_0x339d40))[_0x3fe843(0x2dd)](Boolean)[_0x3fe843(0xcb4)](_0x39053b=>_0x3fe843(0x474)+_0x39053b[_0x3fe843(0x234)]+_0x3fe843(0xd29)+_0x39053b[_0x3fe843(0x73e)][_0x3fe843(0x2dd)](_0x17d87b=>_0x17d87b[_0x3fe843(0xb3d)])[_0x3fe843(0xcb4)](_0x567251=>'-\x20'+_0x567251['content'])[_0x3fe843(0x2c8)]('\x0a'))[_0x3fe843(0x2c8)](''),_0x3abd01=_0x3fe843(0x1121)+_0x39dcbd[_0x3fe843(0x234)]+'”，并根据其人设、记忆和最近的互动，虚构出【1篇】TA今天可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【【【时间铁律\x20(最高优先级)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**'+new Date()[_0x3fe843(0xc76)](_0x3fe843(0x42f))+_0x3fe843(0x392)+_0x39dcbd[_0x3fe843(0x81e)][_0x3fe843(0x1216)]+_0x3fe843(0x6cf)+_0x5de521+'\x0a'+_0x593f70+_0x3fe843(0x334)+_0x417c58+'”的对话摘要**:\x0a'+_0x10d00e+_0x3fe843(0x7b3);try{const _0x13d13a=[{'role':_0x3fe843(0x10ae),'content':_0x3fe843(0x1130)}];let _0x35df86=_0x228c7c[_0x3fe843(0x6e9)](_0x3fe843(0x1046)),_0x1e4dd7=_0x1697e7(_0x3866e8,_0x15349e,_0x3abd01,_0x13d13a);const _0x1e2921=_0x35df86?await fetch(_0x1e4dd7[_0x3fe843(0xb36)],_0x1e4dd7[_0x3fe843(0xd7c)]):await fetch(_0x228c7c+_0x3fe843(0x434),{'method':_0x3fe843(0xa4e),'headers':{'Content-Type':'application/json','Authorization':_0x3fe843(0x841)+_0x15349e},'body':JSON[_0x3fe843(0xe1e)]({'model':_0x3866e8,'messages':[{'role':_0x3fe843(0xab3),'content':_0x3abd01},..._0x13d13a],'temperature':_0x53d851[_0x3fe843(0x906)][_0x3fe843(0xaf8)]||0.95})});if(!_0x1e2921['ok'])throw new Error(_0x3fe843(0x352)+_0x1e2921[_0x3fe843(0x5c1)]);const _0x31d4d8=await _0x1e2921[_0x3fe843(0xdc2)](),_0xfc78d1=getGeminiResponseText(_0x31d4d8),_0x33086d=_0xfc78d1[_0x3fe843(0x1120)](/(\[[\s\S]*\])/);if(!_0x33086d||!_0x33086d[0x0])throw new Error(_0x3fe843(0xfe3)+_0xfc78d1);const _0x1e7cda=_0x33086d[0x0];let _0x782855;try{_0x782855=JSON[_0x3fe843(0x367)](_0x1e7cda)[0x0];}catch(_0x360c73){throw new Error(_0x3fe843(0x7a4)+_0x360c73[_0x3fe843(0x875)]+_0x3fe843(0xa01)+_0xfc78d1);}if(!_0x39dcbd[_0x3fe843(0x1010)])_0x39dcbd[_0x3fe843(0x1010)]=[];_0x39dcbd['diary'][_0x3fe843(0x7dd)]({'id':Date[_0x3fe843(0x9c1)](),'title':_0x782855['title'],'content':_0x782855['content'],'timestamp':Date[_0x3fe843(0x9c1)]()}),await _0xa62efb[_0x3fe843(0xaa3)][_0x3fe843(0x546)](_0x39dcbd),await _0x441e18();}catch(_0x1a2fd7){console['error']('生成新日记失败:',_0x1a2fd7),await _0x184397(_0x3fe843(0x3eb),_0x3fe843(0xea6)+_0x1a2fd7['message']);}}function _0x441e18(){const _0x212b3d=_0x13d875,_0x15416d=document[_0x212b3d(0x53a)]('char-diary-list');_0x15416d[_0x212b3d(0xaac)]='';const _0x3bba69=_0x53d851['chats'][_0x3f6485],_0x459ce8=(_0x3bba69[_0x212b3d(0x1010)]||[])['slice']()[_0x212b3d(0x843)]();if(_0x459ce8[_0x212b3d(0x29d)]===0x0){_0x15416d[_0x212b3d(0xaac)]=_0x212b3d(0x125f);return;}_0x459ce8[_0x212b3d(0xeaf)](_0x4f88ed=>{const _0x27747a=_0x212b3d,_0x40ce62=document[_0x27747a(0xd67)]('div');_0x40ce62[_0x27747a(0x6de)]=_0x27747a(0x292),_0x40ce62[_0x27747a(0xaac)]=_0x27747a(0x6b7)+_0x4f88ed[_0x27747a(0x667)]+_0x27747a(0xd80)+new Date(_0x4f88ed[_0x27747a(0x827)])[_0x27747a(0xc76)]()+_0x27747a(0x30c),_0x40ce62[_0x27747a(0x1086)](_0x27747a(0xb2b),()=>_0x5a2dc1(_0x4f88ed['id'])),_0x3146aa(_0x40ce62,()=>_0x4b976b(_0x4f88ed['id'])),_0x15416d[_0x27747a(0x133d)](_0x40ce62);});}async function _0x5a2dc1(_0x2734c8){const _0x533966=_0x13d875,_0x1a5865=_0x53d851[_0x533966(0xaa3)][_0x3f6485];if(!_0x1a5865||!_0x1a5865[_0x533966(0x1010)])return;const _0x22fbc0=_0x1a5865[_0x533966(0x1010)][_0x533966(0x397)](_0x49fa54=>_0x49fa54['id']===_0x2734c8);if(_0x22fbc0){_0x332baf=_0x22fbc0;const _0x1fc2aa=document['getElementById']('char-diary-detail-title'),_0x4b8910=document[_0x533966(0x53a)]('char-diary-detail-content'),_0x19f35f=document[_0x533966(0x53a)]('favorite-diary-btn');_0x1fc2aa[_0x533966(0x34a)]=_0x22fbc0[_0x533966(0x667)];const _0x5d351f=_0x46c503(_0x22fbc0[_0x533966(0x73e)])[_0x533966(0x13e8)]('\x0a')[_0x533966(0xcb4)](_0x4c327b=>_0x533966(0xb1a)+(_0x4c327b||_0x533966(0x1274))+_0x533966(0x12e2))[_0x533966(0x2c8)]('');_0x4b8910[_0x533966(0xaac)]=_0x5d351f;const _0x15e59e=await _0xa62efb[_0x533966(0xb51)][_0x533966(0x57e)]({'type':'char_diary','content.id':_0x2734c8})[_0x533966(0x7e6)]();_0x19f35f[_0x533966(0x1276)][_0x533966(0x4d7)](_0x533966(0xdf6),!!_0x15e59e),_0x1805e5(_0x533966(0x10bf));}}async function _0x241cd3(){const _0x24f759=_0x13d875;if(!_0x332baf||!_0x3f6485)return;const _0x3f173e=_0x332baf,_0x3412a8=_0x53d851[_0x24f759(0xaa3)][_0x3f6485],_0x46e095=document['getElementById'](_0x24f759(0x12b8)),_0x1c440e=await _0xa62efb[_0x24f759(0xb51)][_0x24f759(0x57e)]({'type':_0x24f759(0x97e),'content.id':_0x3f173e['id']})[_0x24f759(0x7e6)]();if(_0x1c440e)await _0xa62efb[_0x24f759(0xb51)]['delete'](_0x1c440e['id']),_0x46e095['classList']['remove'](_0x24f759(0xdf6)),await _0x184397('操作成功',_0x24f759(0xda1));else{const _0x274e99={'type':'char_diary','content':{'id':_0x3f173e['id'],'title':_0x3f173e[_0x24f759(0x667)],'content':_0x3f173e[_0x24f759(0x73e)],'timestamp':_0x3f173e[_0x24f759(0x827)],'characterId':_0x3f6485,'characterName':_0x3412a8['name']},'timestamp':Date[_0x24f759(0x9c1)]()};await _0xa62efb[_0x24f759(0xb51)][_0x24f759(0xe13)](_0x274e99),_0x46e095[_0x24f759(0x1276)][_0x24f759(0xe13)]('active'),await _0x184397(_0x24f759(0xfd5),_0x24f759(0x452));}}async function _0x48beca(){const _0x27537d=_0x13d875;if(!_0x3e7b3a||!_0x3f6485)return;const _0x2a6a35=_0x3e7b3a,_0x455e8d=_0x53d851['chats'][_0x3f6485],_0x146953=document[_0x27537d(0x53a)](_0x27537d(0x824)),_0x28941c=await _0xa62efb[_0x27537d(0xb51)]['where']({'type':'char_memo','content.id':_0x2a6a35['id']})[_0x27537d(0x7e6)]();if(_0x28941c)await _0xa62efb[_0x27537d(0xb51)][_0x27537d(0x121e)](_0x28941c['id']),_0x146953[_0x27537d(0x1276)][_0x27537d(0x2d4)](_0x27537d(0xdf6)),await _0x184397('操作成功',_0x27537d(0xda1));else{const _0x46ecc7={'type':_0x27537d(0x1222),'content':{'id':_0x2a6a35['id'],'title':_0x2a6a35['title'],'content':_0x2a6a35[_0x27537d(0x73e)],'timestamp':_0x2a6a35[_0x27537d(0x827)],'characterId':_0x3f6485,'characterName':_0x455e8d['name']},'timestamp':Date[_0x27537d(0x9c1)]()};await _0xa62efb[_0x27537d(0xb51)][_0x27537d(0xe13)](_0x46ecc7),_0x146953[_0x27537d(0x1276)][_0x27537d(0xe13)](_0x27537d(0xdf6)),await _0x184397('操作成功',_0x27537d(0x452));}}async function _0x4b976b(_0x5268f5){const _0x20a875=_0x13d875,_0x4d7436=await _0x355fc0(_0x20a875(0x538),_0x20a875(0x3a4),{'confirmButtonClass':_0x20a875(0x264)});if(_0x4d7436){const _0x43db34=_0x53d851[_0x20a875(0xaa3)][_0x3f6485];_0x43db34[_0x20a875(0x1010)]=_0x43db34['diary']['filter'](_0xf8a5a1=>_0xf8a5a1['id']!==_0x5268f5),await _0xa62efb['chats']['put'](_0x43db34),_0x441e18();}}async function _0xa41038(){const _0x461865=_0x13d875,_0x4f0f24=document[_0x461865(0x53a)](_0x461865(0xcbc));_0x4f0f24[_0x461865(0xaac)]='';const _0x3a89ea=_0x53d851['chats'][_0x3f6485];if(!_0x3a89ea)return;const _0x249f94=_0x3a89ea[_0x461865(0x81e)]['myNickname']||(_0x53d851[_0x461865(0xa74)][_0x461865(0x1005)]||'我'),_0x423adc=_0x3a89ea[_0x461865(0xe83)][_0x461865(0x2dd)](_0x3dd162=>!_0x3dd162['isHidden'])['slice'](-0x1)[0x0]||{'content':'...'};let _0x2543a0=_0x461865(0x95d);if(_0x423adc){if(typeof _0x423adc['content']===_0x461865(0xfc5))_0x2543a0=_0x423adc[_0x461865(0x73e)];else{if(Array[_0x461865(0xb31)](_0x423adc[_0x461865(0x73e)])&&_0x423adc[_0x461865(0x73e)][0x0]?.[_0x461865(0x919)]==='image_url')_0x2543a0=_0x461865(0x1169);else{if(_0x423adc['type']){const _0x526e66={'voice_message':'[语音]','transfer':_0x461865(0x6b4),'ai_image':_0x461865(0x1169)};_0x2543a0=_0x526e66[_0x423adc['type']]||'['+_0x423adc[_0x461865(0x919)]+']';}}}}const _0x74b5f9=_0x3a89ea['settings']['myAvatar']||_0x5d06c0,_0x1e38e1=_0x3a89ea[_0x461865(0x81e)][_0x461865(0xf77)]||'';let _0x36a600;_0x1e38e1?_0x36a600='<div\x20class=\x22avatar-group\x20has-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><div\x20class=\x22avatar-with-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22'+_0x74b5f9+'\x22\x20class=\x22avatar-img\x22\x20style=\x22border-radius:\x2050%;\x22><img\x20src=\x22'+_0x1e38e1+_0x461865(0x437):_0x36a600=_0x461865(0x10c1)+_0x74b5f9+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x20width:\x2045px;\x20height:\x2045px;\x22></div>';const _0x338ec8=document[_0x461865(0xd67)](_0x461865(0x1425));_0x338ec8[_0x461865(0x6de)]='chat-list-item',_0x338ec8[_0x461865(0x999)][_0x461865(0xad7)]='-1',_0x338ec8[_0x461865(0xaac)]=_0x461865(0x7b6)+_0x36a600+_0x461865(0xc37)+_0x249f94+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>'+String(_0x2543a0)[_0x461865(0xad6)](0x0,0x14)+_0x461865(0x8d2),_0x4f0f24[_0x461865(0x133d)](_0x338ec8);const _0x164e3d=await _0xa62efb[_0x461865(0x5b7)][_0x461865(0xa73)](),_0x286f37=new Map(_0x164e3d[_0x461865(0xcb4)](_0x11f529=>[_0x11f529[_0x461865(0x234)],_0x11f529])),_0x43eed6=_0x3a89ea[_0x461865(0x76c)]||[];if(_0x43eed6['length']===0x0&&!_0x338ec8){_0x4f0f24[_0x461865(0xaac)]=_0x461865(0xd09);return;}_0x43eed6[_0x461865(0xeaf)]((_0x913341,_0x49cd4a)=>{const _0x191846=_0x461865;if(_0x913341[_0x191846(0x919)]===_0x191846(0xead))return;const _0x223000=document[_0x191846(0xd67)](_0x191846(0x1425));_0x223000[_0x191846(0x6de)]=_0x191846(0x514),_0x223000[_0x191846(0x999)]['conversationIndex']=_0x49cd4a;let _0x286826,_0x765701,_0x524cfd;if(_0x913341[_0x191846(0x919)]===_0x191846(0x1048)){_0x524cfd=_0x913341['groupName']+_0x191846(0x435),_0x286826=_0x913341[_0x191846(0x109c)][_0x191846(0x1340)](-0x1)[0x0]||{'content':_0x191846(0x95d)};const _0x2562cf=_0x191846(0xda7)+_0x913341[_0x191846(0x5f8)]+'\x27',_0x347657=_0x53d851[_0x191846(0x906)][_0x191846(0x128d)]?_0x191846(0x9ce)+encodeURIComponent(_0x2562cf):_0x29ae5b;_0x765701=_0x191846(0x2c1)+_0x347657+_0x191846(0x12e0);}else{_0x524cfd=_0x913341[_0x191846(0x102a)][_0x191846(0x234)],_0x286826=_0x913341[_0x191846(0x109c)][_0x191846(0x1340)](-0x1)[0x0]||{'content':_0x191846(0x95d)};const _0x4f2ac9=_0x286f37['get'](_0x524cfd);let _0x41c158=_0x4f2ac9&&_0x4f2ac9[_0x191846(0x8cd)]?_0x4f2ac9[_0x191846(0x8cd)]:_0x53d851[_0x191846(0x906)]['enableAiDrawing']?_0x191846(0x9ce)+encodeURIComponent(_0x913341[_0x191846(0x102a)]['avatar_prompt']||'anime\x20person'):_0x434592;_0x765701='<div\x20class=\x22avatar-group\x22><img\x20src=\x22'+_0x41c158+'\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>';}let _0x1e1b84=_0x191846(0x95d);_0x286826&&_0x286826[_0x191846(0x73e)]&&(_0x1e1b84=_0x286826[_0x191846(0x73e)]),_0x223000[_0x191846(0xaac)]=_0x191846(0x495)+_0x765701+_0x191846(0x11f3)+_0x524cfd+_0x191846(0x810)+String(_0x1e1b84)[_0x191846(0xad6)](0x0,0x14)+'...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x4f0f24[_0x191846(0x133d)](_0x223000);});}async function _0x41c422(){const _0xf115ad=_0x13d875;if(!_0x3f6485)return;const _0x3b48a5=_0x53d851['chats'][_0x3f6485];if(!_0x3b48a5)return;await _0x184397(_0xf115ad(0x11d7),_0xf115ad(0xee9)+_0x3b48a5[_0xf115ad(0x234)]+_0xf115ad(0x948));const {proxyUrl:_0x406893,apiKey:_0x20c4f9,model:_0x4f51e5}=_0x53d851['apiConfig'];if(!_0x406893||!_0x20c4f9||!_0x4f51e5){alert('请先在API设置中配置好API信息。');return;}const _0x5ab9a9=await _0xa62efb[_0xf115ad(0x5b7)][_0xf115ad(0xa73)](),_0x3f597a=_0x5ab9a9[_0xf115ad(0x2dd)](_0x120b39=>_0x120b39[_0xf115ad(0xa21)]&&_0x120b39[_0xf115ad(0xa21)]['includes'](_0x3f6485));let _0x59c92b=_0xf115ad(0xb57);_0x3f597a['length']>0x0?(_0x59c92b+='这是你认识的、关系密切的NPC。在生成对话时，你应该【优先】与他们互动。\x0a',_0x3f597a[_0xf115ad(0xeaf)](_0x3b5cfa=>{const _0x25c640=_0xf115ad;_0x59c92b+='-\x20**姓名**:\x20'+_0x3b5cfa['name']+'\x0a\x20\x20-\x20**人设**:\x20'+_0x3b5cfa[_0x25c640(0x11fb)]+'\x0a';})):_0x59c92b+='（你目前没有绑定的NPC伙伴，可以自由创造新的NPC。）\x0a';const _0x106e9b=_0x53d851[_0xf115ad(0xa74)][_0xf115ad(0x1005)]===_0xf115ad(0x8ac)||!_0x53d851[_0xf115ad(0xa74)][_0xf115ad(0x1005)]?'用户':_0x53d851[_0xf115ad(0xa74)]['nickname'],_0x48b4ef=_0x3b48a5[_0xf115ad(0x81e)][_0xf115ad(0x1303)]||_0x106e9b,_0x85252d=_0x3b48a5['longTermMemory']&&_0x3b48a5[_0xf115ad(0x1016)][_0xf115ad(0x29d)]>0x0?_0x3b48a5[_0xf115ad(0x1016)][_0xf115ad(0xcb4)](_0x20e18b=>_0xf115ad(0xd87)+_0x272f9c(_0x20e18b[_0xf115ad(0x827)])+')\x20'+_0x20e18b[_0xf115ad(0x73e)])[_0xf115ad(0x2c8)]('\x0a'):'无',_0x3b081f=_0x3b48a5[_0xf115ad(0x81e)][_0xf115ad(0x489)]||0xa,_0x57db2f=_0x3b48a5[_0xf115ad(0xe83)][_0xf115ad(0x1340)](-_0x3b081f)['map'](_0x207b77=>(_0x207b77[_0xf115ad(0xb4d)]===_0xf115ad(0x10ae)?_0x48b4ef:_0x3b48a5['name'])+':\x20'+String(_0x207b77[_0xf115ad(0x73e)])['substring'](0x0,0x1e)+_0xf115ad(0x95d))[_0xf115ad(0x2c8)]('\x0a'),_0x1ae6de=(_0x3b48a5[_0xf115ad(0x81e)][_0xf115ad(0x4ab)]||[])['map'](_0x559b08=>_0x53d851[_0xf115ad(0x10f2)][_0xf115ad(0x397)](_0x45c64b=>_0x45c64b['id']===_0x559b08))[_0xf115ad(0x2dd)](Boolean)['map'](_0x226691=>_0xf115ad(0x474)+_0x226691['name']+_0xf115ad(0x104b)+_0x226691['content']['filter'](_0x42f3ab=>_0x42f3ab['enabled'])[_0xf115ad(0xcb4)](_0xf1925a=>'-\x20'+_0xf1925a[_0xf115ad(0x73e)])[_0xf115ad(0x2c8)]('\x0a'))['join'](''),_0x45ad14=_0x3b48a5[_0xf115ad(0x543)]||_0x3b48a5[_0xf115ad(0x234)],_0xb0fe68=_0x194105(_0x3b48a5),_0x1dc5c0='\x0a#\x20你的任务\x0a你是一个虚拟社交生活模拟器，扮演角色“'+_0x3b48a5[_0xf115ad(0x234)]+_0xf115ad(0xeff)+_0x45ad14+_0xf115ad(0x549)+_0x45ad14+_0xf115ad(0x393)+_0x45ad14+_0xf115ad(0x13e4)+_0x3b48a5[_0xf115ad(0x81e)]['aiPersona']+_0xf115ad(0x106e)+_0x85252d+_0xf115ad(0x4d0)+_0x1ae6de+_0xf115ad(0xdbc)+_0x57db2f+'\x0a'+_0x59c92b+_0xf115ad(0x28e)+_0xb0fe68+_0xf115ad(0x8b7);try{const _0x1a1a0d=[{'role':_0xf115ad(0x10ae),'content':_0xf115ad(0x95a)}];let _0x70db55=_0x406893[_0xf115ad(0x6e9)]('generativelanguage'),_0x5c0a90=_0x1697e7(_0x4f51e5,_0x20c4f9,_0x1dc5c0,_0x1a1a0d);const _0x322948=_0x70db55?await fetch(_0x5c0a90[_0xf115ad(0xb36)],_0x5c0a90['data']):await fetch(_0x406893+_0xf115ad(0x434),{'method':_0xf115ad(0xa4e),'headers':{'Content-Type':_0xf115ad(0x85b),'Authorization':_0xf115ad(0x841)+_0x20c4f9},'body':JSON[_0xf115ad(0xe1e)]({'model':_0x4f51e5,'messages':[{'role':_0xf115ad(0xab3),'content':_0x1dc5c0},..._0x1a1a0d],'temperature':_0x53d851['globalSettings'][_0xf115ad(0xaf8)]||0.9})});if(!_0x322948['ok'])throw new Error(_0xf115ad(0x352)+_0x322948['statusText']);const _0x11e8f8=await _0x322948[_0xf115ad(0xdc2)](),_0x464371=getGeminiResponseText(_0x11e8f8),_0x5a8fb6=_0x464371[_0xf115ad(0x1120)](/(\[[\s\S]*\])/);if(!_0x5a8fb6||!_0x5a8fb6[0x0])throw new Error(_0xf115ad(0xfe3)+_0x464371);const _0x4d0cd5=_0x5a8fb6[0x0];let _0x314037;try{_0x314037=JSON['parse'](_0x4d0cd5);}catch(_0x16b673){throw new Error(_0xf115ad(0x7a4)+_0x16b673[_0xf115ad(0x875)]+_0xf115ad(0xa01)+_0x464371);}_0x3b48a5[_0xf115ad(0x76c)]=_0x314037,await _0xa62efb['chats'][_0xf115ad(0x546)](_0x3b48a5),await _0xa41038();const _0x505d85={'role':_0xf115ad(0xab3),'content':_0xf115ad(0x74e),'timestamp':Date[_0xf115ad(0x9c1)](),'isHidden':!![]};_0x3b48a5[_0xf115ad(0xe83)][_0xf115ad(0x7dd)](_0x505d85),await _0xa62efb[_0xf115ad(0xaa3)]['put'](_0x3b48a5),_0x5403b5();}catch(_0x17fd3a){console['error'](_0xf115ad(0xc27),_0x17fd3a),await _0x184397('生成失败','无法生成模拟聊天记录，请检查API配置或稍后再试。\x0a错误:\x20'+_0x17fd3a[_0xf115ad(0x875)]);}}async function _0x255a32(){const _0x1d4612=_0x13d875;if(!_0x3f6485)return;const _0x24eda2=_0x53d851[_0x1d4612(0xaa3)][_0x3f6485];if(!_0x24eda2)return;try{const {proxyUrl:_0xe5fe60,apiKey:_0x48d8db,model:_0x31a77f}=_0x53d851[_0x1d4612(0x80d)];if(!_0xe5fe60||!_0x48d8db||!_0x31a77f)throw new Error('API未配置，无法生成对话。');const _0x1f56ea=parseInt(_0x24eda2[_0x1d4612(0x81e)][_0x1d4612(0x489)])||0xa,_0x283c0a=_0x24eda2['history'][_0x1d4612(0x1340)](-_0x1f56ea),_0x56b287=_0x24eda2[_0x1d4612(0x81e)]['myNickname']||'我',_0x5679ad=_0x24eda2[_0x1d4612(0x81e)][_0x1d4612(0xab1)]||'用户',_0x43ba09=_0x1d4612(0xa04)+(_0x24eda2['longTermMemory']&&_0x24eda2[_0x1d4612(0x1016)]['length']>0x0?_0x24eda2[_0x1d4612(0x1016)][_0x1d4612(0xcb4)](_0x196a77=>'-\x20'+_0x196a77[_0x1d4612(0x73e)])[_0x1d4612(0x2c8)]('\x0a'):_0x1d4612(0xddc));let _0x5367bf='';if(_0x24eda2['settings'][_0x1d4612(0x4ab)]&&_0x24eda2['settings'][_0x1d4612(0x4ab)][_0x1d4612(0x29d)]>0x0){const _0x2074a2=_0x24eda2[_0x1d4612(0x81e)][_0x1d4612(0x4ab)]['map'](_0x3bd00e=>{const _0x212796=_0x1d4612,_0x1cc33c=_0x53d851[_0x212796(0x10f2)][_0x212796(0x397)](_0x1f33fe=>_0x1f33fe['id']===_0x3bd00e);if(!_0x1cc33c||!Array[_0x212796(0xb31)](_0x1cc33c['content']))return'';const _0x23e7a1=_0x1cc33c[_0x212796(0x73e)][_0x212796(0x2dd)](_0xf78d1f=>_0xf78d1f[_0x212796(0xb3d)]!==![])[_0x212796(0xcb4)](_0x17d969=>_0x212796(0xbc5)+(_0x17d969[_0x212796(0x1445)]||_0x212796(0x4a4))+'\x0a**内容:**\x0a'+_0x17d969[_0x212796(0x73e)])[_0x212796(0x2c8)]('');return _0x23e7a1?'\x0a\x0a##\x20世界书:\x20'+_0x1cc33c['name']+'\x0a'+_0x23e7a1:'';})[_0x1d4612(0x2dd)](Boolean)[_0x1d4612(0x2c8)]('');_0x2074a2&&(_0x5367bf='\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a'+_0x2074a2+'\x0a');}const _0x327a34=_0x32a9cb(_0x24eda2,0x3,'hours'),_0x32e850=_0x32a9cb(_0x24eda2,0x6,_0x1d4612(0x81f)),_0x1042be=_0x32a9cb(_0x24eda2,0x9,_0x1d4612(0x81f)),_0x5bc9b8=_0x32a9cb(_0x24eda2,0x1,'days'),_0x130234=_0x32a9cb(_0x24eda2,0x3,_0x1d4612(0xc61)),_0x5d6d5e=_0x32a9cb(_0x24eda2,0x7,_0x1d4612(0xc61));let _0x522e9b='';if(_0x327a34||_0x32e850||_0x1042be||_0x5bc9b8||_0x130234||_0x5d6d5e){_0x522e9b+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x327a34)_0x522e9b+=_0x327a34;if(_0x32e850)_0x522e9b+=_0x32e850;if(_0x1042be)_0x522e9b+=_0x1042be;if(_0x327a34||_0x32e850||_0x1042be)_0x522e9b+='\x0a';if(_0x5bc9b8)_0x522e9b+=_0x5bc9b8;if(_0x130234)_0x522e9b+=_0x130234;if(_0x5d6d5e)_0x522e9b+=_0x5d6d5e;}const _0x5e263b=_0x25c7bd(_0x24eda2),_0x2139e5=_0x1d4612(0x723)+_0x24eda2[_0x1d4612(0x543)]+_0x1d4612(0xcf6)+_0x24eda2[_0x1d4612(0x81e)][_0x1d4612(0x1216)]+_0x1d4612(0x28e)+_0x5e263b+_0x1d4612(0x49d)+_0x5679ad+_0x1d4612(0x8dc)+_0x24eda2[_0x1d4612(0x543)]+_0x1d4612(0x13ee)+_0x56b287+'\x22\x0a'+_0x5367bf+'\x0a'+_0x43ba09+'\x0a'+_0x522e9b+_0x1d4612(0x3fe)+_0x283c0a[_0x1d4612(0xcb4)](_0x514d65=>(_0x514d65['role']===_0x1d4612(0x10ae)?_0x56b287:_0x24eda2['name'])+':\x20'+String(_0x514d65['content']))[_0x1d4612(0x2c8)]('\x0a')+_0x1d4612(0x108a),_0x4c6219=_0x283c0a[_0x1d4612(0xcb4)](_0x2c264c=>({'role':_0x2c264c[_0x1d4612(0xb4d)],'content':(_0x2c264c[_0x1d4612(0xb4d)]===_0x1d4612(0x10ae)?_0x56b287:_0x24eda2[_0x1d4612(0x234)])+':\x20'+String(_0x2c264c[_0x1d4612(0x73e)])}));let _0x3d6c93=_0xe5fe60[_0x1d4612(0x6e9)](_0x1d4612(0x1046)),_0x5b085d=_0x1697e7(_0x31a77f,_0x48d8db,_0x2139e5,_0x4c6219);const _0x208280=_0x3d6c93?await fetch(_0x5b085d['url'],_0x5b085d[_0x1d4612(0xd7c)]):await fetch(_0xe5fe60+_0x1d4612(0x434),{'method':'POST','headers':{'Content-Type':_0x1d4612(0x85b),'Authorization':'Bearer\x20'+_0x48d8db},'body':JSON[_0x1d4612(0xe1e)]({'model':_0x31a77f,'messages':[{'role':_0x1d4612(0xab3),'content':_0x2139e5},..._0x4c6219],'temperature':_0x53d851[_0x1d4612(0x906)]['apiTemperature']||0.8})});if(!_0x208280['ok'])throw new Error(_0x1d4612(0x509)+(await _0x208280[_0x1d4612(0xdc2)]())[_0x1d4612(0x617)]['message']);const _0x2bb9c4=await _0x208280[_0x1d4612(0xdc2)](),_0x9baf5e=getGeminiResponseText(_0x2bb9c4),_0x2460e3=_0x3e5855(_0x9baf5e);if(!_0x2460e3||_0x2460e3[_0x1d4612(0x29d)]===0x0)throw new Error(_0x1d4612(0xc93));let _0x455e55=0x0,_0x3ab852=Date['now']();for(const _0x45ebd2 of _0x2460e3){const _0x3e074a={'role':_0x1d4612(0xac5),'senderName':_0x24eda2['originalName'],'timestamp':_0x3ab852++};let _0x284b0d=null;switch(_0x45ebd2[_0x1d4612(0x919)]){case _0x1d4612(0x2e6):_0x284b0d={..._0x3e074a,'content':String(_0x45ebd2[_0x1d4612(0x73e)]||_0x45ebd2[_0x1d4612(0x875)])};break;case'sticker':if(_0x45ebd2['meaning']){const _0x1572a5=_0x53d851[_0x1d4612(0xf8f)][_0x1d4612(0x397)](_0x24628f=>_0x24628f[_0x1d4612(0x234)]===_0x45ebd2['meaning']);_0x1572a5?_0x284b0d={..._0x3e074a,'type':_0x1d4612(0x257),'content':_0x1572a5[_0x1d4612(0xb36)],'meaning':_0x1572a5['name']}:(console[_0x1d4612(0xad0)]('AI\x20(CPhone)\x20尝试使用一个不存在的表情:\x20\x22'+_0x45ebd2[_0x1d4612(0x75f)]+'\x22'),_0x284b0d={..._0x3e074a,'type':'text','content':_0x1d4612(0x6b1)+_0x45ebd2[_0x1d4612(0x75f)]+']'});}else console[_0x1d4612(0xad0)](_0x1d4612(0x10fc),_0x45ebd2),_0x284b0d={..._0x3e074a,'type':'sticker','content':_0x45ebd2[_0x1d4612(0xb36)],'meaning':'未知表情'};break;}_0x284b0d&&(_0x24eda2[_0x1d4612(0xe83)][_0x1d4612(0x7dd)](_0x284b0d),_0x455e55++);}_0x455e55>0x0&&(_0x24eda2[_0x1d4612(0x8ce)]=(_0x24eda2[_0x1d4612(0x8ce)]||0x0)+_0x455e55),await _0xa62efb[_0x1d4612(0xaa3)][_0x1d4612(0x546)](_0x24eda2),await _0x5001a4(),_0x455e55>0x0&&_0x23d2a1(_0x24eda2['id'],_0x1d4612(0xce5)+_0x455e55+'\x20条新消息');}catch(_0x4f8b8b){console[_0x1d4612(0x617)]('从CPhone推进真实对话失败:',_0x4f8b8b),await _0x184397(_0x1d4612(0xeac),_0x1d4612(0xbb9)+_0x4f8b8b[_0x1d4612(0x875)]);}}async function _0xc2741f(){const _0x2428e9=_0x13d875;if(_0x2b250e||!_0x3f6485)return;_0x2b250e=!![];const _0x428e52=document[_0x2428e9(0x53a)]('char-conversation-messages'),_0x12c319=_0x53d851[_0x2428e9(0xaa3)][_0x3f6485];if(!_0x12c319){_0x2b250e=![];return;}_0x1e432c(_0x428e52,'top');const _0x3cc177=_0x428e52[_0x2428e9(0xaae)];await new Promise(_0x1b6c3a=>setTimeout(_0x1b6c3a,0x1f4));const _0x4a4f90=_0x12c319[_0x2428e9(0xe83)]['length'],_0x3d6acf=_0x53d851['globalSettings']['chatRenderWindow']||0x32,_0x56e5a3=_0x4a4f90-_0x299341,_0x58b316=Math[_0x2428e9(0x69b)](0x0,_0x56e5a3-_0x3d6acf),_0x5a2cf2=_0x12c319['history'][_0x2428e9(0x1340)](_0x58b316,_0x56e5a3);_0x41b779(_0x428e52);if(_0x5a2cf2[_0x2428e9(0x29d)]===0x0){_0x2b250e=![];return;}for(const _0x4b9c69 of _0x5a2cf2[_0x2428e9(0x843)]()){const _0x1c7b59={..._0x4b9c69,'role':_0x4b9c69[_0x2428e9(0xb4d)]==='user'?_0x2428e9(0xac5):_0x2428e9(0x10ae)},_0x59be85={'id':_0x2428e9(0xf67),'isGroup':![],'name':_0x12c319['name'],'settings':{..._0x12c319[_0x2428e9(0x81e)],'myAvatar':_0x12c319[_0x2428e9(0x81e)][_0x2428e9(0x9e3)],'myAvatarFrame':_0x12c319[_0x2428e9(0x81e)][_0x2428e9(0x2bf)],'aiAvatar':_0x12c319[_0x2428e9(0x81e)]['myAvatar'],'aiAvatarFrame':_0x12c319[_0x2428e9(0x81e)][_0x2428e9(0xf77)]}},_0x188fbc=await _0x36bd8d(_0x1c7b59,_0x59be85);_0x188fbc&&_0x428e52[_0x2428e9(0x860)](_0x188fbc);}_0x299341+=_0x5a2cf2[_0x2428e9(0x29d)];const _0x5a7ae9=_0x428e52['scrollHeight'];_0x428e52[_0x2428e9(0xf68)]=_0x5a7ae9-_0x3cc177,_0x2b250e=![];}async function _0x2c6f48(_0x4736dc){const _0x1a36e5=_0x13d875,_0x5ddae7=_0x53d851[_0x1a36e5(0xaa3)][_0x3f6485];if(!_0x5ddae7)return;_0x2ad3f2=_0x4736dc===-0x1?'private_user':_0x5ddae7[_0x1a36e5(0x76c)][_0x4736dc]?.['type'];const _0x5a9548=document[_0x1a36e5(0x53a)]('char-conversation-messages');_0x5a9548[_0x1a36e5(0xaac)]='',_0x5a9548[_0x1a36e5(0x999)]['theme']=_0x5ddae7[_0x1a36e5(0x81e)]['theme']||_0x1a36e5(0xce2);const _0x33f10a=document[_0x1a36e5(0x53a)](_0x1a36e5(0xf87))[_0x1a36e5(0x1276)][_0x1a36e5(0x6a3)](_0x1a36e5(0xfb9));_0x5a9548[_0x1a36e5(0x1284)]['backgroundColor']=_0x33f10a?_0x1a36e5(0x8f6):_0x1a36e5(0xd5a);let _0x404fa9,_0x23072d=[];const _0x682266=await _0xa62efb[_0x1a36e5(0x5b7)][_0x1a36e5(0xa73)](),_0x255b13=new Map(_0x682266[_0x1a36e5(0xcb4)](_0x48b467=>[_0x48b467['name'],_0x48b467]));if(_0x4736dc===-0x1){_0x2ad3f2=_0x1a36e5(0xead);const _0x2e3d4a=document['getElementById']('char-conversation-partner-name'),_0x46ab2e=document[_0x1a36e5(0x53a)](_0x1a36e5(0xe2d));_0x5a9548[_0x1a36e5(0xaac)]='',_0x2e3d4a[_0x1a36e5(0x34a)]=_0x5ddae7['settings'][_0x1a36e5(0x1303)]||(_0x53d851[_0x1a36e5(0xa74)][_0x1a36e5(0x1005)]||'我'),_0x46ab2e[_0x1a36e5(0x140d)]='与\x20'+(_0x5ddae7[_0x1a36e5(0x81e)][_0x1a36e5(0x1303)]||'我')+_0x1a36e5(0x4aa),_0x299341=0x0,_0x2b250e=![];const _0x2e6d19=_0x5ddae7['history'],_0x432361=_0x53d851['globalSettings'][_0x1a36e5(0xcfe)]||0x32,_0x217d50=_0x2e6d19[_0x1a36e5(0x1340)](-_0x432361);_0x404fa9={'id':_0x1a36e5(0xf67),'isGroup':![],'name':_0x5ddae7['name'],'settings':{..._0x5ddae7[_0x1a36e5(0x81e)],'myAvatar':_0x5ddae7['settings']['aiAvatar'],'myAvatarFrame':_0x5ddae7[_0x1a36e5(0x81e)][_0x1a36e5(0x2bf)],'aiAvatar':_0x5ddae7[_0x1a36e5(0x81e)]['myAvatar'],'aiAvatarFrame':_0x5ddae7[_0x1a36e5(0x81e)][_0x1a36e5(0xf77)]}},_0x23072d=_0x217d50['map'](_0x45b29b=>({..._0x45b29b,'role':_0x45b29b[_0x1a36e5(0xb4d)]===_0x1a36e5(0x10ae)?'assistant':'user'})),_0x299341=_0x217d50[_0x1a36e5(0x29d)];}else{const _0xd0030b=_0x5ddae7[_0x1a36e5(0x76c)][_0x4736dc];if(!_0xd0030b)return;_0x2ad3f2=_0xd0030b[_0x1a36e5(0x919)];const _0x2d671b=document[_0x1a36e5(0x53a)](_0x1a36e5(0x223)),_0x12c906=document[_0x1a36e5(0x53a)](_0x1a36e5(0xe2d));if(_0xd0030b[_0x1a36e5(0x919)]===_0x1a36e5(0x1048))_0x2d671b[_0x1a36e5(0x34a)]=_0xd0030b[_0x1a36e5(0x5f8)]+'\x20('+(_0xd0030b[_0x1a36e5(0x574)][_0x1a36e5(0x29d)]+0x1)+')',_0x12c906[_0x1a36e5(0x140d)]='在\x20'+_0xd0030b[_0x1a36e5(0x5f8)]+_0x1a36e5(0x1409),_0x404fa9={'id':_0x1a36e5(0x1dc),'isGroup':!![],'name':_0xd0030b[_0x1a36e5(0x5f8)],'originalName':_0x5ddae7[_0x1a36e5(0x543)],'members':_0xd0030b[_0x1a36e5(0x574)][_0x1a36e5(0xcb4)](_0x2c0272=>{const _0x91122f=_0x1a36e5,_0x30fbb5=_0x255b13[_0x91122f(0x883)](_0x2c0272[_0x91122f(0x234)]);let _0x2ee055=_0x30fbb5&&_0x30fbb5['avatar']?_0x30fbb5[_0x91122f(0x8cd)]:_0x53d851[_0x91122f(0x906)][_0x91122f(0x128d)]?_0x91122f(0x9ce)+encodeURIComponent(_0x2c0272[_0x91122f(0x122f)]||'anime\x20person'):_0x434592;return{'originalName':_0x2c0272[_0x91122f(0x234)],'groupNickname':_0x2c0272[_0x91122f(0x234)],'avatar':_0x2ee055};}),'settings':{..._0x5ddae7['settings'],'myNickname':_0x5ddae7[_0x1a36e5(0x234)],'myAvatar':_0x5ddae7[_0x1a36e5(0x81e)][_0x1a36e5(0x9e3)],'myAvatarFrame':_0x5ddae7[_0x1a36e5(0x81e)]['aiAvatarFrame']}};else{_0x2d671b['textContent']=_0xd0030b[_0x1a36e5(0x102a)][_0x1a36e5(0x234)],_0x12c906[_0x1a36e5(0x140d)]='与\x20'+_0xd0030b[_0x1a36e5(0x102a)][_0x1a36e5(0x234)]+_0x1a36e5(0x374);const _0x987314=_0x255b13[_0x1a36e5(0x883)](_0xd0030b[_0x1a36e5(0x102a)][_0x1a36e5(0x234)]),_0x10ae56=_0x987314&&_0x987314[_0x1a36e5(0x8cd)]?_0x987314['avatar']:_0x53d851['globalSettings']['enableAiDrawing']?'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0xd0030b[_0x1a36e5(0x102a)]['avatar_prompt']||'anime\x20person'):_0x434592;_0x404fa9={'id':_0x1a36e5(0xf82),'isGroup':![],'name':_0xd0030b['participant'][_0x1a36e5(0x234)],'originalName':_0x5ddae7[_0x1a36e5(0x543)],'settings':{..._0x5ddae7[_0x1a36e5(0x81e)],'myAvatar':_0x5ddae7[_0x1a36e5(0x81e)][_0x1a36e5(0x9e3)],'myAvatarFrame':_0x5ddae7[_0x1a36e5(0x81e)]['aiAvatarFrame'],'aiAvatar':_0x10ae56,'aiAvatarFrame':''}};}_0x23072d=_0xd0030b[_0x1a36e5(0x109c)];}for(const _0x324aed of _0x23072d){let _0xa4df69=_0x324aed[_0x1a36e5(0xb4d)];if(_0x4736dc!==-0x1){const _0x336a90=_0x324aed[_0x1a36e5(0x36d)]===(_0x5ddae7[_0x1a36e5(0x543)]||_0x5ddae7[_0x1a36e5(0x234)]);_0xa4df69=_0x336a90?_0x1a36e5(0x10ae):'assistant';}const _0x337324={'role':_0xa4df69,'senderName':_0x324aed[_0x1a36e5(0x36d)]||(_0xa4df69==='user'?_0x404fa9['settings'][_0x1a36e5(0x1303)]:_0x404fa9['name']),'timestamp':_0x324aed[_0x1a36e5(0x827)]||Date[_0x1a36e5(0x9c1)]()+Math[_0x1a36e5(0xac4)]()};if(_0x324aed['type']==='sticker'&&_0x324aed['meaning']){const _0x55ab92=_0x53d851[_0x1a36e5(0xf8f)][_0x1a36e5(0x397)](_0x202e15=>_0x202e15[_0x1a36e5(0x234)]===_0x324aed[_0x1a36e5(0x75f)]);_0x55ab92?(_0x337324[_0x1a36e5(0x73e)]=_0x55ab92[_0x1a36e5(0xb36)],_0x337324[_0x1a36e5(0x75f)]=_0x324aed[_0x1a36e5(0x75f)],_0x337324['type']='sticker'):(console['warn'](_0x1a36e5(0x221)+_0x324aed['meaning']+_0x1a36e5(0x98f)),_0x337324[_0x1a36e5(0x73e)]=_0x1a36e5(0x6b1)+_0x324aed[_0x1a36e5(0x75f)]+']',_0x337324[_0x1a36e5(0x919)]='text');}else _0x337324['content']=_0x324aed[_0x1a36e5(0x73e)],_0x337324[_0x1a36e5(0x919)]=_0x324aed[_0x1a36e5(0x919)]||_0x1a36e5(0x2e6);const _0x59b34e=await _0x36bd8d(_0x337324,_0x404fa9);_0x59b34e&&_0x5a9548[_0x1a36e5(0x133d)](_0x59b34e);}_0x1805e5(_0x1a36e5(0x3e7)),setTimeout(()=>_0x5a9548['scrollTop']=_0x5a9548[_0x1a36e5(0xaae)],0x0);}function _0x2af984(){const _0x23d066=_0x13d875;document[_0x23d066(0x53a)](_0x23d066(0xed9))[_0x23d066(0x1276)][_0x23d066(0x2d4)](_0x23d066(0xaef));}async function _0x114317(){const _0x9fb4bd=_0x13d875;if(!_0x3f6485)return;const _0x5e9446=_0x53d851[_0x9fb4bd(0xaa3)][_0x3f6485];if(!_0x5e9446){await _0x184397('操作失败',_0x9fb4bd(0x91a));return;}await _0x184397(_0x9fb4bd(0x11d7),_0x9fb4bd(0x217)+_0x5e9446[_0x9fb4bd(0x234)]+_0x9fb4bd(0x12d7));const {proxyUrl:_0x47762a,apiKey:_0x5df0d5,model:_0x29249f}=_0x53d851[_0x9fb4bd(0x80d)];if(!_0x47762a||!_0x5df0d5||!_0x29249f){alert(_0x9fb4bd(0x3ed));return;}const _0xc7fc9=_0x53d851[_0x9fb4bd(0xa74)][_0x9fb4bd(0x1005)]===_0x9fb4bd(0x8ac)||!_0x53d851[_0x9fb4bd(0xa74)][_0x9fb4bd(0x1005)]?'用户':_0x53d851['qzoneSettings'][_0x9fb4bd(0x1005)],_0x25c600=_0x5e9446[_0x9fb4bd(0x1016)]&&_0x5e9446[_0x9fb4bd(0x1016)][_0x9fb4bd(0x29d)]>0x0?_0x5e9446['longTermMemory'][_0x9fb4bd(0xcb4)](_0x587aa2=>_0x9fb4bd(0xd87)+_0x272f9c(_0x587aa2['timestamp'])+')\x20'+_0x587aa2[_0x9fb4bd(0x73e)])['join']('\x0a'):'无',_0x3c5b39=_0x5e9446['settings'][_0x9fb4bd(0x489)]||0xa,_0x486ec9=_0x5e9446[_0x9fb4bd(0xe83)]['slice'](-_0x3c5b39)[_0x9fb4bd(0xcb4)](_0x566b4b=>(_0x566b4b[_0x9fb4bd(0xb4d)]===_0x9fb4bd(0x10ae)?_0xc7fc9:_0x5e9446[_0x9fb4bd(0x234)])+':\x20'+String(_0x566b4b[_0x9fb4bd(0x73e)])[_0x9fb4bd(0xad6)](0x0,0x1e)+_0x9fb4bd(0x95d))['join']('\x0a'),_0x4e3801=(_0x5e9446[_0x9fb4bd(0x81e)][_0x9fb4bd(0x4ab)]||[])['map'](_0x2f7ed5=>_0x53d851['worldBooks'][_0x9fb4bd(0x397)](_0x2bb377=>_0x2bb377['id']===_0x2f7ed5))[_0x9fb4bd(0x2dd)](Boolean)[_0x9fb4bd(0xcb4)](_0x1ee019=>_0x9fb4bd(0x474)+_0x1ee019[_0x9fb4bd(0x234)]+_0x9fb4bd(0xd29)+_0x1ee019[_0x9fb4bd(0x73e)][_0x9fb4bd(0x2dd)](_0x2b1959=>_0x2b1959[_0x9fb4bd(0xb3d)])[_0x9fb4bd(0xcb4)](_0x19c864=>'-\x20'+_0x19c864['content'])[_0x9fb4bd(0x2c8)]('\x0a'))[_0x9fb4bd(0x2c8)](''),_0x54a12e=_0x32a9cb(_0x5e9446,0x3,_0x9fb4bd(0x81f)),_0x45e1cb=_0x32a9cb(_0x5e9446,0x6,'hours'),_0xcce09b=_0x32a9cb(_0x5e9446,0x9,_0x9fb4bd(0x81f)),_0x2298e8=_0x32a9cb(_0x5e9446,0x1,_0x9fb4bd(0xc61)),_0x31490b=_0x32a9cb(_0x5e9446,0x3,_0x9fb4bd(0xc61)),_0x5af160=_0x32a9cb(_0x5e9446,0x7,_0x9fb4bd(0xc61));let _0x2312f2='';if(_0x54a12e||_0x45e1cb||_0xcce09b||_0x2298e8||_0x31490b||_0x5af160){_0x2312f2+=_0x9fb4bd(0xb9a);if(_0x54a12e)_0x2312f2+=_0x54a12e;if(_0x45e1cb)_0x2312f2+=_0x45e1cb;if(_0xcce09b)_0x2312f2+=_0xcce09b;if(_0x54a12e||_0x45e1cb||_0xcce09b)_0x2312f2+='\x0a';if(_0x2298e8)_0x2312f2+=_0x2298e8;if(_0x31490b)_0x2312f2+=_0x31490b;if(_0x5af160)_0x2312f2+=_0x5af160;}const _0x4d76b7=_0x9fb4bd(0x366)+_0x5e9446['name']+_0x9fb4bd(0x6c3)+_0x5e9446[_0x9fb4bd(0x81e)]['aiPersona']+'\x0a'+_0x25c600+'\x0a'+_0x4e3801+'\x0a'+_0x2312f2+_0x9fb4bd(0x513)+_0xc7fc9+_0x9fb4bd(0x294)+_0x486ec9+_0x9fb4bd(0x65b);try{const _0x3f0148=[{'role':_0x9fb4bd(0x10ae),'content':_0x9fb4bd(0xbf7)}];let _0x2c15be=_0x47762a[_0x9fb4bd(0x6e9)](_0x9fb4bd(0x1046)),_0x5b3926=_0x1697e7(_0x29249f,_0x5df0d5,_0x4d76b7,_0x3f0148);const _0x18a02f=_0x2c15be?await fetch(_0x5b3926['url'],_0x5b3926[_0x9fb4bd(0xd7c)]):await fetch(_0x47762a+_0x9fb4bd(0x434),{'method':_0x9fb4bd(0xa4e),'headers':{'Content-Type':_0x9fb4bd(0x85b),'Authorization':_0x9fb4bd(0x841)+_0x5df0d5},'body':JSON['stringify']({'model':_0x29249f,'messages':[{'role':_0x9fb4bd(0xab3),'content':_0x4d76b7},..._0x3f0148],'temperature':_0x53d851[_0x9fb4bd(0x906)][_0x9fb4bd(0xaf8)]||0.9})});if(!_0x18a02f['ok'])throw new Error(_0x9fb4bd(0x352)+_0x18a02f['statusText']);const _0xaa1089=await _0x18a02f['json'](),_0x1c4df7=getGeminiResponseText(_0xaa1089),_0x3f27d5=_0x1c4df7[_0x9fb4bd(0x1120)](/(\[[\s\S]*\])/);if(!_0x3f27d5||!_0x3f27d5[0x0])throw new Error(_0x9fb4bd(0xfe3)+_0x1c4df7);const _0x5a38dc=_0x3f27d5[0x0];let _0x1b5fc7;try{_0x1b5fc7=JSON[_0x9fb4bd(0x367)](_0x5a38dc);}catch(_0xbe8b99){throw new Error(_0x9fb4bd(0x7a4)+_0xbe8b99[_0x9fb4bd(0x875)]+_0x9fb4bd(0xa01)+_0x1c4df7);}_0x5e9446[_0x9fb4bd(0xa17)]=_0x1b5fc7,await _0xa62efb[_0x9fb4bd(0xaa3)][_0x9fb4bd(0x546)](_0x5e9446),await _0x67fdf1();}catch(_0x1e5e44){console['error']('生成模拟相册失败:',_0x1e5e44),await _0x184397(_0x9fb4bd(0x3eb),_0x9fb4bd(0x57b)+_0x1e5e44['message']);}}async function _0x67fdf1(){const _0x2fc4d6=_0x13d875,_0x481570=document[_0x2fc4d6(0x53a)](_0x2fc4d6(0x1e1));_0x481570[_0x2fc4d6(0xaac)]='';if(!_0x3f6485)return;const _0x2d0155=_0x53d851[_0x2fc4d6(0xaa3)][_0x3f6485],_0x3108cd=_0x2d0155[_0x2fc4d6(0xa17)]||[];if(_0x3108cd[_0x2fc4d6(0x29d)]===0x0){_0x481570['innerHTML']=_0x2fc4d6(0x11ac);return;}const _0x216792=_0x2fc4d6(0xbbd);_0x3108cd[_0x2fc4d6(0xeaf)](_0x5ce9ae=>{const _0x12682f=_0x2fc4d6,_0x1e48ab=document[_0x12682f(0xd67)](_0x12682f(0x1425));_0x1e48ab[_0x12682f(0x6de)]='char-photo-item',_0x1e48ab[_0x12682f(0x999)]['description']=_0x5ce9ae[_0x12682f(0xa60)],_0x481570[_0x12682f(0x133d)](_0x1e48ab);if(_0x53d851[_0x12682f(0x906)][_0x12682f(0x128d)]){_0x1e48ab[_0x12682f(0x1284)][_0x12682f(0x615)]=_0x12682f(0x42d);const _0x36a83f=/[^\x00-\x7F]/[_0x12682f(0x7f2)](_0x5ce9ae[_0x12682f(0xadb)]),_0x36b9f2=_0x5ce9ae[_0x12682f(0xadb)]&&_0x5ce9ae[_0x12682f(0xadb)]['trim']()&&!_0x36a83f,_0x47f0cd=_0x36b9f2?_0x5ce9ae[_0x12682f(0xadb)]:'a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting',_0x372bac=_0x12682f(0x9ce)+encodeURIComponent(_0x47f0cd),_0x4f752d=new Image();_0x4f752d[_0x12682f(0x110f)]=function(){const _0xe420da=_0x12682f;_0x1e48ab['style'][_0xe420da(0x2f2)]=_0xe420da(0xf22)+this['src']+')';},_0x4f752d[_0x12682f(0xdcc)]=function(){const _0x501d12=_0x12682f;_0x1e48ab[_0x501d12(0x1284)][_0x501d12(0x2f2)]=_0x501d12(0xf22)+_0x216792+')';},_0x4f752d[_0x12682f(0x7ff)]=_0x372bac;}else{_0x1e48ab[_0x12682f(0x1284)]['backgroundColor']=_0x12682f(0xd5a),_0x1e48ab['style'][_0x12682f(0xb24)]=_0x12682f(0x1229);const _0x5dcd18=document[_0x12682f(0xd67)]('p');_0x5dcd18[_0x12682f(0x6de)]='char-photo-description',_0x5dcd18[_0x12682f(0x34a)]=_0x5ce9ae[_0x12682f(0xa60)]||_0x12682f(0x7c2),_0x1e48ab[_0x12682f(0x133d)](_0x5dcd18);}});}async function _0x54689f(){const _0x528681=_0x13d875;if(!_0x3f6485)return;const _0x39f8bf=_0x53d851[_0x528681(0xaa3)][_0x3f6485];if(!_0x39f8bf)return;await _0x184397('请稍候...',_0x528681(0x2fa)+_0x39f8bf[_0x528681(0x234)]+'”的网上冲浪足迹...');const {proxyUrl:_0x22dcd7,apiKey:_0x8622ee,model:_0x4811bf}=_0x53d851['apiConfig'];if(!_0x22dcd7||!_0x8622ee||!_0x4811bf){alert(_0x528681(0x69f));return;}const _0x556089=_0x53d851[_0x528681(0xa74)]['nickname']===_0x528681(0x8ac)||!_0x53d851[_0x528681(0xa74)][_0x528681(0x1005)]?'用户':_0x53d851[_0x528681(0xa74)][_0x528681(0x1005)],_0x826af9=_0x39f8bf[_0x528681(0x1016)]&&_0x39f8bf[_0x528681(0x1016)][_0x528681(0x29d)]>0x0?_0x39f8bf[_0x528681(0x1016)]['map'](_0xa62a50=>_0x528681(0xd87)+_0x272f9c(_0xa62a50[_0x528681(0x827)])+')\x20'+_0xa62a50[_0x528681(0x73e)])[_0x528681(0x2c8)]('\x0a'):'无',_0x243dbf=_0x39f8bf['settings'][_0x528681(0x489)]||0xa,_0x396e1a=_0x39f8bf[_0x528681(0xe83)][_0x528681(0x1340)](-_0x243dbf)[_0x528681(0xcb4)](_0x457215=>(_0x457215[_0x528681(0xb4d)]===_0x528681(0x10ae)?_0x556089:_0x39f8bf[_0x528681(0x234)])+':\x20'+String(_0x457215[_0x528681(0x73e)])['substring'](0x0,0x1e)+_0x528681(0x95d))[_0x528681(0x2c8)]('\x0a'),_0x4a72b3=(_0x39f8bf['settings'][_0x528681(0x4ab)]||[])['map'](_0x4000b2=>_0x53d851[_0x528681(0x10f2)][_0x528681(0x397)](_0x480ffd=>_0x480ffd['id']===_0x4000b2))[_0x528681(0x2dd)](Boolean)['map'](_0x35e065=>'\x0a##\x20世界书《'+_0x35e065[_0x528681(0x234)]+_0x528681(0xd29)+_0x35e065[_0x528681(0x73e)][_0x528681(0x2dd)](_0x3c79a6=>_0x3c79a6[_0x528681(0xb3d)])[_0x528681(0xcb4)](_0x25d8f5=>'-\x20'+_0x25d8f5[_0x528681(0x73e)])[_0x528681(0x2c8)]('\x0a'))['join'](''),_0x69ec2f=_0x32a9cb(_0x39f8bf,0x3,_0x528681(0x81f)),_0x5185e6=_0x32a9cb(_0x39f8bf,0x6,_0x528681(0x81f)),_0x218538=_0x32a9cb(_0x39f8bf,0x9,_0x528681(0x81f)),_0x475862=_0x32a9cb(_0x39f8bf,0x1,_0x528681(0xc61)),_0x6885ee=_0x32a9cb(_0x39f8bf,0x3,_0x528681(0xc61)),_0x3ad3c8=_0x32a9cb(_0x39f8bf,0x7,_0x528681(0xc61));let _0x5a762b='';if(_0x69ec2f||_0x5185e6||_0x218538||_0x475862||_0x6885ee||_0x3ad3c8){_0x5a762b+=_0x528681(0xb9a);if(_0x69ec2f)_0x5a762b+=_0x69ec2f;if(_0x5185e6)_0x5a762b+=_0x5185e6;if(_0x218538)_0x5a762b+=_0x218538;if(_0x69ec2f||_0x5185e6||_0x218538)_0x5a762b+='\x0a';if(_0x475862)_0x5a762b+=_0x475862;if(_0x6885ee)_0x5a762b+=_0x6885ee;if(_0x3ad3c8)_0x5a762b+=_0x3ad3c8;}const _0x51b40e=_0x39f8bf[_0x528681(0x81e)][_0x528681(0xab1)]||'(未设置)',_0x1b2b91=_0x528681(0x366)+_0x39f8bf[_0x528681(0x234)]+_0x528681(0x250)+_0x39f8bf[_0x528681(0x81e)][_0x528681(0x1216)]+_0x528681(0xa84)+_0x51b40e+_0x528681(0x6cf)+_0x826af9+'\x0a'+_0x4a72b3+'\x0a'+_0x5a762b+'\x20\x0a-\x20**你最近和“'+_0x556089+_0x528681(0x294)+_0x396e1a+_0x528681(0x542);try{const _0x1a7cd6=[{'role':_0x528681(0x10ae),'content':_0x528681(0x8e7)}];let _0x1d423b=_0x22dcd7[_0x528681(0x6e9)](_0x528681(0x1046)),_0x566207=_0x1697e7(_0x4811bf,_0x8622ee,_0x1b2b91,_0x1a7cd6);const _0x2aa219=_0x1d423b?await fetch(_0x566207['url'],_0x566207[_0x528681(0xd7c)]):await fetch(_0x22dcd7+_0x528681(0x434),{'method':'POST','headers':{'Content-Type':_0x528681(0x85b),'Authorization':_0x528681(0x841)+_0x8622ee},'body':JSON[_0x528681(0xe1e)]({'model':_0x4811bf,'messages':[{'role':'system','content':_0x1b2b91},..._0x1a7cd6],'temperature':_0x53d851[_0x528681(0x906)][_0x528681(0xaf8)]||0.9})});if(!_0x2aa219['ok'])throw new Error(_0x528681(0x352)+_0x2aa219[_0x528681(0x5c1)]);const _0x17e6e8=await _0x2aa219['json'](),_0x5d8825=getGeminiResponseText(_0x17e6e8),_0xd92699=_0x5d8825[_0x528681(0x1120)](/(\[[\s\S]*\])/);if(!_0xd92699||!_0xd92699[0x0])throw new Error(_0x528681(0xfe3)+_0x5d8825);const _0x3081cc=_0xd92699[0x0];let _0x1bcb04;try{_0x1bcb04=JSON[_0x528681(0x367)](_0x3081cc);}catch(_0x56a4db){throw new Error(_0x528681(0x7a4)+_0x56a4db[_0x528681(0x875)]+_0x528681(0xa01)+_0x5d8825);}_0x39f8bf[_0x528681(0x241)]=_0x1bcb04,await _0xa62efb['chats'][_0x528681(0x546)](_0x39f8bf),await _0x4572ac();}catch(_0x10cb0b){console[_0x528681(0x617)](_0x528681(0x1212),_0x10cb0b),await _0x184397('生成失败',_0x528681(0x2cf)+_0x10cb0b[_0x528681(0x875)]);}}function _0x4572ac(){const _0x35f06d=_0x13d875,_0xac8b5=document['getElementById'](_0x35f06d(0xe53));_0xac8b5['innerHTML']='';if(!_0x3f6485)return;const _0x308d08=_0x53d851[_0x35f06d(0xaa3)][_0x3f6485],_0x5859df=_0x308d08[_0x35f06d(0x241)]||[];if(_0x5859df['length']===0x0){_0xac8b5['innerHTML']=_0x35f06d(0xc64);return;}_0x5859df[_0x35f06d(0xeaf)]((_0x4ab06e,_0x5dc728)=>{const _0x44adce=_0x35f06d,_0x31de19=document[_0x44adce(0xd67)](_0x44adce(0x1425));_0x31de19['className']=_0x44adce(0x8ca),_0x31de19[_0x44adce(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0x4ab06e[_0x44adce(0x667)]+_0x44adce(0x102c)+_0x4ab06e['url']+_0x44adce(0xca8),_0x31de19[_0x44adce(0x1086)](_0x44adce(0xb2b),()=>_0x18de37(_0x5dc728)),_0xac8b5['appendChild'](_0x31de19);});}async function _0x18de37(_0x45d2c4){const _0x408eff=_0x13d875,_0x1aa746=_0x53d851[_0x408eff(0xaa3)][_0x3f6485],_0x46a5af=_0x1aa746[_0x408eff(0x241)][_0x45d2c4];if(!_0x46a5af)return;_0xcb6686=_0x46a5af,_0x1e85da(_0x46a5af),_0x1805e5(_0x408eff(0xb00));const _0x3dd6e0=document['getElementById'](_0x408eff(0x874)),_0x278593=await _0xa62efb['favorites']['where']({'type':'char_browser_article','content.url':_0x46a5af[_0x408eff(0xb36)]})[_0x408eff(0x7e6)]();_0x3dd6e0[_0x408eff(0x1276)][_0x408eff(0x4d7)](_0x408eff(0xdf6),!!_0x278593);}async function _0x41d557(){const _0x4c792e=_0x13d875;if(!_0xcb6686||!_0x3f6485)return;const _0x1e400f=_0xcb6686,_0x507dde=_0x53d851[_0x4c792e(0xaa3)][_0x3f6485],_0x3e0036=document[_0x4c792e(0x53a)](_0x4c792e(0x874)),_0x522ccf=await _0xa62efb[_0x4c792e(0xb51)][_0x4c792e(0x57e)]({'type':'char_browser_article','content.url':_0x1e400f[_0x4c792e(0xb36)]})[_0x4c792e(0x7e6)]();if(_0x522ccf)await _0xa62efb[_0x4c792e(0xb51)][_0x4c792e(0x121e)](_0x522ccf['id']),_0x3e0036['classList'][_0x4c792e(0x2d4)]('active'),await _0x184397(_0x4c792e(0xfd5),_0x4c792e(0xda1));else{const _0x3cf550={'type':_0x4c792e(0x130e),'content':{..._0x1e400f,'characterId':_0x3f6485,'characterName':_0x507dde['name']},'timestamp':Date[_0x4c792e(0x9c1)]()};await _0xa62efb[_0x4c792e(0xb51)][_0x4c792e(0xe13)](_0x3cf550),_0x3e0036['classList']['add'](_0x4c792e(0xdf6)),await _0x184397(_0x4c792e(0xfd5),_0x4c792e(0x452));}}function _0x1e85da(_0xf77159){const _0x2c7e07=_0x13d875,_0x5018a2=document['getElementById'](_0x2c7e07(0xdac)),_0x1851e0=document['getElementById'](_0x2c7e07(0xde6));_0x5018a2[_0x2c7e07(0x34a)]=_0xf77159['title'],_0x1851e0[_0x2c7e07(0xaac)]='',_0xf77159['type']===_0x2c7e07(0xace)?_0x1851e0[_0x2c7e07(0xaac)]='<p\x20class=\x22char-browser-image-description\x22>'+(_0xf77159[_0x2c7e07(0x667)]||_0x2c7e07(0x839))+'</p>':_0x1851e0['innerHTML']=_0x2c7e07(0xb1a)+(_0xf77159[_0x2c7e07(0x73e)]||'内容加载失败...')[_0x2c7e07(0x795)](/\n/g,_0x2c7e07(0xeee))+_0x2c7e07(0x12e2);}async function _0x531d45(){const _0x4ff62a=_0x13d875;if(!_0x3f6485)return;const _0x3bd7c3=_0x53d851['chats'][_0x3f6485];if(!_0x3bd7c3)return;await _0x184397(_0x4ff62a(0x11d7),_0x4ff62a(0x2fa)+_0x3bd7c3[_0x4ff62a(0x234)]+_0x4ff62a(0xdef));const {proxyUrl:_0x4653b6,apiKey:_0x3ccd1c,model:_0x31210c}=_0x53d851[_0x4ff62a(0x80d)];if(!_0x4653b6||!_0x3ccd1c||!_0x31210c){alert('API未配置，无法生成内容。');return;}const _0x47d1f4=_0x53d851['qzoneSettings']['nickname']==='{{user}}'||!_0x53d851['qzoneSettings'][_0x4ff62a(0x1005)]?'用户':_0x53d851[_0x4ff62a(0xa74)][_0x4ff62a(0x1005)],_0x5b6281=_0x3bd7c3[_0x4ff62a(0x1016)]&&_0x3bd7c3[_0x4ff62a(0x1016)][_0x4ff62a(0x29d)]>0x0?_0x3bd7c3[_0x4ff62a(0x1016)]['map'](_0x13c36d=>_0x4ff62a(0xd87)+_0x272f9c(_0x13c36d[_0x4ff62a(0x827)])+')\x20'+_0x13c36d['content'])[_0x4ff62a(0x2c8)]('\x0a'):'无',_0x4a42ba=_0x3bd7c3[_0x4ff62a(0x81e)][_0x4ff62a(0x489)]||0xa,_0x3bd7c6=_0x3bd7c3[_0x4ff62a(0xe83)][_0x4ff62a(0x1340)](-_0x4a42ba)[_0x4ff62a(0xcb4)](_0x32ec97=>(_0x32ec97[_0x4ff62a(0xb4d)]===_0x4ff62a(0x10ae)?_0x47d1f4:_0x3bd7c3[_0x4ff62a(0x234)])+':\x20'+String(_0x32ec97[_0x4ff62a(0x73e)])[_0x4ff62a(0xad6)](0x0,0x1e)+'...')[_0x4ff62a(0x2c8)]('\x0a'),_0x3d1100=(_0x3bd7c3[_0x4ff62a(0x81e)][_0x4ff62a(0x4ab)]||[])[_0x4ff62a(0xcb4)](_0x3cdf4c=>_0x53d851[_0x4ff62a(0x10f2)][_0x4ff62a(0x397)](_0x5516cd=>_0x5516cd['id']===_0x3cdf4c))[_0x4ff62a(0x2dd)](Boolean)['map'](_0x401f6c=>_0x4ff62a(0x474)+_0x401f6c[_0x4ff62a(0x234)]+_0x4ff62a(0xd29)+_0x401f6c[_0x4ff62a(0x73e)]['filter'](_0x1a68a6=>_0x1a68a6[_0x4ff62a(0xb3d)])[_0x4ff62a(0xcb4)](_0x211d07=>'-\x20'+_0x211d07['content'])[_0x4ff62a(0x2c8)]('\x0a'))[_0x4ff62a(0x2c8)](''),_0x193195=_0x32a9cb(_0x3bd7c3,0x3,_0x4ff62a(0x81f)),_0x576f70=_0x32a9cb(_0x3bd7c3,0x6,_0x4ff62a(0x81f)),_0x4b72d9=_0x32a9cb(_0x3bd7c3,0x9,'hours'),_0x5b2637=_0x32a9cb(_0x3bd7c3,0x1,_0x4ff62a(0xc61)),_0x25aa51=_0x32a9cb(_0x3bd7c3,0x3,_0x4ff62a(0xc61)),_0x341d2b=_0x32a9cb(_0x3bd7c3,0x7,'days');let _0x2c687f='';if(_0x193195||_0x576f70||_0x4b72d9||_0x5b2637||_0x25aa51||_0x341d2b){_0x2c687f+=_0x4ff62a(0xb9a);if(_0x193195)_0x2c687f+=_0x193195;if(_0x576f70)_0x2c687f+=_0x576f70;if(_0x4b72d9)_0x2c687f+=_0x4b72d9;if(_0x193195||_0x576f70||_0x4b72d9)_0x2c687f+='\x0a';if(_0x5b2637)_0x2c687f+=_0x5b2637;if(_0x25aa51)_0x2c687f+=_0x25aa51;if(_0x341d2b)_0x2c687f+=_0x341d2b;}const _0x53ffde='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x3bd7c3['name']+_0x4ff62a(0x6b9)+_0x3bd7c3[_0x4ff62a(0x81e)][_0x4ff62a(0x1216)]+_0x4ff62a(0x6cf)+_0x5b6281+'\x0a'+_0x3d1100+'\x0a'+_0x2c687f+_0x4ff62a(0x513)+_0x47d1f4+_0x4ff62a(0x294)+_0x3bd7c6+'\x0a\x0a现在，请生成包含总余额和购买记录的JSON对象。';try{const _0x545f5c=[{'role':_0x4ff62a(0x10ae),'content':_0x4ff62a(0x817)}];let _0x42e69c=_0x4653b6[_0x4ff62a(0x6e9)]('generativelanguage'),_0x1a1649=_0x1697e7(_0x31210c,_0x3ccd1c,_0x53ffde,_0x545f5c);const _0x2515ee=_0x42e69c?await fetch(_0x1a1649[_0x4ff62a(0xb36)],_0x1a1649['data']):await fetch(_0x4653b6+_0x4ff62a(0x434),{'method':_0x4ff62a(0xa4e),'headers':{'Content-Type':'application/json','Authorization':_0x4ff62a(0x841)+_0x3ccd1c},'body':JSON[_0x4ff62a(0xe1e)]({'model':_0x31210c,'messages':[{'role':'system','content':_0x53ffde},..._0x545f5c],'temperature':_0x53d851[_0x4ff62a(0x906)]['apiTemperature']||0.9})});if(!_0x2515ee['ok'])throw new Error(_0x4ff62a(0x352)+_0x2515ee[_0x4ff62a(0x5c1)]);const _0xa057a=await _0x2515ee[_0x4ff62a(0xdc2)](),_0x161d66=getGeminiResponseText(_0xa057a),_0x300aad=_0x161d66[_0x4ff62a(0x1120)](/({[\s\S]*})/);if(!_0x300aad)throw new Error(_0x4ff62a(0x12a6));const _0x147ae6=JSON[_0x4ff62a(0x367)](_0x300aad[0x0]);!_0x147ae6['purchases']&&(_0x147ae6[_0x4ff62a(0x490)]=[]),_0x3bd7c3[_0x4ff62a(0xfc8)]=_0x147ae6,await _0xa62efb[_0x4ff62a(0xaa3)][_0x4ff62a(0x546)](_0x3bd7c3),await _0x1f9961();}catch(_0x29bd1c){console['error'](_0x4ff62a(0x1001),_0x29bd1c),await _0x184397(_0x4ff62a(0x3eb),_0x4ff62a(0xad2)+_0x29bd1c[_0x4ff62a(0x875)]);}}function _0x24c3f7(){const _0x4eca5a=_0x13d875;_0x7a7dce(),_0x1805e5(_0x4eca5a(0x698));}function _0x7a7dce(){const _0x188f03=_0x13d875,_0x43ae5c=document[_0x188f03(0x53a)](_0x188f03(0x1188));_0x43ae5c[_0x188f03(0xaac)]='';const _0x326baf=_0x53d851[_0x188f03(0xaa3)][_0x3f6485],_0x5a7653=_0x326baf[_0x188f03(0xfc8)]||{},_0x812e27=_0x5a7653[_0x188f03(0x490)]||[],_0x2e5fbe=_0x5a7653['totalBalance']||0x0,_0x1f61d3=document[_0x188f03(0xd67)](_0x188f03(0x1425));_0x1f61d3[_0x188f03(0x1284)][_0x188f03(0x94d)]=_0x188f03(0xa1b),_0x1f61d3['innerHTML']=_0x188f03(0x1383)+_0x2e5fbe[_0x188f03(0x39e)](0x2)+_0x188f03(0xe34),_0x43ae5c[_0x188f03(0x133d)](_0x1f61d3);const _0xf52d0e=document[_0x188f03(0xd67)]('h3');_0xf52d0e[_0x188f03(0x34a)]=_0x188f03(0x31f),_0xf52d0e[_0x188f03(0x1284)][_0x188f03(0x94d)]=_0x188f03(0x7e3),_0x43ae5c['appendChild'](_0xf52d0e);if(_0x812e27[_0x188f03(0x29d)]===0x0){_0x43ae5c['innerHTML']+='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>暂无支出记录。</p>';return;}_0x812e27[_0x188f03(0xeaf)](_0x13f72a=>{const _0x36c5c1=_0x188f03,_0x5d3a65=document['createElement'](_0x36c5c1(0x1425));_0x5d3a65['style'][_0x36c5c1(0x94d)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2015px\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#f0f0f0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x5d3a65[_0x36c5c1(0xaac)]=_0x36c5c1(0x88f)+_0x13f72a['itemName']+_0x36c5c1(0x695)+_0x13f72a['status']+_0x36c5c1(0x7da)+(_0x13f72a[_0x36c5c1(0xbde)]||0x0)[_0x36c5c1(0x39e)](0x2)+_0x36c5c1(0xca8),_0x43ae5c[_0x36c5c1(0x133d)](_0x5d3a65);});}async function _0x30c95d(){const _0xe6606=_0x13d875;if(!_0x3f6485)return;const _0x2c35fa=_0x53d851['chats'][_0x3f6485];if(!_0x2c35fa)return;await _0x184397(_0xe6606(0x11d7),_0xe6606(0x217)+_0x2c35fa[_0xe6606(0x234)]+_0xe6606(0x609));const {proxyUrl:_0x1ea8f8,apiKey:_0x954d21,model:_0xbed07b}=_0x53d851[_0xe6606(0x80d)];if(!_0x1ea8f8||!_0x954d21||!_0xbed07b){alert(_0xe6606(0x3ed));return;}const _0x2fb2e7=_0x53d851[_0xe6606(0xa74)][_0xe6606(0x1005)]==='{{user}}'||!_0x53d851[_0xe6606(0xa74)][_0xe6606(0x1005)]?'用户':_0x53d851[_0xe6606(0xa74)][_0xe6606(0x1005)],_0xfbf357=_0x2c35fa['longTermMemory']&&_0x2c35fa[_0xe6606(0x1016)][_0xe6606(0x29d)]>0x0?_0x2c35fa[_0xe6606(0x1016)][_0xe6606(0xcb4)](_0x2b5c56=>_0xe6606(0xd87)+_0x272f9c(_0x2b5c56[_0xe6606(0x827)])+')\x20'+_0x2b5c56['content'])['join']('\x0a'):'无',_0x3248f7=_0x2c35fa['settings'][_0xe6606(0x489)]||0xa,_0x1c9ec6=_0x2c35fa[_0xe6606(0xe83)][_0xe6606(0x1340)](-_0x3248f7)[_0xe6606(0xcb4)](_0x4c883a=>(_0x4c883a[_0xe6606(0xb4d)]==='user'?_0x2fb2e7:_0x2c35fa[_0xe6606(0x234)])+':\x20'+String(_0x4c883a['content'])['substring'](0x0,0x1e)+'...')[_0xe6606(0x2c8)]('\x0a'),_0x1b0e3a=(_0x2c35fa['settings'][_0xe6606(0x4ab)]||[])[_0xe6606(0xcb4)](_0x32f9ef=>_0x53d851[_0xe6606(0x10f2)][_0xe6606(0x397)](_0x5cd025=>_0x5cd025['id']===_0x32f9ef))['filter'](Boolean)[_0xe6606(0xcb4)](_0x55675e=>_0xe6606(0x474)+_0x55675e['name']+_0xe6606(0xd29)+_0x55675e[_0xe6606(0x73e)][_0xe6606(0x2dd)](_0x3f6d37=>_0x3f6d37[_0xe6606(0xb3d)])[_0xe6606(0xcb4)](_0x35abef=>'-\x20'+_0x35abef[_0xe6606(0x73e)])[_0xe6606(0x2c8)]('\x0a'))[_0xe6606(0x2c8)](''),_0x424f9d=_0x32a9cb(_0x2c35fa,0x3,_0xe6606(0x81f)),_0xe3a60=_0x32a9cb(_0x2c35fa,0x6,_0xe6606(0x81f)),_0x374480=_0x32a9cb(_0x2c35fa,0x9,_0xe6606(0x81f)),_0x20032f=_0x32a9cb(_0x2c35fa,0x1,_0xe6606(0xc61)),_0x44fc0c=_0x32a9cb(_0x2c35fa,0x3,_0xe6606(0xc61)),_0x31b4ff=_0x32a9cb(_0x2c35fa,0x7,_0xe6606(0xc61));let _0x3861dd='';if(_0x424f9d||_0xe3a60||_0x374480||_0x20032f||_0x44fc0c||_0x31b4ff){_0x3861dd+=_0xe6606(0xb9a);if(_0x424f9d)_0x3861dd+=_0x424f9d;if(_0xe3a60)_0x3861dd+=_0xe3a60;if(_0x374480)_0x3861dd+=_0x374480;if(_0x424f9d||_0xe3a60||_0x374480)_0x3861dd+='\x0a';if(_0x20032f)_0x3861dd+=_0x20032f;if(_0x44fc0c)_0x3861dd+=_0x44fc0c;if(_0x31b4ff)_0x3861dd+=_0x31b4ff;}const _0x3a1666=_0x2c35fa[_0xe6606(0x81e)]['myPersona']||_0xe6606(0x970),_0x219498=_0xe6606(0x366)+_0x2c35fa['name']+_0xe6606(0xecb)+_0x2c35fa[_0xe6606(0x81e)][_0xe6606(0x1216)]+'\x0a-\x20**\x20你的聊天对象（用户）的人设**:'+_0x3a1666+_0xe6606(0x6cf)+_0xfbf357+'\x0a'+_0x1b0e3a+'\x0a'+_0x3861dd+_0xe6606(0x334)+_0x2fb2e7+_0xe6606(0x294)+_0x1c9ec6+_0xe6606(0x2ad);try{const _0x11aae0=[{'role':_0xe6606(0x10ae),'content':_0xe6606(0x60f)}];let _0x3d6cbe=_0x1ea8f8[_0xe6606(0x6e9)](_0xe6606(0x1046)),_0x401e4a=_0x1697e7(_0xbed07b,_0x954d21,_0x219498,_0x11aae0);const _0x2e69d7=_0x3d6cbe?await fetch(_0x401e4a[_0xe6606(0xb36)],_0x401e4a[_0xe6606(0xd7c)]):await fetch(_0x1ea8f8+_0xe6606(0x434),{'method':_0xe6606(0xa4e),'headers':{'Content-Type':_0xe6606(0x85b),'Authorization':'Bearer\x20'+_0x954d21},'body':JSON['stringify']({'model':_0xbed07b,'messages':[{'role':'system','content':_0x219498},..._0x11aae0],'temperature':_0x53d851['globalSettings'][_0xe6606(0xaf8)]||0.9})});if(!_0x2e69d7['ok']){const _0x37a55f=await _0x2e69d7[_0xe6606(0xdc2)]()[_0xe6606(0x9cb)](()=>null),_0x1786c0=_0x37a55f?.[_0xe6606(0x617)]?.[_0xe6606(0x875)]||_0x2e69d7[_0xe6606(0x5c1)];throw new Error('API\x20错误:\x20'+_0x2e69d7[_0xe6606(0x12d3)]+_0xe6606(0x122c)+_0x1786c0);}const _0x11e8c5=await _0x2e69d7['json'](),_0x50e2d=getGeminiResponseText(_0x11e8c5),_0x49f2a8=_0x50e2d[_0xe6606(0x1120)](/(\[[\s\S]*\])/);if(!_0x49f2a8||!_0x49f2a8[0x0])throw new Error(_0xe6606(0xfe3)+_0x50e2d);const _0x583c19=_0x49f2a8[0x0];let _0x4eeb6b;try{_0x4eeb6b=JSON[_0xe6606(0x367)](_0x583c19);}catch(_0x203bd8){throw new Error(_0xe6606(0x7a4)+_0x203bd8[_0xe6606(0x875)]+_0xe6606(0xa01)+_0x50e2d);}if(!Array['isArray'](_0x4eeb6b))throw new Error('AI返回的数据不是一个数组。原始返回:\x20'+JSON[_0xe6606(0xe1e)](_0x4eeb6b));_0x2c35fa[_0xe6606(0x32f)]=_0x4eeb6b['map'](_0x5524f8=>({'id':Date['now']()+Math['random'](),'title':_0x5524f8[_0xe6606(0x667)],'content':_0x5524f8['content']})),await _0xa62efb[_0xe6606(0xaa3)]['put'](_0x2c35fa),await _0x1c8c9c();}catch(_0x34a1bf){console[_0xe6606(0x617)]('生成模拟备忘录失败:',_0x34a1bf),await _0x184397('生成失败',_0xe6606(0x5a9)+_0x34a1bf['message']);}}async function _0xf2a36f(){const _0x4e1027=_0x13d875;if(!_0x3f6485)return;const _0x4e121c=_0x53d851[_0x4e1027(0xaa3)][_0x3f6485];if(!_0x4e121c)return;await _0x184397(_0x4e1027(0x11d7),'正在生成“'+_0x4e121c[_0x4e1027(0x234)]+_0x4e1027(0x2b3));const {proxyUrl:_0x3d579b,apiKey:_0x2acfbb,model:_0x4f367e}=_0x53d851['apiConfig'];if(!_0x3d579b||!_0x2acfbb||!_0x4f367e){alert('API未配置，无法生成内容。');return;}const _0x21e103=_0x53d851[_0x4e1027(0xa74)][_0x4e1027(0x1005)]==='{{user}}'||!_0x53d851[_0x4e1027(0xa74)]['nickname']?'用户':_0x53d851[_0x4e1027(0xa74)][_0x4e1027(0x1005)],_0x25eab2=_0x4e121c['longTermMemory']&&_0x4e121c['longTermMemory'][_0x4e1027(0x29d)]>0x0?_0x4e121c['longTermMemory'][_0x4e1027(0xcb4)](_0x2278d3=>_0x4e1027(0xd87)+_0x272f9c(_0x2278d3[_0x4e1027(0x827)])+')\x20'+_0x2278d3[_0x4e1027(0x73e)])[_0x4e1027(0x2c8)]('\x0a'):'无',_0x10bfa0=_0x4e121c[_0x4e1027(0x81e)][_0x4e1027(0x489)]||0xa,_0x3be5eb=_0x4e121c[_0x4e1027(0xe83)][_0x4e1027(0x1340)](-_0x10bfa0)[_0x4e1027(0xcb4)](_0x4108af=>(_0x4108af[_0x4e1027(0xb4d)]===_0x4e1027(0x10ae)?_0x21e103:_0x4e121c[_0x4e1027(0x234)])+':\x20'+String(_0x4108af[_0x4e1027(0x73e)])[_0x4e1027(0xad6)](0x0,0x1e)+_0x4e1027(0x95d))[_0x4e1027(0x2c8)]('\x0a'),_0x16a671=(_0x4e121c[_0x4e1027(0x81e)][_0x4e1027(0x4ab)]||[])[_0x4e1027(0xcb4)](_0x49bc4a=>_0x53d851['worldBooks'][_0x4e1027(0x397)](_0x24343d=>_0x24343d['id']===_0x49bc4a))['filter'](Boolean)[_0x4e1027(0xcb4)](_0x52d3d3=>_0x4e1027(0x474)+_0x52d3d3[_0x4e1027(0x234)]+'》设定:\x0a'+_0x52d3d3['content'][_0x4e1027(0x2dd)](_0x4bd2d8=>_0x4bd2d8['enabled'])[_0x4e1027(0xcb4)](_0x5ab0fe=>'-\x20'+_0x5ab0fe[_0x4e1027(0x73e)])[_0x4e1027(0x2c8)]('\x0a'))['join'](''),_0x3ed26f=_0x32a9cb(_0x4e121c,0x3,_0x4e1027(0x81f)),_0x14fb21=_0x32a9cb(_0x4e121c,0x6,_0x4e1027(0x81f)),_0x4f66e5=_0x32a9cb(_0x4e121c,0x9,'hours'),_0x19793b=_0x32a9cb(_0x4e121c,0x1,_0x4e1027(0xc61)),_0x5b5dcb=_0x32a9cb(_0x4e121c,0x3,'days'),_0x2bd400=_0x32a9cb(_0x4e121c,0x7,_0x4e1027(0xc61));let _0x270bfa='';if(_0x3ed26f||_0x14fb21||_0x4f66e5||_0x19793b||_0x5b5dcb||_0x2bd400){_0x270bfa+=_0x4e1027(0xb9a);if(_0x3ed26f)_0x270bfa+=_0x3ed26f;if(_0x14fb21)_0x270bfa+=_0x14fb21;if(_0x4f66e5)_0x270bfa+=_0x4f66e5;if(_0x3ed26f||_0x14fb21||_0x4f66e5)_0x270bfa+='\x0a';if(_0x19793b)_0x270bfa+=_0x19793b;if(_0x5b5dcb)_0x270bfa+=_0x5b5dcb;if(_0x2bd400)_0x270bfa+=_0x2bd400;}const _0x41e477=_0x4e1027(0x366)+_0x4e121c[_0x4e1027(0x234)]+_0x4e1027(0xc47)+new Date()[_0x4e1027(0x747)]()+_0x4e1027(0xa4a)+_0x4e121c[_0x4e1027(0x81e)][_0x4e1027(0x1216)]+_0x4e1027(0x6cf)+_0x25eab2+'\x0a'+_0x16a671+'\x0a'+_0x270bfa+_0x4e1027(0x334)+_0x21e103+_0x4e1027(0x294)+_0x3be5eb+_0x4e1027(0xe2c);try{const _0xb72da9=[{'role':'user','content':_0x4e1027(0x8eb)}];let _0x39f52e=_0x3d579b[_0x4e1027(0x6e9)](_0x4e1027(0x1046)),_0x21fd01=_0x1697e7(_0x4f367e,_0x2acfbb,_0x41e477,_0xb72da9);const _0x31c27d=_0x39f52e?await fetch(_0x21fd01[_0x4e1027(0xb36)],_0x21fd01[_0x4e1027(0xd7c)]):await fetch(_0x3d579b+_0x4e1027(0x434),{'method':_0x4e1027(0xa4e),'headers':{'Content-Type':_0x4e1027(0x85b),'Authorization':_0x4e1027(0x841)+_0x2acfbb},'body':JSON[_0x4e1027(0xe1e)]({'model':_0x4f367e,'messages':[{'role':_0x4e1027(0xab3),'content':_0x41e477},..._0xb72da9],'temperature':_0x53d851[_0x4e1027(0x906)][_0x4e1027(0xaf8)]||0.9})});if(!_0x31c27d['ok'])throw new Error(_0x4e1027(0x352)+_0x31c27d['statusText']);const _0x5359a0=await _0x31c27d['json'](),_0x251f2d=getGeminiResponseText(_0x5359a0),_0x4e0e81=_0x251f2d[_0x4e1027(0x1120)](/(\[[\s\S]*\])/);if(!_0x4e0e81||!_0x4e0e81[0x0])throw new Error(_0x4e1027(0xfe3)+_0x251f2d);const _0x412d38=_0x4e0e81[0x0];let _0xf7491e;try{_0xf7491e=JSON[_0x4e1027(0x367)](_0x412d38);}catch(_0x5061d5){throw new Error('解析AI返回的JSON时出错:\x20'+_0x5061d5['message']+_0x4e1027(0xa01)+_0x251f2d);}_0x4e121c[_0x4e1027(0xe08)]=_0xf7491e,await _0xa62efb[_0x4e1027(0xaa3)][_0x4e1027(0x546)](_0x4e121c),await _0x480caa();}catch(_0x54bb6a){console[_0x4e1027(0x617)](_0x4e1027(0xdd8),_0x54bb6a),await _0x184397(_0x4e1027(0x3eb),'无法生成足迹，请检查API配置或稍后再试。\x0a错误:\x20'+_0x54bb6a[_0x4e1027(0x875)]);}}function _0x480caa(){const _0x2866ab=_0x13d875,_0x87e674=document[_0x2866ab(0x53a)](_0x2866ab(0x119b));_0x87e674[_0x2866ab(0xaac)]='';if(!_0x3f6485)return;const _0x47b3d2=_0x53d851[_0x2866ab(0xaa3)][_0x3f6485],_0x39e7d3=_0x47b3d2['simulatedAmapHistory']||[];if(_0x39e7d3[_0x2866ab(0x29d)]===0x0){_0x87e674[_0x2866ab(0xaac)]=_0x2866ab(0x10e2);return;}_0x39e7d3[_0x2866ab(0xeaf)](_0x20ead2=>{const _0x2444f8=_0x2866ab,_0x59e67c=document['createElement'](_0x2444f8(0x1425));_0x59e67c['className']='char-amap-item';let _0x117087='';if(_0x20ead2['image_prompt']){const _0x2fde40=_0x2444f8(0x9ce)+encodeURIComponent(_0x20ead2[_0x2444f8(0xadb)]);_0x117087=_0x2444f8(0xc3b)+_0x2fde40+'\x27)\x22\x20data-comment=\x22'+_0x20ead2[_0x2444f8(0x1445)]+_0x2444f8(0xf56);}const _0x5389d1=_0x20ead2[_0x2444f8(0x827)]?_0x272f9c(new Date(_0x20ead2[_0x2444f8(0x827)])[_0x2444f8(0x984)]()):_0x2444f8(0x937);_0x59e67c[_0x2444f8(0xaac)]=_0x2444f8(0x129f)+_0x20ead2['locationName']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-address\x22>'+_0x20ead2[_0x2444f8(0x536)]+_0x2444f8(0x72f)+_0x20ead2[_0x2444f8(0x1445)][_0x2444f8(0x795)](/\n/g,_0x2444f8(0x596))+_0x2444f8(0xa69)+_0x117087+_0x2444f8(0xe22)+_0x5389d1+_0x2444f8(0x30c),_0x87e674[_0x2444f8(0x133d)](_0x59e67c);});}async function _0x558d65(){const _0x32d0a4=_0x13d875;if(!_0x3f6485)return;const _0x571392=_0x53d851[_0x32d0a4(0xaa3)][_0x3f6485];if(!_0x571392)return;await _0x184397('请稍候...','正在分析“'+_0x571392[_0x32d0a4(0x234)]+_0x32d0a4(0x4ee));const {proxyUrl:_0x4dfdf2,apiKey:_0x419034,model:_0xed4732}=_0x53d851[_0x32d0a4(0x80d)];if(!_0x4dfdf2||!_0x419034||!_0xed4732){alert('API未配置，无法生成内容。');return;}const _0x312c95=_0x53d851[_0x32d0a4(0xa74)][_0x32d0a4(0x1005)]===_0x32d0a4(0x8ac)||!_0x53d851['qzoneSettings']['nickname']?'用户':_0x53d851[_0x32d0a4(0xa74)][_0x32d0a4(0x1005)],_0x27bf57=_0x571392['longTermMemory']&&_0x571392['longTermMemory'][_0x32d0a4(0x29d)]>0x0?_0x571392[_0x32d0a4(0x1016)][_0x32d0a4(0xcb4)](_0x487213=>_0x32d0a4(0xd87)+_0x272f9c(_0x487213[_0x32d0a4(0x827)])+')\x20'+_0x487213[_0x32d0a4(0x73e)])[_0x32d0a4(0x2c8)]('\x0a'):'无',_0x387714=_0x571392[_0x32d0a4(0x81e)][_0x32d0a4(0x489)]||0xa,_0x35f2c4=_0x571392[_0x32d0a4(0xe83)][_0x32d0a4(0x1340)](-_0x387714)[_0x32d0a4(0xcb4)](_0xfd0f54=>(_0xfd0f54[_0x32d0a4(0xb4d)]===_0x32d0a4(0x10ae)?_0x312c95:_0x571392[_0x32d0a4(0x234)])+':\x20'+String(_0xfd0f54[_0x32d0a4(0x73e)])[_0x32d0a4(0xad6)](0x0,0x1e)+_0x32d0a4(0x95d))[_0x32d0a4(0x2c8)]('\x0a'),_0x4409de=(_0x571392[_0x32d0a4(0x81e)]['linkedWorldBookIds']||[])[_0x32d0a4(0xcb4)](_0x108a75=>_0x53d851['worldBooks'][_0x32d0a4(0x397)](_0x4b9cbc=>_0x4b9cbc['id']===_0x108a75))['filter'](Boolean)['map'](_0x26dce5=>_0x32d0a4(0x474)+_0x26dce5[_0x32d0a4(0x234)]+_0x32d0a4(0xd29)+_0x26dce5[_0x32d0a4(0x73e)]['filter'](_0x4466aa=>_0x4466aa[_0x32d0a4(0xb3d)])[_0x32d0a4(0xcb4)](_0x35c64e=>'-\x20'+_0x35c64e[_0x32d0a4(0x73e)])[_0x32d0a4(0x2c8)]('\x0a'))[_0x32d0a4(0x2c8)](''),_0xc0fd7a=_0x32a9cb(_0x571392,0x3,_0x32d0a4(0x81f)),_0x28ef73=_0x32a9cb(_0x571392,0x6,_0x32d0a4(0x81f)),_0x407e24=_0x32a9cb(_0x571392,0x9,_0x32d0a4(0x81f)),_0x48d326=_0x32a9cb(_0x571392,0x1,_0x32d0a4(0xc61)),_0x113c16=_0x32a9cb(_0x571392,0x3,_0x32d0a4(0xc61)),_0x33d85c=_0x32a9cb(_0x571392,0x7,_0x32d0a4(0xc61));let _0x3cc7ac='';if(_0xc0fd7a||_0x28ef73||_0x407e24||_0x48d326||_0x113c16||_0x33d85c){_0x3cc7ac+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0xc0fd7a)_0x3cc7ac+=_0xc0fd7a;if(_0x28ef73)_0x3cc7ac+=_0x28ef73;if(_0x407e24)_0x3cc7ac+=_0x407e24;if(_0xc0fd7a||_0x28ef73||_0x407e24)_0x3cc7ac+='\x0a';if(_0x48d326)_0x3cc7ac+=_0x48d326;if(_0x113c16)_0x3cc7ac+=_0x113c16;if(_0x33d85c)_0x3cc7ac+=_0x33d85c;}const _0x5d59c0='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x571392['name']+'”，并根据其人设、记忆和最近的互动，虚构出TA最近一天的【手机App屏幕使用时间】记录，总共约20条。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与多样性**:\x20生成的App列表【不必局限于】Cphone主屏幕上已有的App。你可以自由地虚构TA可能使用的其他App，例如\x20Instagram,\x20Twitter,\x20各种游戏\x20(如：原神,\x20王者荣耀),\x20视频App\x20(如：抖音,\x20YouTube),\x20学习或工作软件等，这能更好地体现角色的隐藏兴趣和生活习惯。\x0a2.\x20\x20**合理性**:\x20使用时长和App类型必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一个App的使用记录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22appName\x22:\x20\x22App的名称\x20(例如:\x20微信,\x20微博,\x20原神)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22usageTimeMinutes\x22:\x20125,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22App的分类\x20(例如:\x20社交,\x20游戏,\x20影音,\x20工具,\x20阅读,\x20购物)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这个App【图标】的、简洁的【英文】关键词。风格必须是\x20modern\x20app\x20icon,\x20flat\x20design,\x20simple,\x20clean\x20background\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x571392['settings'][_0x32d0a4(0x1216)]+'\x0a-\x20**你的长期记忆**:\x0a'+_0x27bf57+'\x0a'+_0x4409de+'\x0a'+_0x3cc7ac+'\x0a-\x20**你最近和“'+_0x312c95+_0x32d0a4(0x294)+_0x35f2c4+_0x32d0a4(0xfb1);try{const _0x2ae9c9=[{'role':_0x32d0a4(0x10ae),'content':_0x32d0a4(0x1208)}];let _0x3b6412=_0x4dfdf2[_0x32d0a4(0x6e9)]('generativelanguage'),_0x64d3b=_0x1697e7(_0xed4732,_0x419034,_0x5d59c0,_0x2ae9c9);const _0x175f74=_0x3b6412?await fetch(_0x64d3b[_0x32d0a4(0xb36)],_0x64d3b[_0x32d0a4(0xd7c)]):await fetch(_0x4dfdf2+_0x32d0a4(0x434),{'method':'POST','headers':{'Content-Type':_0x32d0a4(0x85b),'Authorization':_0x32d0a4(0x841)+_0x419034},'body':JSON['stringify']({'model':_0xed4732,'messages':[{'role':_0x32d0a4(0xab3),'content':_0x5d59c0},..._0x2ae9c9],'temperature':_0x53d851[_0x32d0a4(0x906)][_0x32d0a4(0xaf8)]||0.9})});if(!_0x175f74['ok'])throw new Error(_0x32d0a4(0x352)+_0x175f74[_0x32d0a4(0x5c1)]);const _0x1fac35=await _0x175f74[_0x32d0a4(0xdc2)](),_0xd8b423=getGeminiResponseText(_0x1fac35),_0xeb9233=_0xd8b423[_0x32d0a4(0x795)](/^```json\s*/,'')[_0x32d0a4(0x795)](/```$/,''),_0x433ad7=JSON[_0x32d0a4(0x367)](_0xeb9233);_0x571392[_0x32d0a4(0x2a3)]=_0x433ad7,await _0xa62efb['chats'][_0x32d0a4(0x546)](_0x571392),await _0x184b88();}catch(_0x1dcffd){console[_0x32d0a4(0x617)](_0x32d0a4(0x10c3),_0x1dcffd),await _0x184397('生成失败','无法生成记录，请检查API配置或稍后再试。\x0a错误:\x20'+_0x1dcffd[_0x32d0a4(0x875)]);}}function _0x184b88(){const _0x1e3f4f=_0x13d875,_0x576dd5=document[_0x1e3f4f(0x53a)](_0x1e3f4f(0x5da));_0x576dd5[_0x1e3f4f(0xaac)]='';if(!_0x3f6485)return;const _0x393470=_0x53d851[_0x1e3f4f(0xaa3)][_0x3f6485],_0x5d778c=(_0x393470[_0x1e3f4f(0x2a3)]||[])[_0x1e3f4f(0xdb0)]((_0x3ff922,_0x2a11b0)=>_0x2a11b0[_0x1e3f4f(0x428)]-_0x3ff922['usageTimeMinutes']);if(_0x5d778c[_0x1e3f4f(0x29d)]===0x0){_0x576dd5[_0x1e3f4f(0xaac)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有任何使用记录，<br>点击右上角刷新按钮生成一些吧！</p>';return;}_0x5d778c[_0x1e3f4f(0xeaf)](_0x3fda97=>{const _0x3e047=_0x1e3f4f,_0x41c4f2=document['createElement']('div');_0x41c4f2[_0x3e047(0x6de)]=_0x3e047(0x9c7);const _0x1b192d=Math['floor'](_0x3fda97[_0x3e047(0x428)]/0x3c),_0x2ef74a=_0x3fda97[_0x3e047(0x428)]%0x3c;let _0x29a09d='';if(_0x1b192d>0x0)_0x29a09d+=_0x1b192d+'小时';if(_0x2ef74a>0x0)_0x29a09d+=_0x2ef74a+'分钟';if(!_0x29a09d)_0x29a09d=_0x3e047(0x38b);const _0x264bb7=_0x3fda97['image_prompt']||_0x3e047(0xb8f)+_0x3fda97[_0x3e047(0x7bd)]+_0x3e047(0x7e8),_0xcac42f=_0x3e047(0x9ce)+encodeURIComponent(_0x264bb7);_0x41c4f2[_0x3e047(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0xcac42f+_0x3e047(0x1dd)+_0x3fda97[_0x3e047(0x7bd)]+_0x3e047(0x796)+_0x3fda97[_0x3e047(0x3f4)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-time\x22>'+_0x29a09d+_0x3e047(0x30c),_0x576dd5['appendChild'](_0x41c4f2);});}async function _0x1833f0(){const _0x59309c=_0x13d875;if(!_0x3f6485)return;const _0x3cca40=_0x53d851[_0x59309c(0xaa3)][_0x3f6485];if(!_0x3cca40)return;await _0x184397(_0x59309c(0x11d7),_0x59309c(0x217)+_0x3cca40['name']+_0x59309c(0xe6a));const {proxyUrl:_0x137341,apiKey:_0x2a2703,model:_0x3e2e51}=_0x53d851[_0x59309c(0x80d)];if(!_0x137341||!_0x2a2703||!_0x3e2e51){alert(_0x59309c(0x3ed));return;}const _0x4ae2dd=_0x53d851[_0x59309c(0xa74)][_0x59309c(0x1005)]===_0x59309c(0x8ac)||!_0x53d851[_0x59309c(0xa74)][_0x59309c(0x1005)]?'用户':_0x53d851['qzoneSettings']['nickname'],_0x51e82a=_0x3cca40['longTermMemory']&&_0x3cca40[_0x59309c(0x1016)]['length']>0x0?_0x3cca40['longTermMemory'][_0x59309c(0xcb4)](_0x2e3dba=>_0x59309c(0xd87)+_0x272f9c(_0x2e3dba[_0x59309c(0x827)])+')\x20'+_0x2e3dba[_0x59309c(0x73e)])[_0x59309c(0x2c8)]('\x0a'):'无',_0xbdacf1=_0x3cca40[_0x59309c(0x81e)][_0x59309c(0x489)]||0xa,_0x286525=_0x3cca40[_0x59309c(0xe83)][_0x59309c(0x1340)](-_0xbdacf1)[_0x59309c(0xcb4)](_0x15ddfd=>(_0x15ddfd[_0x59309c(0xb4d)]===_0x59309c(0x10ae)?_0x4ae2dd:_0x3cca40[_0x59309c(0x234)])+':\x20'+String(_0x15ddfd['content'])[_0x59309c(0xad6)](0x0,0x1e)+_0x59309c(0x95d))[_0x59309c(0x2c8)]('\x0a'),_0x298ace=(_0x3cca40[_0x59309c(0x81e)][_0x59309c(0x4ab)]||[])['map'](_0xdc644=>_0x53d851['worldBooks'][_0x59309c(0x397)](_0x2c7935=>_0x2c7935['id']===_0xdc644))[_0x59309c(0x2dd)](Boolean)[_0x59309c(0xcb4)](_0x49eeb4=>_0x59309c(0x474)+_0x49eeb4[_0x59309c(0x234)]+'》设定:\x0a'+_0x49eeb4[_0x59309c(0x73e)][_0x59309c(0x2dd)](_0x390172=>_0x390172[_0x59309c(0xb3d)])['map'](_0x2deb67=>'-\x20'+_0x2deb67[_0x59309c(0x73e)])[_0x59309c(0x2c8)]('\x0a'))['join'](''),_0x5ef6f2=_0x59309c(0xe96)+_0x3cca40['name']+'”，并根据其人设、记忆和最近的互动，挑选出【14到18首】最能代表TA此刻心情或品味的歌曲。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20歌单必须完全符合角色的性格、爱好和生活背景。\x0a2.\x20\x20**多样性**:\x20歌曲风格可以多样，但必须逻辑自洽。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一首歌，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22songName\x22:\x20\x22歌曲的准确名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22artistName\x22:\x20\x22歌曲的准确艺术家/歌手名\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x3cca40[_0x59309c(0x81e)][_0x59309c(0x1216)]+'\x0a-\x20**你的长期记忆**:\x0a'+_0x51e82a+'\x0a'+_0x298ace+_0x59309c(0x334)+_0x4ae2dd+_0x59309c(0x294)+_0x286525+_0x59309c(0x73d);try{const _0x5de966=[{'role':_0x59309c(0x10ae),'content':_0x59309c(0x5de)}];let _0x21bdbf=_0x137341['includes']('generativelanguage'),_0x5cb4ea=_0x1697e7(_0x3e2e51,_0x2a2703,_0x5ef6f2,_0x5de966);const _0x47ce5b=_0x21bdbf?await fetch(_0x5cb4ea[_0x59309c(0xb36)],_0x5cb4ea['data']):await fetch(_0x137341+_0x59309c(0x434),{'method':_0x59309c(0xa4e),'headers':{'Content-Type':_0x59309c(0x85b),'Authorization':_0x59309c(0x841)+_0x2a2703},'body':JSON[_0x59309c(0xe1e)]({'model':_0x3e2e51,'messages':[{'role':_0x59309c(0xab3),'content':_0x5ef6f2},..._0x5de966],'temperature':_0x53d851[_0x59309c(0x906)][_0x59309c(0xaf8)]||0x1})});if(!_0x47ce5b['ok'])throw new Error(_0x59309c(0x352)+_0x47ce5b[_0x59309c(0x5c1)]);const _0x312baa=await _0x47ce5b[_0x59309c(0xdc2)](),_0x16498d=getGeminiResponseText(_0x312baa),_0x43e58b=_0x16498d['replace'](/^```json\s*/,'')[_0x59309c(0x795)](/```$/,''),_0x5f21b9=JSON[_0x59309c(0x367)](_0x43e58b);await _0x184397(_0x59309c(0x11d7),_0x59309c(0x1192)+_0x5f21b9['length']+_0x59309c(0x1380));const _0xbe01d9=_0x5f21b9[_0x59309c(0xcb4)](async _0x4af93a=>{const _0x3fe602=_0x59309c;let _0x2da619=await _0x56468e(_0x4af93a['songName'],_0x4af93a[_0x3fe602(0x1431)]);(!_0x2da619||_0x2da619[_0x3fe602(0x29d)]===0x0)&&(_0x2da619=await _0x3fd404(_0x4af93a[_0x3fe602(0xec7)]));if(_0x2da619[_0x3fe602(0x29d)]>0x0)return _0x4f9833(_0x2da619[0x0]);return console[_0x3fe602(0xad0)](_0x3fe602(0xf16)+_0x4af93a[_0x3fe602(0xec7)]+_0x3fe602(0x122c)+_0x4af93a[_0x3fe602(0x1431)]+'”'),null;}),_0x1cab63=(await Promise['all'](_0xbe01d9))[_0x59309c(0x2dd)](Boolean);_0x3cca40[_0x59309c(0x46a)]=_0x1cab63,await _0xa62efb[_0x59309c(0xaa3)][_0x59309c(0x546)](_0x3cca40),await _0x1e77b6();}catch(_0x1cd7da){console['error']('生成模拟歌单失败:',_0x1cd7da),await _0x184397('生成失败',_0x59309c(0x222)+_0x1cd7da[_0x59309c(0x875)]);}}function _0x1e77b6(){const _0x57865b=_0x13d875,_0x2b66d3=document[_0x57865b(0x53a)](_0x57865b(0xb41));_0x2b66d3['innerHTML']='';if(!_0x3f6485)return;const _0xfb4026=_0x53d851['chats'][_0x3f6485],_0x1b8775=_0xfb4026[_0x57865b(0x46a)]||[];if(_0x1b8775[_0x57865b(0x29d)]===0x0){_0x2b66d3[_0x57865b(0xaac)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的歌单还是空的，<br>点击右上角刷新按钮生成一些歌曲吧！</p>';return;}_0x1b8775['forEach']((_0xa56d13,_0x3f16c0)=>{const _0x9954ff=_0x57865b,_0x3ddddc=document['createElement'](_0x9954ff(0x1425));_0x3ddddc['className']='char-music-item',_0x3ddddc['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0xa56d13[_0x9954ff(0x100f)]+_0x9954ff(0x5d2)+_0xa56d13[_0x9954ff(0x234)]+_0x9954ff(0x10e1)+_0xa56d13[_0x9954ff(0x7cc)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x3ddddc['addEventListener']('click',()=>_0x32de9b(_0xa56d13)),_0x2b66d3[_0x9954ff(0x133d)](_0x3ddddc);});}let _0x4bfbf2={'currentPlaylist':[],'currentIndex':-0x1,'isPlaying':![],'playMode':_0x13d875(0x6fe),'lrcUpdateInterval':null,'parsedLyrics':[],'currentLyricIndex':-0x1};function _0x32de9b(_0x46467f){const _0x1357bd=_0x13d875,_0x239ab3=document[_0x1357bd(0x53a)](_0x1357bd(0xe51)),_0x55dd26=document['getElementById'](_0x1357bd(0x757));if(_0x4bfbf2[_0x1357bd(0xbe4)])clearInterval(_0x4bfbf2[_0x1357bd(0xbe4)]);_0x239ab3[_0x1357bd(0xd54)]();const _0x55126b=_0x4bfbf2[_0x1357bd(0x9ba)][_0x1357bd(0x298)](_0x4a2c5f=>_0x4a2c5f[_0x1357bd(0x7ff)]===_0x46467f[_0x1357bd(0x7ff)]);_0x55126b>-0x1?_0x4bfbf2[_0x1357bd(0xe7d)]=_0x55126b:(_0x4bfbf2[_0x1357bd(0x9ba)]=[_0x46467f],_0x4bfbf2[_0x1357bd(0xe7d)]=0x0);document[_0x1357bd(0x53a)](_0x1357bd(0xed6))[_0x1357bd(0x34a)]=_0x46467f['name'],document[_0x1357bd(0x53a)](_0x1357bd(0x453))[_0x1357bd(0x34a)]=_0x46467f[_0x1357bd(0x7cc)],document['getElementById'](_0x1357bd(0x669))[_0x1357bd(0x7ff)]=_0x46467f[_0x1357bd(0x100f)],_0x4bfbf2[_0x1357bd(0xd4b)]=_0x5a24fc(_0x46467f[_0x1357bd(0x917)]||''),_0xe14e8c();if(_0x46467f[_0x1357bd(0xfe6)]){const _0x3c2c17=new Blob([_0x46467f['src']],{'type':_0x46467f['fileType']||'audio/mpeg'});_0x239ab3[_0x1357bd(0x7ff)]=URL[_0x1357bd(0xaa0)](_0x3c2c17);}else _0x239ab3[_0x1357bd(0x7ff)]=_0x46467f[_0x1357bd(0x7ff)];_0x239ab3[_0x1357bd(0x116c)]()[_0x1357bd(0x9cb)](_0x17bdaa=>console['error'](_0x1357bd(0x1052),_0x17bdaa)),_0x239ab3['onloadedmetadata']=()=>{const _0x405fc4=_0x1357bd;document['getElementById'](_0x405fc4(0x33a))['textContent']=_0x27d8fc(_0x239ab3[_0x405fc4(0xb6a)]),_0x4bfbf2[_0x405fc4(0xbe4)]=setInterval(_0x2aaed2,0x1f4);},_0x55dd26[_0x1357bd(0x1276)][_0x1357bd(0xe13)](_0x1357bd(0xaef));}function _0x4510ce(){const _0x48e3e4=_0x13d875,_0x5c5aa4=document['getElementById'](_0x48e3e4(0x757)),_0x1dbed2=document[_0x48e3e4(0x53a)]('char-audio-player');if(_0x4bfbf2[_0x48e3e4(0xbe4)])clearInterval(_0x4bfbf2[_0x48e3e4(0xbe4)]);_0x1dbed2[_0x48e3e4(0xd54)](),_0x1dbed2['src']='',_0x5c5aa4['classList']['remove'](_0x48e3e4(0xaef)),_0x4bfbf2[_0x48e3e4(0x5a4)]=![],document[_0x48e3e4(0x53a)](_0x48e3e4(0x775))[_0x48e3e4(0x1276)][_0x48e3e4(0x2d4)](_0x48e3e4(0xd50));}function _0x2aaed2(){const _0x37383f=_0x13d875,_0x929097=document[_0x37383f(0x53a)]('char-audio-player');if(!_0x929097[_0x37383f(0xb6a)])return;const _0x19eb51=_0x929097[_0x37383f(0x13d0)],_0x13d65d=_0x929097[_0x37383f(0xb6a)];document[_0x37383f(0x53a)](_0x37383f(0xcff))[_0x37383f(0x1284)][_0x37383f(0xd10)]=_0x19eb51/_0x13d65d*0x64+'%',document['getElementById']('char-music-current-time')[_0x37383f(0x34a)]=_0x27d8fc(_0x19eb51),_0x20711d(_0x19eb51);}function _0xe14e8c(){const _0x4a49ff=_0x13d875,_0x59b1e0=document['getElementById']('char-music-lyrics');_0x59b1e0[_0x4a49ff(0xaac)]='',_0x4bfbf2[_0x4a49ff(0x10b2)]=-0x1;if(!_0x4bfbf2[_0x4a49ff(0xd4b)]||_0x4bfbf2[_0x4a49ff(0xd4b)][_0x4a49ff(0x29d)]===0x0){_0x59b1e0[_0x4a49ff(0xaac)]=_0x4a49ff(0xc8c);return;}_0x4bfbf2['parsedLyrics'][_0x4a49ff(0xeaf)]((_0x53d408,_0x2dd181)=>{const _0x5b440f=_0x4a49ff,_0x27c676=document[_0x5b440f(0xd67)]('p');_0x27c676[_0x5b440f(0x34a)]=_0x53d408[_0x5b440f(0x2e6)],_0x27c676['dataset'][_0x5b440f(0xd52)]=_0x2dd181,_0x59b1e0[_0x5b440f(0x133d)](_0x27c676);});}function _0x20711d(_0x44b8d0){const _0x2c9f2d=_0x13d875,_0x30cbc6=_0x4bfbf2[_0x2c9f2d(0xd4b)];if(_0x30cbc6[_0x2c9f2d(0x29d)]===0x0)return;let _0xfc820f=-0x1;for(let _0x220f38=0x0;_0x220f38<_0x30cbc6[_0x2c9f2d(0x29d)];_0x220f38++){if(_0x44b8d0>=_0x30cbc6[_0x220f38]['time'])_0xfc820f=_0x220f38;else break;}if(_0xfc820f===_0x4bfbf2[_0x2c9f2d(0x10b2)])return;_0x4bfbf2[_0x2c9f2d(0x10b2)]=_0xfc820f;const _0x37c4ff=document[_0x2c9f2d(0x53a)]('char-music-lyrics'),_0x498cfc=_0x37c4ff[_0x2c9f2d(0xc3d)]('p');_0x498cfc[_0x2c9f2d(0xeaf)](_0x403d6=>_0x403d6[_0x2c9f2d(0x1276)]['remove'](_0x2c9f2d(0xdf6)));if(_0xfc820f>-0x1){const _0x414df0=_0x37c4ff[_0x2c9f2d(0x139c)](_0x2c9f2d(0xd13)+_0xfc820f+'\x22]');if(_0x414df0){_0x414df0[_0x2c9f2d(0x1276)][_0x2c9f2d(0xe13)](_0x2c9f2d(0xdf6));const _0x578e64=_0x37c4ff[_0x2c9f2d(0x252)]/0x2-_0x414df0[_0x2c9f2d(0x938)]-_0x414df0[_0x2c9f2d(0x127d)]/0x2;_0x498cfc[_0x2c9f2d(0xeaf)](_0x86d0de=>{const _0x6ea271=_0x2c9f2d;_0x86d0de['style'][_0x6ea271(0xd91)]=_0x6ea271(0xe16)+_0x578e64+'px)';});}}}function _0x273c9d(){const _0x30c25f=_0x13d875;if(_0x4bfbf2['currentPlaylist']['length']===0x0)return;let _0x1e52b0;switch(_0x4bfbf2[_0x30c25f(0x10d4)]){case _0x30c25f(0xac4):_0x1e52b0=Math[_0x30c25f(0x7d5)](Math[_0x30c25f(0xac4)]()*_0x4bfbf2[_0x30c25f(0x9ba)][_0x30c25f(0x29d)]);break;case _0x30c25f(0x129b):_0x32de9b(_0x4bfbf2[_0x30c25f(0x9ba)][_0x4bfbf2[_0x30c25f(0xe7d)]]);return;case'order':default:_0x1e52b0=(_0x4bfbf2['currentIndex']+0x1)%_0x4bfbf2[_0x30c25f(0x9ba)][_0x30c25f(0x29d)];break;}_0x32de9b(_0x4bfbf2[_0x30c25f(0x9ba)][_0x1e52b0]);}function _0x444360(){const _0x19f82c=_0x13d875;if(_0x4bfbf2[_0x19f82c(0x9ba)]['length']===0x0)return;const _0x3d0d63=(_0x4bfbf2[_0x19f82c(0xe7d)]-0x1+_0x4bfbf2[_0x19f82c(0x9ba)]['length'])%_0x4bfbf2[_0x19f82c(0x9ba)]['length'];_0x32de9b(_0x4bfbf2[_0x19f82c(0x9ba)][_0x3d0d63]);}function _0x27aa79(){const _0x52b704=_0x13d875,_0x2e33e9=[_0x52b704(0x6fe),_0x52b704(0xac4),_0x52b704(0x129b)],_0x103992=_0x2e33e9['indexOf'](_0x4bfbf2[_0x52b704(0x10d4)]);_0x4bfbf2[_0x52b704(0x10d4)]=_0x2e33e9[(_0x103992+0x1)%_0x2e33e9[_0x52b704(0x29d)]],document[_0x52b704(0x53a)]('char-music-mode-btn')[_0x52b704(0x34a)]={'order':'顺序','random':'随机','single':'单曲'}[_0x4bfbf2[_0x52b704(0x10d4)]];}function _0x174bcd(){const _0x3ccdc6=_0x13d875,_0x38665d=document[_0x3ccdc6(0x53a)]('char-audio-player'),_0x3eee20=document['getElementById']('char-music-play-pause-btn'),_0x5c1d42=document['getElementById'](_0x3ccdc6(0x775));_0x3eee20[_0x3ccdc6(0x1086)]('click',()=>{const _0x1b0cb4=_0x3ccdc6;if(_0x38665d[_0x1b0cb4(0x8c5)]){if(_0x4bfbf2['currentIndex']>-0x1)_0x38665d['play']();}else _0x38665d['pause']();}),_0x38665d[_0x3ccdc6(0x9f5)]=()=>{const _0x30a555=_0x3ccdc6;_0x3eee20[_0x30a555(0xaac)]='<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019h4V5H6v14zm8-14v14h4V5h-4z\x22></path></svg>',_0x5c1d42[_0x30a555(0x1276)][_0x30a555(0xe13)]('spinning'),_0x4bfbf2[_0x30a555(0x5a4)]=!![];},_0x38665d[_0x3ccdc6(0xe00)]=()=>{const _0xecb31e=_0x3ccdc6;_0x3eee20['innerHTML']=_0xecb31e(0xf1e),_0x5c1d42[_0xecb31e(0x1276)][_0xecb31e(0x2d4)](_0xecb31e(0xd50)),_0x4bfbf2[_0xecb31e(0x5a4)]=![];},_0x38665d[_0x3ccdc6(0xe4e)]=()=>{const _0x2926dc=_0x3ccdc6;_0x5c1d42[_0x2926dc(0x1276)]['remove'](_0x2926dc(0xd50)),_0x4bfbf2[_0x2926dc(0x5a4)]=![],_0x273c9d();},document[_0x3ccdc6(0x53a)](_0x3ccdc6(0x12f8))['addEventListener']('click',_0x444360),document[_0x3ccdc6(0x53a)](_0x3ccdc6(0x243))[_0x3ccdc6(0x1086)]('click',_0x273c9d),document[_0x3ccdc6(0x53a)](_0x3ccdc6(0xcab))[_0x3ccdc6(0x1086)](_0x3ccdc6(0xb2b),_0x27aa79),document[_0x3ccdc6(0x53a)](_0x3ccdc6(0xe1f))[_0x3ccdc6(0x1086)](_0x3ccdc6(0xb2b),_0x562839=>{const _0xd647db=_0x3ccdc6;if(!_0x38665d[_0xd647db(0xb6a)])return;const _0x292936=_0x562839['currentTarget'],_0x5d7452=_0x562839[_0xd647db(0xe74)];_0x38665d[_0xd647db(0x13d0)]=_0x5d7452/_0x292936['clientWidth']*_0x38665d[_0xd647db(0xb6a)];});}async function _0x529c6c(){const _0x3834b9=_0x13d875,_0xcf5a55=document[_0x3834b9(0x53a)](_0x3834b9(0xca0));_0xcf5a55[_0x3834b9(0xaac)]='';const _0x355a3b=await _0xa62efb[_0x3834b9(0x360)][_0x3834b9(0x1064)](_0x3834b9(0x827))['reverse']()['toArray']();if(_0x355a3b[_0x3834b9(0x29d)]===0x0){_0xcf5a55[_0x3834b9(0xaac)]=_0x3834b9(0x594);return;}_0x355a3b['forEach'](_0x48443c=>{const _0x2e446a=_0x3834b9;let _0x1c5cf8;const _0x2f4d38=_0x48443c['authorOriginalName']?Object['values'](_0x53d851[_0x2e446a(0xaa3)])[_0x2e446a(0x397)](_0x53dc7c=>!_0x53dc7c[_0x2e446a(0x86e)]&&_0x53dc7c['name']===_0x48443c[_0x2e446a(0xd2f)]):null;if(_0x2f4d38)_0x1c5cf8=_0x2f4d38[_0x2e446a(0x81e)][_0x2e446a(0x9e3)];else{const _0x2ec5e4=Object['values'](_0x53d851[_0x2e446a(0xaa3)])[_0x2e446a(0x397)](_0x285e3f=>!_0x285e3f[_0x2e446a(0x86e)]&&_0x285e3f['name']===_0x48443c[_0x2e446a(0x3dd)]);if(_0x2ec5e4)_0x1c5cf8=_0x2ec5e4[_0x2e446a(0x81e)][_0x2e446a(0x9e3)];else _0x48443c['authorAvatarPrompt']?_0x1c5cf8=_0x2e446a(0x9ce)+encodeURIComponent(_0x48443c[_0x2e446a(0x1080)]):_0x1c5cf8=_0x5d06c0;}const _0x2ca202=document[_0x2e446a(0xd67)](_0x2e446a(0x1425));_0x2ca202[_0x2e446a(0x6de)]=_0x2e446a(0x85f),_0x2ca202[_0x2e446a(0x12f2)]=()=>_0xc712f7(_0x48443c['id']),_0x2ca202[_0x2e446a(0xaac)]=_0x2e446a(0x1033)+_0x1c5cf8+_0x2e446a(0xcbf)+_0x48443c[_0x2e446a(0x3dd)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-group-name\x22>来自\x20'+_0x48443c['groupName']+_0x2e446a(0xa8a)+_0x48443c[_0x2e446a(0x68f)]+_0x2e446a(0x1210)+_0x48443c['content'][_0x2e446a(0x795)](/\n/g,_0x2e446a(0x596))+_0x2e446a(0x141d)+_0x48443c[_0x2e446a(0x23e)]+_0x2e446a(0x991)+_0x48443c[_0x2e446a(0x664)]+_0x2e446a(0x941)+_0x272f9c(_0x48443c[_0x2e446a(0x827)])+_0x2e446a(0xd25),_0xcf5a55[_0x2e446a(0x133d)](_0x2ca202);});}async function _0x15bb1b(){const _0x38a19f=_0x13d875,_0x11c788=_0x53d851['globalSettings'][_0x38a19f(0x12a4)]||[];if(_0x11c788[_0x38a19f(0x29d)]===0x0){await _0x184397('请先选择角色',_0x38a19f(0x24e));return;}await _0x184397(_0x38a19f(0x11d7),_0x38a19f(0x354)+_0x11c788[_0x38a19f(0x29d)]+_0x38a19f(0xad4));const {proxyUrl:_0x908835,apiKey:_0x4eb54e,model:_0x300f40}=_0x53d851[_0x38a19f(0x80d)];if(!_0x908835||!_0x4eb54e||!_0x300f40){alert(_0x38a19f(0x3ed));return;}const _0x18e96e=new Set();_0x11c788[_0x38a19f(0xeaf)](_0x1a8a46=>{const _0x5b625f=_0x38a19f,_0x5dcae9=_0x53d851[_0x5b625f(0xaa3)][_0x1a8a46];_0x5dcae9&&_0x5dcae9[_0x5b625f(0x81e)][_0x5b625f(0x4ab)]&&_0x5dcae9[_0x5b625f(0x81e)][_0x5b625f(0x4ab)]['forEach'](_0x320148=>_0x18e96e[_0x5b625f(0xe13)](_0x320148));});let _0x4476e4='';_0x18e96e[_0x38a19f(0x38e)]>0x0&&(_0x4476e4+=_0x38a19f(0x13fc),_0x18e96e[_0x38a19f(0xeaf)](_0xa82aeb=>{const _0xa63a19=_0x38a19f,_0x5cdf7c=_0x53d851[_0xa63a19(0x10f2)][_0xa63a19(0x397)](_0x29dce2=>_0x29dce2['id']===_0xa82aeb);if(_0x5cdf7c){const _0x3d3348=_0x5cdf7c[_0xa63a19(0x73e)]['filter'](_0xb3a628=>_0xb3a628['enabled']!==![])[_0xa63a19(0xcb4)](_0x435c56=>'-\x20'+_0x435c56['content'])[_0xa63a19(0x2c8)]('\x0a');_0x3d3348&&(_0x4476e4+=_0xa63a19(0xff7)+_0x5cdf7c['name']+'》:\x0a'+_0x3d3348);}}));const _0x4967f3=_0x53d851[_0x38a19f(0x10f2)]['find'](_0x335b06=>_0x335b06[_0x38a19f(0x234)]==='豆瓣设定');let _0x5a519b='',_0x3e8a3d=[];_0x4967f3&&_0x4967f3[_0x38a19f(0x73e)][_0x38a19f(0xeaf)](_0x5292e7=>{const _0x20ba34=_0x38a19f;_0x5292e7[_0x20ba34(0x1445)][_0x20ba34(0x6e9)](_0x20ba34(0xa42))&&(_0x5a519b+=_0x20ba34(0x1066)+_0x5292e7[_0x20ba34(0x73e)]);if(_0x5292e7[_0x20ba34(0x1445)][_0x20ba34(0x6e9)](_0x20ba34(0x4e8))){const _0x38ea07=_0x5292e7[_0x20ba34(0x73e)][_0x20ba34(0x13e8)]('\x0a');_0x38ea07[_0x20ba34(0xeaf)](_0x5d49ab=>{const _0xc57aa6=_0x20ba34,_0x5b3c0b=_0x5d49ab['match'](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x5b3c0b&&_0x3e8a3d['push']({'name':_0x5b3c0b[0x1]['trim'](),'persona':_0x5b3c0b[0x2][_0xc57aa6(0x13bc)]()});});}});const _0x3be23f=_0x53d851[_0x38a19f(0xa74)][_0x38a19f(0x1005)]||'我',_0x3c78fd=_0x11c788[_0x38a19f(0x29d)]>0x0&&_0x53d851['chats'][_0x11c788[0x0]]?_0x53d851['chats'][_0x11c788[0x0]]['settings'][_0x38a19f(0xab1)]:_0x38a19f(0x970);let _0x255413='';_0x11c788[_0x38a19f(0xeaf)](_0x3ae7d4=>{const _0x3acc9d=_0x38a19f,_0x4b5996=_0x53d851[_0x3acc9d(0xaa3)][_0x3ae7d4];if(_0x4b5996){const _0x11589d=_0x4b5996['longTermMemory']&&_0x4b5996[_0x3acc9d(0x1016)][_0x3acc9d(0x29d)]>0x0?_0x4b5996[_0x3acc9d(0x1016)][_0x3acc9d(0xcb4)](_0xd8c5eb=>_0xd8c5eb[_0x3acc9d(0x73e)])['join'](';\x20'):'无',_0xdafaf=_0x4b5996[_0x3acc9d(0xe83)]['slice'](-0xa)['map'](_0x1af96c=>(_0x1af96c[_0x3acc9d(0xb4d)]===_0x3acc9d(0x10ae)?_0x3be23f:_0x4b5996[_0x3acc9d(0x234)])+':\x20'+String(_0x1af96c[_0x3acc9d(0x73e)])[_0x3acc9d(0xad6)](0x0,0x1e)+_0x3acc9d(0x95d))[_0x3acc9d(0x2c8)]('\x0a');_0x255413+='\x0a<character>\x0a\x20\x20<name>'+_0x4b5996[_0x3acc9d(0x234)]+'</name>\x0a\x20\x20<persona>'+_0x4b5996[_0x3acc9d(0x81e)]['aiPersona']+_0x3acc9d(0x110b)+_0x11589d+_0x3acc9d(0x1328)+_0xdafaf+_0x3acc9d(0x2eb);}}),_0x3e8a3d[_0x38a19f(0xeaf)](_0x233f34=>{const _0x2f53d1=_0x38a19f;_0x255413+=_0x2f53d1(0x5c0)+_0x233f34[_0x2f53d1(0x234)]+_0x2f53d1(0xd78)+_0x233f34[_0x2f53d1(0x11fb)]+'</persona>\x0a</character>\x0a';});const _0x4b7b20=new Date(),_0x200cdf=_0x4b7b20['toLocaleString']('zh-CN',{'dateStyle':_0x38a19f(0xbcc),'timeStyle':_0x38a19f(0xa18)}),_0x229ac8=_0x53d851[_0x38a19f(0x906)][_0x38a19f(0x106b)]||0xc,_0x16d322=_0x53d851['globalSettings'][_0x38a19f(0x12fe)]||0x14,_0x50e470=_0x38a19f(0xec2)+_0x229ac8+'到'+_0x16d322+_0x38a19f(0xeb4)+_0x200cdf+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的帖子和评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“'+_0x3be23f+_0x38a19f(0x13eb)+_0x3be23f+_0x38a19f(0xcc8)+_0x5a519b+'\x0a'+_0x4476e4+_0x38a19f(0x134a)+_0x200cdf+_0x38a19f(0x79b)+_0x3be23f+'\x0a-\x20**人设**:\x20'+_0x3c78fd+'\x0a\x0a#\x20统一角色列表\x20(你扮演的角色\x20+\x20路人NPC)\x0a'+_0x255413+_0x38a19f(0x2b9);try{const _0x34463f=[{'role':'user','content':_0x38a19f(0xf8b)}];let _0xddbd1e=_0x908835[_0x38a19f(0x6e9)](_0x38a19f(0x1046)),_0x5afb1=_0x1697e7(_0x300f40,_0x4eb54e,_0x50e470,_0x34463f);const _0x552fda=_0xddbd1e?await fetch(_0x5afb1['url'],_0x5afb1[_0x38a19f(0xd7c)]):await fetch(_0x908835+_0x38a19f(0x434),{'method':_0x38a19f(0xa4e),'headers':{'Content-Type':_0x38a19f(0x85b),'Authorization':_0x38a19f(0x841)+_0x4eb54e},'body':JSON[_0x38a19f(0xe1e)]({'model':_0x300f40,'messages':[{'role':_0x38a19f(0xab3),'content':_0x50e470},..._0x34463f],'temperature':_0x53d851[_0x38a19f(0x906)][_0x38a19f(0xaf8)]||0x1})});if(!_0x552fda['ok'])throw new Error(_0x38a19f(0x352)+_0x552fda[_0x38a19f(0x5c1)]);const _0x7252f6=await _0x552fda['json'](),_0x14b5de=getGeminiResponseText(_0x7252f6),_0x4830ce=_0x14b5de['match'](/\[[\s\S]*\]/);if(!_0x4830ce)throw new Error(_0x38a19f(0xfe3)+_0x14b5de);const _0x5ea174=JSON[_0x38a19f(0x367)](_0x4830ce[0x0]);await _0xa62efb[_0x38a19f(0x360)][_0x38a19f(0xfcf)](),await _0xa62efb[_0x38a19f(0x360)][_0x38a19f(0x1386)](_0x5ea174[_0x38a19f(0xcb4)](_0x4f7ccd=>({..._0x4f7ccd,'timestamp':Date['now']()-Math[_0x38a19f(0xac4)]()*0x186a0}))),await _0x529c6c();}catch(_0x40d1c6){console[_0x38a19f(0x617)]('生成豆瓣帖子失败:',_0x40d1c6),await _0x184397(_0x38a19f(0x3eb),_0x38a19f(0x8d4)+_0x40d1c6[_0x38a19f(0x875)]);}}async function _0xc712f7(_0x1b6ae9){const _0x6cf578=_0x13d875;_0x541a81(_0x6cf578(0x969)),_0x2aa15f=_0x1b6ae9;const _0x17b004=await _0xa62efb[_0x6cf578(0x360)][_0x6cf578(0x883)](_0x1b6ae9);if(!_0x17b004){_0x541a81(_0x6cf578(0x807));return;}document[_0x6cf578(0x53a)](_0x6cf578(0x7c9))[_0x6cf578(0x34a)]=_0x6cf578(0x559);let _0x255703=_0x5d06c0,_0x543c6e=_0x17b004[_0x6cf578(0x3dd)];const _0x188dba=_0x17b004[_0x6cf578(0xd2f)]?Object['values'](_0x53d851[_0x6cf578(0xaa3)])[_0x6cf578(0x397)](_0x5ed927=>!_0x5ed927['isGroup']&&_0x5ed927['originalName']===_0x17b004[_0x6cf578(0xd2f)]):null;if(_0x188dba)_0x255703=_0x188dba[_0x6cf578(0x81e)][_0x6cf578(0x9e3)];else{const _0x1176b4=Object['values'](_0x53d851[_0x6cf578(0xaa3)])['find'](_0xd65baa=>!_0xd65baa[_0x6cf578(0x86e)]&&_0xd65baa[_0x6cf578(0x234)]===_0x17b004[_0x6cf578(0x3dd)]);if(_0x1176b4)_0x255703=_0x1176b4[_0x6cf578(0x81e)][_0x6cf578(0x9e3)];else _0x17b004['authorAvatarPrompt']&&(_0x255703=_0x6cf578(0x9ce)+encodeURIComponent(_0x17b004['authorAvatarPrompt']));}document[_0x6cf578(0x53a)](_0x6cf578(0x1442))[_0x6cf578(0x7ff)]=_0x255703,document[_0x6cf578(0x53a)]('douban-detail-author')[_0x6cf578(0x34a)]=_0x543c6e,document[_0x6cf578(0x53a)](_0x6cf578(0x84b))[_0x6cf578(0x34a)]=_0x6cf578(0x422)+_0x17b004[_0x6cf578(0x5f8)],document['getElementById'](_0x6cf578(0xf4a))[_0x6cf578(0x34a)]=_0x17b004[_0x6cf578(0x68f)],document[_0x6cf578(0x53a)](_0x6cf578(0xff5))['innerHTML']=_0x17b004[_0x6cf578(0x73e)][_0x6cf578(0x795)](/\n/g,'<br>'),document[_0x6cf578(0x53a)]('douban-my-comment-avatar')[_0x6cf578(0x7ff)]=_0x53d851[_0x6cf578(0xa74)][_0x6cf578(0x8cd)],document[_0x6cf578(0x53a)](_0x6cf578(0x13c4))[_0x6cf578(0x11a2)]='';const _0x445f89=document[_0x6cf578(0x53a)]('douban-detail-comments-list');_0x445f89[_0x6cf578(0xaac)]='';if(_0x17b004[_0x6cf578(0x11ed)]&&_0x17b004['comments'][_0x6cf578(0x29d)]>0x0){const _0xe50f12=new Map();_0x17b004[_0x6cf578(0x11ed)][_0x6cf578(0xeaf)](_0x3fed1a=>{const _0x22fe4b=_0x6cf578;let _0x558375=_0x5d06c0;const _0x413156=_0x53d851[_0x22fe4b(0xa74)]['nickname']||'我',_0x2a8940=_0x3fed1a[_0x22fe4b(0x5c4)];if(_0xe50f12[_0x22fe4b(0x11af)](_0x2a8940))_0x558375=_0xe50f12[_0x22fe4b(0x883)](_0x2a8940);else{if(_0x2a8940===_0x413156)_0x558375=_0x53d851['qzoneSettings']['avatar'];else{if(_0x2a8940===_0x17b004[_0x22fe4b(0x3dd)])_0x558375=_0x255703;else{const _0x557c87=_0x3fed1a[_0x22fe4b(0x65c)]?Object[_0x22fe4b(0x244)](_0x53d851['chats'])[_0x22fe4b(0x397)](_0x5d1a25=>!_0x5d1a25['isGroup']&&_0x5d1a25['originalName']===_0x3fed1a[_0x22fe4b(0x65c)]):null;if(_0x557c87)_0x558375=_0x557c87[_0x22fe4b(0x81e)][_0x22fe4b(0x9e3)];else{const _0x2a2ce4=Object[_0x22fe4b(0x244)](_0x53d851[_0x22fe4b(0xaa3)])[_0x22fe4b(0x397)](_0x30f1ae=>!_0x30f1ae[_0x22fe4b(0x86e)]&&_0x30f1ae[_0x22fe4b(0x234)]===_0x2a8940);if(_0x2a2ce4)_0x558375=_0x2a2ce4[_0x22fe4b(0x81e)][_0x22fe4b(0x9e3)];else _0x3fed1a[_0x22fe4b(0x122f)]&&(_0x558375=_0x22fe4b(0x9ce)+encodeURIComponent(_0x3fed1a[_0x22fe4b(0x122f)]));}}}_0xe50f12[_0x22fe4b(0xf2b)](_0x2a8940,_0x558375);}const _0x4d61ee=document['createElement'](_0x22fe4b(0x1425));_0x4d61ee[_0x22fe4b(0x6de)]='douban-comment-item',_0x4d61ee[_0x22fe4b(0xaac)]=_0x22fe4b(0x142f)+_0x558375+_0x22fe4b(0xc6a)+_0x2a8940+_0x22fe4b(0xd70)+_0x3fed1a[_0x22fe4b(0x2e6)][_0x22fe4b(0x795)](/\n/g,_0x22fe4b(0x596))+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x445f89[_0x22fe4b(0x133d)](_0x4d61ee);});}else _0x445f89[_0x6cf578(0xaac)]=_0x6cf578(0xa40);const _0x454074=document['getElementById'](_0x6cf578(0x48e));if(_0x454074)_0x454074[_0x6cf578(0xf68)]=0x0;}async function _0x2bf047(){const _0x4b5bb8=_0x13d875;if(!_0x2aa15f)return;const _0x5d4c3f=document['getElementById'](_0x4b5bb8(0x13c4)),_0x2cddd1=_0x5d4c3f[_0x4b5bb8(0x11a2)][_0x4b5bb8(0x13bc)]();if(!_0x2cddd1)return;const _0x31ce5d=await _0xa62efb[_0x4b5bb8(0x360)][_0x4b5bb8(0x883)](_0x2aa15f);if(!_0x31ce5d)return;!_0x31ce5d[_0x4b5bb8(0x11ed)]&&(_0x31ce5d[_0x4b5bb8(0x11ed)]=[]);const _0x1597c9=_0x53d851[_0x4b5bb8(0xa74)][_0x4b5bb8(0x1005)]||'我';_0x31ce5d[_0x4b5bb8(0x11ed)]['push']({'commenter':_0x1597c9,'text':_0x2cddd1}),_0x31ce5d[_0x4b5bb8(0x664)]++,await _0xa62efb[_0x4b5bb8(0x360)]['put'](_0x31ce5d),_0x5d4c3f[_0x4b5bb8(0x11a2)]='',await _0xc712f7(_0x2aa15f);}async function _0x1c6454(){const _0x3116f7=_0x13d875;if(!_0x2aa15f)return;const _0x2f5bcb=_0x2aa15f,_0x32aef8=await _0xa62efb[_0x3116f7(0x360)]['get'](_0x2f5bcb);if(!_0x32aef8)return;const _0x212273=_0x32aef8['comments']&&_0x32aef8['comments'][_0x3116f7(0x1340)](-0x1)[0x0];if(!_0x212273){alert('还没有任何评论，无法等待回复。');return;}await _0x184397('请稍候...','正在请求AI角色们加入讨论...');try{const {proxyUrl:_0x3cacce,apiKey:_0xe452be,model:_0x39846e}=_0x53d851[_0x3116f7(0x80d)];if(!_0x3cacce||!_0xe452be||!_0x39846e)throw new Error(_0x3116f7(0x69f));const _0x3f4b98=_0x53d851['qzoneSettings'][_0x3116f7(0x1005)]||'我',_0x365b5f=_0x53d851[_0x3116f7(0xaa3)][Object[_0x3116f7(0x1350)](_0x53d851[_0x3116f7(0xaa3)])[0x0]]?.[_0x3116f7(0x81e)][_0x3116f7(0xab1)]||'(未设置)',_0x32de9d=new Map();_0x32aef8[_0x3116f7(0x11ed)]&&_0x32aef8['comments'][_0x3116f7(0xeaf)](_0x1e28a1=>{const _0x3c5b82=_0x3116f7,_0x499f62=(_0x53d851[_0x3c5b82(0x906)][_0x3c5b82(0x12a4)]||[])[_0x3c5b82(0xe0f)](_0x49d1d5=>_0x53d851[_0x3c5b82(0xaa3)][_0x49d1d5]?.['name']===_0x1e28a1[_0x3c5b82(0x5c4)]);!_0x499f62&&_0x1e28a1[_0x3c5b82(0x122f)]&&_0x32de9d['set'](_0x1e28a1[_0x3c5b82(0x5c4)],_0x1e28a1['avatar_prompt']);});let _0x55d07a=_0x3116f7(0x56a);_0x32de9d['size']>0x0?(_0x55d07a+=_0x3116f7(0x7d4),_0x32de9d[_0x3116f7(0xeaf)]((_0x112cdb,_0x3c0e4b)=>{const _0x4eec65=_0x3116f7;_0x55d07a+=_0x4eec65(0x846)+_0x3c0e4b+_0x4eec65(0xa2b)+_0x112cdb+'\x22\x0a';})):_0x55d07a+=_0x3116f7(0x444);const _0x3104c5=_0x53d851[_0x3116f7(0x10f2)]['find'](_0x1c88d5=>_0x1c88d5[_0x3116f7(0x234)]===_0x3116f7(0x27b));let _0x465641=[];_0x3104c5&&_0x3104c5[_0x3116f7(0x73e)]['forEach'](_0x11bf19=>{const _0xd21b76=_0x3116f7;if(_0x11bf19['comment']['includes'](_0xd21b76(0x4e8))){const _0x443c52=_0x11bf19[_0xd21b76(0x73e)][_0xd21b76(0x13e8)]('\x0a');_0x443c52[_0xd21b76(0xeaf)](_0x5a3d19=>{const _0x331fda=_0xd21b76,_0x38c3be=_0x5a3d19[_0x331fda(0x1120)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x38c3be&&_0x465641[_0x331fda(0x7dd)]({'name':_0x38c3be[0x1]['trim'](),'persona':_0x38c3be[0x2][_0x331fda(0x13bc)]()});});}});let _0x2f5af2='';const _0x583e3c=_0x53d851[_0x3116f7(0x906)][_0x3116f7(0x12a4)]||[];_0x583e3c['forEach'](_0x40223c=>{const _0x543bae=_0x3116f7,_0x713d0e=_0x53d851['chats'][_0x40223c];if(_0x713d0e){const _0x183fa7=_0x713d0e[_0x543bae(0x1016)]&&_0x713d0e['longTermMemory'][_0x543bae(0x29d)]>0x0?_0x713d0e[_0x543bae(0x1016)][_0x543bae(0xcb4)](_0x54e945=>_0x54e945[_0x543bae(0x73e)])[_0x543bae(0x2c8)](';\x20'):'无',_0x5a9a0b=_0x713d0e[_0x543bae(0xe83)]['slice'](-0xa)[_0x543bae(0xcb4)](_0x324278=>(_0x324278['role']==='user'?_0x3f4b98:_0x713d0e[_0x543bae(0x234)])+':\x20'+String(_0x324278['content'])[_0x543bae(0xad6)](0x0,0x1e)+_0x543bae(0x95d))[_0x543bae(0x2c8)]('\x0a');_0x2f5af2+=_0x543bae(0xf07)+_0x713d0e['name']+':\x20'+_0x713d0e[_0x543bae(0x81e)]['aiPersona']['substring'](0x0,0x32)+_0x543bae(0xbf4)+_0x183fa7+_0x543bae(0x370)+_0x5a9a0b+']';}}),_0x465641[_0x3116f7(0xeaf)](_0x1fce80=>{const _0x37039f=_0x3116f7;_0x2f5af2+='\x0a-\x20'+_0x1fce80[_0x37039f(0x234)]+':\x20'+_0x1fce80['persona'];});const _0x3d8aa7=new Date(),_0x11e3bb=_0x3d8aa7[_0x3116f7(0x5ee)](_0x3116f7(0x42f),{'dateStyle':_0x3116f7(0xbcc),'timeStyle':_0x3116f7(0xa18)}),_0x3bbf73=_0x3116f7(0x62e)+_0x3f4b98+_0x3116f7(0x64b)+_0x11e3bb+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“'+_0x3f4b98+_0x3116f7(0x11b8)+_0x3f4b98+_0x3116f7(0xf41)+_0x32aef8[_0x3116f7(0x68f)]+_0x3116f7(0x7cf)+_0x32aef8['authorName']+_0x3116f7(0x2d1)+_0x32aef8[_0x3116f7(0x73e)][_0x3116f7(0xad6)](0x0,0x64)+'...\x0a-\x20**已有评论**:\x0a'+_0x32aef8[_0x3116f7(0x11ed)][_0x3116f7(0xcb4)](_0x2a997e=>'-\x20'+_0x2a997e[_0x3116f7(0x5c4)]+':\x20'+_0x2a997e['text'])[_0x3116f7(0x2c8)]('\x0a')+'\x0a\x0a'+_0x55d07a+'\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20'+_0x11e3bb+_0x3116f7(0x113d)+_0x3f4b98+_0x3116f7(0x7ef)+_0x365b5f+_0x3116f7(0x5b4)+_0x2f5af2+'\x0a\x0a现在，请生成新的评论。',_0x17ab4f=[{'role':_0x3116f7(0x10ae),'content':_0x3116f7(0x1067)}];let _0x5ee526=_0x3cacce['includes'](_0x3116f7(0x1046)),_0x4dfc94=_0x1697e7(_0x39846e,_0xe452be,_0x3bbf73,_0x17ab4f);const _0x4e8371=_0x5ee526?await fetch(_0x4dfc94[_0x3116f7(0xb36)],_0x4dfc94[_0x3116f7(0xd7c)]):await fetch(_0x3cacce+_0x3116f7(0x434),{'method':_0x3116f7(0xa4e),'headers':{'Content-Type':_0x3116f7(0x85b),'Authorization':_0x3116f7(0x841)+_0xe452be},'body':JSON[_0x3116f7(0xe1e)]({'model':_0x39846e,'messages':[{'role':_0x3116f7(0xab3),'content':_0x3bbf73},..._0x17ab4f],'temperature':_0x53d851[_0x3116f7(0x906)]['apiTemperature']||0x1})});if(!_0x4e8371['ok'])throw new Error('API\x20错误:\x20'+_0x4e8371[_0x3116f7(0x5c1)]);const _0x25f72d=await _0x4e8371['json'](),_0x4d54ce=getGeminiResponseText(_0x25f72d),_0xcc3554=_0x4d54ce['replace'](/^```json\s*/,'')[_0x3116f7(0x795)](/```$/,''),_0x5765e5=JSON[_0x3116f7(0x367)](_0xcc3554);Array[_0x3116f7(0xb31)](_0x5765e5)&&_0x5765e5['length']>0x0&&(_0x32aef8[_0x3116f7(0x11ed)][_0x3116f7(0x7dd)](..._0x5765e5),_0x32aef8[_0x3116f7(0x664)]+=_0x5765e5[_0x3116f7(0x29d)],await _0xa62efb[_0x3116f7(0x360)][_0x3116f7(0x546)](_0x32aef8)),await _0xc712f7(_0x2f5bcb),_0x2e6322();}catch(_0x195af2){console[_0x3116f7(0x617)](_0x3116f7(0xa52),_0x195af2),await _0x184397('操作失败',_0x3116f7(0x323)+_0x195af2[_0x3116f7(0x875)]);}}async function _0x49fb9b(){const _0x8800d9=_0x13d875,_0xef584d=document[_0x8800d9(0x53a)](_0x8800d9(0x5a1)),_0x49c453=document[_0x8800d9(0x53a)](_0x8800d9(0x365));_0x49c453[_0x8800d9(0xaac)]='';const _0x3b9ac2=Object[_0x8800d9(0x244)](_0x53d851[_0x8800d9(0xaa3)])[_0x8800d9(0x2dd)](_0x4eca57=>!_0x4eca57['isGroup']),_0xb3969d=new Set(_0x53d851['globalSettings']['doubanActiveCharacterIds']||[]);_0x3b9ac2[_0x8800d9(0x29d)]===0x0?_0x49c453[_0x8800d9(0xaac)]=_0x8800d9(0x11dc):_0x3b9ac2[_0x8800d9(0xeaf)](_0x205f7c=>{const _0x28c954=_0x8800d9,_0x21665f=document[_0x28c954(0xd67)]('div');_0x21665f['className']=_0x28c954(0xa94),_0x21665f[_0x28c954(0xaac)]=_0x28c954(0x13a6)+_0x205f7c['id']+'\x22\x20'+(_0xb3969d[_0x28c954(0x11af)](_0x205f7c['id'])?_0x28c954(0x1077):'')+_0x28c954(0x5fb)+(_0x205f7c[_0x28c954(0x81e)][_0x28c954(0x9e3)]||_0x5d06c0)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x205f7c[_0x28c954(0x234)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x49c453[_0x28c954(0x133d)](_0x21665f);}),_0xef584d[_0x8800d9(0x1276)][_0x8800d9(0xe13)](_0x8800d9(0xaef));}async function _0x29a4c2(){const _0x5087ab=_0x13d875,_0xf21986=document[_0x5087ab(0xc3d)]('#douban-cast-list\x20.douban-cast-checkbox:checked'),_0x5e53fa=Array['from'](_0xf21986)[_0x5087ab(0xcb4)](_0x21295b=>_0x21295b[_0x5087ab(0x999)][_0x5087ab(0x1054)]);_0x53d851['globalSettings'][_0x5087ab(0x12a4)]=_0x5e53fa,await _0xa62efb[_0x5087ab(0x906)][_0x5087ab(0x546)](_0x53d851[_0x5087ab(0x906)]),document[_0x5087ab(0x53a)](_0x5087ab(0x5a1))[_0x5087ab(0x1276)][_0x5087ab(0x2d4)](_0x5087ab(0xaef)),await _0x15bb1b();}document['getElementById']('douban-cast-select-btn')['addEventListener'](_0x13d875(0xb2b),_0x49fb9b),document[_0x13d875(0x53a)](_0x13d875(0x12f4))['addEventListener']('click',()=>{const _0x410f78=_0x13d875;document[_0x410f78(0x53a)](_0x410f78(0x5a1))[_0x410f78(0x1276)][_0x410f78(0x2d4)]('visible');}),document[_0x13d875(0x53a)](_0x13d875(0x213))[_0x13d875(0x1086)]('click',_0x29a4c2),document[_0x13d875(0x53a)](_0x13d875(0x365))['addEventListener'](_0x13d875(0xb2b),_0x109d33=>{const _0x308431=_0x13d875,_0x546e60=_0x109d33[_0x308431(0x9c2)][_0x308431(0x106f)](_0x308431(0x1395));if(_0x546e60){const _0x57371e=_0x546e60[_0x308431(0x139c)](_0x308431(0xa0a));_0x57371e&&_0x109d33[_0x308431(0x9c2)]!==_0x57371e&&(_0x57371e[_0x308431(0x1077)]=!_0x57371e['checked']);}});async function _0x1ebad4(_0x2ee80e){const _0x7383e1=_0x13d875;if(!_0x2ee80e)return;const _0x5de07d=await _0x355fc0('导入外观设置',_0x7383e1(0x2a9),{'confirmText':_0x7383e1(0x34c)});if(!_0x5de07d)return;try{const _0x3b59eb=await _0x2ee80e[_0x7383e1(0x2e6)](),_0x463cb8=JSON['parse'](_0x3b59eb);if(!_0x463cb8[_0x7383e1(0x8ee)]&&!_0x463cb8[_0x7383e1(0x114d)]&&!_0x463cb8[_0x7383e1(0xb97)])throw new Error(_0x7383e1(0x773));Object[_0x7383e1(0x100b)](_0x53d851[_0x7383e1(0x906)],_0x463cb8),await _0xa62efb['globalSettings'][_0x7383e1(0x546)](_0x53d851[_0x7383e1(0x906)]),_0x1ce9d9(),_0x4b6d38(),_0x40e495(),_0x201b82(),_0x1c3306(_0x53d851[_0x7383e1(0x906)]['globalCss']),_0x281d80(_0x53d851['globalSettings'][_0x7383e1(0x9a0)]),_0x39c21c(),_0x3ec9da(),_0x24b0a8(),await _0x184397(_0x7383e1(0x11c0),_0x7383e1(0x670));}catch(_0x1afe05){console[_0x7383e1(0x617)](_0x7383e1(0x3ba),_0x1afe05),await _0x184397(_0x7383e1(0x3a1),_0x7383e1(0xa30)+_0x1afe05[_0x7383e1(0x875)]);}}async function _0x2f09a3(_0x495cfd){const _0x42729c=_0x13d875;console['log'](_0x42729c(0xf05)+_0x495cfd[_0x42729c(0x39e)](0x1)+_0x42729c(0x8b9));const _0x5ab4b4=Object[_0x42729c(0x244)](_0x53d851['chats'])['filter'](_0x38ebbd=>!_0x38ebbd[_0x42729c(0x86e)]&&_0x38ebbd[_0x42729c(0x81e)][_0x42729c(0x527)]&&_0x38ebbd[_0x42729c(0x1333)]?.[_0x42729c(0x12d3)]==='friend');if(_0x5ab4b4[_0x42729c(0x29d)]===0x0){console['log'](_0x42729c(0x1160));return;}for(const _0x54520a of _0x5ab4b4){const _0x421f3d=_0x54520a[_0x42729c(0x81e)]['actionCooldownMinutes']||0xf,_0x32d2ba=_0x54520a[_0x42729c(0xa28)]?(Date[_0x42729c(0x9c1)]()-_0x54520a[_0x42729c(0xa28)])/(0x3e8*0x3c):Infinity;_0x495cfd>_0x421f3d&&_0x32d2ba>_0x421f3d&&(Math[_0x42729c(0xac4)]()<0.3&&(console[_0x42729c(0x1081)](_0x42729c(0x6fc)+_0x54520a[_0x42729c(0x234)]+_0x42729c(0xf73)),Math[_0x42729c(0xac4)]()<0.7?await _0x41526b(_0x54520a['id']):console[_0x42729c(0x1081)]('角色\x20\x22'+_0x54520a[_0x42729c(0x234)]+_0x42729c(0x2c6))));}}function _0x3479dd(){const _0x4a1cb3=_0x13d875;if(!_0x53d851['activeChatId'])return;const _0x37b125=_0x53d851[_0x4a1cb3(0xaa3)][_0x53d851[_0x4a1cb3(0x13be)]];document[_0x4a1cb3(0x53a)](_0x4a1cb3(0x27d))[_0x4a1cb3(0x11a2)]='',document[_0x4a1cb3(0x53a)]('date-search-input')['value']='',document[_0x4a1cb3(0x53a)](_0x4a1cb3(0x126a))['innerHTML']=_0x4a1cb3(0xceb),_0x541a81('search-history-screen');}async function _0x1bd1f0(){const _0x312323=_0x13d875,_0x16ac9e=_0x53d851[_0x312323(0xaa3)][_0x53d851[_0x312323(0x13be)]];if(!_0x16ac9e)return;const _0x3aaacb=document[_0x312323(0x53a)](_0x312323(0x27d))['value'][_0x312323(0x13bc)]()[_0x312323(0x12b5)](),_0x3b2984=document[_0x312323(0x53a)]('date-search-input')[_0x312323(0x11a2)];if(!_0x3aaacb&&!_0x3b2984){alert('请输入关键词或选择一个日期。');return;}let _0x1f20f0=_0x16ac9e[_0x312323(0xe83)][_0x312323(0x2dd)](_0x53b32d=>!_0x53b32d['isHidden']);_0x3aaacb&&(_0x1f20f0=_0x1f20f0['filter'](_0x80dde9=>{const _0x2529a6=_0x312323;let _0x500afd='';if(typeof _0x80dde9[_0x2529a6(0x73e)]===_0x2529a6(0xfc5))_0x500afd=_0x80dde9[_0x2529a6(0x73e)];else{if(_0x80dde9[_0x2529a6(0x919)]===_0x2529a6(0x64f))_0x500afd=_0x80dde9['content'];else{if(_0x80dde9[_0x2529a6(0x919)]===_0x2529a6(0x2a5)||_0x80dde9[_0x2529a6(0x919)]===_0x2529a6(0x1053))_0x500afd=_0x80dde9[_0x2529a6(0x73e)];else{if(_0x80dde9[_0x2529a6(0x919)]===_0x2529a6(0x8c3))_0x500afd=(_0x80dde9[_0x2529a6(0x1266)]||'')+'\x20'+(_0x80dde9['description']||'');else _0x80dde9[_0x2529a6(0x6a2)]&&(_0x500afd=_0x80dde9[_0x2529a6(0x73e)]);}}}return _0x500afd[_0x2529a6(0x12b5)]()[_0x2529a6(0x6e9)](_0x3aaacb);}));if(_0x3b2984){const _0x26edf4=new Date(_0x3b2984),_0x186d9a=new Date(_0x26edf4['setHours'](0x0,0x0,0x0,0x0))[_0x312323(0x984)](),_0x142b82=new Date(_0x26edf4[_0x312323(0x519)](0x17,0x3b,0x3b,0x3e7))[_0x312323(0x984)]();_0x1f20f0=_0x1f20f0[_0x312323(0x2dd)](_0x45ef0e=>_0x45ef0e[_0x312323(0x827)]>=_0x186d9a&&_0x45ef0e[_0x312323(0x827)]<=_0x142b82);}await _0xdff105(_0x1f20f0);}async function _0xdff105(_0x2fa992){const _0x3bcaaf=_0x13d875,_0x44e200=document['getElementById']('chat-search-results-list'),_0x4c8db4=_0x53d851[_0x3bcaaf(0xaa3)][_0x53d851[_0x3bcaaf(0x13be)]];_0x44e200['innerHTML']='';if(_0x2fa992['length']===0x0){_0x44e200[_0x3bcaaf(0xaac)]=_0x3bcaaf(0x20d);return;}let _0xade990='';for(const _0x4f602a of _0x2fa992){const _0x51eaff=new Date(_0x4f602a[_0x3bcaaf(0x827)]),_0x12a0e1=_0x51eaff[_0x3bcaaf(0xc76)]();if(_0x12a0e1!==_0xade990){const _0x3a0765=document['createElement'](_0x3bcaaf(0x1425));_0x3a0765[_0x3bcaaf(0x6de)]='date-separator',_0x3a0765[_0x3bcaaf(0x34a)]=_0x3bcaaf(0x1035)+_0x51eaff[_0x3bcaaf(0xf14)]()+'年'+(_0x51eaff['getMonth']()+0x1)+'月'+_0x51eaff['getDate']()+'日\x20---',_0x44e200[_0x3bcaaf(0x133d)](_0x3a0765),_0xade990=_0x12a0e1;}const _0x8e96e7=await _0x36bd8d(_0x4f602a,_0x4c8db4);_0x8e96e7&&(_0x8e96e7[_0x3bcaaf(0x1284)][_0x3bcaaf(0x98c)]=_0x3bcaaf(0xc28),_0x8e96e7['addEventListener'](_0x3bcaaf(0xb2b),()=>_0x28c862(_0x4f602a[_0x3bcaaf(0x827)])),_0x44e200['appendChild'](_0x8e96e7));}}async function _0x28c862(_0x1ae452){const _0x8eab4c=_0x13d875,_0x22cb12=_0x53d851[_0x8eab4c(0x13be)];if(!_0x22cb12)return;_0x541a81(_0x8eab4c(0x10ba)),setTimeout(async()=>{const _0x28a345=_0x8eab4c,_0x5da93a=document[_0x28a345(0x53a)](_0x28a345(0xa33)),_0x5a32fc=_0x28a345(0x3a9)+_0x1ae452+'\x22]';let _0x216327=_0x5da93a[_0x28a345(0x139c)](_0x5a32fc),_0x123b0d=0x0;const _0xaf2948=0x14;while(!_0x216327&&_0x123b0d<_0xaf2948){const _0x33769c=document['getElementById'](_0x28a345(0x5bc));if(_0x33769c)console[_0x28a345(0x1081)]('目标消息未找到,\x20正在加载更多历史记录...\x20(尝试\x20'+(_0x123b0d+0x1)+')'),await _0xe8662(),_0x216327=_0x5da93a['querySelector'](_0x5a32fc),_0x123b0d++;else break;}_0x74d5de(_0x1ae452);},0xc8);}async function _0x94673e(){const _0xaef7c7=_0x13d875;document[_0xaef7c7(0x53a)]('keyword-search-input')[_0xaef7c7(0x11a2)]='',document[_0xaef7c7(0x53a)](_0xaef7c7(0xc20))[_0xaef7c7(0x11a2)]='',await _0xdff105(_0x53d851[_0xaef7c7(0xaa3)][_0x53d851[_0xaef7c7(0x13be)]]['history']['filter'](_0x37a0b6=>!_0x37a0b6['isHidden']));}async function _0x2a4fbf(_0x22d6d6=![],_0x1431ad=null,_0x2e86a7=null){const _0x21237f=_0x13d875,_0x3fc26d=document['getElementById'](_0x21237f(0x640)),_0x1c6de4=document[_0x21237f(0x53a)](_0x21237f(0x1037)),_0x2f2b5c=_0x53d851[_0x21237f(0xaa3)][_0x53d851['activeChatId']];_0x3fc26d[_0x21237f(0xaac)]='',_0x1c6de4[_0x21237f(0xaac)]='';const _0x282044=await _0xa62efb['customAvatarFrames'][_0x21237f(0xa73)](),_0x2a3a5d=[..._0x903668,..._0x282044];document[_0x21237f(0x139c)](_0x21237f(0x3a0))['style'][_0x21237f(0x11d9)]=_0x22d6d6?_0x21237f(0xbf2):'flex',document[_0x21237f(0x53a)]('ai-frame-content')['style']['display']=_0x21237f(0x1ea),document[_0x21237f(0x53a)](_0x21237f(0x7b7))[_0x21237f(0x1284)][_0x21237f(0x11d9)]=_0x21237f(0xbf2),document[_0x21237f(0x53a)](_0x21237f(0x7ad))['classList']['add'](_0x21237f(0xdf6)),document[_0x21237f(0x53a)](_0x21237f(0x126e))['classList'][_0x21237f(0x2d4)](_0x21237f(0xdf6));if(_0x22d6d6)_0x2a3a5d['forEach'](_0x268bb3=>{const _0x599bcf=_0x21237f,_0x1e1504=_0x47a309(_0x268bb3,'my',_0x1431ad);_0x268bb3[_0x599bcf(0xb36)]===_0x2e86a7&&_0x1e1504['classList'][_0x599bcf(0xe13)]('selected'),_0x3fc26d[_0x599bcf(0x133d)](_0x1e1504);});else{const _0x35baf8=_0x2f2b5c[_0x21237f(0x81e)]['aiAvatar']||_0x5d06c0,_0x4265d7=_0x2f2b5c[_0x21237f(0x81e)][_0x21237f(0x971)]||(_0x2f2b5c[_0x21237f(0x86e)]?_0x132d11:_0x5d06c0);_0x2a3a5d[_0x21237f(0xeaf)](_0x4761b2=>{const _0xd9ad60=_0x21237f,_0x12cbf0=_0x47a309(_0x4761b2,'ai',_0x35baf8);if(_0x4761b2[_0xd9ad60(0xb36)]===_0x515ef1['ai'])_0x12cbf0[_0xd9ad60(0x1276)][_0xd9ad60(0xe13)](_0xd9ad60(0x1015));_0x3fc26d[_0xd9ad60(0x133d)](_0x12cbf0);const _0x2fd682=_0x47a309(_0x4761b2,'my',_0x4265d7);if(_0x4761b2['url']===_0x515ef1['my'])_0x2fd682[_0xd9ad60(0x1276)][_0xd9ad60(0xe13)](_0xd9ad60(0x1015));_0x1c6de4[_0xd9ad60(0x133d)](_0x2fd682);});}}function _0x47a309(_0x1c996f,_0x5d53c3,_0xf0ab81){const _0x3f3aeb=_0x13d875,_0x37805c=document[_0x3f3aeb(0xd67)]('div');_0x37805c['className']=_0x3f3aeb(0x9b7),_0x37805c[_0x3f3aeb(0x999)][_0x3f3aeb(0x2f0)]=_0x1c996f[_0x3f3aeb(0xb36)],_0x37805c['title']=_0x1c996f[_0x3f3aeb(0x234)];const _0x5b4390=typeof _0x1c996f['id']===_0x3f3aeb(0x65d),_0x54e865=_0x5b4390?_0x3f3aeb(0x7ce)+_0x1c996f['id']+'\x22\x20style=\x22display:block;\x22>×</button>':'';return _0x37805c[_0x3f3aeb(0xaac)]=_0x3f3aeb(0x7b6)+_0x54e865+_0x3f3aeb(0x49f)+_0xf0ab81+_0x3f3aeb(0xe61)+(_0x1c996f[_0x3f3aeb(0xb36)]?_0x3f3aeb(0x88b)+_0x1c996f[_0x3f3aeb(0xb36)]+'\x22\x20class=\x22preview-frame\x22>':'')+'\x0a\x20\x20\x20\x20',_0x37805c[_0x3f3aeb(0x1086)](_0x3f3aeb(0xb2b),_0x2e5c86=>{const _0x2fdf6d=_0x3f3aeb;if(_0x2e5c86[_0x2fdf6d(0x9c2)][_0x2fdf6d(0x1276)][_0x2fdf6d(0x6a3)](_0x2fdf6d(0x2e3)))return;if(_0x5a5ea7){if(_0x5b4390){const _0x30c083=parseInt(_0x1c996f['id']);_0x37805c['classList'][_0x2fdf6d(0x4d7)](_0x2fdf6d(0x1015)),_0x4648e0[_0x2fdf6d(0x11af)](_0x30c083)?_0x4648e0[_0x2fdf6d(0x121e)](_0x30c083):_0x4648e0[_0x2fdf6d(0xe13)](_0x30c083),_0x94bdcf();}}else{_0x515ef1[_0x5d53c3]=_0x1c996f[_0x2fdf6d(0xb36)];const _0x74c931=_0x5d53c3==='ai'?document[_0x2fdf6d(0x53a)](_0x2fdf6d(0x640)):document[_0x2fdf6d(0x53a)](_0x2fdf6d(0x1037));_0x74c931['querySelectorAll'](_0x2fdf6d(0x8f2))['forEach'](_0x2185b6=>_0x2185b6[_0x2fdf6d(0x1276)][_0x2fdf6d(0x2d4)](_0x2fdf6d(0x1015))),_0x37805c[_0x2fdf6d(0x1276)]['add'](_0x2fdf6d(0x1015));}}),_0x37805c;}async function _0x6e4db6(){const _0x18b7ce=_0x13d875,_0xe34975=document[_0x18b7ce(0x53a)](_0x18b7ce(0xe7f)),_0x5158e1=await new Promise(_0x5a5d9a=>{const _0x19bb47=_0x18b7ce,_0x4561c1=_0x3d9eb6=>{const _0xe0847d=_0x55b8;_0x5a5d9a(_0x3d9eb6['target']['files'][0x0]||null),_0xe34975[_0xe0847d(0x5ce)](_0xe0847d(0x325),_0x4561c1);};_0xe34975[_0x19bb47(0x1086)]('change',_0x4561c1,{'once':!![]}),_0xe34975[_0x19bb47(0xb2b)]();});if(!_0x5158e1)return;const _0x3593b4=await _0x4f6537(_0x18b7ce(0x965),'请为这个新头像框起个名字');if(!_0x3593b4||!_0x3593b4[_0x18b7ce(0x13bc)]())return;const _0x378cf7=await new Promise(_0x3a9497=>{const _0x33c932=_0x18b7ce,_0xcda6f8=new FileReader();_0xcda6f8[_0x33c932(0x110f)]=()=>_0x3a9497(_0xcda6f8['result']),_0xcda6f8[_0x33c932(0x13b6)](_0x5158e1);});await _0xa62efb[_0x18b7ce(0xbdf)][_0x18b7ce(0xe13)]({'name':_0x3593b4[_0x18b7ce(0x13bc)](),'url':_0x378cf7}),_0x2a4fbf(_0x2c46d1);}async function _0x4e9556(){const _0x2204a6=_0x13d875,_0x4e5f14='请按照以下格式粘贴，一行一个：\x0a\x0a头像框名字1:\x20https://.../image1.png\x0a头像框名字2:\x20https://.../image2.gif',_0x12de8c=await _0x4f6537('批量导入头像框','从完整链接批量导入','','textarea',_0x2204a6(0xe39)+_0x4e5f14+_0x2204a6(0x12e2));if(!_0x12de8c||!_0x12de8c[_0x2204a6(0x13bc)]())return;const _0x495133=_0x12de8c[_0x2204a6(0x13bc)]()[_0x2204a6(0x13e8)]('\x0a'),_0x1bdb9d=[];let _0x3eacc5=0x0;for(const _0x2c9098 of _0x495133){const _0x3318f5=_0x2c9098[_0x2204a6(0x1120)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x3318f5)_0x1bdb9d[_0x2204a6(0x7dd)]({'name':_0x3318f5[0x1][_0x2204a6(0x13bc)](),'url':_0x3318f5[0x2][_0x2204a6(0x13bc)]()});else _0x2c9098['trim']()&&_0x3eacc5++;}_0x1bdb9d[_0x2204a6(0x29d)]>0x0&&(await _0xa62efb['customAvatarFrames'][_0x2204a6(0x1386)](_0x1bdb9d),_0x2a4fbf(_0x2c46d1),await _0x184397(_0x2204a6(0x11c0),_0x2204a6(0x534)+_0x1bdb9d[_0x2204a6(0x29d)]+'\x20个新头像框！')),_0x3eacc5>0x0&&await _0x184397('部分失败','有\x20'+_0x3eacc5+_0x2204a6(0xb74));}async function _0x53308b(_0x5cc174){const _0x51a959=_0x13d875,_0xa354e4=await _0xa62efb[_0x51a959(0xbdf)][_0x51a959(0x883)](_0x5cc174);if(!_0xa354e4)return;const _0x537711=await _0x355fc0(_0x51a959(0x69a),_0x51a959(0xddb)+_0xa354e4[_0x51a959(0x234)]+_0x51a959(0x2ec),{'confirmButtonClass':_0x51a959(0x264)});_0x537711&&(await _0xa62efb[_0x51a959(0xbdf)][_0x51a959(0x121e)](_0x5cc174),_0x2a4fbf(_0x2c46d1));}let _0x2a8656=0x0;const _0x495b56=0x2;function _0x29a16a(){const _0x5263b8=_0x13d875,_0x99d0fd=document[_0x5263b8(0x53a)](_0x5263b8(0x1186)),_0x4d11c4=document['getElementById'](_0x5263b8(0xf11)),_0x2e1270=document['querySelectorAll'](_0x5263b8(0x7a8));let _0x951a86=0x0,_0x16c1e5=0x0,_0x1839db=0x0,_0x437bd2=![],_0xaa205e=!![];const _0x1fdfc1=()=>{const _0x5f1273=_0x5263b8;_0x4d11c4['style'][_0x5f1273(0xd91)]=_0x5f1273(0x51b)+_0x2a8656*(0x64/_0x495b56)+'%)',_0x2e1270['forEach']((_0x54b809,_0x4a64a8)=>{const _0x46cf3a=_0x5f1273;_0x54b809[_0x46cf3a(0x1276)][_0x46cf3a(0x4d7)](_0x46cf3a(0xdf6),_0x4a64a8===_0x2a8656);});},_0x1251bf=_0x3b9ffd=>{const _0x308b20=_0x5263b8;_0x437bd2=!![],_0xaa205e=!![],_0x951a86=_0x3b9ffd['type']['includes']('mouse')?_0x3b9ffd[_0x308b20(0x33b)]:_0x3b9ffd[_0x308b20(0xd44)][0x0][_0x308b20(0x33b)],_0x16c1e5=_0x3b9ffd[_0x308b20(0x919)][_0x308b20(0x6e9)]('mouse')?_0x3b9ffd[_0x308b20(0x977)]:_0x3b9ffd[_0x308b20(0xd44)][0x0]['pageY'],_0x4d11c4[_0x308b20(0x1284)]['transition']=_0x308b20(0xbf2);},_0x55adfc=_0x45d5a5=>{const _0x23b3b1=_0x5263b8;if(!_0x437bd2)return;const _0x1a31e2=_0x45d5a5[_0x23b3b1(0x919)][_0x23b3b1(0x6e9)](_0x23b3b1(0xd4e))?_0x45d5a5['pageY']:_0x45d5a5['touches'][0x0]['pageY'];_0x1839db=_0x45d5a5['type'][_0x23b3b1(0x6e9)](_0x23b3b1(0xd4e))?_0x45d5a5[_0x23b3b1(0x33b)]:_0x45d5a5[_0x23b3b1(0xd44)][0x0][_0x23b3b1(0x33b)];const _0x117929=_0x1839db-_0x951a86,_0x45997f=_0x1a31e2-_0x16c1e5;_0xaa205e&&(Math['abs'](_0x117929)>0xa||Math['abs'](_0x45997f)>0xa)&&(_0xaa205e=![]);if(Math[_0x23b3b1(0xc05)](_0x117929)>Math[_0x23b3b1(0xc05)](_0x45997f)){if(_0x45d5a5[_0x23b3b1(0xfac)])_0x45d5a5[_0x23b3b1(0x1013)]();_0x4d11c4[_0x23b3b1(0x1284)][_0x23b3b1(0xd91)]='translateX(calc(-'+_0x2a8656*(0x64/_0x495b56)+'%\x20+\x20'+_0x117929+_0x23b3b1(0x9da);}},_0x43f1b3=_0x7c3591=>{const _0x3a6c9e=_0x5263b8;if(!_0x437bd2)return;_0x437bd2=![],_0x4d11c4[_0x3a6c9e(0x1284)][_0x3a6c9e(0x64c)]='transform\x200.4s\x20cubic-bezier(0.4,\x200,\x200.2,\x201)';if(_0xaa205e){_0x1fdfc1();return;}const _0xc0f1e8=_0x1839db-_0x951a86;if(Math[_0x3a6c9e(0xc05)](_0xc0f1e8)>_0x99d0fd['offsetWidth']/0x4){if(_0xc0f1e8>0x0&&_0x2a8656>0x0)_0x2a8656--;else _0xc0f1e8<0x0&&_0x2a8656<_0x495b56-0x1&&_0x2a8656++;}_0x1fdfc1();};_0x99d0fd['addEventListener'](_0x5263b8(0xff3),_0x1251bf),_0x99d0fd['addEventListener'](_0x5263b8(0xef3),_0x55adfc),_0x99d0fd['addEventListener'](_0x5263b8(0xacd),_0x43f1b3),_0x99d0fd[_0x5263b8(0x1086)]('mouseleave',_0x43f1b3),_0x99d0fd[_0x5263b8(0x1086)](_0x5263b8(0x3bc),_0x1251bf,{'passive':![]}),_0x99d0fd['addEventListener'](_0x5263b8(0xd22),_0x55adfc,{'passive':![]}),_0x99d0fd[_0x5263b8(0x1086)](_0x5263b8(0xab6),_0x43f1b3);}let _0x4e6a9e=null;async function _0x2681f4(){const _0x24ec8a=_0x13d875;await _0x15c1cd(),_0x541a81(_0x24ec8a(0x449));}async function _0x15c1cd(){const _0x3a9d7b=_0x13d875,_0x2a62e0=document['getElementById'](_0x3a9d7b(0x1281)),_0x419ac1=document[_0x3a9d7b(0x53a)](_0x3a9d7b(0xc5f));_0x2a62e0[_0x3a9d7b(0xaac)]='',_0x419ac1[_0x3a9d7b(0xaac)]='';const [_0x3ba976,_0x1a6e8a]=await Promise[_0x3a9d7b(0x63d)]([_0xa62efb[_0x3a9d7b(0x13b8)][_0x3a9d7b(0xa73)](),_0xa62efb[_0x3a9d7b(0xa3c)]['orderBy'](_0x3a9d7b(0x234))[_0x3a9d7b(0xa73)]()]);_0x53d851[_0x3a9d7b(0x13b8)]=_0x3ba976;if(_0x3ba976[_0x3a9d7b(0x29d)]===0x0){_0x419ac1[_0x3a9d7b(0xaac)]=_0x3a9d7b(0x727);return;}const _0x2703d0=document[_0x3a9d7b(0xd67)](_0x3a9d7b(0x59e));_0x2703d0[_0x3a9d7b(0x6de)]=_0x3a9d7b(0x3f9),_0x2703d0[_0x3a9d7b(0x34a)]='全部',_0x2703d0[_0x3a9d7b(0x999)][_0x3a9d7b(0xbcd)]=_0x3a9d7b(0x63d),_0x2a62e0[_0x3a9d7b(0x133d)](_0x2703d0);const _0x3ebf91=document[_0x3a9d7b(0xd67)]('div');_0x3ebf91[_0x3a9d7b(0x6de)]=_0x3a9d7b(0xd6e),_0x3ebf91['dataset'][_0x3a9d7b(0xbcd)]='all',_0x419ac1[_0x3a9d7b(0x133d)](_0x3ebf91),_0x1a6e8a[_0x3a9d7b(0xeaf)](_0x3de15c=>{const _0x48669a=_0x3a9d7b,_0x26cef5=document[_0x48669a(0xd67)]('button');_0x26cef5[_0x48669a(0x6de)]='world-book-tab',_0x26cef5[_0x48669a(0x34a)]=_0x3de15c[_0x48669a(0x234)],_0x26cef5[_0x48669a(0x999)][_0x48669a(0xbcd)]=String(_0x3de15c['id']),_0x2a62e0[_0x48669a(0x133d)](_0x26cef5);const _0x5e03df=document[_0x48669a(0xd67)](_0x48669a(0x1425));_0x5e03df[_0x48669a(0x6de)]=_0x48669a(0xf86),_0x5e03df['dataset'][_0x48669a(0xbcd)]=String(_0x3de15c['id']),_0x419ac1[_0x48669a(0x133d)](_0x5e03df);});const _0x49225a=_0x3ba976[_0x3a9d7b(0xe0f)](_0x30e174=>!_0x30e174[_0x3a9d7b(0xbcd)]);if(_0x49225a){const _0x22b87a=document[_0x3a9d7b(0xd67)]('button');_0x22b87a['className']=_0x3a9d7b(0xc07),_0x22b87a[_0x3a9d7b(0x34a)]=_0x3a9d7b(0x113a),_0x22b87a[_0x3a9d7b(0x999)][_0x3a9d7b(0xbcd)]=_0x3a9d7b(0x414),_0x2a62e0[_0x3a9d7b(0x133d)](_0x22b87a);const _0x1fcf2f=document['createElement']('div');_0x1fcf2f['className']=_0x3a9d7b(0xf86),_0x1fcf2f[_0x3a9d7b(0x999)][_0x3a9d7b(0xbcd)]=_0x3a9d7b(0x414),_0x419ac1[_0x3a9d7b(0x133d)](_0x1fcf2f);}_0x3ba976['forEach'](_0x5348da=>{const _0x4fa535=_0x3a9d7b,_0x533336='该预设包含\x20'+_0x5348da[_0x4fa535(0x73e)]['length']+'\x20个条目。',_0x47f59f=document[_0x4fa535(0xd67)]('div');_0x47f59f[_0x4fa535(0x6de)]=_0x4fa535(0x575),_0x47f59f[_0x4fa535(0xaac)]=_0x4fa535(0xf43)+_0x5348da['name']+_0x4fa535(0x4f9)+_0x533336+_0x4fa535(0xca8);const _0x120ba5=()=>_0x2dded4(_0x5348da['id']),_0x68a417=async()=>{const _0x49af77=_0x4fa535,_0x42031d=await _0x355fc0(_0x49af77(0x1163),_0x49af77(0xafb)+_0x5348da['name']+_0x49af77(0x1452),{'confirmButtonClass':_0x49af77(0x264)});_0x42031d&&(await _0xa62efb[_0x49af77(0x13b8)]['delete'](_0x5348da['id']),_0x53d851[_0x49af77(0x13b8)]=await _0xa62efb['presets'][_0x49af77(0xa73)](),_0x15c1cd());};_0x47f59f[_0x4fa535(0x1086)](_0x4fa535(0xb2b),_0x120ba5),_0x3146aa(_0x47f59f,_0x68a417);const _0x88ef9e=_0x47f59f[_0x4fa535(0x75a)](!![]);_0x88ef9e[_0x4fa535(0x1086)](_0x4fa535(0xb2b),_0x120ba5),_0x3146aa(_0x88ef9e,_0x68a417),_0x3ebf91[_0x4fa535(0x133d)](_0x88ef9e);const _0x1041c0=_0x5348da[_0x4fa535(0xbcd)]?String(_0x5348da[_0x4fa535(0xbcd)]):'uncategorized',_0x3b7f7e=_0x419ac1[_0x4fa535(0x139c)](_0x4fa535(0xe38)+_0x1041c0+'\x22]');_0x3b7f7e&&_0x3b7f7e[_0x4fa535(0x133d)](_0x47f59f);}),document[_0x3a9d7b(0xc3d)]('#preset-tabs\x20.world-book-tab')[_0x3a9d7b(0xeaf)](_0xc04c07=>{const _0x41c9db=_0x3a9d7b;_0xc04c07[_0x41c9db(0x1086)](_0x41c9db(0xb2b),()=>_0x233839(_0xc04c07['dataset']['categoryId']));});}function _0x233839(_0x460cc3){const _0x1e0685=_0x13d875;document[_0x1e0685(0xc3d)]('#preset-tabs\x20.world-book-tab')[_0x1e0685(0xeaf)](_0xfd7a9c=>{const _0x58fc30=_0x1e0685;_0xfd7a9c[_0x58fc30(0x1276)]['toggle']('active',_0xfd7a9c[_0x58fc30(0x999)][_0x58fc30(0xbcd)]===_0x460cc3);}),document[_0x1e0685(0xc3d)]('#preset-content-container\x20.world-book-category-pane')['forEach'](_0x45e508=>{const _0x4a4f9a=_0x1e0685;_0x45e508['classList'][_0x4a4f9a(0x4d7)](_0x4a4f9a(0xdf6),_0x45e508['dataset'][_0x4a4f9a(0xbcd)]===_0x460cc3);});}async function _0x2dded4(_0x51015b){const _0x1d9780=_0x13d875;_0x541a81(_0x1d9780(0x7ec)),_0x4e6a9e=_0x51015b;try{const [_0x344e03,_0xf1cd78]=await Promise[_0x1d9780(0x63d)]([_0xa62efb[_0x1d9780(0x13b8)][_0x1d9780(0x883)](_0x51015b),_0xa62efb[_0x1d9780(0xa3c)][_0x1d9780(0xa73)]()]);if(!_0x344e03){console[_0x1d9780(0x617)](_0x1d9780(0xa57),_0x51015b),await _0x184397('加载失败',_0x1d9780(0x326)),_0x541a81(_0x1d9780(0x449));return;}setTimeout(()=>{const _0x401d61=_0x1d9780;document['getElementById'](_0x401d61(0xe94))[_0x401d61(0x34a)]=_0x344e03[_0x401d61(0x234)],document['getElementById']('preset-name-input')[_0x401d61(0x11a2)]=_0x344e03[_0x401d61(0x234)];const _0x577bda=document[_0x401d61(0x53a)](_0x401d61(0x981));_0x577bda[_0x401d61(0xaac)]='<option\x20value=\x22\x22>--\x20未分类\x20--</option>',_0xf1cd78[_0x401d61(0xeaf)](_0x29c052=>{const _0xb5fc5d=_0x401d61,_0x1434e0=document[_0xb5fc5d(0xd67)](_0xb5fc5d(0xa1e));_0x1434e0['value']=_0x29c052['id'],_0x1434e0[_0xb5fc5d(0x34a)]=_0x29c052[_0xb5fc5d(0x234)];if(_0x344e03['categoryId']===_0x29c052['id'])_0x1434e0[_0xb5fc5d(0x1015)]=!![];_0x577bda[_0xb5fc5d(0x133d)](_0x1434e0);});const _0x1a427a=document[_0x401d61(0x53a)]('preset-entries-container');_0x1a427a[_0x401d61(0xaac)]='',Array[_0x401d61(0xb31)](_0x344e03[_0x401d61(0x73e)])&&_0x344e03[_0x401d61(0x73e)][_0x401d61(0x29d)]>0x0?_0x344e03[_0x401d61(0x73e)]['forEach'](_0x67dfdf=>{const _0x3ae710=_0x401d61,_0x3360a9=_0x56b9f(_0x67dfdf);_0x1a427a[_0x3ae710(0x133d)](_0x3360a9);}):_0x1a427a[_0x401d61(0xaac)]=_0x401d61(0xb54);},0x32);}catch(_0xeb19ab){console[_0x1d9780(0x617)]('打开预设编辑器时发生严重错误:',_0xeb19ab),await _0x184397(_0x1d9780(0x633),_0x1d9780(0xce1)+_0xeb19ab[_0x1d9780(0x875)]),_0x541a81(_0x1d9780(0x449));}}function _0x56b9f(_0x56b37e={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x28097a=_0x13d875,_0x3660c6=document['createElement']('div');_0x3660c6[_0x28097a(0x6de)]=_0x28097a(0x595);const _0x413931=_0x56b37e[_0x28097a(0xb3d)]!==![]?_0x28097a(0x1077):'';_0x3660c6[_0x28097a(0xaac)]=_0x28097a(0x75b)+_0x413931+'>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22'+(_0x56b37e[_0x28097a(0x1445)]||'')+_0x28097a(0x7f3)+(_0x56b37e['keys']||[])[_0x28097a(0x2c8)](',\x20')+_0x28097a(0x1401)+(_0x56b37e[_0x28097a(0x73e)]||'')+_0x28097a(0x5aa),_0x3660c6[_0x28097a(0x139c)](_0x28097a(0x425))[_0x28097a(0x1086)](_0x28097a(0xb2b),()=>_0x3660c6['remove']());const _0x27f9d2=_0x3660c6['querySelector']('.toggle-content-btn'),_0x46cc16=_0x3660c6[_0x28097a(0x139c)](_0x28097a(0x989));return _0x27f9d2['addEventListener'](_0x28097a(0xb2b),()=>{const _0xeee94d=_0x28097a,_0x53b737=_0x46cc16['style'][_0xeee94d(0x11d9)]===_0xeee94d(0xbf2);_0x46cc16[_0xeee94d(0x1284)][_0xeee94d(0x11d9)]=_0x53b737?'block':_0xeee94d(0xbf2),_0x27f9d2[_0xeee94d(0x34a)]=_0x53b737?'收起':'展开';}),_0x3660c6;}async function _0x49ccbc(){const _0x10b5bc=_0x13d875;await _0x3f3bf0(),document[_0x10b5bc(0x139c)](_0x10b5bc(0xcc5))['textContent']='管理预设分类',document[_0x10b5bc(0x53a)](_0x10b5bc(0x4bc))[_0x10b5bc(0x12f2)]=_0x4502a2,document[_0x10b5bc(0x53a)](_0x10b5bc(0x33d))[_0x10b5bc(0x12f2)]=_0x2b1cae=>{const _0x4373de=_0x10b5bc;_0x2b1cae[_0x4373de(0x9c2)][_0x4373de(0x1276)][_0x4373de(0x6a3)](_0x4373de(0xf79))&&_0x8416dd(parseInt(_0x2b1cae[_0x4373de(0x9c2)][_0x4373de(0x999)]['id']));},document[_0x10b5bc(0x53a)](_0x10b5bc(0xa5b))[_0x10b5bc(0x12f2)]=()=>{const _0x2888f1=_0x10b5bc;document[_0x2888f1(0x53a)]('group-management-modal')[_0x2888f1(0x1276)]['remove'](_0x2888f1(0xaef)),_0x15c1cd();},document['getElementById']('group-management-modal')[_0x10b5bc(0x1276)]['add'](_0x10b5bc(0xaef));}async function _0x3f3bf0(){const _0x30c8a3=_0x13d875,_0x203e19=document[_0x30c8a3(0x53a)](_0x30c8a3(0x33d)),_0x47988d=await _0xa62efb[_0x30c8a3(0xa3c)][_0x30c8a3(0xa73)]();_0x203e19[_0x30c8a3(0xaac)]='',_0x47988d[_0x30c8a3(0x29d)]===0x0&&(_0x203e19[_0x30c8a3(0xaac)]='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>'),_0x47988d[_0x30c8a3(0xeaf)](_0x5521f9=>{const _0x434887=_0x30c8a3,_0xe655fa=document['createElement'](_0x434887(0x1425));_0xe655fa[_0x434887(0x6de)]=_0x434887(0xebc),_0xe655fa['innerHTML']=_0x434887(0x1315)+_0x5521f9[_0x434887(0x234)]+'</span><span\x20class=\x22delete-group-btn\x22\x20data-id=\x22'+_0x5521f9['id']+_0x434887(0xdc5),_0x203e19['appendChild'](_0xe655fa);});}async function _0x4502a2(){const _0x1d5d1e=_0x13d875,_0x3b25d5=document[_0x1d5d1e(0x53a)](_0x1d5d1e(0x41e)),_0x9e6bd0=_0x3b25d5[_0x1d5d1e(0x11a2)][_0x1d5d1e(0x13bc)]();if(!_0x9e6bd0)return alert(_0x1d5d1e(0x1000));const _0x4af4a4=await _0xa62efb[_0x1d5d1e(0xa3c)][_0x1d5d1e(0x57e)](_0x1d5d1e(0x234))[_0x1d5d1e(0x12f6)](_0x9e6bd0)[_0x1d5d1e(0x7e6)]();if(_0x4af4a4)return alert('分类\x20\x22'+_0x9e6bd0+_0x1d5d1e(0x2a7));await _0xa62efb['presetCategories'][_0x1d5d1e(0xe13)]({'name':_0x9e6bd0}),_0x3b25d5['value']='',await _0x3f3bf0();}async function _0x8416dd(_0x35fef2){const _0x192961=_0x13d875,_0x167137=await _0x355fc0('确认删除',_0x192961(0x65e),{'confirmButtonClass':_0x192961(0x264)});_0x167137&&(await _0xa62efb['presetCategories'][_0x192961(0x121e)](_0x35fef2),await _0xa62efb[_0x192961(0x13b8)]['where'](_0x192961(0xbcd))[_0x192961(0x12f6)](_0x35fef2)['modify']({'categoryId':null}),_0x53d851[_0x192961(0x13b8)]=await _0xa62efb[_0x192961(0x13b8)][_0x192961(0xa73)](),await _0x3f3bf0());}async function _0x4d7278(_0x241ea3){const _0x313c50=_0x13d875,_0x3faa3b=_0x241ea3[_0x313c50(0x9c2)][_0x313c50(0x1413)][0x0];if(!_0x3faa3b)return;try{if(!_0x3faa3b[_0x313c50(0x234)][_0x313c50(0xc31)](_0x313c50(0xbed)))throw new Error(_0x313c50(0x1366));const _0xa6cdce=await _0x3faa3b[_0x313c50(0x2e6)](),_0x14b53a=JSON[_0x313c50(0x367)](_0xa6cdce);await _0xb17d34(_0x14b53a,_0x3faa3b[_0x313c50(0x234)]);}catch(_0xfdf0f5){console[_0x313c50(0x617)]('预设导入失败:',_0xfdf0f5),await _0x184397(_0x313c50(0x3a1),'无法解析预设文件。\x0a错误:\x20'+_0xfdf0f5[_0x313c50(0x875)]);}finally{_0x241ea3[_0x313c50(0x9c2)]['value']=null;}}async function _0xb17d34(_0x4ee235,_0x168fe9){const _0x5036a7=_0x13d875;let _0x2e3328=[];if(Array[_0x5036a7(0xb31)](_0x4ee235[_0x5036a7(0x83d)])&&Array['isArray'](_0x4ee235[_0x5036a7(0xaed)])&&_0x4ee235[_0x5036a7(0xaed)][_0x5036a7(0x29d)]>0x0){console['log'](_0x5036a7(0x80e));const _0x566062=new Map(_0x4ee235[_0x5036a7(0x83d)][_0x5036a7(0xcb4)](_0x29efc8=>[_0x29efc8['identifier'],_0x29efc8])),_0x569ec4=_0x4ee235[_0x5036a7(0xaed)][_0x5036a7(0xae0)]((_0x27105b,_0x15f16f)=>_0x15f16f[_0x5036a7(0x6fe)]&&_0x15f16f['order'][_0x5036a7(0x29d)]>(_0x27105b[_0x5036a7(0x29d)]||0x0)?_0x15f16f[_0x5036a7(0x6fe)]:_0x27105b,[]);_0x569ec4&&_0x569ec4[_0x5036a7(0x29d)]>0x0&&(_0x2e3328=_0x569ec4['map'](_0x4e9fb8=>{const _0xbe4ea=_0x5036a7,_0x6c910d=_0x566062[_0xbe4ea(0x883)](_0x4e9fb8[_0xbe4ea(0x140e)]);if(_0x6c910d)return{'keys':[],'comment':_0x6c910d[_0xbe4ea(0x234)]||_0xbe4ea(0x42b),'content':_0x6c910d['content']||'','enabled':_0x4e9fb8[_0xbe4ea(0xb3d)]};return null;})[_0x5036a7(0x2dd)](Boolean));}else{if(_0x4ee235[_0x5036a7(0xfdc)]&&typeof _0x4ee235[_0x5036a7(0xfdc)]==='object')console[_0x5036a7(0x1081)](_0x5036a7(0x103c)),Array[_0x5036a7(0xb31)](_0x4ee235[_0x5036a7(0x6fe)])?(console[_0x5036a7(0x1081)](_0x5036a7(0x9d3)),_0x2e3328=_0x4ee235[_0x5036a7(0x6fe)][_0x5036a7(0xcb4)](_0x3aaf46=>_0x4ee235[_0x5036a7(0xfdc)][_0x3aaf46])[_0x5036a7(0x2dd)](Boolean)[_0x5036a7(0xcb4)](_0x44bf35=>({'keys':_0x44bf35[_0x5036a7(0xf31)]||[],'comment':_0x44bf35[_0x5036a7(0x1445)]||_0x5036a7(0x4a4),'content':_0x44bf35[_0x5036a7(0x73e)]||'','enabled':!_0x44bf35['disable']}))):(console[_0x5036a7(0xad0)](_0x5036a7(0x45c)),_0x2e3328=Object['values'](_0x4ee235['entries'])['map'](_0x3fefe9=>({'keys':_0x3fefe9[_0x5036a7(0xf31)]||[],'comment':_0x3fefe9['comment']||_0x5036a7(0x4a4),'content':_0x3fefe9[_0x5036a7(0x73e)]||'','enabled':!_0x3fefe9[_0x5036a7(0x7d9)]})));else{if(Array[_0x5036a7(0xb31)](_0x4ee235[_0x5036a7(0x83d)]))console[_0x5036a7(0x1081)](_0x5036a7(0xbd9)),_0x2e3328=_0x4ee235[_0x5036a7(0x83d)][_0x5036a7(0xcb4)](_0x40e794=>({'keys':[],'comment':_0x40e794[_0x5036a7(0x234)]||_0x5036a7(0x42b),'content':_0x40e794['content']||'','enabled':!![]}));else throw new Error(_0x5036a7(0x4a0));}}_0x2e3328=_0x2e3328[_0x5036a7(0x2dd)](_0x357a44=>_0x357a44[_0x5036a7(0x73e)]);if(_0x2e3328[_0x5036a7(0x29d)]===0x0){alert(_0x5036a7(0x11e1));return;}const _0x4219f5=_0x168fe9[_0x5036a7(0x795)](/\.json$/i,''),_0x38eeac=await _0x4f6537(_0x5036a7(0x4ea),_0x5036a7(0x637),_0x4219f5);if(!_0x38eeac||!_0x38eeac[_0x5036a7(0x13bc)]()){alert('导入已取消，因为未提供名称。');return;}const _0x5453cc={'id':_0x5036a7(0xb68)+Date[_0x5036a7(0x9c1)](),'name':_0x38eeac['trim'](),'content':_0x2e3328,'categoryId':null};await _0xa62efb[_0x5036a7(0x13b8)]['add'](_0x5453cc),_0x53d851['presets'][_0x5036a7(0x7dd)](_0x5453cc),await _0x15c1cd(),await _0x184397(_0x5036a7(0xd0a),_0x5036a7(0x58a)+_0x38eeac+'》。');}async function _0x17cd40(_0x5145ad){const _0x52bca1=_0x13d875,_0xa26b21=document[_0x52bca1(0x53a)]('offline-preset-select');if(!_0xa26b21)return;const _0x489ab9=_0x53d851[_0x52bca1(0x13b8)]||[];_0xa26b21['innerHTML']='<option\x20value=\x22\x22>--\x20不使用预设\x20--</option>',_0x489ab9[_0x52bca1(0xeaf)](_0x41b15e=>{const _0x302ebd=_0x52bca1,_0x1a7247=document[_0x302ebd(0xd67)](_0x302ebd(0xa1e));_0x1a7247[_0x302ebd(0x11a2)]=_0x41b15e['id'],_0x1a7247['textContent']=_0x41b15e[_0x302ebd(0x234)],_0xa26b21['appendChild'](_0x1a7247);}),_0x5145ad[_0x52bca1(0x81e)]['offlinePresetId']&&(_0xa26b21['value']=_0x5145ad[_0x52bca1(0x81e)]['offlinePresetId']);}function _0x18bc71(){const _0x232277=_0x13d875,_0x54b973=document[_0x232277(0x53a)](_0x232277(0x91f));if(!_0x54b973)return;_0x54b973[_0x232277(0xaac)]='';let _0x59a53b=_0x53d851[_0x232277(0x906)][_0x232277(0x951)]||_0x15b883;_0x59a53b[_0x232277(0xeaf)](_0xf36310=>{const _0x4392ef=_0x232277,_0x22d54f=document[_0x4392ef(0x53a)](_0xf36310);if(_0x22d54f){const _0x579794=document[_0x4392ef(0xd67)]('div');_0x579794[_0x4392ef(0x6de)]=_0x4392ef(0x1271),_0x579794['draggable']=!![],_0x579794[_0x4392ef(0x999)][_0x4392ef(0x3ec)]=_0xf36310,_0x579794[_0x4392ef(0xaac)]=_0x22d54f['innerHTML'],_0x54b973['appendChild'](_0x579794);}});}function _0x55fda7(){const _0x2d0aeb=_0x13d875,_0x17a67c=document[_0x2d0aeb(0x53a)]('button-order-editor');if(!_0x17a67c)return;let _0x527fc4=null;const _0x558ff1=_0x1ba3f8=>{const _0x592326=_0x2d0aeb,_0xa2695b=_0x1ba3f8[_0x592326(0x9c2)][_0x592326(0x106f)]('.draggable-button-item');if(!_0xa2695b)return;_0x527fc4=_0xa2695b,_0x527fc4[_0x592326(0x1276)][_0x592326(0xe13)](_0x592326(0xee6));if(_0x1ba3f8[_0x592326(0xfac)])_0x1ba3f8[_0x592326(0x1013)]();},_0x52ed3f=_0x12930e=>{const _0x4de7e9=_0x2d0aeb;if(!_0x527fc4)return;const _0x5b8b4c=_0x12930e['type']['includes'](_0x4de7e9(0xd4e))?_0x12930e[_0x4de7e9(0x1251)]:_0x12930e[_0x4de7e9(0xd44)][0x0][_0x4de7e9(0x1251)],_0x32212f=_0x25d1a4(_0x17a67c,_0x5b8b4c);_0x32212f==null?_0x17a67c[_0x4de7e9(0x133d)](_0x527fc4):_0x17a67c[_0x4de7e9(0xc38)](_0x527fc4,_0x32212f);},_0x164dbc=()=>{const _0x2ef9dc=_0x2d0aeb;if(!_0x527fc4)return;_0x527fc4[_0x2ef9dc(0x1276)][_0x2ef9dc(0x2d4)]('dragging'),_0x527fc4=null,_0x30afe0();};_0x17a67c[_0x2d0aeb(0x1086)](_0x2d0aeb(0xff3),_0x558ff1),_0x17a67c[_0x2d0aeb(0x1086)]('touchstart',_0x558ff1,{'passive':![]}),_0x17a67c[_0x2d0aeb(0x1086)](_0x2d0aeb(0xef3),_0x52ed3f),_0x17a67c[_0x2d0aeb(0x1086)]('touchmove',_0x52ed3f,{'passive':![]}),_0x17a67c[_0x2d0aeb(0x1086)](_0x2d0aeb(0xacd),_0x164dbc),_0x17a67c['addEventListener'](_0x2d0aeb(0x355),_0x164dbc),_0x17a67c[_0x2d0aeb(0x1086)]('touchend',_0x164dbc);}function _0x25d1a4(_0x134eeb,_0x40c263){const _0x902c88=_0x13d875,_0x470654=[..._0x134eeb[_0x902c88(0xc3d)]('.draggable-button-item:not(.dragging)')];return _0x470654['reduce']((_0x9b0838,_0x528a63)=>{const _0xbc915a=_0x902c88,_0x5912df=_0x528a63[_0xbc915a(0xde9)](),_0x3e655a=_0x40c263-_0x5912df[_0xbc915a(0xcd7)]-_0x5912df['width']/0x2;return _0x3e655a<0x0&&_0x3e655a>_0x9b0838[_0xbc915a(0x10e7)]?{'offset':_0x3e655a,'element':_0x528a63}:_0x9b0838;},{'offset':Number[_0x902c88(0xe99)]})[_0x902c88(0x131c)];}async function _0x30afe0(){const _0x250fcd=_0x13d875,_0x109869=document[_0x250fcd(0x53a)]('button-order-editor'),_0x3f2b6d=Array[_0x250fcd(0xd97)](_0x109869['querySelectorAll'](_0x250fcd(0x5ab)))[_0x250fcd(0xcb4)](_0x3b558e=>_0x3b558e[_0x250fcd(0x999)]['buttonId']);_0x53d851[_0x250fcd(0x906)]['chatActionButtonsOrder']=_0x3f2b6d,await _0xa62efb['globalSettings']['put'](_0x53d851[_0x250fcd(0x906)]);}function _0x189f4b(){const _0x2de952=_0x13d875,_0x17ebe0=_0x53d851[_0x2de952(0x906)][_0x2de952(0x951)];if(!_0x17ebe0||!Array[_0x2de952(0xb31)](_0x17ebe0)||_0x17ebe0[_0x2de952(0x29d)]===0x0)return;const _0x559fa9=document[_0x2de952(0x53a)]('chat-input-actions-top');if(!_0x559fa9)return;_0x17ebe0['forEach'](_0x5916cc=>{const _0x55fe1f=_0x2de952,_0x3e7cd7=document[_0x55fe1f(0x53a)](_0x5916cc);_0x3e7cd7&&_0x559fa9['appendChild'](_0x3e7cd7);});}const _0x15b883=[_0x13d875(0x11f8),_0x13d875(0xbbc),_0x13d875(0x441),'transfer-btn',_0x13d875(0x755),'send-waimai-request-btn',_0x13d875(0xa62),_0x13d875(0x797),_0x13d875(0xa50),_0x13d875(0x7b2),_0x13d875(0x13a2),'gomoku-btn',_0x13d875(0x1002),_0x13d875(0x1301),_0x13d875(0xc7b),_0x13d875(0xbc6),_0x13d875(0xdb6),_0x13d875(0xae2),_0x13d875(0x4ed),'read-together-btn'];async function _0x3bef32(){const _0x3d9640=_0x13d875;_0x53d851[_0x3d9640(0x906)][_0x3d9640(0x951)]=null,await _0xa62efb[_0x3d9640(0x906)][_0x3d9640(0x546)](_0x53d851[_0x3d9640(0x906)]),_0x18bc71(),_0x189f4b(),await _0x184397('成功',_0x3d9640(0x748));}let _0x3748ce=[],_0x424f4b=[];function _0x231c57(){const _0x43ac7c=_0x13d875,_0x21040b=document[_0x43ac7c(0x53a)](_0x43ac7c(0x8e1));_0x3748ce=[],_0x424f4b=[],_0x4c1423(),document[_0x43ac7c(0x53a)](_0x43ac7c(0x94f))[_0x43ac7c(0x1284)][_0x43ac7c(0x11d9)]=_0x43ac7c(0x2f6),document[_0x43ac7c(0x53a)]('data-clear-step-2')[_0x43ac7c(0x1284)][_0x43ac7c(0x11d9)]=_0x43ac7c(0xbf2),_0x21040b[_0x43ac7c(0x1276)][_0x43ac7c(0xe13)](_0x43ac7c(0xaef));}function _0x4c1423(){const _0x531f9f=_0x13d875,_0x1098a6=document[_0x531f9f(0x53a)](_0x531f9f(0x1365));_0x1098a6[_0x531f9f(0xaac)]='';const _0x4e41b0=document[_0x531f9f(0xd67)](_0x531f9f(0x1425));_0x4e41b0[_0x531f9f(0x6de)]='clear-posts-item',_0x4e41b0[_0x531f9f(0x999)]['charId']=_0x531f9f(0x10ae),_0x4e41b0[_0x531f9f(0xaac)]=_0x531f9f(0xec3)+(_0x53d851[_0x531f9f(0xa74)][_0x531f9f(0x1005)]||'我')+_0x531f9f(0x216),_0x1098a6[_0x531f9f(0x133d)](_0x4e41b0),Object[_0x531f9f(0x244)](_0x53d851[_0x531f9f(0xaa3)])[_0x531f9f(0xeaf)](_0x46cc68=>{const _0x95d85e=_0x531f9f;if(!_0x46cc68[_0x95d85e(0x86e)]){const _0x3079d9=document[_0x95d85e(0xd67)]('div');_0x3079d9[_0x95d85e(0x6de)]=_0x95d85e(0xaaf),_0x3079d9[_0x95d85e(0x999)][_0x95d85e(0x13c7)]=_0x46cc68['id'],_0x3079d9[_0x95d85e(0xaac)]=_0x95d85e(0xaf6)+_0x46cc68[_0x95d85e(0x234)]+'\x20(角色)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1098a6[_0x95d85e(0x133d)](_0x3079d9);}});}function _0x39ae86(){const _0x178067=_0x13d875,_0x293604=document['getElementById']('data-clear-type-list');_0x293604[_0x178067(0xaac)]='';const _0x57e94a=[{'id':_0x178067(0x2d8),'name':_0x178067(0xfcb),'description':_0x178067(0xafd)},{'id':'qzone','name':_0x178067(0x11e3),'description':_0x178067(0x485)},{'id':_0x178067(0x12df),'name':_0x178067(0x408),'description':_0x178067(0xb45)},{'id':_0x178067(0x72c),'name':'心声','description':_0x178067(0x10da)},{'id':_0x178067(0xbe7),'name':_0x178067(0x5b0),'description':_0x178067(0x1155)},{'id':_0x178067(0xb51),'name':'收藏','description':_0x178067(0xe46)},{'id':_0x178067(0x1180),'name':_0x178067(0x1068),'description':'将清空角色的相册、QQ、浏览器、淘宝、日记、备忘录等所有模拟手机数据。'}];_0x57e94a[_0x178067(0xeaf)](_0x31e04c=>{const _0x3e72bf=_0x178067,_0x352b45=document[_0x3e72bf(0xd67)](_0x3e72bf(0x1425));_0x352b45[_0x3e72bf(0x6de)]=_0x3e72bf(0xaaf),_0x352b45[_0x3e72bf(0x999)][_0x3e72bf(0x1388)]=_0x31e04c['id'],_0x352b45['innerHTML']=_0x3e72bf(0x26d)+_0x31e04c[_0x3e72bf(0x234)]+_0x3e72bf(0x28f)+_0x31e04c['description']+_0x3e72bf(0x1252),_0x293604[_0x3e72bf(0x133d)](_0x352b45);});}function _0x21d052(){const _0x6e3a0d=_0x13d875,_0x213a01=document[_0x6e3a0d(0xc3d)](_0x6e3a0d(0x6f8));if(_0x213a01[_0x6e3a0d(0x29d)]===0x0){alert(_0x6e3a0d(0xbda));return;}_0x3748ce=Array['from'](_0x213a01)[_0x6e3a0d(0xcb4)](_0x297136=>_0x297136[_0x6e3a0d(0x999)]['charId']),_0x39ae86(),document['getElementById'](_0x6e3a0d(0x94f))[_0x6e3a0d(0x1284)][_0x6e3a0d(0x11d9)]=_0x6e3a0d(0xbf2),document['getElementById']('data-clear-step-2')['style'][_0x6e3a0d(0x11d9)]='flex';}function _0x3aecd8(){const _0x30b64b=_0x13d875;document['getElementById']('data-clear-step-2')[_0x30b64b(0x1284)][_0x30b64b(0x11d9)]=_0x30b64b(0xbf2),document[_0x30b64b(0x53a)](_0x30b64b(0x94f))[_0x30b64b(0x1284)][_0x30b64b(0x11d9)]=_0x30b64b(0x2f6),document['querySelectorAll'](_0x30b64b(0x10ed))['forEach'](_0x579896=>{const _0x302a7c=_0x30b64b;_0x3748ce[_0x302a7c(0x6e9)](_0x579896['dataset'][_0x302a7c(0x13c7)])&&_0x579896['classList'][_0x302a7c(0xe13)](_0x302a7c(0x1015));});}async function _0xe77114(){const _0x4630e2=_0x13d875,_0x3ab037=document['querySelectorAll'](_0x4630e2(0xf15));if(_0x3ab037[_0x4630e2(0x29d)]===0x0){alert(_0x4630e2(0x111c));return;}_0x424f4b=Array[_0x4630e2(0xd97)](_0x3ab037)[_0x4630e2(0xcb4)](_0x904455=>_0x904455[_0x4630e2(0x999)][_0x4630e2(0x1388)]);const _0xb89214=await _0x355fc0(_0x4630e2(0x1110),_0x4630e2(0xaa8),{'confirmButtonClass':'btn-danger','confirmText':_0x4630e2(0x69a)});if(!_0xb89214)return;await _0x184397('请稍候...',_0x4630e2(0x581));try{await _0xa62efb[_0x4630e2(0x11ab)]('rw',_0xa62efb[_0x4630e2(0x760)],async()=>{const _0x3b243c=_0x4630e2;for(const _0x3accae of _0x3748ce){for(const _0x367db7 of _0x424f4b){if(_0x367db7===_0x3b243c(0x2d8)){if(_0x3accae==='user'){const _0x145723=await _0xa62efb['chats']['toArray']();for(const _0x45680d of _0x145723){_0x45680d[_0x3b243c(0xe83)]=_0x45680d['history']['filter'](_0x468c99=>_0x468c99['role']!=='user'),await _0xa62efb[_0x3b243c(0xaa3)][_0x3b243c(0x546)](_0x45680d);}}else{const _0x2b920b=await _0xa62efb[_0x3b243c(0xaa3)][_0x3b243c(0x883)](_0x3accae);_0x2b920b&&(_0x2b920b[_0x3b243c(0xe83)]=[],_0x2b920b[_0x3b243c(0x13cb)]='...',_0x2b920b['randomJottings']=_0x3b243c(0x95d),Array['isArray'](_0x2b920b['nameHistory'])&&(_0x2b920b[_0x3b243c(0x12ed)]=[]),_0x2b920b[_0x3b243c(0x81e)]&&(_0x2b920b[_0x3b243c(0x81e)][_0x3b243c(0x1303)]='我'),await _0xa62efb[_0x3b243c(0xaa3)][_0x3b243c(0x546)](_0x2b920b));}}if(_0x367db7===_0x3b243c(0x1153)){const _0x2e7a=_0x3accae==='user'?'user':_0x3accae;await _0xa62efb[_0x3b243c(0xfc2)][_0x3b243c(0x57e)]('authorId')['equals'](_0x2e7a)[_0x3b243c(0x121e)]();}_0x367db7===_0x3b243c(0x12df)&&_0x3accae!==_0x3b243c(0x10ae)&&await _0xa62efb['callRecords'][_0x3b243c(0x57e)](_0x3b243c(0x1054))[_0x3b243c(0x12f6)](_0x3accae)[_0x3b243c(0x121e)]();if(_0x367db7===_0x3b243c(0x72c)&&_0x3accae!==_0x3b243c(0x10ae)){const _0x3f7188=await _0xa62efb[_0x3b243c(0xaa3)]['get'](_0x3accae);_0x3f7188&&(_0x3f7188[_0x3b243c(0xf2c)]=[],_0x3f7188['heartfeltVoice']=_0x3b243c(0x95d),_0x3f7188['randomJottings']=_0x3b243c(0x95d),await _0xa62efb[_0x3b243c(0xaa3)][_0x3b243c(0x546)](_0x3f7188));}if(_0x367db7===_0x3b243c(0xbe7)&&_0x3accae!==_0x3b243c(0x10ae)){const _0x1aea63=await _0xa62efb[_0x3b243c(0xaa3)][_0x3b243c(0x883)](_0x3accae);_0x1aea63&&(_0x1aea63[_0x3b243c(0x1016)]=[],await _0xa62efb['chats'][_0x3b243c(0x546)](_0x1aea63));}_0x367db7==='favorites'&&(_0x3accae===_0x3b243c(0x10ae)?(await _0xa62efb['favorites']['where'](_0x3b243c(0x919))[_0x3b243c(0x12f6)]('qzone_post')[_0x3b243c(0x2dd)](_0x245f1b=>_0x245f1b[_0x3b243c(0x73e)][_0x3b243c(0xa59)]===_0x3b243c(0x10ae))[_0x3b243c(0x121e)](),await _0xa62efb['favorites'][_0x3b243c(0x57e)](_0x3b243c(0x919))[_0x3b243c(0x12f6)](_0x3b243c(0x776))[_0x3b243c(0x2dd)](_0x4dbcb2=>_0x4dbcb2[_0x3b243c(0x73e)]['role']===_0x3b243c(0x10ae))[_0x3b243c(0x121e)]()):(await _0xa62efb[_0x3b243c(0xb51)][_0x3b243c(0x57e)](_0x3b243c(0x919))['equals'](_0x3b243c(0x776))[_0x3b243c(0xd3b)](_0x2de8db=>_0x2de8db[_0x3b243c(0x1054)]===_0x3accae)[_0x3b243c(0x121e)](),await _0xa62efb[_0x3b243c(0xb51)][_0x3b243c(0x57e)](_0x3b243c(0x919))['equals'](_0x3b243c(0xc50))[_0x3b243c(0x2dd)](_0x485cff=>_0x485cff[_0x3b243c(0x73e)]['authorId']===_0x3accae)[_0x3b243c(0x121e)](),await _0xa62efb[_0x3b243c(0xb51)][_0x3b243c(0x57e)](_0x3b243c(0x919))[_0x3b243c(0x12f6)](_0x3b243c(0x97e))[_0x3b243c(0x2dd)](_0x483132=>_0x483132['content']['characterId']===_0x3accae)[_0x3b243c(0x121e)](),await _0xa62efb[_0x3b243c(0xb51)][_0x3b243c(0x57e)](_0x3b243c(0x919))['equals'](_0x3b243c(0x130e))[_0x3b243c(0x2dd)](_0x214bb9=>_0x214bb9[_0x3b243c(0x73e)][_0x3b243c(0xb93)]===_0x3accae)[_0x3b243c(0x121e)](),await _0xa62efb[_0x3b243c(0xb51)][_0x3b243c(0x57e)](_0x3b243c(0x919))[_0x3b243c(0x12f6)](_0x3b243c(0x1222))[_0x3b243c(0x2dd)](_0x4f89=>_0x4f89[_0x3b243c(0x73e)]['characterId']===_0x3accae)[_0x3b243c(0x121e)]()));if(_0x367db7===_0x3b243c(0x1180)&&_0x3accae!==_0x3b243c(0x10ae)){const _0x2c9b1a=await _0xa62efb[_0x3b243c(0xaa3)]['get'](_0x3accae);_0x2c9b1a&&(_0x2c9b1a[_0x3b243c(0xa17)]=[],_0x2c9b1a['simulatedConversations']=[],_0x2c9b1a[_0x3b243c(0x241)]=[],_0x2c9b1a['simulatedTaobaoHistory']=null,_0x2c9b1a['simulatedAmapHistory']=[],_0x2c9b1a['simulatedAppUsage']=[],_0x2c9b1a[_0x3b243c(0x46a)]=[],_0x2c9b1a[_0x3b243c(0x1010)]=[],_0x2c9b1a[_0x3b243c(0x32f)]=[],await _0xa62efb[_0x3b243c(0xaa3)]['put'](_0x2c9b1a));}}}}),await _0x483882(),await _0x5001a4(),document[_0x4630e2(0x53a)](_0x4630e2(0x8e1))[_0x4630e2(0x1276)][_0x4630e2(0x2d4)]('visible'),await _0x184397(_0x4630e2(0xd2a),'指定的数据已成功清除。');}catch(_0x3fdbfc){console[_0x4630e2(0x617)](_0x4630e2(0xfb0),_0x3fdbfc),await _0x184397('清理失败',_0x4630e2(0xb8e)+_0x3fdbfc[_0x4630e2(0x875)]);}}async function _0x1c26b1(_0xd12a55,_0x334381,_0x311f71){const _0x5305bb=_0x13d875,_0x485e3b=_0x311f71[_0x5305bb(0x139c)](_0x5305bb(0x692))['alt'],_0x432902=await _0x34ea2c(_0x5305bb(0xdde)+_0x485e3b+'”图标',[{'text':'📁\x20从本地上传','value':_0x5305bb(0x3f3)},{'text':_0x5305bb(0x476),'value':_0x5305bb(0xb36)}]);let _0x13c18f=null;if(_0x432902==='local')_0x13c18f=await _0x15351c();else{if(_0x432902==='url'){const _0x3ec277=_0x334381===_0x5305bb(0x1180)?_0x53d851[_0x5305bb(0x906)]['cphoneAppIcons'][_0xd12a55]:_0x53d851[_0x5305bb(0x906)][_0x5305bb(0xb97)][_0xd12a55],_0x2d640f=_0x3ec277[_0x5305bb(0x1200)]('data:image'),_0x4629c3=_0x2d640f?'':_0x3ec277;_0x13c18f=await _0x4f6537('更换图标','请输入新的图片URL',_0x4629c3,_0x5305bb(0xb36));}}if(_0x13c18f&&_0x13c18f[_0x5305bb(0x13bc)]()){const _0x20dffb=_0x13c18f[_0x5305bb(0x13bc)]();_0x334381===_0x5305bb(0x1180)?_0x53d851[_0x5305bb(0x906)][_0x5305bb(0xaee)][_0xd12a55]=_0x20dffb:_0x53d851[_0x5305bb(0x906)][_0x5305bb(0xb97)][_0xd12a55]=_0x20dffb,_0x311f71[_0x5305bb(0x139c)](_0x5305bb(0x692))[_0x5305bb(0x7ff)]=_0x20dffb;}else _0x13c18f!==null&&alert(_0x5305bb(0x73c));}async function _0x4b78ab(){const _0x5f0416=_0x13d875,_0x4e700c=await _0x355fc0('确认压缩图片？',_0x5f0416(0xfff),{'confirmButtonClass':_0x5f0416(0x264),'confirmText':'我已了解风险，确认压缩'});if(!_0x4e700c)return;await _0x184397(_0x5f0416(0x11d7),_0x5f0416(0x5b8));let _0x27cbb4={'found':0x0,'compressed':0x0,'skipped':0x0,'originalSize':0x0,'newSize':0x0};try{console[_0x5f0416(0x1081)]('压缩步骤\x201/3:\x20正在从数据库读取所有相关数据...');const _0xd8cc32=[_0x5f0416(0xaa3),_0x5f0416(0x906),_0x5f0416(0xa74),'userStickers',_0x5f0416(0xbdf)],_0x253112=[];for(const _0x45bc8c of _0xd8cc32){const _0x43fe52=_0xa62efb[_0x5f0416(0xdec)](_0x45bc8c),_0x2f74c5=await _0x43fe52['toArray']();_0x253112[_0x5f0416(0x7dd)]({'tableName':_0x45bc8c,'records':_0x2f74c5});}console[_0x5f0416(0x1081)](_0x5f0416(0x731));for(const _0x226ade of _0x253112){for(const _0xea0ca9 of _0x226ade[_0x5f0416(0x5e8)]){await _0x35d0c4(_0xea0ca9,_0x27cbb4);}}console[_0x5f0416(0x1081)]('压缩步骤\x203/3:\x20正在将压缩后的数据写回数据库...'),await _0xa62efb['transaction']('rw',_0xd8cc32,async()=>{const _0x11a080=_0x5f0416;for(const _0x5062b5 of _0x253112){await _0xa62efb['table'](_0x5062b5[_0x11a080(0x986)])[_0x11a080(0x2db)](_0x5062b5[_0x11a080(0x5e8)]);}});const _0xacaccc=_0x27cbb4[_0x5f0416(0x406)]-_0x27cbb4[_0x5f0416(0x1325)],_0x234ef0=_0x27cbb4[_0x5f0416(0x406)]>0x0?(_0xacaccc/_0x27cbb4[_0x5f0416(0x406)]*0x64)['toFixed'](0x2):0x0;await _0x184397(_0x5f0416(0x5a8),_0x5f0416(0xa8d)+_0x27cbb4['found']+_0x5f0416(0x1322)+_0x27cbb4[_0x5f0416(0x21b)]+_0x5f0416(0xdf8)+_0x27cbb4['skipped']+_0x5f0416(0x34f)+(_0xacaccc/0x400/0x400)[_0x5f0416(0x39e)](0x2)+'\x20MB</strong>\x20(压缩率\x20'+_0x234ef0+_0x5f0416(0x254));}catch(_0x559f73){console['error'](_0x5f0416(0x7c1),_0x559f73),await _0x184397('压缩失败',_0x5f0416(0xb8e)+_0x559f73[_0x5f0416(0x875)]);}}function _0x25a474(_0x4e6e21,_0xdac036=''){const _0x43dc24=_0x13d875;let _0x24a850=0x0;for(const _0x171a99 in _0x4e6e21){if(_0x4e6e21['hasOwnProperty'](_0x171a99)){const _0x2e994e=_0x4e6e21[_0x171a99];if(typeof _0x2e994e===_0x43dc24(0xfc5)&&_0x2e994e[_0x43dc24(0x1200)](_0x43dc24(0xf48))){const _0x485daa=_0xdac036===_0x43dc24(0x906)&&(_0x171a99===_0x43dc24(0x8ee)||_0x171a99===_0x43dc24(0x227)||_0x171a99===_0x43dc24(0xbc0))||_0xdac036===_0x43dc24(0x585)||_0xdac036===_0x43dc24(0x81e)&&_0x171a99===_0x43dc24(0x274)||(_0xdac036===_0x43dc24(0xb97)||_0xdac036==='cphoneAppIcons');!_0x485daa&&(_0x24a850+=_0x2e994e['length']);}else typeof _0x2e994e===_0x43dc24(0xc74)&&_0x2e994e!==null&&(_0x24a850+=_0x25a474(_0x2e994e,_0x171a99));}}return _0x24a850;}async function _0x4b0d3c(){const _0x2d6890=_0x13d875,_0x44faa9=document[_0x2d6890(0x53a)](_0x2d6890(0x11d1));if(!_0x44faa9)return;_0x44faa9[_0x2d6890(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>正在计算可压缩图片大小...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>--\x20MB</span>\x0a\x20\x20\x20\x20';try{let _0x59ccf4=0x0;const _0x16c2ac=[_0x2d6890(0xaa3),_0x2d6890(0x906),'qzoneSettings','userStickers','customAvatarFrames'];for(const _0x5e3511 of _0x16c2ac){const _0x6dbbf4=_0xa62efb[_0x2d6890(0xdec)](_0x5e3511);await _0x6dbbf4[_0x2d6890(0x271)](_0x17c0ad=>{_0x59ccf4+=_0x25a474(_0x17c0ad);});}const _0x5664f0=(_0x59ccf4/0x400/0x400)[_0x2d6890(0x39e)](0x2);_0x44faa9[_0x2d6890(0xaac)]=_0x2d6890(0x204)+_0x5664f0+_0x2d6890(0x1279);}catch(_0x4e87b5){console[_0x2d6890(0x617)](_0x2d6890(0x361),_0x4e87b5),_0x44faa9[_0x2d6890(0xaac)]=_0x2d6890(0x92b);}}async function _0x35d0c4(_0x56cf0c,_0x513912,_0x2bfc1e=''){const _0x406f4b=_0x13d875;for(const _0x22e1ba in _0x56cf0c){if(_0x56cf0c['hasOwnProperty'](_0x22e1ba)){const _0x3e54a6=_0x56cf0c[_0x22e1ba];if(typeof _0x3e54a6===_0x406f4b(0xfc5)&&_0x3e54a6[_0x406f4b(0x1200)]('data:image')){const _0x17e8ff=_0x2bfc1e===_0x406f4b(0x906)&&(_0x22e1ba===_0x406f4b(0x8ee)||_0x22e1ba==='cphoneWallpaper'||_0x22e1ba==='globalChatBackground')||_0x2bfc1e===_0x406f4b(0x585)||_0x2bfc1e===_0x406f4b(0x81e)&&_0x22e1ba===_0x406f4b(0x274)||(_0x2bfc1e==='appIcons'||_0x2bfc1e===_0x406f4b(0xaee));if(_0x17e8ff)continue;_0x513912[_0x406f4b(0xaf0)]++,_0x513912[_0x406f4b(0x406)]+=_0x3e54a6[_0x406f4b(0x29d)];const _0x3ff956=await _0x32a9aa(_0x3e54a6);_0x3ff956&&_0x3ff956!==_0x3e54a6?(_0x56cf0c[_0x22e1ba]=_0x3ff956,_0x513912[_0x406f4b(0x21b)]++,_0x513912[_0x406f4b(0x1325)]+=_0x3ff956['length']):(_0x513912[_0x406f4b(0x7ba)]++,_0x513912[_0x406f4b(0x1325)]+=_0x3e54a6[_0x406f4b(0x29d)]);}else typeof _0x3e54a6===_0x406f4b(0xc74)&&_0x3e54a6!==null&&await _0x35d0c4(_0x3e54a6,_0x513912,_0x22e1ba);}}}function _0x32a9aa(_0x229d67,_0x53002a={}){return new Promise(_0x5975de=>{const _0x4064bc=_0x55b8;if(!_0x229d67[_0x4064bc(0x1200)]('data:image')){console[_0x4064bc(0xad0)](_0x4064bc(0xc90),_0x229d67[_0x4064bc(0xad6)](0x0,0x32)+_0x4064bc(0x95d)),_0x5975de(_0x229d67);return;}const _0x3256fa=_0x53002a[_0x4064bc(0x2ac)]||0.5,_0x441edf=_0x53002a[_0x4064bc(0xf65)]||0x320,_0x161e2e=new Image();_0x161e2e[_0x4064bc(0x110f)]=()=>{const _0xfb0f91=_0x4064bc;let _0x1a0091=_0x161e2e[_0xfb0f91(0xd10)],_0x7b4131=_0x161e2e['height'];_0x1a0091>_0x441edf&&(_0x7b4131=Math[_0xfb0f91(0x143a)](_0x441edf/_0x1a0091*_0x7b4131),_0x1a0091=_0x441edf);const _0x2fd9a1=document[_0xfb0f91(0xd67)]('canvas');_0x2fd9a1[_0xfb0f91(0xd10)]=_0x1a0091,_0x2fd9a1[_0xfb0f91(0xfeb)]=_0x7b4131;const _0x2abc46=_0x2fd9a1['getContext']('2d');_0x2abc46['drawImage'](_0x161e2e,0x0,0x0,_0x1a0091,_0x7b4131);const _0x27c6f3=_0x2fd9a1[_0xfb0f91(0xff6)]('image/jpeg',_0x3256fa);_0x5975de(_0x27c6f3);},_0x161e2e[_0x4064bc(0xdcc)]=()=>{const _0x3b0d79=_0x4064bc;console['warn'](_0x3b0d79(0xb14),_0x229d67['substring'](0x0,0x32)+'...'),_0x5975de(_0x229d67);},_0x161e2e[_0x4064bc(0x7ff)]=_0x229d67;});}function _0x3d858b(_0x3212a6,_0x12bcd8){const _0x1c7b65=_0x13d875;if(!_0x3212a6||!_0x12bcd8||typeof _0x3212a6!==_0x1c7b65(0xfc5)||typeof _0x12bcd8!=='string')return 0x0;const _0x3cad2c=_0x3212a6[_0x1c7b65(0x13e8)]('.')['map'](Number),_0x798c2b=_0x12bcd8[_0x1c7b65(0x13e8)]('.')[_0x1c7b65(0xcb4)](Number),_0x50fae4=Math[_0x1c7b65(0x69b)](_0x3cad2c['length'],_0x798c2b['length']);for(let _0x574558=0x0;_0x574558<_0x50fae4;_0x574558++){const _0x2ab6f8=_0x3cad2c[_0x574558]||0x0,_0x124f55=_0x798c2b[_0x574558]||0x0;if(_0x2ab6f8>_0x124f55)return 0x1;if(_0x2ab6f8<_0x124f55)return-0x1;}return 0x0;}async function _0x4aaa08(){const _0x30459d=_0x13d875,_0xec9187=_0x30459d(0x1119);try{const _0xd23c36=await fetch(_0x30459d(0x3fc)+Date[_0x30459d(0x9c1)]());if(!_0xd23c36['ok']){console[_0x30459d(0xad0)](_0x30459d(0xaaa));return;}const _0x144adb=await _0xd23c36['text'](),_0x490e05=document['createElement']('div');_0x490e05[_0x30459d(0xaac)]=_0x144adb;const _0x6627fb=_0x490e05[_0x30459d(0x139c)](_0x30459d(0x11ff));if(!_0x6627fb){console['error'](_0x30459d(0xd95));return;}const _0x2fda15=_0x6627fb[_0x30459d(0x999)][_0x30459d(0x8b6)],_0x415af6=localStorage[_0x30459d(0xa14)](_0x30459d(0x119f));!_0x415af6||_0x3d858b(_0x2fda15,_0x415af6)>0x0?(console[_0x30459d(0x1081)](_0x30459d(0x75c)+_0x2fda15+_0x30459d(0x8be)+(_0x415af6||'无')+')'),_0x31137c(_0x2fda15,_0x6627fb[_0x30459d(0xaac)])):console['log'](_0x30459d(0x229)+_0x2fda15+')\x20已被用户忽略或为旧版本，无需显示。');}catch(_0x487ff9){console[_0x30459d(0x617)](_0x30459d(0x100d),_0x487ff9);}}function _0x31137c(_0x57d720,_0x4fcb23){const _0x1744e0=_0x13d875,_0x43387e=document[_0x1744e0(0x53a)](_0x1744e0(0x3f8)),_0x2e05f9=document[_0x1744e0(0x53a)](_0x1744e0(0x726)),_0x428fec=document[_0x1744e0(0x53a)](_0x1744e0(0x590)),_0x5553a0=document[_0x1744e0(0x53a)](_0x1744e0(0x132f));_0x2e05f9[_0x1744e0(0xaac)]=_0x4fcb23,_0x428fec[_0x1744e0(0x12f2)]=()=>{const _0x29404f=_0x1744e0;_0x43387e[_0x29404f(0x1276)][_0x29404f(0x2d4)](_0x29404f(0xaef));},_0x5553a0[_0x1744e0(0x12f2)]=()=>{const _0x16d273=_0x1744e0;localStorage['setItem'](_0x16d273(0x119f),_0x57d720),_0x43387e[_0x16d273(0x1276)][_0x16d273(0x2d4)](_0x16d273(0xaef)),console['log'](_0x16d273(0x1329)+_0x57d720);},_0x43387e['classList'][_0x1744e0(0xe13)]('visible');}function _0x16bf5c(){const _0x2032bb=_0x13d875,_0x2113f6=document[_0x2032bb(0x53a)](_0x2032bb(0x128a));document[_0x2032bb(0x53a)](_0x2032bb(0x6f1))[_0x2032bb(0x11a2)]=_0x53d851[_0x2032bb(0x906)][_0x2032bb(0x106b)]||0xc,document[_0x2032bb(0x53a)](_0x2032bb(0xfed))['value']=_0x53d851[_0x2032bb(0x906)]['doubanMaxPosts']||0x14,_0x2113f6[_0x2032bb(0x1276)][_0x2032bb(0xe13)](_0x2032bb(0xaef));}async function _0x8927e6(){const _0x137a75=_0x13d875,_0x4ef015=document[_0x137a75(0x53a)](_0x137a75(0x6f1)),_0x176061=document[_0x137a75(0x53a)](_0x137a75(0xfed)),_0x4b9cf5=parseInt(_0x4ef015['value']),_0x525a51=parseInt(_0x176061[_0x137a75(0x11a2)]);if(isNaN(_0x4b9cf5)||isNaN(_0x525a51)||_0x4b9cf5<0x1||_0x525a51<0x1){alert('请输入有效的正整数！');return;}if(_0x4b9cf5>_0x525a51){alert(_0x137a75(0x3af));return;}_0x53d851['globalSettings'][_0x137a75(0x106b)]=_0x4b9cf5,_0x53d851[_0x137a75(0x906)][_0x137a75(0x12fe)]=_0x525a51,await _0xa62efb['globalSettings']['put'](_0x53d851[_0x137a75(0x906)]),document['getElementById']('douban-settings-modal')[_0x137a75(0x1276)]['remove']('visible'),await _0x184397(_0x137a75(0x6aa),_0x137a75(0xa78));}async function _0xd6d5d7(_0x1b5e7b){const _0x27fbab=_0x13d875,_0x1bf6f0=document[_0x27fbab(0x53a)](_0x27fbab(0x855)),_0x4bc689=document['getElementById']('werewolf-player-selection-list');_0x4bc689[_0x27fbab(0xaac)]='';let _0x4a3077=[];if(_0x1b5e7b===_0x27fbab(0x131a)){const _0x960dc3=Object['values'](_0x53d851[_0x27fbab(0xaa3)])[_0x27fbab(0x2dd)](_0x35bf6d=>!_0x35bf6d['isGroup']),_0x32d5b4=await _0xa62efb[_0x27fbab(0x5b7)][_0x27fbab(0xa73)]();_0x4a3077=[{'id':_0x27fbab(0x10ae),'name':_0x53d851[_0x27fbab(0xa74)][_0x27fbab(0x1005)]||'我','originalName':_0x53d851['qzoneSettings'][_0x27fbab(0x1005)]||'我','avatar':_0x53d851['qzoneSettings'][_0x27fbab(0x8cd)],'type':_0x27fbab(0x10ae)},..._0x960dc3[_0x27fbab(0xcb4)](_0x4205be=>({'id':_0x4205be['id'],'name':_0x4205be[_0x27fbab(0x234)],'originalName':_0x4205be[_0x27fbab(0x543)],'avatar':_0x4205be[_0x27fbab(0x81e)][_0x27fbab(0x9e3)],'type':_0x27fbab(0xde1)})),..._0x32d5b4[_0x27fbab(0xcb4)](_0x369a7f=>({'id':_0x27fbab(0xc78)+_0x369a7f['id'],'name':_0x369a7f[_0x27fbab(0x234)],'originalName':_0x369a7f[_0x27fbab(0x234)],'avatar':_0x369a7f['avatar'],'type':_0x27fbab(0x57d)}))],_0x30aab7[_0x27fbab(0x1054)]=null;}else{const _0x345df1=_0x53d851[_0x27fbab(0xaa3)][_0x53d851['activeChatId']];if(!_0x345df1||!_0x345df1['isGroup'])return;_0x4a3077=[{'id':'user','name':_0x345df1[_0x27fbab(0x81e)][_0x27fbab(0x1303)]||'我','originalName':_0x53d851[_0x27fbab(0xa74)][_0x27fbab(0x1005)]||'我','avatar':_0x345df1[_0x27fbab(0x81e)][_0x27fbab(0x971)],'type':'user'},..._0x345df1[_0x27fbab(0x3de)][_0x27fbab(0xcb4)](_0x1075a=>{const _0x71b6ee=_0x27fbab,_0x3825b0=_0x53d851[_0x71b6ee(0xaa3)][_0x1075a['id']],_0x50e905=_0x1075a[_0x71b6ee(0x8cd)]||(_0x3825b0?_0x3825b0[_0x71b6ee(0x81e)]['aiAvatar']:_0x434592);return{'id':_0x1075a['id'],'name':_0x1075a['groupNickname'],'originalName':_0x1075a[_0x71b6ee(0x543)],'avatar':_0x50e905,'type':_0x1075a[_0x71b6ee(0x410)]?_0x71b6ee(0x57d):'character'};})],_0x30aab7[_0x27fbab(0x1054)]=_0x53d851[_0x27fbab(0x13be)];}_0x4a3077[_0x27fbab(0xeaf)](_0x18c3f7=>{const _0x587734=_0x27fbab,_0x42819a=document[_0x587734(0xd67)]('div');_0x42819a[_0x587734(0x6de)]=_0x587734(0xa94),_0x42819a[_0x587734(0xaac)]=_0x587734(0x5d4)+JSON['stringify'](_0x18c3f7)+'\x27\x20'+(_0x18c3f7[_0x587734(0x919)]===_0x587734(0x10ae)?_0x587734(0x10bb):_0x587734(0x1077))+_0x587734(0x1363)+_0x18c3f7[_0x587734(0x8cd)]+_0x587734(0x63a)+_0x18c3f7[_0x587734(0x234)]+_0x587734(0x1378),_0x4bc689['appendChild'](_0x42819a);}),_0x1bf6f0[_0x27fbab(0x1276)][_0x27fbab(0xe13)](_0x27fbab(0xaef));}async function _0x32dfc6(){const _0x26e6b3=_0x13d875,_0x14fb0a=document[_0x26e6b3(0xc3d)](_0x26e6b3(0x384)),_0x9cf420=_0x14fb0a['length'];let _0x11d0b3=[];if(_0x9cf420===0x6)_0x30aab7[_0x26e6b3(0x3d4)]='6p',_0x11d0b3=['狼人','狼人','平民','平民','预言家','猎人'];else{if(_0x9cf420===0x9)_0x30aab7[_0x26e6b3(0x3d4)]='9p',_0x11d0b3=['狼人','狼人','狼人','平民','平民','平民','预言家','女巫','猎人'];else{if(_0x9cf420===0xc)_0x30aab7[_0x26e6b3(0x3d4)]=_0x26e6b3(0x625),_0x11d0b3=['狼人','狼人','狼人','狼人','平民','平民','平民','平民',_0x26e6b3(0x123e),'女巫','猎人','守卫'];else{alert(_0x26e6b3(0x4af)+_0x9cf420+_0x26e6b3(0xb9b));return;}}}document[_0x26e6b3(0x53a)](_0x26e6b3(0x855))['classList'][_0x26e6b3(0x2d4)]('visible'),await _0x184397(_0x26e6b3(0x1412),_0x26e6b3(0x118f));for(let _0x31ee5f=_0x11d0b3[_0x26e6b3(0x29d)]-0x1;_0x31ee5f>0x0;_0x31ee5f--){const _0x1cd098=Math[_0x26e6b3(0x7d5)](Math['random']()*(_0x31ee5f+0x1));[_0x11d0b3[_0x31ee5f],_0x11d0b3[_0x1cd098]]=[_0x11d0b3[_0x1cd098],_0x11d0b3[_0x31ee5f]];}const _0x519747=Array['from'](_0x14fb0a)[_0x26e6b3(0xcb4)](_0x3c4643=>JSON[_0x26e6b3(0x367)](_0x3c4643['dataset']['playerJson']));_0x30aab7['players']=[];for(let _0x1eea2f=0x0;_0x1eea2f<_0x519747[_0x26e6b3(0x29d)];_0x1eea2f++){const _0x331dde=_0x519747[_0x1eea2f],_0x2b3448=_0x11d0b3[_0x1eea2f];let _0x1efe6b='一个普通玩家';if(_0x331dde[_0x26e6b3(0x919)]===_0x26e6b3(0xde1)){const _0x574957=_0x53d851['chats'][_0x331dde['id']];_0x1efe6b=_0x574957?_0x574957[_0x26e6b3(0x81e)]['aiPersona']:_0x26e6b3(0xd2e);}else{if(_0x331dde['type']==='npc'){const _0x291651=await _0xa62efb[_0x26e6b3(0x5b7)][_0x26e6b3(0xa73)](),_0x214e6c=_0x291651[_0x26e6b3(0x397)](_0x202a1c=>_0x26e6b3(0xc78)+_0x202a1c['id']===_0x331dde['id']);_0x1efe6b=_0x214e6c?_0x214e6c['persona']:_0x26e6b3(0xaf5);}else{if(_0x331dde[_0x26e6b3(0x919)]===_0x26e6b3(0x10ae)){const _0x2c8f76=_0x30aab7['chatId']?_0x53d851[_0x26e6b3(0xaa3)][_0x30aab7[_0x26e6b3(0x1054)]]:null;_0x1efe6b=_0x2c8f76?_0x2c8f76[_0x26e6b3(0x81e)][_0x26e6b3(0xab1)]:'我是谁呀。';}}}const _0x46fde9={..._0x331dde,'role':_0x2b3448,'isAlive':!![],'character_persona':_0x1efe6b};_0x2b3448==='女巫'&&(_0x46fde9[_0x26e6b3(0xa5a)]=![],_0x46fde9['poisonUsed']=![]),_0x2b3448==='守卫'&&(_0x46fde9[_0x26e6b3(0x898)]=null),_0x30aab7[_0x26e6b3(0x4db)][_0x26e6b3(0x7dd)](_0x46fde9);}_0x30aab7[_0x26e6b3(0x975)]=!![],_0x30aab7[_0x26e6b3(0x101c)]=0x1,_0x30aab7[_0x26e6b3(0x5bb)]=_0x26e6b3(0x84f),_0x30aab7[_0x26e6b3(0x2d3)]=[],_0x30aab7[_0x26e6b3(0xe52)]=[];const _0x541807=_0x11d0b3[_0x26e6b3(0xae0)]((_0x2cb966,_0x2112b4)=>{return _0x2cb966[_0x2112b4]=(_0x2cb966[_0x2112b4]||0x0)+0x1,_0x2cb966;},{}),_0x397ac0=Object[_0x26e6b3(0xfdc)](_0x541807)[_0x26e6b3(0xcb4)](([_0x3e4726,_0x18a9b2])=>_0x3e4726+'\x20x'+_0x18a9b2)[_0x26e6b3(0x2c8)]('、');_0x2becb6('游戏配置：'+_0x9cf420+_0x26e6b3(0x897)+_0x397ac0+'。');const _0x3d39fd=_0x30aab7[_0x26e6b3(0x4db)][_0x26e6b3(0x397)](_0x4faab0=>_0x4faab0['id']===_0x26e6b3(0x10ae));_0x141d83(),_0x541a81('werewolf-game-screen'),_0x205750(_0x3d39fd[_0x26e6b3(0xb4d)]);}function _0x141d83(){const _0x414340=_0x13d875,_0x50e1b0=document['getElementById']('werewolf-player-grid');_0x50e1b0[_0x414340(0xaac)]='';const _0x209542=[..._0x30aab7[_0x414340(0x4db)]][_0x414340(0xdb0)]((_0xced867,_0x5ca3aa)=>_0xced867[_0x414340(0x1038)]-_0x5ca3aa[_0x414340(0x1038)]);_0x209542[_0x414340(0xeaf)]((_0x1a3d9b,_0x20a2ec)=>{const _0x4a6ee9=_0x414340,_0x39e68=_0x30aab7[_0x4a6ee9(0x4db)][_0x4a6ee9(0x298)](_0xf65ec4=>_0xf65ec4['id']===_0x1a3d9b['id'])+0x1,_0x26177f=document[_0x4a6ee9(0xd67)](_0x4a6ee9(0x1425));_0x26177f[_0x4a6ee9(0x6de)]=_0x4a6ee9(0xc2b);if(!_0x1a3d9b[_0x4a6ee9(0x1038)])_0x26177f[_0x4a6ee9(0x1276)][_0x4a6ee9(0xe13)](_0x4a6ee9(0x120a));_0x26177f[_0x4a6ee9(0xaac)]=_0x4a6ee9(0xc75)+_0x1a3d9b[_0x4a6ee9(0x8cd)]+_0x4a6ee9(0x641)+_0x39e68+'.\x20'+_0x1a3d9b[_0x4a6ee9(0x234)]+_0x4a6ee9(0x1378),_0x50e1b0[_0x4a6ee9(0x133d)](_0x26177f);});const _0x14d156=document[_0x414340(0x53a)](_0x414340(0x13f3));_0x14d156[_0x414340(0xaac)]='';for(let _0x2d0719=0x1;_0x2d0719<=_0x30aab7[_0x414340(0x101c)];_0x2d0719++){const _0x483f78=[..._0x30aab7[_0x414340(0x2d3)][_0x414340(0x2dd)](_0x27acd1=>_0x27acd1[_0x414340(0x45f)]===_0x2d0719),..._0x30aab7[_0x414340(0xe52)][_0x414340(0x2dd)](_0x5bd820=>_0x5bd820[_0x414340(0x45f)]===_0x2d0719)][_0x414340(0xdb0)]((_0x2dcde6,_0xf7f85c)=>(_0x2dcde6[_0x414340(0x827)]||0x0)-(_0xf7f85c[_0x414340(0x827)]||0x0));if(_0x483f78[_0x414340(0x29d)]>0x0){const _0x51348c=document[_0x414340(0xd67)]('div');_0x51348c[_0x414340(0x6de)]='werewolf-log-entry\x20system',_0x51348c['textContent']=_0x414340(0x1305)+_0x2d0719+_0x414340(0x13f6),_0x51348c['style'][_0x414340(0x94d)]=_0x414340(0x9e5),_0x14d156['appendChild'](_0x51348c),_0x483f78[_0x414340(0xeaf)](_0x35b8fb=>{const _0x41a700=_0x414340,_0x68c710=document[_0x41a700(0xd67)](_0x41a700(0x1425));_0x68c710[_0x41a700(0x6de)]='werewolf-log-entry\x20'+_0x35b8fb[_0x41a700(0x919)],_0x35b8fb['type']===_0x41a700(0x1266)?_0x68c710['innerHTML']=_0x41a700(0x41f)+_0x35b8fb[_0x41a700(0xca3)]+_0x41a700(0x761)+_0x35b8fb[_0x41a700(0x73e)]:_0x68c710[_0x41a700(0x34a)]=_0x35b8fb[_0x41a700(0x73e)],_0x14d156[_0x41a700(0x133d)](_0x68c710);});}}_0x14d156[_0x414340(0xf68)]=_0x14d156['scrollHeight'];const _0x4bf658={'start':'游戏开始','night':'第'+_0x30aab7['currentDay']+_0x414340(0x11e5),'day':'第'+_0x30aab7[_0x414340(0x101c)]+_0x414340(0x8ba),'discussion':'第'+_0x30aab7[_0x414340(0x101c)]+_0x414340(0x242),'voting':'第'+_0x30aab7['currentDay']+_0x414340(0x3ae),'gameover':'游戏结束'};document[_0x414340(0x53a)](_0x414340(0x51c))[_0x414340(0x34a)]='狼人杀\x20-\x20'+(_0x4bf658[_0x30aab7[_0x414340(0x5bb)]]||_0x30aab7['currentPhase']);}function _0x205750(_0x380145){const _0x2066eb=_0x13d875,_0x3bb72b={'狼人':_0x2066eb(0x11b3),'平民':'你没有任何特殊能力，你的目标是通过投票放逐所有狼人。','预言家':'每晚可以查验一个玩家的身份是好人还是狼人。','猎人':'当你死亡时，你可以选择带走场上任意一名玩家。','女巫':_0x2066eb(0x38c),'守卫':_0x2066eb(0x337)};document['getElementById'](_0x2066eb(0x900))[_0x2066eb(0x34a)]=_0x380145,document[_0x2066eb(0x53a)](_0x2066eb(0x12c6))['textContent']=_0x3bb72b[_0x380145]||'一个神秘的角色。',document[_0x2066eb(0x53a)](_0x2066eb(0xa5c))[_0x2066eb(0x1276)][_0x2066eb(0xe13)](_0x2066eb(0xaef));}async function _0x338c52(){const _0x146c2a=_0x13d875;_0x30aab7[_0x146c2a(0x5bb)]='第'+_0x30aab7['currentDay']+'天\x20-\x20夜晚',_0x30aab7[_0x146c2a(0x530)]={},_0x2becb6('天黑请闭眼...'),_0x141d83(),document[_0x146c2a(0x53a)]('werewolf-action-bar')[_0x146c2a(0x1284)][_0x146c2a(0x11d9)]=_0x146c2a(0xbf2),document['getElementById'](_0x146c2a(0x4ff))['style']['display']='none',await new Promise(_0x5b5d2a=>setTimeout(_0x5b5d2a,0x5dc));const _0x3a5ba8=_0x30aab7[_0x146c2a(0x4db)]['find'](_0x5c6ee3=>_0x5c6ee3[_0x146c2a(0xb4d)]==='守卫'&&_0x5c6ee3[_0x146c2a(0x1038)]);if(_0x3a5ba8){_0x2becb6(_0x146c2a(0x95b)),_0x141d83();let _0x1337ba=null;if(_0x3a5ba8['id']===_0x146c2a(0x10ae))_0x1337ba=await _0x443004(_0x146c2a(0xac1),_0x3a5ba8[_0x146c2a(0x898)]);else{const _0x4a0d00=_0x30aab7[_0x146c2a(0x4db)][_0x146c2a(0x2dd)](_0x436585=>_0x436585[_0x146c2a(0x1038)]&&_0x436585['id']!==_0x3a5ba8[_0x146c2a(0x898)]);_0x4a0d00[_0x146c2a(0x29d)]>0x0&&(_0x1337ba=_0x4a0d00[Math['floor'](Math[_0x146c2a(0xac4)]()*_0x4a0d00['length'])]['id']);}_0x1337ba&&(_0x30aab7[_0x146c2a(0x530)][_0x146c2a(0x1d8)]=_0x1337ba,_0x3a5ba8['lastGuardedId']=_0x1337ba),_0x2becb6(_0x146c2a(0xd23)),_0x141d83(),await new Promise(_0x216c63=>setTimeout(_0x216c63,0x5dc));}_0x2becb6(_0x146c2a(0xc88)),_0x141d83();const _0x17f44=_0x30aab7[_0x146c2a(0x4db)][_0x146c2a(0x2dd)](_0x3b5434=>_0x3b5434['role']==='狼人'&&_0x3b5434[_0x146c2a(0x1038)]),_0x3161e3=_0x17f44[_0x146c2a(0xe0f)](_0x42f4c6=>_0x42f4c6['id']==='user');let _0x354f04=null;_0x30aab7[_0x146c2a(0xb30)]=_0x146c2a(0x10d1);try{if(_0x3161e3)_0x2becb6(_0x146c2a(0x248)),_0x141d83(),_0x354f04=await _0x49ad95();else{if(_0x30aab7[_0x146c2a(0x101c)]===0x1){console[_0x146c2a(0x1081)](_0x146c2a(0xab9));const _0x2b23c5=_0x30aab7[_0x146c2a(0x4db)][_0x146c2a(0x2dd)](_0x27dd50=>_0x27dd50[_0x146c2a(0x1038)]&&_0x27dd50[_0x146c2a(0xb4d)]!=='狼人');_0x2b23c5[_0x146c2a(0x29d)]>0x0&&(_0x354f04=_0x2b23c5[Math[_0x146c2a(0x7d5)](Math[_0x146c2a(0xac4)]()*_0x2b23c5[_0x146c2a(0x29d)])]['id']);}else _0x354f04=await _0x552bbb();}_0x30aab7['lastFailedAction']=null;}catch(_0x12ab38){console[_0x146c2a(0x617)](_0x146c2a(0x809),_0x12ab38),await _0x184397(_0x146c2a(0xeac),'AI狼人团队无法决定目标，游戏暂停。请点击右上角的“重试”按钮继续。'),document[_0x146c2a(0x53a)]('werewolf-retry-btn')[_0x146c2a(0x1284)][_0x146c2a(0x11d9)]=_0x146c2a(0x1ea);return;}_0x30aab7[_0x146c2a(0x530)][_0x146c2a(0x61f)]=_0x354f04,_0x2becb6(_0x146c2a(0xf3b)),_0x141d83(),await new Promise(_0x570e61=>setTimeout(_0x570e61,0x5dc));const _0x12c393=_0x30aab7[_0x146c2a(0x4db)][_0x146c2a(0x397)](_0x7b390f=>_0x7b390f[_0x146c2a(0xb4d)]==='女巫'&&_0x7b390f[_0x146c2a(0x1038)]);if(_0x12c393){_0x2becb6('女巫请睁眼。'),_0x141d83();const _0xac47e7=_0x30aab7[_0x146c2a(0x4db)]['find'](_0x57dde3=>_0x57dde3['id']===_0x30aab7[_0x146c2a(0x530)][_0x146c2a(0x61f)]),_0x224583=_0x30aab7[_0x146c2a(0x530)][_0x146c2a(0x1d8)]===_0x30aab7[_0x146c2a(0x530)][_0x146c2a(0x61f)],_0x2716e6=_0x224583||!_0xac47e7?null:_0xac47e7;if(_0x12c393['id']===_0x146c2a(0x10ae)){let _0x111700=await _0x2846e3(_0x2716e6,_0x12c393);_0x111700[_0x146c2a(0x66a)]&&(_0x30aab7[_0x146c2a(0x530)][_0x146c2a(0xc98)]=_0x30aab7['nightActions'][_0x146c2a(0x61f)],_0x12c393[_0x146c2a(0xa5a)]=!![]),_0x111700[_0x146c2a(0x3e8)]&&(_0x30aab7['nightActions'][_0x146c2a(0xbd2)]=_0x111700[_0x146c2a(0x3e8)],_0x12c393[_0x146c2a(0x1096)]=!![]);}else{if(!_0x12c393[_0x146c2a(0xa5a)]&&_0x2716e6){let _0x31741b=0x0;_0x30aab7[_0x146c2a(0x101c)]===0x1?_0x31741b=0.3:_0x31741b=0.8,console[_0x146c2a(0x1081)](_0x146c2a(0x55c)+_0x30aab7[_0x146c2a(0x101c)]+_0x146c2a(0x593)+_0x31741b*0x64+'%'),Math[_0x146c2a(0xac4)]()<_0x31741b?(console[_0x146c2a(0x1081)]('AI女巫决定使用解药！'),_0x30aab7['nightActions']['savedId']=_0x30aab7[_0x146c2a(0x530)][_0x146c2a(0x61f)],_0x12c393['antidoteUsed']=!![]):console[_0x146c2a(0x1081)](_0x146c2a(0x9ed));}if(!_0x30aab7[_0x146c2a(0x530)]['savedId']&&!_0x12c393['poisonUsed']&&Math[_0x146c2a(0xac4)]()<0.5){const _0x19b492=_0x30aab7['players']['filter'](_0x190c32=>_0x190c32[_0x146c2a(0x1038)]&&_0x190c32['id']!==_0x30aab7['nightActions'][_0x146c2a(0x61f)]);if(_0x19b492[_0x146c2a(0x29d)]>0x0){const _0x51b10f=_0x19b492[Math[_0x146c2a(0x7d5)](Math[_0x146c2a(0xac4)]()*_0x19b492[_0x146c2a(0x29d)])];_0x30aab7[_0x146c2a(0x530)][_0x146c2a(0xbd2)]=_0x51b10f['id'],_0x12c393[_0x146c2a(0x1096)]=!![],console[_0x146c2a(0x1081)](_0x146c2a(0xae3)+_0x51b10f[_0x146c2a(0x234)]);}}}_0x2becb6(_0x146c2a(0x200)),_0x141d83(),await new Promise(_0x2bd4b2=>setTimeout(_0x2bd4b2,0x5dc));}const _0x183a14=_0x30aab7[_0x146c2a(0x4db)][_0x146c2a(0x397)](_0x3f7631=>_0x3f7631[_0x146c2a(0xb4d)]===_0x146c2a(0x123e)&&_0x3f7631[_0x146c2a(0x1038)]);if(_0x183a14){_0x2becb6('预言家请睁眼，请选择要查验的玩家。'),_0x141d83();if(_0x183a14['id']===_0x146c2a(0x10ae)){const _0x31a0bb=await _0x443004('prophet'),_0x134c42=_0x30aab7[_0x146c2a(0x4db)][_0x146c2a(0x397)](_0x5995e3=>_0x5995e3['id']===_0x31a0bb);if(_0x134c42){const _0xf29c98=_0x134c42[_0x146c2a(0xb4d)]==='狼人';await _0x184397(_0x146c2a(0x92d),_0x146c2a(0xa81)+_0x134c42['name']+_0x146c2a(0xcc3)+(_0xf29c98?'狼人':'好人')),_0x30aab7[_0x146c2a(0x530)][_0x146c2a(0xc25)]={'target':_0x31a0bb,'result':_0xf29c98?'狼人':'好人'};}}else{const _0x4c66e5=_0x30aab7['players'][_0x146c2a(0x2dd)](_0x1b89a1=>_0x1b89a1[_0x146c2a(0x1038)]&&_0x1b89a1['id']!==_0x183a14['id']);if(_0x4c66e5['length']>0x0){const _0x378934=_0x4c66e5[Math[_0x146c2a(0x7d5)](Math['random']()*_0x4c66e5[_0x146c2a(0x29d)])];_0x30aab7[_0x146c2a(0x530)][_0x146c2a(0xc25)]={'target':_0x378934['id'],'result':_0x378934['role']==='狼人'?'狼人':'好人'};}}_0x2becb6(_0x146c2a(0x97f)),_0x141d83(),await new Promise(_0x2e6b81=>setTimeout(_0x2e6b81,0x5dc));}_0x35ffe3();}async function _0x35ffe3(){const _0x5d9f26=_0x13d875;_0x30aab7[_0x5d9f26(0x5bb)]='第'+_0x30aab7[_0x5d9f26(0x101c)]+'天\x20-\x20白天',_0x30aab7['voteResults']={},_0x2becb6(_0x5d9f26(0x1eb));const {killedId:_0x58e3f6,guardedId:_0x396c5f,savedId:_0x2e1de8,poisonedId:_0x1701d9}=_0x30aab7[_0x5d9f26(0x530)],_0x33471f=new Set();_0x58e3f6&&_0x58e3f6!==_0x396c5f&&_0x58e3f6!==_0x2e1de8&&_0x33471f['add'](_0x58e3f6);_0x1701d9&&_0x33471f[_0x5d9f26(0xe13)](_0x1701d9);if(_0x33471f[_0x5d9f26(0x38e)]===0x0)_0x2becb6('昨晚是平安夜。');else for(const _0x27f916 of _0x33471f){const _0x376713=_0x30aab7[_0x5d9f26(0x4db)][_0x5d9f26(0x397)](_0x3ea382=>_0x3ea382['id']===_0x27f916);if(_0x376713&&_0x376713[_0x5d9f26(0x1038)]){_0x376713[_0x5d9f26(0x1038)]=![],_0x2becb6(_0x5d9f26(0xa4c)+_0x376713['name']+_0x5d9f26(0x802));if(_0x376713['role']==='猎人'){_0x2becb6(_0x5d9f26(0xd73)),_0x141d83();let _0x370ee0=null;if(_0x376713['id']==='user')_0x370ee0=await _0x443004(_0x5d9f26(0xa37));else{const _0x439b7d=_0x30aab7[_0x5d9f26(0x4db)][_0x5d9f26(0x2dd)](_0x40d196=>_0x40d196[_0x5d9f26(0x1038)]&&_0x40d196['id']!==_0x376713['id']);_0x439b7d[_0x5d9f26(0x29d)]>0x0&&(_0x370ee0=_0x439b7d[Math[_0x5d9f26(0x7d5)](Math['random']()*_0x439b7d[_0x5d9f26(0x29d)])]['id']);}const _0x44a955=_0x30aab7[_0x5d9f26(0x4db)][_0x5d9f26(0x397)](_0x561dcb=>_0x561dcb['id']===_0x370ee0);_0x44a955&&(_0x44a955[_0x5d9f26(0x1038)]=![],_0x2becb6(_0x5d9f26(0x5d1)+_0x44a955[_0x5d9f26(0x234)]+'。'));}}}_0x141d83();if(_0x423ed0())return;await _0x165721();}async function _0x165721(){const _0x3b0cae=_0x13d875;_0x2becb6(_0x3b0cae(0xc44)),_0x141d83();const {proxyUrl:_0x8634da,apiKey:_0x134b95,model:_0x4f698e}=_0x53d851[_0x3b0cae(0x80d)];if(!_0x8634da||!_0x134b95||!_0x4f698e){alert(_0x3b0cae(0xfa2));return;}const _0x38c65d=_0x59675c();_0x30aab7[_0x3b0cae(0xb30)]=_0x3b0cae(0x22c);try{await _0x184397('请稍候',_0x3b0cae(0x40d));let _0x50d243=_0x8634da[_0x3b0cae(0x6e9)](_0x3b0cae(0x1046)),_0x3c2b65=[{'role':_0x3b0cae(0x10ae),'content':_0x3b0cae(0x9b0)}],_0x266ecb=_0x1697e7(_0x4f698e,_0x134b95,_0x38c65d,_0x3c2b65);const _0x1387c8=_0x50d243?await fetch(_0x266ecb[_0x3b0cae(0xb36)],_0x266ecb[_0x3b0cae(0xd7c)]):await fetch(_0x8634da+_0x3b0cae(0x434),{'method':_0x3b0cae(0xa4e),'headers':{'Content-Type':_0x3b0cae(0x85b),'Authorization':'Bearer\x20'+_0x134b95},'body':JSON['stringify']({'model':_0x4f698e,'messages':[{'role':'system','content':_0x38c65d},..._0x3c2b65],'temperature':_0x53d851['globalSettings'][_0x3b0cae(0xaf8)]||0.95})});if(!_0x1387c8['ok']){const _0x35decd=await _0x1387c8[_0x3b0cae(0xdc2)]();throw new Error(_0x3b0cae(0x352)+_0x35decd[_0x3b0cae(0x617)][_0x3b0cae(0x875)]);}const _0x5cedfe=await _0x1387c8[_0x3b0cae(0xdc2)](),_0x55e583=getGeminiResponseText(_0x5cedfe),_0x872c8f=_0x55e583['match'](/(\[[\s\S]*\])/);if(!_0x872c8f)throw new Error(_0x3b0cae(0x9e6)+_0x55e583);const _0xb6c9d1=JSON[_0x3b0cae(0x367)](_0x872c8f[0x0]);for(const _0x26ca73 of _0xb6c9d1){_0x26ca73[_0x3b0cae(0x471)]&&_0x26ca73[_0x3b0cae(0x1266)]&&(_0x28ad36(_0x26ca73[_0x3b0cae(0x471)],_0x26ca73['dialogue']),_0x141d83(),await new Promise(_0x251ef3=>setTimeout(_0x251ef3,0x5dc+Math[_0x3b0cae(0xac4)]()*0x7d0)));}_0x30aab7[_0x3b0cae(0xb30)]=null;}catch(_0x215c85){console[_0x3b0cae(0x617)](_0x3b0cae(0x786),_0x215c85),await _0x184397(_0x3b0cae(0x5ad),'讨论无法开始，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20'+_0x215c85[_0x3b0cae(0x875)]),document['getElementById'](_0x3b0cae(0x4ff))['style'][_0x3b0cae(0x11d9)]=_0x3b0cae(0x1ea);return;}const _0x193e79=_0x30aab7[_0x3b0cae(0x4db)][_0x3b0cae(0x397)](_0x489d9f=>_0x489d9f['id']===_0x3b0cae(0x10ae)),_0x1640b0=document[_0x3b0cae(0x53a)]('werewolf-action-bar'),_0x12d844=document['getElementById'](_0x3b0cae(0xa56)),_0x5ec497=document['getElementById'](_0x3b0cae(0x10c2)),_0x210d33=document['getElementById'](_0x3b0cae(0x1039));_0x1640b0[_0x3b0cae(0x1284)]['display']='flex';if(_0x193e79&&_0x193e79[_0x3b0cae(0x1038)]){_0x12d844[_0x3b0cae(0x34a)]=_0x3b0cae(0x1347),_0x5ec497[_0x3b0cae(0x34a)]=_0x3b0cae(0x876),_0x12d844[_0x3b0cae(0x1284)][_0x3b0cae(0x11d9)]=_0x3b0cae(0x1ea),_0x5ec497[_0x3b0cae(0x1284)][_0x3b0cae(0x11d9)]='block',_0x210d33[_0x3b0cae(0xb77)]=![],_0x210d33[_0x3b0cae(0x140d)]=_0x3b0cae(0xb1c),_0x210d33[_0x3b0cae(0x78d)]();const _0x3d6ee1=_0x12d844['cloneNode'](!![]);_0x12d844['parentNode'][_0x3b0cae(0xa1d)](_0x3d6ee1,_0x12d844),_0x3d6ee1['addEventListener'](_0x3b0cae(0xb2b),_0x1c1287);const _0x51230d=_0x5ec497[_0x3b0cae(0x75a)](!![]);_0x5ec497['parentNode'][_0x3b0cae(0xa1d)](_0x51230d,_0x5ec497),_0x51230d[_0x3b0cae(0x1086)](_0x3b0cae(0xb2b),_0x288158);}else{_0x2becb6(_0x3b0cae(0x1254)),_0x141d83(),_0x12d844['textContent']=_0x3b0cae(0x935),_0x5ec497['textContent']=_0x3b0cae(0xfd6),_0x12d844[_0x3b0cae(0x1284)]['display']='block',_0x5ec497['style'][_0x3b0cae(0x11d9)]=_0x3b0cae(0x1ea),_0x210d33['disabled']=!![],_0x210d33[_0x3b0cae(0x140d)]=_0x3b0cae(0x1224);const _0x402357=_0x12d844['cloneNode'](!![]);_0x12d844[_0x3b0cae(0x9e8)][_0x3b0cae(0xa1d)](_0x402357,_0x12d844),_0x402357['addEventListener']('click',_0x556d19);const _0x39dbaf=_0x5ec497[_0x3b0cae(0x75a)](!![]);_0x5ec497[_0x3b0cae(0x9e8)][_0x3b0cae(0xa1d)](_0x39dbaf,_0x5ec497),_0x39dbaf['addEventListener']('click',_0x4831ee);}}function _0x59675c(){const _0x556f9a=_0x13d875,_0x579673=_0x30aab7['players']['filter'](_0x4d3a71=>_0x4d3a71[_0x556f9a(0x1038)]),_0x36776f=_0x30aab7[_0x556f9a(0x4db)]['find'](_0x8eec3e=>_0x8eec3e['id']==='user'),_0x5e64c9=_0x36776f?_0x36776f['name']:'用户',_0x5d88b6=_0x579673[_0x556f9a(0xe0f)](_0x1ab9c9=>_0x1ab9c9['id']===_0x556f9a(0x10ae));let _0x406414=_0x556f9a(0x281);_0x579673[_0x556f9a(0xeaf)]((_0x5690b2,_0x241731)=>{const _0x40c1dd=_0x556f9a,_0x161803=_0x30aab7[_0x40c1dd(0x4db)]['findIndex'](_0x1dcb5d=>_0x1dcb5d['id']===_0x5690b2['id'])+0x1;_0x406414+='\x0a##\x20'+_0x161803+_0x40c1dd(0x23c)+_0x5690b2['name']+'\x20(这是TA的昵称)\x0a-\x20**本名\x20(你在对话中必须用这个名字称呼TA)**:\x20'+_0x5690b2['originalName']+'\x0a-\x20**身份**:\x20'+(_0x5690b2['id']===_0x40c1dd(0x10ae)?_0x40c1dd(0x9a3):'【AI角色】')+_0x40c1dd(0x552)+_0x5690b2[_0x40c1dd(0x9f3)]+'\x0a';if(_0x5690b2[_0x40c1dd(0x919)]===_0x40c1dd(0xde1)){const _0x425cb5=_0x53d851[_0x40c1dd(0xaa3)][_0x5690b2['id']];if(_0x425cb5&&_0x425cb5[_0x40c1dd(0x1016)]&&_0x425cb5[_0x40c1dd(0x1016)][_0x40c1dd(0x29d)]>0x0){const _0x179c39=_0x425cb5[_0x40c1dd(0x1016)]['map'](_0x44b8b8=>_0x44b8b8[_0x40c1dd(0x73e)])['join'](';\x20');_0x406414+=_0x40c1dd(0xa1a)+_0x179c39+'\x0a';}}});let _0xbfb6cf='#\x20昨晚事件总结\x20(Night\x20Event\x20Summary)\x0a';const _0x4f37e7=_0x30aab7[_0x556f9a(0x2d3)][_0x556f9a(0x2dd)](_0x4cd356=>_0x4cd356[_0x556f9a(0x73e)]['includes']('死亡了')&&_0x4cd356['day']===_0x30aab7[_0x556f9a(0x101c)]);_0x4f37e7[_0x556f9a(0x29d)]===0x0?_0xbfb6cf+=_0x556f9a(0x7bb):_0x4f37e7[_0x556f9a(0xeaf)](_0xb80654=>{const _0x2b7d77=_0x556f9a;_0xbfb6cf+='-\x20'+_0xb80654[_0x2b7d77(0x73e)]+'\x0a';});let _0xa62a58=_0x556f9a(0x413);if(_0x30aab7['currentDay']>0x1)for(let _0x1f0352=0x1;_0x1f0352<_0x30aab7['currentDay'];_0x1f0352++){_0xa62a58+=_0x556f9a(0x1141)+_0x1f0352+_0x556f9a(0x46d);const _0x4bb322=_0x30aab7[_0x556f9a(0x2d3)][_0x556f9a(0x2dd)](_0x907463=>_0x907463['day']===_0x1f0352&&(_0x907463[_0x556f9a(0x73e)][_0x556f9a(0x6e9)]('死亡')||_0x907463[_0x556f9a(0x73e)][_0x556f9a(0x6e9)]('放逐')));_0x4bb322[_0x556f9a(0x29d)]>0x0?_0xa62a58+='*事件*:\x20'+_0x4bb322[_0x556f9a(0xcb4)](_0xf093ec=>_0xf093ec[_0x556f9a(0x73e)])['join']('\x20')+'\x0a':_0xa62a58+='*事件*:\x20平安夜，无人出局。\x0a';const _0x31af1=_0x30aab7['discussionLog']['filter'](_0x2085e4=>_0x2085e4[_0x556f9a(0x45f)]===_0x1f0352);_0x31af1[_0x556f9a(0x29d)]>0x0&&(_0xa62a58+=_0x556f9a(0xfa7)+_0x31af1[_0x556f9a(0xcb4)](_0x2ee2e5=>'-\x20'+_0x2ee2e5['speaker']+':\x20'+_0x2ee2e5[_0x556f9a(0x73e)])['join']('\x0a')+'\x0a');}else _0xa62a58+=_0x556f9a(0xb2a);let _0x286afe=_0x556f9a(0x5f9);_0x579673[_0x556f9a(0xeaf)](_0x301a9b=>{const _0x47ba8e=_0x556f9a;if(_0x301a9b['id']!==_0x47ba8e(0x10ae)){_0x286afe+=_0x47ba8e(0xa7a)+_0x301a9b[_0x47ba8e(0x234)]+_0x47ba8e(0x10ce)+_0x301a9b['role']+'】\x0a';if(_0x301a9b[_0x47ba8e(0xb4d)]==='狼人'){const _0x431a1b=_0x30aab7[_0x47ba8e(0x4db)][_0x47ba8e(0x2dd)](_0x5cbf67=>_0x5cbf67[_0x47ba8e(0xb4d)]==='狼人'&&_0x5cbf67['id']!==_0x301a9b['id'])[_0x47ba8e(0xcb4)](_0x419f10=>_0x419f10['name'])[_0x47ba8e(0x2c8)]('、');_0x286afe+='-\x20你的狼队友是：'+(_0x431a1b||'无')+'\x0a';const _0x4e16eb=_0x30aab7['players'][_0x47ba8e(0x397)](_0x94b689=>_0x94b689['id']===_0x30aab7[_0x47ba8e(0x530)][_0x47ba8e(0x61f)]);_0x286afe+=_0x47ba8e(0x9d7)+(_0x4e16eb?_0x4e16eb[_0x47ba8e(0x234)]:'空刀')+'\x0a';}if(_0x301a9b['role']===_0x47ba8e(0x123e)&&_0x30aab7[_0x47ba8e(0x530)]['prophetCheck']){const _0x1152f8=_0x30aab7['players'][_0x47ba8e(0x397)](_0x5220dc=>_0x5220dc['id']===_0x30aab7['nightActions'][_0x47ba8e(0xc25)]['target']);_0x286afe+=_0x47ba8e(0xc86)+_0x1152f8['name']+_0x47ba8e(0x11fc)+_0x30aab7[_0x47ba8e(0x530)][_0x47ba8e(0xc25)][_0x47ba8e(0xa2a)]+'】\x0a';}if(_0x301a9b[_0x47ba8e(0xb4d)]==='女巫'){if(_0x30aab7[_0x47ba8e(0x530)][_0x47ba8e(0xc98)]){const _0x14829a=_0x30aab7[_0x47ba8e(0x4db)][_0x47ba8e(0x397)](_0x2004ff=>_0x2004ff['id']===_0x30aab7[_0x47ba8e(0x530)][_0x47ba8e(0xc98)]);_0x286afe+=_0x47ba8e(0x7eb)+_0x14829a[_0x47ba8e(0x234)]+'。\x0a';}if(_0x30aab7[_0x47ba8e(0x530)][_0x47ba8e(0xbd2)]){const _0x5496fb=_0x30aab7[_0x47ba8e(0x4db)]['find'](_0x3f905e=>_0x3f905e['id']===_0x30aab7['nightActions'][_0x47ba8e(0xbd2)]);_0x286afe+=_0x47ba8e(0xfc7)+_0x5496fb[_0x47ba8e(0x234)]+'。\x0a';}_0x286afe+=_0x47ba8e(0xfaa)+(_0x301a9b['antidoteUsed']?_0x47ba8e(0xd31):_0x47ba8e(0x34b))+'\x0a',_0x286afe+=_0x47ba8e(0x480)+(_0x301a9b[_0x47ba8e(0x1096)]?'已使用':_0x47ba8e(0x34b))+'\x0a';}if(_0x301a9b[_0x47ba8e(0xb4d)]==='守卫'){if(_0x30aab7[_0x47ba8e(0x530)]['guardedId']){const _0x126f8f=_0x30aab7['players']['find'](_0xa15123=>_0xa15123['id']===_0x30aab7['nightActions'][_0x47ba8e(0x1d8)]);_0x286afe+='-\x20你昨晚守护了\x20'+_0x126f8f['name']+'。\x0a';}else _0x286afe+=_0x47ba8e(0x10e8);}_0x286afe+='\x0a';}});let _0x4920ec=_0x556f9a(0xe60);const _0x1a0b9c=_0x30aab7[_0x556f9a(0xe52)]['filter'](_0x183a81=>_0x183a81['day']===_0x30aab7[_0x556f9a(0x101c)]);_0x1a0b9c['length']>0x0?_0x4920ec+=_0x1a0b9c['map'](_0x593ee=>_0x556f9a(0x846)+_0x593ee[_0x556f9a(0xca3)]+_0x556f9a(0xffa)+_0x593ee[_0x556f9a(0x73e)])[_0x556f9a(0x2c8)]('\x0a'):_0x4920ec+=_0x556f9a(0xbfa);const _0x288ec8=_0x556f9a(0x52c)+(_0x5d88b6?_0x556f9a(0x136b)+_0x5e64c9+')':_0x556f9a(0x779)+_0x5e64c9+')')+_0x556f9a(0x9ab)+_0x406414+_0x556f9a(0xc16)+(_0x30aab7[_0x556f9a(0x3d4)]==='12p'?'屠边局：狼人杀死所有神职或所有平民即获胜。':_0x556f9a(0xc63))+'\x0a-\x20好人胜利：放逐所有狼人。\x0a\x0a#\x20当前游戏状态\x0a-\x20今天是第\x20'+_0x30aab7[_0x556f9a(0x101c)]+'\x20天的讨论环节。\x0a'+_0xbfb6cf+_0x556f9a(0xefb)+_0x579673[_0x556f9a(0xcb4)](_0x5c2a81=>_0x5c2a81[_0x556f9a(0x234)]+'\x20('+(_0x5c2a81['id']===_0x556f9a(0x10ae)?'用户':'AI')+')')[_0x556f9a(0x2c8)](',\x20')+'\x0a\x0a#\x20【【【角色策略指南\x20(至关重要！)】】】\x0a你的发言【必须】体现出高水平的、类似真人的策略博弈，而不是简单地陈述事实。\x0a\x0a###\x20**神职角色\x20(预言家,\x20女巫,\x20猎人,\x20守卫)\x20策略**\x0a1.\x20\x20**【隐藏优先！】**:\x20你的首要任务是活下去。**绝对不要**在第一天就轻易暴露自己的神职身份！这会让你立刻成为狼人的目标。\x0a2.\x20\x20**【暗示而非明示】**:\x20你应该用更委婉、更聪明的语言来传递信息，而不是直接说“我是预言家，我查了A”。\x0a\x20\x20\x20\x20*\x20\x20\x20**预言家可以说**:\x20“我对X玩家的身份有一些看法，我觉得他发言很阳光。”\x20或\x20“Y玩家的发言让我感到很不舒服，我把他列为重点怀疑对象。”\x0a\x20\x20\x20\x20*\x20\x20\x20**女巫可以说**:\x20“昨晚的信息很有趣，场上局势可能和大家想的不一样。”\x0a3.\x20\x20**【何时起跳？】**:\x20只有在以下【危急情况】下，你才应该考虑暴露自己的身份（俗称“起跳”）：\x0a\x20\x20\x20\x20*\x20\x20\x20**被投票时**:\x20当你即将被投票放逐时，必须起跳自证身份来求生。\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20当你掌握了可以决定胜负的信息时（例如预言家查到了最后一个狼人）。\x0a\x20\x20\x20\x20*\x20\x20\x20**有人悍跳**:\x20当有狼人假扮你的身份时，你必须站出来与他对峙，争夺好人的信任。\x0a\x0a###\x20**狼人角色策略**\x0a1.\x20\x20**【积极伪装】**:\x20你需要扮演一个好人，最好是伪装成某个神职（俗称“悍跳”），来扰乱好人的判断，骗取他们的信任。\x0a2.\x20\x20**【制造混乱】**:\x20你的发言应该引导好人去怀疑其他无辜的好人。可以故意曲解别人的发言，或者制造逻辑陷阱。\x0a3.\x20\x20**【团队合作】**:\x20如果你的狼队友被怀疑，你应该想办法为他辩护，或者通过攻击其他玩家来转移焦点。\x0a\x0a###\x20**平民角色策略**\x0a1.\x20\x20**【逻辑为王】**:\x20你是场上的“法官”。你的核心任务是仔细倾听每个人的发言，找出其中的逻辑漏洞和矛盾之处。\x0a2.\x20\x20**【积极分析】**:\x20不要只是说“我不知道，我过了”。你应该大胆说出你的怀疑，并解释你的理由。例如：“A玩家说B是狼人，但是他的理由很牵强，所以我更怀疑A。”\x0a3.\x20\x20**【跟票与站边】**:\x20在你相信某位神职玩家后，你应该坚定地支持他，并号召其他好人一起投票给神职指认的狼人。\x0a\x0a#\x20其他核心指令\x20(必须遵守)\x0a1.\x20\x20**互动铁律**:\x20角色之间【必须】互相质疑、支持、分析【本轮已有发言】。你【绝对不能】无视\x20'+_0x5e64c9+_0x556f9a(0x12de)+_0xa62a58+_0x556f9a(0xf66)+_0x4920ec+'\x0a\x0a'+_0x286afe+'\x0a\x0a现在，请为所有【存活的AI角色】生成他们充满策略和博弈的发言。';return _0x288ec8;}function _0x31afb9(_0xb6ae21){const _0x32c242=_0x13d875;let _0x5e9b24='---\x20狼人杀对局完整复盘\x20---\x0a\x0a';const _0x5884ba=_0xb6ae21['gameLog']['find'](_0x3e6f38=>_0x3e6f38['content']['includes']('胜利'))?.[_0x32c242(0x73e)]||_0x32c242(0x1094);_0x5e9b24+=_0x32c242(0xe23)+_0x5884ba+'\x0a\x0a',_0x5e9b24+=_0x32c242(0xcc0),_0xb6ae21['players'][_0x32c242(0xeaf)](_0x22eaff=>{const _0x53bee7=_0x32c242,_0x51eb2e=_0x22eaff[_0x53bee7(0x1038)]?'存活':_0x53bee7(0x34d);_0x5e9b24+='-\x20'+_0x22eaff[_0x53bee7(0x234)]+':\x20'+_0x22eaff[_0x53bee7(0xb4d)]+'\x20('+_0x51eb2e+')\x0a';}),_0x5e9b24+=_0x32c242(0x101b);for(let _0x5d99bd=0x1;_0x5d99bd<=_0xb6ae21[_0x32c242(0x101c)];_0x5d99bd++){_0x5e9b24+=_0x32c242(0x1141)+_0x5d99bd+_0x32c242(0x46d);const _0x5b3d5b=_0xb6ae21[_0x32c242(0x2d3)]['filter'](_0x52e2e8=>_0x52e2e8[_0x32c242(0x45f)]===_0x5d99bd&&_0x52e2e8[_0x32c242(0x73e)][_0x32c242(0x6e9)]('死亡'));if(_0x5b3d5b[_0x32c242(0x29d)]>0x0)_0x5e9b24+=_0x32c242(0x91e)+_0x5b3d5b['map'](_0x462f06=>_0x462f06[_0x32c242(0x73e)])[_0x32c242(0x2c8)]('\x20')+'\x0a';else(_0x5d99bd>0x1||_0x5d99bd===0x1&&_0xb6ae21['currentDay']>0x1)&&(_0x5e9b24+=_0x32c242(0xbaf));const _0x49427a=_0xb6ae21[_0x32c242(0xe52)]['filter'](_0x47887d=>_0x47887d[_0x32c242(0x45f)]===_0x5d99bd);_0x49427a[_0x32c242(0x29d)]>0x0&&(_0x5e9b24+=_0x32c242(0x556)+_0x49427a[_0x32c242(0xcb4)](_0x485d80=>'-\x20'+_0x485d80[_0x32c242(0xca3)]+':\x20'+_0x485d80[_0x32c242(0x73e)])[_0x32c242(0x2c8)]('\x0a')+'\x0a');const _0xd80ef9=_0xb6ae21[_0x32c242(0x2d3)]['find'](_0x42c68d=>_0x42c68d[_0x32c242(0x45f)]===_0x5d99bd&&_0x42c68d['content'][_0x32c242(0x6e9)](_0x32c242(0x37b)));_0xd80ef9&&(_0x5e9b24+='**[投票结果]**\x20'+_0xd80ef9[_0x32c242(0x73e)]+'\x0a');}return _0x5e9b24+=_0x32c242(0x12ca),_0x5e9b24;}async function _0x17248c(_0x6b2675){const _0x4f4e2d=_0x13d875;let _0x14606c=0x0;for(const _0x54e702 of _0x30aab7[_0x4f4e2d(0x4db)]){if(_0x54e702[_0x4f4e2d(0x919)]==='character'){const _0x1dd7c0=_0x53d851[_0x4f4e2d(0xaa3)][_0x54e702['id']];if(_0x1dd7c0){const _0x4ff48d={'content':_0x6b2675,'timestamp':Date[_0x4f4e2d(0x9c1)](),'source':'werewolf_summary'};!_0x1dd7c0[_0x4f4e2d(0x1016)]&&(_0x1dd7c0[_0x4f4e2d(0x1016)]=[]),_0x1dd7c0[_0x4f4e2d(0x1016)]['push'](_0x4ff48d),await _0xa62efb[_0x4f4e2d(0xaa3)]['put'](_0x1dd7c0),_0x14606c++;}}}return _0x14606c;}async function _0x3e78ed(){const _0x3f2d12=_0x13d875;if(!_0x30aab7[_0x3f2d12(0x975)]&&_0x30aab7[_0x3f2d12(0x5bb)]===_0x3f2d12(0x882)){await _0x184397('请稍候...','正在为所有AI角色生成并注入游戏记忆...');try{const _0x24c285=_0x31afb9(_0x30aab7),_0x349967=await _0x17248c(_0x24c285);await _0x184397('成功',_0x3f2d12(0xd62)+_0x349967+_0x3f2d12(0xb29));}catch(_0x51cfaa){console[_0x3f2d12(0x617)](_0x3f2d12(0x486),_0x51cfaa),await _0x184397('失败',_0x3f2d12(0xc46)+_0x51cfaa[_0x3f2d12(0x875)]);}}else alert(_0x3f2d12(0xcb0));}async function _0x1d2f7a(_0x41d50b){const _0x50ffde=_0x13d875;_0x30aab7['isActive']=![],_0x30aab7[_0x50ffde(0x5bb)]=_0x50ffde(0x882),_0x2becb6(_0x41d50b+_0x50ffde(0x455)),document[_0x50ffde(0x53a)](_0x50ffde(0x905))['textContent']=_0x41d50b+_0x50ffde(0x3c6);let _0x17d7b2='';_0x41d50b==='好人'?_0x17d7b2='所有狼人已被放逐，好人阵营获得了胜利！':_0x17d7b2=_0x50ffde(0x1423);const _0x2da9ad=document[_0x50ffde(0x53a)](_0x50ffde(0x1358));_0x2da9ad[_0x50ffde(0x34a)]=_0x17d7b2;const _0x40387e=document[_0x50ffde(0x53a)](_0x50ffde(0x3d3));_0x40387e['innerHTML']='';const _0x5d6c1c=[..._0x30aab7[_0x50ffde(0x4db)]]['sort']((_0xd66d2d,_0xf46a34)=>{const _0x507ee6=_0x50ffde,_0x19f06e=_0x30aab7[_0x507ee6(0x4db)][_0x507ee6(0x298)](_0x1eb9d5=>_0x1eb9d5['id']===_0xd66d2d['id']),_0x30fd57=_0x30aab7[_0x507ee6(0x4db)][_0x507ee6(0x298)](_0x4a90d5=>_0x4a90d5['id']===_0xf46a34['id']);return _0x19f06e-_0x30fd57;});_0x5d6c1c[_0x50ffde(0xeaf)]((_0x402f29,_0x2ce42a)=>{const _0x9a033e=_0x50ffde,_0xa00cbd=document[_0x9a033e(0xd67)](_0x9a033e(0x1425));_0xa00cbd['style'][_0x9a033e(0x94d)]='display:\x20flex;\x20align-items:\x20center;\x20padding:\x208px\x200;\x20border-bottom:\x201px\x20solid\x20#444;\x20color:\x20white;';if(_0x2ce42a===_0x5d6c1c[_0x9a033e(0x29d)]-0x1)_0xa00cbd['style']['borderBottom']='none';const _0x3484d2=_0x402f29[_0x9a033e(0xb4d)]==='狼人'?_0x9a033e(0x47d):'#52c41a';_0xa00cbd[_0x9a033e(0xaac)]=_0x9a033e(0x36f)+_0x402f29[_0x9a033e(0x8cd)]+_0x9a033e(0x729)+(_0x402f29[_0x9a033e(0x1038)]?_0x9a033e(0xbf2):_0x9a033e(0x6db))+_0x9a033e(0x13b7)+(_0x402f29[_0x9a033e(0x1038)]?_0x9a033e(0xbf2):_0x9a033e(0x2e7))+';\x22>'+(_0x2ce42a+0x1)+'.\x20'+_0x402f29['name']+_0x9a033e(0x12ae)+_0x3484d2+_0x9a033e(0xb13)+_0x402f29[_0x9a033e(0xb4d)]+_0x9a033e(0x359),_0x40387e[_0x9a033e(0x133d)](_0xa00cbd);}),document[_0x50ffde(0x53a)](_0x50ffde(0xba2))['classList']['add']('visible');try{console[_0x50ffde(0x1081)]('游戏结束，开始自动总结并注入记忆...');const _0x488fd0=_0x31afb9(_0x30aab7),_0x155fb9=await generateAndInjectWerewolfMemories(_0x488fd0);console[_0x50ffde(0x1081)](_0x50ffde(0xd3a)+_0x155fb9+_0x50ffde(0x690));}catch(_0x21196e){console[_0x50ffde(0x617)](_0x50ffde(0x96c),_0x21196e),_0x2da9ad&&(_0x2da9ad[_0x50ffde(0xaac)]+=_0x50ffde(0x23f));}}function _0x2becb6(_0x22a6b3){const _0x56a433=_0x13d875;_0x30aab7[_0x56a433(0x2d3)]['push']({'type':_0x56a433(0xab3),'content':_0x22a6b3,'timestamp':Date[_0x56a433(0x9c1)](),'day':_0x30aab7[_0x56a433(0x101c)]});}function _0x28ad36(_0x326e31,_0x9f4661){const _0x4a11aa=_0x13d875;_0x30aab7[_0x4a11aa(0xe52)][_0x4a11aa(0x7dd)]({'type':_0x4a11aa(0x1266),'speaker':_0x326e31,'content':_0x9f4661,'timestamp':Date[_0x4a11aa(0x9c1)](),'day':_0x30aab7['currentDay']});}function _0x443004(_0x4ce72e){return new Promise(_0x3c8acb=>{const _0x4ae044=_0x55b8,_0x5ccbd5=_0x4ae044(0xaa7)+_0x4ce72e+_0x4ae044(0x3e3),_0x373eb3=_0x4ae044(0xaa7)+_0x4ce72e+_0x4ae044(0xeda);let _0x40d3fc='';if(_0x4ce72e===_0x4ae044(0xdc0))_0x40d3fc='confirm-prophet-check-btn';if(_0x4ce72e===_0x4ae044(0xa37))_0x40d3fc='confirm-hunter-shot-btn';if(_0x4ce72e==='vote')_0x40d3fc=_0x4ae044(0x116f);const _0x4f8dc1=document['getElementById'](_0x5ccbd5),_0x4bae6a=document[_0x4ae044(0x53a)](_0x373eb3),_0x2a6ebc=document[_0x4ae044(0x53a)](_0x40d3fc);_0x4bae6a[_0x4ae044(0xaac)]='';let _0xfafbd4=null;const _0x10511f=_0x30aab7[_0x4ae044(0x4db)]['filter'](_0x2242f4=>_0x2242f4[_0x4ae044(0x1038)]&&(_0x4ce72e==='hunter'||_0x4ce72e===_0x4ae044(0xa9f)||_0x2242f4['id']!==_0x4ae044(0x10ae)));_0x10511f[_0x4ae044(0xeaf)](_0x4c7edd=>{const _0x163003=_0x4ae044,_0x29ebe5=document[_0x163003(0xd67)]('div');_0x29ebe5[_0x163003(0x6de)]=_0x163003(0x812),_0x29ebe5['dataset']['id']=_0x4c7edd['id'],_0x29ebe5[_0x163003(0xaac)]=_0x163003(0x88b)+_0x4c7edd['avatar']+'\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>'+_0x4c7edd[_0x163003(0x234)]+_0x163003(0xbec),_0x29ebe5[_0x163003(0x12f2)]=()=>{const _0x328fdb=_0x163003;_0x4bae6a[_0x328fdb(0xc3d)](_0x328fdb(0x7de))[_0x328fdb(0xeaf)](_0x42c307=>_0x42c307['classList']['remove'](_0x328fdb(0x1015))),_0x29ebe5[_0x328fdb(0x1276)]['add']('selected'),_0xfafbd4=_0x4c7edd['id'];},_0x4bae6a['appendChild'](_0x29ebe5);});const _0x1a8bd8=_0x2a6ebc[_0x4ae044(0x75a)](!![]);_0x2a6ebc[_0x4ae044(0x9e8)][_0x4ae044(0xa1d)](_0x1a8bd8,_0x2a6ebc),_0x1a8bd8[_0x4ae044(0x12f2)]=()=>{const _0x1059c3=_0x4ae044;_0xfafbd4?(_0x4f8dc1[_0x1059c3(0x1276)]['remove'](_0x1059c3(0xaef)),_0x3c8acb(_0xfafbd4)):alert(_0x1059c3(0xba8));},_0x4f8dc1[_0x4ae044(0x1276)]['add'](_0x4ae044(0xaef));});}function _0x49ad95(){return new Promise(_0x56211d=>{const _0x2d9c68=_0x55b8,_0x391438=document[_0x2d9c68(0x53a)]('werewolf-kill-modal'),_0x2ec717=document[_0x2d9c68(0x53a)]('werewolf-kill-selection-list'),_0x2afb4f=document[_0x2d9c68(0x53a)](_0x2d9c68(0x1047)),_0x8c0bf1=_0x391438['querySelector']('.modal-header\x20span'),_0x26fdc1=_0x30aab7[_0x2d9c68(0x4db)][_0x2d9c68(0x2dd)](_0x1ce0d4=>_0x1ce0d4[_0x2d9c68(0xb4d)]==='狼人'&&_0x1ce0d4[_0x2d9c68(0x1038)]),_0x382842=_0x26fdc1[_0x2d9c68(0x2dd)](_0x358c8a=>_0x358c8a['id']!==_0x2d9c68(0x10ae))[_0x2d9c68(0xcb4)](_0x216436=>_0x216436[_0x2d9c68(0x234)])[_0x2d9c68(0x2c8)]('、');_0x382842?_0x8c0bf1['innerHTML']='狼人请选择刀人对象<br><small\x20style=\x22font-weight:normal;\x20font-size:\x2013px;\x22>你的队友是:\x20'+_0x382842+_0x2d9c68(0x90f):_0x8c0bf1['textContent']=_0x2d9c68(0xbd0);_0x2ec717['innerHTML']='';let _0x823e05=null;const _0x19b8d7=_0x30aab7[_0x2d9c68(0x4db)][_0x2d9c68(0x2dd)](_0x50422=>_0x50422['isAlive']&&_0x50422[_0x2d9c68(0xb4d)]!=='狼人');_0x19b8d7[_0x2d9c68(0xeaf)](_0xb45865=>{const _0x205f11=_0x2d9c68,_0x1a1dc8=document[_0x205f11(0xd67)](_0x205f11(0x1425));_0x1a1dc8[_0x205f11(0x6de)]=_0x205f11(0x812),_0x1a1dc8[_0x205f11(0x999)]['id']=_0xb45865['id'],_0x1a1dc8['innerHTML']='<img\x20src=\x22'+_0xb45865[_0x205f11(0x8cd)]+_0x205f11(0x1061)+_0xb45865['name']+_0x205f11(0xbec),_0x1a1dc8[_0x205f11(0x12f2)]=()=>{const _0x27ce97=_0x205f11;_0x2ec717[_0x27ce97(0xc3d)]('.selected')[_0x27ce97(0xeaf)](_0x4dd2de=>_0x4dd2de[_0x27ce97(0x1276)][_0x27ce97(0x2d4)](_0x27ce97(0x1015))),_0x1a1dc8[_0x27ce97(0x1276)][_0x27ce97(0xe13)](_0x27ce97(0x1015)),_0x823e05=_0xb45865['id'];},_0x2ec717['appendChild'](_0x1a1dc8);});const _0x352717=_0x2afb4f[_0x2d9c68(0x75a)](!![]);_0x2afb4f[_0x2d9c68(0x9e8)][_0x2d9c68(0xa1d)](_0x352717,_0x2afb4f),_0x352717['onclick']=()=>{const _0x49cb3c=_0x2d9c68;_0x823e05?(_0x391438['classList']['remove'](_0x49cb3c(0xaef)),_0x56211d(_0x823e05)):alert('请选择一个目标。');},_0x391438[_0x2d9c68(0x1276)][_0x2d9c68(0xe13)](_0x2d9c68(0xaef));});}function _0x288158(){const _0x20b6ba=_0x13d875,_0x524ed2=_0x30aab7[_0x20b6ba(0x4db)][_0x20b6ba(0x397)](_0x30c07e=>_0x30c07e['id']===_0x20b6ba(0x10ae));if(!_0x524ed2||!_0x524ed2['isAlive'])return;const _0x31e3e3=document[_0x20b6ba(0x53a)](_0x20b6ba(0x1039)),_0x329279=_0x31e3e3[_0x20b6ba(0x11a2)][_0x20b6ba(0x13bc)]();_0x329279&&(_0x28ad36(_0x524ed2[_0x20b6ba(0x234)],_0x329279),_0x141d83()),document[_0x20b6ba(0x53a)]('werewolf-action-bar')['style'][_0x20b6ba(0x11d9)]='none',_0x31e3e3['value']='',_0x4831ee();}async function _0x556d19(){const _0x27ce2e=_0x13d875;_0x2becb6('你让大家继续讨论...'),_0x141d83();const _0x5b46ef=document['getElementById'](_0x27ce2e(0xa56));if(_0x5b46ef)_0x5b46ef[_0x27ce2e(0xb77)]=!![];await _0x184397(_0x27ce2e(0xb83),_0x27ce2e(0xcda));const {proxyUrl:_0x336f4e,apiKey:_0x506c06,model:_0x1b3e5c}=_0x53d851[_0x27ce2e(0x80d)];if(!_0x336f4e||!_0x506c06||!_0x1b3e5c){alert(_0x27ce2e(0xfa2));return;}const _0x5c7297=_0x59675c();try{let _0x362601=_0x336f4e[_0x27ce2e(0x6e9)](_0x27ce2e(0x1046)),_0x2ce4b3=[{'role':_0x27ce2e(0x10ae),'content':_0x27ce2e(0x279)}],_0x4f2f25=_0x1697e7(_0x1b3e5c,_0x506c06,_0x5c7297,_0x2ce4b3);const _0x1d23ae=_0x362601?await fetch(_0x4f2f25[_0x27ce2e(0xb36)],_0x4f2f25[_0x27ce2e(0xd7c)]):await fetch(_0x336f4e+_0x27ce2e(0x434),{'method':_0x27ce2e(0xa4e),'headers':{'Content-Type':_0x27ce2e(0x85b),'Authorization':_0x27ce2e(0x841)+_0x506c06},'body':JSON[_0x27ce2e(0xe1e)]({'model':_0x1b3e5c,'messages':[{'role':'system','content':_0x5c7297},..._0x2ce4b3],'temperature':_0x53d851[_0x27ce2e(0x906)][_0x27ce2e(0xaf8)]||0.9})});if(!_0x1d23ae['ok']){const _0x390744=await _0x1d23ae[_0x27ce2e(0xdc2)]();throw new Error(_0x27ce2e(0x352)+_0x390744[_0x27ce2e(0x617)]['message']);}const _0x17184c=await _0x1d23ae[_0x27ce2e(0xdc2)](),_0x10b7c8=getGeminiResponseText(_0x17184c),_0x2690f4=_0x10b7c8[_0x27ce2e(0x1120)](/(\[[\s\S]*\])/);if(!_0x2690f4)throw new Error('AI返回的内容中未找到有效的JSON数组。原始返回:\x20'+_0x10b7c8);const _0x5f13ff=JSON['parse'](_0x2690f4[0x0]);for(const _0x1799fc of _0x5f13ff){_0x1799fc[_0x27ce2e(0x471)]&&_0x1799fc['dialogue']&&(_0x28ad36(_0x1799fc[_0x27ce2e(0x471)],_0x1799fc[_0x27ce2e(0x1266)]),_0x141d83(),await new Promise(_0x5e89e2=>setTimeout(_0x5e89e2,0x5dc+Math[_0x27ce2e(0xac4)]()*0x7d0)));}}catch(_0x174394){console[_0x27ce2e(0x617)](_0x27ce2e(0x9e2),_0x174394),await _0x184397(_0x27ce2e(0x5ad),_0x27ce2e(0xea6)+_0x174394[_0x27ce2e(0x875)]);}finally{if(_0x5b46ef)_0x5b46ef[_0x27ce2e(0xb77)]=![];}}async function _0x1c1287(){const _0x1b9e0c=_0x13d875,_0x10e7ac=_0x30aab7[_0x1b9e0c(0x4db)]['find'](_0x213346=>_0x213346['id']==='user');if(!_0x10e7ac||!_0x10e7ac[_0x1b9e0c(0x1038)]){console[_0x1b9e0c(0xad0)](_0x1b9e0c(0xdbe));return;}const _0x247c9f=document[_0x1b9e0c(0x53a)]('werewolf-user-input'),_0x4fd9e6=_0x247c9f['value'][_0x1b9e0c(0x13bc)]();if(!_0x4fd9e6){alert(_0x1b9e0c(0x2f9));return;}_0x28ad36(_0x10e7ac['name'],_0x4fd9e6),_0x141d83(),_0x247c9f['value']='',await _0x184397('请稍候',_0x1b9e0c(0xbf6));const {proxyUrl:_0x4d1b0e,apiKey:_0x4e1d3d,model:_0x20ad3c}=_0x53d851['apiConfig'];if(!_0x4d1b0e||!_0x4e1d3d||!_0x20ad3c){alert('API未配置，无法生成对话。');return;}const _0x110cdc=_0x59675c();try{let _0x161788=_0x4d1b0e[_0x1b9e0c(0x6e9)](_0x1b9e0c(0x1046)),_0x4bdeba=[{'role':'user','content':_0x1b9e0c(0x108d)+_0x10e7ac[_0x1b9e0c(0x234)]+_0x1b9e0c(0x1189)}],_0x3b7d78=_0x1697e7(_0x20ad3c,_0x4e1d3d,_0x110cdc,_0x4bdeba);const _0x2066d0=_0x161788?await fetch(_0x3b7d78[_0x1b9e0c(0xb36)],_0x3b7d78[_0x1b9e0c(0xd7c)]):await fetch(_0x4d1b0e+_0x1b9e0c(0x434),{'method':_0x1b9e0c(0xa4e),'headers':{'Content-Type':_0x1b9e0c(0x85b),'Authorization':_0x1b9e0c(0x841)+_0x4e1d3d},'body':JSON[_0x1b9e0c(0xe1e)]({'model':_0x20ad3c,'messages':[{'role':_0x1b9e0c(0xab3),'content':_0x110cdc},..._0x4bdeba],'temperature':_0x53d851[_0x1b9e0c(0x906)][_0x1b9e0c(0xaf8)]||0.9})});if(!_0x2066d0['ok']){const _0x17c01f=await _0x2066d0[_0x1b9e0c(0xdc2)]();throw new Error(_0x1b9e0c(0x352)+_0x17c01f[_0x1b9e0c(0x617)][_0x1b9e0c(0x875)]);}const _0x434985=await _0x2066d0[_0x1b9e0c(0xdc2)](),_0x1f54fd=getGeminiResponseText(_0x434985),_0x5a4530=_0x1f54fd[_0x1b9e0c(0x1120)](/(\[[\s\S]*\])/);if(!_0x5a4530)throw new Error(_0x1b9e0c(0xfe3)+_0x1f54fd);const _0x496b5f=JSON[_0x1b9e0c(0x367)](_0x5a4530[0x0]);for(const _0x509e69 of _0x496b5f){_0x509e69['speaker_name']&&_0x509e69[_0x1b9e0c(0x1266)]&&(_0x28ad36(_0x509e69[_0x1b9e0c(0x471)],_0x509e69['dialogue']),_0x141d83(),await new Promise(_0x3b30eb=>setTimeout(_0x3b30eb,0x5dc+Math[_0x1b9e0c(0xac4)]()*0x7d0)));}}catch(_0x466e40){console[_0x1b9e0c(0x617)](_0x1b9e0c(0x9e2),_0x466e40),await _0x184397('AI\x20发言失败',_0x1b9e0c(0xea6)+_0x466e40['message']);}}async function _0x4831ee(){const _0x3a69e7=_0x13d875;_0x2becb6(_0x3a69e7(0x10f9)),_0x141d83(),_0x30aab7[_0x3a69e7(0x771)]={};let _0x2ab971=null;_0x30aab7[_0x3a69e7(0xb30)]=_0x3a69e7(0x1435);try{_0x2ab971=await _0x2d7061(),_0x2ab971&&_0x2ab971[_0x3a69e7(0xeaf)](_0x509872=>{const _0xcba098=_0x3a69e7,_0x213b4d=_0x30aab7[_0xcba098(0x4db)][_0xcba098(0x397)](_0x18e76f=>_0x18e76f[_0xcba098(0x234)]===_0x509872[_0xcba098(0xd57)]),_0x302007=_0x30aab7[_0xcba098(0x4db)][_0xcba098(0x397)](_0x5c6ee9=>_0x5c6ee9['name']===_0x509872[_0xcba098(0x143e)]);_0x213b4d&&_0x213b4d['isAlive']&&_0x302007&&(_0x30aab7[_0xcba098(0x771)][_0x213b4d[_0xcba098(0x234)]]=_0x302007[_0xcba098(0x234)]);}),_0x30aab7[_0x3a69e7(0xb30)]=null;}catch(_0x393ca9){console[_0x3a69e7(0x617)](_0x3a69e7(0x11d3),_0x393ca9),await _0x184397('操作失败',_0x3a69e7(0x117d)+_0x393ca9[_0x3a69e7(0x875)]),document[_0x3a69e7(0x53a)](_0x3a69e7(0x4ff))['style'][_0x3a69e7(0x11d9)]=_0x3a69e7(0x1ea);return;}const _0x55640e=_0x30aab7[_0x3a69e7(0x4db)][_0x3a69e7(0x397)](_0x44847e=>_0x44847e['id']===_0x3a69e7(0x10ae));if(_0x55640e&&_0x55640e[_0x3a69e7(0x1038)]){_0x2becb6(_0x3a69e7(0x3b3)),_0x141d83();const _0x5053b4=await _0x443004(_0x3a69e7(0xa9f)),_0x4e1b94=_0x30aab7[_0x3a69e7(0x4db)][_0x3a69e7(0x397)](_0x100193=>_0x100193['id']===_0x5053b4);_0x4e1b94&&(_0x30aab7[_0x3a69e7(0x771)][_0x55640e[_0x3a69e7(0x234)]]=_0x4e1b94[_0x3a69e7(0x234)]);}_0x450485();}async function _0x2d7061(){const _0x46b87c=_0x13d875,{proxyUrl:_0x1761d8,apiKey:_0x4cec9a,model:_0xb68d2a}=_0x53d851['apiConfig'];if(!_0x1761d8||!_0x4cec9a||!_0xb68d2a)return null;const _0x324395=_0x30aab7[_0x46b87c(0x4db)][_0x46b87c(0x2dd)](_0x7c978=>_0x7c978[_0x46b87c(0x1038)]&&_0x7c978['id']!==_0x46b87c(0x10ae)),_0x58521f=_0x30aab7[_0x46b87c(0x4db)]['filter'](_0x204e8e=>_0x204e8e['isAlive'])['map'](_0x3952bc=>_0x3952bc[_0x46b87c(0x234)]);let _0x586b19=_0x59675c();_0x586b19+=_0x46b87c(0xb66)+_0x58521f[_0x46b87c(0x2c8)](',\x20')+_0x46b87c(0xe0d);try{let _0xaa2331=_0x1761d8[_0x46b87c(0x6e9)](_0x46b87c(0x1046)),_0x16c2b4=[{'role':_0x46b87c(0x10ae),'content':'请所有AI角色开始投票。'}],_0x5d3e09=_0x1697e7(_0xb68d2a,_0x4cec9a,_0x586b19,_0x16c2b4);const _0x9bf16=_0xaa2331?await fetch(_0x5d3e09['url'],_0x5d3e09[_0x46b87c(0xd7c)]):await fetch(_0x1761d8+_0x46b87c(0x434),{'method':_0x46b87c(0xa4e),'headers':{'Content-Type':_0x46b87c(0x85b),'Authorization':'Bearer\x20'+_0x4cec9a},'body':JSON[_0x46b87c(0xe1e)]({'model':_0xb68d2a,'messages':[{'role':_0x46b87c(0xab3),'content':_0x586b19},..._0x16c2b4],'temperature':_0x53d851[_0x46b87c(0x906)][_0x46b87c(0xaf8)]||0.8})});if(!_0x9bf16['ok'])throw new Error((await _0x9bf16[_0x46b87c(0xdc2)]())['error'][_0x46b87c(0x875)]);const _0x155854=await _0x9bf16['json'](),_0x2c8914=getGeminiResponseText(_0x155854);let _0x292895=_0x2c8914[_0x46b87c(0x795)](/^```json\s*/,'')[_0x46b87c(0x795)](/```$/,'')[_0x46b87c(0x13bc)]();const _0x4a6884=_0x292895[_0x46b87c(0x57c)]('['),_0x4eee38=_0x292895[_0x46b87c(0x1149)](']');if(_0x4a6884===-0x1||_0x4eee38===-0x1||_0x4eee38<_0x4a6884)throw new Error('AI返回的投票结果中未找到有效的JSON数组结构\x20(`[...]`)。');const _0x8ddb84=_0x292895[_0x46b87c(0xad6)](_0x4a6884,_0x4eee38+0x1);try{const _0x5a1ae4=_0x8ddb84['match'](/(\[[\s\S]*?\])/g);if(_0x5a1ae4&&_0x5a1ae4['length']>0x0)return JSON[_0x46b87c(0x367)](_0x5a1ae4[_0x5a1ae4['length']-0x1]);return JSON[_0x46b87c(0x367)](_0x8ddb84);}catch(_0x40375c){throw new Error(_0x46b87c(0x658)+_0x40375c[_0x46b87c(0x875)]+_0x46b87c(0xa01)+_0x2c8914);}}catch(_0x3ad49d){console[_0x46b87c(0x617)](_0x46b87c(0x20f),_0x3ad49d);throw new Error(_0x46b87c(0x7a0)+_0x3ad49d[_0x46b87c(0x875)]);}}function _0x450485(){const _0x85048a=_0x13d875,_0x116201={},_0x32f665={};for(const _0x2a52cd in _0x30aab7[_0x85048a(0x771)]){const _0x3266e7=_0x30aab7[_0x85048a(0x771)][_0x2a52cd];_0x116201[_0x3266e7]=(_0x116201[_0x3266e7]||0x0)+0x1,!_0x32f665[_0x3266e7]&&(_0x32f665[_0x3266e7]=[]),_0x32f665[_0x3266e7][_0x85048a(0x7dd)](_0x2a52cd);}let _0x305296=0x0,_0x50b83=[];for(const _0x7c1e19 in _0x116201){const _0x54d254=_0x116201[_0x7c1e19];if(_0x54d254>_0x305296)_0x305296=_0x54d254,_0x50b83=[_0x7c1e19];else _0x54d254===_0x305296&&_0x50b83[_0x85048a(0x7dd)](_0x7c1e19);}_0x2becb6(_0x85048a(0xacc));for(const _0x467103 in _0x32f665){_0x2becb6(_0x467103+'\x20('+_0x32f665[_0x467103][_0x85048a(0x29d)]+'票):\x20'+_0x32f665[_0x467103][_0x85048a(0x2c8)]('、\x20'));}if(_0x50b83[_0x85048a(0x29d)]===0x1&&_0x305296>0x0){const _0x27101a=_0x30aab7[_0x85048a(0x4db)]['find'](_0x1c03fc=>_0x1c03fc['name']===_0x50b83[0x0]);if(_0x27101a){_0x27101a['isAlive']=![],_0x2becb6(_0x27101a[_0x85048a(0x234)]+_0x85048a(0x12e7));if(_0x27101a['role']==='猎人'){}}}else _0x2becb6(_0x85048a(0xc99));_0x141d83();if(_0x423ed0())return;_0x30aab7[_0x85048a(0x101c)]++,_0x338c52();}async function _0x552bbb(){const _0x5409d9=_0x13d875,{proxyUrl:_0x2fa28c,apiKey:_0x1945bc,model:_0x42dbdd}=_0x53d851[_0x5409d9(0x80d)];if(!_0x2fa28c||!_0x1945bc||!_0x42dbdd)return null;const _0x1211b0=_0x30aab7[_0x5409d9(0x4db)]['filter'](_0x1fe305=>_0x1fe305[_0x5409d9(0xb4d)]==='狼人'&&_0x1fe305[_0x5409d9(0x1038)]),_0xcacdd0=_0x30aab7[_0x5409d9(0x4db)][_0x5409d9(0x2dd)](_0x3631b8=>_0x3631b8['isAlive']&&_0x3631b8['role']!=='狼人'),_0x3fba9a='\x0a#\x20你的任务\x0a你现在是狼人团队的指挥官。你的任务是分析当前局势，并为狼人团队选择一个最佳的刀人目标。\x0a#\x20核心规则\x0a1.\x20\x20**目标**:\x20优先刀掉预言家、女巫等神职人员。如果没有明确的神职信息，可以根据发言来判断谁的逻辑清晰、威胁最大。\x0a2.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20`{\x22target_name\x22:\x20\x22你决定要刀的玩家名字\x22}`\x0a\x0a#\x20游戏状态\x0a-\x20**你的狼队友是**:\x20'+_0x1211b0[_0x5409d9(0xcb4)](_0x46287e=>_0x46287e['name'])['join']('、\x20')+'\x0a-\x20**可以刀的玩家列表**:\x20'+_0xcacdd0[_0x5409d9(0xcb4)](_0x39bf02=>_0x39bf02[_0x5409d9(0x234)])[_0x5409d9(0x2c8)]('、\x20')+'\x0a-\x20**讨论摘要**:\x20\x0a'+_0x30aab7['discussionLog']['map'](_0x55447c=>_0x55447c[_0x5409d9(0xca3)]+':\x20'+_0x55447c[_0x5409d9(0x73e)])[_0x5409d9(0x2c8)]('\x0a')+_0x5409d9(0x1102);try{let _0x47cff3=_0x2fa28c[_0x5409d9(0x6e9)]('generativelanguage'),_0x3e67d4=[{'role':_0x5409d9(0x10ae),'content':_0x5409d9(0x8a2)}],_0x5d39a7=_0x1697e7(_0x42dbdd,_0x1945bc,_0x3fba9a,_0x3e67d4);const _0x57950a=_0x47cff3?await fetch(_0x5d39a7['url'],_0x5d39a7['data']):await fetch(_0x2fa28c+'/v1/chat/completions',{'method':_0x5409d9(0xa4e),'headers':{'Content-Type':_0x5409d9(0x85b),'Authorization':_0x5409d9(0x841)+_0x1945bc},'body':JSON[_0x5409d9(0xe1e)]({'model':_0x42dbdd,'messages':[{'role':_0x5409d9(0xab3),'content':_0x3fba9a},..._0x3e67d4],'temperature':_0x53d851['globalSettings'][_0x5409d9(0xaf8)]||0.8})});if(!_0x57950a['ok'])throw new Error((await _0x57950a[_0x5409d9(0xdc2)]())[_0x5409d9(0x617)]['message']);const _0x33de88=await _0x57950a[_0x5409d9(0xdc2)](),_0x593020=getGeminiResponseText(_0x33de88),_0x415f09=_0x593020[_0x5409d9(0x1120)](/({[\s\S]*})/);if(!_0x415f09)throw new Error(_0x5409d9(0x806));const _0x25913d=JSON[_0x5409d9(0x367)](_0x415f09[0x0]),_0x2a198b=_0x30aab7[_0x5409d9(0x4db)][_0x5409d9(0x397)](_0x57f2c4=>_0x57f2c4[_0x5409d9(0x234)]===_0x25913d[_0x5409d9(0x688)]);return _0x2a198b?_0x2a198b['id']:null;}catch(_0x2928ea){return console['error'](_0x5409d9(0x106d),_0x2928ea),_0xcacdd0[Math['floor'](Math[_0x5409d9(0xac4)]()*_0xcacdd0['length'])]['id'];}}function _0x2846e3(_0x12f5fc,_0x1c3231){return new Promise(_0x3839a2=>{const _0x4bf8a6=_0x55b8,_0x20c453=document[_0x4bf8a6(0x53a)](_0x4bf8a6(0x4d3)),_0x31178c=document[_0x4bf8a6(0x53a)]('werewolf-witch-selection-list'),_0x58334f=document[_0x4bf8a6(0x53a)](_0x4bf8a6(0x665)),_0x1722b4=document[_0x4bf8a6(0x53a)]('confirm-witch-poison-btn'),_0x3cab3c=document[_0x4bf8a6(0x53a)]('witch-do-nothing-btn');_0x31178c[_0x4bf8a6(0xaac)]='';const _0x40c5e0=_0x1722b4[_0x4bf8a6(0x75a)](!![]);_0x1722b4[_0x4bf8a6(0x9e8)][_0x4bf8a6(0xa1d)](_0x40c5e0,_0x1722b4);const _0x943c60=_0x3cab3c['cloneNode'](!![]);_0x3cab3c[_0x4bf8a6(0x9e8)][_0x4bf8a6(0xa1d)](_0x943c60,_0x3cab3c),_0x40c5e0[_0x4bf8a6(0x1284)]['display']=_0x4bf8a6(0x1ea),_0x40c5e0[_0x4bf8a6(0xb77)]=!![];let _0x13c13e={'save':![],'poison':null},_0x1f4dc8=null;if(_0x12f5fc&&!_0x1c3231[_0x4bf8a6(0xa5a)]){_0x58334f[_0x4bf8a6(0x34a)]=_0x4bf8a6(0xa4c)+_0x12f5fc['name']+_0x4bf8a6(0xbe1);const _0x5d5bf7=document[_0x4bf8a6(0xd67)](_0x4bf8a6(0x59e));_0x5d5bf7[_0x4bf8a6(0x6de)]=_0x4bf8a6(0x9f2),_0x5d5bf7[_0x4bf8a6(0x34a)]=_0x4bf8a6(0x301),_0x5d5bf7[_0x4bf8a6(0x1284)][_0x4bf8a6(0x1332)]=_0x4bf8a6(0x1217),_0x5d5bf7[_0x4bf8a6(0x12f2)]=()=>{const _0x3cdf7f=_0x4bf8a6;_0x13c13e[_0x3cdf7f(0x66a)]=!![],_0x20c453[_0x3cdf7f(0x1276)][_0x3cdf7f(0x2d4)](_0x3cdf7f(0xaef)),_0x3839a2(_0x13c13e);},_0x31178c[_0x4bf8a6(0x133d)](_0x5d5bf7);}else _0x12f5fc?_0x58334f[_0x4bf8a6(0x34a)]=_0x4bf8a6(0xa4c)+_0x12f5fc[_0x4bf8a6(0x234)]+_0x4bf8a6(0xdc7):_0x58334f[_0x4bf8a6(0x34a)]='昨晚是平安夜';if(!_0x1c3231['poisonUsed']){const _0x120edd=document['createElement']('p');_0x120edd[_0x4bf8a6(0x34a)]=_0x4bf8a6(0x11f9),_0x120edd[_0x4bf8a6(0x1284)][_0x4bf8a6(0x12dd)]=_0x4bf8a6(0x25d),_0x120edd[_0x4bf8a6(0x1284)][_0x4bf8a6(0xfad)]=_0x4bf8a6(0x1217),_0x31178c[_0x4bf8a6(0x133d)](_0x120edd);const _0x33ebbe=_0x30aab7['players'][_0x4bf8a6(0x2dd)](_0x2edd10=>_0x2edd10[_0x4bf8a6(0x1038)]&&_0x2edd10['id']!==_0x12f5fc?.['id']);_0x33ebbe[_0x4bf8a6(0xeaf)](_0x613c17=>{const _0x538a77=_0x4bf8a6,_0x4561a7=document[_0x538a77(0xd67)](_0x538a77(0x1425));_0x4561a7['className']=_0x538a77(0x812),_0x4561a7[_0x538a77(0x999)]['id']=_0x613c17['id'],_0x4561a7[_0x538a77(0xaac)]=_0x538a77(0x88b)+_0x613c17[_0x538a77(0x8cd)]+_0x538a77(0x1061)+_0x613c17[_0x538a77(0x234)]+_0x538a77(0xbec),_0x4561a7[_0x538a77(0x12f2)]=()=>{const _0x48a1ff=_0x538a77;_0x31178c[_0x48a1ff(0xc3d)](_0x48a1ff(0x7de))['forEach'](_0x226110=>_0x226110['classList']['remove'](_0x48a1ff(0x1015))),_0x4561a7['classList']['add'](_0x48a1ff(0x1015)),_0x1f4dc8=_0x613c17['id'],_0x40c5e0[_0x48a1ff(0xb77)]=![];},_0x31178c[_0x538a77(0x133d)](_0x4561a7);});}_0x40c5e0[_0x4bf8a6(0x12f2)]=()=>{const _0x10663e=_0x4bf8a6;_0x1f4dc8&&(_0x13c13e['poison']=_0x1f4dc8,_0x20c453[_0x10663e(0x1276)][_0x10663e(0x2d4)](_0x10663e(0xaef)),_0x3839a2(_0x13c13e));},_0x943c60[_0x4bf8a6(0x12f2)]=()=>{const _0x25659b=_0x4bf8a6;_0x20c453['classList']['remove'](_0x25659b(0xaef)),_0x3839a2(_0x13c13e);},_0x20c453[_0x4bf8a6(0x1276)][_0x4bf8a6(0xe13)](_0x4bf8a6(0xaef));});}async function _0x30f786(){const _0x3a0e50=_0x13d875,_0xea1c1a=_0x30aab7[_0x3a0e50(0xb30)];if(!_0xea1c1a)return;document[_0x3a0e50(0x53a)](_0x3a0e50(0x4ff))[_0x3a0e50(0x1284)][_0x3a0e50(0x11d9)]='none',await _0x184397(_0x3a0e50(0x11d7),_0x3a0e50(0x129d)+_0xea1c1a+'\x22操作...');switch(_0xea1c1a){case _0x3a0e50(0x10d1):await _0x338c52();break;case _0x3a0e50(0x22c):await _0x165721();break;case _0x3a0e50(0x1435):await _0x4831ee();break;}}function _0x423ed0(){const _0x594fc9=_0x13d875,_0x165802=_0x30aab7['players'][_0x594fc9(0x2dd)](_0x1c78b8=>_0x1c78b8[_0x594fc9(0x1038)]),_0x1f42bb=_0x165802[_0x594fc9(0x2dd)](_0x3338aa=>_0x3338aa[_0x594fc9(0xb4d)]==='狼人'),_0x303d45=_0x165802[_0x594fc9(0x2dd)](_0x45c186=>['预言家','女巫','猎人','守卫'][_0x594fc9(0x6e9)](_0x45c186[_0x594fc9(0xb4d)])),_0x544825=_0x165802[_0x594fc9(0x2dd)](_0x34bd82=>_0x34bd82[_0x594fc9(0xb4d)]==='平民');let _0x594792=null;if(_0x1f42bb['length']===0x0)_0x594792='好人';else{if(_0x1f42bb[_0x594fc9(0x29d)]>=_0x303d45[_0x594fc9(0x29d)]+_0x544825[_0x594fc9(0x29d)])_0x594792='狼人';else _0x30aab7[_0x594fc9(0x3d4)]==='12p'?(_0x303d45[_0x594fc9(0x29d)]===0x0||_0x544825[_0x594fc9(0x29d)]===0x0)&&(_0x594792='狼人'):_0x303d45[_0x594fc9(0x29d)]===0x0&&_0x544825[_0x594fc9(0x29d)]===0x0&&(_0x594792='狼人');}if(_0x594792)return _0x1d2f7a(_0x594792),!![];return![];}async function _0x4a8c8c(){const _0x117550=_0x13d875,_0x45acd2=await _0x355fc0(_0x117550(0x911),'此功能将扫描数据库，尝试找出并修复“角色在数据库中存在，但未在聊天列表显示”的问题。<br><br><strong>操作通常是安全的，但仍建议在操作前备份数据。</strong>',{'confirmText':_0x117550(0xf5a)});if(!_0x45acd2)return;await _0x184397(_0x117550(0x11d7),_0x117550(0x124c));try{const _0x524473=await _0xa62efb[_0x117550(0xaa3)][_0x117550(0xa73)]();let _0x55ae4c=0x0;for(const _0x501066 of _0x524473){let _0x1e94b4=![];!Array[_0x117550(0xb31)](_0x501066[_0x117550(0xe83)])&&(_0x501066[_0x117550(0xe83)]=[],_0x1e94b4=!![]),(typeof _0x501066[_0x117550(0x81e)]!==_0x117550(0xc74)||_0x501066[_0x117550(0x81e)]===null)&&(_0x501066['settings']={},_0x1e94b4=!![]),!_0x501066['isGroup']&&!_0x501066[_0x117550(0x543)]&&(_0x501066[_0x117550(0x543)]=_0x501066[_0x117550(0x234)],_0x1e94b4=!![]),typeof _0x501066['unreadCount']===_0x117550(0x131e)&&(_0x501066[_0x117550(0x8ce)]=0x0,_0x1e94b4=!![]),!Array[_0x117550(0xb31)](_0x501066[_0x117550(0x1016)])&&(_0x501066['longTermMemory']=[],_0x1e94b4=!![]),_0x1e94b4&&(_0x55ae4c++,console[_0x117550(0x1081)](_0x117550(0x135b)+_0x501066['name']+_0x117550(0x1346)+_0x501066['id']+')\x20的残缺数据。'),await _0xa62efb[_0x117550(0xaa3)][_0x117550(0x546)](_0x501066)),_0x53d851[_0x117550(0xaa3)][_0x501066['id']]=_0x501066;}_0x55ae4c>0x0?(await _0x184397(_0x117550(0x13b5),_0x117550(0x1042)+_0x55ae4c+_0x117550(0x10fa)),await _0x5001a4()):await _0x184397('检查完成',_0x117550(0x569));}catch(_0x22dd8a){console['error']('数据检查与修复失败:',_0x22dd8a),await _0x184397('操作失败',_0x117550(0x680)+_0x22dd8a[_0x117550(0x875)]);}}function _0x1e432c(_0x539305,_0x268d2b=_0x13d875(0x624)){const _0x440cd5=_0x13d875;if(_0x539305[_0x440cd5(0x139c)](_0x440cd5(0xe79)))return;const _0x13e07e=document[_0x440cd5(0xd67)](_0x440cd5(0x1425));_0x13e07e[_0x440cd5(0x6de)]=_0x440cd5(0xdd4),_0x13e07e[_0x440cd5(0xaac)]=_0x440cd5(0x47e),_0x268d2b==='bottom'?_0x539305[_0x440cd5(0x133d)](_0x13e07e):_0x539305[_0x440cd5(0x860)](_0x13e07e);}function _0x41b779(_0x348b65){const _0x3c7630=_0x13d875,_0x516ce8=_0x348b65[_0x3c7630(0x139c)](_0x3c7630(0xe79));_0x516ce8&&_0x516ce8[_0x3c7630(0x2d4)]();}async function _0x4ca2bc(){const _0x470d14=_0x13d875,_0x29cb53=document[_0x470d14(0x53a)](_0x470d14(0x1164)),_0x4b71ff=document[_0x470d14(0x53a)]('delete-world-books-list'),_0x992582=document[_0x470d14(0x53a)]('select-all-world-books-for-clear');_0x4b71ff['innerHTML']='',_0x992582[_0x470d14(0x1077)]=![];const _0x2815a9=await _0xa62efb[_0x470d14(0x10f2)][_0x470d14(0xa73)]();_0x2815a9['length']===0x0?_0x4b71ff[_0x470d14(0xaac)]=_0x470d14(0xc8a):_0x2815a9[_0x470d14(0xeaf)](_0x3c7d0c=>{const _0xcc89a3=_0x470d14,_0x41eea7=document[_0xcc89a3(0xd67)](_0xcc89a3(0x1425));_0x41eea7[_0xcc89a3(0x6de)]='clear-posts-item',_0x41eea7['dataset'][_0xcc89a3(0x6a9)]=_0x3c7d0c['id'],_0x41eea7[_0xcc89a3(0xaac)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x3c7d0c[_0xcc89a3(0x234)]+_0xcc89a3(0x752),_0x4b71ff[_0xcc89a3(0x133d)](_0x41eea7);}),_0x29cb53[_0x470d14(0x1276)][_0x470d14(0xe13)](_0x470d14(0xaef));}async function _0x57462d(){const _0xd1547e=_0x13d875,_0x227f30=document['querySelectorAll'](_0xd1547e(0x1338));if(_0x227f30[_0xd1547e(0x29d)]===0x0){alert(_0xd1547e(0x687));return;}const _0x432983=Array[_0xd1547e(0xd97)](_0x227f30)[_0xd1547e(0xcb4)](_0x1a89e0=>_0x1a89e0[_0xd1547e(0x999)][_0xd1547e(0x6a9)]),_0x41c852=await _0x355fc0('最后确认！','此操作将永久删除您选择的\x20'+_0x227f30[_0xd1547e(0x29d)]+'\x20本世界书，并解除它们与所有角色的关联。此操作【不可恢复】！',{'confirmButtonClass':'btn-danger','confirmText':_0xd1547e(0x69a)});if(!_0x41c852)return;await _0x184397(_0xd1547e(0x11d7),_0xd1547e(0x11f2));try{await _0xa62efb[_0xd1547e(0x11ab)]('rw',_0xa62efb['worldBooks'],_0xa62efb[_0xd1547e(0xaa3)],async()=>{const _0x5380b8=_0xd1547e;await _0xa62efb[_0x5380b8(0x10f2)][_0x5380b8(0x12e5)](_0x432983);const _0x11a5b0=await _0xa62efb[_0x5380b8(0xaa3)]['toArray']();for(const _0xaa45df of _0x11a5b0){if(_0xaa45df['settings']&&Array['isArray'](_0xaa45df[_0x5380b8(0x81e)][_0x5380b8(0x4ab)])){const _0x41e2fa=_0xaa45df[_0x5380b8(0x81e)][_0x5380b8(0x4ab)]['length'];_0xaa45df[_0x5380b8(0x81e)][_0x5380b8(0x4ab)]=_0xaa45df[_0x5380b8(0x81e)][_0x5380b8(0x4ab)][_0x5380b8(0x2dd)](_0x5340d4=>!_0x432983[_0x5380b8(0x6e9)](_0x5340d4)),_0xaa45df[_0x5380b8(0x81e)]['linkedWorldBookIds'][_0x5380b8(0x29d)]<_0x41e2fa&&await _0xa62efb[_0x5380b8(0xaa3)][_0x5380b8(0x546)](_0xaa45df);}}}),_0x53d851['worldBooks']=_0x53d851[_0xd1547e(0x10f2)]['filter'](_0x12f7b8=>!_0x432983[_0xd1547e(0x6e9)](_0x12f7b8['id'])),document[_0xd1547e(0x53a)](_0xd1547e(0x1164))['classList'][_0xd1547e(0x2d4)]('visible'),await _0x184397(_0xd1547e(0x134f),_0x227f30[_0xd1547e(0x29d)]+_0xd1547e(0x685));}catch(_0x5912f5){console[_0xd1547e(0x617)](_0xd1547e(0xd6b),_0x5912f5),await _0x184397(_0xd1547e(0x62b),_0xd1547e(0xb8e)+_0x5912f5['message']);}}function _0x4a6b00(){const _0x2af23b=_0x13d875;if(!_0x53d851['activeChatId'])return;const _0x429d3d=_0x53d851[_0x2af23b(0x13be)],_0x12d752=document[_0x2af23b(0x53a)](_0x2af23b(0xd88)),_0x5c8aeb=document[_0x2af23b(0x53a)]('reading-window'),_0x15c903=document['getElementById']('reading-restore-btn');let _0x566717=_0x4e8694[_0x429d3d];if(_0x566717&&_0x566717[_0x2af23b(0x975)]){_0x566717['isMinimized']&&_0xb9ad05();_0x12d752[_0x2af23b(0x1284)]['display']='flex';return;}_0x5b1fee(_0x429d3d),_0x375173(_0x429d3d),_0x12d752[_0x2af23b(0x1284)]['display']='flex',_0x5c8aeb[_0x2af23b(0x1276)]['remove'](_0x2af23b(0x63c)),_0x15c903[_0x2af23b(0x1284)][_0x2af23b(0x11d9)]=_0x2af23b(0xbf2);const _0x3252bf=document[_0x2af23b(0x53a)](_0x2af23b(0xf87)),_0x5bcf09=_0x5c8aeb[_0x2af23b(0xde9)](),_0x432a7f=(_0x3252bf['clientHeight']-_0x5bcf09[_0x2af23b(0xfeb)])/0x2,_0x2d710a=(_0x3252bf[_0x2af23b(0x703)]-_0x5bcf09[_0x2af23b(0xd10)])/0x2;_0x5c8aeb[_0x2af23b(0x1284)][_0x2af23b(0x624)]=_0x432a7f+'px',_0x5c8aeb['style'][_0x2af23b(0xcd7)]=_0x2d710a+'px',_0x5c8aeb[_0x2af23b(0x1284)][_0x2af23b(0xd91)]='';}function _0x5b1fee(_0x4ff651){_0x4e8694[_0x4ff651]={'isActive':!![],'isMinimized':![],'title':'未选择书籍','contentLines':[],'currentPage':0x0,'totalPages':0x0,'linesPerPage':0xf,'currentSnippet':''};}function _0x23ce0e(){const _0x177157=_0x13d875,_0x3dd8be=_0x53d851[_0x177157(0x13be)];if(!_0x3dd8be||!_0x4e8694[_0x3dd8be]||!_0x4e8694[_0x3dd8be]['isActive'])return;document[_0x177157(0x53a)]('reading-overlay')[_0x177157(0x1284)][_0x177157(0x11d9)]='none',document[_0x177157(0x53a)]('reading-restore-btn')[_0x177157(0x1284)][_0x177157(0x11d9)]=_0x177157(0xbf2),document[_0x177157(0x53a)](_0x177157(0x1e0))[_0x177157(0x1276)][_0x177157(0x2d4)]('minimized'),_0x4e8694[_0x3dd8be]['isActive']=![],console['log'](_0x177157(0x330));}function _0xc9dcef(){const _0xe33b13=_0x13d875,_0x5a3655=_0x4e8694[_0x53d851['activeChatId']];if(!_0x5a3655||!_0x5a3655['isActive']||_0x5a3655[_0xe33b13(0x25a)])return;_0x5a3655[_0xe33b13(0x25a)]=!![],document[_0xe33b13(0x53a)](_0xe33b13(0x1e0))[_0xe33b13(0x1276)][_0xe33b13(0xe13)](_0xe33b13(0x63c)),document['getElementById']('reading-restore-btn')[_0xe33b13(0x1284)]['display']=_0xe33b13(0x2f6);}function _0xb9ad05(){const _0x2820a5=_0x13d875,_0x50c3b7=_0x4e8694[_0x53d851['activeChatId']];if(!_0x50c3b7||!_0x50c3b7[_0x2820a5(0x975)]||!_0x50c3b7[_0x2820a5(0x25a)])return;_0x50c3b7[_0x2820a5(0x25a)]=![],document['getElementById'](_0x2820a5(0xc0c))[_0x2820a5(0x1284)][_0x2820a5(0x11d9)]=_0x2820a5(0xbf2),document['getElementById'](_0x2820a5(0x1e0))['classList'][_0x2820a5(0x2d4)](_0x2820a5(0x63c));}function _0x15ab6a(_0x1d3239,_0x1eb4ec){const _0x49b69f=_0x13d875;let _0x546e35=0x0,_0x50449a=0x0,_0x581192=0x0,_0x85a8aa=0x0;const _0x53862e=document[_0x49b69f(0x53a)](_0x49b69f(0xf87)),_0x337579=_0x1c232c=>{const _0x19f45d=_0x49b69f;if(_0x1c232c[_0x19f45d(0x9c2)][_0x19f45d(0x106f)](_0x19f45d(0x59e)))return;if(_0x1d3239[_0x19f45d(0x1284)][_0x19f45d(0xd91)]){const _0x396d50=_0x1d3239[_0x19f45d(0xde9)](),_0x28198e=_0x1d3239[_0x19f45d(0x507)][_0x19f45d(0xde9)]();_0x1d3239[_0x19f45d(0x1284)][_0x19f45d(0x624)]=_0x396d50['top']-_0x28198e[_0x19f45d(0x624)]+'px',_0x1d3239['style'][_0x19f45d(0xcd7)]=_0x396d50[_0x19f45d(0xcd7)]-_0x28198e[_0x19f45d(0xcd7)]+'px',_0x1d3239[_0x19f45d(0x1284)][_0x19f45d(0xd91)]='';}_0x1c232c[_0x19f45d(0x1013)]();const _0x407229=_0x1c232c[_0x19f45d(0x919)]===_0x19f45d(0x3bc)?_0x1c232c[_0x19f45d(0xd44)][0x0]:_0x1c232c;_0x581192=_0x407229[_0x19f45d(0x1251)],_0x85a8aa=_0x407229[_0x19f45d(0xe71)],document['addEventListener'](_0x19f45d(0xacd),_0x3f10d8),document[_0x19f45d(0x1086)]('mousemove',_0x443052),document['addEventListener'](_0x19f45d(0xab6),_0x3f10d8),document['addEventListener']('touchmove',_0x443052);},_0x443052=_0x14e942=>{const _0x512e60=_0x49b69f,_0x556a99=_0x14e942['type']===_0x512e60(0xd22)?_0x14e942[_0x512e60(0xd44)][0x0]:_0x14e942;_0x546e35=_0x581192-_0x556a99['clientX'],_0x50449a=_0x85a8aa-_0x556a99['clientY'],_0x581192=_0x556a99[_0x512e60(0x1251)],_0x85a8aa=_0x556a99[_0x512e60(0xe71)];let _0x13d146=_0x1d3239[_0x512e60(0x938)]-_0x50449a,_0x2ed6ac=_0x1d3239['offsetLeft']-_0x546e35;const _0x2c17ee=_0x53862e[_0x512e60(0x252)]-_0x1d3239[_0x512e60(0x127d)]-0xa,_0x211ee6=_0x53862e['clientWidth']-_0x1d3239[_0x512e60(0xb6f)]-0xa;_0x13d146=Math[_0x512e60(0x69b)](0xa,Math[_0x512e60(0x683)](_0x13d146,_0x2c17ee)),_0x2ed6ac=Math[_0x512e60(0x69b)](0xa,Math[_0x512e60(0x683)](_0x2ed6ac,_0x211ee6)),_0x1d3239[_0x512e60(0x1284)][_0x512e60(0x624)]=_0x13d146+'px',_0x1d3239[_0x512e60(0x1284)][_0x512e60(0xcd7)]=_0x2ed6ac+'px';},_0x3f10d8=()=>{const _0x1c1243=_0x49b69f;document[_0x1c1243(0x5ce)](_0x1c1243(0xacd),_0x3f10d8),document['removeEventListener']('mousemove',_0x443052),document[_0x1c1243(0x5ce)](_0x1c1243(0xab6),_0x3f10d8),document[_0x1c1243(0x5ce)](_0x1c1243(0xd22),_0x443052);};_0x1eb4ec[_0x49b69f(0x1086)](_0x49b69f(0xff3),_0x337579),_0x1eb4ec[_0x49b69f(0x1086)]('touchstart',_0x337579);}function _0x375173(_0x53fdd0){const _0x197cee=_0x13d875,_0x563805=_0x4e8694[_0x53fdd0];if(!_0x563805)return;const _0x59d4d7=document['getElementById'](_0x197cee(0x10ab)),_0x9dda7c=document['getElementById'](_0x197cee(0x892)),_0x392c93=document[_0x197cee(0x53a)]('page-indicator'),_0x2c911a=document['getElementById'](_0x197cee(0x4f8)),_0x1f72a8=document[_0x197cee(0x53a)](_0x197cee(0x6f0));_0x59d4d7['textContent']=_0x563805[_0x197cee(0x667)];if(_0x563805[_0x197cee(0xc62)][_0x197cee(0x29d)]===0x0)_0x9dda7c['innerHTML']='<p>点击“导入”按钮，<br>从本地.txt文件或网络URL加载书籍内容。</p>',_0x563805[_0x197cee(0x13dd)]=0x0,_0x563805[_0x197cee(0xc4e)]=0x0;else{const _0x58ba46=_0x563805['currentPage']*_0x563805['linesPerPage'],_0xaa6b37=_0x58ba46+_0x563805[_0x197cee(0x9f8)];_0x9dda7c[_0x197cee(0x34a)]=_0x563805['contentLines'][_0x197cee(0x1340)](_0x58ba46,_0xaa6b37)[_0x197cee(0x2c8)]('\x0a');}_0x392c93['textContent']=_0x563805[_0x197cee(0xc4e)]+0x1+_0x197cee(0x60c)+_0x563805[_0x197cee(0x13dd)],_0x2c911a[_0x197cee(0xb77)]=_0x563805['currentPage']===0x0,_0x1f72a8[_0x197cee(0xb77)]=_0x563805[_0x197cee(0xc4e)]>=_0x563805[_0x197cee(0x13dd)]-0x1;}function _0x2941cf(){const _0x43682a=_0x13d875,_0x2ca463=_0x4e8694[_0x53d851[_0x43682a(0x13be)]];_0x2ca463&&_0x2ca463[_0x43682a(0xc4e)]<_0x2ca463[_0x43682a(0x13dd)]-0x1&&(_0x2ca463[_0x43682a(0xc4e)]++,_0x375173(_0x53d851[_0x43682a(0x13be)]),document[_0x43682a(0x53a)](_0x43682a(0x892))[_0x43682a(0xf68)]=0x0,_0x393c85(_0x2ca463['activeBookId'],_0x2ca463[_0x43682a(0xc4e)]));}async function _0x772f7e(){const _0x39917b=_0x13d875,_0x82f058=_0x4e8694[_0x53d851[_0x39917b(0x13be)]];_0x82f058&&_0x82f058[_0x39917b(0xc4e)]>0x0&&(_0x82f058[_0x39917b(0xc4e)]--,_0x375173(_0x53d851['activeChatId']),document[_0x39917b(0x53a)](_0x39917b(0x892))['scrollTop']=0x0,await _0x393c85(_0x82f058[_0x39917b(0x24d)],_0x82f058[_0x39917b(0xc4e)]),await notifyAiOfPageTurn(_0x53d851[_0x39917b(0x13be)],_0x82f058));}function _0x48fe13(){const _0x5aa3bb=_0x13d875;document[_0x5aa3bb(0x53a)](_0x5aa3bb(0x21f))[_0x5aa3bb(0xb2b)]();}async function _0x4ad338(_0x3f00c5){const _0x22b6b3=_0x13d875,_0x54825a=new Uint8Array(_0x3f00c5);if(_0x54825a[_0x22b6b3(0x29d)]>=0x3&&_0x54825a[0x0]===0xef&&_0x54825a[0x1]===0xbb&&_0x54825a[0x2]===0xbf)return console[_0x22b6b3(0x1081)]('检测到\x20UTF-8\x20BOM，使用\x20UTF-8\x20解码。'),new TextDecoder(_0x22b6b3(0xbe9))[_0x22b6b3(0x2bc)](_0x54825a);if(_0x54825a[_0x22b6b3(0x29d)]>=0x2&&_0x54825a[0x0]===0xff&&_0x54825a[0x1]===0xfe)return console[_0x22b6b3(0x1081)](_0x22b6b3(0x1226)),new TextDecoder(_0x22b6b3(0xa99))['decode'](_0x54825a);if(_0x54825a[_0x22b6b3(0x29d)]>=0x2&&_0x54825a[0x0]===0xfe&&_0x54825a[0x1]===0xff)return console[_0x22b6b3(0x1081)]('检测到\x20UTF-16\x20BE\x20BOM，使用\x20UTF-16\x20BE\x20解码。'),new TextDecoder('utf-16be')['decode'](_0x54825a);try{console['log'](_0x22b6b3(0x137d));const _0x5b7c7e=new TextDecoder(_0x22b6b3(0xbe9),{'fatal':!![]})[_0x22b6b3(0x2bc)](_0x54825a);return console['log'](_0x22b6b3(0x1f3)),_0x5b7c7e;}catch(_0x3123fa){console[_0x22b6b3(0x1081)](_0x22b6b3(0xb60));try{const _0x9de262=new TextDecoder(_0x22b6b3(0x557))['decode'](_0x54825a);return console['log'](_0x22b6b3(0x371)),_0x9de262;}catch(_0x51848e){console['error'](_0x22b6b3(0x94a),_0x51848e);throw new Error(_0x22b6b3(0x9bc));}}}async function _0x5f52c7(_0x5c5eec){const _0x4bbeee=_0x13d875,_0x4a449f=_0x5c5eec['target'][_0x4bbeee(0x1413)][0x0];if(!_0x4a449f)return;try{const _0x707340=await _0x4a449f[_0x4bbeee(0x55a)](),_0x416c2b=await _0x4ad338(_0x707340),_0x52a8c2=_0x4a449f[_0x4bbeee(0x234)][_0x4bbeee(0x795)](/\.txt$/i,''),_0x1bab4f=await _0xa62efb[_0x4bbeee(0x59f)][_0x4bbeee(0xe13)]({'title':_0x52a8c2,'content':_0x416c2b,'lastOpened':Date[_0x4bbeee(0x9c1)]()});await _0x121413(_0x1bab4f),document['getElementById'](_0x4bbeee(0x913))[_0x4bbeee(0x1276)]['contains'](_0x4bbeee(0xaef))&&_0x2a996e();}catch(_0x580c2d){console['error'](_0x4bbeee(0xd69),_0x580c2d),await _0x184397(_0x4bbeee(0x3a1),_0x580c2d['message']);}finally{_0x5c5eec[_0x4bbeee(0x9c2)][_0x4bbeee(0x11a2)]=null;}}async function _0x357dd3(){const _0x24eeaa=_0x13d875,_0x2e86e0=_0x53d851[_0x24eeaa(0x13be)];if(!_0x2e86e0)return;const _0x4f3086=_0x4e8694[_0x2e86e0];if(!_0x4f3086||_0x4f3086[_0x24eeaa(0x13dd)]<=0x1)return;const _0x35aef4=await _0x4f6537(_0x24eeaa(0x6bb),_0x24eeaa(0xb58)+_0x4f3086[_0x24eeaa(0x13dd)]+')',_0x4f3086[_0x24eeaa(0xc4e)]+0x1);if(_0x35aef4===null)return;const _0x37894c=parseInt(_0x35aef4);if(isNaN(_0x37894c)||_0x37894c<0x1||_0x37894c>_0x4f3086[_0x24eeaa(0x13dd)]){alert(_0x24eeaa(0xac9));return;}_0x4f3086['currentPage']=_0x37894c-0x1,_0x375173(_0x2e86e0),_0x393c85(_0x4f3086['activeBookId'],_0x4f3086[_0x24eeaa(0xc4e)]);}async function _0x393c85(_0x1433ff,_0x41de1d){const _0x4353df=_0x13d875;if(!_0x1433ff)return;try{await _0xa62efb[_0x4353df(0x59f)][_0x4353df(0xc03)](_0x1433ff,{'currentPage':_0x41de1d});}catch(_0x703c9b){console['error'](_0x4353df(0xa03)+_0x1433ff+_0x4353df(0xfee),_0x703c9b);}}async function _0x2941cf(){const _0x456033=_0x13d875,_0x5d2dc8=_0x4e8694[_0x53d851[_0x456033(0x13be)]];_0x5d2dc8&&_0x5d2dc8[_0x456033(0xc4e)]<_0x5d2dc8['totalPages']-0x1&&(_0x5d2dc8[_0x456033(0xc4e)]++,_0x375173(_0x53d851[_0x456033(0x13be)]),document['getElementById'](_0x456033(0x892))[_0x456033(0xf68)]=0x0,await _0x393c85(_0x5d2dc8[_0x456033(0x24d)],_0x5d2dc8['currentPage']),await notifyAiOfPageTurn(_0x53d851['activeChatId'],_0x5d2dc8));}function _0x339cb9(_0x59b347,_0x3fd907){const _0x45f5b8=_0x13d875,_0x1ebf9e=_0x53d851[_0x45f5b8(0x13be)];if(!_0x1ebf9e)return;const _0x2f5d96=_0x4e8694[_0x1ebf9e];_0x2f5d96[_0x45f5b8(0x667)]=_0x59b347[_0x45f5b8(0x795)](/\.txt$/i,''),_0x2f5d96[_0x45f5b8(0xc62)]=_0x3fd907[_0x45f5b8(0x13e8)](/\r\n?|\n/)[_0x45f5b8(0xcb4)](_0x14171a=>_0x14171a[_0x45f5b8(0x795)](/ +/g,'\x20')),_0x2f5d96[_0x45f5b8(0x13dd)]=Math[_0x45f5b8(0x856)](_0x2f5d96[_0x45f5b8(0xc62)]['length']/_0x2f5d96[_0x45f5b8(0x9f8)]),_0x2f5d96['currentPage']=0x0,_0x375173(_0x1ebf9e);}async function _0x3f860f(){const _0x3e4072=_0x13d875;document[_0x3e4072(0x53a)]('reading-library-search-input')['value']='',await _0x2a996e(),document[_0x3e4072(0x53a)](_0x3e4072(0x913))['classList']['add'](_0x3e4072(0xaef));}async function _0x2a996e(_0x23afd8=''){const _0x2939aa=_0x13d875,_0x63a993=document[_0x2939aa(0x53a)](_0x2939aa(0xf9c));let _0x34199a=await _0xa62efb[_0x2939aa(0x59f)][_0x2939aa(0x1064)](_0x2939aa(0x858))[_0x2939aa(0x843)]()['toArray']();_0x63a993[_0x2939aa(0xaac)]='';_0x23afd8&&(_0x34199a=_0x34199a[_0x2939aa(0x2dd)](_0x16e4fa=>_0x16e4fa[_0x2939aa(0x667)][_0x2939aa(0x12b5)]()['includes'](_0x23afd8[_0x2939aa(0x12b5)]())));if(_0x34199a[_0x2939aa(0x29d)]===0x0){const _0x4060d4=_0x23afd8?'找不到匹配的书籍':_0x2939aa(0x705);_0x63a993[_0x2939aa(0xaac)]=_0x2939aa(0xa66)+_0x4060d4+_0x2939aa(0x12e2);return;}_0x34199a[_0x2939aa(0xeaf)](_0x1f90ed=>{const _0x2d58d6=_0x2939aa,_0x448616=document[_0x2d58d6(0xd67)](_0x2d58d6(0x1425));_0x448616['className']=_0x2d58d6(0xebc),_0x448616[_0x2d58d6(0xaac)]=_0x2d58d6(0xced)+_0x1f90ed['id']+'\x22>'+_0x1f90ed[_0x2d58d6(0x667)]+_0x2d58d6(0xb46)+_0x1f90ed['id']+_0x2d58d6(0xb43),_0x63a993[_0x2d58d6(0x133d)](_0x448616);});}async function _0x121413(_0x208fdc){const _0x40d9cd=_0x13d875,_0x20820f=_0x53d851[_0x40d9cd(0x13be)];if(!_0x20820f)return;const _0x3695f6=await _0xa62efb['readingLibrary']['get'](_0x208fdc);if(!_0x3695f6){alert(_0x40d9cd(0xe82));return;}await _0xa62efb[_0x40d9cd(0x59f)][_0x40d9cd(0xc03)](_0x208fdc,{'lastOpened':Date[_0x40d9cd(0x9c1)]()});const _0x398ece=_0x4e8694[_0x20820f];_0x398ece[_0x40d9cd(0x24d)]=_0x208fdc,_0x398ece[_0x40d9cd(0x667)]=_0x3695f6['title'],_0x398ece[_0x40d9cd(0xc62)]=_0x3695f6[_0x40d9cd(0x73e)]['split'](/\r\n?|\n/)['map'](_0x30e3ad=>_0x30e3ad['replace'](/ +/g,'\x20')),_0x398ece['totalPages']=Math[_0x40d9cd(0x856)](_0x398ece[_0x40d9cd(0xc62)][_0x40d9cd(0x29d)]/_0x398ece[_0x40d9cd(0x9f8)]),_0x398ece[_0x40d9cd(0xc4e)]=_0x3695f6[_0x40d9cd(0xc4e)]||0x0,_0x375173(_0x20820f),document[_0x40d9cd(0x53a)](_0x40d9cd(0x892))[_0x40d9cd(0xf68)]=0x0,document['getElementById'](_0x40d9cd(0x913))[_0x40d9cd(0x1276)][_0x40d9cd(0x2d4)]('visible');}async function _0x1ccd3a(_0x3e74ab){const _0x5284e8=_0x13d875,_0x517096=await _0xa62efb['readingLibrary'][_0x5284e8(0x883)](_0x3e74ab);if(!_0x517096)return;const _0x2e1fbc=await _0x355fc0('删除书籍',_0x5284e8(0xafb)+_0x517096['title']+_0x5284e8(0x1452),{'confirmButtonClass':_0x5284e8(0x264)});_0x2e1fbc&&(await _0xa62efb['readingLibrary']['delete'](_0x3e74ab),await _0x2a996e());}function _0x339cb9(_0x4137df,_0x29539a){const _0x5e19c6=_0x13d875,_0x106708=_0x53d851[_0x5e19c6(0x13be)];if(!_0x106708)return;const _0x27296c=_0x4e8694[_0x106708];_0x27296c['title']=_0x4137df[_0x5e19c6(0x795)](/\.txt$/i,''),_0x27296c[_0x5e19c6(0xc62)]=_0x29539a[_0x5e19c6(0x13e8)](/\r\n?|\n/),_0x27296c[_0x5e19c6(0x13dd)]=Math[_0x5e19c6(0x856)](_0x27296c['contentLines']['length']/_0x27296c[_0x5e19c6(0x9f8)]),_0x27296c[_0x5e19c6(0xc4e)]=0x0,_0x375173(_0x106708);}function _0x15ab6a(_0x3c93a5,_0x444c05){const _0x59206e=_0x13d875;let _0x50fed4=0x0,_0x508d10=0x0,_0x2fce6b=0x0,_0x39e31f=0x0,_0xadd296=![],_0x51ca38=![];const _0x4de365=document[_0x59206e(0x53a)](_0x59206e(0xf87)),_0x4179ca=_0x7259cc=>{const _0x470e15=_0x59206e;if(_0x3c93a5!==_0x444c05&&_0x7259cc[_0x470e15(0x9c2)][_0x470e15(0x106f)](_0x470e15(0x59e)))return;_0xadd296=!![],_0x51ca38=![];const _0x26101f=_0x7259cc[_0x470e15(0x919)]==='touchstart'?_0x7259cc[_0x470e15(0xd44)][0x0]:_0x7259cc;_0x2fce6b=_0x26101f[_0x470e15(0x1251)],_0x39e31f=_0x26101f['clientY'],_0x3c93a5[_0x470e15(0x1284)][_0x470e15(0x624)]=_0x3c93a5[_0x470e15(0x938)]+'px',_0x3c93a5['style'][_0x470e15(0xcd7)]=_0x3c93a5[_0x470e15(0x803)]+'px',_0x3c93a5[_0x470e15(0x1284)][_0x470e15(0xd91)]='',document[_0x470e15(0x1086)](_0x470e15(0xacd),_0x3e19ee),document['addEventListener'](_0x470e15(0xef3),_0xa2954c),document[_0x470e15(0x1086)](_0x470e15(0xab6),_0x3e19ee),document[_0x470e15(0x1086)](_0x470e15(0xd22),_0xa2954c,{'passive':![]});},_0xa2954c=_0x5adf20=>{const _0xbb8f0=_0x59206e;if(!_0xadd296)return;const _0x596357=_0x5adf20[_0xbb8f0(0x919)]===_0xbb8f0(0xd22)?_0x5adf20[_0xbb8f0(0xd44)][0x0]:_0x5adf20,_0x459335=_0x596357[_0xbb8f0(0x1251)]-_0x2fce6b,_0x50fe1b=_0x596357[_0xbb8f0(0xe71)]-_0x39e31f;!_0x51ca38&&(Math[_0xbb8f0(0xc05)](_0x459335)>0x5||Math[_0xbb8f0(0xc05)](_0x50fe1b)>0x5)&&(_0x51ca38=!![]);_0x51ca38&&_0x5adf20[_0xbb8f0(0xfac)]&&_0x5adf20[_0xbb8f0(0x1013)]();_0x50fed4=_0x2fce6b-_0x596357['clientX'],_0x508d10=_0x39e31f-_0x596357[_0xbb8f0(0xe71)],_0x2fce6b=_0x596357[_0xbb8f0(0x1251)],_0x39e31f=_0x596357['clientY'];let _0x592af2=_0x3c93a5[_0xbb8f0(0x938)]-_0x508d10,_0x47eca6=_0x3c93a5['offsetLeft']-_0x50fed4;const _0x46ba7f=_0x4de365['clientHeight']-_0x3c93a5['offsetHeight']-0xa,_0x2f01d6=_0x4de365[_0xbb8f0(0x703)]-_0x3c93a5['offsetWidth']-0xa;_0x592af2=Math[_0xbb8f0(0x69b)](0xa,Math[_0xbb8f0(0x683)](_0x592af2,_0x46ba7f)),_0x47eca6=Math[_0xbb8f0(0x69b)](0xa,Math[_0xbb8f0(0x683)](_0x47eca6,_0x2f01d6)),_0x3c93a5[_0xbb8f0(0x1284)][_0xbb8f0(0x624)]=_0x592af2+'px',_0x3c93a5['style']['left']=_0x47eca6+'px';},_0x3e19ee=()=>{const _0x2044ac=_0x59206e;document[_0x2044ac(0x5ce)]('mouseup',_0x3e19ee),document['removeEventListener'](_0x2044ac(0xef3),_0xa2954c),document[_0x2044ac(0x5ce)](_0x2044ac(0xab6),_0x3e19ee),document[_0x2044ac(0x5ce)]('touchmove',_0xa2954c);if(!_0xadd296)return;_0xadd296=![],!_0x51ca38&&_0x3c93a5[_0x2044ac(0xb2b)]();};_0x444c05['addEventListener']('mousedown',_0x4179ca),_0x444c05[_0x59206e(0x1086)](_0x59206e(0x3bc),_0x4179ca,{'passive':![]});}function _0xc9dcef(){const _0x384868=_0x13d875,_0x10b6d0=_0x4e8694[_0x53d851[_0x384868(0x13be)]];if(!_0x10b6d0||!_0x10b6d0[_0x384868(0x975)])return;document[_0x384868(0x53a)](_0x384868(0x1e0))[_0x384868(0x1276)][_0x384868(0xe13)](_0x384868(0x63c)),document[_0x384868(0x53a)](_0x384868(0xc0c))['style']['display']=_0x384868(0x2f6),_0x10b6d0['isMinimized']=!![];}function _0xb9ad05(){const _0x2c347a=_0x13d875,_0x5d0205=_0x4e8694[_0x53d851['activeChatId']];if(!_0x5d0205||!_0x5d0205[_0x2c347a(0x975)])return;document['getElementById'](_0x2c347a(0xc0c))[_0x2c347a(0x1284)][_0x2c347a(0x11d9)]=_0x2c347a(0xbf2),document[_0x2c347a(0x53a)](_0x2c347a(0x1e0))[_0x2c347a(0x1276)][_0x2c347a(0x2d4)]('minimized'),_0x5d0205[_0x2c347a(0x25a)]=![];}function _0x1acba8(_0x18156d,_0x15e8d5){let _0x10345b;return function(..._0x2bc7aa){const _0xee6e27=_0x55b8,_0x42f01e=this;clearTimeout(_0x10345b),_0x10345b=setTimeout(()=>_0x18156d[_0xee6e27(0x4e7)](_0x42f01e,_0x2bc7aa),_0x15e8d5);};}function _0x187570(_0x47a080){const _0x2cfe89=_0x13d875,_0x4153da=_0x4e8694[_0x47a080];if(!_0x4153da||!_0x4153da['isActive'])return'';const _0x2b0982=_0x4153da[_0x2cfe89(0x667)]||_0x2cfe89(0x140b);let _0x8bb869='',_0x14a88e='';if(_0x4153da[_0x2cfe89(0x9d8)]&&_0x4153da['currentSnippet'][_0x2cfe89(0x13bc)]())_0x8bb869=_0x4153da[_0x2cfe89(0x9d8)],_0x14a88e='你正在阅读的段落';else{if(_0x4153da[_0x2cfe89(0xc62)][_0x2cfe89(0x29d)]>0x0){const _0x57f766=_0x4153da['currentPage']*_0x4153da['linesPerPage'],_0x5c4c66=_0x57f766+_0x4153da[_0x2cfe89(0x9f8)];_0x8bb869=_0x4153da[_0x2cfe89(0xc62)][_0x2cfe89(0x1340)](_0x57f766,_0x5c4c66)[_0x2cfe89(0x2c8)]('\x0a')[_0x2cfe89(0xad6)](0x0,0xc8),_0x14a88e=_0x2cfe89(0xa26);}else _0x8bb869='(无内容)',_0x14a88e='内容';}return _0x2cfe89(0xef8)+_0x2b0982+_0x2cfe89(0xec4)+_0x14a88e+_0x2cfe89(0xa2b)+_0x8bb869+_0x2cfe89(0x1245)+(_0x53d851[_0x2cfe89(0xaa3)][_0x47a080]?.[_0x2cfe89(0x543)]||_0x2cfe89(0x91c))+_0x2cfe89(0xfca);}function _0x14577e(){const _0x55847f=_0x13d875,_0x343f01=_0x53d851[_0x55847f(0x13be)];if(!_0x343f01||!_0x4e8694[_0x343f01])return;const _0x1c2aa8=_0x4e8694[_0x343f01],_0x397bac=document[_0x55847f(0x53a)]('reading-content'),_0x51a081=_0x397bac[_0x55847f(0xf68)],_0x5738f4=_0x397bac['clientHeight'],_0x5dd9e2=_0x51a081+_0x5738f4,_0x38bbd2=0xf*1.8,_0x517399=Math[_0x55847f(0x7d5)](_0x51a081/_0x38bbd2),_0x211daa=Math['ceil'](_0x5dd9e2/_0x38bbd2),_0x51c766=_0x1c2aa8[_0x55847f(0xc4e)]*_0x1c2aa8[_0x55847f(0x9f8)]+_0x517399,_0x1875c1=_0x1c2aa8[_0x55847f(0xc4e)]*_0x1c2aa8[_0x55847f(0x9f8)]+_0x211daa;if(_0x51c766<0x0||_0x51c766>=_0x1c2aa8[_0x55847f(0xc62)][_0x55847f(0x29d)])return;const _0x1779b9=_0x1c2aa8[_0x55847f(0xc62)]['slice'](Math[_0x55847f(0x69b)](0x0,_0x51c766),Math[_0x55847f(0x683)](_0x1c2aa8[_0x55847f(0xc62)]['length'],_0x1875c1))[_0x55847f(0x2c8)]('\x0a');_0x1c2aa8['currentSnippet']=_0x1779b9;}function _0x3c8ff9(){const _0x480ea6=_0x13d875,_0xce50ff=document[_0x480ea6(0x53a)](_0x480ea6(0xb98));if(_0xce50ff){const _0xa48e58=_0xce50ff['play']();_0xa48e58!==undefined&&_0xa48e58[_0x480ea6(0x299)](_0x3d614c=>{const _0x1ac784=_0x480ea6;console['log'](_0x1ac784(0xeef));})[_0x480ea6(0x9cb)](_0x2958e9=>{const _0x7f9a34=_0x480ea6;console[_0x7f9a34(0xad0)]('无法自动播放静音音频（这在iOS首次加载时是正常现象）:',_0x2958e9);});}}function _0x10331c(){const _0x5f0cde=_0x13d875,_0x3337ab=document['getElementById'](_0x5f0cde(0xb98));_0x3337ab&&!_0x3337ab['paused']&&(_0x3337ab[_0x5f0cde(0xd54)](),_0x3337ab[_0x5f0cde(0x13d0)]=0x0,console[_0x5f0cde(0x1081)](_0x5f0cde(0x34e)));}async function _0x36debc(_0x264fd2){const _0x5e1761=_0x13d875,_0x3d205b=decodeURIComponent(_0x264fd2[_0x5e1761(0x999)]['text']),_0x2bda30=_0x264fd2['dataset'][_0x5e1761(0x2be)],_0x2d2be5=_0x264fd2[_0x5e1761(0x139c)](_0x5e1761(0x7be)),_0x569f43=_0x264fd2[_0x5e1761(0x139c)](_0x5e1761(0x1078)),_0x4132b0=document[_0x5e1761(0x53a)]('tts-audio-player');if(!_0x4132b0[_0x5e1761(0x8c5)]&&_0x4132b0[_0x5e1761(0x999)][_0x5e1761(0x12c8)]===_0x3d205b&&_0x4132b0[_0x5e1761(0x999)][_0x5e1761(0x117c)]===_0x2bda30){_0x4132b0[_0x5e1761(0xd54)]();return;}_0x4132b0[_0x5e1761(0xd54)](),document['querySelectorAll'](_0x5e1761(0x7be))[_0x5e1761(0xeaf)](_0x73545b=>_0x73545b[_0x5e1761(0x34a)]='▶');const _0x6ed068=_0x5e1761(0x579)+_0x2bda30+'_'+_0x3d205b;let _0x4ca622=_0x53d851[_0x5e1761(0xc71)]['get'](_0x6ed068);if(_0x4ca622){console[_0x5e1761(0x1081)]('从缓存播放\x20TTS\x20音频...'),await _0x48587a(_0x4ca622[_0x5e1761(0xb36)],_0x4ca622[_0x5e1761(0x919)],_0x3d205b,_0x2bda30,_0x264fd2);return;}console[_0x5e1761(0x1081)](_0x5e1761(0x103a));if(_0x2d2be5)_0x2d2be5['style'][_0x5e1761(0x11d9)]='none';_0x569f43['style'][_0x5e1761(0x11d9)]=_0x5e1761(0x1ea);const {minimaxGroupId:_0x448485,minimaxApiKey:_0x131bb4}=_0x53d851['apiConfig'];if(!_0x448485||!_0x131bb4){await _0x184397('配置错误',_0x5e1761(0x96f)),_0x569f43['style'][_0x5e1761(0x11d9)]=_0x5e1761(0xbf2);if(_0x2d2be5)_0x2d2be5[_0x5e1761(0x1284)][_0x5e1761(0x11d9)]='flex';return;}try{const _0x439192=await fetch(_0x5e1761(0x68c)+_0x448485,{'method':'POST','headers':{'Authorization':'Bearer\x20'+_0x131bb4,'Content-Type':_0x5e1761(0x85b)},'body':JSON[_0x5e1761(0xe1e)]({'text':_0x3d205b,'voice_id':_0x2bda30,'model':_0x53d851[_0x5e1761(0x80d)][_0x5e1761(0x32e)]||'speech-01','speed':0x1,'vol':0x1,'pitch':0x0})});if(!_0x439192['ok']){let _0x47b560='API\x20返回错误:\x20'+_0x439192['status'];try{const _0x45f700=await _0x439192[_0x5e1761(0xdc2)]();_0x47b560=_0x45f700[_0x5e1761(0xe73)]?.['status_msg']||JSON['stringify'](_0x45f700);}catch(_0x212878){_0x47b560=await _0x439192[_0x5e1761(0x2e6)]();}throw new Error(_0x47b560);}const _0x4dfe96=await _0x439192['blob'](),_0x257c1e=URL[_0x5e1761(0xaa0)](_0x4dfe96);await _0x48587a(_0x257c1e,_0x4dfe96[_0x5e1761(0x919)],_0x3d205b,_0x2bda30,_0x264fd2);const _0xbd5cad=new FileReader();_0xbd5cad['onloadend']=function(){const _0x301801=_0x5e1761;_0x53d851[_0x301801(0xc71)][_0x301801(0xf2b)](_0x6ed068,{'url':_0xbd5cad[_0x301801(0xa2a)],'type':_0x4dfe96[_0x301801(0x919)]}),console['log'](_0x301801(0x291));},_0xbd5cad[_0x5e1761(0x13b6)](_0x4dfe96);}catch(_0x52b1a3){console[_0x5e1761(0x617)](_0x5e1761(0x498),_0x52b1a3),await _0x184397(_0x5e1761(0x1391),'错误:\x20'+_0x52b1a3[_0x5e1761(0x875)]);}finally{_0x569f43['style']['display']='none';if(_0x2d2be5)_0x2d2be5['style'][_0x5e1761(0x11d9)]=_0x5e1761(0x2f6);}}function _0x48587a(_0x3e1dba,_0x36d84e,_0x55ce10,_0x4a5ada,_0x542893){return new Promise((_0xdf3027,_0x9b275c)=>{const _0x53fb54=_0x55b8,_0x37a9d3=document[_0x53fb54(0x53a)](_0x53fb54(0xa71));_0x37a9d3[_0x53fb54(0x7ff)]=_0x3e1dba,_0x37a9d3[_0x53fb54(0x919)]=_0x36d84e,_0x37a9d3['dataset'][_0x53fb54(0x12c8)]=_0x55ce10,_0x37a9d3[_0x53fb54(0x999)][_0x53fb54(0x117c)]=_0x4a5ada;const _0x577bf5=_0x37a9d3[_0x53fb54(0x116c)]();_0x577bf5!==undefined&&_0x577bf5[_0x53fb54(0x299)](()=>{const _0x3002e5=_0x53fb54,_0xabaa1d=_0x542893[_0x3002e5(0x139c)](_0x3002e5(0x7be));if(_0xabaa1d)_0xabaa1d[_0x3002e5(0x34a)]='❚❚';_0xdf3027();})[_0x53fb54(0x9cb)](_0x30e5d5=>{const _0x1b24e9=_0x53fb54;console[_0x1b24e9(0x617)](_0x1b24e9(0x1052),_0x30e5d5),_0x9b275c(_0x30e5d5);}),_0x37a9d3[_0x53fb54(0xe4e)]=()=>{const _0x1bdabe=_0x53fb54,_0x40c262=_0x542893[_0x1bdabe(0x139c)]('.voice-play-btn');if(_0x40c262)_0x40c262[_0x1bdabe(0x34a)]='▶';},_0x37a9d3[_0x53fb54(0xe00)]=()=>{const _0x32b6b9=_0x53fb54,_0x34ba30=_0x542893[_0x32b6b9(0x139c)](_0x32b6b9(0x7be));if(_0x34ba30)_0x34ba30[_0x32b6b9(0x34a)]='▶';};});}function _0x180c8c(_0x28f0c1){const _0x59f010=_0x13d875,_0x1c2791=_0x28f0c1['closest']('.message-bubble');if(!_0x1c2791)return;const _0x36f390=_0x1c2791['querySelector']('.voice-transcript'),_0x310e88=decodeURIComponent(_0x28f0c1[_0x59f010(0x999)][_0x59f010(0x2e6)]);_0x36f390[_0x59f010(0x1284)]['display']===_0x59f010(0x1ea)?_0x36f390[_0x59f010(0x1284)][_0x59f010(0x11d9)]=_0x59f010(0xbf2):(_0x36f390['textContent']=_0x310e88,_0x36f390[_0x59f010(0x1284)]['display']=_0x59f010(0x1ea));}async function _0x2dab9a(){const _0x5a7337=_0x13d875;await _0x1d230b(),document[_0x5a7337(0x53a)](_0x5a7337(0x373))[_0x5a7337(0x1276)]['add'](_0x5a7337(0xaef));}async function _0x1d230b(){const _0x33d52f=_0x13d875,_0x5cba30=document[_0x33d52f(0x53a)](_0x33d52f(0xdb1)),_0xd3910e=await _0xa62efb['shoppingCategories']['toArray']();_0x5cba30[_0x33d52f(0xaac)]='';if(_0xd3910e[_0x33d52f(0x29d)]===0x0){_0x5cba30['innerHTML']=_0x33d52f(0xa16);return;}_0xd3910e[_0x33d52f(0xeaf)](_0x339c5f=>{const _0x4f78de=_0x33d52f,_0x168ed0=document[_0x4f78de(0xd67)](_0x4f78de(0x1425));_0x168ed0[_0x4f78de(0x6de)]=_0x4f78de(0xebc),_0x168ed0['innerHTML']=_0x4f78de(0x1312)+_0x339c5f[_0x4f78de(0x234)]+_0x4f78de(0x2d5)+_0x339c5f['id']+_0x4f78de(0x448),_0x5cba30[_0x4f78de(0x133d)](_0x168ed0);});}async function _0x237ea2(){const _0x502c85=_0x13d875,_0x2943a6=document[_0x502c85(0x53a)](_0x502c85(0xfe0)),_0x4a1493=_0x2943a6['value'][_0x502c85(0x13bc)]();if(!_0x4a1493)return alert(_0x502c85(0x1000));const _0xba1cc3=await _0xa62efb[_0x502c85(0x44b)][_0x502c85(0x57e)](_0x502c85(0x234))[_0x502c85(0x12f6)](_0x4a1493)[_0x502c85(0x7e6)]();if(_0xba1cc3)return alert('分类\x20\x22'+_0x4a1493+_0x502c85(0x2a7));await _0xa62efb['shoppingCategories'][_0x502c85(0xe13)]({'name':_0x4a1493}),_0x2943a6[_0x502c85(0x11a2)]='',await _0x1d230b();}async function _0x2e84dc(_0x4b43da){const _0x477175=_0x13d875,_0x1602b0=await _0x355fc0(_0x477175(0x69a),_0x477175(0xa07),{'confirmButtonClass':'btn-danger'});_0x1602b0&&(await _0xa62efb[_0x477175(0x44b)][_0x477175(0x121e)](_0x4b43da),await _0xa62efb[_0x477175(0x1257)][_0x477175(0x57e)]('categoryId')[_0x477175(0x12f6)](_0x4b43da)[_0x477175(0xcf0)]({'categoryId':null}),await _0x1d230b());}function _0x23b682(_0xddf7c={}){const _0x520be2=_0x13d875,_0x2ea9e0=document['getElementById'](_0x520be2(0x314)),_0x112f40=document[_0x520be2(0xd67)](_0x520be2(0x1425));return _0x112f40[_0x520be2(0x6de)]=_0x520be2(0x1368),_0x112f40[_0x520be2(0xaac)]=_0x520be2(0xd7e)+(_0xddf7c[_0x520be2(0x234)]||'')+_0x520be2(0xeb7)+(_0xddf7c[_0x520be2(0xbde)]||'')+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式图片\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22avatar-upload\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22variation-image-preview\x22\x20src=\x22'+(_0xddf7c[_0x520be2(0x97a)]||_0x520be2(0xb7e))+_0x520be2(0x86a),_0x112f40['querySelector'](_0x520be2(0x425))['addEventListener']('click',()=>_0x112f40[_0x520be2(0x2d4)]()),_0x112f40[_0x520be2(0x139c)](_0x520be2(0x1300))[_0x520be2(0x1086)]('click',()=>{const _0x400bee=_0x520be2;_0x112f40['querySelector'](_0x400bee(0x978))[_0x400bee(0xb2b)]();}),_0x112f40[_0x520be2(0x139c)](_0x520be2(0x978))[_0x520be2(0x1086)](_0x520be2(0x325),_0x12695a=>{const _0x430d99=_0x520be2,_0x50b82f=_0x12695a[_0x430d99(0x9c2)][_0x430d99(0x1413)][0x0];if(_0x50b82f){const _0x1e060f=new FileReader();_0x1e060f[_0x430d99(0x110f)]=_0x447241=>{const _0xdd941e=_0x430d99;_0x112f40[_0xdd941e(0x139c)]('.variation-image-preview')[_0xdd941e(0x7ff)]=_0x447241[_0xdd941e(0x9c2)]['result'];},_0x1e060f[_0x430d99(0x13b6)](_0x50b82f);}}),_0x2ea9e0[_0x520be2(0x133d)](_0x112f40),_0x112f40;}async function _0x579250(_0x1bd156){const _0x1619e5=_0x13d875,_0x411aec=await _0xa62efb['shoppingProducts'][_0x1619e5(0x883)](_0x1bd156);if(!_0x411aec||!_0x411aec[_0x1619e5(0xfdb)]||_0x411aec[_0x1619e5(0xfdb)]['length']===0x0)return;const _0x3b9f24=document[_0x1619e5(0x53a)](_0x1619e5(0x74b));document[_0x1619e5(0x53a)](_0x1619e5(0x13d8))[_0x1619e5(0x7ff)]=_0x411aec[_0x1619e5(0x97a)],document['getElementById']('variation-product-name')['textContent']=_0x411aec[_0x1619e5(0x234)];const _0x2763d3=document[_0x1619e5(0x53a)](_0x1619e5(0xff2));_0x2763d3[_0x1619e5(0xaac)]='',_0x411aec[_0x1619e5(0xfdb)][_0x1619e5(0xeaf)]((_0x491384,_0x4c48b9)=>{const _0xff41f3=_0x1619e5,_0xb578a9=document[_0xff41f3(0xd67)](_0xff41f3(0x1174));_0xb578a9[_0xff41f3(0x919)]=_0xff41f3(0x1421),_0xb578a9[_0xff41f3(0x234)]=_0xff41f3(0x10f1),_0xb578a9['id']=_0xff41f3(0x1381)+_0x1bd156+'-'+_0x4c48b9,_0xb578a9['value']=_0x4c48b9,_0xb578a9['style'][_0xff41f3(0x11d9)]=_0xff41f3(0xbf2);if(_0x4c48b9===0x0)_0xb578a9[_0xff41f3(0x1077)]=!![];const _0x27aae2=document[_0xff41f3(0xd67)](_0xff41f3(0xc81));_0x27aae2[_0xff41f3(0x25b)]=_0xff41f3(0x1381)+_0x1bd156+'-'+_0x4c48b9,_0x27aae2[_0xff41f3(0x34a)]=_0x491384[_0xff41f3(0x234)],_0x27aae2[_0xff41f3(0x1284)][_0xff41f3(0x94d)]=_0xff41f3(0x12c4),_0x2763d3[_0xff41f3(0x133d)](_0xb578a9),_0x2763d3[_0xff41f3(0x133d)](_0x27aae2);});const _0x31c44d=()=>{const _0x551649=_0x1619e5,_0x4d854c=_0x2763d3[_0x551649(0x139c)](_0x551649(0x611));_0x2763d3[_0x551649(0xc3d)]('label')[_0x551649(0xeaf)](_0x192459=>{const _0x281ad7=_0x551649;_0x192459['style'][_0x281ad7(0xac7)]=_0x281ad7(0x798),_0x192459[_0x281ad7(0x1284)][_0x281ad7(0xb27)]=_0x281ad7(0xd68),_0x192459[_0x281ad7(0x1284)][_0x281ad7(0x615)]=_0x281ad7(0x492);});if(_0x4d854c){const _0x54ed64=_0x2763d3['querySelector'](_0x551649(0xcf8)+_0x4d854c['id']+'\x22]');_0x54ed64['style'][_0x551649(0xac7)]=_0x551649(0x711),_0x54ed64[_0x551649(0x1284)][_0x551649(0xb27)]=_0x551649(0x711),_0x54ed64[_0x551649(0x1284)][_0x551649(0x615)]='#e7f3ff';const _0x20446e=_0x411aec['variations'][parseInt(_0x4d854c['value'])];document[_0x551649(0x53a)](_0x551649(0xf95))[_0x551649(0x34a)]='¥'+_0x20446e[_0x551649(0xbde)][_0x551649(0x39e)](0x2),_0x20446e[_0x551649(0x97a)]?document[_0x551649(0x53a)](_0x551649(0x13d8))['src']=_0x20446e['imageUrl']:document['getElementById'](_0x551649(0x13d8))[_0x551649(0x7ff)]=_0x411aec['imageUrl'];}};_0x2763d3[_0x1619e5(0x1086)](_0x1619e5(0x325),_0x31c44d),_0x31c44d(),document[_0x1619e5(0x53a)](_0x1619e5(0x708))[_0x1619e5(0x34a)]='1';const _0x12c958=document['getElementById'](_0x1619e5(0xb59)),_0x22b526=_0x12c958[_0x1619e5(0x75a)](!![]);_0x12c958['parentNode'][_0x1619e5(0xa1d)](_0x22b526,_0x12c958),_0x22b526[_0x1619e5(0x1086)](_0x1619e5(0xb2b),async()=>{const _0x1b58a8=_0x1619e5,_0x3e26f3=_0x2763d3[_0x1b58a8(0x139c)](_0x1b58a8(0x611)),_0x923656=parseInt(document[_0x1b58a8(0x53a)](_0x1b58a8(0x708))[_0x1b58a8(0x34a)]);if(_0x3e26f3){const _0x2bb42e=_0x411aec[_0x1b58a8(0xfdb)][parseInt(_0x3e26f3['value'])];await _0x151669(_0x1bd156,_0x923656,_0x2bb42e),_0x3b9f24['classList'][_0x1b58a8(0x2d4)]('visible'),await _0x184397('成功',_0x1b58a8(0xdf3));}}),_0x3b9f24[_0x1619e5(0x1276)][_0x1619e5(0xe13)]('visible');}function _0x306d57(){const _0x2a6f5b=_0x13d875,_0x4e3d14=document[_0x2a6f5b(0x53a)](_0x2a6f5b(0xe8f));document['getElementById'](_0x2a6f5b(0xd83))[_0x2a6f5b(0x11a2)]=_0x53d851[_0x2a6f5b(0x906)][_0x2a6f5b(0xf9e)]||0x3,document['getElementById']('shopping-product-count-input')['value']=_0x53d851['globalSettings']['shoppingProductCount']||0x8,_0x4e3d14['classList'][_0x2a6f5b(0xe13)]('visible');}async function _0x497221(){const _0x5e1231=_0x13d875,_0x3a537b=document[_0x5e1231(0x53a)](_0x5e1231(0xd83)),_0x115e09=document['getElementById'](_0x5e1231(0x963)),_0x114333=parseInt(_0x3a537b['value']),_0x28cbfd=parseInt(_0x115e09['value']);if(isNaN(_0x114333)||isNaN(_0x28cbfd)||_0x114333<0x1||_0x28cbfd<0x1){alert(_0x5e1231(0x70a));return;}_0x53d851[_0x5e1231(0x906)]['shoppingCategoryCount']=_0x114333,_0x53d851[_0x5e1231(0x906)]['shoppingProductCount']=_0x28cbfd,await _0xa62efb[_0x5e1231(0x906)][_0x5e1231(0x546)](_0x53d851['globalSettings']),document[_0x5e1231(0x53a)](_0x5e1231(0xe8f))['classList']['remove'](_0x5e1231(0xaef)),await _0x184397('保存成功',_0x5e1231(0x71a));}async function _0x3be2d3(){const _0x19f01d=_0x13d875;if(!_0x53d851['activeChatId']){await _0x184397(_0x19f01d(0xeac),_0x19f01d(0x62c));return;}const _0x1ee5f5=_0x53d851[_0x19f01d(0xaa3)][_0x53d851[_0x19f01d(0x13be)]],_0x3e2b4a=await _0x355fc0('为“'+_0x1ee5f5[_0x19f01d(0x234)]+_0x19f01d(0xbb7),_0x19f01d(0x691),{'confirmText':_0x19f01d(0xc65)});if(!_0x3e2b4a)return;await _0x184397(_0x19f01d(0x11d7),_0x19f01d(0xee9)+_0x1ee5f5[_0x19f01d(0x234)]+_0x19f01d(0x520));const _0x255d43=_0x53d851[_0x19f01d(0x80d)][_0x19f01d(0x11f4)]&&_0x53d851[_0x19f01d(0x80d)][_0x19f01d(0x8ec)]&&_0x53d851[_0x19f01d(0x80d)]['secondaryModel'],{proxyUrl:_0x3d0238,apiKey:_0x5a8d09,model:_0x200b2f}=_0x255d43?{'proxyUrl':_0x53d851[_0x19f01d(0x80d)][_0x19f01d(0x11f4)],'apiKey':_0x53d851[_0x19f01d(0x80d)][_0x19f01d(0x8ec)],'model':_0x53d851['apiConfig'][_0x19f01d(0x112b)]}:_0x53d851[_0x19f01d(0x80d)];if(!_0x3d0238||!_0x5a8d09||!_0x200b2f){await _0x184397(_0x19f01d(0x65f),_0x19f01d(0x12c3));return;}const _0xdd6f8c=_0x53d851[_0x19f01d(0x906)][_0x19f01d(0xf9e)]||0x3,_0x3284c6=_0x53d851[_0x19f01d(0x906)][_0x19f01d(0x11de)]||0x8,_0x31b250=await _0xa62efb[_0x19f01d(0x44b)]['toArray']();let _0x37bbac='';_0x31b250['length']>0x0&&(_0x37bbac=_0x19f01d(0x928)+_0x31b250[_0x19f01d(0xcb4)](_0x4a858b=>'\x22'+_0x4a858b['name']+'\x22')[_0x19f01d(0x2c8)](',\x20')+']\x0a');const _0x2f9706=_0x53d851[_0x19f01d(0xa74)]['nickname']||'我',_0x2c6797=_0x1ee5f5[_0x19f01d(0x1016)]&&_0x1ee5f5[_0x19f01d(0x1016)][_0x19f01d(0x29d)]>0x0?_0x1ee5f5['longTermMemory'][_0x19f01d(0xcb4)](_0x3b416b=>_0x19f01d(0xd87)+_0x272f9c(_0x3b416b['timestamp'])+')\x20'+_0x3b416b[_0x19f01d(0x73e)])[_0x19f01d(0x2c8)]('\x0a'):'无',_0x145347=_0x1ee5f5[_0x19f01d(0xe83)][_0x19f01d(0x1340)](-0xa)[_0x19f01d(0xcb4)](_0x2c48ef=>(_0x2c48ef[_0x19f01d(0xb4d)]==='user'?_0x2f9706:_0x1ee5f5[_0x19f01d(0x234)])+':\x20'+String(_0x2c48ef[_0x19f01d(0x73e)])[_0x19f01d(0xad6)](0x0,0x1e)+_0x19f01d(0x95d))[_0x19f01d(0x2c8)]('\x0a');let _0x50074d='';if(_0x1ee5f5['settings'][_0x19f01d(0x4ab)]&&_0x1ee5f5[_0x19f01d(0x81e)][_0x19f01d(0x4ab)][_0x19f01d(0x29d)]>0x0){const _0x4773d5=_0x1ee5f5[_0x19f01d(0x81e)]['linkedWorldBookIds'][_0x19f01d(0xcb4)](_0x36cb00=>{const _0x10e8f7=_0x19f01d,_0x398345=_0x53d851[_0x10e8f7(0x10f2)][_0x10e8f7(0x397)](_0x404bdf=>_0x404bdf['id']===_0x36cb00);if(!_0x398345||!Array[_0x10e8f7(0xb31)](_0x398345[_0x10e8f7(0x73e)]))return'';const _0x56076c=_0x398345[_0x10e8f7(0x73e)]['filter'](_0x16085d=>_0x16085d[_0x10e8f7(0xb3d)]!==![])[_0x10e8f7(0xcb4)](_0x34d79c=>'-\x20'+_0x34d79c[_0x10e8f7(0x73e)])['join']('\x0a');return _0x56076c?'\x0a##\x20来自《'+_0x398345[_0x10e8f7(0x234)]+_0x10e8f7(0xaf2)+_0x56076c:'';})['filter'](Boolean)[_0x19f01d(0x2c8)]('');_0x4773d5&&(_0x50074d=_0x19f01d(0x13bd)+_0x4773d5+'\x0a');}const _0x4a04f0='\x0a#\x20你的任务\x0a你是一个虚拟的、极具创造力的商品规划师。你的任务是为下面的角色“'+_0x1ee5f5['name']+_0x19f01d(0xaeb)+_0xdd6f8c+_0x19f01d(0x1258)+_0x3284c6+_0x19f01d(0x119a)+_0x1ee5f5[_0x19f01d(0x234)]+_0x19f01d(0x79e)+_0x1ee5f5['settings'][_0x19f01d(0x1216)]+'\x0a-\x20**长期记忆**:\x20'+_0x2c6797+_0x19f01d(0x5d9)+_0x50074d+'\x0a'+_0x37bbac+'\x0a-\x20**最近对话摘要**:\x0a'+_0x145347+_0x19f01d(0xbb6)+_0x1ee5f5[_0x19f01d(0x234)]+_0x19f01d(0x141f);try{const _0xcc7baa=[{'role':_0x19f01d(0x10ae),'content':_0x19f01d(0x13a0)}];let _0x249524=_0x3d0238[_0x19f01d(0x6e9)](_0x19f01d(0x1046)),_0xac4c80=_0x1697e7(_0x200b2f,_0x5a8d09,_0x4a04f0,_0xcc7baa);const _0x3f8d87=_0x249524?await fetch(_0xac4c80[_0x19f01d(0xb36)],_0xac4c80[_0x19f01d(0xd7c)]):await fetch(_0x3d0238+'/v1/chat/completions',{'method':_0x19f01d(0xa4e),'headers':{'Content-Type':'application/json','Authorization':_0x19f01d(0x841)+_0x5a8d09},'body':JSON['stringify']({'model':_0x200b2f,'messages':[{'role':'system','content':_0x4a04f0},..._0xcc7baa],'temperature':_0x53d851['globalSettings'][_0x19f01d(0xaf8)]||0.9})});if(!_0x3f8d87['ok'])throw new Error(_0x19f01d(0x352)+_0x3f8d87[_0x19f01d(0x5c1)]);const _0x4b0253=await _0x3f8d87[_0x19f01d(0xdc2)](),_0x60ac4c=getGeminiResponseText(_0x4b0253),_0x4a4eef=_0x60ac4c[_0x19f01d(0x1120)](/({[\s\S]*})/);if(!_0x4a4eef)throw new Error('AI返回的内容中未找到有效的JSON对象。');const _0x27386b=JSON[_0x19f01d(0x367)](_0x4a4eef[0x0]);if(!_0x27386b[_0x19f01d(0xbba)]||!Array[_0x19f01d(0xb31)](_0x27386b['categories']))throw new Error('AI返回的JSON格式不正确，缺少\x20\x27categories\x27\x20数组。');await _0xa62efb['transaction']('rw',_0xa62efb['shoppingProducts'],_0xa62efb[_0x19f01d(0x44b)],async()=>{const _0x28c6d2=_0x19f01d;for(const _0x4c0a42 of _0x27386b[_0x28c6d2(0xbba)]){let _0x52fa15;const _0x5c3338=await _0xa62efb['shoppingCategories']['where'](_0x28c6d2(0x234))[_0x28c6d2(0x5b1)](_0x4c0a42[_0x28c6d2(0x234)])['first']();_0x5c3338?_0x52fa15=_0x5c3338['id']:_0x52fa15=await _0xa62efb['shoppingCategories']['add']({'name':_0x4c0a42[_0x28c6d2(0x234)]});const _0x34529d=_0x4c0a42[_0x28c6d2(0xf94)]['map'](_0x37d281=>{const _0x4201af=_0x28c6d2;return{'name':_0x37d281[_0x4201af(0x234)],'price':_0x37d281['price']||0x0,'description':_0x37d281[_0x4201af(0xa60)]||'','imageUrl':'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x37d281[_0x4201af(0xadb)]),'variations':(_0x37d281[_0x4201af(0xfdb)]||[])[_0x4201af(0xcb4)](_0x69b62c=>({..._0x69b62c,'imageUrl':'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x69b62c[_0x4201af(0xadb)])})),'categoryId':_0x52fa15};});_0x34529d[_0x28c6d2(0x29d)]>0x0&&await _0xa62efb['shoppingProducts'][_0x28c6d2(0x1386)](_0x34529d);}}),activeShoppingCategoryId='all',await _0x568252(),await _0x184397('生成成功！','为“'+_0x1ee5f5['name']+'”量身定制的商品已上架！');}catch(_0x1cc690){console[_0x19f01d(0x617)](_0x19f01d(0x53f),_0x1cc690),await _0x184397(_0x19f01d(0x3eb),'无法生成商品，请检查(主/副)API配置或稍后再试。\x0a错误:\x20'+_0x1cc690[_0x19f01d(0x875)]);}}async function _0x5970b0(_0x27aa77){const _0x54419e=_0x13d875,_0x1d936b=document[_0x54419e(0x53a)](_0x27aa77);if(!_0x1d936b)return;const _0xbb7498=await _0x34ea2c('更换图片',[{'text':_0x54419e(0x1352),'value':_0x54419e(0x3f3)},{'text':_0x54419e(0x476),'value':'url'}]);let _0x4863c7=null;if(_0xbb7498===_0x54419e(0x3f3))_0x4863c7=await _0x15351c();else _0xbb7498===_0x54419e(0xb36)&&(_0x4863c7=await _0x4f6537(_0x54419e(0x446),_0x54419e(0x10a5),_0x1d936b[_0x54419e(0x7ff)],_0x54419e(0xb36)));if(_0x4863c7&&_0x4863c7[_0x54419e(0x13bc)]()){const _0x2dddce=_0x4863c7[_0x54419e(0x13bc)]();_0x1d936b[_0x54419e(0x7ff)]=_0x2dddce,!_0x53d851[_0x54419e(0x906)][_0x54419e(0x585)]&&(_0x53d851[_0x54419e(0x906)][_0x54419e(0x585)]={}),_0x53d851[_0x54419e(0x906)][_0x54419e(0x585)][_0x27aa77]=_0x2dddce,await _0xa62efb['globalSettings'][_0x54419e(0x546)](_0x53d851[_0x54419e(0x906)]),await _0x184397('成功',_0x54419e(0x123b));}}window[_0x13d875(0xf10)]=_0x5970b0;async function _0xa6be9(){const _0x12a09f=_0x13d875;if(!window['streamSaver']){alert(_0x12a09f(0x296));return;}await _0x184397('正在准备...',_0x12a09f(0x2cc));const _0x466816=streamSaver[_0x12a09f(0x277)](_0x12a09f(0x6e8)+new Date()['toISOString']()[_0x12a09f(0x13e8)]('T')[0x0]+'.json'),_0x497ff8=_0x466816[_0x12a09f(0x895)](),_0x3a89e9=new TextEncoder();try{await _0x497ff8[_0x12a09f(0xb7d)](_0x3a89e9[_0x12a09f(0x6df)]('{\x0a\x22version\x22:\x203,\x0a\x22timestamp\x22:\x20'+Date['now']()+',\x0a\x22data\x22:\x20{\x0a'));const _0x2be8d3=await _0xa62efb['tables'][_0x12a09f(0xcb4)](_0x6c869a=>_0x6c869a[_0x12a09f(0x234)]);for(let _0x34170e=0x0;_0x34170e<_0x2be8d3[_0x12a09f(0x29d)];_0x34170e++){const _0x33271c=_0x2be8d3[_0x34170e],_0x460517=_0xa62efb[_0x12a09f(0xdec)](_0x33271c);await _0x497ff8[_0x12a09f(0xb7d)](_0x3a89e9[_0x12a09f(0x6df)]('\x22'+_0x33271c+'\x22:\x20[\x0a'));let _0x54f528=!![];await _0x460517[_0x12a09f(0x271)](_0x4efe7b=>{const _0x3cc4b6=_0x12a09f;!_0x54f528&&_0x497ff8[_0x3cc4b6(0xb7d)](_0x3a89e9[_0x3cc4b6(0x6df)](',\x0a')),_0x497ff8[_0x3cc4b6(0xb7d)](_0x3a89e9[_0x3cc4b6(0x6df)](JSON['stringify'](_0x4efe7b))),_0x54f528=![];}),await _0x497ff8[_0x12a09f(0xb7d)](_0x3a89e9[_0x12a09f(0x6df)]('\x0a]')),_0x34170e<_0x2be8d3['length']-0x1&&await _0x497ff8[_0x12a09f(0xb7d)](_0x3a89e9[_0x12a09f(0x6df)](',\x0a'));}await _0x497ff8[_0x12a09f(0xb7d)](_0x3a89e9['encode'](_0x12a09f(0x6ad)));}catch(_0x589afa){console[_0x12a09f(0x617)](_0x12a09f(0xba6),_0x589afa),await _0x184397('导出失败',_0x12a09f(0x1071)+_0x589afa[_0x12a09f(0x875)]);}finally{await _0x497ff8[_0x12a09f(0x32d)]();}}async function _0x1d1445(){const _0xb3d91d=_0x13d875;await _0x184397(_0xb3d91d(0x23a),_0xb3d91d(0x8a7));try{const _0x2be5fd={'version':0x3,'timestamp':Date[_0xb3d91d(0x9c1)](),'data':{}},_0x226b10=_0xa62efb[_0xb3d91d(0x760)][_0xb3d91d(0xcb4)](_0x3c14c7=>_0x3c14c7[_0xb3d91d(0x234)]);for(const _0x5d85ab of _0x226b10){const _0x23c9ec=await _0xa62efb[_0xb3d91d(0xdec)](_0x5d85ab)['toArray']();_0x2be5fd[_0xb3d91d(0xd7c)][_0x5d85ab]=_0x23c9ec,console[_0xb3d91d(0x1081)](_0xb3d91d(0xc9e)+_0x5d85ab+_0xb3d91d(0xb4e)+_0x23c9ec[_0xb3d91d(0x29d)]);}const _0x57ce9f=new Blob([JSON[_0xb3d91d(0xe1e)](_0x2be5fd,null,0x2)],{'type':_0xb3d91d(0x85b)}),_0x17e81b=URL[_0xb3d91d(0xaa0)](_0x57ce9f),_0x554884=document[_0xb3d91d(0xd67)]('a');_0x554884[_0xb3d91d(0xf0b)]=_0x17e81b,_0x554884['download']=_0xb3d91d(0x68d)+new Date()[_0xb3d91d(0x747)]()['split']('T')[0x0]+'.json',_0x554884['click'](),URL[_0xb3d91d(0x39b)](_0x17e81b),await _0x184397('导出成功',_0xb3d91d(0xd60));}catch(_0x52dbba){console[_0xb3d91d(0x617)](_0xb3d91d(0x10d0),_0x52dbba),await _0x184397('导出失败',_0xb3d91d(0x3b8)+_0x52dbba['message']);}}function _0x5983f0(){const _0x4f8869=_0x13d875,_0x488f9e=Object[_0x4f8869(0x244)](_0x53d851[_0x4f8869(0xaa3)])[_0x4f8869(0xae0)]((_0x4abb0d,_0x2ba6d2)=>{const _0x111122=_0x4f8869;if(_0x2ba6d2['id']===_0x53d851[_0x111122(0x13be)])return _0x4abb0d;return _0x4abb0d+(_0x2ba6d2[_0x111122(0x8ce)]||0x0);},0x0),_0x17ba1c=_0x13cfad||0x0,_0x8e3484=_0x488f9e+_0x17ba1c,_0x3929e2=document[_0x4f8869(0x53a)](_0x4f8869(0xe66));if(!_0x3929e2)return;let _0x26f482=_0x3929e2[_0x4f8869(0x139c)](_0x4f8869(0x9a7));!_0x26f482&&(_0x26f482=document[_0x4f8869(0xd67)](_0x4f8869(0x5a3)),_0x26f482['className']='unread-indicator',_0x3929e2[_0x4f8869(0x133d)](_0x26f482));let _0x2767b2=_0x3929e2[_0x4f8869(0x139c)](_0x4f8869(0xc9b));_0x2767b2&&_0x2767b2[_0x4f8869(0x2d4)](),_0x8e3484>0x0?(_0x26f482[_0x4f8869(0x34a)]=_0x8e3484>0x63?_0x4f8869(0x116b):_0x8e3484,_0x26f482[_0x4f8869(0x1284)][_0x4f8869(0x11d9)]='block',_0x26f482[_0x4f8869(0x1284)][_0x4f8869(0xf1d)]='20',_0x26f482[_0x4f8869(0x1284)][_0x4f8869(0xd91)]=_0x4f8869(0xc6b)):_0x26f482[_0x4f8869(0x1284)][_0x4f8869(0x11d9)]='none';}async function _0x1f60b4(_0x55bd4c){const _0x3f0b91=_0x13d875,_0x2657c9=_0x55bd4c===_0x3f0b91(0x414)?{'id':_0x3f0b91(0x414),'name':_0x3f0b91(0x113a)}:await _0xa62efb[_0x3f0b91(0xa9c)][_0x3f0b91(0x883)](_0x55bd4c);if(!_0x2657c9){console[_0x3f0b91(0x617)](_0x3f0b91(0xf18),_0x55bd4c);return;}const _0xcc7b57=document[_0x3f0b91(0x53a)](_0x3f0b91(0x6f3)),_0x20d407=document[_0x3f0b91(0x53a)]('sticker-binding-chat-list'),_0x1e9be1=_0xcc7b57[_0x3f0b91(0x139c)](_0x3f0b91(0x1282));_0x20d407[_0x3f0b91(0xaac)]='',_0x1e9be1[_0x3f0b91(0x34a)]=_0x3f0b91(0x396)+_0x2657c9['name']+_0x3f0b91(0xc7c);const _0x3db9b1=Object['values'](_0x53d851[_0x3f0b91(0xaa3)])[_0x3f0b91(0xdb0)]((_0x5dc69b,_0x32bdcd)=>_0x5dc69b[_0x3f0b91(0x234)][_0x3f0b91(0x81c)](_0x32bdcd[_0x3f0b91(0x234)],_0x3f0b91(0x42f)));_0x3db9b1['forEach'](_0x245dde=>{const _0x52360a=_0x3f0b91,_0x5d8183=Array[_0x52360a(0xb31)](_0x245dde[_0x52360a(0x81e)]?.[_0x52360a(0xdc1)])&&_0x245dde[_0x52360a(0x81e)]['stickerCategoryIds'][_0x52360a(0x6e9)](_0x55bd4c),_0x46b6c7=document[_0x52360a(0xd67)](_0x52360a(0x1425));_0x46b6c7[_0x52360a(0x6de)]='contact-picker-item',_0x46b6c7[_0x52360a(0xaac)]=_0x52360a(0x1051)+_0x245dde['id']+'\x22\x20'+(_0x5d8183?_0x52360a(0x1077):'')+_0x52360a(0x472)+(_0x245dde[_0x52360a(0x86e)]?_0x245dde[_0x52360a(0x81e)]['groupAvatar']:_0x245dde[_0x52360a(0x81e)][_0x52360a(0x9e3)]||_0x5d06c0)+_0x52360a(0x63a)+_0x245dde['name']+_0x52360a(0x1378),_0x20d407[_0x52360a(0x133d)](_0x46b6c7);}),document[_0x3f0b91(0x53a)](_0x3f0b91(0x214))['onclick']=()=>_0x4b34ad(_0x55bd4c),document[_0x3f0b91(0x53a)]('cancel-sticker-binding-btn')[_0x3f0b91(0x12f2)]=()=>_0xcc7b57[_0x3f0b91(0x1276)][_0x3f0b91(0x2d4)]('visible'),_0xcc7b57[_0x3f0b91(0x1276)][_0x3f0b91(0xe13)]('visible');}async function _0x4b34ad(_0x2c4f14){const _0xf90e30=_0x13d875,_0x49266a=new Set(Array['from'](document[_0xf90e30(0xc3d)](_0xf90e30(0x12f1)))['map'](_0x47f4d1=>_0x47f4d1['dataset'][_0xf90e30(0x1054)])),_0x435f33=[];for(const _0x2c50e2 in _0x53d851[_0xf90e30(0xaa3)]){const _0x50174e=_0x53d851['chats'][_0x2c50e2];!Array[_0xf90e30(0xb31)](_0x50174e[_0xf90e30(0x81e)]['stickerCategoryIds'])&&(_0x50174e[_0xf90e30(0x81e)]['stickerCategoryIds']=[]);const _0x3f6849=_0x50174e[_0xf90e30(0x81e)][_0xf90e30(0xdc1)][_0xf90e30(0x6e9)](_0x2c4f14),_0x36199e=_0x49266a[_0xf90e30(0x11af)](_0x2c50e2);if(_0x3f6849&&!_0x36199e)_0x50174e[_0xf90e30(0x81e)][_0xf90e30(0xdc1)]=_0x50174e[_0xf90e30(0x81e)]['stickerCategoryIds'][_0xf90e30(0x2dd)](_0x575a1e=>_0x575a1e!==_0x2c4f14),_0x435f33[_0xf90e30(0x7dd)](_0x50174e);else!_0x3f6849&&_0x36199e&&(_0x50174e[_0xf90e30(0x81e)][_0xf90e30(0xdc1)][_0xf90e30(0x7dd)](_0x2c4f14),_0x435f33[_0xf90e30(0x7dd)](_0x50174e));}_0x435f33[_0xf90e30(0x29d)]>0x0&&(await _0xa62efb['chats']['bulkPut'](_0x435f33),await _0x184397(_0xf90e30(0x6aa),'表情包分类绑定已更新！')),document[_0xf90e30(0x53a)](_0xf90e30(0x6f3))[_0xf90e30(0x1276)][_0xf90e30(0x2d4)](_0xf90e30(0xaef));}function _0x25c7bd(_0x1bb99c){const _0x2c05af=_0x13d875;if(!_0x1bb99c||!_0x1bb99c['settings'][_0x2c05af(0xdc1)]||_0x1bb99c[_0x2c05af(0x81e)][_0x2c05af(0xdc1)][_0x2c05af(0x29d)]===0x0)return'';const _0x5db672=_0x1bb99c[_0x2c05af(0x81e)][_0x2c05af(0xdc1)];let _0x176ef7=[];const _0x245025=new Set();_0x5db672[_0x2c05af(0xeaf)](_0x58b758=>{const _0x381c1b=_0x2c05af;let _0x447d03;_0x58b758===_0x381c1b(0x414)?_0x447d03=_0x53d851[_0x381c1b(0xf8f)]['filter'](_0x48d328=>!_0x48d328[_0x381c1b(0xbcd)]):_0x447d03=_0x53d851[_0x381c1b(0xf8f)][_0x381c1b(0x2dd)](_0x2710a4=>_0x2710a4[_0x381c1b(0xbcd)]===_0x58b758),_0x447d03[_0x381c1b(0xeaf)](_0x3b123d=>{const _0x6dc09f=_0x381c1b;!_0x245025[_0x6dc09f(0x11af)](_0x3b123d[_0x6dc09f(0x234)])&&(_0x176ef7['push'](_0x3b123d),_0x245025[_0x6dc09f(0xe13)](_0x3b123d[_0x6dc09f(0x234)]));});});if(_0x176ef7['length']===0x0)return'';const _0x353f27=_0x176ef7[_0x2c05af(0xcb4)](_0xdde119=>'-\x20'+_0xdde119[_0x2c05af(0x234)])['join']('\x0a');return _0x2c05af(0x37d)+_0x353f27+'\x0a';}function _0x194105(_0x37b6c2){const _0x4d968f=_0x13d875;if(!_0x37b6c2||!_0x37b6c2[_0x4d968f(0x86e)])return'';let _0x4562c3=_0x4d968f(0x2af),_0x2f3f3b=![];return _0x37b6c2[_0x4d968f(0x3de)][_0x4d968f(0xeaf)](_0x4ec22f=>{const _0x2a0772=_0x4d968f;if(_0x4ec22f['id']==='user')return;const _0x5ad2f5=_0x53d851[_0x2a0772(0xaa3)][_0x4ec22f['id']];if(_0x5ad2f5&&_0x5ad2f5['settings'][_0x2a0772(0xdc1)]&&_0x5ad2f5[_0x2a0772(0x81e)][_0x2a0772(0xdc1)][_0x2a0772(0x29d)]>0x0){const _0x1c313b=_0x5ad2f5[_0x2a0772(0x81e)]['stickerCategoryIds'];let _0x307c3f=[];const _0x176567=new Set();_0x1c313b[_0x2a0772(0xeaf)](_0x33ddd9=>{const _0x4d114c=_0x2a0772;let _0x198b8d;_0x33ddd9===_0x4d114c(0x414)?_0x198b8d=_0x53d851[_0x4d114c(0xf8f)][_0x4d114c(0x2dd)](_0x133074=>!_0x133074[_0x4d114c(0xbcd)]):_0x198b8d=_0x53d851[_0x4d114c(0xf8f)][_0x4d114c(0x2dd)](_0x2dce08=>_0x2dce08['categoryId']===_0x33ddd9),_0x198b8d[_0x4d114c(0xeaf)](_0x5397ce=>{const _0x34f996=_0x4d114c;!_0x176567[_0x34f996(0x11af)](_0x5397ce[_0x34f996(0x234)])&&(_0x307c3f[_0x34f996(0x7dd)](_0x5397ce),_0x176567[_0x34f996(0xe13)](_0x5397ce[_0x34f996(0x234)]));});}),_0x307c3f[_0x2a0772(0x29d)]>0x0&&(_0x2f3f3b=!![],_0x4562c3+=_0x2a0772(0x510)+_0x4ec22f[_0x2a0772(0x12bc)]+_0x2a0772(0xdb3)+_0x4ec22f[_0x2a0772(0x543)]+_0x2a0772(0xb6b),_0x4562c3+=_0x307c3f[_0x2a0772(0xcb4)](_0x337d95=>'-\x20'+_0x337d95[_0x2a0772(0x234)])[_0x2a0772(0x2c8)]('\x0a'));}}),_0x2f3f3b?_0x4562c3:'';}function _0x1f55c4(_0x324dee){const _0x16abee=_0x13d875;if(!_0x324dee)return 0x0;return Math[_0x16abee(0x856)](_0x324dee['length']/1.5);}async function _0x47761c(){const _0x1edf0c=_0x13d875;if(!_0x53d851['activeChatId'])return 0x0;const _0x18002f=_0x53d851[_0x1edf0c(0xaa3)][_0x53d851['activeChatId']];if(!_0x18002f)return 0x0;const _0x186518=parseInt(document[_0x1edf0c(0x53a)](_0x1edf0c(0x505))[_0x1edf0c(0x11a2)])||0xa,_0x4f1bf7=parseInt(document[_0x1edf0c(0x53a)](_0x1edf0c(0x9c3))[_0x1edf0c(0x11a2)])||0xa,_0x468baa=document[_0x1edf0c(0x53a)](_0x1edf0c(0xf85))[_0x1edf0c(0x1077)],_0x33576f=document['getElementById']('ai-persona')['value'],_0x471787=document[_0x1edf0c(0x53a)](_0x1edf0c(0x1264))[_0x1edf0c(0x11a2)];let _0x487476='';const _0x58fe42=Array[_0x1edf0c(0xd97)](document[_0x1edf0c(0xc3d)](_0x1edf0c(0xd3c)))[_0x1edf0c(0xcb4)](_0x2f391d=>_0x2f391d[_0x1edf0c(0x11a2)][_0x1edf0c(0x795)](_0x1edf0c(0x261),''));if(_0x58fe42[_0x1edf0c(0x29d)]>0x0){const _0x391657=_0x58fe42[_0x1edf0c(0xcb4)](_0xe13d43=>{const _0x181724=_0x1edf0c,_0x28cd55=_0x53d851[_0x181724(0x10f2)][_0x181724(0x397)](_0x500667=>_0x500667['id']===_0xe13d43);if(!_0x28cd55||!Array[_0x181724(0xb31)](_0x28cd55['content']))return'';return _0x28cd55[_0x181724(0x73e)][_0x181724(0x2dd)](_0x212ef5=>_0x212ef5[_0x181724(0xb3d)]!==![])[_0x181724(0xcb4)](_0x3a748e=>_0x3a748e[_0x181724(0x73e)])[_0x181724(0x2c8)]('\x0a');})['filter'](Boolean)['join']('\x0a');_0x487476+=_0x391657;}_0x18002f[_0x1edf0c(0x1016)]&&_0x18002f[_0x1edf0c(0x1016)][_0x1edf0c(0x29d)]>0x0&&(_0x487476+=_0x18002f['longTermMemory']['map'](_0x443181=>_0x443181['content'])['join']('\x0a'));const _0xf90648=document[_0x1edf0c(0x53a)](_0x1edf0c(0x6d6))['checked'];if(_0xf90648){const _0x363867=Array[_0x1edf0c(0xd97)](document['querySelectorAll'](_0x1edf0c(0x13d7)))[_0x1edf0c(0xcb4)](_0x49cd44=>_0x49cd44['value']);for(const _0xf31006 of _0x363867){const _0x5435c0=_0x53d851[_0x1edf0c(0xaa3)][_0xf31006];_0x5435c0&&_0x5435c0['history'][_0x1edf0c(0x29d)]>0x0&&(_0x487476+=_0x5435c0[_0x1edf0c(0xe83)][_0x1edf0c(0x1340)](-_0x4f1bf7)[_0x1edf0c(0xcb4)](_0x35b892=>String(_0x35b892[_0x1edf0c(0x73e)]))[_0x1edf0c(0x2c8)]('\x0a'));}}_0x18002f['isGroup']?_0x18002f[_0x1edf0c(0x3de)][_0x1edf0c(0xeaf)](_0x1cf9f7=>{const _0x1a0d55=_0x1edf0c;_0x487476+=_0x1cf9f7[_0x1a0d55(0x11fb)];}):_0x487476+=_0x33576f;_0x487476+=_0x471787,_0x487476+=_0x25c7bd(_0x18002f);_0x18002f[_0x1edf0c(0x86e)]&&(_0x487476+=_0x194105(_0x18002f));if(!_0x18002f[_0x1edf0c(0x86e)]&&_0x468baa){const _0x38cb8f=document[_0x1edf0c(0x53a)](_0x1edf0c(0x554))['value'];if(_0x38cb8f){const _0xf480fd=_0x53d851[_0x1edf0c(0x13b8)]['find'](_0x12b093=>_0x12b093['id']===_0x38cb8f);_0xf480fd&&(_0x487476+=_0xf480fd['content']['filter'](_0xbd4bf9=>_0xbd4bf9[_0x1edf0c(0xb3d)]!==![])[_0x1edf0c(0xcb4)](_0x5cfad7=>_0x5cfad7[_0x1edf0c(0x73e)])[_0x1edf0c(0x2c8)]('\x0a'));}}const _0x4af30e=_0x18002f['history'][_0x1edf0c(0x1340)](-_0x186518);return _0x487476+=_0x4af30e['map'](_0x48c5b1=>{const _0x186854=_0x1edf0c;if(typeof _0x48c5b1['content']===_0x186854(0xfc5))return _0x48c5b1[_0x186854(0x73e)];if(Array[_0x186854(0xb31)](_0x48c5b1['content']))return _0x48c5b1[_0x186854(0x73e)]['map'](_0x4a6aae=>_0x4a6aae['text'])[_0x186854(0x2c8)]('\x20');return'';})[_0x1edf0c(0x2c8)]('\x0a'),_0x1f55c4(_0x487476);}const _0x2214ad=_0x1acba8(async()=>{const _0x21bf17=_0x13d875,_0x334dca=document[_0x21bf17(0x53a)](_0x21bf17(0x79a));if(!_0x334dca)return;_0x334dca[_0x21bf17(0xaac)]=_0x21bf17(0x134b);try{const _0xd8c90e=await _0x47761c();_0x334dca[_0x21bf17(0xaac)]=_0x21bf17(0xdab)+_0xd8c90e+_0x21bf17(0x4a2);}catch(_0x4f977f){console[_0x21bf17(0x617)](_0x21bf17(0xfde),_0x4f977f),_0x334dca[_0x21bf17(0xaac)]=_0x21bf17(0x11ea);}},0x12c);async function _0x59abd1(){const _0x11344e=_0x13d875;async function _0x194495(_0x2d890c){const _0x51f199=_0x55b8;if(!_0x2d890c)return;try{const _0x5d96f4=await _0x2d890c[_0x51f199(0x2e6)](),_0x43240f=JSON[_0x51f199(0x367)](_0x5d96f4);if(_0x43240f[_0x51f199(0x919)]===_0x51f199(0x4b0))console['log'](_0x51f199(0xe37)),await _0x1e4f4d(_0x43240f);else{if(_0x43240f['entries']&&typeof _0x43240f[_0x51f199(0xfdc)]===_0x51f199(0xc74))console[_0x51f199(0x1081)](_0x51f199(0xbd6)),await _0x270604(_0x43240f,_0x2d890c['name']);else throw new Error(_0x51f199(0x99c));}}catch(_0x2e9243){console[_0x51f199(0x617)](_0x51f199(0x5c7),_0x2e9243),await _0x184397(_0x51f199(0x3a1),'文件解析或应用失败:\x20'+_0x2e9243[_0x51f199(0x875)]);}}async function _0x270604(_0x37bf3e,_0x37c084){const _0x3acc0e=_0x55b8,_0x2221c4=_0x37c084[_0x3acc0e(0x795)](/\.json$/i,''),_0x5896d0=await _0x4f6537(_0x3acc0e(0x2d7),_0x3acc0e(0x3f5),_0x2221c4);if(!_0x5896d0||!_0x5896d0[_0x3acc0e(0x13bc)]()){alert('导入已取消，因为未提供书名。');return;}const _0x25a608=Object['values'](_0x37bf3e[_0x3acc0e(0xfdc)])['map'](_0x50b8e0=>{const _0xd8953c=_0x3acc0e;return{'keys':_0x50b8e0['key']||[],'comment':_0x50b8e0['comment']||_0xd8953c(0x4a4),'content':_0x50b8e0[_0xd8953c(0x73e)]||'','enabled':!_0x50b8e0['disable']};})['filter'](_0x4f30d9=>_0x4f30d9[_0x3acc0e(0x73e)]);if(_0x25a608[_0x3acc0e(0x29d)]===0x0){alert(_0x3acc0e(0x1152));return;}const _0x4b32a0={'id':_0x3acc0e(0x45d)+Date[_0x3acc0e(0x9c1)](),'name':_0x5896d0[_0x3acc0e(0x13bc)](),'content':_0x25a608,'categoryId':null};await _0xa62efb['worldBooks'][_0x3acc0e(0xe13)](_0x4b32a0),_0x53d851['worldBooks'][_0x3acc0e(0x7dd)](_0x4b32a0),await _0x1f59bd(),await _0x184397(_0x3acc0e(0xd0a),_0x3acc0e(0x13e9)+_0x5896d0+'》。');}async function _0x116d48(){const _0x2659b9=_0x55b8;try{const _0x3ed6f8=await _0xa62efb['worldBooks'][_0x2659b9(0xa73)](),_0x84df01=await _0xa62efb[_0x2659b9(0xf5d)][_0x2659b9(0xa73)]();if(_0x3ed6f8[_0x2659b9(0x29d)]===0x0&&_0x84df01['length']===0x0){alert(_0x2659b9(0x79d));return;}const _0x7dd2bb={'type':_0x2659b9(0x4b0),'version':0x1,'timestamp':Date[_0x2659b9(0x9c1)](),'books':_0x3ed6f8,'categories':_0x84df01},_0x249884=new Blob([JSON[_0x2659b9(0xe1e)](_0x7dd2bb,null,0x2)],{'type':_0x2659b9(0x85b)}),_0x5d03ab=URL[_0x2659b9(0xaa0)](_0x249884),_0x214460=document[_0x2659b9(0xd67)]('a');_0x214460[_0x2659b9(0xf0b)]=_0x5d03ab,_0x214460[_0x2659b9(0x888)]=_0x2659b9(0x873)+new Date()['toISOString']()[_0x2659b9(0x13e8)]('T')[0x0]+'.json',_0x214460[_0x2659b9(0xb2b)](),URL['revokeObjectURL'](_0x5d03ab),await _0x184397(_0x2659b9(0x4e0),_0x2659b9(0x7f6));}catch(_0xf181ce){console[_0x2659b9(0x617)]('导出世界书时出错:',_0xf181ce),await _0x184397(_0x2659b9(0x484),'发生了一个错误:\x20'+_0xf181ce['message']);}}async function _0x1e4f4d(_0x1f77a5){const _0x5add2b=_0x55b8;try{if(_0x1f77a5['type']!==_0x5add2b(0x4b0)||!_0x1f77a5[_0x5add2b(0x673)])throw new Error(_0x5add2b(0x70e));const _0x4708f6=await _0x355fc0('导入世界书',_0x5add2b(0x5bd),{'confirmButtonClass':'btn-danger','confirmText':_0x5add2b(0xfe8)});if(!_0x4708f6)return;await _0xa62efb['transaction']('rw',_0xa62efb[_0x5add2b(0x10f2)],_0xa62efb[_0x5add2b(0xf5d)],async()=>{const _0x558753=_0x5add2b;await _0xa62efb[_0x558753(0x10f2)][_0x558753(0xfcf)](),await _0xa62efb['worldBookCategories'][_0x558753(0xfcf)](),Array['isArray'](_0x1f77a5[_0x558753(0x673)])&&await _0xa62efb[_0x558753(0x10f2)][_0x558753(0x2db)](_0x1f77a5[_0x558753(0x673)]),Array[_0x558753(0xb31)](_0x1f77a5['categories'])&&await _0xa62efb[_0x558753(0xf5d)][_0x558753(0x2db)](_0x1f77a5[_0x558753(0xbba)]);}),_0x53d851[_0x5add2b(0x10f2)]=await _0xa62efb[_0x5add2b(0x10f2)]['toArray'](),await _0x1f59bd(),await _0x184397(_0x5add2b(0x11c0),_0x5add2b(0x50a));}catch(_0x3bbab3){console[_0x5add2b(0x617)](_0x5add2b(0x5c7),_0x3bbab3),await _0x184397(_0x5add2b(0x3a1),_0x5add2b(0xa30)+_0x3bbab3[_0x5add2b(0x875)]);}}const _0x3785c3=localStorage[_0x11344e(0xa14)]('ephoneLastActiveTimestamp');if(_0x3785c3){const _0x305f4b=(Date['now']()-parseInt(_0x3785c3))/(0x3e8*0x3c);_0x305f4b>0x5&&_0x2f09a3(_0x305f4b);}_0x174bcd(),window['showScreen']=_0x541a81,window['openRenderingRulesScreen']=_0x4e194f,window['handleListenTogetherClick']=_0x38ee3d,window[_0x11344e(0x7b8)]=_0x2e9332,window[_0x11344e(0x5c9)]=_0x589f97,window[_0x11344e(0x12ea)]=_0x388ce3,window['openCharWallet']=_0x24c3f7,window['switchToCharHomeScreen']=_0x45e04d,window[_0x11344e(0x1170)]=_0x25fd0e;const _0x3c5f4c=document[_0x11344e(0xd67)](_0x11344e(0x1425));_0x3c5f4c['id']='sticker-action-bar',_0x3c5f4c[_0x11344e(0xaac)]='<button\x20id=\x22delete-selected-stickers-btn\x22>删除\x20(0)</button>',document[_0x11344e(0x53a)]('sticker-panel')[_0x11344e(0x133d)](_0x3c5f4c);const _0x15dc6f=document['createElement']('style');_0x15dc6f['id']='global-custom-style',document[_0x11344e(0x66b)][_0x11344e(0x133d)](_0x15dc6f),_0x2284f0['panelEl']=document[_0x11344e(0x53a)](_0x11344e(0x12ab)),_0x2284f0['gridEl']=document['getElementById'](_0x11344e(0x317));const _0x262a06=localStorage[_0x11344e(0xa14)](_0x11344e(0x1197))||_0x11344e(0x8ef);_0x3bde11(_0x262a06);const _0x35f033=document[_0x11344e(0xd67)]('style');_0x35f033['id']=_0x11344e(0x265),document[_0x11344e(0x66b)][_0x11344e(0x133d)](_0x35f033);const _0x359d8b=document[_0x11344e(0xd67)](_0x11344e(0x1284));_0x359d8b['id']=_0x11344e(0x12d0),document[_0x11344e(0x66b)]['appendChild'](_0x359d8b),_0x378258('',_0x11344e(0x356),_0x11344e(0x265)),_0x378258('','#settings-preview-area','preview-bubble-style'),window[_0x11344e(0xb4f)]=_0x4e194f,window[_0x11344e(0xfba)]=_0x541a81,window['renderChatListProxy']=_0x5001a4,window[_0x11344e(0xe0a)]=_0x17e058,window['renderWallpaperScreenProxy']=_0x24b0a8,window[_0x11344e(0x1308)]=_0x1f59bd,await _0x483882(),_0x39c21c(),await _0x14a77a(),_0x1c3306(_0x53d851['globalSettings'][_0x11344e(0x114d)]);const _0x3e031f=parseInt(localStorage[_0x11344e(0xa14)](_0x11344e(0x958)))||0x0;_0x5bac35(_0x3e031f);_0x53d851[_0x11344e(0x906)]&&_0x53d851['globalSettings']['fontUrl']&&_0x281d80(_0x53d851[_0x11344e(0x906)][_0x11344e(0x9a0)]);_0x344b05(),setInterval(_0x344b05,0x3e8*0x1e),_0x1ce9d9(),_0x26bf05(),_0x40e495(),_0x3ec9da(),document['getElementById'](_0x11344e(0x115e))[_0x11344e(0x1086)]('click',_0x410952=>{const _0xeb8d08=_0x11344e;_0x410952[_0xeb8d08(0x9c2)][_0xeb8d08(0x1276)][_0xeb8d08(0x6a3)]('rules-tab')&&_0x22b4ff(_0x410952[_0xeb8d08(0x9c2)][_0xeb8d08(0x999)][_0xeb8d08(0xbcd)]);}),document[_0x11344e(0x53a)]('add-new-rule-btn')['addEventListener'](_0x11344e(0xb2b),()=>_0x5bd706(null)),document[_0x11344e(0x53a)](_0x11344e(0xa3e))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x52a6ea=_0x11344e;document[_0x52a6ea(0x53a)]('rule-editor-modal')[_0x52a6ea(0x1276)][_0x52a6ea(0x2d4)](_0x52a6ea(0xaef));}),document[_0x11344e(0x53a)](_0x11344e(0x628))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x206abc),document[_0x11344e(0x53a)](_0x11344e(0x1301))['addEventListener'](_0x11344e(0xb2b),()=>{const _0x8b590b=_0x11344e;if(_0x53d851[_0x8b590b(0x13be)]&&!_0x53d851['chats'][_0x53d851[_0x8b590b(0x13be)]][_0x8b590b(0x86e)]){const _0x5196b1=_0x53d851[_0x8b590b(0xaa3)][_0x53d851[_0x8b590b(0x13be)]];_0x394622(_0x5196b1['id'],_0x5196b1[_0x8b590b(0x543)]);}});let _0x1dc39d=null;function _0x1188aa(_0x2bfa47){const _0x4081a9=_0x11344e;_0x1dc39d=_0x2bfa47;const _0x2599b9=_0x53d851[_0x4081a9(0xaa3)][_0x53d851[_0x4081a9(0x13be)]],_0x2d2e33=_0x2599b9[_0x4081a9(0x12db)]['find'](_0x12ae59=>_0x12ae59['id']===_0x2bfa47);if(!_0x2d2e33)return;const _0x13ec87=document[_0x4081a9(0x53a)](_0x4081a9(0x4b9));_0x13ec87[_0x4081a9(0x34a)]=_0x2d2e33[_0x4081a9(0x4d4)]?'取消置顶':_0x4081a9(0x48f),document[_0x4081a9(0x53a)](_0x4081a9(0xf33))[_0x4081a9(0x1276)][_0x4081a9(0xe13)]('visible');}async function _0x598d0b(){const _0x5449e1=_0x11344e;if(!_0x1dc39d)return;const _0x202898=_0x53d851[_0x5449e1(0xaa3)][_0x53d851[_0x5449e1(0x13be)]],_0x4a6a49=_0x202898[_0x5449e1(0x12db)][_0x5449e1(0x397)](_0x5eb1b1=>_0x5eb1b1['id']===_0x1dc39d);_0x4a6a49&&(_0x4a6a49[_0x5449e1(0x4d4)]=!_0x4a6a49[_0x5449e1(0x4d4)],await _0xa62efb[_0x5449e1(0xaa3)]['put'](_0x202898),_0x3a1384()),document[_0x5449e1(0x53a)](_0x5449e1(0xf33))[_0x5449e1(0x1276)][_0x5449e1(0x2d4)](_0x5449e1(0xaef));}async function _0x554056(){const _0x30d1a2=_0x11344e;if(!_0x1dc39d)return;const _0x439f83=await _0x355fc0(_0x30d1a2(0x69a),_0x30d1a2(0xf39),{'confirmButtonClass':_0x30d1a2(0x264)});if(_0x439f83){const _0x1e391a=_0x53d851[_0x30d1a2(0xaa3)][_0x53d851[_0x30d1a2(0x13be)]];_0x1e391a['announcements']=_0x1e391a[_0x30d1a2(0x12db)][_0x30d1a2(0x2dd)](_0x543b24=>_0x543b24['id']!==_0x1dc39d),await _0xa62efb[_0x30d1a2(0xaa3)][_0x30d1a2(0x546)](_0x1e391a),_0x3a1384();}document[_0x30d1a2(0x53a)]('announcement-actions-modal')[_0x30d1a2(0x1276)][_0x30d1a2(0x2d4)]('visible');}document[_0x11344e(0x53a)](_0x11344e(0xf74))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x2e6322),document[_0x11344e(0x53a)](_0x11344e(0xee4))[_0x11344e(0x1086)]('click',_0x4dc86a=>{const _0x1eacc2=_0x11344e;if(_0x4dc86a[_0x1eacc2(0x9c2)]===_0x5d53da)_0x2e6322();}),document[_0x11344e(0x53a)]('export-data-btn')['addEventListener'](_0x11344e(0xb2b),async()=>{const _0x4e3a13=_0x11344e,_0x45d019=await _0x34ea2c(_0x4e3a13(0x1045),[{'text':'智能导出\x20(推荐，速度快，内存占用小)','value':_0x4e3a13(0x1446)},{'text':_0x4e3a13(0x10ee),'value':_0x4e3a13(0xfa4)}]);if(_0x45d019===_0x4e3a13(0x1446))_0xa6be9();else _0x45d019===_0x4e3a13(0xfa4)&&_0x1d1445();}),document[_0x11344e(0x53a)](_0x11344e(0x9df))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0xc9c860),document['getElementById'](_0x11344e(0xf85))[_0x11344e(0x1086)](_0x11344e(0x325),_0x5b6b6d=>{const _0x236146=_0x11344e;document['getElementById']('offline-mode-options')['style']['display']=_0x5b6b6d[_0x236146(0x9c2)][_0x236146(0x1077)]?_0x236146(0x1ea):_0x236146(0xbf2);}),document[_0x11344e(0x53a)](_0x11344e(0x834))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>document[_0x11344e(0x53a)](_0x11344e(0x285))[_0x11344e(0xb2b)]()),document[_0x11344e(0x53a)](_0x11344e(0x206))[_0x11344e(0x1086)](_0x11344e(0x325),_0x59221d=>{const _0x52e879=_0x11344e;document[_0x52e879(0x53a)]('time-zone-group')[_0x52e879(0x1284)][_0x52e879(0x11d9)]=_0x59221d[_0x52e879(0x9c2)][_0x52e879(0x1077)]?'block':_0x52e879(0xbf2);}),document['getElementById'](_0x11344e(0x285))[_0x11344e(0x1086)]('change',_0x512988=>_0x3b72d9(_0x512988[_0x11344e(0x9c2)][_0x11344e(0x1413)][0x0])),document['getElementById'](_0x11344e(0x487))[_0x11344e(0x1086)](_0x11344e(0x325),_0x3a604e),document['getElementById'](_0x11344e(0xe66))[_0x11344e(0x1086)]('click',()=>{const _0x290cad=_0x11344e;_0x5dbfcd={},_0x378258('',_0x290cad(0x356),_0x290cad(0x265)),_0x378258('',_0x290cad(0x11db),_0x290cad(0x12d0)),_0x3c73fa(),_0x53d851[_0x290cad(0x13be)]=null,_0x541a81(_0x290cad(0xbca));}),document[_0x11344e(0x53a)]('add-chat-btn')[_0x11344e(0x1086)]('click',async()=>{const _0x55d024=_0x11344e,_0x1f1949=await _0x34ea2c(_0x55d024(0x5b9),[{'text':_0x55d024(0x9fb),'value':_0x55d024(0x55f)},{'text':_0x55d024(0x451),'value':'import_card'}]);if(_0x1f1949===_0x55d024(0x55f)){const _0x2cffa3=await _0x4f6537(_0x55d024(0x10ac),'请输入你想为Ta设置的【备注名】(例如:\x20哥哥)');if(!_0x2cffa3||!_0x2cffa3[_0x55d024(0x13bc)]())return;const _0x4cb6bc=await _0x4f6537(_0x55d024(0xe6d),_0x55d024(0x58e));if(!_0x4cb6bc||!_0x4cb6bc[_0x55d024(0x13bc)]())return;const _0x14cbc2=_0x55d024(0x8e2)+Date[_0x55d024(0x9c1)](),_0x4f1f50={'id':_0x14cbc2,'name':_0x2cffa3[_0x55d024(0x13bc)](),'originalName':_0x4cb6bc['trim'](),'isGroup':![],'isPinned':![],'unreadCount':0x0,'relationship':{'status':_0x55d024(0x10b1),'blockedTimestamp':null,'applicationReason':''},'status':{'text':'在线','lastUpdate':Date[_0x55d024(0x9c1)](),'isBusy':![]},'settings':{'aiPersona':_0x55d024(0x280),'myPersona':_0x55d024(0x11df),'myNickname':'我','maxMemory':0xa,'aiAvatar':_0x5d06c0,'myAvatar':_0x5d06c0,'background':'','theme':_0x55d024(0xce2),'fontSize':0xd,'customCss':'','linkedWorldBookIds':[],'aiAvatarLibrary':[],'myAvatarLibrary':[],'enableBackgroundActivity':!![],'actionCooldownMinutes':0xf,'enableTimePerception':!![],'isOfflineMode':![],'offlineMinLength':0x64,'offlineMaxLength':0x12c,'offlinePresetId':null,'timeZone':_0x55d024(0x7c3)},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[],'thoughtsHistory':[]};_0x53d851[_0x55d024(0xaa3)][_0x14cbc2]=_0x4f1f50,await _0xa62efb[_0x55d024(0xaa3)][_0x55d024(0x546)](_0x4f1f50),_0x5001a4();}else _0x1f1949==='import_card'&&document[_0x55d024(0x53a)](_0x55d024(0x487))[_0x55d024(0xb2b)]();}),document[_0x11344e(0x53a)]('add-group-chat-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x3b3d18),document['getElementById'](_0x11344e(0x12d8))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>document[_0x11344e(0x53a)](_0x11344e(0x6ff))[_0x11344e(0x1276)][_0x11344e(0x2d4)](_0x11344e(0xaef))),document[_0x11344e(0x53a)](_0x11344e(0x7ea))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x254ecc),document[_0x11344e(0x53a)](_0x11344e(0x139e))['addEventListener'](_0x11344e(0xb2b),_0x38ee3d),document[_0x11344e(0x53a)](_0x11344e(0x12fb))['addEventListener']('click',()=>_0x3b9a16(!![])),document[_0x11344e(0x53a)](_0x11344e(0x40e))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x49a196),document['getElementById'](_0x11344e(0x41a))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x190c27),document[_0x11344e(0x53a)]('music-next-btn')[_0x11344e(0x1086)]('click',_0x3bf151),document[_0x11344e(0x53a)](_0x11344e(0x11b0))['addEventListener']('click',_0x427712),document[_0x11344e(0x53a)]('music-mode-btn')['addEventListener']('click',_0x3bcc48),document[_0x11344e(0x53a)](_0x11344e(0x620))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x45caba=_0x11344e;_0x3c76c6(),document[_0x45caba(0x53a)]('music-playlist-panel')[_0x45caba(0x1276)][_0x45caba(0xe13)]('visible');}),document['getElementById'](_0x11344e(0x736))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>document['getElementById'](_0x11344e(0xc01))[_0x11344e(0x1276)]['remove'](_0x11344e(0xaef))),document[_0x11344e(0x53a)](_0x11344e(0x1356))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x954234),document[_0x11344e(0x53a)](_0x11344e(0x302))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>document[_0x11344e(0x53a)](_0x11344e(0x224))[_0x11344e(0xb2b)]()),document[_0x11344e(0x53a)](_0x11344e(0x224))[_0x11344e(0x1086)]('change',_0x4314b8),document[_0x11344e(0x53a)](_0x11344e(0xf90))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x129e4b=>{const _0x1369d6=_0x11344e,_0x654cc=_0x129e4b[_0x1369d6(0x9c2)],_0x57fe80=parseInt(_0x654cc[_0x1369d6(0x999)][_0x1369d6(0xd52)]);if(isNaN(_0x57fe80))return;if(_0x654cc['classList'][_0x1369d6(0x6a3)](_0x1369d6(0x724)))_0x39ba5a(_0x57fe80);else{if(_0x654cc['classList']['contains'](_0x1369d6(0x137f)))_0x517cd7(_0x57fe80);else{if(_0x654cc[_0x1369d6(0x1276)][_0x1369d6(0x6a3)](_0x1369d6(0x5a2)))_0x4cd737(_0x57fe80);else _0x654cc['classList']['contains'](_0x1369d6(0x320))&&_0x3180d7(_0x57fe80);}}}),_0x2a3e73[_0x11344e(0x1086)](_0x11344e(0x7b0),()=>{const _0x4f6532=_0x11344e;document[_0x4f6532(0x53a)](_0x4f6532(0x47f))['classList'][_0x4f6532(0x2d4)](_0x4f6532(0xd50)),_0x3bf151();});const _0x32a810=document[_0x11344e(0x53a)]('chat-input');document[_0x11344e(0x53a)](_0x11344e(0x8e4))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x3dfaa4=_0x11344e;_0x3c8ff9();const _0x3b97df=_0x32a810['value'][_0x3dfaa4(0x13bc)]();if(!_0x3b97df||!_0x53d851[_0x3dfaa4(0x13be)])return;const _0x943c84=_0x53d851['chats'][_0x53d851[_0x3dfaa4(0x13be)]],_0x1f6911={'role':_0x3dfaa4(0x10ae),'content':_0x3b97df,'timestamp':Date[_0x3dfaa4(0x9c1)]()};_0x25ec6e&&(_0x1f6911[_0x3dfaa4(0x6a2)]=_0x25ec6e),_0xa4d65(_0x1f6911,_0x943c84),((async()=>{const _0x58820b=_0x3dfaa4;_0x943c84[_0x58820b(0xe83)][_0x58820b(0x7dd)](_0x1f6911),await _0xa62efb[_0x58820b(0xaa3)][_0x58820b(0x546)](_0x943c84),_0x5001a4();})()),_0x32a810[_0x3dfaa4(0x11a2)]='',_0x32a810[_0x3dfaa4(0x1284)]['height']=_0x3dfaa4(0x1157),_0x32a810[_0x3dfaa4(0x78d)](),_0x33fd8c();}),document[_0x11344e(0x53a)](_0x11344e(0xf24))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x5403b5),_0x32a810[_0x11344e(0x1086)](_0x11344e(0x1026),_0x1cbe14=>{const _0x473ab2=_0x11344e;_0x1cbe14[_0x473ab2(0xf31)]===_0x473ab2(0xbfd)&&!_0x1cbe14['shiftKey']&&(_0x1cbe14[_0x473ab2(0x1013)](),document['getElementById'](_0x473ab2(0x8e4))['click']());}),document[_0x11344e(0x53a)](_0x11344e(0xc2f))[_0x11344e(0x1086)]('change',async _0x2dd75c=>{const _0x4a976a=_0x11344e,_0x45abf1=_0x2dd75c[_0x4a976a(0x9c2)]['files'][0x0];if(_0x45abf1){const _0x2aaf26=await new Promise((_0x3e5abd,_0x4e7f50)=>{const _0x4858ab=_0x4a976a,_0x4a7336=new FileReader();_0x4a7336[_0x4858ab(0x110f)]=()=>_0x3e5abd(_0x4a7336['result']),_0x4a7336[_0x4858ab(0xdcc)]=()=>_0x4e7f50(_0x4a7336[_0x4858ab(0x617)]),_0x4a7336['readAsDataURL'](_0x45abf1);});_0x497271=_0x2aaf26,_0x24b0a8();}}),document['getElementById'](_0x11344e(0x540))['addEventListener'](_0x11344e(0xb2b),async()=>{const _0xe145d1=_0x11344e;_0x497271&&(_0x53d851[_0xe145d1(0x906)][_0xe145d1(0x8ee)]=_0x497271),_0x53d851['globalSettings']['globalCss']=document[_0xe145d1(0x53a)](_0xe145d1(0x1387))[_0xe145d1(0x11a2)][_0xe145d1(0x13bc)](),_0x53d851[_0xe145d1(0x906)][_0xe145d1(0x1159)]=document['getElementById']('notification-sound-url-input')['value'][_0xe145d1(0x13bc)](),_0x53d851[_0xe145d1(0x906)][_0xe145d1(0xab5)]=document[_0xe145d1(0x53a)]('status-bar-toggle-switch')['checked'],await _0xa62efb[_0xe145d1(0x906)]['put'](_0x53d851[_0xe145d1(0x906)]),_0x1ce9d9(),_0x4b6d38(),_0x497271=null,_0x40e495(),_0x201b82(),_0x1c3306(_0x53d851['globalSettings'][_0xe145d1(0x114d)]),_0x39c21c(),alert(_0xe145d1(0x5f0)),_0x541a81(_0xe145d1(0x2ab));});const _0x32af6a=document[_0x11344e(0x53a)]('messages-view');_0x32af6a['addEventListener']('scroll',()=>{const {scrollTop:_0x202f04,scrollHeight:_0x21d110,clientHeight:_0x35449b}=_0x32af6a;_0x21d110-_0x202f04-_0x35449b<_0x35449b&&(!_0x4ec6e0&&_0x5778f5());}),document['getElementById'](_0x11344e(0x4cf))['addEventListener'](_0x11344e(0xb2b),async()=>{const _0x416488=_0x11344e;_0x53d851['apiConfig'][_0x416488(0x122e)]=document[_0x416488(0x53a)](_0x416488(0xa64))[_0x416488(0x11a2)][_0x416488(0x13bc)](),_0x53d851[_0x416488(0x80d)][_0x416488(0xe95)]=document[_0x416488(0x53a)](_0x416488(0x275))['value'][_0x416488(0x13bc)](),_0x53d851['apiConfig'][_0x416488(0xd6f)]=document[_0x416488(0x53a)](_0x416488(0xe85))['value'],_0x53d851[_0x416488(0x80d)][_0x416488(0x2b6)]=document[_0x416488(0x53a)]('minimax-group-id')[_0x416488(0x11a2)][_0x416488(0x13bc)](),_0x53d851[_0x416488(0x80d)][_0x416488(0x6ce)]=document[_0x416488(0x53a)](_0x416488(0x1097))[_0x416488(0x11a2)][_0x416488(0x13bc)](),_0x53d851[_0x416488(0x80d)][_0x416488(0x32e)]=document[_0x416488(0x53a)](_0x416488(0x716))[_0x416488(0x11a2)],_0x53d851[_0x416488(0x80d)][_0x416488(0x11f4)]=document[_0x416488(0x53a)](_0x416488(0xc7d))[_0x416488(0x11a2)][_0x416488(0x13bc)](),_0x53d851['apiConfig'][_0x416488(0x8ec)]=document[_0x416488(0x53a)]('secondary-api-key')[_0x416488(0x11a2)][_0x416488(0x13bc)](),_0x53d851[_0x416488(0x80d)][_0x416488(0x112b)]=document['getElementById'](_0x416488(0x1219))[_0x416488(0x11a2)],await _0xa62efb['apiConfig'][_0x416488(0x546)](_0x53d851[_0x416488(0x80d)]);const _0x429f85=document['getElementById'](_0x416488(0x20c)),_0xa02f8e=document[_0x416488(0x53a)]('background-interval-input'),_0x405bce=document[_0x416488(0x53a)](_0x416488(0x6a8));_0x53d851[_0x416488(0x906)][_0x416488(0x527)]=_0x429f85[_0x416488(0x1077)],_0x53d851[_0x416488(0x906)][_0x416488(0xf27)]=parseInt(_0xa02f8e[_0x416488(0x11a2)])||0x3c,_0x53d851['globalSettings'][_0x416488(0xbbe)]=parseFloat(_0x405bce[_0x416488(0x11a2)])||0x1,_0x53d851['globalSettings']['enableAiDrawing']=document['getElementById'](_0x416488(0x83a))[_0x416488(0x1077)],_0x53d851[_0x416488(0x906)][_0x416488(0xcfe)]=parseInt(document['getElementById'](_0x416488(0xe18))[_0x416488(0x11a2)])||0x32,_0x53d851[_0x416488(0x906)][_0x416488(0x8ea)]=parseInt(document[_0x416488(0x53a)]('chat-list-render-window-input')[_0x416488(0x11a2)])||0x1e,_0x53d851[_0x416488(0x906)][_0x416488(0xaf8)]=parseFloat(document['getElementById'](_0x416488(0x515))[_0x416488(0x11a2)]),await _0xa62efb[_0x416488(0x906)]['put'](_0x53d851[_0x416488(0x906)]),_0xb50323();_0x53d851[_0x416488(0x906)]['enableBackgroundActivity']?(_0x148146(),console[_0x416488(0x1081)](_0x416488(0xe17)+_0x53d851[_0x416488(0x906)][_0x416488(0xf27)]+'秒')):console[_0x416488(0x1081)](_0x416488(0x11ad));const _0x347d7b=document[_0x416488(0x53a)]('novelai-switch')[_0x416488(0x1077)],_0x3d2707=document[_0x416488(0x53a)]('novelai-model')[_0x416488(0x11a2)],_0x3e9f40=document[_0x416488(0x53a)](_0x416488(0x84e))[_0x416488(0x11a2)][_0x416488(0x13bc)]();localStorage[_0x416488(0xf64)](_0x416488(0xc18),_0x347d7b),localStorage[_0x416488(0xf64)](_0x416488(0x835),_0x3d2707),localStorage[_0x416488(0xf64)](_0x416488(0x84e),_0x3e9f40),alert('所有API与后台设置已保存!');});const _0x4f47a5=document[_0x11344e(0x53a)]('api-key');_0x4f47a5[_0x11344e(0x1086)](_0x11344e(0x78d),_0x21c89b=>{const _0x2274ac=_0x11344e;_0x21c89b[_0x2274ac(0x9c2)][_0x2274ac(0x8d3)]('type','text');}),_0x4f47a5[_0x11344e(0x1086)]('blur',_0x2836b2=>{const _0x80c042=_0x11344e;_0x2836b2[_0x80c042(0x9c2)][_0x80c042(0x8d3)](_0x80c042(0x919),'password');});async function _0x43ab82(_0x346647,_0x48f2ce,_0xca7ca2){const _0x85aa92=_0x11344e,_0x5e6b48=document[_0x85aa92(0x53a)](_0x346647)[_0x85aa92(0x11a2)][_0x85aa92(0x13bc)](),_0x2c3d3e=document[_0x85aa92(0x53a)](_0x48f2ce)['value'][_0x85aa92(0x13bc)]();if(!_0x5e6b48||!_0x2c3d3e)return alert(_0x85aa92(0x40a));try{let _0x287f11=_0x5e6b48===GEMINI_API_URL;const _0x57c5ca=await fetch(_0x287f11?GEMINI_API_URL+'?key='+getRandomValue(_0x2c3d3e):_0x5e6b48+_0x85aa92(0xc2e),_0x287f11?undefined:{'headers':{'Authorization':_0x85aa92(0x841)+_0x2c3d3e}});if(!_0x57c5ca['ok'])throw new Error(_0x85aa92(0xd12));const _0x258432=await _0x57c5ca[_0x85aa92(0xdc2)]();let _0x25400c=_0x287f11?_0x258432[_0x85aa92(0xb99)][_0x85aa92(0xcb4)](_0x282607=>({'id':_0x282607[_0x85aa92(0x234)][_0x85aa92(0x13e8)]('/')[0x1]||_0x282607[_0x85aa92(0x234)]})):_0x258432[_0x85aa92(0xd7c)];const _0x4a7cf1=document[_0x85aa92(0x53a)](_0xca7ca2);_0x4a7cf1['innerHTML']='';const _0x2849e2=_0xca7ca2===_0x85aa92(0xe85)?_0x53d851['apiConfig'][_0x85aa92(0xd6f)]:_0x53d851[_0x85aa92(0x80d)]['secondaryModel'];_0x25400c[_0x85aa92(0xeaf)](_0x1b892a=>{const _0x337440=_0x85aa92,_0x228fa5=document[_0x337440(0xd67)](_0x337440(0xa1e));_0x228fa5[_0x337440(0x11a2)]=_0x1b892a['id'],_0x228fa5[_0x337440(0x34a)]=_0x1b892a['id'];if(_0x1b892a['id']===_0x2849e2)_0x228fa5[_0x337440(0x1015)]=!![];_0x4a7cf1[_0x337440(0x133d)](_0x228fa5);}),alert(_0x85aa92(0x143d));}catch(_0x15f8ab){alert(_0x85aa92(0x8aa)+_0x15f8ab['message']);}}document[_0x11344e(0x53a)](_0x11344e(0xc3e))[_0x11344e(0x1086)]('click',()=>{const _0x146844=_0x11344e;_0x43ab82('proxy-url',_0x146844(0x275),_0x146844(0xe85));}),document[_0x11344e(0x53a)]('fetch-secondary-models-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x5b8e69=_0x11344e;_0x43ab82(_0x5b8e69(0xc7d),_0x5b8e69(0xd14),_0x5b8e69(0x1219));}),document['getElementById'](_0x11344e(0x9c6))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x5b2744=_0x11344e,_0x429f95=await _0x4f6537(_0x5b2744(0x7b9),_0x5b2744(0x13a3));if(_0x429f95&&_0x429f95[_0x5b2744(0x13bc)]()){const _0x38c3cc={'id':'wb_'+Date['now'](),'name':_0x429f95[_0x5b2744(0x13bc)](),'content':''};await _0xa62efb[_0x5b2744(0x10f2)][_0x5b2744(0xe13)](_0x38c3cc),_0x53d851['worldBooks']['push'](_0x38c3cc),_0x1f59bd(),_0x313d23(_0x38c3cc['id']);}}),document[_0x11344e(0x53a)](_0x11344e(0xb02))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x35ffcc=_0x11344e;if(!_0x1261d0)return;const _0x2fcd54=_0x53d851[_0x35ffcc(0x10f2)][_0x35ffcc(0x397)](_0x49107a=>_0x49107a['id']===_0x1261d0);if(!_0x2fcd54)return;const _0x5a0f4f=document[_0x35ffcc(0x53a)](_0x35ffcc(0x395))[_0x35ffcc(0x11a2)][_0x35ffcc(0x13bc)]();if(!_0x5a0f4f){alert(_0x35ffcc(0x1221));return;}_0x2fcd54[_0x35ffcc(0x234)]=_0x5a0f4f;const _0x1b8d00=document[_0x35ffcc(0x53a)](_0x35ffcc(0xe90))[_0x35ffcc(0x11a2)];_0x2fcd54[_0x35ffcc(0xbcd)]=_0x1b8d00?parseInt(_0x1b8d00):null;const _0x1b03ec=document[_0x35ffcc(0x53a)]('world-book-entries-container'),_0x46073c=_0x1b03ec[_0x35ffcc(0xc3d)](_0x35ffcc(0x124a)),_0x4540b7=[];_0x46073c['forEach'](_0x42fd2b=>{const _0x55fdf8=_0x35ffcc,_0x18d7cb=_0x42fd2b[_0x55fdf8(0x139c)](_0x55fdf8(0x6c8))[_0x55fdf8(0x11a2)][_0x55fdf8(0x13bc)](),_0x2c3e15=_0x42fd2b[_0x55fdf8(0x139c)](_0x55fdf8(0x5af))[_0x55fdf8(0x11a2)][_0x55fdf8(0x13bc)](),_0x2fe36f=_0x42fd2b['querySelector'](_0x55fdf8(0xe8a))[_0x55fdf8(0x1077)];_0x2c3e15&&_0x4540b7[_0x55fdf8(0x7dd)]({'comment':_0x42fd2b['querySelector'](_0x55fdf8(0x316))['value'][_0x55fdf8(0x13bc)](),'keys':_0x18d7cb?_0x18d7cb[_0x55fdf8(0x13e8)](',')[_0x55fdf8(0xcb4)](_0x10a171=>_0x10a171[_0x55fdf8(0x13bc)]())[_0x55fdf8(0x2dd)](_0x18c090=>_0x18c090):[],'content':_0x2c3e15,'enabled':_0x2fe36f});}),_0x2fcd54[_0x35ffcc(0x73e)]=_0x4540b7,await _0xa62efb[_0x35ffcc(0x10f2)][_0x35ffcc(0x546)](_0x2fcd54),document['getElementById']('world-book-editor-title')['textContent']=_0x5a0f4f,_0x1261d0=null,_0x541a81(_0x35ffcc(0x3fa)),await _0x1f59bd();}),document[_0x11344e(0x53a)](_0x11344e(0xa33))[_0x11344e(0x1086)]('click',async _0x17ab30=>{const _0x2c98a9=_0x11344e,_0x46158e=_0x17ab30[_0x2c98a9(0x9c2)][_0x2c98a9(0x106f)](_0x2c98a9(0xf21));if(_0x46158e){const _0x1a6f7c=_0x53d851[_0x2c98a9(0xaa3)][_0x53d851[_0x2c98a9(0x13be)]];if(!_0x1a6f7c)return;_0x180c8c(_0x46158e);const _0x7eaf28=_0x46158e[_0x2c98a9(0x106f)](_0x2c98a9(0x401)),_0x5de414=_0x7eaf28?_0x7eaf28['querySelector']('.voice-transcript'):null;if(_0x46158e[_0x2c98a9(0x999)][_0x2c98a9(0x2be)]&&_0x5de414&&_0x5de414[_0x2c98a9(0x1284)]['display']===_0x2c98a9(0x1ea)){if(_0x1a6f7c[_0x2c98a9(0x86e)]){console[_0x2c98a9(0x1081)](_0x2c98a9(0xd2c));return;}if(_0x1a6f7c[_0x2c98a9(0x81e)][_0x2c98a9(0x107c)]===![]){console[_0x2c98a9(0x1081)]('“'+_0x1a6f7c[_0x2c98a9(0x234)]+'”的TTS功能已关闭，已禁止发起TTS请求。');return;}_0x36debc(_0x46158e);}return;}const _0x1e0e06=_0x17ab30[_0x2c98a9(0x9c2)][_0x2c98a9(0x106f)](_0x2c98a9(0x7cd));if(_0x1e0e06){const _0x59946a=_0x1e0e06[_0x2c98a9(0x106f)](_0x2c98a9(0x401));if(_0x59946a){const _0x48b527=parseInt(_0x59946a[_0x2c98a9(0x999)][_0x2c98a9(0x827)]);if(!isNaN(_0x48b527)){_0x3f4e63(_0x48b527);return;}}}const _0x48c639=_0x17ab30[_0x2c98a9(0x9c2)][_0x2c98a9(0x106f)]('.waimai-user-actions\x20button');if(_0x48c639){const _0x420e22=_0x48c639['closest'](_0x2c98a9(0x401));if(_0x420e22){const _0x276928=parseInt(_0x420e22['dataset'][_0x2c98a9(0x827)]),_0x521e00=_0x48c639['dataset'][_0x2c98a9(0x60b)];if(!isNaN(_0x276928)&&_0x521e00){await _0x3d09cb(_0x276928,_0x521e00);return;}}}const _0x16b682=_0x17ab30[_0x2c98a9(0x9c2)][_0x2c98a9(0x106f)](_0x2c98a9(0xd4d));if(_0x16b682){const _0xda47b4=parseInt(_0x16b682['dataset'][_0x2c98a9(0xb09)]);if(!isNaN(_0xda47b4)){const _0x54da45=await _0xa62efb[_0x2c98a9(0xfc2)][_0x2c98a9(0x883)](_0xda47b4);if(_0x54da45){let _0x49cb6d='';const _0x2f785a=_0x54da45['authorId']==='user'?_0x53d851[_0x2c98a9(0xa74)]['nickname']:_0x53d851[_0x2c98a9(0xaa3)][_0x54da45[_0x2c98a9(0xa59)]]?.['name']||_0x2c98a9(0x701);if(_0x54da45[_0x2c98a9(0x919)]==='shuoshuo')_0x49cb6d=_0x54da45[_0x2c98a9(0x73e)];else{_0x49cb6d=_0x54da45[_0x2c98a9(0x678)]||'';if(_0x54da45[_0x2c98a9(0x97a)])_0x49cb6d+='\x0a[图片]';if(_0x54da45[_0x2c98a9(0x319)])_0x49cb6d+=_0x2c98a9(0x3c8)+_0x54da45[_0x2c98a9(0x319)]+']';}_0x184397(_0x2c98a9(0x422)+_0x2f785a+_0x2c98a9(0x104f),_0x49cb6d[_0x2c98a9(0x795)](/\n/g,_0x2c98a9(0x596)));}else _0x184397('提示',_0x2c98a9(0x95e));}return;}const _0x54221c=_0x17ab30['target'][_0x2c98a9(0x106f)](_0x2c98a9(0x4ae));if(_0x54221c){const _0x403a32=_0x54221c[_0x2c98a9(0x999)][_0x2c98a9(0xa60)];if(_0x403a32)_0x184397(_0x2c98a9(0x4b6),_0x403a32);return;}const _0x3ab6d3=_0x17ab30[_0x2c98a9(0x9c2)]['closest'](_0x2c98a9(0xf97));if(_0x3ab6d3&&_0x3ab6d3['dataset'][_0x2c98a9(0xbae)]){const _0x543983=parseInt(_0x3ab6d3[_0x2c98a9(0x999)][_0x2c98a9(0xbae)]);!isNaN(_0x543983)&&_0x74d5de(_0x543983);}const _0x2b887f=_0x17ab30['target'][_0x2c98a9(0x106f)](_0x2c98a9(0x60a));if(_0x2b887f){const _0xc008e0=_0x2b887f['closest'](_0x2c98a9(0x401));_0xc008e0&&_0x40bff8(parseInt(_0xc008e0[_0x2c98a9(0x999)][_0x2c98a9(0x827)]));}const _0x3a5a29=_0x17ab30['target'][_0x2c98a9(0x106f)](_0x2c98a9(0x68a));if(_0x3a5a29){const _0x59a05d=_0x3a5a29[_0x2c98a9(0x106f)]('.message-bubble');if(_0x59a05d&&_0x59a05d[_0x2c98a9(0x999)][_0x2c98a9(0x827)]){const _0x1d6c38=parseInt(_0x59a05d[_0x2c98a9(0x999)][_0x2c98a9(0x827)]);_0x5273c3(_0x1d6c38);}}const _0x6d89a8=_0x17ab30[_0x2c98a9(0x9c2)][_0x2c98a9(0x106f)](_0x2c98a9(0xcd4));if(_0x6d89a8){const _0x5125f8=parseInt(_0x6d89a8[_0x2c98a9(0x999)][_0x2c98a9(0x372)]);if(isNaN(_0x5125f8))return;const _0x2345d9=_0x17ab30['target']['closest']('.poll-option-item');if(_0x2345d9&&!_0x6d89a8[_0x2c98a9(0x1276)]['contains'](_0x2c98a9(0x409))){_0x23575e(_0x5125f8,_0x2345d9['dataset'][_0x2c98a9(0xa1e)]);return;}const _0x57c3f0=_0x17ab30[_0x2c98a9(0x9c2)][_0x2c98a9(0x106f)](_0x2c98a9(0xf98));if(_0x57c3f0){_0x6d89a8[_0x2c98a9(0x1276)]['contains']('closed')?_0x5f4404(_0x5125f8):_0x4f7223(_0x5125f8);return;}_0x6d89a8[_0x2c98a9(0x1276)][_0x2c98a9(0x6a3)](_0x2c98a9(0x409))&&_0x5f4404(_0x5125f8);}const _0x153195=_0x17ab30[_0x2c98a9(0x9c2)]['closest'](_0x2c98a9(0x1183));if(_0x153195){const _0x29c105=_0x53d851['chats'][_0x53d851[_0x2c98a9(0x13be)]],_0x55741e=_0x153195[_0x2c98a9(0x106f)]('.message-wrapper');if(_0x29c105&&_0x55741e){const _0x305086=parseInt(_0x55741e['dataset']['timestamp']),_0xb64692=_0x29c105[_0x2c98a9(0xe83)]['find'](_0x4af77c=>_0x4af77c[_0x2c98a9(0x827)]===_0x305086);if(_0xb64692&&_0xb64692[_0x2c98a9(0x138a)]){let _0x5c8ad4='';const _0x457b79=_0xb64692[_0x2c98a9(0x138a)];_0x457b79['originalType']===_0x2c98a9(0x2e6)?_0x5c8ad4='原文:\x20\x22'+_0x457b79['originalContent']+'\x22':_0x5c8ad4=_0x2c98a9(0x7f8)+_0x457b79[_0x2c98a9(0x1384)]+_0x2c98a9(0xf17),_0x184397(_0x2c98a9(0x232),_0x5c8ad4);}}}const _0x424e06=_0x17ab30[_0x2c98a9(0x9c2)][_0x2c98a9(0x106f)](_0x2c98a9(0xd34));if(_0x424e06&&_0x424e06[_0x2c98a9(0x106f)](_0x2c98a9(0x1295))){const _0x2e2696=parseInt(_0x424e06['dataset']['timestamp']);_0x2134bf(_0x2e2696);}const _0x13fb51=_0x17ab30['target'][_0x2c98a9(0x106f)](_0x2c98a9(0x401));if(_0x13fb51&&_0x13fb51[_0x2c98a9(0x1276)][_0x2c98a9(0x6a3)]('ai')&&_0x13fb51[_0x2c98a9(0x1276)][_0x2c98a9(0x6a3)]('is-transfer')&&_0x13fb51[_0x2c98a9(0x999)]['status']===_0x2c98a9(0x43a)){const _0x394196=parseInt(_0x13fb51[_0x2c98a9(0x999)][_0x2c98a9(0x827)]);!isNaN(_0x394196)&&_0x2014ee(_0x394196);}});const _0x26c3ed=document[_0x11344e(0x53a)](_0x11344e(0xe1c)),_0x188283=document[_0x11344e(0x139c)]('.custom-multiselect\x20.select-box'),_0x4c7105=document['getElementById'](_0x11344e(0x116a));function _0x8ac75c(){const _0x172e70=_0x11344e,_0x3a439f=_0x4c7105[_0x172e70(0xc3d)](_0x172e70(0xdc8)),_0x3fd3e1=document[_0x172e70(0x139c)](_0x172e70(0xf08));if(_0x3a439f[_0x172e70(0x29d)]===0x0)_0x3fd3e1[_0x172e70(0x34a)]=_0x172e70(0x867);else{if(_0x3a439f['length']>0x2)_0x3fd3e1['textContent']=_0x172e70(0x11fa)+_0x3a439f['length']+_0x172e70(0x1140);else{const _0x34b9f4=Array[_0x172e70(0xd97)](_0x3a439f)['map'](_0x49a918=>{const _0x47e942=_0x172e70;return _0x49a918[_0x47e942(0xbd1)]['textContent']['trim']();});_0x3fd3e1['textContent']=_0x34b9f4['join'](',\x20');}}}_0x188283[_0x11344e(0x1086)]('click',_0x2512a7=>{const _0x273e6a=_0x11344e;_0x2512a7['stopPropagation'](),_0x4c7105[_0x273e6a(0x1276)][_0x273e6a(0x4d7)](_0x273e6a(0xaef)),_0x188283[_0x273e6a(0x1276)]['toggle'](_0x273e6a(0x583));}),document[_0x11344e(0x53a)](_0x11344e(0x116a))[_0x11344e(0x1086)](_0x11344e(0x325),_0x8ac75c),window[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x1d2254=>{const _0x1dc549=_0x11344e;!document[_0x1dc549(0x139c)](_0x1dc549(0x1198))[_0x1dc549(0x6a3)](_0x1d2254[_0x1dc549(0x9c2)])&&(_0x4c7105[_0x1dc549(0x1276)][_0x1dc549(0x2d4)](_0x1dc549(0xaef)),_0x188283['classList'][_0x1dc549(0x2d4)](_0x1dc549(0x583)));}),document['getElementById'](_0x11344e(0x460))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x4899ea=_0x11344e;_0x273dd7();if(!_0x53d851['activeChatId'])return;const _0x50b1f0=_0x53d851[_0x4899ea(0xaa3)][_0x53d851[_0x4899ea(0x13be)]],_0x5d023a=_0x50b1f0[_0x4899ea(0x86e)],_0x4ce1dc=document[_0x4899ea(0x53a)](_0x4899ea(0x9f7));!_0x5d023a&&_0x50b1f0['settings'][_0x4899ea(0x311)]&&_0x50b1f0['settings'][_0x4899ea(0x311)][_0x4899ea(0x29d)]>0x0?_0x4ce1dc[_0x4899ea(0x1284)][_0x4899ea(0x11d9)]='block':_0x4ce1dc['style'][_0x4899ea(0x11d9)]='none';document['getElementById'](_0x4899ea(0xe7c))[_0x4899ea(0x1284)][_0x4899ea(0x11d9)]=_0x4899ea(0x1ea),document[_0x4899ea(0x53a)](_0x4899ea(0x1417))[_0x4899ea(0x1284)]['display']=_0x4899ea(0x1ea),document[_0x4899ea(0x53a)](_0x4899ea(0xd3e))[_0x4899ea(0x1284)][_0x4899ea(0x11d9)]=_0x4899ea(0x1ea),document[_0x4899ea(0x53a)](_0x4899ea(0x11a4))[_0x4899ea(0x1284)][_0x4899ea(0x11d9)]=_0x5d023a?_0x4899ea(0x1ea):_0x4899ea(0xbf2),document[_0x4899ea(0x53a)]('my-nickname-group')[_0x4899ea(0x1284)][_0x4899ea(0x11d9)]=_0x5d023a?_0x4899ea(0xbf2):_0x4899ea(0x1ea),document[_0x4899ea(0x53a)](_0x4899ea(0xcd9))[_0x4899ea(0x1284)][_0x4899ea(0x11d9)]=_0x5d023a?_0x4899ea(0x1ea):_0x4899ea(0xbf2),document[_0x4899ea(0x53a)](_0x4899ea(0xf46))[_0x4899ea(0x1284)]['display']=_0x5d023a?_0x4899ea(0x1ea):_0x4899ea(0xbf2),document['getElementById'](_0x4899ea(0x377))[_0x4899ea(0x1284)][_0x4899ea(0x11d9)]=_0x5d023a?_0x4899ea(0xbf2):_0x4899ea(0x1ea),document[_0x4899ea(0x53a)]('ai-avatar-group')[_0x4899ea(0x1284)][_0x4899ea(0x11d9)]=_0x5d023a?'none':_0x4899ea(0x1ea),document[_0x4899ea(0x53a)](_0x4899ea(0x120f))[_0x4899ea(0x1284)]['display']=_0x5d023a?_0x4899ea(0xbf2):_0x4899ea(0x1ea),document[_0x4899ea(0x53a)](_0x4899ea(0x8cf))[_0x4899ea(0x1284)][_0x4899ea(0x11d9)]=_0x5d023a?_0x4899ea(0xbf2):_0x4899ea(0x1ea),document[_0x4899ea(0x53a)](_0x4899ea(0xf4f))[_0x4899ea(0x1284)][_0x4899ea(0x11d9)]=_0x5d023a?_0x4899ea(0xbf2):_0x4899ea(0x1ea),document[_0x4899ea(0x53a)]('inject-thought-group')[_0x4899ea(0x1284)][_0x4899ea(0x11d9)]=_0x5d023a?'none':_0x4899ea(0x1ea),document[_0x4899ea(0x53a)](_0x4899ea(0x11b2))[_0x4899ea(0x1284)][_0x4899ea(0x11d9)]=_0x5d023a?'none':_0x4899ea(0x1ea),document[_0x4899ea(0x53a)](_0x4899ea(0x55b))['style'][_0x4899ea(0x11d9)]=_0x5d023a?_0x4899ea(0xbf2):_0x4899ea(0x1ea),document[_0x4899ea(0x53a)]('group-cooldown-group')['style'][_0x4899ea(0x11d9)]=_0x5d023a?'block':_0x4899ea(0xbf2),document['getElementById'](_0x4899ea(0x929))[_0x4899ea(0x11a2)]=_0x50b1f0['name'],document[_0x4899ea(0x53a)](_0x4899ea(0x1264))[_0x4899ea(0x11a2)]=_0x50b1f0['settings']['myPersona'],document['getElementById'](_0x4899ea(0xb96))['src']=_0x50b1f0[_0x4899ea(0x81e)][_0x4899ea(0x971)]||(_0x5d023a?_0x132d11:_0x5d06c0),document['getElementById'](_0x4899ea(0x505))[_0x4899ea(0x11a2)]=_0x50b1f0['settings'][_0x4899ea(0x489)],document[_0x4899ea(0x53a)](_0x4899ea(0x9c3))['value']=_0x50b1f0[_0x4899ea(0x81e)][_0x4899ea(0x90d)]||0xa;const _0x18c5b7=document['getElementById'](_0x4899ea(0x4bf)),_0x5234e3=document[_0x4899ea(0x53a)]('remove-bg-btn');_0x50b1f0[_0x4899ea(0x81e)]['background']?(_0x18c5b7[_0x4899ea(0x7ff)]=_0x50b1f0[_0x4899ea(0x81e)]['background'],_0x18c5b7['style']['display']=_0x4899ea(0x1ea),_0x5234e3['style']['display']=_0x4899ea(0xbeb)):(_0x18c5b7[_0x4899ea(0x1284)]['display']=_0x4899ea(0xbf2),_0x5234e3[_0x4899ea(0x1284)][_0x4899ea(0x11d9)]='none');document['getElementById']('lyrics-position-group')[_0x4899ea(0x1284)]['display']=_0x5d023a?_0x4899ea(0xbf2):'block',document[_0x4899ea(0x53a)]('single-char-background-activity-group')[_0x4899ea(0x1284)]['display']=_0x5d023a?_0x4899ea(0xbf2):_0x4899ea(0x1ea),document[_0x4899ea(0x53a)](_0x4899ea(0x21a))[_0x4899ea(0x1284)][_0x4899ea(0x11d9)]=_0x5d023a?'block':_0x4899ea(0xbf2);const _0x3de45c=document[_0x4899ea(0x53a)](_0x4899ea(0x206)),_0x532297=document[_0x4899ea(0x53a)]('time-zone-group');_0x3de45c[_0x4899ea(0x1077)]=_0x50b1f0[_0x4899ea(0x81e)][_0x4899ea(0x558)],_0x532297['style'][_0x4899ea(0x11d9)]=_0x3de45c['checked']?'block':_0x4899ea(0xbf2);const _0x1e87bc=document[_0x4899ea(0x53a)](_0x4899ea(0x9b2)),_0x5e080e=Intl['supportedValuesOf'](_0x4899ea(0x13fa));_0x1e87bc[_0x4899ea(0xaac)]='',_0x5e080e[_0x4899ea(0xeaf)](_0x3bf5e3=>{const _0x351c1e=_0x4899ea,_0x1542fa=document['createElement'](_0x351c1e(0xa1e));_0x1542fa[_0x351c1e(0x11a2)]=_0x3bf5e3,_0x1542fa[_0x351c1e(0x34a)]=_0x3bf5e3,_0x1e87bc[_0x351c1e(0x133d)](_0x1542fa);}),_0x1e87bc[_0x4899ea(0x11a2)]=_0x50b1f0[_0x4899ea(0x81e)][_0x4899ea(0x13fa)]||_0x4899ea(0x7c3);if(_0x5d023a)document[_0x4899ea(0x53a)](_0x4899ea(0x105e))['checked']=_0x50b1f0['settings'][_0x4899ea(0x527)],document[_0x4899ea(0x53a)](_0x4899ea(0x666))[_0x4899ea(0x11a2)]=_0x50b1f0['settings'][_0x4899ea(0x1303)]||'',document[_0x4899ea(0x53a)](_0x4899ea(0x4b7))[_0x4899ea(0x7ff)]=_0x50b1f0[_0x4899ea(0x81e)][_0x4899ea(0x629)]||_0x29ae5b,document[_0x4899ea(0x53a)](_0x4899ea(0x1441))['value']=_0x50b1f0['settings'][_0x4899ea(0xdd0)]||0xa,document[_0x4899ea(0x53a)]('single-char-background-activity-group')[_0x4899ea(0x1284)][_0x4899ea(0x11d9)]=_0x4899ea(0xbf2),_0x17f903(_0x50b1f0[_0x4899ea(0x3de)]);else{document[_0x4899ea(0x53a)]('single-char-background-activity-group')[_0x4899ea(0x1284)]['display']=_0x4899ea(0x1ea),document['getElementById'](_0x4899ea(0xfbf))[_0x4899ea(0x1077)]=_0x50b1f0[_0x4899ea(0x81e)][_0x4899ea(0x527)],document['getElementById']('inject-thought-toggle')['checked']=_0x50b1f0[_0x4899ea(0x81e)]['injectLatestThought'];const _0x4d9bda=document[_0x4899ea(0x53a)](_0x4899ea(0xf85)),_0x19a219=document[_0x4899ea(0x53a)](_0x4899ea(0x415)),_0x2124c1=document['getElementById'](_0x4899ea(0x10b4)),_0x16181b=document[_0x4899ea(0x53a)](_0x4899ea(0xcfd));_0x4d9bda[_0x4899ea(0x1077)]=_0x50b1f0[_0x4899ea(0x81e)][_0x4899ea(0x9af)]||![],_0x19a219[_0x4899ea(0x1284)][_0x4899ea(0x11d9)]=_0x4d9bda[_0x4899ea(0x1077)]?'block':_0x4899ea(0xbf2),_0x2124c1[_0x4899ea(0x11a2)]=_0x50b1f0['settings'][_0x4899ea(0x804)]||0x64,_0x16181b[_0x4899ea(0x11a2)]=_0x50b1f0[_0x4899ea(0x81e)][_0x4899ea(0x11ef)]||0x12c,await _0x17cd40(_0x50b1f0),document[_0x4899ea(0x53a)](_0x4899ea(0x383))['value']=_0x50b1f0['originalName'],document['getElementById'](_0x4899ea(0xcb7))['value']=_0x50b1f0['settings'][_0x4899ea(0x1234)]||'',document[_0x4899ea(0x53a)](_0x4899ea(0x5db))[_0x4899ea(0x1077)]=_0x50b1f0[_0x4899ea(0x81e)][_0x4899ea(0x107c)]!==![],document[_0x4899ea(0x53a)](_0x4899ea(0xeb2))[_0x4899ea(0x11a2)]=_0x50b1f0[_0x4899ea(0x81e)]['aiPersona'],document[_0x4899ea(0x53a)](_0x4899ea(0xf45))[_0x4899ea(0x7ff)]=_0x50b1f0['settings'][_0x4899ea(0x9e3)]||_0x5d06c0,document[_0x4899ea(0x53a)](_0x4899ea(0x584))['value']=_0x50b1f0[_0x4899ea(0x81e)][_0x4899ea(0x1303)]||'我',document[_0x4899ea(0x53a)]('ai-action-cooldown-input')[_0x4899ea(0x11a2)]=_0x50b1f0['settings']['actionCooldownMinutes']||0xa;const _0x1b79b0=document[_0x4899ea(0x53a)](_0x4899ea(0x135e));_0x1b79b0['innerHTML']='<option\x20value=\x22\x22>未分组</option>';const _0x5722f6=await _0xa62efb[_0x4899ea(0x443)]['toArray']();_0x5722f6[_0x4899ea(0xeaf)](_0x7c396a=>{const _0x421f95=_0x4899ea,_0x20d9b2=document[_0x421f95(0xd67)]('option');_0x20d9b2[_0x421f95(0x11a2)]=_0x7c396a['id'],_0x20d9b2[_0x421f95(0x34a)]=_0x7c396a['name'];if(_0x50b1f0[_0x421f95(0x608)]===_0x7c396a['id'])_0x20d9b2[_0x421f95(0x1015)]=!![];_0x1b79b0['appendChild'](_0x20d9b2);});const _0x3789ae=_0x50b1f0['settings'][_0x4899ea(0x10d7)]||{'vertical':'top','horizontal':'center','offset':0xa};document[_0x4899ea(0x53a)](_0x4899ea(0x31e))[_0x4899ea(0x11a2)]=_0x3789ae[_0x4899ea(0x140f)],document[_0x4899ea(0x53a)](_0x4899ea(0xf80))[_0x4899ea(0x11a2)]=_0x3789ae['horizontal'],document[_0x4899ea(0x53a)]('lyrics-offset-input')['value']=_0x3789ae['offset'];}const _0x1acd35=document[_0x4899ea(0x53a)](_0x4899ea(0x116a));_0x1acd35[_0x4899ea(0xaac)]='';const [_0x2fa922,_0x4a888f]=await Promise[_0x4899ea(0x63d)]([_0xa62efb[_0x4899ea(0xf5d)]['toArray'](),_0xa62efb[_0x4899ea(0x10f2)][_0x4899ea(0xa73)]()]),_0x2382f9=new Set(_0x50b1f0['settings'][_0x4899ea(0x4ab)]||[]);if(_0x4a888f['length']===0x0)_0x1acd35['innerHTML']=_0x4899ea(0x13b2);else{_0x2fa922[_0x4899ea(0xeaf)](_0x489502=>{const _0xddbe32=_0x4899ea,_0x4602f3=_0x4a888f[_0xddbe32(0x2dd)](_0x48652c=>_0x48652c['categoryId']===_0x489502['id']);if(_0x4602f3[_0xddbe32(0x29d)]>0x0){const _0x5ef9c6=document[_0xddbe32(0xd67)]('h4');_0x5ef9c6[_0xddbe32(0x34a)]=_0x489502['name'],_0x5ef9c6[_0xddbe32(0x1284)]['cssText']=_0xddbe32(0x66e),_0x1acd35[_0xddbe32(0x133d)](_0x5ef9c6),_0x4602f3[_0xddbe32(0xeaf)](_0x52108e=>{const _0x1b6434=_0xddbe32,_0x5cf052=_0x2382f9[_0x1b6434(0x11af)](_0x52108e['id']),_0x2648b2=document[_0x1b6434(0xd67)](_0x1b6434(0xc81));_0x2648b2[_0x1b6434(0xaac)]='<input\x20type=\x22checkbox\x22\x20value=\x22book_'+_0x52108e['id']+'\x22\x20'+(_0x5cf052?_0x1b6434(0x1077):'')+'>\x20'+_0x52108e[_0x1b6434(0x234)],_0x1acd35[_0x1b6434(0x133d)](_0x2648b2);});}});const _0x9b411f=_0x4a888f['filter'](_0x107fd3=>!_0x107fd3[_0x4899ea(0xbcd)]);if(_0x9b411f[_0x4899ea(0x29d)]>0x0){const _0x41aaa=document[_0x4899ea(0xd67)]('h4');_0x41aaa[_0x4899ea(0x34a)]=_0x4899ea(0x113a),_0x41aaa[_0x4899ea(0x1284)][_0x4899ea(0x94d)]=_0x4899ea(0xc32),_0x1acd35[_0x4899ea(0x133d)](_0x41aaa),_0x9b411f[_0x4899ea(0xeaf)](_0x1e3ef6=>{const _0xcc1d03=_0x4899ea,_0x427df7=_0x2382f9[_0xcc1d03(0x11af)](_0x1e3ef6['id']),_0x5469a0=document[_0xcc1d03(0xd67)]('label');_0x5469a0[_0xcc1d03(0xaac)]=_0xcc1d03(0x1211)+_0x1e3ef6['id']+'\x22\x20'+(_0x427df7?_0xcc1d03(0x1077):'')+'>\x20'+_0x1e3ef6[_0xcc1d03(0x234)],_0x1acd35['appendChild'](_0x5469a0);});}}_0x8ac75c();const _0x456325=document[_0x4899ea(0x53a)](_0x4899ea(0x6d6)),_0x48c131=document[_0x4899ea(0x53a)](_0x4899ea(0x312)),_0x39a3ed=document[_0x4899ea(0x53a)](_0x4899ea(0x1006)),_0x33a0c7=_0x50b1f0[_0x4899ea(0x81e)][_0x4899ea(0x278)]||[];_0x456325[_0x4899ea(0x1077)]=_0x33a0c7[_0x4899ea(0x29d)]>0x0,_0x48c131[_0x4899ea(0x1284)]['display']=_0x456325[_0x4899ea(0x1077)]?_0x4899ea(0x1ea):_0x4899ea(0xbf2),_0x39a3ed[_0x4899ea(0xaac)]='',Object[_0x4899ea(0x244)](_0x53d851[_0x4899ea(0xaa3)])[_0x4899ea(0xeaf)](_0x12d324=>{const _0x2eef13=_0x4899ea;if(_0x12d324['id']===_0x50b1f0['id'])return;const _0x34ccc9=_0x33a0c7[_0x2eef13(0x6e9)](_0x12d324['id']),_0x5d57b8=_0x12d324[_0x2eef13(0x86e)]?_0x2eef13(0xbf8):_0x2eef13(0x829),_0x201de0=document['createElement'](_0x2eef13(0xc81));_0x201de0['innerHTML']='<input\x20type=\x22checkbox\x22\x20value=\x22'+_0x12d324['id']+'\x22\x20'+(_0x34ccc9?_0x2eef13(0x1077):'')+'>\x20'+_0x5d57b8+'\x20'+_0x12d324[_0x2eef13(0x234)],_0x39a3ed[_0x2eef13(0x133d)](_0x201de0);});function _0x1a6752(){const _0x49cc41=_0x4899ea,_0x2eb3e9=_0x39a3ed['querySelectorAll']('input:checked'),_0x4f721d=_0x48c131['querySelector'](_0x49cc41(0xf08));if(_0x2eb3e9['length']===0x0)_0x4f721d[_0x49cc41(0x34a)]=_0x49cc41(0x867);else _0x2eb3e9['length']>0x2?_0x4f721d[_0x49cc41(0x34a)]=_0x49cc41(0x11fa)+_0x2eb3e9['length']+'\x20项':_0x4f721d[_0x49cc41(0x34a)]=Array[_0x49cc41(0xd97)](_0x2eb3e9)['map'](_0x956c8b=>_0x956c8b['parentElement'][_0x49cc41(0x34a)][_0x49cc41(0x13bc)]())['join'](',\x20');}_0x1a6752(),_0x456325[_0x4899ea(0x1086)](_0x4899ea(0x325),()=>{const _0x3ee4b4=_0x4899ea;_0x48c131[_0x3ee4b4(0x1284)][_0x3ee4b4(0x11d9)]=_0x456325[_0x3ee4b4(0x1077)]?_0x3ee4b4(0x1ea):_0x3ee4b4(0xbf2);});const _0x5f443b=_0x48c131['querySelector'](_0x4899ea(0x9bf)),_0x13c89b=_0x5f443b[_0x4899ea(0x75a)](!![]);_0x5f443b[_0x4899ea(0x9e8)][_0x4899ea(0xa1d)](_0x13c89b,_0x5f443b),_0x13c89b[_0x4899ea(0x1086)](_0x4899ea(0xb2b),_0x350dfc=>{const _0x46522f=_0x4899ea;_0x350dfc['stopPropagation'](),_0x39a3ed[_0x46522f(0x1276)][_0x46522f(0x4d7)](_0x46522f(0xaef)),_0x13c89b[_0x46522f(0x1276)][_0x46522f(0x4d7)]('expanded');}),_0x39a3ed[_0x4899ea(0x1086)]('change',_0x1a6752);const _0x3bb060=document[_0x4899ea(0x139c)](_0x4899ea(0xa6c)+(_0x50b1f0[_0x4899ea(0x81e)][_0x4899ea(0x1297)]||_0x4899ea(0xce2))+'\x22]');if(_0x3bb060)_0x3bb060[_0x4899ea(0x1077)]=!![];const _0x325ea8=document[_0x4899ea(0x53a)](_0x4899ea(0x813));_0x325ea8['value']=_0x50b1f0[_0x4899ea(0x81e)][_0x4899ea(0xd8d)]||0xd,document['getElementById'](_0x4899ea(0x668))[_0x4899ea(0x34a)]=_0x325ea8[_0x4899ea(0x11a2)]+'px';const _0x312d6d=document[_0x4899ea(0x53a)](_0x4899ea(0xb8b));_0x312d6d[_0x4899ea(0x11a2)]=_0x50b1f0[_0x4899ea(0x81e)][_0x4899ea(0x123c)]||'',_0x574a7b(),document[_0x4899ea(0x53a)](_0x4899ea(0x799))[_0x4899ea(0x1077)]=_0x50b1f0[_0x4899ea(0x81e)][_0x4899ea(0xe1a)]||![],document[_0x4899ea(0x53a)](_0x4899ea(0x93e))[_0x4899ea(0x11a2)]=_0x50b1f0['settings']['autoMemoryInterval']||0x14,setTimeout(()=>{const _0x1bee65=_0x4899ea;_0x2214ad();const _0x12885b=['ai-persona',_0x1bee65(0x1264),'max-memory',_0x1bee65(0x9c3),_0x1bee65(0x799),_0x1bee65(0x93e),'offline-mode-toggle',_0x1bee65(0x10b4),'offline-max-length-input',_0x1bee65(0x554)];_0x12885b[_0x1bee65(0xeaf)](_0x275345=>{const _0x627b6d=_0x1bee65,_0x42f299=document[_0x627b6d(0x53a)](_0x275345);_0x42f299&&_0x42f299['addEventListener']('input',_0x2214ad);}),document[_0x1bee65(0x53a)](_0x1bee65(0x116a))[_0x1bee65(0x1086)](_0x1bee65(0x325),_0x2214ad),document['getElementById'](_0x1bee65(0x1006))[_0x1bee65(0x1086)]('change',_0x2214ad),document[_0x1bee65(0x53a)](_0x1bee65(0x6d6))[_0x1bee65(0x1086)](_0x1bee65(0x325),_0x2214ad);},0x64),_0x541a81(_0x4899ea(0x607));});function _0x17f903(_0x6959b2){const _0x5594a4=_0x11344e,_0x17c6b9=document[_0x5594a4(0x53a)](_0x5594a4(0xbc4));_0x17c6b9[_0x5594a4(0xaac)]='',_0x6959b2[_0x5594a4(0xeaf)](_0x485507=>{const _0x4e9f8e=_0x5594a4,_0x9b7691=document[_0x4e9f8e(0xd67)](_0x4e9f8e(0x1425));_0x9b7691[_0x4e9f8e(0x6de)]=_0x4e9f8e(0x35e),_0x9b7691[_0x4e9f8e(0x999)][_0x4e9f8e(0x1327)]=_0x485507['id'];const _0x9b5698=_0x485507[_0x4e9f8e(0x8cd)]||(_0x53d851['chats'][_0x485507['id']]?_0x53d851['chats'][_0x485507['id']][_0x4e9f8e(0x81e)][_0x4e9f8e(0x9e3)]:_0x434592);_0x9b7691['innerHTML']=_0x4e9f8e(0x88b)+_0x9b5698+_0x4e9f8e(0xa65)+_0x485507['groupNickname']+_0x4e9f8e(0x677)+_0x485507[_0x4e9f8e(0x12bc)]+'</div>',_0x9b7691['addEventListener'](_0x4e9f8e(0xb2b),()=>_0x2d08e8(_0x485507['id'])),_0x17c6b9[_0x4e9f8e(0x133d)](_0x9b7691);});}document[_0x11344e(0x53a)](_0x11344e(0xa24))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x2bc032=_0x11344e;if(!_0x4283ff)return;const _0x3e26fb=_0x53d851[_0x2bc032(0xaa3)][_0x53d851[_0x2bc032(0x13be)]],_0xcc3e65=_0x3e26fb[_0x2bc032(0x3de)][_0x2bc032(0x397)](_0x4daeeb=>_0x4daeeb['id']===_0x4283ff);if(!_0xcc3e65)return;const _0x4b9776=document[_0x2bc032(0x53a)](_0x2bc032(0xb87))[_0x2bc032(0x11a2)][_0x2bc032(0x13bc)]();if(!_0x4b9776){alert(_0x2bc032(0xbab));return;}_0xcc3e65['groupNickname']=_0x4b9776,_0xcc3e65[_0x2bc032(0x11fb)]=document['getElementById'](_0x2bc032(0x90e))['value'];const _0x3b2c63=document[_0x2bc032(0x53a)]('member-avatar-preview')[_0x2bc032(0x7ff)];_0xcc3e65[_0x2bc032(0x8cd)]=_0x3b2c63;const _0x222a2f=_0x53d851[_0x2bc032(0xaa3)][_0xcc3e65['id']];_0x222a2f&&(_0x222a2f[_0x2bc032(0x81e)][_0x2bc032(0x9e3)]=_0x3b2c63,await _0xa62efb[_0x2bc032(0xaa3)][_0x2bc032(0x546)](_0x222a2f)),await _0xa62efb[_0x2bc032(0xaa3)][_0x2bc032(0x546)](_0x3e26fb),_0x17f903(_0x3e26fb[_0x2bc032(0x3de)]),document['getElementById']('member-settings-modal')[_0x2bc032(0x1276)][_0x2bc032(0x2d4)](_0x2bc032(0xaef)),_0x4283ff=null;});function _0x2d08e8(_0xedc5ad){const _0x496d4d=_0x11344e;_0x4283ff=_0xedc5ad;const _0x1e085a=_0x53d851[_0x496d4d(0xaa3)][_0x53d851[_0x496d4d(0x13be)]],_0x5e2878=_0x1e085a[_0x496d4d(0x3de)][_0x496d4d(0x397)](_0x13268c=>_0x13268c['id']===_0xedc5ad);if(!_0x5e2878)return;document[_0x496d4d(0x53a)](_0x496d4d(0xb87))[_0x496d4d(0x11a2)]=_0x5e2878[_0x496d4d(0x12bc)],document['getElementById'](_0x496d4d(0x90e))[_0x496d4d(0x11a2)]=_0x5e2878[_0x496d4d(0x11fb)];const _0x3a4eb0=_0x5e2878[_0x496d4d(0x8cd)]||(_0x53d851['chats'][_0x5e2878['id']]?_0x53d851[_0x496d4d(0xaa3)][_0x5e2878['id']][_0x496d4d(0x81e)][_0x496d4d(0x9e3)]:_0x434592);document['getElementById']('member-avatar-preview')[_0x496d4d(0x7ff)]=_0x3a4eb0,document['getElementById'](_0x496d4d(0xc30))['classList'][_0x496d4d(0xe13)]('visible');}document['getElementById'](_0x11344e(0x88c))[_0x11344e(0x1086)]('click',()=>{const _0x1884a6=_0x11344e;document['getElementById']('member-settings-modal')['classList'][_0x1884a6(0x2d4)]('visible'),_0x4283ff=null;}),document[_0x11344e(0x53a)]('save-member-settings-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x39728a=_0x11344e;if(!_0x4283ff)return;const _0x55b463=_0x53d851['chats'][_0x53d851[_0x39728a(0x13be)]],_0x387f19=_0x55b463[_0x39728a(0x3de)][_0x39728a(0x397)](_0x43c219=>_0x43c219['id']===_0x4283ff);if(!_0x387f19)return;const _0x297d6a=document[_0x39728a(0x53a)](_0x39728a(0xb87))['value'][_0x39728a(0x13bc)]();if(!_0x297d6a){alert(_0x39728a(0xbab));return;}_0x387f19[_0x39728a(0x12bc)]=_0x297d6a,_0x387f19['persona']=document[_0x39728a(0x53a)](_0x39728a(0x90e))[_0x39728a(0x11a2)];const _0x30f2c6=document[_0x39728a(0x53a)](_0x39728a(0xa53))[_0x39728a(0x7ff)];_0x387f19[_0x39728a(0x8cd)]=_0x30f2c6;const _0xaf5fad=_0x53d851[_0x39728a(0xaa3)][_0x387f19['id']];_0xaf5fad&&(_0xaf5fad['settings'][_0x39728a(0x9e3)]=_0x30f2c6,await _0xa62efb[_0x39728a(0xaa3)]['put'](_0xaf5fad)),await _0xa62efb[_0x39728a(0xaa3)]['put'](_0x55b463),_0x17f903(_0x55b463[_0x39728a(0x3de)]),document[_0x39728a(0x53a)]('member-settings-modal')[_0x39728a(0x1276)][_0x39728a(0x2d4)](_0x39728a(0xaef)),_0x4283ff=null;}),document[_0x11344e(0x53a)](_0x11344e(0x12cc))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x4154c9=_0x11344e;document[_0x4154c9(0x53a)](_0x4154c9(0xa55))[_0x4154c9(0x1077)]=!![];}),document[_0x11344e(0x53a)](_0x11344e(0xfd7))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x23996a=_0x11344e;if(!_0x53d851[_0x23996a(0x13be)])return;const _0xf0d6a7=_0x53d851['chats'][_0x53d851[_0x23996a(0x13be)]],_0x349ee0=_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x9af)]||![],_0x1e08fa=document[_0x23996a(0x53a)](_0x23996a(0x929))['value']['trim']();if(!_0x1e08fa)return alert('备注名/群名不能为空！');if(!_0xf0d6a7[_0x23996a(0x86e)]&&_0x1e08fa!==_0xf0d6a7[_0x23996a(0x234)]){if(!_0xf0d6a7['nameHistory'])_0xf0d6a7[_0x23996a(0x12ed)]=[];if(!_0xf0d6a7[_0x23996a(0x12ed)][_0x23996a(0x6e9)](_0xf0d6a7[_0x23996a(0x234)]))_0xf0d6a7[_0x23996a(0x12ed)][_0x23996a(0x7dd)](_0xf0d6a7['name']);}_0xf0d6a7[_0x23996a(0x234)]=_0x1e08fa;const _0x4385b1=document[_0x23996a(0x139c)]('input[name=\x22theme-select\x22]:checked');_0xf0d6a7[_0x23996a(0x81e)]['theme']=_0x4385b1?_0x4385b1[_0x23996a(0x11a2)]:_0x23996a(0xce2),_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0xd8d)]=parseInt(document[_0x23996a(0x53a)](_0x23996a(0x813))['value']),_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x123c)]=document['getElementById']('custom-css-input')['value'][_0x23996a(0x13bc)](),_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0xab1)]=document['getElementById']('my-persona')[_0x23996a(0x11a2)],_0xf0d6a7[_0x23996a(0x81e)]['myAvatar']=document['getElementById'](_0x23996a(0xb96))[_0x23996a(0x7ff)],_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x489)]=parseInt(document[_0x23996a(0x53a)](_0x23996a(0x505))['value'])||0xa,_0xf0d6a7[_0x23996a(0x81e)]['linkedMemoryCount']=parseInt(document[_0x23996a(0x53a)](_0x23996a(0x9c3))[_0x23996a(0x11a2)])||0xa;const _0x39a0c6=document['querySelectorAll'](_0x23996a(0x920)),_0x16a492=[];_0x39a0c6[_0x23996a(0xeaf)](_0x32cc95=>{const _0x11d601=_0x23996a;_0x32cc95[_0x11d601(0x11a2)][_0x11d601(0x1200)]('book_')&&_0x16a492[_0x11d601(0x7dd)](_0x32cc95[_0x11d601(0x11a2)]['replace'](_0x11d601(0x261),''));}),_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x4ab)]=_0x16a492;const _0x3f4d94=document[_0x23996a(0x53a)](_0x23996a(0x6d6))['checked'];if(_0x3f4d94){const _0x37766a=document[_0x23996a(0xc3d)](_0x23996a(0x13d7));_0xf0d6a7[_0x23996a(0x81e)]['linkedMemoryChatIds']=Array[_0x23996a(0xd97)](_0x37766a)[_0x23996a(0xcb4)](_0x425b9f=>_0x425b9f[_0x23996a(0x11a2)]);}else _0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x278)]=[];_0xf0d6a7[_0x23996a(0x81e)]['enableAutoMemory']=document['getElementById'](_0x23996a(0x799))['checked'],_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x645)]=parseInt(document[_0x23996a(0x53a)]('auto-memory-interval')[_0x23996a(0x11a2)])||0x14,_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x558)]=document['getElementById'](_0x23996a(0x206))['checked'],_0xf0d6a7[_0x23996a(0x81e)]['timeZone']=document[_0x23996a(0x53a)](_0x23996a(0x9b2))[_0x23996a(0x11a2)];if(_0xf0d6a7[_0x23996a(0x86e)])_0xf0d6a7[_0x23996a(0x81e)]['enableBackgroundActivity']=document[_0x23996a(0x53a)]('group-background-activity-switch')[_0x23996a(0x1077)],_0xf0d6a7[_0x23996a(0x81e)]['myNickname']=document['getElementById'](_0x23996a(0x666))[_0x23996a(0x11a2)][_0x23996a(0x13bc)](),_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x629)]=document[_0x23996a(0x53a)](_0x23996a(0x4b7))[_0x23996a(0x7ff)],_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0xdd0)]=parseInt(document[_0x23996a(0x53a)]('group-action-cooldown-input')[_0x23996a(0x11a2)])||0xa;else{_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x527)]=document[_0x23996a(0x53a)](_0x23996a(0xfbf))[_0x23996a(0x1077)];const _0x5653fe=document[_0x23996a(0x53a)]('offline-mode-toggle')[_0x23996a(0x1077)];_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x9af)]=_0x5653fe;if(_0x349ee0===!![]&&_0x5653fe===![]){const _0x4de199={'role':_0x23996a(0xab3),'content':_0x23996a(0x1191),'timestamp':Date[_0x23996a(0x9c1)](),'isHidden':!![]};_0xf0d6a7[_0x23996a(0xe83)][_0x23996a(0x7dd)](_0x4de199),console['log']('已成功注入“切换到线上模式”的系统指令。');}_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0xe12)]=document[_0x23996a(0x53a)](_0x23996a(0x10fb))[_0x23996a(0x1077)],_0xf0d6a7['settings'][_0x23996a(0x804)]=parseInt(document['getElementById'](_0x23996a(0x10b4))[_0x23996a(0x11a2)])||0x64,_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x11ef)]=parseInt(document[_0x23996a(0x53a)](_0x23996a(0xcfd))['value'])||0x12c,_0xf0d6a7['settings']['offlinePresetId']=document[_0x23996a(0x53a)](_0x23996a(0x554))[_0x23996a(0x11a2)]||null;const _0x48703b=document[_0x23996a(0x53a)](_0x23996a(0x383))[_0x23996a(0x11a2)]['trim']();if(!_0x48703b)return alert('对方本名不能为空！');_0xf0d6a7[_0x23996a(0x543)]=_0x48703b,_0xf0d6a7['settings']['aiPersona']=document['getElementById'](_0x23996a(0xeb2))['value'],_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x1234)]=document['getElementById'](_0x23996a(0xcb7))[_0x23996a(0x11a2)][_0x23996a(0x13bc)](),_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x107c)]=document[_0x23996a(0x53a)](_0x23996a(0x5db))[_0x23996a(0x1077)],_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x9e3)]=document['getElementById'](_0x23996a(0xf45))[_0x23996a(0x7ff)],_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x1303)]=document[_0x23996a(0x53a)](_0x23996a(0x584))['value'][_0x23996a(0x13bc)]()||'我',_0xf0d6a7[_0x23996a(0x81e)]['actionCooldownMinutes']=parseInt(document[_0x23996a(0x53a)](_0x23996a(0x945))['value'])||0xa,_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x10d7)]={'vertical':document[_0x23996a(0x53a)](_0x23996a(0x31e))['value'],'horizontal':document[_0x23996a(0x53a)]('lyrics-horizontal-pos')['value'],'offset':parseInt(document[_0x23996a(0x53a)](_0x23996a(0x13bb))[_0x23996a(0x11a2)])||0xa};const _0x2fdf7f=document[_0x23996a(0x53a)](_0x23996a(0x135e))[_0x23996a(0x11a2)];_0xf0d6a7[_0x23996a(0x608)]=_0x2fdf7f?parseInt(_0x2fdf7f):null;}await _0xa62efb[_0x23996a(0xaa3)]['put'](_0xf0d6a7),!_0xf0d6a7[_0x23996a(0x86e)]&&(await _0x30a85e(_0xf0d6a7),await _0x55466c(_0xf0d6a7)),_0x3b0963(_0xf0d6a7),_0x378258(_0xf0d6a7[_0x23996a(0x81e)][_0x23996a(0x123c)],_0x23996a(0x356),_0x23996a(0x265)),_0x541a81(_0x23996a(0x10ba)),_0x60f53f(_0x53d851[_0x23996a(0x13be)]),_0x5001a4();}),document['getElementById']('chat-settings-screen')['addEventListener'](_0x11344e(0xb2b),_0x5ce273=>{const _0x454f9a=_0x11344e;_0x5ce273[_0x454f9a(0x9c2)][_0x454f9a(0x1276)][_0x454f9a(0x6a3)](_0x454f9a(0xea2))&&_0x3ef259(_0x454f9a(0x2d8));}),document[_0x11344e(0x53a)](_0x11344e(0xc30))['addEventListener']('click',_0x880daf=>{const _0xc8baed=_0x11344e;_0x880daf[_0xc8baed(0x9c2)]['classList'][_0xc8baed(0x6a3)](_0xc8baed(0xea2))&&_0x3ef259('member');});const _0x53b5f2=document['getElementById']('avatar-frame-modal'),_0xc81f54=document[_0x11344e(0x53a)](_0x11344e(0x7ad)),_0x1d15b1=document[_0x11344e(0x53a)](_0x11344e(0x126e)),_0x1aa11e=document[_0x11344e(0x53a)](_0x11344e(0x676)),_0x80decf=document[_0x11344e(0x53a)](_0x11344e(0x7b7));document[_0x11344e(0x53a)](_0x11344e(0xc2d))['addEventListener'](_0x11344e(0xb2b),_0x464936),document[_0x11344e(0x53a)](_0x11344e(0x35a))['addEventListener'](_0x11344e(0xb2b),()=>{const _0x4a7eaf=_0x11344e;_0x53b5f2['classList'][_0x4a7eaf(0x2d4)]('visible'),_0x2c46d1=![];}),_0xc81f54[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x17520f=_0x11344e;_0xc81f54[_0x17520f(0x1276)][_0x17520f(0xe13)](_0x17520f(0xdf6)),_0x1d15b1[_0x17520f(0x1276)][_0x17520f(0x2d4)]('active'),_0x1aa11e[_0x17520f(0x1284)][_0x17520f(0x11d9)]=_0x17520f(0x1ea),_0x80decf[_0x17520f(0x1284)][_0x17520f(0x11d9)]='none';}),_0x1d15b1[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x43adc3=_0x11344e;_0x1d15b1[_0x43adc3(0x1276)][_0x43adc3(0xe13)]('active'),_0xc81f54[_0x43adc3(0x1276)][_0x43adc3(0x2d4)]('active'),_0x80decf[_0x43adc3(0x1284)]['display']=_0x43adc3(0x1ea),_0x1aa11e[_0x43adc3(0x1284)][_0x43adc3(0x11d9)]=_0x43adc3(0xbf2);}),document[_0x11344e(0x53a)](_0x11344e(0xf8e))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x3dcf72=_0x11344e;if(!_0x53d851[_0x3dcf72(0x13be)])return;const _0x186158=_0x53d851['chats'][_0x53d851[_0x3dcf72(0x13be)]],_0x441eae=await _0x355fc0('清空聊天记录',_0x3dcf72(0x286),{'confirmButtonClass':_0x3dcf72(0x264)});_0x441eae&&(_0x186158[_0x3dcf72(0xe83)]=[],_0x186158[_0x3dcf72(0x13cb)]=_0x3dcf72(0x95d),_0x186158['randomJottings']='...',await _0xa62efb[_0x3dcf72(0xaa3)]['put'](_0x186158),_0x60f53f(_0x53d851[_0x3dcf72(0x13be)]),_0x5001a4(),_0x26c3ed[_0x3dcf72(0x1276)][_0x3dcf72(0x2d4)](_0x3dcf72(0xaef)));});const _0x90b0da=(_0x3a1c9c,_0x447a30)=>{const _0x18af46=_0x11344e;document[_0x18af46(0x53a)](_0x3a1c9c)[_0x18af46(0x1086)](_0x18af46(0x325),async _0x20b2cf=>{const _0x383059=_0x18af46,_0x50684e=_0x20b2cf[_0x383059(0x9c2)][_0x383059(0x1413)][0x0];if(_0x50684e){const _0x3ab4c7=await new Promise((_0x375efe,_0x171bd5)=>{const _0x33eb77=_0x383059,_0x2254ba=new FileReader();_0x2254ba[_0x33eb77(0x110f)]=()=>_0x375efe(_0x2254ba[_0x33eb77(0xa2a)]),_0x2254ba[_0x33eb77(0xdcc)]=()=>_0x171bd5(_0x2254ba[_0x33eb77(0x617)]),_0x2254ba[_0x33eb77(0x13b6)](_0x50684e);});_0x447a30(_0x3ab4c7),_0x20b2cf[_0x383059(0x9c2)][_0x383059(0x11a2)]=null;}});};_0x90b0da(_0x11344e(0x819),_0x1126a7=>document[_0x11344e(0x53a)](_0x11344e(0xf45))[_0x11344e(0x7ff)]=_0x1126a7),_0x90b0da('my-avatar-input',_0x42caa5=>document['getElementById']('my-avatar-preview')[_0x11344e(0x7ff)]=_0x42caa5),_0x90b0da(_0x11344e(0xeae),_0x1c41b7=>document[_0x11344e(0x53a)](_0x11344e(0x4b7))[_0x11344e(0x7ff)]=_0x1c41b7),_0x90b0da(_0x11344e(0x90a),_0x77a627=>document[_0x11344e(0x53a)](_0x11344e(0xa53))[_0x11344e(0x7ff)]=_0x77a627),_0x90b0da(_0x11344e(0x12a8),_0xa8c35d=>{const _0x2d69ea=_0x11344e;if(_0x53d851[_0x2d69ea(0x13be)]){_0x53d851[_0x2d69ea(0xaa3)][_0x53d851[_0x2d69ea(0x13be)]][_0x2d69ea(0x81e)][_0x2d69ea(0x274)]=_0xa8c35d;const _0x3225c6=document[_0x2d69ea(0x53a)](_0x2d69ea(0x4bf));_0x3225c6[_0x2d69ea(0x7ff)]=_0xa8c35d,_0x3225c6[_0x2d69ea(0x1284)][_0x2d69ea(0x11d9)]=_0x2d69ea(0x1ea),document[_0x2d69ea(0x53a)](_0x2d69ea(0x13f4))[_0x2d69ea(0x1284)][_0x2d69ea(0x11d9)]=_0x2d69ea(0xbeb);}}),_0x90b0da(_0x11344e(0xff0),_0x34ec9b=>document[_0x11344e(0x53a)](_0x11344e(0xa05))[_0x11344e(0x7ff)]=_0x34ec9b),document[_0x11344e(0x53a)](_0x11344e(0x13f4))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x5eeffd=_0x11344e;if(_0x53d851[_0x5eeffd(0x13be)]){_0x53d851[_0x5eeffd(0xaa3)][_0x53d851[_0x5eeffd(0x13be)]][_0x5eeffd(0x81e)][_0x5eeffd(0x274)]='';const _0x3e8ac3=document['getElementById'](_0x5eeffd(0x4bf));_0x3e8ac3[_0x5eeffd(0x7ff)]='',_0x3e8ac3[_0x5eeffd(0x1284)]['display']=_0x5eeffd(0xbf2),document[_0x5eeffd(0x53a)](_0x5eeffd(0x13f4))[_0x5eeffd(0x1284)][_0x5eeffd(0x11d9)]=_0x5eeffd(0xbf2);}});const _0x40983a=document[_0x11344e(0x53a)](_0x11344e(0x6e0));document[_0x11344e(0x53a)]('open-sticker-panel-btn')['addEventListener']('click',()=>{const _0x454732=_0x11344e,_0x42b5b1=_0x53d851['chats'][_0x53d851[_0x454732(0x13be)]];_0x42b5b1&&_0x42b5b1[_0x454732(0x81e)][_0x454732(0x141b)]?_0x2d0790=_0x42b5b1[_0x454732(0x81e)][_0x454732(0x141b)]:_0x2d0790='all',_0x590e2b(),_0x40983a[_0x454732(0x1276)][_0x454732(0xe13)](_0x454732(0xaef));}),document['getElementById']('close-sticker-panel-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>_0x40983a[_0x11344e(0x1276)]['remove']('visible')),document[_0x11344e(0x53a)](_0x11344e(0x134e))['addEventListener']('click',_0x1845f6),document[_0x11344e(0x53a)](_0x11344e(0xf44))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>document[_0x11344e(0x53a)](_0x11344e(0xfce))[_0x11344e(0xb2b)]()),document[_0x11344e(0x53a)]('sticker-upload-input')[_0x11344e(0x1086)](_0x11344e(0x325),async _0x527c8e=>{const _0x2e0872=_0x11344e,_0x1f387e=_0x527c8e[_0x2e0872(0x9c2)][_0x2e0872(0x1413)][0x0];if(!_0x1f387e)return;const _0x1b9b6d=new FileReader();_0x1b9b6d['readAsDataURL'](_0x1f387e),_0x1b9b6d[_0x2e0872(0x110f)]=async()=>{const _0x57bae1=_0x2e0872,_0x80cb2=_0x1b9b6d[_0x57bae1(0xa2a)],_0x27d3f8=await _0x4f6537(_0x57bae1(0x8af),'请为这个表情命名\x20(例如：好耶、疑惑)');if(_0x27d3f8&&_0x27d3f8[_0x57bae1(0x13bc)]()){const _0x427230={'id':_0x57bae1(0x99e)+Date['now'](),'url':_0x80cb2,'name':_0x27d3f8[_0x57bae1(0x13bc)](),'categoryId':_0x2d0790!=='all'&&_0x2d0790!=='uncategorized'?_0x2d0790:null};await _0xa62efb[_0x57bae1(0xf8f)][_0x57bae1(0xe13)](_0x427230),_0x53d851['userStickers'][_0x57bae1(0x7dd)](_0x427230),_0x590e2b();}else{if(_0x27d3f8!==null)alert(_0x57bae1(0xc49));}},_0x527c8e[_0x2e0872(0x9c2)][_0x2e0872(0x11a2)]=null;}),document[_0x11344e(0x53a)](_0x11344e(0x441))['addEventListener'](_0x11344e(0xb2b),()=>document[_0x11344e(0x53a)](_0x11344e(0xab2))['click']()),document[_0x11344e(0x53a)](_0x11344e(0xab2))['addEventListener'](_0x11344e(0x325),async _0x393aa7=>{const _0xab104e=_0x11344e,_0x4b598f=_0x393aa7[_0xab104e(0x9c2)][_0xab104e(0x1413)][0x0];if(!_0x4b598f||!_0x53d851[_0xab104e(0x13be)])return;const _0x2ab435=new FileReader();_0x2ab435[_0xab104e(0x110f)]=async _0x256392=>{const _0x1bc206=_0xab104e,_0x439be5=_0x256392[_0x1bc206(0x9c2)][_0x1bc206(0xa2a)],_0x544a9e=_0x53d851[_0x1bc206(0xaa3)][_0x53d851[_0x1bc206(0x13be)]],_0xc20b81={'role':'user','content':[{'type':_0x1bc206(0xc40),'image_url':{'url':_0x439be5}}],'timestamp':Date['now']()};_0x544a9e[_0x1bc206(0xe83)][_0x1bc206(0x7dd)](_0xc20b81),await _0xa62efb['chats'][_0x1bc206(0x546)](_0x544a9e),_0xa4d65(_0xc20b81,_0x544a9e),_0x5001a4();},_0x2ab435[_0xab104e(0x13b6)](_0x4b598f),_0x393aa7[_0xab104e(0x9c2)][_0xab104e(0x11a2)]=null;}),document[_0x11344e(0x53a)](_0x11344e(0x755))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x16eeda=_0x11344e;if(!_0x53d851[_0x16eeda(0x13be)])return;const _0x5f79c8=await _0x4f6537(_0x16eeda(0x344),'请输入你想说的内容：');if(_0x5f79c8&&_0x5f79c8['trim']()){const _0x34cc79=_0x53d851[_0x16eeda(0xaa3)][_0x53d851[_0x16eeda(0x13be)]],_0x4aac7d={'role':_0x16eeda(0x10ae),'type':'voice_message','content':_0x5f79c8[_0x16eeda(0x13bc)](),'timestamp':Date['now']()};_0x34cc79['history'][_0x16eeda(0x7dd)](_0x4aac7d),await _0xa62efb[_0x16eeda(0xaa3)][_0x16eeda(0x546)](_0x34cc79),_0xa4d65(_0x4aac7d,_0x34cc79),_0x5001a4();}}),document['getElementById'](_0x11344e(0xbbc))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x5611ae=_0x11344e;if(!_0x53d851[_0x5611ae(0x13be)])return;const _0x40dfa8=await _0x4f6537(_0x5611ae(0x48a),_0x5611ae(0x8e5));if(_0x40dfa8&&_0x40dfa8[_0x5611ae(0x13bc)]()){const _0x6f23c7=_0x53d851[_0x5611ae(0xaa3)][_0x53d851[_0x5611ae(0x13be)]],_0x5ed189={'role':_0x5611ae(0x10ae),'type':_0x5611ae(0x1053),'content':_0x40dfa8['trim'](),'timestamp':Date[_0x5611ae(0x9c1)]()};_0x6f23c7[_0x5611ae(0xe83)]['push'](_0x5ed189),await _0xa62efb[_0x5611ae(0xaa3)][_0x5611ae(0x546)](_0x6f23c7),_0xa4d65(_0x5ed189,_0x6f23c7),_0x5001a4();}});const _0x3c0e63=document[_0x11344e(0x53a)](_0x11344e(0xfb2));document[_0x11344e(0x53a)](_0x11344e(0x76a))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x378662=_0x11344e;_0x3c0e63[_0x378662(0x1276)][_0x378662(0xe13)](_0x378662(0xaef));}),_0x3c0e63[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x2151d0=>{const _0x5819f4=_0x11344e;_0x2151d0[_0x5819f4(0x9c2)]===_0x3c0e63&&_0x3c0e63[_0x5819f4(0x1276)][_0x5819f4(0x2d4)]('visible');}),document[_0x11344e(0x53a)]('waimai-order-for-ai-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x452481),document['getElementById'](_0x11344e(0x61c))['addEventListener'](_0x11344e(0xb2b),async()=>{const _0x1933fe=_0x11344e;if(!_0x53d851[_0x1933fe(0x13be)])return;const _0x522da3=document[_0x1933fe(0x53a)](_0x1933fe(0x9fd)),_0x507c02=document['getElementById'](_0x1933fe(0xe10)),_0x419113=_0x522da3[_0x1933fe(0x11a2)][_0x1933fe(0x13bc)](),_0x21787f=parseFloat(_0x507c02[_0x1933fe(0x11a2)]);if(!_0x419113||isNaN(_0x21787f)||_0x21787f<=0x0){alert(_0x1933fe(0x4f6));return;}const _0x1be21e=_0x53d851['chats'][_0x53d851[_0x1933fe(0x13be)]],_0x1becc5=Date['now'](),_0x39a686=_0x1be21e['isGroup']?_0x1be21e[_0x1933fe(0x81e)][_0x1933fe(0x1303)]||'我':'我',_0xec5953={'role':'user','senderName':_0x39a686,'type':'waimai_request','productInfo':_0x419113,'amount':_0x21787f,'status':_0x1933fe(0x43a),'countdownEndTime':_0x1becc5+0xf*0x3c*0x3e8,'timestamp':_0x1becc5};_0x1be21e[_0x1933fe(0xe83)][_0x1933fe(0x7dd)](_0xec5953),await _0xa62efb[_0x1933fe(0xaa3)]['put'](_0x1be21e),_0xa4d65(_0xec5953,_0x1be21e),_0x5001a4(),_0x522da3[_0x1933fe(0x11a2)]='',_0x507c02['value']='',_0x3c0e63[_0x1933fe(0x1276)][_0x1933fe(0x2d4)](_0x1933fe(0xaef));}),document['getElementById'](_0x11344e(0x868))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x14b870),document[_0x11344e(0x53a)](_0x11344e(0xe33))['addEventListener'](_0x11344e(0xb2b),_0x3d9862),document[_0x11344e(0x53a)](_0x11344e(0x118c))[_0x11344e(0x1086)]('click',_0x1158a0),document[_0x11344e(0x53a)](_0x11344e(0xc60))['addEventListener'](_0x11344e(0xb2b),_0x5c7035),document[_0x11344e(0x53a)](_0x11344e(0x737))[_0x11344e(0x1086)]('click',_0xcf3fd5),document['getElementById'](_0x11344e(0x11bb))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x36ec0a),document['getElementById'](_0x11344e(0x96d))[_0x11344e(0x1086)]('click',_0x19f093),document['getElementById'](_0x11344e(0xc8b))['addEventListener'](_0x11344e(0xb2b),_0x2b4d91),document[_0x11344e(0x53a)](_0x11344e(0x11b9))[_0x11344e(0x1086)]('click',_0x3c73fa),document[_0x11344e(0x53a)](_0x11344e(0xff1))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x15c5ba=_0x11344e;if(_0x373402[_0x15c5ba(0x38e)]===0x0)return;const _0x518e4a=await _0x355fc0(_0x15c5ba(0xccc),_0x15c5ba(0x269)+_0x373402[_0x15c5ba(0x38e)]+_0x15c5ba(0x11ba),{'confirmButtonClass':'btn-danger'});if(_0x518e4a){const _0x464163=_0x53d851[_0x15c5ba(0xaa3)][_0x53d851[_0x15c5ba(0x13be)]];let _0x59af0a=[];for(const _0x127ac7 of _0x373402){const _0xdfc8ef=_0x464163[_0x15c5ba(0xe83)][_0x15c5ba(0x397)](_0x30f6e4=>_0x30f6e4[_0x15c5ba(0x827)]===_0x127ac7);_0xdfc8ef&&_0xdfc8ef[_0x15c5ba(0x919)]===_0x15c5ba(0xf2e)&&_0x59af0a[_0x15c5ba(0x7dd)]('关于“'+_0xdfc8ef[_0x15c5ba(0xd1d)]+'”的投票(时间戳:\x20'+_0xdfc8ef['timestamp']+')');}_0x464163[_0x15c5ba(0xe83)]=_0x464163['history']['filter'](_0x1884d9=>!_0x373402[_0x15c5ba(0x11af)](_0x1884d9[_0x15c5ba(0x827)]));let _0x44d4ce=_0x15c5ba(0x1114);_0x59af0a[_0x15c5ba(0x29d)]>0x0&&(_0x44d4ce+=_0x15c5ba(0x45e)+_0x59af0a['join']('；')+'。');_0x44d4ce+=_0x15c5ba(0x5dc);const _0x5d130c={'role':_0x15c5ba(0xab3),'content':'[系统提示：'+_0x44d4ce+']','timestamp':Date[_0x15c5ba(0x9c1)](),'isHidden':!![]};_0x464163[_0x15c5ba(0xe83)][_0x15c5ba(0x7dd)](_0x5d130c),await _0xa62efb[_0x15c5ba(0xaa3)]['put'](_0x464163),_0x60f53f(_0x53d851[_0x15c5ba(0x13be)]),_0x5001a4();}}),document[_0x11344e(0x53a)](_0x11344e(0x78a))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x4bb8a0=_0x11344e;if(_0x373402[_0x4bb8a0(0x38e)]===0x0)return;const _0x3b1511=await _0x355fc0(_0x4bb8a0(0x427),'这将从历史记录中【永久抹除】这\x20'+_0x373402['size']+'\x20条消息，AI将完全遗忘它们的存在。确定吗？',{'confirmButtonClass':'btn-danger','confirmText':'确认抹除'});if(_0x3b1511){const _0x2b50c7=_0x53d851[_0x4bb8a0(0xaa3)][_0x53d851[_0x4bb8a0(0x13be)]];_0x2b50c7[_0x4bb8a0(0xe83)]=_0x2b50c7[_0x4bb8a0(0xe83)][_0x4bb8a0(0x2dd)](_0x422598=>!_0x373402[_0x4bb8a0(0x11af)](_0x422598[_0x4bb8a0(0x827)])),await _0xa62efb[_0x4bb8a0(0xaa3)][_0x4bb8a0(0x546)](_0x2b50c7),_0x60f53f(_0x53d851[_0x4bb8a0(0x13be)]),_0x5001a4();}});const _0x22b53a=document[_0x11344e(0x53a)](_0x11344e(0x9a2));_0x22b53a[_0x11344e(0x1086)](_0x11344e(0x1174),()=>_0x281d80(_0x22b53a[_0x11344e(0x11a2)][_0x11344e(0x13bc)](),!![])),document['getElementById'](_0x11344e(0x126d))[_0x11344e(0x1086)]('click',async()=>{const _0x4f767a=_0x11344e,_0x46674c=_0x22b53a[_0x4f767a(0x11a2)][_0x4f767a(0x13bc)]();if(!_0x46674c){alert(_0x4f767a(0x9dd));return;}_0x281d80(_0x46674c,![]),_0x53d851[_0x4f767a(0x906)]['fontUrl']=_0x46674c,await _0xa62efb[_0x4f767a(0x906)]['put'](_0x53d851[_0x4f767a(0x906)]),alert('字体已保存并应用！');}),document[_0x11344e(0x53a)](_0x11344e(0xc80))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x4c23a4),document['querySelectorAll']('#chat-list-bottom-nav\x20.nav-item')['forEach'](_0x1c020f=>{const _0xa58c9a=_0x11344e;_0x1c020f[_0xa58c9a(0x1086)]('click',()=>_0x4001e6(_0x1c020f[_0xa58c9a(0x999)][_0xa58c9a(0x42e)]));}),document[_0x11344e(0x53a)]('qzone-back-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>_0x4001e6(_0x11344e(0x411))),document[_0x11344e(0x53a)](_0x11344e(0xe30))['addEventListener'](_0x11344e(0xb2b),async()=>{const _0x35c10c=_0x11344e,_0x453897=await _0x4f6537(_0x35c10c(0x10b9),'请输入新的昵称',_0x53d851[_0x35c10c(0xa74)]['nickname']);_0x453897&&_0x453897[_0x35c10c(0x13bc)]()&&(_0x53d851[_0x35c10c(0xa74)][_0x35c10c(0x1005)]=_0x453897[_0x35c10c(0x13bc)](),await _0x2bd11e(),_0x489bd7());}),document[_0x11344e(0x53a)](_0x11344e(0x1202))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>document[_0x11344e(0x53a)](_0x11344e(0xf6a))[_0x11344e(0xb2b)]()),document[_0x11344e(0x53a)](_0x11344e(0x6c2))['addEventListener'](_0x11344e(0xb2b),()=>document[_0x11344e(0x53a)]('qzone-banner-input')['click']()),document[_0x11344e(0x53a)]('qzone-avatar-input')[_0x11344e(0x1086)](_0x11344e(0x325),async _0x2162b5=>{const _0x35573a=_0x11344e,_0x4d5df4=_0x2162b5[_0x35573a(0x9c2)]['files'][0x0];if(_0x4d5df4){const _0x304db6=await new Promise(_0x4f0d67=>{const _0x210ec7=_0x35573a,_0x1b8804=new FileReader();_0x1b8804['onload']=()=>_0x4f0d67(_0x1b8804[_0x210ec7(0xa2a)]),_0x1b8804['readAsDataURL'](_0x4d5df4);});_0x53d851['qzoneSettings'][_0x35573a(0x8cd)]=_0x304db6,await _0x2bd11e(),_0x489bd7();}_0x2162b5[_0x35573a(0x9c2)][_0x35573a(0x11a2)]=null;}),document['getElementById'](_0x11344e(0x464))[_0x11344e(0x1086)](_0x11344e(0x325),async _0x54700a=>{const _0x1ddf59=_0x11344e,_0x17f759=_0x54700a['target']['files'][0x0];if(_0x17f759){const _0x23522b=await new Promise(_0x4092ae=>{const _0xa870ee=_0x55b8,_0x1d1a9b=new FileReader();_0x1d1a9b[_0xa870ee(0x110f)]=()=>_0x4092ae(_0x1d1a9b['result']),_0x1d1a9b[_0xa870ee(0x13b6)](_0x17f759);});_0x53d851[_0x1ddf59(0xa74)][_0x1ddf59(0xb72)]=_0x23522b,await _0x2bd11e(),_0x489bd7();}_0x54700a['target'][_0x1ddf59(0x11a2)]=null;}),document['getElementById'](_0x11344e(0xbf0))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x3835e6=_0x11344e;_0x1c899c();const _0x38b95f=document[_0x3835e6(0x53a)](_0x3835e6(0x1056));_0x38b95f[_0x3835e6(0x999)]['mode']=_0x3835e6(0x12c5),_0x38b95f['querySelector'](_0x3835e6(0x112d))[_0x3835e6(0x1284)]['display']=_0x3835e6(0xbf2),_0x38b95f[_0x3835e6(0x139c)](_0x3835e6(0x597))[_0x3835e6(0x1284)]['display']=_0x3835e6(0xbf2),_0x38b95f['querySelector'](_0x3835e6(0x66d))[_0x3835e6(0x1284)][_0x3835e6(0x11d9)]=_0x3835e6(0xbf2),_0x38b95f['querySelector'](_0x3835e6(0x13db))[_0x3835e6(0x140d)]=_0x3835e6(0x954);const _0x4ac9c1=document[_0x3835e6(0x53a)](_0x3835e6(0x7fb));_0x4ac9c1[_0x3835e6(0xaac)]='';const _0x3123b6=await _0xa62efb[_0x3835e6(0x443)]['toArray']();_0x3123b6[_0x3835e6(0x29d)]>0x0?_0x3123b6[_0x3835e6(0xeaf)](_0x435aeb=>{const _0x4406e3=_0x3835e6,_0x16980f=document['createElement']('label');_0x16980f[_0x4406e3(0x1284)][_0x4406e3(0x11d9)]=_0x4406e3(0x1ea),_0x16980f[_0x4406e3(0xaac)]='<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22'+_0x435aeb['id']+_0x4406e3(0x127a)+_0x435aeb[_0x4406e3(0x234)],_0x4ac9c1['appendChild'](_0x16980f);}):_0x4ac9c1[_0x3835e6(0xaac)]=_0x3835e6(0x86f),_0x38b95f[_0x3835e6(0x1276)][_0x3835e6(0xe13)](_0x3835e6(0xaef));}),document[_0x11344e(0x53a)](_0x11344e(0x13e7))[_0x11344e(0x1086)]('click',async()=>{const _0x1f2ef9=_0x11344e;_0x1c899c();const _0x5c9616=document[_0x1f2ef9(0x53a)](_0x1f2ef9(0x1056));_0x5c9616[_0x1f2ef9(0x999)]['mode']=_0x1f2ef9(0x4fd),_0x5c9616[_0x1f2ef9(0x139c)](_0x1f2ef9(0x112d))['style'][_0x1f2ef9(0x11d9)]=_0x1f2ef9(0x2f6),_0x5c9616[_0x1f2ef9(0x139c)]('#image-mode-content')['classList'][_0x1f2ef9(0xe13)](_0x1f2ef9(0xdf6)),_0x5c9616[_0x1f2ef9(0x139c)](_0x1f2ef9(0x66d))[_0x1f2ef9(0x1276)][_0x1f2ef9(0x2d4)](_0x1f2ef9(0xdf6)),_0x5c9616[_0x1f2ef9(0x139c)](_0x1f2ef9(0x13db))[_0x1f2ef9(0x140d)]=_0x1f2ef9(0x1253);const _0x28e74b=document[_0x1f2ef9(0x53a)](_0x1f2ef9(0x7fb));_0x28e74b[_0x1f2ef9(0xaac)]='';const _0x4247d1=await _0xa62efb[_0x1f2ef9(0x443)][_0x1f2ef9(0xa73)]();_0x4247d1[_0x1f2ef9(0x29d)]>0x0?_0x4247d1[_0x1f2ef9(0xeaf)](_0x5761e3=>{const _0x11f4ec=_0x1f2ef9,_0x4b3ba1=document[_0x11f4ec(0xd67)](_0x11f4ec(0xc81));_0x4b3ba1['style'][_0x11f4ec(0x11d9)]='block',_0x4b3ba1[_0x11f4ec(0xaac)]=_0x11f4ec(0x335)+_0x5761e3['id']+_0x11f4ec(0x127a)+_0x5761e3[_0x11f4ec(0x234)],_0x28e74b[_0x11f4ec(0x133d)](_0x4b3ba1);}):_0x28e74b[_0x1f2ef9(0xaac)]=_0x1f2ef9(0x86f),_0x5c9616[_0x1f2ef9(0x1276)][_0x1f2ef9(0xe13)](_0x1f2ef9(0xaef));}),document['getElementById'](_0x11344e(0x9a6))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x2e2a7b=_0x11344e;await _0x4a3063(),_0x541a81(_0x2e2a7b(0x638));}),document[_0x11344e(0x53a)](_0x11344e(0xe78))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x20647e=_0x11344e;_0x541a81(_0x20647e(0xbca)),_0x4001e6('qzone-screen');}),document[_0x11344e(0x53a)](_0x11344e(0x77a))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0xa41216=_0x11344e;_0x53d851[_0xa41216(0x96b)]=null,_0x541a81(_0xa41216(0x638));}),document[_0x11344e(0x53a)](_0x11344e(0x307))['addEventListener']('click',()=>document[_0x11344e(0x53a)](_0x11344e(0x310))['click']()),document['getElementById'](_0x11344e(0x310))[_0x11344e(0x1086)](_0x11344e(0x325),async _0x4a9868=>{const _0xf56112=_0x11344e;if(!_0x53d851[_0xf56112(0x96b)])return;const _0x44f969=_0x4a9868[_0xf56112(0x9c2)][_0xf56112(0x1413)];if(!_0x44f969[_0xf56112(0x29d)])return;const _0x5d7f65=await _0xa62efb[_0xf56112(0x7a3)][_0xf56112(0x883)](_0x53d851['activeAlbumId']);for(const _0x2c872f of _0x44f969){const _0x7e1c7e=await new Promise(_0xa94b92=>{const _0xb9696c=_0xf56112,_0x104fa8=new FileReader();_0x104fa8[_0xb9696c(0x110f)]=()=>_0xa94b92(_0x104fa8[_0xb9696c(0xa2a)]),_0x104fa8[_0xb9696c(0x13b6)](_0x2c872f);});await _0xa62efb[_0xf56112(0x1272)][_0xf56112(0xe13)]({'albumId':_0x53d851['activeAlbumId'],'url':_0x7e1c7e,'createdAt':Date[_0xf56112(0x9c1)]()});}const _0x3dd4f2=await _0xa62efb[_0xf56112(0x1272)][_0xf56112(0x57e)](_0xf56112(0x814))[_0xf56112(0x12f6)](_0x53d851[_0xf56112(0x96b)])['count'](),_0x357f79={'photoCount':_0x3dd4f2};if(!_0x5d7f65[_0xf56112(0x721)]||_0x5d7f65[_0xf56112(0x108e)][_0xf56112(0x6e9)](_0xf56112(0x140d))){const _0x2e4774=await _0xa62efb[_0xf56112(0x1272)][_0xf56112(0x57e)](_0xf56112(0x814))[_0xf56112(0x12f6)](_0x53d851[_0xf56112(0x96b)])[_0xf56112(0x7e6)]();if(_0x2e4774)_0x357f79['coverUrl']=_0x2e4774[_0xf56112(0xb36)];}await _0xa62efb[_0xf56112(0x7a3)]['update'](_0x53d851[_0xf56112(0x96b)],_0x357f79),await _0x384a29(),await _0x4a3063(),_0x4a9868[_0xf56112(0x9c2)][_0xf56112(0x11a2)]=null,alert(_0xf56112(0x2ee));}),document['getElementById'](_0x11344e(0x13fb))[_0x11344e(0x1086)]('click',async _0x3d3527=>{const _0x589a9c=_0x11344e,_0x51b734=_0x3d3527[_0x589a9c(0x9c2)]['closest'](_0x589a9c(0xf2a)),_0x35b4f7=_0x3d3527[_0x589a9c(0x9c2)][_0x589a9c(0x106f)](_0x589a9c(0xc00));if(_0x51b734){_0x3d3527[_0x589a9c(0xecc)]();const _0x1130d2=parseInt(_0x51b734[_0x589a9c(0x999)][_0x589a9c(0x50e)]),_0x387eee=await _0x355fc0(_0x589a9c(0x6c7),_0x589a9c(0x12fa),{'confirmButtonClass':'btn-danger'});if(_0x387eee){const _0x156b9c=await _0xa62efb[_0x589a9c(0x1272)][_0x589a9c(0x883)](_0x1130d2);if(!_0x156b9c)return;await _0xa62efb['qzonePhotos'][_0x589a9c(0x121e)](_0x1130d2);const _0x254c64=await _0xa62efb[_0x589a9c(0x7a3)][_0x589a9c(0x883)](_0x53d851[_0x589a9c(0x96b)]),_0x3c8197=(_0x254c64[_0x589a9c(0x721)]||0x1)-0x1,_0x2722be={'photoCount':_0x3c8197};if(_0x254c64[_0x589a9c(0x108e)]===_0x156b9c[_0x589a9c(0xb36)]){const _0x346af7=await _0xa62efb['qzonePhotos'][_0x589a9c(0x57e)]('albumId')[_0x589a9c(0x12f6)](_0x53d851[_0x589a9c(0x96b)])['first']();_0x2722be['coverUrl']=_0x346af7?_0x346af7[_0x589a9c(0xb36)]:_0x589a9c(0xca7);}await _0xa62efb[_0x589a9c(0x7a3)][_0x589a9c(0xc03)](_0x53d851['activeAlbumId'],_0x2722be),await _0x384a29(),await _0x4a3063(),alert(_0x589a9c(0x2bd));}}else _0x35b4f7&&_0x58d1df(_0x35b4f7[_0x589a9c(0x7ff)]);}),document[_0x11344e(0x53a)](_0x11344e(0x13c1))['addEventListener'](_0x11344e(0xb2b),_0x20ef11),document['getElementById'](_0x11344e(0x614))[_0x11344e(0x1086)]('click',_0xed7e51),document[_0x11344e(0x53a)](_0x11344e(0x108c))[_0x11344e(0x1086)]('click',_0x67bb9e),document['addEventListener'](_0x11344e(0xfd9),_0x2f8d3e=>{const _0x1eef02=_0x11344e;if(!_0x21503a[_0x1eef02(0xb11)])return;if(_0x2f8d3e['key']===_0x1eef02(0x854))_0xed7e51();else{if(_0x2f8d3e[_0x1eef02(0xf31)]===_0x1eef02(0x2d6))_0x67bb9e();else _0x2f8d3e[_0x1eef02(0xf31)]===_0x1eef02(0x840)&&_0x20ef11();}}),document[_0x11344e(0x53a)](_0x11344e(0x8b0))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x2b6e4a=_0x11344e,_0x43ebec=await _0x4f6537(_0x2b6e4a(0xd66),_0x2b6e4a(0x66f));if(_0x43ebec&&_0x43ebec['trim']()){const _0x342e8e={'name':_0x43ebec[_0x2b6e4a(0x13bc)](),'coverUrl':_0x2b6e4a(0xca7),'photoCount':0x0,'createdAt':Date[_0x2b6e4a(0x9c1)]()};await _0xa62efb[_0x2b6e4a(0x7a3)][_0x2b6e4a(0xe13)](_0x342e8e),await _0x4a3063(),alert(_0x2b6e4a(0x3b4)+_0x43ebec+'\x22\x20创建成功！');}else _0x43ebec!==null&&alert(_0x2b6e4a(0x1109));}),document['getElementById'](_0x11344e(0xdcb))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>document[_0x11344e(0x53a)](_0x11344e(0x1056))[_0x11344e(0x1276)][_0x11344e(0x2d4)](_0x11344e(0xaef))),document[_0x11344e(0x53a)]('post-upload-local-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>document['getElementById'](_0x11344e(0x94b))[_0x11344e(0xb2b)]()),document['getElementById'](_0x11344e(0x94b))['addEventListener']('change',_0x5a26bb=>{const _0x55c980=_0x11344e,_0x28aedc=_0x5a26bb[_0x55c980(0x9c2)][_0x55c980(0x1413)][0x0];if(_0x28aedc){const _0x51c749=new FileReader();_0x51c749[_0x55c980(0x110f)]=_0x205582=>{const _0x21bac6=_0x55c980;document[_0x21bac6(0x53a)](_0x21bac6(0x11d8))[_0x21bac6(0x7ff)]=_0x205582[_0x21bac6(0x9c2)][_0x21bac6(0xa2a)],document['getElementById']('post-image-preview-container')[_0x21bac6(0x1276)][_0x21bac6(0xe13)](_0x21bac6(0xaef)),document[_0x21bac6(0x53a)](_0x21bac6(0x403))[_0x21bac6(0x1284)][_0x21bac6(0x11d9)]='block';},_0x51c749[_0x55c980(0x13b6)](_0x28aedc);}}),document[_0x11344e(0x53a)](_0x11344e(0xb71))['addEventListener'](_0x11344e(0xb2b),async()=>{const _0x2357b6=_0x11344e,_0x5d7259=await _0x4f6537(_0x2357b6(0xdda),_0x2357b6(0x863),'',_0x2357b6(0xb36));_0x5d7259&&(document['getElementById'](_0x2357b6(0x11d8))['src']=_0x5d7259,document[_0x2357b6(0x53a)]('post-image-preview-container')[_0x2357b6(0x1276)][_0x2357b6(0xe13)](_0x2357b6(0xaef)),document[_0x2357b6(0x53a)](_0x2357b6(0x403))[_0x2357b6(0x1284)][_0x2357b6(0x11d9)]=_0x2357b6(0x1ea));}),document[_0x11344e(0x53a)](_0x11344e(0x10df))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>_0x1c899c());const _0x58dc31=document[_0x11344e(0x53a)](_0x11344e(0x4c8)),_0x32bcd4=document[_0x11344e(0x53a)](_0x11344e(0xd92)),_0x2e0f98=document[_0x11344e(0x53a)](_0x11344e(0x6b3)),_0x3960c0=document['getElementById']('text-image-mode-content');_0x58dc31[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x43e86a=_0x11344e;_0x58dc31[_0x43e86a(0x1276)][_0x43e86a(0xe13)](_0x43e86a(0xdf6)),_0x32bcd4['classList']['remove'](_0x43e86a(0xdf6)),_0x2e0f98[_0x43e86a(0x1276)][_0x43e86a(0xe13)](_0x43e86a(0xdf6)),_0x3960c0[_0x43e86a(0x1276)][_0x43e86a(0x2d4)]('active');}),_0x32bcd4[_0x11344e(0x1086)]('click',()=>{const _0x1464dc=_0x11344e;_0x32bcd4[_0x1464dc(0x1276)]['add'](_0x1464dc(0xdf6)),_0x58dc31[_0x1464dc(0x1276)][_0x1464dc(0x2d4)]('active'),_0x3960c0[_0x1464dc(0x1276)][_0x1464dc(0xe13)]('active'),_0x2e0f98[_0x1464dc(0x1276)]['remove'](_0x1464dc(0xdf6));}),document['getElementById']('confirm-create-post-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x4e7ddf=_0x11344e,_0x3e8881=document[_0x4e7ddf(0x53a)]('create-post-modal'),_0x4079e5=_0x3e8881[_0x4e7ddf(0x999)][_0x4e7ddf(0xa82)],_0x100f0a=document[_0x4e7ddf(0x139c)]('input[name=\x22visibility\x22]:checked')[_0x4e7ddf(0x11a2)];let _0x3e0ba8=null;_0x100f0a===_0x4e7ddf(0x6c0)&&(_0x3e0ba8=Array['from'](document[_0x4e7ddf(0xc3d)]('input[name=\x22visibility_group\x22]:checked'))[_0x4e7ddf(0xcb4)](_0x1d191f=>parseInt(_0x1d191f['value'])));let _0x4056e0={};const _0x2e2bb4={'timestamp':Date[_0x4e7ddf(0x9c1)](),'authorId':_0x4e7ddf(0x10ae),'visibleGroupIds':_0x3e0ba8};if(_0x4079e5===_0x4e7ddf(0x12c5)){const _0x4e3d9b=document[_0x4e7ddf(0x53a)](_0x4e7ddf(0xdf5))[_0x4e7ddf(0x11a2)][_0x4e7ddf(0x13bc)]();if(!_0x4e3d9b){alert(_0x4e7ddf(0x10cb));return;}_0x4056e0={..._0x2e2bb4,'type':_0x4e7ddf(0x12c5),'content':_0x4e3d9b};}else{const _0x49cd78=document[_0x4e7ddf(0x53a)](_0x4e7ddf(0xdf5))[_0x4e7ddf(0x11a2)][_0x4e7ddf(0x13bc)](),_0x9555c5=document[_0x4e7ddf(0x53a)](_0x4e7ddf(0x6b3))[_0x4e7ddf(0x1276)][_0x4e7ddf(0x6a3)](_0x4e7ddf(0xdf6));if(_0x9555c5){const _0x2db1c=document[_0x4e7ddf(0x53a)](_0x4e7ddf(0x11d8))[_0x4e7ddf(0x7ff)],_0x36cc7a=document[_0x4e7ddf(0x53a)](_0x4e7ddf(0xe1b))['value']['trim']();if(!_0x2db1c||!(_0x2db1c[_0x4e7ddf(0x1200)]('http')||_0x2db1c[_0x4e7ddf(0x1200)](_0x4e7ddf(0xc95)))){alert(_0x4e7ddf(0xd39));return;}if(!_0x36cc7a){alert(_0x4e7ddf(0x404));return;}_0x4056e0={..._0x2e2bb4,'type':'image_post','publicText':_0x49cd78,'imageUrl':_0x2db1c,'imageDescription':_0x36cc7a};}else{const _0x4825ea=document[_0x4e7ddf(0x53a)]('post-hidden-text')['value']['trim']();if(!_0x4825ea){alert(_0x4e7ddf(0x11e8));return;}_0x4056e0={..._0x2e2bb4,'type':'text_image','publicText':_0x49cd78,'hiddenContent':_0x4825ea};}}const _0x22c934=await _0xa62efb[_0x4e7ddf(0xfc2)][_0x4e7ddf(0xe13)](_0x4056e0);let _0x5abbf6=_0x4056e0[_0x4e7ddf(0x73e)]||_0x4056e0[_0x4e7ddf(0x678)]||_0x4056e0['imageDescription']||_0x4056e0[_0x4e7ddf(0x319)]||_0x4e7ddf(0xc83);_0x5abbf6=_0x5abbf6[_0x4e7ddf(0xad6)](0x0,0x32)+(_0x5abbf6[_0x4e7ddf(0x29d)]>0x32?_0x4e7ddf(0x95d):'');for(const _0x44eb4c in _0x53d851[_0x4e7ddf(0xaa3)]){const _0x5b7ab9=_0x53d851[_0x4e7ddf(0xaa3)][_0x44eb4c];if(_0x5b7ab9[_0x4e7ddf(0x86e)])continue;let _0x32d213=![];const _0x7edc7a=_0x4056e0[_0x4e7ddf(0x879)];if(!_0x7edc7a||_0x7edc7a[_0x4e7ddf(0x29d)]===0x0)_0x32d213=!![];else _0x5b7ab9['groupId']&&_0x7edc7a[_0x4e7ddf(0x6e9)](_0x5b7ab9['groupId'])&&(_0x32d213=!![]);if(_0x32d213){const _0x9bd2f9={'role':'system','content':'[系统提示：用户刚刚发布了一条动态(ID:\x20'+_0x22c934+')，内容摘要是：“'+_0x5abbf6+_0x4e7ddf(0x345),'timestamp':Date['now'](),'isHidden':!![]};_0x5b7ab9[_0x4e7ddf(0xe83)][_0x4e7ddf(0x7dd)](_0x9bd2f9),await _0xa62efb['chats'][_0x4e7ddf(0x546)](_0x5b7ab9);}}await _0x3679f3(),_0x3e8881[_0x4e7ddf(0x1276)][_0x4e7ddf(0x2d4)]('visible'),alert(_0x4e7ddf(0x324));});const _0x38fc1d=document[_0x11344e(0x53a)]('qzone-posts-list');let _0x18f4a4={'isDragging':![],'startX':0x0,'startY':0x0,'currentX':0x0,'activeContainer':null,'swipeDirection':null,'isClick':!![]};function _0x7e496(_0x2a1074=null){const _0x38db71=_0x11344e;document[_0x38db71(0xc3d)](_0x38db71(0x599))[_0x38db71(0xeaf)](_0x3cc6be=>{const _0x1790d7=_0x38db71;_0x3cc6be!==_0x2a1074&&_0x3cc6be['querySelector']('.qzone-post-item')[_0x1790d7(0x1276)]['remove'](_0x1790d7(0x1043));});}async function _0x134486(_0x48b1f1){const _0xb0b4f6=_0x11344e;_0x48b1f1[_0xb0b4f6(0xecc)]();const _0x331d1c=_0x48b1f1[_0xb0b4f6(0x9c2)],_0x7ffd31=_0x331d1c['closest'](_0xb0b4f6(0xdc3));if(_0x7ffd31){const _0x5f2353=_0x7ffd31[_0xb0b4f6(0x106f)](_0xb0b4f6(0x599)),_0x25af98=parseInt(_0x5f2353[_0xb0b4f6(0x999)][_0xb0b4f6(0xb09)]),_0x299618=parseInt(_0x7ffd31[_0xb0b4f6(0x999)]['commentIndex']);if(isNaN(_0x25af98)||isNaN(_0x299618))return;const _0x4c15df=_0x2ec44e[_0xb0b4f6(0x397)](_0x3ee752=>_0x3ee752['id']===_0x25af98);if(!_0x4c15df||!_0x4c15df['comments']||!_0x4c15df[_0xb0b4f6(0x11ed)][_0x299618])return;const _0x30d41d=_0x4c15df[_0xb0b4f6(0x11ed)][_0x299618],_0x5f255d=await _0x355fc0(_0xb0b4f6(0x25c),_0xb0b4f6(0x45b),{'confirmButtonClass':'btn-danger'});if(_0x5f255d){_0x4c15df[_0xb0b4f6(0x11ed)]['splice'](_0x299618,0x1),await _0xa62efb[_0xb0b4f6(0xfc2)][_0xb0b4f6(0xc03)](_0x25af98,{'comments':_0x4c15df['comments']});if(_0x30d41d&&_0x30d41d[_0xb0b4f6(0x3a7)]===_0x53d851[_0xb0b4f6(0xa74)][_0xb0b4f6(0x1005)]){console['log'](_0xb0b4f6(0xd28));const _0x6b9153=new Set();_0x4c15df['authorId']!==_0xb0b4f6(0x10ae)&&_0x6b9153[_0xb0b4f6(0xe13)](_0x4c15df[_0xb0b4f6(0xa59)]);if(_0x30d41d[_0xb0b4f6(0x7fc)]){const _0x24c9bd=Object[_0xb0b4f6(0x244)](_0x53d851['chats'])[_0xb0b4f6(0x397)](_0x5c505f=>_0x5c505f['originalName']===_0x30d41d['replyTo']);_0x24c9bd&&_0x6b9153[_0xb0b4f6(0xe13)](_0x24c9bd['id']);}const _0x4f4a38=(_0x4c15df[_0xb0b4f6(0x678)]||_0x4c15df[_0xb0b4f6(0x73e)]||'')[_0xb0b4f6(0xad6)](0x0,0x1e),_0x166e99=_0x53d851[_0xb0b4f6(0xa74)]['nickname'];let _0x16be93;const _0x1fee69=_0x53d851[_0xb0b4f6(0xf8f)][_0xb0b4f6(0x397)](_0x1fdce7=>_0x1fdce7[_0xb0b4f6(0xb36)]===_0x30d41d['text']);if(_0x1fee69)_0x16be93=_0xb0b4f6(0x112a)+_0x166e99+_0xb0b4f6(0xf34)+_0x4f4a38+_0xb0b4f6(0xe57)+_0x1fee69[_0xb0b4f6(0x234)]+'”。';else{if(_0x30d41d['replyTo']){const _0x4a6d90=_0x4b300d(_0x30d41d['replyTo']);_0x16be93='用户\x27'+_0x166e99+_0xb0b4f6(0xf34)+_0x4f4a38+'”下，回复了\x27'+_0x4a6d90+_0xb0b4f6(0x11f7)+_0x30d41d[_0xb0b4f6(0x2e6)]+'”。';}else _0x16be93=_0xb0b4f6(0x112a)+_0x166e99+_0xb0b4f6(0x4cb)+_0x4f4a38+'”，内容是：“'+_0x30d41d[_0xb0b4f6(0x2e6)]+'”。';}const _0x5264b0=_0xb0b4f6(0xd06)+_0x16be93+_0xb0b4f6(0xca9);for(const _0x14e8f7 of _0x6b9153){const _0x52bad3=_0x53d851[_0xb0b4f6(0xaa3)][_0x14e8f7];if(_0x52bad3){const _0x3a3acc=_0x52bad3['history'][_0xb0b4f6(0x29d)];_0x52bad3[_0xb0b4f6(0xe83)]=_0x52bad3['history'][_0xb0b4f6(0x2dd)](_0x524170=>!(_0x524170[_0xb0b4f6(0x1032)]&&_0x524170['role']===_0xb0b4f6(0xab3)&&_0x524170[_0xb0b4f6(0x73e)]===_0x5264b0)),_0x52bad3['history'][_0xb0b4f6(0x29d)]<_0x3a3acc&&(console[_0xb0b4f6(0x1081)](_0xb0b4f6(0x1330)+_0x52bad3[_0xb0b4f6(0x234)]+_0xb0b4f6(0xcc6)),await _0xa62efb[_0xb0b4f6(0xaa3)][_0xb0b4f6(0x546)](_0x52bad3));}}}await _0x462f2e(_0x25af98);}return;}const _0x42740f=_0x331d1c[_0xb0b4f6(0x106f)](_0xb0b4f6(0xd07));if(_0x42740f){const _0x52227c=_0x42740f['closest'](_0xb0b4f6(0x599));if(!_0x52227c)return;const _0x187081=parseInt(_0x52227c['dataset']['postId']);_0x2284f0[_0xb0b4f6(0xb11)]&&_0x2284f0[_0xb0b4f6(0x117a)]===_0x187081?_0x4398f9():_0x2c9c6e(_0x187081,_0x42740f);return;}const _0x2ec0bd=_0x331d1c[_0xb0b4f6(0x106f)](_0xb0b4f6(0x1263));if(_0x2ec0bd){const _0x135358=parseInt(_0x2ec0bd[_0xb0b4f6(0x999)][_0xb0b4f6(0xb09)]),_0xf45777=_0x2ec0bd[_0xb0b4f6(0x999)][_0xb0b4f6(0x65c)],_0x3c6412=_0x2ec0bd[_0xb0b4f6(0x999)][_0xb0b4f6(0xdb7)];if(!_0xf45777||!_0x3c6412||_0xf45777===_0x53d851[_0xb0b4f6(0xa74)][_0xb0b4f6(0x1005)]){_0x1bc9e6(_0x2ec0bd['closest']('.qzone-post-container'));return;}_0x5e91f3={'postId':_0x135358,'replyToName':_0xf45777,'replyToDisplayName':_0x3c6412};const _0x1abe5a=_0x2ec0bd[_0xb0b4f6(0x106f)]('.qzone-post-container'),_0x465dff=_0x1abe5a[_0xb0b4f6(0x139c)](_0xb0b4f6(0xc94));_0x465dff['placeholder']=_0xb0b4f6(0x1399)+_0x3c6412+':',_0x465dff[_0xb0b4f6(0x78d)]();return;}if(_0x331d1c['classList'][_0xb0b4f6(0x6a3)]('post-actions-btn')){const _0x421c52=_0x331d1c[_0xb0b4f6(0x106f)](_0xb0b4f6(0x599));if(_0x421c52&&_0x421c52[_0xb0b4f6(0x999)][_0xb0b4f6(0xb09)])_0x328745(parseInt(_0x421c52[_0xb0b4f6(0x999)][_0xb0b4f6(0xb09)]));return;}if(_0x331d1c[_0xb0b4f6(0xfcc)]==='IMG'&&_0x331d1c[_0xb0b4f6(0x999)][_0xb0b4f6(0x884)]){_0x184397(_0xb0b4f6(0xf01),_0x331d1c[_0xb0b4f6(0x999)][_0xb0b4f6(0x884)][_0xb0b4f6(0x795)](/<br>/g,'\x0a'));return;}const _0x1b4d12=_0x331d1c[_0xb0b4f6(0x106f)](_0xb0b4f6(0x599));if(!_0x1b4d12)return;const _0x58d0fe=parseInt(_0x1b4d12[_0xb0b4f6(0x999)][_0xb0b4f6(0xb09)]);if(isNaN(_0x58d0fe))return;if(_0x331d1c[_0xb0b4f6(0x106f)](_0xb0b4f6(0x92e))){const _0x2f906c=await _0x355fc0(_0xb0b4f6(0xe76),_0xb0b4f6(0x5e5),{'confirmButtonClass':'btn-danger'});_0x2f906c&&(_0x1b4d12[_0xb0b4f6(0x1284)][_0xb0b4f6(0x64c)]='all\x200.3s\x20ease',_0x1b4d12[_0xb0b4f6(0x1284)][_0xb0b4f6(0xd91)]=_0xb0b4f6(0xc6b),_0x1b4d12['style']['opacity']='0',setTimeout(async()=>{const _0x419a66=_0xb0b4f6;await _0xa62efb[_0x419a66(0xfc2)][_0x419a66(0x121e)](_0x58d0fe);const _0x543811=_0x419a66(0x477)+_0x58d0fe+')';for(const _0x1d318a in _0x53d851[_0x419a66(0xaa3)]){const _0x88f1e6=_0x53d851[_0x419a66(0xaa3)][_0x1d318a],_0x140010=_0x88f1e6['history']['length'];_0x88f1e6[_0x419a66(0xe83)]=_0x88f1e6['history'][_0x419a66(0x2dd)](_0x5e75c6=>!(_0x5e75c6['role']===_0x419a66(0xab3)&&_0x5e75c6['content']['includes'](_0x543811)));if(_0x88f1e6['history'][_0x419a66(0x29d)]<_0x140010)await _0xa62efb[_0x419a66(0xaa3)][_0x419a66(0x546)](_0x88f1e6);}await _0x3679f3(),alert(_0x419a66(0xb37));},0x12c));return;}const _0x58c804=_0x331d1c[_0xb0b4f6(0x106f)]('.action-icon');if(_0x58c804){if(_0x58c804[_0xb0b4f6(0x1276)][_0xb0b4f6(0x6a3)](_0xb0b4f6(0x784))){_0x58306e(_0x58d0fe);return;}if(_0x58c804[_0xb0b4f6(0x1276)][_0xb0b4f6(0x6a3)](_0xb0b4f6(0x3bb))){const _0xd88e04=_0x2ec44e[_0xb0b4f6(0x397)](_0x2e74cb=>_0x2e74cb['id']===_0x58d0fe);if(!_0xd88e04)return;if(!_0xd88e04[_0xb0b4f6(0xf52)])_0xd88e04['likes']=[];const _0x201d7d=_0x53d851[_0xb0b4f6(0xa74)][_0xb0b4f6(0x1005)],_0x5057f7=_0xd88e04[_0xb0b4f6(0xf52)][_0xb0b4f6(0x57c)](_0x201d7d);_0x5057f7>-0x1?_0xd88e04[_0xb0b4f6(0xf52)]['splice'](_0x5057f7,0x1):(_0xd88e04[_0xb0b4f6(0xf52)]['push'](_0x201d7d),_0x58c804[_0xb0b4f6(0x1276)][_0xb0b4f6(0xe13)](_0xb0b4f6(0xbc3)),_0x58c804[_0xb0b4f6(0x1086)](_0xb0b4f6(0xe77),()=>_0x58c804[_0xb0b4f6(0x1276)][_0xb0b4f6(0x2d4)](_0xb0b4f6(0xbc3)),{'once':!![]})),await _0xa62efb[_0xb0b4f6(0xfc2)]['update'](_0x58d0fe,{'likes':_0xd88e04[_0xb0b4f6(0xf52)]}),await _0x462f2e(_0x58d0fe);}if(_0x58c804[_0xb0b4f6(0x1276)][_0xb0b4f6(0x6a3)](_0xb0b4f6(0x329))){const _0x22405d=await _0xa62efb[_0xb0b4f6(0xb51)]['where']({'type':_0xb0b4f6(0xc50),'content.id':_0x58d0fe})[_0xb0b4f6(0x7e6)]();if(_0x22405d)await _0xa62efb[_0xb0b4f6(0xb51)]['delete'](_0x22405d['id']),await _0x184397('提示',_0xb0b4f6(0x33c));else{const _0x2e2d19=await _0xa62efb[_0xb0b4f6(0xfc2)]['get'](_0x58d0fe);_0x2e2d19&&(await _0xa62efb[_0xb0b4f6(0xb51)][_0xb0b4f6(0xe13)]({'type':_0xb0b4f6(0xc50),'content':_0x2e2d19,'timestamp':Date[_0xb0b4f6(0x9c1)]()}),await _0x184397('提示',_0xb0b4f6(0x12cf)));}await _0x462f2e(_0x58d0fe);}return;}const _0x22ea85=_0x331d1c['closest'](_0xb0b4f6(0xcb8));if(_0x22ea85){const _0x495522=_0x1b4d12[_0xb0b4f6(0x139c)](_0xb0b4f6(0xc94)),_0x377c54=_0x495522['value'][_0xb0b4f6(0x13bc)]();if(!_0x377c54)return alert('评论内容不能为空哦！');const _0x50baa2=_0x2ec44e[_0xb0b4f6(0x397)](_0xbaf67e=>_0xbaf67e['id']===_0x58d0fe);if(!_0x50baa2)return;if(!_0x50baa2[_0xb0b4f6(0x11ed)])_0x50baa2['comments']=[];const _0x339431={'commenterName':_0x53d851[_0xb0b4f6(0xa74)][_0xb0b4f6(0x1005)],'text':_0x377c54,'timestamp':Date[_0xb0b4f6(0x9c1)](),'replyTo':_0x5e91f3&&_0x5e91f3[_0xb0b4f6(0xb09)]===_0x58d0fe?_0x5e91f3[_0xb0b4f6(0x11a7)]:null};_0x50baa2['comments']['push'](_0x339431),await _0xa62efb[_0xb0b4f6(0xfc2)][_0xb0b4f6(0xc03)](_0x58d0fe,{'comments':_0x50baa2['comments']});let _0x1fad7c=(_0x50baa2[_0xb0b4f6(0x678)]||_0x50baa2[_0xb0b4f6(0x73e)]||'')['substring'](0x0,0x1e);const _0x37c5ee=_0x53d851[_0xb0b4f6(0xa74)][_0xb0b4f6(0x1005)],_0x163805=new Set();if(_0x50baa2[_0xb0b4f6(0xa59)]!==_0xb0b4f6(0x10ae))_0x163805[_0xb0b4f6(0xe13)](_0x50baa2['authorId']);if(_0x339431['replyTo']&&_0x339431[_0xb0b4f6(0x7fc)]!==_0x37c5ee){const _0x343dc2=Object[_0xb0b4f6(0x244)](_0x53d851[_0xb0b4f6(0xaa3)])['find'](_0x2ad6b4=>_0x2ad6b4[_0xb0b4f6(0x543)]===_0x339431[_0xb0b4f6(0x7fc)]);if(_0x343dc2)_0x163805[_0xb0b4f6(0xe13)](_0x343dc2['id']);}for(const _0x4e1a39 of _0x163805){const _0x294136=_0x53d851['chats'][_0x4e1a39];if(_0x294136&&!_0x294136['isGroup']){const _0x347ca0=_0x53d851['userStickers'][_0xb0b4f6(0x397)](_0x4f2e73=>_0x4f2e73[_0xb0b4f6(0xb36)]===_0x377c54);let _0x447dd7=_0x347ca0?'用户\x27'+_0x37c5ee+_0xb0b4f6(0xf34)+_0x1fad7c+_0xb0b4f6(0xe57)+_0x347ca0['name']+'”。':_0x339431[_0xb0b4f6(0x7fc)]?_0xb0b4f6(0x112a)+_0x37c5ee+_0xb0b4f6(0xf34)+_0x1fad7c+_0xb0b4f6(0x5cc)+_0x5e91f3[_0xb0b4f6(0xc6c)]+'\x27的评论，内容是：“'+_0x377c54+'”。':_0xb0b4f6(0x112a)+_0x37c5ee+'\x27刚刚评论了你的动态“'+_0x1fad7c+_0xb0b4f6(0x8f4)+_0x377c54+'”。';const _0x3dde7b={'role':'system','content':_0xb0b4f6(0xd06)+_0x447dd7+'请你对此作出回应。]','timestamp':Date[_0xb0b4f6(0x9c1)](),'isHidden':!![]};_0x294136[_0xb0b4f6(0xe83)][_0xb0b4f6(0x7dd)](_0x3dde7b),await _0xa62efb[_0xb0b4f6(0xaa3)][_0xb0b4f6(0x546)](_0x294136);}}_0x495522[_0xb0b4f6(0x11a2)]='',_0x1bc9e6(_0x1b4d12),await _0x462f2e(_0x58d0fe);return;}}const _0x54d181=_0x35aa40=>{const _0x1ade40=_0x11344e,_0x4a98ab=_0x35aa40[_0x1ade40(0x9c2)];if(_0x4a98ab[_0x1ade40(0x106f)](_0x1ade40(0x4e5)))return;const _0x20419c=_0x35aa40[_0x1ade40(0x9c2)][_0x1ade40(0x106f)]('.qzone-post-container');if(!_0x20419c)return;_0x7e496(_0x20419c),_0x18f4a4['activeContainer']=_0x20419c,_0x18f4a4['isDragging']=!![],_0x18f4a4[_0x1ade40(0x3a2)]=!![],_0x18f4a4['swipeDirection']=null,_0x18f4a4['startX']=_0x35aa40['type'][_0x1ade40(0x6e9)](_0x1ade40(0xd4e))?_0x35aa40['pageX']:_0x35aa40['touches'][0x0][_0x1ade40(0x33b)],_0x18f4a4['startY']=_0x35aa40['type'][_0x1ade40(0x6e9)](_0x1ade40(0xd4e))?_0x35aa40[_0x1ade40(0x977)]:_0x35aa40[_0x1ade40(0xd44)][0x0][_0x1ade40(0x977)],_0x18f4a4['activeContainer'][_0x1ade40(0x139c)](_0x1ade40(0xb35))['style'][_0x1ade40(0x64c)]=_0x1ade40(0xbf2),document[_0x1ade40(0x1086)](_0x1ade40(0xef3),_0x22c377),document[_0x1ade40(0x1086)]('mouseup',_0x362475),document[_0x1ade40(0x1086)](_0x1ade40(0xd22),_0x22c377,{'passive':![]}),document[_0x1ade40(0x1086)]('touchend',_0x362475);},_0x22c377=_0x3b1c6f=>{const _0x17f709=_0x11344e;if(!_0x18f4a4[_0x17f709(0x983)]||!_0x18f4a4[_0x17f709(0xb6d)])return;const _0x198dde=_0x3b1c6f[_0x17f709(0x919)][_0x17f709(0x6e9)](_0x17f709(0xd4e))?_0x3b1c6f[_0x17f709(0x33b)]:_0x3b1c6f['touches'][0x0]['pageX'],_0x177ab5=_0x3b1c6f[_0x17f709(0x919)][_0x17f709(0x6e9)](_0x17f709(0xd4e))?_0x3b1c6f[_0x17f709(0x977)]:_0x3b1c6f[_0x17f709(0xd44)][0x0][_0x17f709(0x977)],_0x49e85d=_0x198dde-_0x18f4a4[_0x17f709(0x58f)],_0x566ebc=_0x177ab5-_0x18f4a4['startY'];_0x18f4a4[_0x17f709(0x3a2)]&&(Math[_0x17f709(0xc05)](_0x49e85d)>0x5||Math[_0x17f709(0xc05)](_0x566ebc)>0x5)&&(_0x18f4a4['isClick']=![]);!_0x18f4a4[_0x17f709(0x235)]&&(Math['abs'](_0x49e85d)>Math[_0x17f709(0xc05)](_0x566ebc)?_0x18f4a4['swipeDirection']=_0x17f709(0x54a):_0x18f4a4[_0x17f709(0x235)]=_0x17f709(0x140f));if(_0x18f4a4[_0x17f709(0x235)]===_0x17f709(0x54a)){_0x3b1c6f['preventDefault'](),_0x18f4a4['currentX']=_0x198dde;let _0x49c409=Math[_0x17f709(0x683)](0x0,Math['max'](-0x5a,_0x49e85d));_0x18f4a4[_0x17f709(0xb6d)][_0x17f709(0x139c)](_0x17f709(0xb35))['style'][_0x17f709(0xd91)]=_0x17f709(0x7f0)+_0x49c409+'px)';}},_0x362475=_0x3b1acb=>{const _0x3f24b9=_0x11344e;document[_0x3f24b9(0x5ce)]('mousemove',_0x22c377),document[_0x3f24b9(0x5ce)](_0x3f24b9(0xacd),_0x362475),document[_0x3f24b9(0x5ce)](_0x3f24b9(0xd22),_0x22c377),document[_0x3f24b9(0x5ce)](_0x3f24b9(0xab6),_0x362475);if(!_0x18f4a4[_0x3f24b9(0x983)]||!_0x18f4a4[_0x3f24b9(0xb6d)])return;const _0x180d5c=_0x18f4a4['activeContainer'][_0x3f24b9(0x139c)](_0x3f24b9(0xb35));_0x180d5c[_0x3f24b9(0x1284)][_0x3f24b9(0x64c)]=_0x3f24b9(0xd86);if(_0x18f4a4[_0x3f24b9(0x235)]===_0x3f24b9(0x54a)&&!_0x18f4a4[_0x3f24b9(0x3a2)]){const _0x33195c=_0x3b1acb[_0x3f24b9(0x919)][_0x3f24b9(0x6e9)]('touchend')?_0x3b1acb['changedTouches'][0x0][_0x3f24b9(0x33b)]:_0x3b1acb[_0x3f24b9(0x33b)],_0x4a5f8c=_0x33195c-_0x18f4a4[_0x3f24b9(0x58f)];_0x4a5f8c<-0x28?_0x180d5c[_0x3f24b9(0x1276)][_0x3f24b9(0xe13)](_0x3f24b9(0x1043)):_0x180d5c[_0x3f24b9(0x1276)]['remove'](_0x3f24b9(0x1043));}_0x180d5c[_0x3f24b9(0x1284)]['transform']='',_0x18f4a4[_0x3f24b9(0x983)]=![],_0x18f4a4[_0x3f24b9(0xb6d)]=null,_0x18f4a4[_0x3f24b9(0x235)]=null,_0x18f4a4[_0x3f24b9(0x3a2)]=!![];};_0x38fc1d[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x134486),_0x38fc1d[_0x11344e(0x1086)]('mousedown',_0x54d181),_0x38fc1d['addEventListener'](_0x11344e(0x3bc),_0x54d181,{'passive':!![]}),_0x38fc1d[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x207fb3=>{const _0xb41ed2=_0x11344e;_0x207fb3[_0xb41ed2(0x9c2)]&&_0x207fb3[_0xb41ed2(0x9c2)]['id']==='load-more-qzone-btn'&&_0x2e0a5e();}),document[_0x11344e(0x53a)](_0x11344e(0x51e))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x5303b4=_0x11344e;_0x53d851[_0x5303b4(0x13be)]&&_0x32670c(_0x53d851[_0x5303b4(0x13be)]);}),document['getElementById'](_0x11344e(0x7b5))[_0x11344e(0x1086)](_0x11344e(0x325),_0xdf3eb9),document[_0x11344e(0x53a)](_0x11344e(0x78b))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x20146a),document['getElementById'](_0x11344e(0x4c2))[_0x11344e(0x1086)]('click',_0x1cdc5e),document[_0x11344e(0x53a)](_0x11344e(0x8db))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x31db72=_0x11344e,_0x69062e=document[_0x31db72(0x53a)]('world-book-entries-container');_0x69062e['querySelector']('p')&&(_0x69062e[_0x31db72(0xaac)]='');const _0x51831a=_0x3571ed();_0x69062e[_0x31db72(0x133d)](_0x51831a),_0x51831a[_0x31db72(0x139c)](_0x31db72(0x5af))[_0x31db72(0x78d)]();}),document[_0x11344e(0x53a)](_0x11344e(0xfa5))['addEventListener'](_0x11344e(0xb2b),_0x4fd454),document[_0x11344e(0x53a)](_0x11344e(0x92f))['addEventListener']('click',_0x6b24a4=>{const _0x377d2f=_0x11344e;_0x6b24a4[_0x377d2f(0x9c2)]&&_0x6b24a4[_0x377d2f(0x9c2)]['id']===_0x377d2f(0x537)&&_0x58a02b();}),document[_0x11344e(0x53a)](_0x11344e(0x791))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x65758c),document['getElementById'](_0x11344e(0x99d))[_0x11344e(0x1086)]('click',_0x12cd02),document['getElementById']('character-profile-modal')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x3c1d8d=>{const _0x5ed75b=_0x11344e;_0x3c1d8d[_0x5ed75b(0x9c2)]['id']===_0x5ed75b(0x8e9)&&_0x3c1d8d[_0x5ed75b(0x9c2)][_0x5ed75b(0x1276)]['remove'](_0x5ed75b(0xaef));}),document['getElementById']('manage-stickers-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x3e2c21),document[_0x11344e(0x53a)](_0x11344e(0x13a4))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x281be8),document[_0x11344e(0x53a)](_0x11344e(0x9a1))[_0x11344e(0x1086)]('click',()=>_0x4001e6('messages-view')),document[_0x11344e(0x53a)]('favorites-back-btn')[_0x11344e(0x1086)]('click',()=>_0x4001e6(_0x11344e(0x411)));const _0x1b8ad7=document[_0x11344e(0x53a)](_0x11344e(0x40f)),_0x5aecb6=document[_0x11344e(0x53a)](_0x11344e(0x733));_0x1b8ad7[_0x11344e(0x1086)](_0x11344e(0x1174),()=>{const _0x2b2f7c=_0x11344e,_0x2a3b2d=_0x1b8ad7[_0x2b2f7c(0x11a2)]['trim']()['toLowerCase']();_0x5aecb6[_0x2b2f7c(0x1284)][_0x2b2f7c(0x11d9)]=_0x2a3b2d?_0x2b2f7c(0x1ea):'none';if(!_0x2a3b2d){_0x58f784(allFavoriteItems);return;}const _0x406757=allFavoriteItems[_0x2b2f7c(0x2dd)](_0x55987b=>{const _0x26825a=_0x2b2f7c;let _0x58f649='',_0x2f2a9b='';if(_0x55987b[_0x26825a(0x919)]===_0x26825a(0xc50)){const _0x470bec=_0x55987b[_0x26825a(0x73e)];_0x58f649+=(_0x470bec[_0x26825a(0x678)]||'')+'\x20'+(_0x470bec[_0x26825a(0x73e)]||'');if(_0x470bec[_0x26825a(0xa59)]==='user')_0x2f2a9b=_0x53d851[_0x26825a(0xa74)][_0x26825a(0x1005)];else _0x53d851[_0x26825a(0xaa3)][_0x470bec['authorId']]&&(_0x2f2a9b=_0x53d851[_0x26825a(0xaa3)][_0x470bec[_0x26825a(0xa59)]][_0x26825a(0x234)]);}else{if(_0x55987b['type']===_0x26825a(0x776)){const _0x412559=_0x55987b[_0x26825a(0x73e)];typeof _0x412559[_0x26825a(0x73e)]===_0x26825a(0xfc5)&&(_0x58f649=_0x412559[_0x26825a(0x73e)]);const _0x2d677c=_0x53d851['chats'][_0x55987b['chatId']];_0x2d677c&&(_0x412559[_0x26825a(0xb4d)]===_0x26825a(0x10ae)?_0x2f2a9b=_0x2d677c[_0x26825a(0x86e)]?_0x2d677c[_0x26825a(0x81e)][_0x26825a(0x1303)]||'我':'我':_0x2f2a9b=_0x2d677c[_0x26825a(0x86e)]?_0x412559[_0x26825a(0xbee)]:_0x2d677c[_0x26825a(0x234)]);}}return _0x58f649[_0x26825a(0x12b5)]()[_0x26825a(0x6e9)](_0x2a3b2d)||_0x2f2a9b['toLowerCase']()[_0x26825a(0x6e9)](_0x2a3b2d);});_0x58f784(_0x406757);}),_0x5aecb6[_0x11344e(0x1086)]('click',()=>{const _0x4c8460=_0x11344e;_0x1b8ad7[_0x4c8460(0x11a2)]='',_0x5aecb6['style'][_0x4c8460(0x11d9)]=_0x4c8460(0xbf2),_0x58f784(allFavoriteItems),_0x1b8ad7[_0x4c8460(0x78d)]();}),document['getElementById'](_0x11344e(0xfec))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x51fa56=_0x11344e;if(_0x373402[_0x51fa56(0x38e)]===0x0)return;const _0x19ab36=_0x53d851[_0x51fa56(0xaa3)][_0x53d851[_0x51fa56(0x13be)]];if(!_0x19ab36)return;const _0x21c72b=[],_0x5e65cb=[..._0x373402];for(const _0x287310 of _0x5e65cb){const _0x4d1ea0=await _0xa62efb[_0x51fa56(0xb51)][_0x51fa56(0x57e)](_0x51fa56(0xbae))[_0x51fa56(0x12f6)](_0x287310)[_0x51fa56(0x7e6)]();if(!_0x4d1ea0){const _0x3394a6=_0x19ab36[_0x51fa56(0xe83)]['find'](_0x4ab9b8=>_0x4ab9b8[_0x51fa56(0x827)]===_0x287310);_0x3394a6&&_0x21c72b[_0x51fa56(0x7dd)]({'type':_0x51fa56(0x776),'content':_0x3394a6,'chatId':_0x53d851[_0x51fa56(0x13be)],'timestamp':Date[_0x51fa56(0x9c1)](),'originalTimestamp':_0x3394a6[_0x51fa56(0x827)]});}}_0x21c72b['length']>0x0?(await _0xa62efb[_0x51fa56(0xb51)][_0x51fa56(0x1386)](_0x21c72b),allFavoriteItems=await _0xa62efb[_0x51fa56(0xb51)][_0x51fa56(0x1064)](_0x51fa56(0x827))[_0x51fa56(0x843)]()[_0x51fa56(0xa73)](),await _0x184397(_0x51fa56(0xe36),_0x51fa56(0x9f1)+_0x21c72b[_0x51fa56(0x29d)]+_0x51fa56(0x707))):await _0x184397('提示',_0x51fa56(0xe92)),_0x3c73fa();});const _0x4bf603=document['getElementById']('favorites-edit-btn'),_0xc24889=document[_0x11344e(0x53a)](_0x11344e(0x837)),_0x336dbd=document[_0x11344e(0x53a)]('favorites-action-bar'),_0x22ecbc=document['getElementById'](_0x11344e(0x521)),_0x2e307c=document[_0x11344e(0x53a)](_0x11344e(0xb64));_0x4bf603[_0x11344e(0x1086)]('click',()=>{const _0x30033a=_0x11344e;_0xd43fb7=!_0xd43fb7,_0xc24889[_0x30033a(0x1276)][_0x30033a(0x4d7)]('selection-mode',_0xd43fb7),_0xd43fb7?(_0x4bf603[_0x30033a(0x34a)]='完成',_0x336dbd['style']['display']=_0x30033a(0x1ea),_0x22ecbc['style'][_0x30033a(0x11d9)]=_0x30033a(0xbf2),_0x2e307c['style'][_0x30033a(0x6e4)]=_0x30033a(0x71b)):(_0x4bf603[_0x30033a(0x34a)]='编辑',_0x336dbd[_0x30033a(0x1284)][_0x30033a(0x11d9)]=_0x30033a(0xbf2),_0x22ecbc[_0x30033a(0x1284)][_0x30033a(0x11d9)]='flex',_0x2e307c['style'][_0x30033a(0x6e4)]='',_0x16de0e[_0x30033a(0xfcf)](),document[_0x30033a(0xc3d)]('.favorite-item-card.selected')['forEach'](_0x4a07ec=>_0x4a07ec[_0x30033a(0x1276)][_0x30033a(0x2d4)]('selected')),document['getElementById']('favorites-delete-selected-btn')[_0x30033a(0x34a)]='删除\x20(0)');}),document[_0x11344e(0x53a)]('favorites-list')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x1f31df=>{const _0x1503f5=_0x11344e,_0x16b8a5=_0x1f31df[_0x1503f5(0x9c2)],_0x1396ea=_0x16b8a5['closest'](_0x1503f5(0xc3f));if(_0x16b8a5[_0x1503f5(0xfcc)]===_0x1503f5(0xbce)&&_0x16b8a5[_0x1503f5(0x999)][_0x1503f5(0x884)]){const _0x3596ae=_0x16b8a5[_0x1503f5(0x999)][_0x1503f5(0x884)];_0x184397(_0x1503f5(0xf01),_0x3596ae[_0x1503f5(0x795)](/<br>/g,'\x0a'));return;}if(!_0xd43fb7)return;if(!_0x1396ea)return;const _0xa6a99d=parseInt(_0x1396ea['dataset'][_0x1503f5(0x714)]);if(isNaN(_0xa6a99d))return;_0x16de0e[_0x1503f5(0x11af)](_0xa6a99d)?(_0x16de0e[_0x1503f5(0x121e)](_0xa6a99d),_0x1396ea[_0x1503f5(0x1276)][_0x1503f5(0x2d4)](_0x1503f5(0x1015))):(_0x16de0e[_0x1503f5(0xe13)](_0xa6a99d),_0x1396ea[_0x1503f5(0x1276)]['add'](_0x1503f5(0x1015))),document['getElementById'](_0x1503f5(0xe28))[_0x1503f5(0x34a)]=_0x1503f5(0xf3c)+_0x16de0e[_0x1503f5(0x38e)]+')';}),document[_0x11344e(0x53a)]('favorites-delete-selected-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x57c975=_0x11344e;if(_0x16de0e[_0x57c975(0x38e)]===0x0)return;const _0x2389ae=await _0x355fc0(_0x57c975(0x69a),'确定要从收藏夹中移除这\x20'+_0x16de0e['size']+_0x57c975(0x8bf),{'confirmButtonClass':_0x57c975(0x264)});if(_0x2389ae){const _0xe590a8=[..._0x16de0e];await _0xa62efb[_0x57c975(0xb51)]['bulkDelete'](_0xe590a8),await _0x184397('删除成功','选中的收藏已被移除。'),allFavoriteItems=allFavoriteItems[_0x57c975(0x2dd)](_0x5bcadb=>!_0xe590a8[_0x57c975(0x6e9)](_0x5bcadb['id'])),_0x58f784(allFavoriteItems),_0x4bf603[_0x57c975(0xb2b)]();}});_0x53d851[_0x11344e(0x906)][_0x11344e(0x527)]&&(_0x148146(),console[_0x11344e(0x1081)](_0x11344e(0x866)));document['querySelectorAll']('input[name=\x22theme-select\x22]')['forEach'](_0xe83be4=>{const _0xbc4335=_0x11344e;_0xe83be4[_0xbc4335(0x1086)](_0xbc4335(0x325),_0x574a7b);});const _0x5d34c4=document[_0x11344e(0x53a)](_0x11344e(0x813));_0x5d34c4['addEventListener'](_0x11344e(0x1174),()=>{const _0x1723ee=_0x11344e;document[_0x1723ee(0x53a)](_0x1723ee(0x668))[_0x1723ee(0x34a)]=_0x5d34c4[_0x1723ee(0x11a2)]+'px',_0x574a7b();});const _0x55bd5a=document['getElementById'](_0x11344e(0xb8b));_0x55bd5a[_0x11344e(0x1086)](_0x11344e(0x1174),_0x574a7b),document[_0x11344e(0x53a)](_0x11344e(0x12cc))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{document['getElementById']('theme-default')['checked']=!![],_0x574a7b();}),document[_0x11344e(0x53a)]('reset-custom-css-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x3957e9=_0x11344e;document[_0x3957e9(0x53a)](_0x3957e9(0xb8b))[_0x3957e9(0x11a2)]='',_0x574a7b();}),document['getElementById']('lyrics-vertical-pos')['addEventListener'](_0x11344e(0x325),_0x574a7b),document[_0x11344e(0x53a)](_0x11344e(0xf80))['addEventListener']('change',_0x574a7b),document[_0x11344e(0x53a)](_0x11344e(0x13bb))['addEventListener'](_0x11344e(0x1174),_0x574a7b),document[_0x11344e(0xc3d)]('input[name=\x22visibility\x22]')[_0x11344e(0xeaf)](_0x3092a4=>{const _0x5dbdef=_0x11344e;_0x3092a4[_0x5dbdef(0x1086)](_0x5dbdef(0x325),function(){const _0x6ca05d=_0x5dbdef,_0x253a23=document['getElementById'](_0x6ca05d(0x7fb));this[_0x6ca05d(0x11a2)]===_0x6ca05d(0x6c0)||this[_0x6ca05d(0x11a2)]==='exclude'?_0x253a23[_0x6ca05d(0x1284)]['display']='block':_0x253a23[_0x6ca05d(0x1284)][_0x6ca05d(0x11d9)]=_0x6ca05d(0xbf2);});}),document[_0x11344e(0x53a)](_0x11344e(0xbf9))['addEventListener'](_0x11344e(0xb2b),_0x20126a),document[_0x11344e(0x53a)](_0x11344e(0xa5b))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x30a3f2=_0x11344e;document[_0x30a3f2(0x53a)](_0x30a3f2(0x740))[_0x30a3f2(0x1276)][_0x30a3f2(0x2d4)]('visible');const _0x358b75=document['getElementById']('chat-settings-btn');document[_0x30a3f2(0x53a)]('chat-settings-modal')['classList'][_0x30a3f2(0x6a3)]('visible')&&_0x358b75[_0x30a3f2(0xb2b)]();}),document[_0x11344e(0x53a)](_0x11344e(0x4bc))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x4eb228),document[_0x11344e(0x53a)]('existing-groups-list')['addEventListener'](_0x11344e(0xb2b),_0x3c267e=>{const _0x2c0dd9=_0x11344e;if(_0x3c267e['target'][_0x2c0dd9(0x1276)][_0x2c0dd9(0x6a3)](_0x2c0dd9(0xf79))){const _0x20876d=parseInt(_0x3c267e['target'][_0x2c0dd9(0x999)]['id']);_0x31dd16(_0x20876d);}}),document[_0x11344e(0x53a)](_0x11344e(0xc79))[_0x11344e(0x1086)]('click',_0x294f69),document['getElementById'](_0x11344e(0x13c0))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x511fe1),document[_0x11344e(0x53a)](_0x11344e(0x13b3))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x5caf6b),document['getElementById'](_0x11344e(0x5be))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x2455b5),document[_0x11344e(0x53a)](_0x11344e(0x12b6))[_0x11344e(0x1086)]('click',()=>{const _0x5bc833=_0x3d3f39;_0x294f69(),_0x5bc833&&_0x1e26c7(_0x5bc833);}),document[_0x11344e(0x53a)](_0x11344e(0xa33))['addEventListener']('click',_0x36ed29=>{const _0x319e27=_0x11344e,_0x243a51=_0x36ed29[_0x319e27(0x9c2)]['closest']('.message-bubble');if(!_0x243a51)return;if(_0x243a51['classList'][_0x319e27(0x6a3)]('ai')&&_0x243a51[_0x319e27(0x1276)][_0x319e27(0x6a3)](_0x319e27(0x8bd))&&_0x243a51['dataset'][_0x319e27(0x12d3)]===_0x319e27(0x43a)){const _0x3bc745=parseInt(_0x243a51[_0x319e27(0x999)][_0x319e27(0x827)]);!isNaN(_0x3bc745)&&_0x2014ee(_0x3bc745);}}),document['getElementById']('transfer-action-accept')['addEventListener'](_0x11344e(0xb2b),()=>_0x59d079(_0x11344e(0x42c))),document['getElementById'](_0x11344e(0x13ca))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>_0x59d079(_0x11344e(0xe65))),document[_0x11344e(0x53a)](_0x11344e(0x13b1))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x11ada4),document[_0x11344e(0x53a)]('edit-post-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x4bc790),document[_0x11344e(0x53a)](_0x11344e(0x12b1))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x19fbe8),document[_0x11344e(0x53a)](_0x11344e(0xf62))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x20806a),document[_0x11344e(0x53a)]('cancel-contact-picker-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0xc1c41a=_0x11344e;_0x541a81(_0xc1c41a(0xbca));}),document[_0x11344e(0x53a)]('contact-picker-list')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x295aa1=>{const _0x3c265e=_0x11344e,_0x49ade5=_0x295aa1[_0x3c265e(0x9c2)][_0x3c265e(0x106f)]('.contact-picker-item');if(!_0x49ade5)return;const _0x2adbef=_0x49ade5[_0x3c265e(0x999)]['contactId'];_0x49ade5['classList'][_0x3c265e(0x4d7)]('selected'),_0x3da78a['has'](_0x2adbef)?_0x3da78a['delete'](_0x2adbef):_0x3da78a[_0x3c265e(0xe13)](_0x2adbef),_0x2eaf02();}),document[_0x11344e(0x53a)](_0x11344e(0xe04))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{_0x447e82();}),document['getElementById'](_0x11344e(0x3a3))['addEventListener'](_0x11344e(0xb2b),()=>{const _0x19db6e=_0x11344e;_0x541a81(_0x19db6e(0x10ba)),document[_0x19db6e(0x53a)](_0x19db6e(0x460))['click']();}),document[_0x11344e(0x53a)]('member-management-list')['addEventListener'](_0x11344e(0xb2b),_0xefd23c=>{const _0x52bbf3=_0x11344e;_0xefd23c['target'][_0x52bbf3(0x1276)][_0x52bbf3(0x6a3)](_0x52bbf3(0x135f))&&_0x435b16(_0xefd23c['target']['dataset']['memberId']);}),document[_0x11344e(0x53a)](_0x11344e(0xd19))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x1055e0=_0x11344e,_0x24bccc=document[_0x1055e0(0x53a)](_0x1055e0(0x73a)),_0x5bc8c3=_0x24bccc[_0x1055e0(0x75a)](!![]);_0x24bccc[_0x1055e0(0x9e8)][_0x1055e0(0xa1d)](_0x5bc8c3,_0x24bccc),_0x5bc8c3[_0x1055e0(0x1086)](_0x1055e0(0xb2b),_0x341252),await _0x58b6b0();}),document[_0x11344e(0x53a)](_0x11344e(0x40c))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x2b2043),document[_0x11344e(0x53a)](_0x11344e(0xa62))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x19f550),document[_0x11344e(0x53a)]('group-video-call-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x19f550),document['getElementById'](_0x11344e(0x3cd))[_0x11344e(0x1086)]('click',_0x492cea),document[_0x11344e(0x53a)](_0x11344e(0x635))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x21b8bc=_0x11344e;_0x58a059[_0x21b8bc(0xf9b)]=![],_0x541a81('chat-interface-screen');}),document[_0x11344e(0x53a)]('join-call-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x3a29e8),document['getElementById']('decline-call-btn')['addEventListener'](_0x11344e(0xb2b),async()=>{const _0x29afd2=_0x11344e;_0x5bd3ef();const _0x54bfb2=_0x53d851[_0x29afd2(0xaa3)][_0x58a059['activeChatId']];if(!_0x54bfb2)return;if(_0x58a059['isGroupCall']){_0x58a059['isUserParticipating']=![];const _0x2bf3fe={'role':_0x29afd2(0xab3),'content':_0x29afd2(0xe11),'timestamp':Date[_0x29afd2(0x9c1)](),'isHidden':!![]};_0x54bfb2[_0x29afd2(0xe83)][_0x29afd2(0x7dd)](_0x2bf3fe),await _0xa62efb[_0x29afd2(0xaa3)][_0x29afd2(0x546)](_0x54bfb2),await _0x5403b5();}else{const _0x52f389={'role':_0x29afd2(0x10ae),'content':'我拒绝了你的视频通话请求。','timestamp':Date[_0x29afd2(0x9c1)]()};_0x54bfb2[_0x29afd2(0xe83)]['push'](_0x52f389),await _0xa62efb[_0x29afd2(0xaa3)][_0x29afd2(0x546)](_0x54bfb2),_0x541a81(_0x29afd2(0x10ba)),_0xa4d65(_0x52f389,_0x54bfb2),_0x5403b5();}_0x58a059[_0x29afd2(0xf9b)]=![];}),document['getElementById'](_0x11344e(0x20a))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x552acc=_0x11344e;_0x5bd3ef(),_0x58a059[_0x552acc(0xf71)]='ai',_0x58a059[_0x552acc(0x1402)]=!![],_0x58a059[_0x552acc(0x13be)]=_0x53d851[_0x552acc(0x13be)];if(_0x58a059[_0x552acc(0x732)]){const _0x5b0e90=_0x53d851[_0x552acc(0xaa3)][_0x58a059[_0x552acc(0x13be)]],_0x40d699=_0x5b0e90['members'][_0x552acc(0x397)](_0x4cee40=>_0x4cee40[_0x552acc(0x234)]===_0x58a059[_0x552acc(0xa0b)]);_0x40d699?_0x58a059['participants']=[_0x40d699]:_0x58a059[_0x552acc(0x574)]=[];}_0x56dfd3();}),document[_0x11344e(0x53a)](_0x11344e(0xa98))['addEventListener'](_0x11344e(0xb2b),async()=>{const _0x5b3a47=_0x11344e;if(!_0x58a059[_0x5b3a47(0x975)])return;const _0x35746f=document[_0x5b3a47(0x139c)](_0x5b3a47(0x2c5));_0x35746f&&_0x35746f[_0x5b3a47(0x1276)][_0x5b3a47(0xe13)](_0x5b3a47(0x94e));const _0x27f4af=await _0x4f6537('你说',_0x5b3a47(0x353));_0x35746f&&_0x35746f['classList'][_0x5b3a47(0x2d4)](_0x5b3a47(0x94e)),_0x27f4af&&_0x27f4af['trim']()&&_0x2b8205(_0x27f4af[_0x5b3a47(0x13bc)]());}),document[_0x11344e(0x139c)](_0x11344e(0x1025))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x4175f0=_0x11344e;_0xd43fb7&&document[_0x4175f0(0x53a)]('favorites-edit-btn')[_0x4175f0(0xb2b)](),_0x4001e6(_0x4175f0(0x1024)),_0x326e05();}),document['getElementById'](_0x11344e(0xcce))[_0x11344e(0x1086)]('click',()=>_0x4001e6('messages-view')),document[_0x11344e(0x53a)](_0x11344e(0xaf4))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x418a50=_0x11344e,_0x556ea1=document[_0x418a50(0x53a)](_0x418a50(0xe7b))[_0x418a50(0x11a2)][_0x418a50(0x13bc)](),_0x567079=document[_0x418a50(0x53a)]('countdown-date-input')[_0x418a50(0x11a2)];if(!_0x556ea1||!_0x567079){alert('请填写完整的约定标题和日期！');return;}const _0x1f7391=new Date(_0x567079);if(isNaN(_0x1f7391)||_0x1f7391<=new Date()){alert('请输入一个有效的、未来的日期！');return;}const _0x30337f={'authorId':_0x418a50(0x10ae),'description':_0x556ea1,'timestamp':Date[_0x418a50(0x9c1)](),'type':_0x418a50(0x1178),'targetDate':_0x1f7391['getTime']()};await _0xa62efb[_0x418a50(0xbe7)][_0x418a50(0xe13)](_0x30337f),document[_0x418a50(0x53a)]('create-countdown-modal')[_0x418a50(0x1276)][_0x418a50(0x2d4)](_0x418a50(0xaef)),_0x326e05();}),document[_0x11344e(0x53a)](_0x11344e(0x11a6))['addEventListener'](_0x11344e(0xb2b),async()=>{const _0x406183=_0x11344e;if(!_0x53d851[_0x406183(0x13be)]||_0x53d851[_0x406183(0xaa3)][_0x53d851[_0x406183(0x13be)]][_0x406183(0x86e)])return;const _0x4c5214=_0x53d851[_0x406183(0xaa3)][_0x53d851[_0x406183(0x13be)]],_0x18bd4c=await _0x355fc0(_0x406183(0xc5c),_0x406183(0x391)+_0x4c5214['name']+_0x406183(0x11b5),{'confirmButtonClass':_0x406183(0x264)});if(_0x18bd4c){_0x4c5214['relationship'][_0x406183(0x12d3)]='blocked_by_user',_0x4c5214[_0x406183(0x1333)][_0x406183(0xde7)]=Date['now']();const _0x3869ef={'role':'system','content':_0x406183(0xd84),'timestamp':Date[_0x406183(0x9c1)]()+0x1,'isHidden':!![]};_0x4c5214[_0x406183(0xe83)][_0x406183(0x7dd)](_0x3869ef),await _0xa62efb[_0x406183(0xaa3)][_0x406183(0x546)](_0x4c5214),document[_0x406183(0x53a)](_0x406183(0xe1c))[_0x406183(0x1276)][_0x406183(0x2d4)](_0x406183(0xaef)),_0x60f53f(_0x53d851['activeChatId']),_0x5001a4();}}),document[_0x11344e(0x53a)](_0x11344e(0x97b))[_0x11344e(0x1086)](_0x11344e(0xb2b),async _0x4e7a30=>{const _0x3f8b02=_0x11344e,_0x34c0c5=_0x53d851[_0x3f8b02(0xaa3)][_0x53d851[_0x3f8b02(0x13be)]];if(!_0x34c0c5)return;if(_0x4e7a30[_0x3f8b02(0x9c2)]['id']===_0x3f8b02(0xd96)){alert(_0x3f8b02(0x120d)),await _0x56c2ac(_0x34c0c5['id']),_0x60f53f(_0x34c0c5['id']);return;}if(_0x4e7a30[_0x3f8b02(0x9c2)]['id']===_0x3f8b02(0xea4)){_0x34c0c5[_0x3f8b02(0x1333)][_0x3f8b02(0x12d3)]=_0x3f8b02(0x10b1),_0x34c0c5[_0x3f8b02(0x1333)][_0x3f8b02(0xde7)]=null;const _0x4e1f66={'role':_0x3f8b02(0xab3),'content':_0x3f8b02(0x119d),'timestamp':Date[_0x3f8b02(0x9c1)](),'isHidden':!![]};_0x34c0c5[_0x3f8b02(0xe83)][_0x3f8b02(0x7dd)](_0x4e1f66),await _0xa62efb[_0x3f8b02(0xaa3)][_0x3f8b02(0x546)](_0x34c0c5),_0x60f53f(_0x34c0c5['id']),_0x5001a4(),_0x5403b5();}else{if(_0x4e7a30[_0x3f8b02(0x9c2)]['id']===_0x3f8b02(0xe5f)){_0x34c0c5[_0x3f8b02(0x1333)][_0x3f8b02(0x12d3)]=_0x3f8b02(0x10b1),_0x34c0c5[_0x3f8b02(0x1333)][_0x3f8b02(0xc1c)]='';const _0x74b0c8={'role':_0x3f8b02(0xab3),'type':'pat_message','content':_0x3f8b02(0xb7b)+_0x34c0c5[_0x3f8b02(0x234)]+_0x3f8b02(0xa91),'timestamp':Date[_0x3f8b02(0x9c1)]()};_0x34c0c5[_0x3f8b02(0xe83)]['push'](_0x74b0c8);const _0x37c71a={'role':_0x3f8b02(0xac5),'senderName':_0x34c0c5[_0x3f8b02(0x234)],'content':'太好了！我们又可以聊天啦！','timestamp':Date['now']()+0x1};_0x34c0c5[_0x3f8b02(0xe83)][_0x3f8b02(0x7dd)](_0x37c71a),await _0xa62efb[_0x3f8b02(0xaa3)]['put'](_0x34c0c5),_0x60f53f(_0x34c0c5['id']),_0x5001a4();}else{if(_0x4e7a30[_0x3f8b02(0x9c2)]['id']===_0x3f8b02(0xc91))_0x34c0c5['relationship'][_0x3f8b02(0x12d3)]=_0x3f8b02(0x133c),_0x34c0c5[_0x3f8b02(0x1333)][_0x3f8b02(0xde7)]=Date['now'](),_0x34c0c5[_0x3f8b02(0x1333)][_0x3f8b02(0xc1c)]='',await _0xa62efb['chats'][_0x3f8b02(0x546)](_0x34c0c5),_0x60f53f(_0x34c0c5['id']);else{if(_0x4e7a30['target']['id']===_0x3f8b02(0x1079)){const _0x1572e9=await _0x4f6537(_0x3f8b02(0x454),_0x3f8b02(0xaf1)+_0x34c0c5['name']+'”说的申请理由：','我们和好吧！');_0x1572e9!==null&&(_0x34c0c5[_0x3f8b02(0x1333)][_0x3f8b02(0x12d3)]=_0x3f8b02(0xf51),_0x34c0c5['relationship'][_0x3f8b02(0xc1c)]=_0x1572e9,await _0xa62efb[_0x3f8b02(0xaa3)][_0x3f8b02(0x546)](_0x34c0c5),_0x60f53f(_0x34c0c5['id']),_0x5001a4(),_0x5403b5());}}}}}),document[_0x11344e(0x53a)]('transfer-btn')['addEventListener']('click',_0x19d4d9),document['getElementById'](_0x11344e(0x1098))[_0x11344e(0x1086)]('click',()=>{const _0x353a79=_0x11344e;document[_0x353a79(0x53a)](_0x353a79(0x76b))['classList'][_0x353a79(0x2d4)](_0x353a79(0xaef));}),document['getElementById'](_0x11344e(0x672))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x5dbd2c),document[_0x11344e(0x53a)](_0x11344e(0x141c))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0xa2eff4);const _0x5209c6=document[_0x11344e(0x53a)](_0x11344e(0x338)),_0x5af2f1=document['getElementById']('rp-tab-direct'),_0x3610f9=document[_0x11344e(0x53a)](_0x11344e(0xfbc)),_0x2acb8a=document[_0x11344e(0x53a)](_0x11344e(0x1428));_0x5209c6[_0x11344e(0x1086)]('click',()=>{const _0x518cb6=_0x11344e;_0x5209c6['classList'][_0x518cb6(0xe13)](_0x518cb6(0xdf6)),_0x5af2f1[_0x518cb6(0x1276)]['remove'](_0x518cb6(0xdf6)),_0x3610f9[_0x518cb6(0x1284)][_0x518cb6(0x11d9)]=_0x518cb6(0x1ea),_0x2acb8a[_0x518cb6(0x1284)][_0x518cb6(0x11d9)]='none';}),_0x5af2f1[_0x11344e(0x1086)]('click',()=>{const _0x428cd8=_0x11344e;_0x5af2f1[_0x428cd8(0x1276)][_0x428cd8(0xe13)](_0x428cd8(0xdf6)),_0x5209c6['classList']['remove'](_0x428cd8(0xdf6)),_0x2acb8a[_0x428cd8(0x1284)][_0x428cd8(0x11d9)]=_0x428cd8(0x1ea),_0x3610f9['style']['display']=_0x428cd8(0xbf2);}),document[_0x11344e(0x53a)](_0x11344e(0x327))[_0x11344e(0x1086)](_0x11344e(0x1174),_0x26530b=>{const _0x1f7cd3=_0x11344e,_0x5e8acf=parseFloat(_0x26530b[_0x1f7cd3(0x9c2)]['value'])||0x0;document[_0x1f7cd3(0x53a)](_0x1f7cd3(0x9b8))['textContent']='¥\x20'+_0x5e8acf[_0x1f7cd3(0x39e)](0x2);}),document[_0x11344e(0x53a)](_0x11344e(0xa3f))[_0x11344e(0x1086)](_0x11344e(0x1174),_0x541f25=>{const _0x50c005=_0x11344e,_0x5cdbd9=parseFloat(_0x541f25[_0x50c005(0x9c2)][_0x50c005(0x11a2)])||0x0;document[_0x50c005(0x53a)](_0x50c005(0xde5))[_0x50c005(0x34a)]='¥\x20'+_0x5cdbd9['toFixed'](0x2);}),document[_0x11344e(0x53a)]('chat-messages')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x5c5340=>{const _0x407e3c=_0x11344e,_0x3e71c4=_0x5c5340[_0x407e3c(0x9c2)][_0x407e3c(0x106f)](_0x407e3c(0x68a));if(!_0x3e71c4)return;const _0x5cd8e0=_0x3e71c4['closest']('.message-bubble');if(!_0x5cd8e0||!_0x5cd8e0['dataset'][_0x407e3c(0x827)])return;const _0xdf2e79=parseInt(_0x5cd8e0[_0x407e3c(0x999)][_0x407e3c(0x827)]);_0x5273c3(_0xdf2e79);}),document[_0x11344e(0x53a)]('send-poll-btn')[_0x11344e(0x1086)]('click',_0x1750bb),document[_0x11344e(0x53a)](_0x11344e(0x630))[_0x11344e(0x1086)]('click',_0x2f736e),document['getElementById']('cancel-create-poll-btn')['addEventListener'](_0x11344e(0xb2b),()=>{const _0x4833e2=_0x11344e;document[_0x4833e2(0x53a)](_0x4833e2(0x98d))['classList'][_0x4833e2(0x2d4)](_0x4833e2(0xaef));}),document[_0x11344e(0x53a)](_0x11344e(0xd49))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0xd1d89),document['getElementById'](_0x11344e(0xa33))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x471861=>{const _0x4fd42b=_0x11344e,_0x15c1ff=_0x471861[_0x4fd42b(0x9c2)]['closest']('.poll-card');if(!_0x15c1ff)return;const _0x106436=parseInt(_0x15c1ff[_0x4fd42b(0x999)][_0x4fd42b(0x372)]);if(isNaN(_0x106436))return;const _0x4cd46b=_0x471861[_0x4fd42b(0x9c2)]['closest'](_0x4fd42b(0x7ae));if(_0x4cd46b&&!_0x15c1ff[_0x4fd42b(0x1276)][_0x4fd42b(0x6a3)](_0x4fd42b(0x409))){_0x23575e(_0x106436,_0x4cd46b[_0x4fd42b(0x999)]['option']);return;}const _0x8a6c46=_0x471861[_0x4fd42b(0x9c2)][_0x4fd42b(0x106f)]('.poll-action-btn');if(_0x8a6c46){_0x15c1ff[_0x4fd42b(0x1276)][_0x4fd42b(0x6a3)](_0x4fd42b(0x409))?_0x5f4404(_0x106436):_0x4f7223(_0x106436);return;}_0x15c1ff[_0x4fd42b(0x1276)][_0x4fd42b(0x6a3)](_0x4fd42b(0x409))&&_0x5f4404(_0x106436);}),document[_0x11344e(0x53a)](_0x11344e(0x23b))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x305fab),document[_0x11344e(0x53a)]('add-ai-avatar-batch-btn')['addEventListener'](_0x11344e(0xb2b),()=>_0x47027b('ai')),document[_0x11344e(0x53a)](_0x11344e(0x6e7))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>_0x47027b(_0x11344e(0x1048))),document[_0x11344e(0x53a)]('add-ai-avatar-url-btn')['addEventListener'](_0x11344e(0xb2b),_0x4c840e),document[_0x11344e(0x53a)](_0x11344e(0x11c3))[_0x11344e(0x1086)]('click',()=>{const _0x25a395=_0x11344e;document[_0x25a395(0x53a)](_0x25a395(0x305))['click']();}),document[_0x11344e(0x53a)](_0x11344e(0x305))['addEventListener'](_0x11344e(0x325),_0x17f2a9),document[_0x11344e(0x53a)](_0x11344e(0xec8))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x4a890d),document[_0x11344e(0x53a)](_0x11344e(0x2e1))['addEventListener'](_0x11344e(0xb2b),_0x1342f6),document[_0x11344e(0x53a)](_0x11344e(0x805))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x2033c3),document[_0x11344e(0x53a)]('add-group-avatar-upload-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x46431e=_0x11344e;document[_0x46431e(0x53a)](_0x46431e(0x785))[_0x46431e(0xb2b)]();}),document[_0x11344e(0x53a)](_0x11344e(0x785))[_0x11344e(0x1086)](_0x11344e(0x325),_0x15a9de),document[_0x11344e(0x53a)]('close-group-avatar-library-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x8ec3a8),document[_0x11344e(0x53a)](_0x11344e(0xf1c))['addEventListener'](_0x11344e(0xb2b),_0x31be95=>{const _0x3e5a5c=_0x11344e;if(_0x31be95[_0x3e5a5c(0x9c2)]['classList'][_0x3e5a5c(0x6a3)](_0x3e5a5c(0x2d2))){const _0x2adcc5=_0x31be95[_0x3e5a5c(0x9c2)]['closest'](_0x3e5a5c(0x10fd)),_0x5f2927=_0x2adcc5[_0x3e5a5c(0x999)][_0x3e5a5c(0x10eb)];_0x5f2927&&_0x1c26b1(_0x5f2927,_0x3e5a5c(0x778),_0x2adcc5);}}),document[_0x11344e(0x53a)](_0x11344e(0xa33))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x9b9bfa=>{const _0x3b451a=_0x11344e,_0x37afb3=_0x9b9bfa['target'][_0x3b451a(0x106f)](_0x3b451a(0xd34));if(_0x37afb3){const _0x44dc56=parseInt(_0x37afb3[_0x3b451a(0x999)]['timestamp']);!isNaN(_0x44dc56)&&_0x56ddbe(_0x44dc56);}}),document[_0x11344e(0x53a)](_0x11344e(0x8d1))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{_0x541a81('chat-interface-screen');}),_0x2284f0['panelEl'][_0x11344e(0x1086)](_0x11344e(0xb2b),async _0x28bbfa=>{const _0x154d4c=_0x11344e,_0x27a0ac=_0x28bbfa[_0x154d4c(0x9c2)][_0x154d4c(0x106f)]('.sticker-item');if(_0x27a0ac&&_0x2284f0[_0x154d4c(0x117a)]!==null){const _0x39e055=_0x27a0ac[_0x154d4c(0x1284)][_0x154d4c(0x2f2)][_0x154d4c(0x1340)](0x5,-0x2),_0x35972b=_0x53d851[_0x154d4c(0xf8f)][_0x154d4c(0x397)](_0x536622=>_0x536622[_0x154d4c(0xb36)]===_0x39e055);_0x35972b?await _0xd0818a(_0x2284f0[_0x154d4c(0x117a)],_0x35972b):console['warn'](_0x154d4c(0xd15),_0x39e055);}}),document[_0x11344e(0x1086)]('click',_0x42ef90=>{const _0x8959a1=_0x11344e;_0x2284f0[_0x8959a1(0xb11)]&&!_0x2284f0['panelEl']['contains'](_0x42ef90['target'])&&!_0x42ef90[_0x8959a1(0x9c2)][_0x8959a1(0x106f)](_0x8959a1(0xd07))&&_0x4398f9();}),document[_0x11344e(0x53a)](_0x11344e(0x7b2))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x12e1d1),document['getElementById'](_0x11344e(0xa29))['addEventListener'](_0x11344e(0xb2b),()=>{const _0x545e51=_0x11344e;document['getElementById']('share-link-modal')[_0x545e51(0x1276)]['remove'](_0x545e51(0xaef));}),document['getElementById'](_0x11344e(0x31b))['addEventListener'](_0x11344e(0xb2b),_0x246c46),document['getElementById']('theme-toggle-switch')[_0x11344e(0x1086)]('change',_0x269e8d),document[_0x11344e(0x53a)](_0x11344e(0x13a2))['addEventListener'](_0x11344e(0xb2b),_0x43605f),document[_0x11344e(0x53a)](_0x11344e(0x103d))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x141945),document[_0x11344e(0x53a)](_0x11344e(0xdc6))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x5dae39=_0x11344e;_0x541a81(_0x5dae39(0xbca));}),document[_0x11344e(0x53a)](_0x11344e(0xe7e))['addEventListener'](_0x11344e(0xb2b),_0x53fbba=>{const _0x129cce=_0x11344e,_0x253934=_0x53fbba[_0x129cce(0x9c2)][_0x129cce(0x106f)]('.call-record-card');_0x253934&&_0x253934['dataset']['recordId']&&_0x41ff1f(parseInt(_0x253934[_0x129cce(0x999)][_0x129cce(0x26a)]));}),document[_0x11344e(0x53a)]('close-call-transcript-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0xe5358c=_0x11344e;document[_0xe5358c(0x53a)](_0xe5358c(0x1285))[_0xe5358c(0x1276)][_0xe5358c(0x2d4)]('visible');}),document['getElementById'](_0x11344e(0x2a4))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x30011f),document[_0x11344e(0x53a)](_0x11344e(0xd85))[_0x11344e(0x1086)]('click',()=>{const _0x3b7a9f=_0x11344e;_0x373402[_0x3b7a9f(0x38e)]>0x0&&_0x3f7155();}),document[_0x11344e(0x53a)](_0x11344e(0x67a))[_0x11344e(0x1086)]('click',_0x16a6f1),document['getElementById'](_0x11344e(0x10c7))[_0x11344e(0x1086)]('click',async()=>{const _0x78d22c=_0x11344e,_0x6f4dc7=_0x53d851['chats'][_0x53d851[_0x78d22c(0x13be)]],_0x15b362=Array['from'](document['querySelectorAll']('.share-target-checkbox:checked'))[_0x78d22c(0xcb4)](_0x3ab02b=>_0x3ab02b[_0x78d22c(0x999)][_0x78d22c(0x1054)]);if(_0x15b362[_0x78d22c(0x29d)]===0x0){alert(_0x78d22c(0xafc));return;}const _0x1cf1fe=[],_0x3971e3=[..._0x373402][_0x78d22c(0xdb0)]((_0x550e7e,_0x434b16)=>_0x550e7e-_0x434b16);for(const _0x175419 of _0x3971e3){const _0x24b00c=_0x6f4dc7['history'][_0x78d22c(0x397)](_0x38fbc6=>_0x38fbc6[_0x78d22c(0x827)]===_0x175419);_0x24b00c&&_0x1cf1fe['push'](_0x24b00c);}const _0x48af59={'role':'user','senderName':_0x6f4dc7['isGroup']?_0x6f4dc7[_0x78d22c(0x81e)][_0x78d22c(0x1303)]||'我':'我','type':'share_card','timestamp':Date[_0x78d22c(0x9c1)](),'payload':{'sourceChatName':_0x6f4dc7['name'],'title':_0x78d22c(0x6fb)+_0x6f4dc7[_0x78d22c(0x234)]+_0x78d22c(0xe72),'sharedHistory':_0x1cf1fe}};for(const _0x24d960 of _0x15b362){const _0x52f0f8=_0x53d851[_0x78d22c(0xaa3)][_0x24d960];_0x52f0f8&&(_0x52f0f8['history'][_0x78d22c(0x7dd)](_0x48af59),await _0xa62efb[_0x78d22c(0xaa3)][_0x78d22c(0x546)](_0x52f0f8));}document[_0x78d22c(0x53a)](_0x78d22c(0x10de))['classList'][_0x78d22c(0x2d4)](_0x78d22c(0xaef)),_0x3c73fa(),await _0x184397(_0x78d22c(0xe4f),_0x78d22c(0x115f)+_0x15b362[_0x78d22c(0x29d)]+'\x20个会话中。'),_0x5001a4();}),document[_0x11344e(0x53a)](_0x11344e(0xcdf))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x49a185=_0x11344e;document[_0x49a185(0x53a)]('share-target-modal')['classList'][_0x49a185(0x2d4)](_0x49a185(0xaef));}),document[_0x11344e(0x53a)]('chat-messages')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x3384df=>{const _0x50e708=_0x11344e,_0x2d9451=_0x3384df[_0x50e708(0x9c2)]['closest']('.link-share-card[data-timestamp]');if(_0x2d9451&&_0x2d9451[_0x50e708(0x106f)](_0x50e708(0x1295))){const _0x5db046=parseInt(_0x2d9451['dataset']['timestamp']);_0x2134bf(_0x5db046);}}),document[_0x11344e(0x53a)](_0x11344e(0xb84))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x4e7f33=_0x11344e;document[_0x4e7f33(0x53a)](_0x4e7f33(0x84c))['classList'][_0x4e7f33(0x2d4)]('visible');});async function _0x2134bf(_0x4d0791){const _0x26569d=_0x11344e,_0x23f3ad=_0x53d851['chats'][_0x53d851[_0x26569d(0x13be)]],_0x47f4e8=_0x23f3ad['history']['find'](_0x376fb9=>_0x376fb9['timestamp']===_0x4d0791);if(!_0x47f4e8||_0x47f4e8[_0x26569d(0x919)]!=='share_card'||!_0x47f4e8[_0x26569d(0x6ac)]){console[_0x26569d(0x617)]('无法找到或消息类型/内容不匹配的分享记录:',_0x4d0791),await _0x184397(_0x26569d(0x1166),_0x26569d(0x64a));return;}const _0x4534ba=document[_0x26569d(0x53a)](_0x26569d(0x84c)),_0x14abfc=document[_0x26569d(0x53a)]('shared-history-viewer-title'),_0x40d0a2=document['getElementById'](_0x26569d(0x1389));_0x14abfc[_0x26569d(0x34a)]=_0x47f4e8[_0x26569d(0x6ac)][_0x26569d(0x667)],_0x40d0a2[_0x26569d(0xaac)]='';const _0x4a2238=document['createDocumentFragment'](),_0x5b0df2=Object[_0x26569d(0x244)](_0x53d851['chats'])[_0x26569d(0x397)](_0x18331c=>_0x18331c[_0x26569d(0x234)]===_0x47f4e8['payload']['sourceChatName'])||_0x23f3ad;for(const _0x2afd58 of _0x47f4e8[_0x26569d(0x6ac)][_0x26569d(0xeed)]){const _0x574a51=await _0x36bd8d(_0x2afd58,_0x5b0df2);_0x574a51&&_0x4a2238['appendChild'](_0x574a51);}_0x40d0a2[_0x26569d(0x133d)](_0x4a2238),_0x4534ba['classList'][_0x26569d(0xe13)]('visible');}_0x2a3e73['addEventListener'](_0x11344e(0x1410),_0x255c27),_0x2a3e73[_0x11344e(0x1086)](_0x11344e(0xd54),()=>{_0x2eebda['isActive']&&(_0x2eebda['isPlaying']=![],_0x1dfd4f());}),_0x2a3e73[_0x11344e(0x1086)](_0x11344e(0x116c),()=>{const _0xc83d=_0x11344e;_0x2eebda[_0xc83d(0x975)]&&(_0x2eebda['isPlaying']=!![],_0x1dfd4f());}),document[_0x11344e(0x53a)](_0x11344e(0xf90))[_0x11344e(0x1086)](_0x11344e(0xb2b),async _0x5345c6=>{const _0x5648cf=_0x11344e,_0x2e545a=_0x5345c6[_0x5648cf(0x9c2)],_0x6e0faa=_0x2e545a['closest'](_0x5648cf(0xe0e));if(_0x6e0faa){const _0x494e28=parseInt(_0x6e0faa[_0x5648cf(0x999)][_0x5648cf(0xd52)]);!isNaN(_0x494e28)&&await _0x39ba5a(_0x494e28);return;}const _0x18b0b9=_0x2e545a[_0x5648cf(0x106f)](_0x5648cf(0x1104));if(_0x18b0b9){const _0xd769f1=parseInt(_0x18b0b9[_0x5648cf(0x999)][_0x5648cf(0xd52)]);if(isNaN(_0xd769f1))return;await _0x517cd7(_0xd769f1);return;}const _0x37ac20=_0x2e545a[_0x5648cf(0x106f)](_0x5648cf(0xf83));if(_0x37ac20){const _0x172b0d=parseInt(_0x37ac20[_0x5648cf(0x999)][_0x5648cf(0xd52)]);if(isNaN(_0x172b0d))return;const _0x3c8d0c=_0x2eebda[_0x5648cf(0xc9a)][_0x172b0d],_0x10dbb7=await _0x355fc0(_0x5648cf(0x5b5),'确定要从播放列表中删除《'+_0x3c8d0c['name']+'》吗？');_0x10dbb7&&_0x3180d7(_0x172b0d);return;}const _0xad3db6=_0x2e545a['closest']('.playlist-item-info');if(_0xad3db6){const _0x4381f5=_0xad3db6[_0x5648cf(0x106f)](_0x5648cf(0x7af)),_0x54c79a=Array[_0x5648cf(0xd97)](_0x4381f5[_0x5648cf(0xbd1)][_0x5648cf(0x6cd)])[_0x5648cf(0x57c)](_0x4381f5);_0x54c79a>-0x1&&_0x2fd6d0(_0x54c79a);}}),document[_0x11344e(0x139c)](_0x11344e(0xf6c))['addEventListener'](_0x11344e(0xb2b),_0x4f4363=>{const _0x43a76c=_0x11344e;if(!_0x2a3e73[_0x43a76c(0xb6a)])return;const _0x545516=_0x4f4363[_0x43a76c(0x44f)],_0x296d78=_0x545516[_0x43a76c(0x703)],_0x1545a5=_0x4f4363[_0x43a76c(0xe74)];_0x2a3e73[_0x43a76c(0x13d0)]=_0x1545a5/_0x296d78*_0x2a3e73[_0x43a76c(0xb6a)];}),document[_0x11344e(0x53a)](_0x11344e(0xa33))[_0x11344e(0x1086)]('click',_0x4055a4=>{const _0x257f71=_0x11344e,_0x280efa=_0x4055a4['target'][_0x257f71(0x106f)](_0x257f71(0x1183));if(_0x280efa){const _0x2a6c32=_0x53d851[_0x257f71(0xaa3)][_0x53d851[_0x257f71(0x13be)]],_0x2c346a=_0x280efa[_0x257f71(0x106f)](_0x257f71(0x5fc));if(_0x2a6c32&&_0x2c346a){const _0x5361be=parseInt(_0x2c346a[_0x257f71(0x999)][_0x257f71(0x827)]),_0x260b5b=_0x2a6c32[_0x257f71(0xe83)]['find'](_0x1b9ad8=>_0x1b9ad8[_0x257f71(0x827)]===_0x5361be);if(_0x260b5b&&_0x260b5b[_0x257f71(0x138a)]){let _0x2c50b2='';const _0x19daa5=_0x260b5b[_0x257f71(0x138a)];switch(_0x19daa5[_0x257f71(0x1384)]){case _0x257f71(0x2e6):_0x2c50b2=_0x257f71(0xca4)+_0x19daa5[_0x257f71(0x124b)]+'\x22';break;case _0x257f71(0x1053):case _0x257f71(0x2a5):case _0x257f71(0xa9a):_0x2c50b2=_0x257f71(0x885)+_0x19daa5[_0x257f71(0x124b)]+'\x22';break;case _0x257f71(0x64f):_0x2c50b2=_0x257f71(0xb65)+_0x19daa5[_0x257f71(0x124b)]+'\x22';break;case _0x257f71(0x257):_0x2c50b2='[表情]\x20含义:\x20\x22'+(_0x19daa5['originalMeaning']||_0x257f71(0x694))+_0x257f71(0x57f)+_0x19daa5['originalContent'];break;case _0x257f71(0x566):_0x2c50b2=_0x257f71(0x4f3);break;default:_0x2c50b2='撤回了一条['+_0x19daa5[_0x257f71(0x1384)]+']类型的消息。\x0a内容:\x20'+JSON[_0x257f71(0xe1e)](_0x19daa5[_0x257f71(0x124b)]);break;}_0x184397(_0x257f71(0x232),_0x2c50b2);}}}}),document[_0x11344e(0x53a)]('manage-world-book-categories-btn')['addEventListener']('click',_0x2c8734),document[_0x11344e(0x53a)](_0x11344e(0x122d))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x4364ff=_0x11344e;document[_0x4364ff(0x53a)](_0x4364ff(0xad5))[_0x4364ff(0x1276)][_0x4364ff(0x2d4)](_0x4364ff(0xaef)),_0x1f59bd();}),document['getElementById'](_0x11344e(0x6fa))[_0x11344e(0x1086)]('click',_0x380bc9),document['getElementById']('existing-categories-list')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x24fadb=>{const _0x59b2fe=_0x11344e;if(_0x24fadb['target'][_0x59b2fe(0x1276)][_0x59b2fe(0x6a3)](_0x59b2fe(0xf79))){const _0x322bb9=parseInt(_0x24fadb['target'][_0x59b2fe(0x999)]['id']);_0x11a111(_0x322bb9);}}),document[_0x11344e(0x53a)](_0x11344e(0x1259))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x381a07),document[_0x11344e(0x53a)]('repost-confirm-btn')['addEventListener'](_0x11344e(0xb2b),_0x3e98b3),document[_0x11344e(0x53a)](_0x11344e(0xabd))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x557ca2),document['getElementById']('cancel-reply-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x33fd8c),document[_0x11344e(0x53a)](_0x11344e(0x4a9))[_0x11344e(0x1086)](_0x11344e(0x1174),_0x3894de=>{const _0x43b1b5=_0x11344e;if(!_0x3894de['target'][_0x43b1b5(0x1443)]('.comment-input'))return;const _0x1e5fdb=_0x3894de[_0x43b1b5(0x9c2)],_0x1785a1=_0x1e5fdb[_0x43b1b5(0x106f)]('.qzone-post-container');if(!_0x1785a1)return;const _0x120f06=_0x1785a1['querySelector'](_0x43b1b5(0x85d)),_0x302f90=_0x1e5fdb['value'],_0x4d809b=_0x302f90[_0x43b1b5(0x1120)](/@([\p{L}\w]*)$/u);if(_0x4d809b){const _0x1fa20b=new Set(),_0xf44583=_0x1785a1[_0x43b1b5(0x139c)](_0x43b1b5(0x626))?.[_0x43b1b5(0x34a)];if(_0xf44583)_0x1fa20b[_0x43b1b5(0xe13)](_0xf44583);_0x1785a1[_0x43b1b5(0xc3d)](_0x43b1b5(0x46b))[_0x43b1b5(0xeaf)](_0x3e2b6f=>{const _0x33b7e4=_0x43b1b5;_0x1fa20b[_0x33b7e4(0xe13)](_0x3e2b6f['textContent'][_0x33b7e4(0x795)](':',''));}),_0x1fa20b[_0x43b1b5(0x121e)](_0x53d851[_0x43b1b5(0xa74)][_0x43b1b5(0x1005)]),_0x120f06['innerHTML']='';if(_0x1fa20b[_0x43b1b5(0x38e)]>0x0){const _0x2cde4c=_0x4d809b[0x1];_0x1fa20b['forEach'](_0x217279=>{const _0x1a051e=_0x43b1b5;if(_0x217279[_0x1a051e(0x12b5)]()['includes'](_0x2cde4c[_0x1a051e(0x12b5)]())){const _0x3f126f=document[_0x1a051e(0xd67)](_0x1a051e(0x1425));_0x3f126f['className']='at-mention-item',_0x3f126f[_0x1a051e(0x34a)]=_0x217279,_0x3f126f['addEventListener'](_0x1a051e(0xff3),_0x55e7b3=>{const _0x4ebd53=_0x1a051e;_0x55e7b3[_0x4ebd53(0x1013)]();const _0x4c14c6=_0x302f90[_0x4ebd53(0xad6)](0x0,_0x4d809b[_0x4ebd53(0xd52)])+('@'+_0x217279+'\x20');_0x1e5fdb[_0x4ebd53(0x11a2)]=_0x4c14c6,_0x120f06[_0x4ebd53(0x1284)][_0x4ebd53(0x11d9)]='none',_0x1e5fdb[_0x4ebd53(0x78d)]();}),_0x120f06[_0x1a051e(0x133d)](_0x3f126f);}}),_0x120f06[_0x43b1b5(0x1284)][_0x43b1b5(0x11d9)]=_0x120f06[_0x43b1b5(0x6cd)][_0x43b1b5(0x29d)]>0x0?_0x43b1b5(0x1ea):'none';}else _0x120f06[_0x43b1b5(0x1284)][_0x43b1b5(0x11d9)]='none';}else _0x120f06[_0x43b1b5(0x1284)][_0x43b1b5(0x11d9)]=_0x43b1b5(0xbf2);}),document['getElementById'](_0x11344e(0x4a9))[_0x11344e(0x1086)]('focusout',_0x304736=>{const _0x3ab04d=_0x11344e;if(_0x304736[_0x3ab04d(0x9c2)][_0x3ab04d(0x1443)](_0x3ab04d(0xc94))){const _0x4f0a99=_0x304736[_0x3ab04d(0x9c2)][_0x3ab04d(0x106f)]('.qzone-post-container');if(_0x4f0a99){const _0x1a823f=_0x4f0a99[_0x3ab04d(0x139c)](_0x3ab04d(0x85d));_0x1a823f&&setTimeout(()=>{const _0x156c5d=_0x3ab04d;_0x1a823f[_0x156c5d(0x1284)][_0x156c5d(0x11d9)]=_0x156c5d(0xbf2);},0xc8);}}});const _0x29e25e=document['getElementById'](_0x11344e(0x2b1)),_0x53acee=document['getElementById'](_0x11344e(0x96a));_0x29e25e[_0x11344e(0x1086)]('input',()=>{const _0x445584=_0x11344e;if(!_0x53d851['activeChatId']||!_0x53d851[_0x445584(0xaa3)][_0x53d851['activeChatId']]['isGroup']){_0x53acee[_0x445584(0x1284)][_0x445584(0x11d9)]=_0x445584(0xbf2);return;}const _0x2b996c=_0x53d851['chats'][_0x53d851[_0x445584(0x13be)]],_0x136cfb=_0x29e25e['value'],_0x5e5af4=_0x136cfb[_0x445584(0x1120)](/@([\p{L}\w]*)$/u);if(_0x5e5af4){const _0x165b2b=_0x2b996c[_0x445584(0x81e)][_0x445584(0x1303)]||'我',_0x4f820f=_0x2b996c['members'][_0x445584(0xcb4)](_0x2014f3=>_0x2014f3[_0x445584(0x12bc)])['filter'](_0x5f0efb=>_0x5f0efb!==_0x165b2b);_0x53acee[_0x445584(0xaac)]='';if(_0x4f820f[_0x445584(0x29d)]>0x0){const _0x25540b=_0x5e5af4[0x1];_0x4f820f[_0x445584(0xeaf)](_0xdd56f4=>{const _0x186885=_0x445584;if(_0xdd56f4[_0x186885(0x12b5)]()[_0x186885(0x6e9)](_0x25540b['toLowerCase']())){const _0x43fc4a=document[_0x186885(0xd67)]('div');_0x43fc4a[_0x186885(0x6de)]=_0x186885(0xf93),_0x43fc4a['textContent']=_0xdd56f4,_0x43fc4a[_0x186885(0x1086)]('mousedown',_0x529f08=>{const _0x23be96=_0x186885;_0x529f08['preventDefault']();const _0x51969a=_0x136cfb[_0x23be96(0xad6)](0x0,_0x5e5af4[_0x23be96(0xd52)])+('@'+_0xdd56f4+'\x20');_0x29e25e[_0x23be96(0x11a2)]=_0x51969a,_0x53acee['style'][_0x23be96(0x11d9)]='none',_0x29e25e[_0x23be96(0x78d)]();}),_0x53acee[_0x186885(0x133d)](_0x43fc4a);}}),_0x53acee[_0x445584(0x1284)][_0x445584(0x11d9)]=_0x53acee['children'][_0x445584(0x29d)]>0x0?_0x445584(0x1ea):_0x445584(0xbf2);}else _0x53acee[_0x445584(0x1284)][_0x445584(0x11d9)]=_0x445584(0xbf2);}else _0x53acee['style'][_0x445584(0x11d9)]=_0x445584(0xbf2);}),_0x29e25e[_0x11344e(0x1086)](_0x11344e(0x642),()=>{setTimeout(()=>{const _0x43bb65=_0x55b8;_0x53acee['style'][_0x43bb65(0x11d9)]=_0x43bb65(0xbf2);},0xc8);}),document[_0x11344e(0x53a)](_0x11344e(0x1209))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x3e6712),document[_0x11344e(0x53a)](_0x11344e(0xae2))['addEventListener'](_0x11344e(0xb2b),_0x3a1384),document['getElementById'](_0x11344e(0xe91))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x6bd87b=_0x11344e;document['getElementById'](_0x6bd87b(0x385))['classList'][_0x6bd87b(0x2d4)](_0x6bd87b(0xaef));}),document[_0x11344e(0x53a)]('announcement-board-content')['addEventListener'](_0x11344e(0xb2b),_0x177aba=>{const _0x35cf88=_0x11344e;if(_0x177aba['target']['classList'][_0x35cf88(0x6a3)](_0x35cf88(0x632))){const _0x5745c2=_0x177aba[_0x35cf88(0x9c2)][_0x35cf88(0x999)]['annoId'];_0x5745c2&&_0x1188aa(_0x5745c2);}}),document[_0x11344e(0x53a)]('announcement-action-pin')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x598d0b),document[_0x11344e(0x53a)](_0x11344e(0x496))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x554056),document[_0x11344e(0x53a)](_0x11344e(0x351))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x44f5fb=_0x11344e;document['getElementById']('announcement-actions-modal')['classList'][_0x44f5fb(0x2d4)](_0x44f5fb(0xaef));}),document[_0x11344e(0x53a)]('reset-global-css-btn')[_0x11344e(0x1086)]('click',()=>{const _0x32a5aa=_0x11344e;document[_0x32a5aa(0x53a)]('global-css-input')[_0x32a5aa(0x11a2)]='';}),document[_0x11344e(0x53a)](_0x11344e(0x1449))['addEventListener'](_0x11344e(0xb2b),_0x44f259),document[_0x11344e(0x53a)](_0x11344e(0x939))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x423a3a=_0x11344e;_0x541a81(_0x423a3a(0x10ba));}),document[_0x11344e(0x53a)]('add-manual-memory-btn-header')['addEventListener'](_0x11344e(0xb2b),_0x4b04e3),document['getElementById'](_0x11344e(0x2c4))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x476fd3),document['getElementById'](_0x11344e(0x8f7))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x463a52=>{const _0x3bcc02=_0x11344e,_0x3e97d3=_0x463a52[_0x3bcc02(0x9c2)][_0x3bcc02(0x106f)](_0x3bcc02(0x3e6));if(_0x3e97d3){_0xfec2b7(_0x3e97d3[_0x3bcc02(0x999)][_0x3bcc02(0xa59)],parseInt(_0x3e97d3['dataset'][_0x3bcc02(0x3e5)]));return;}const _0x408027=_0x463a52[_0x3bcc02(0x9c2)]['closest'](_0x3bcc02(0x470));if(_0x408027){_0x432b32(_0x408027[_0x3bcc02(0x999)][_0x3bcc02(0xa59)],parseInt(_0x408027[_0x3bcc02(0x999)][_0x3bcc02(0x3e5)]));return;}}),document[_0x11344e(0x53a)](_0x11344e(0x27c))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x3a1dfe),document[_0x11344e(0x53a)]('close-gomoku-btn')['addEventListener'](_0x11344e(0xb2b),_0x13cecc);const _0x593a9e=document[_0x11344e(0x53a)](_0x11344e(0x11ee));_0x593a9e[_0x11344e(0x1086)](_0x11344e(0xef3),_0x38f514),_0x593a9e[_0x11344e(0x1086)](_0x11344e(0x1190),()=>_0x276755(_0x53d851['activeChatId'])),_0x593a9e['addEventListener'](_0x11344e(0xb2b),_0x101879),document['getElementById'](_0x11344e(0x916))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x4ed897=_0x11344e;document[_0x4ed897(0x53a)](_0x4ed897(0xe7b))[_0x4ed897(0x11a2)]='',document[_0x4ed897(0x53a)](_0x4ed897(0x430))[_0x4ed897(0x11a2)]='',document['getElementById'](_0x4ed897(0xed5))[_0x4ed897(0x1276)]['add'](_0x4ed897(0xaef));}),document['getElementById'](_0x11344e(0xd8f))[_0x11344e(0x1086)]('click',()=>{const _0x210172=_0x11344e;document[_0x210172(0x53a)](_0x210172(0xed5))[_0x210172(0x1276)][_0x210172(0x2d4)](_0x210172(0xaef));}),document[_0x11344e(0x53a)](_0x11344e(0x750))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0xd27b0f),document[_0x11344e(0x53a)](_0x11344e(0xf99))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x31ac69),document[_0x11344e(0x53a)](_0x11344e(0x71f))['addEventListener']('click',_0x582162),document[_0x11344e(0x53a)](_0x11344e(0xc7b))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x13426b),document[_0x11344e(0x53a)](_0x11344e(0x130d))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x35f86f=_0x11344e;document[_0x35f86f(0x53a)]('ai-response-editor-modal')[_0x35f86f(0x1276)][_0x35f86f(0x2d4)](_0x35f86f(0xaef));}),document['getElementById'](_0x11344e(0x1385))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x5aa38b),document[_0x11344e(0x53a)](_0x11344e(0x830))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0xfa0e57=_0x11344e,_0x16e40f=document[_0xfa0e57(0x53a)](_0xfa0e57(0x13f7)),_0x35716b=_0x2e41c7('{\x0a\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x22content\x22:\x20\x22在这里输入新消息...\x22\x0a}');_0x16e40f['appendChild'](_0x35716b),_0x35716b[_0xfa0e57(0x139c)](_0xfa0e57(0x728))[_0xfa0e57(0x78d)]();}),document[_0x11344e(0x53a)]('manage-my-avatar-library-btn')[_0x11344e(0x1086)]('click',_0x25be2c),document['getElementById']('close-my-avatar-library-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x5516fa),document[_0x11344e(0x53a)]('add-my-avatar-url-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x753a66),document[_0x11344e(0x53a)](_0x11344e(0x1302))['addEventListener'](_0x11344e(0xb2b),()=>{const _0x412626=_0x11344e;document[_0x412626(0x53a)](_0x412626(0xd04))[_0x412626(0xb2b)]();}),document['getElementById'](_0x11344e(0xd04))[_0x11344e(0x1086)](_0x11344e(0x325),_0x139e68),document[_0x11344e(0x53a)](_0x11344e(0x532))[_0x11344e(0x1086)]('click',async()=>{const _0x5b6e19=_0x11344e,_0x5d46c8=_0x5b6e19(0xd5b),_0x44de6f=await _0x4f6537(_0x5b6e19(0xa83),_0x5d46c8,'',_0x5b6e19(0x728));_0x44de6f&&_0x44de6f[_0x5b6e19(0x13bc)]()&&await _0x5dd556(_0x44de6f);}),document[_0x11344e(0x53a)](_0x11344e(0x1002))['addEventListener']('click',_0x48f141),document[_0x11344e(0x53a)](_0x11344e(0x516))[_0x11344e(0x1086)]('click',()=>_0x541a81(_0x11344e(0x10ba))),document[_0x11344e(0x53a)]('go-to-cart-btn')['addEventListener'](_0x11344e(0xb2b),_0x341fe5),document['getElementById'](_0x11344e(0x3a5))[_0x11344e(0x1086)]('click',_0x48f141),document[_0x11344e(0x53a)](_0x11344e(0x50c))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x34ed36),document[_0x11344e(0x53a)]('close-receipt-btn')['addEventListener'](_0x11344e(0xb2b),()=>{const _0x55f2d5=_0x11344e;document[_0x55f2d5(0x53a)](_0x55f2d5(0x6c9))[_0x55f2d5(0x1276)][_0x55f2d5(0x2d4)](_0x55f2d5(0xaef));}),document['getElementById'](_0x11344e(0xb39))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x18f078=_0x11344e;_0x5e4a35=!_0x5e4a35;const _0x33df82=document[_0x18f078(0x53a)](_0x18f078(0xb39)),_0x44baf6=document[_0x18f078(0x53a)]('shopping-action-bar'),_0x3d7042=document[_0x18f078(0x53a)](_0x18f078(0x1f6));_0x33df82[_0x18f078(0x1284)]['color']=_0x5e4a35?'var(--accent-color)':_0x18f078(0xf3e),_0x5e4a35?(_0x44baf6[_0x18f078(0x1284)][_0x18f078(0x11d9)]=_0x18f078(0x2f6),_0x3d7042[_0x18f078(0x1284)][_0x18f078(0x6e4)]='80px'):(_0x44baf6[_0x18f078(0x1284)]['display']='none',_0x3d7042['style'][_0x18f078(0x6e4)]='',_0x14d88b[_0x18f078(0xfcf)](),document[_0x18f078(0xc3d)](_0x18f078(0x2aa))['forEach'](_0x5c3398=>_0x5c3398[_0x18f078(0x1276)][_0x18f078(0x2d4)](_0x18f078(0x1015))),document[_0x18f078(0x53a)](_0x18f078(0x64e))[_0x18f078(0x34a)]='删除\x20(0)',document[_0x18f078(0x53a)](_0x18f078(0xe42))[_0x18f078(0x1077)]=![]),_0x568252(),_0x2d8c6d();}),document[_0x11344e(0x53a)](_0x11344e(0xf55))['addEventListener'](_0x11344e(0xb2b),()=>{const _0xb5d2fb=_0x11344e;_0x5e4a35?_0x5da4a1(null):alert(_0xb5d2fb(0x3ee));}),document['getElementById'](_0x11344e(0x1f6))['addEventListener'](_0x11344e(0xb2b),async _0x4412f1=>{const _0x809cca=_0x11344e,_0x3dddc4=_0x4412f1['target'][_0x809cca(0x106f)](_0x809cca(0xc3c));if(!_0x3dddc4)return;const _0x4d62d6=parseInt(_0x3dddc4['dataset']['id']);if(isNaN(_0x4d62d6))return;if(_0x5e4a35){if(_0x4412f1[_0x809cca(0x9c2)][_0x809cca(0x1276)][_0x809cca(0x6a3)](_0x809cca(0xa12))){_0x5da4a1(_0x4d62d6);return;}if(_0x4412f1[_0x809cca(0x9c2)]['classList'][_0x809cca(0x6a3)](_0x809cca(0xdd3))){const _0x377585=await _0xa62efb[_0x809cca(0x1257)][_0x809cca(0x883)](_0x4d62d6);if(!_0x377585)return;const _0x51d7d9=await _0x355fc0('删除商品',_0x809cca(0xa3b)+_0x377585[_0x809cca(0x234)]+'”\x20吗？',{'confirmButtonClass':_0x809cca(0x264)});_0x51d7d9&&(await _0xa62efb[_0x809cca(0x1257)]['delete'](_0x4d62d6),await _0x568252(),alert(_0x809cca(0xea1)));return;}_0x3dddc4[_0x809cca(0x1276)][_0x809cca(0x4d7)](_0x809cca(0x1015));_0x14d88b['has'](_0x4d62d6)?_0x14d88b[_0x809cca(0x121e)](_0x4d62d6):_0x14d88b[_0x809cca(0xe13)](_0x4d62d6);document[_0x809cca(0x53a)]('delete-selected-products-btn')[_0x809cca(0x34a)]=_0x809cca(0xf3c)+_0x14d88b[_0x809cca(0x38e)]+')';return;}if(_0x4412f1[_0x809cca(0x9c2)]['classList'][_0x809cca(0x6a3)](_0x809cca(0x75d))){const _0x1485bd=await _0xa62efb[_0x809cca(0x1257)]['get'](_0x4d62d6);_0x1485bd['variations']&&_0x1485bd[_0x809cca(0xfdb)][_0x809cca(0x29d)]>0x0?_0x579250(_0x4d62d6):(await _0x151669(_0x4d62d6),await _0x184397('成功','已成功加入购物车！'));return;}_0x3dddc4[_0x809cca(0x6a3)](_0x4412f1['target'])&&console[_0x809cca(0x1081)](_0x809cca(0xc87)+_0x4d62d6);}),document[_0x11344e(0x53a)](_0x11344e(0x336))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0xe89ff7=>{const _0x3dfe0a=_0x11344e,_0x3435b4=_0xe89ff7[_0x3dfe0a(0x9c2)];_0x3435b4[_0x3dfe0a(0x1276)][_0x3dfe0a(0x6a3)](_0x3dfe0a(0x6af))&&_0x1827c5(parseInt(_0x3435b4['dataset']['id']),-0x1),_0x3435b4[_0x3dfe0a(0x1276)][_0x3dfe0a(0x6a3)](_0x3dfe0a(0x12a9))&&_0x1827c5(parseInt(_0x3435b4[_0x3dfe0a(0x999)]['id']),0x1),_0x3435b4['classList']['contains'](_0x3dfe0a(0x9a5))&&_0x184c57();}),document[_0x11344e(0x53a)](_0x11344e(0x1283))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x34e414=_0x11344e;if(_0x3db08a['length']===0x0)return;const _0x219adf=await _0x355fc0(_0x34e414(0xabe),_0x34e414(0x1418));_0x219adf&&(_0x3db08a=[],_0x575b6f(),_0x3b6dc1());}),document[_0x11344e(0x53a)](_0x11344e(0x394))[_0x11344e(0x1086)](_0x11344e(0x325),function(_0x5dd243){const _0xcb12db=_0x11344e;document[_0xcb12db(0xc3d)]('.cart-item-checkbox')[_0xcb12db(0xeaf)](_0x20d816=>{const _0x4af570=_0xcb12db;_0x20d816[_0x4af570(0x1077)]=_0x5dd243['target'][_0x4af570(0x1077)];}),_0x184c57();}),document[_0x11344e(0x53a)](_0x11344e(0x1131))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x589484=_0x11344e;document[_0x589484(0x53a)]('product-editor-modal')[_0x589484(0x1276)][_0x589484(0x2d4)](_0x589484(0xaef));}),document[_0x11344e(0x53a)](_0x11344e(0xeca))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x3d1c1b),document['getElementById'](_0x11344e(0x11b7))[_0x11344e(0x1086)](_0x11344e(0x325),_0x277d68=>{const _0x40350d=_0x11344e,_0x3c409e=_0x277d68[_0x40350d(0x9c2)]['files'][0x0];if(_0x3c409e){const _0x5d16fb=new FileReader();_0x5d16fb[_0x40350d(0x110f)]=_0x1062cb=>{const _0xb2fd36=_0x40350d;document[_0xb2fd36(0x53a)](_0xb2fd36(0x1f5))[_0xb2fd36(0x7ff)]=_0x1062cb[_0xb2fd36(0x9c2)]['result'];},_0x5d16fb[_0x40350d(0x13b6)](_0x3c409e);}}),document[_0x11344e(0x53a)](_0x11344e(0xa33))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x2fce95=>{const _0x39ed1a=_0x11344e,_0x5e38be=_0x2fce95[_0x39ed1a(0x9c2)]['closest']('.gift-card');if(_0x5e38be){const _0x46d51b=_0x5e38be['closest'](_0x39ed1a(0x401));_0x46d51b&&_0x40bff8(parseInt(_0x46d51b[_0x39ed1a(0x999)]['timestamp']));}}),document[_0x11344e(0x53a)]('cancel-gift-recipient-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x5c0b1c=_0x11344e;document['getElementById'](_0x5c0b1c(0xae6))[_0x5c0b1c(0x1276)][_0x5c0b1c(0x2d4)]('visible');}),document[_0x11344e(0x53a)](_0x11344e(0x112e))[_0x11344e(0x1086)]('click',async()=>{const _0x2c0c7e=_0x11344e,_0x2f2ea4=Array['from'](document[_0x2c0c7e(0xc3d)](_0x2c0c7e(0xe8e)))['map'](_0x6bb390=>_0x6bb390[_0x2c0c7e(0x999)][_0x2c0c7e(0x283)]);if(_0x2f2ea4[_0x2c0c7e(0x29d)]===0x0){alert(_0x2c0c7e(0x4ba));return;}const _0x45663c=_0x3db08a['filter'](_0x11888e=>document[_0x2c0c7e(0x139c)](_0x2c0c7e(0x85a)+_0x11888e[_0x2c0c7e(0x7ac)]+_0x2c0c7e(0x10c5)));await _0x329a69(_0x45663c,_0x2f2ea4),document[_0x2c0c7e(0x53a)]('gift-recipient-modal')[_0x2c0c7e(0x1276)]['remove'](_0x2c0c7e(0xaef));}),document[_0x11344e(0x53a)](_0x11344e(0x1306))['addEventListener'](_0x11344e(0xb2b),_0x2c8d64=>{const _0xf1b61b=_0x11344e,_0x171902=_0x2c8d64[_0xf1b61b(0x9c2)][_0xf1b61b(0x106f)]('.contact-picker-item');_0x171902&&_0x171902[_0xf1b61b(0x1276)][_0xf1b61b(0x4d7)](_0xf1b61b(0x1015));}),document[_0x11344e(0x53a)](_0x11344e(0x7a9))[_0x11344e(0x1086)](_0x11344e(0x325),function(_0x3956cc){const _0x3b5912=_0x11344e,_0x4a7ff6=_0x3956cc[_0x3b5912(0x9c2)]['checked'];document['querySelectorAll'](_0x3b5912(0x28d))[_0x3b5912(0xeaf)](_0x21a8f5=>{const _0x1e2af2=_0x3b5912;_0x21a8f5[_0x1e2af2(0x1276)]['toggle'](_0x1e2af2(0x1015),_0x4a7ff6);});}),document['getElementById'](_0x11344e(0xbc6))[_0x11344e(0x1086)]('click',_0x511546),document[_0x11344e(0x53a)](_0x11344e(0x533))[_0x11344e(0x1086)]('click',_0x30decf),document[_0x11344e(0x53a)](_0x11344e(0xdb6))['addEventListener']('click',_0x1bef42),document[_0x11344e(0x53a)]('test-sound-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x2637c4=_0x11344e,_0x4ff435=document[_0x2637c4(0x53a)]('notification-sound-player'),_0x5d3c74=document['getElementById'](_0x2637c4(0x22d))[_0x2637c4(0x11a2)][_0x2637c4(0x13bc)]()||_0x480f21;_0x4ff435[_0x2637c4(0x7ff)]=_0x5d3c74,_0x4ff435[_0x2637c4(0x116c)]()[_0x2637c4(0x9cb)](_0xb160c2=>alert(_0x2637c4(0x343)));}),document[_0x11344e(0x53a)](_0x11344e(0x30d))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x363c60=_0x11344e;document['getElementById'](_0x363c60(0x22d))[_0x363c60(0x11a2)]='',alert('已重置为默认提示音，点击“保存所有外观设置”后生效。');}),document[_0x11344e(0x53a)](_0x11344e(0x2ab))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x595cf9=>{const _0x92e394=_0x11344e,_0x3bdb6e=_0x595cf9[_0x92e394(0x9c2)];_0x3bdb6e[_0x92e394(0x1276)][_0x92e394(0x6a3)](_0x92e394(0x52b))&&_0x2fa338(_0x3bdb6e),_0x3bdb6e[_0x92e394(0x1276)][_0x92e394(0x6a3)]('editable-image')&&_0x27fa51(_0x3bdb6e);}),document[_0x11344e(0x53a)]('add-song-search-btn')[_0x11344e(0x1086)]('click',_0x254455),document[_0x11344e(0x53a)]('cancel-music-search-btn')[_0x11344e(0x1086)]('click',()=>{const _0x3fcd8b=_0x11344e;document[_0x3fcd8b(0x53a)](_0x3fcd8b(0x576))[_0x3fcd8b(0x1276)]['remove']('visible');}),document[_0x11344e(0x53a)]('add-song-search-btn')[_0x11344e(0x1086)]('click',_0x254455),document[_0x11344e(0x53a)]('cancel-music-search-btn')['addEventListener'](_0x11344e(0xb2b),()=>{const _0x462390=_0x11344e;document[_0x462390(0x53a)](_0x462390(0x576))[_0x462390(0x1276)][_0x462390(0x2d4)](_0x462390(0xaef));}),document['getElementById']('select-all-music-search')[_0x11344e(0x1086)]('change',function(_0x56dfbb){const _0x500ead=_0x11344e;document[_0x500ead(0xc3d)](_0x500ead(0xddd))['forEach'](_0x2cbd7d=>{const _0x439238=_0x500ead;_0x2cbd7d[_0x439238(0x1077)]=_0x56dfbb['target'][_0x439238(0x1077)];});}),document[_0x11344e(0x53a)](_0x11344e(0x36e))[_0x11344e(0x1086)]('click',_0x4b208f=>{const _0x5de853=_0x11344e,_0x27ff9c=_0x4b208f[_0x5de853(0x9c2)][_0x5de853(0x106f)](_0x5de853(0x8d6));if(_0x27ff9c){const _0x4d17df=_0x27ff9c['querySelector'](_0x5de853(0x764));_0x4d17df&&(_0x4b208f[_0x5de853(0x9c2)]!==_0x4d17df&&(_0x4d17df['checked']=!_0x4d17df['checked']));}}),document[_0x11344e(0x53a)](_0x11344e(0x10cd))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x4ea9cd=_0x11344e,_0x5b93bf=document[_0x4ea9cd(0xc3d)](_0x4ea9cd(0x1e5));if(_0x5b93bf[_0x4ea9cd(0x29d)]===0x0){alert('请先选择要添加的歌曲。');return;}document[_0x4ea9cd(0x53a)]('music-search-results-modal')['classList'][_0x4ea9cd(0x2d4)]('visible'),await _0x184397(_0x4ea9cd(0x11d7),'正在批量添加\x20'+_0x5b93bf[_0x4ea9cd(0x29d)]+_0x4ea9cd(0x5b3));const _0xa71dca=Array[_0x4ea9cd(0xd97)](_0x5b93bf)[_0x4ea9cd(0xcb4)](_0x5b058f=>JSON[_0x4ea9cd(0x367)](_0x5b058f[_0x4ea9cd(0x106f)]('.search-result-item')['dataset'][_0x4ea9cd(0xef2)]));let _0x13ebfd=0x0,_0x1dd180=[];const _0x4e9592=_0xa71dca[_0x4ea9cd(0xcb4)](_0xb13592=>_0x4f9833(_0xb13592)),_0xfbc9e=await Promise[_0x4ea9cd(0x63d)](_0x4e9592);_0xfbc9e[_0x4ea9cd(0xeaf)]((_0x3a4da2,_0x3db1e7)=>{const _0x15a9c0=_0x4ea9cd;_0x3a4da2?(_0x2eebda['playlist'][_0x15a9c0(0x7dd)](_0x3a4da2),_0x13ebfd++):_0x1dd180['push'](_0xa71dca[_0x3db1e7]['name']);});_0x13ebfd>0x0&&(await _0x4cf2f7(),_0x3c76c6(),_0x2eebda[_0x4ea9cd(0xe7d)]===-0x1&&(_0x2eebda['currentIndex']=_0x2eebda['playlist'][_0x4ea9cd(0x29d)]-_0x13ebfd,_0x1dfd4f()));let _0x2e20a2=_0x4ea9cd(0xc17)+_0x13ebfd+_0x4ea9cd(0x2ce);_0x1dd180[_0x4ea9cd(0x29d)]>0x0&&(_0x2e20a2+='\x0a\x0a'+_0x1dd180[_0x4ea9cd(0x29d)]+_0x4ea9cd(0xece)+_0x1dd180[_0x4ea9cd(0x2c8)](_0x4ea9cd(0xf07))),await _0x184397(_0x4ea9cd(0xcde),_0x2e20a2);}),document['getElementById'](_0x11344e(0x1137))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x4335cf=_0x11344e;document[_0x4335cf(0x53a)](_0x4335cf(0x1137))['classList'][_0x4335cf(0x4d7)](_0x4335cf(0x943));}),document['getElementById'](_0x11344e(0x381))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x254455),document[_0x11344e(0x53a)](_0x11344e(0xd4a))['addEventListener'](_0x11344e(0xb2b),()=>{const _0x5e00c7=_0x11344e;document[_0x5e00c7(0x53a)](_0x5e00c7(0x576))[_0x5e00c7(0x1276)]['remove'](_0x5e00c7(0xaef));}),document[_0x11344e(0x53a)](_0x11344e(0x36e))[_0x11344e(0x1086)]('click',_0x52f802=>{const _0x445010=_0x11344e,_0x47c51f=_0x52f802[_0x445010(0x9c2)]['closest'](_0x445010(0x8d6));if(_0x47c51f&&_0x47c51f[_0x445010(0x999)][_0x445010(0xef2)]){const _0x28430b=JSON[_0x445010(0x367)](_0x47c51f['dataset'][_0x445010(0xef2)]);handleSearchResultClick(_0x28430b);}}),document[_0x11344e(0x53a)](_0x11344e(0x1260))[_0x11344e(0x1086)]('click',_0xde2393),document[_0x11344e(0x53a)](_0x11344e(0x1429))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x3cdab5),document[_0x11344e(0x53a)]('toggle-fullscreen-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x23f578),document[_0x11344e(0x53a)](_0x11344e(0xc1d))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x40bf4d),document['getElementById'](_0x11344e(0xcb5))['addEventListener'](_0x11344e(0x325),()=>{const _0x476816=_0x11344e;_0x53d851['globalSettings']['showStatusBar']=document['getElementById']('status-bar-toggle-switch')[_0x476816(0x1077)],_0x39c21c();}),document[_0x11344e(0x53a)](_0x11344e(0x955))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x447d81),document[_0x11344e(0x53a)]('cancel-clear-posts-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x21d8a6=_0x11344e;document[_0x21d8a6(0x53a)]('clear-posts-modal')['classList'][_0x21d8a6(0x2d4)]('visible');}),document[_0x11344e(0x53a)]('confirm-clear-posts-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x55211c),document['getElementById'](_0x11344e(0x720))['addEventListener'](_0x11344e(0xb2b),_0x40a1c7=>{const _0x26c970=_0x11344e,_0x4d36d0=_0x40a1c7[_0x26c970(0x9c2)]['closest']('.clear-posts-item');_0x4d36d0&&_0x4d36d0[_0x26c970(0x1276)][_0x26c970(0x4d7)](_0x26c970(0x1015));}),document[_0x11344e(0x53a)](_0x11344e(0x7f1))['addEventListener'](_0x11344e(0x325),async _0x98b644=>{const _0x4065f7=_0x11344e,_0x5a579b=_0x98b644[_0x4065f7(0x9c2)]['files'][0x0];if(_0x5a579b){const _0x233cc1=await new Promise(_0x1f0a51=>{const _0x176a57=_0x4065f7,_0x506871=new FileReader();_0x506871[_0x176a57(0x110f)]=()=>_0x1f0a51(_0x506871[_0x176a57(0xa2a)]),_0x506871[_0x176a57(0x13b6)](_0x5a579b);});_0x53d851[_0x4065f7(0x906)][_0x4065f7(0xbc0)]=_0x233cc1,_0x24b0a8();}_0x98b644[_0x4065f7(0x9c2)][_0x4065f7(0x11a2)]=null;}),document[_0x11344e(0x53a)](_0x11344e(0xa3a))[_0x11344e(0x1086)]('click',()=>{const _0x41d08d=_0x11344e;_0x53d851[_0x41d08d(0x906)][_0x41d08d(0xbc0)]='',_0x24b0a8();}),document[_0x11344e(0x53a)](_0x11344e(0x540))[_0x11344e(0x1086)]('click',async()=>{const _0x77c73d=_0x11344e;_0x497271&&(_0x53d851[_0x77c73d(0x906)][_0x77c73d(0x8ee)]=_0x497271),_0x53d851[_0x77c73d(0x906)][_0x77c73d(0x114d)]=document[_0x77c73d(0x53a)](_0x77c73d(0x1387))[_0x77c73d(0x11a2)][_0x77c73d(0x13bc)](),_0x53d851['globalSettings'][_0x77c73d(0x1159)]=document[_0x77c73d(0x53a)](_0x77c73d(0x22d))[_0x77c73d(0x11a2)][_0x77c73d(0x13bc)](),_0x53d851[_0x77c73d(0x906)][_0x77c73d(0xab5)]=document[_0x77c73d(0x53a)](_0x77c73d(0xcb5))[_0x77c73d(0x1077)],await _0xa62efb[_0x77c73d(0x906)][_0x77c73d(0x546)](_0x53d851[_0x77c73d(0x906)]),_0x1ce9d9(),_0x497271=null,_0x40e495(),_0x1c3306(_0x53d851[_0x77c73d(0x906)][_0x77c73d(0x114d)]),_0x39c21c(),alert(_0x77c73d(0x5f0)),_0x541a81('home-screen');}),document[_0x11344e(0x53a)]('upload-global-bg-url-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x5822cf=_0x11344e,_0xcb429a=await _0x4f6537(_0x5822cf(0x649),_0x5822cf(0x10a9),'',_0x5822cf(0xb36));if(_0xcb429a&&_0xcb429a['trim']())_0x53d851['globalSettings'][_0x5822cf(0xbc0)]=_0xcb429a[_0x5822cf(0x13bc)](),_0x24b0a8();else _0xcb429a!==null&&alert(_0x5822cf(0x756));}),document[_0x11344e(0x53a)](_0x11344e(0x39f))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x5451c8=_0x11344e,_0x70df3a=await _0x4f6537(_0x5451c8(0x1313),_0x5451c8(0x31a),'',_0x5451c8(0xb36));if(_0x70df3a&&_0x70df3a['trim']())_0x497271=_0x70df3a[_0x5451c8(0x13bc)](),_0x24b0a8();else _0x70df3a!==null&&alert(_0x5451c8(0x756));}),document['getElementById']('upload-cphone-bg-url-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0xf7c3b4=_0x11344e,_0x3ced26=await _0x4f6537(_0xf7c3b4(0xedc),_0xf7c3b4(0x4ef),'',_0xf7c3b4(0xb36));if(_0x3ced26&&_0x3ced26['trim']())_0x53d851[_0xf7c3b4(0x906)]['cphoneWallpaper']=_0x3ced26['trim'](),_0x24b0a8();else _0x3ced26!==null&&alert(_0xf7c3b4(0x756));}),document[_0x11344e(0x53a)](_0x11344e(0x987))[_0x11344e(0x1086)]('click',()=>{const _0x48645c=_0x11344e;_0x497271=null,_0x53d851[_0x48645c(0x906)][_0x48645c(0x8ee)]='',_0x24b0a8();}),document[_0x11344e(0x53a)](_0x11344e(0xbe2))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x537f54=_0x11344e;_0x53d851[_0x537f54(0x906)][_0x537f54(0x227)]='',_0x24b0a8();}),document['getElementById'](_0x11344e(0xbcb))[_0x11344e(0x1086)]('change',_0x3928a1),document[_0x11344e(0x53a)]('save-css-preset-btn')[_0x11344e(0x1086)]('click',_0x5d36a0),document[_0x11344e(0x53a)]('delete-css-preset-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x2e7a4b),document[_0x11344e(0x53a)](_0x11344e(0x857))[_0x11344e(0x1086)]('change',_0x202f54),document[_0x11344e(0x53a)](_0x11344e(0xe4d))[_0x11344e(0x1086)]('click',_0x28aef0),document[_0x11344e(0x53a)](_0x11344e(0xf06))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x5f3845),document[_0x11344e(0x53a)](_0x11344e(0x11e0))[_0x11344e(0x1086)](_0x11344e(0x325),_0x5973fc),document[_0x11344e(0x53a)]('save-theme-preset-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x568b99),document[_0x11344e(0x53a)](_0x11344e(0x697))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x5ca98d),document['getElementById'](_0x11344e(0x1349))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x2d7ead),document['getElementById'](_0x11344e(0xbac))['addEventListener']('click',()=>{const _0x5a54cc=_0x11344e;document[_0x5a54cc(0x53a)](_0x5a54cc(0xf6e))[_0x5a54cc(0x1276)][_0x5a54cc(0x2d4)]('visible'),_0x590e2b();}),document[_0x11344e(0x53a)](_0x11344e(0x13af))['addEventListener'](_0x11344e(0xb2b),_0x1345ab),document[_0x11344e(0x53a)]('existing-sticker-categories-list')[_0x11344e(0x1086)]('click',_0x14d53a=>{const _0x5ac365=_0x11344e;if(_0x14d53a[_0x5ac365(0x9c2)][_0x5ac365(0x1276)][_0x5ac365(0x6a3)](_0x5ac365(0xf79))){const _0x44de05=parseInt(_0x14d53a[_0x5ac365(0x9c2)]['dataset']['id']);_0x185c81(_0x44de05);}}),document['getElementById'](_0x11344e(0x49b))['addEventListener'](_0x11344e(0xb2b),_0x7017d4=>{const _0x3a5474=_0x11344e;if(_0x7017d4[_0x3a5474(0x9c2)]['classList'][_0x3a5474(0x6a3)](_0x3a5474(0x469))){const _0x2eb2ec=_0x7017d4[_0x3a5474(0x9c2)][_0x3a5474(0x999)]['categoryId'],_0x199e71=_0x2eb2ec!==_0x3a5474(0x63d)&&_0x2eb2ec!==_0x3a5474(0x414)?parseInt(_0x2eb2ec):_0x2eb2ec;_0x4eeba4(_0x199e71);}}),document['getElementById'](_0x11344e(0x1175))[_0x11344e(0x1086)](_0x11344e(0x325),_0xcdc8e3),document['getElementById']('export-single-chat-btn')[_0x11344e(0x1086)]('click',_0x28601a),document[_0x11344e(0x53a)](_0x11344e(0xcdb))['addEventListener'](_0x11344e(0xb2b),()=>{const _0x4eb1c3=_0x11344e;document[_0x4eb1c3(0x53a)](_0x4eb1c3(0xbdb))[_0x4eb1c3(0xb2b)]();}),document['getElementById'](_0x11344e(0xbdb))[_0x11344e(0x1086)](_0x11344e(0x325),_0x17b31b=>{const _0x10c14b=_0x11344e,_0x3f8640=_0x17b31b[_0x10c14b(0x9c2)][_0x10c14b(0x1413)][0x0];_0x3f8640&&_0x440ab7(_0x3f8640),_0x17b31b[_0x10c14b(0x9c2)]['value']=null;}),document[_0x11344e(0x53a)](_0x11344e(0xdf2))['addEventListener']('click',()=>_0x5d8c1d()),document[_0x11344e(0x53a)](_0x11344e(0x136a))['addEventListener'](_0x11344e(0xb2b),()=>openDiaryEditor()),document[_0x11344e(0x53a)](_0x11344e(0x12b8))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x241cd3),document[_0x11344e(0x53a)](_0x11344e(0x874))[_0x11344e(0x1086)]('click',_0x41d557),document[_0x11344e(0x53a)](_0x11344e(0x824))['addEventListener'](_0x11344e(0xb2b),_0x48beca),document[_0x11344e(0x53a)]('regenerate-char-qq-btn')[_0x11344e(0x1086)]('click',async()=>{const _0x23d4d6=_0x11344e;_0x184397(_0x23d4d6(0x1239),_0x23d4d6(0x849));try{await Promise[_0x23d4d6(0x63d)]([_0x41c422(),_0x255a32()]),console[_0x23d4d6(0x1081)]('CPhone\x20QQ模拟记录生成\x20和\x20主聊天推进\x20已同时完成。');}catch(_0x30dcc2){console[_0x23d4d6(0x617)](_0x23d4d6(0xac8),_0x30dcc2),await _0x184397(_0x23d4d6(0xeac),'在执行组合操作时遇到错误:\x20'+_0x30dcc2['message']);}}),document[_0x11344e(0x53a)](_0x11344e(0xcbc))[_0x11344e(0x1086)]('click',_0x4ed230=>{const _0x1cabe3=_0x11344e,_0x174ed8=_0x4ed230['target'][_0x1cabe3(0x106f)](_0x1cabe3(0x1f8));if(_0x174ed8&&_0x174ed8['dataset'][_0x1cabe3(0xad7)]){const _0x128b46=parseInt(_0x174ed8[_0x1cabe3(0x999)]['conversationIndex']);!isNaN(_0x128b46)&&_0x2c6f48(_0x128b46);}}),document['getElementById'](_0x11344e(0x3cb))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x3a5f33=_0x11344e;_0x1805e5(_0x3a5f33(0x83f));});const _0x356528=document[_0x11344e(0x53a)](_0x11344e(0xfaf)),_0x2ff3ea=()=>{const _0x4301cb=_0x11344e;if(_0x2ad3f2!=='private_user')return;if(_0x356528[_0x4301cb(0xf68)]<0x1&&!_0x2b250e){const _0x17a6e3=_0x53d851[_0x4301cb(0xaa3)][_0x3f6485]?.[_0x4301cb(0xe83)][_0x4301cb(0x29d)]||0x0;_0x17a6e3>_0x299341&&_0xc2741f();}};_0x356528[_0x11344e(0x1086)]('scroll',_0x2ff3ea),document[_0x11344e(0x53a)](_0x11344e(0xd8e))['addEventListener'](_0x11344e(0xb2b),()=>{const _0x3b9bbb=_0x11344e;alert(_0x3b9bbb(0x4f5));}),document['getElementById']('regenerate-char-album-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x114317),document[_0x11344e(0x53a)](_0x11344e(0x1e1))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x20f022=>{const _0x2dbdf3=_0x11344e,_0x1c26e4=_0x20f022[_0x2dbdf3(0x9c2)][_0x2dbdf3(0x106f)](_0x2dbdf3(0xf92));if(_0x1c26e4&&_0x1c26e4[_0x2dbdf3(0x999)][_0x2dbdf3(0xa60)]){const _0x2049ba=_0x1c26e4[_0x2dbdf3(0x999)]['description'];_0x184397(_0x2dbdf3(0x120b),_0x2049ba[_0x2dbdf3(0x795)](/\n/g,_0x2dbdf3(0x596)));}}),document[_0x11344e(0x53a)](_0x11344e(0x9d5))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x54689f),document[_0x11344e(0x53a)](_0x11344e(0x313))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x531d45),document['getElementById'](_0x11344e(0xaca))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x585d9a=>{const _0x204171=_0x11344e,_0x870730=_0x585d9a[_0x204171(0x9c2)][_0x204171(0x106f)](_0x204171(0x28b));if(_0x870730&&_0x870730['dataset'][_0x204171(0xd90)]){const _0xfb7a58=_0x870730['dataset'][_0x204171(0xd90)];_0x184397('TA的想法...',_0xfb7a58[_0x204171(0x795)](/\n/g,_0x204171(0x596)));}}),window[_0x11344e(0x1223)]=_0x24c3f7,document[_0x11344e(0x53a)](_0x11344e(0x1354))[_0x11344e(0x1086)]('click',_0x30c95d),document[_0x11344e(0x53a)](_0x11344e(0x105c))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>_0x1805e5(_0x11344e(0xafe))),document[_0x11344e(0x53a)](_0x11344e(0x735))[_0x11344e(0x1086)]('click',_0x2dec4e),document[_0x11344e(0x53a)]('add-char-diary-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x166899),document[_0x11344e(0x53a)](_0x11344e(0xf9a))['addEventListener'](_0x11344e(0xb2b),()=>_0x1805e5(_0x11344e(0x1f4))),document[_0x11344e(0x53a)]('regenerate-char-amap-btn')['addEventListener']('click',_0xf2a36f),document['getElementById'](_0x11344e(0x1324))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x558d65),document[_0x11344e(0x53a)]('regenerate-char-music-btn')[_0x11344e(0x1086)]('click',_0x1833f0),document['getElementById'](_0x11344e(0x43f))[_0x11344e(0x1086)]('click',_0x4510ce),document[_0x11344e(0x53a)](_0x11344e(0xefc))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x15bb1b),document[_0x11344e(0x53a)]('regenerate-douban-btn')['addEventListener'](_0x11344e(0xb2b),_0x15bb1b),document[_0x11344e(0x53a)]('douban-detail-back-btn')[_0x11344e(0x1086)]('click',()=>_0x541a81(_0x11344e(0x807))),document[_0x11344e(0x53a)]('douban-send-comment-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x2bf047),document[_0x11344e(0x53a)](_0x11344e(0x1414))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x1c6454),document[_0x11344e(0x53a)]('cphone-wallpaper-upload-input')['addEventListener']('change',async _0x4367b3=>{const _0x53a0c1=_0x11344e,_0x2bac56=_0x4367b3['target'][_0x53a0c1(0x1413)][0x0];if(_0x2bac56){const _0x1a373c=await new Promise(_0x27c618=>{const _0x24a620=_0x53a0c1,_0x25c40a=new FileReader();_0x25c40a[_0x24a620(0x110f)]=()=>_0x27c618(_0x25c40a[_0x24a620(0xa2a)]),_0x25c40a[_0x24a620(0x13b6)](_0x2bac56);});_0x53d851[_0x53a0c1(0x906)]['cphoneWallpaper']=_0x1a373c,_0x24b0a8();}}),document[_0x11344e(0x53a)](_0x11344e(0x11e7))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x58a84a=>{const _0x3e7746=_0x11344e;if(_0x58a84a[_0x3e7746(0x9c2)][_0x3e7746(0x1276)][_0x3e7746(0x6a3)](_0x3e7746(0x2d2))){const _0x65a781=_0x58a84a['target'][_0x3e7746(0x106f)](_0x3e7746(0x10fd)),_0x536c58=_0x65a781['dataset']['iconId'];_0x536c58&&_0x1c26b1(_0x536c58,_0x3e7746(0x1180),_0x65a781);}}),document[_0x11344e(0x53a)](_0x11344e(0xdb4))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x4b81cb=_0x11344e;document[_0x4b81cb(0x53a)]('import-appearance-input')[_0x4b81cb(0xb2b)]();}),document[_0x11344e(0x53a)](_0x11344e(0x6ab))[_0x11344e(0x1086)](_0x11344e(0x325),_0x240cbf=>{const _0x1dc90c=_0x11344e,_0x29b2b9=_0x240cbf['target'][_0x1dc90c(0x1413)][0x0];_0x29b2b9&&_0x1ebad4(_0x29b2b9),_0x240cbf['target']['value']=null;}),document['addEventListener'](_0x11344e(0xcf1),()=>{const _0x333649=_0x11344e;document[_0x333649(0x405)]==='hidden'&&(localStorage['setItem']('ephoneLastActiveTimestamp',Date[_0x333649(0x9c1)]()),console['log'](_0x333649(0xa93)));}),document[_0x11344e(0x53a)](_0x11344e(0x8b2))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x116d48),document[_0x11344e(0x53a)](_0x11344e(0x72e))['addEventListener'](_0x11344e(0xb2b),()=>{const _0x51a8a9=_0x11344e;document[_0x51a8a9(0x53a)]('import-world-book-input')[_0x51a8a9(0xb2b)]();}),document[_0x11344e(0x53a)]('import-world-book-input')['addEventListener'](_0x11344e(0x325),_0x24ac48=>{const _0x265ee9=_0x11344e,_0x7bec83=_0x24ac48[_0x265ee9(0x9c2)][_0x265ee9(0x1413)][0x0];_0x7bec83&&_0x194495(_0x7bec83),_0x24ac48['target'][_0x265ee9(0x11a2)]=null;}),document[_0x11344e(0x53a)](_0x11344e(0x83a))[_0x11344e(0x1086)]('change',async _0x255e57=>{const _0x3a9da7=_0x11344e,_0xaa2094=_0x255e57[_0x3a9da7(0x9c2)][_0x3a9da7(0x1077)];_0x53d851[_0x3a9da7(0x906)][_0x3a9da7(0x128d)]=_0xaa2094,await _0xa62efb[_0x3a9da7(0x906)][_0x3a9da7(0x546)](_0x53d851[_0x3a9da7(0x906)]);const _0x126cc5=document[_0x3a9da7(0x139c)](_0x3a9da7(0x816));if(_0x126cc5)switch(_0x126cc5['id']){case'chat-interface-screen':_0x60f53f(_0x53d851[_0x3a9da7(0x13be)]);break;case _0x3a9da7(0xbca):if(document[_0x3a9da7(0x53a)](_0x3a9da7(0x116e))['classList'][_0x3a9da7(0x6a3)](_0x3a9da7(0xdf6)))_0x3679f3();if(document['getElementById']('favorites-view')[_0x3a9da7(0x1276)]['contains'](_0x3a9da7(0xdf6)))_0xf36c44();break;case'douban-screen':_0x529c6c();break;case _0x3a9da7(0x969):_0xc712f7(_0x2aa15f);break;case _0x3a9da7(0x932):const _0x24d7ce=document[_0x3a9da7(0x139c)]('.char-screen.active');if(_0x24d7ce)switch(_0x24d7ce['id']){case _0x3a9da7(0x5f5):_0x67fdf1();break;case _0x3a9da7(0x27f):_0x1f9961();break;case _0x3a9da7(0xb00):const _0x370a65=_0x53d851['chats'][_0x3f6485],_0x411670=_0x370a65[_0x3a9da7(0x241)]||[],_0x48dd28=_0x411670[_0x3a9da7(0x29d)]>0x0?_0x411670[_0x3a9da7(0x29d)]-0x1:0x0;_0x1e85da(_0x411670[_0x48dd28]);break;case'char-usage-screen':_0x184b88();break;case _0x3a9da7(0x83f):_0xa41038();break;case _0x3a9da7(0x3e7):const _0x120044=document[_0x3a9da7(0x139c)](_0x3a9da7(0x838))?.['dataset']['conversationIndex']||0x0;_0x2c6f48(parseInt(_0x120044));break;}break;}_0x184397(_0x3a9da7(0x754),_0x3a9da7(0x7d7)+(_0xaa2094?'开启':'关闭')+'。');}),document[_0x11344e(0x53a)](_0x11344e(0x5c6))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x3479dd),document[_0x11344e(0x53a)]('search-history-back-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{_0x541a81('chat-settings-screen');}),document[_0x11344e(0x53a)](_0x11344e(0x1280))['addEventListener'](_0x11344e(0xb2b),_0x1bd1f0),document[_0x11344e(0x53a)](_0x11344e(0x43b))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x94673e),document[_0x11344e(0x53a)](_0x11344e(0xc2c))[_0x11344e(0x1086)]('click',_0x6e4db6),document['getElementById'](_0x11344e(0x7bf))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x4e9556),document[_0x11344e(0x139c)](_0x11344e(0x1353))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x5288d3=>{const _0x283bc4=_0x11344e;if(_0x5288d3['target'][_0x283bc4(0x1276)][_0x283bc4(0x6a3)](_0x283bc4(0x2e3))){const _0x4bfb2=parseInt(_0x5288d3[_0x283bc4(0x9c2)]['dataset']['id']);!isNaN(_0x4bfb2)&&_0x53308b(_0x4bfb2);}}),_0x29a16a(),window[_0x11344e(0xde2)]=_0x2681f4,document[_0x11344e(0x53a)](_0x11344e(0x117b))['addEventListener']('click',async()=>{const _0x27eb3d=_0x11344e,_0x7cd197=await _0x4f6537(_0x27eb3d(0x28a),_0x27eb3d(0xf12));if(_0x7cd197&&_0x7cd197[_0x27eb3d(0x13bc)]()){const _0x6ffbd6={'id':_0x27eb3d(0xb68)+Date[_0x27eb3d(0x9c1)](),'name':_0x7cd197[_0x27eb3d(0x13bc)](),'content':[]};await _0xa62efb[_0x27eb3d(0x13b8)][_0x27eb3d(0xe13)](_0x6ffbd6),await _0x15c1cd(),_0x2dded4(_0x6ffbd6['id']);}}),document[_0x11344e(0x53a)](_0x11344e(0x12ad))['addEventListener'](_0x11344e(0xb2b),_0x49ccbc),document[_0x11344e(0x53a)](_0x11344e(0x901))['addEventListener'](_0x11344e(0xb2b),()=>{const _0x5314ad=_0x11344e,_0x597a83=document[_0x5314ad(0x53a)]('preset-entries-container');_0x597a83['querySelector']('p')&&(_0x597a83['innerHTML']='');const _0x34327b=_0x56b9f();_0x597a83[_0x5314ad(0x133d)](_0x34327b),_0x34327b[_0x5314ad(0x139c)]('.entry-content-textarea')[_0x5314ad(0x78d)]();}),document[_0x11344e(0x53a)](_0x11344e(0x606))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x5ed917=_0x11344e;if(!_0x4e6a9e)return;const _0x292a27=await _0xa62efb[_0x5ed917(0x13b8)][_0x5ed917(0x883)](_0x4e6a9e);if(!_0x292a27)return;const _0x3bad99=document['getElementById'](_0x5ed917(0xedb))[_0x5ed917(0x11a2)][_0x5ed917(0x13bc)]();if(!_0x3bad99){alert(_0x5ed917(0xda2));return;}_0x292a27[_0x5ed917(0x234)]=_0x3bad99,_0x292a27[_0x5ed917(0xbcd)]=parseInt(document[_0x5ed917(0x53a)](_0x5ed917(0x981))['value'])||null;const _0x3d5f4f=document[_0x5ed917(0x53a)]('preset-entries-container'),_0x5a3cbb=_0x3d5f4f[_0x5ed917(0xc3d)](_0x5ed917(0x124a)),_0x3ad706=[];_0x5a3cbb[_0x5ed917(0xeaf)](_0x42983d=>{const _0x4d7c04=_0x5ed917,_0xc7fac7=_0x42983d[_0x4d7c04(0x139c)](_0x4d7c04(0x5af))[_0x4d7c04(0x11a2)][_0x4d7c04(0x13bc)]();_0xc7fac7&&_0x3ad706[_0x4d7c04(0x7dd)]({'comment':_0x42983d[_0x4d7c04(0x139c)]('.entry-comment-input')['value'][_0x4d7c04(0x13bc)](),'keys':(_0x42983d[_0x4d7c04(0x139c)]('.entry-keys-input')['value'][_0x4d7c04(0x13bc)]()||'')[_0x4d7c04(0x13e8)](',')[_0x4d7c04(0xcb4)](_0x83e437=>_0x83e437[_0x4d7c04(0x13bc)]())[_0x4d7c04(0x2dd)](Boolean),'content':_0xc7fac7,'enabled':_0x42983d[_0x4d7c04(0x139c)](_0x4d7c04(0xe8a))['checked']});}),_0x292a27[_0x5ed917(0x73e)]=_0x3ad706,await _0xa62efb[_0x5ed917(0x13b8)][_0x5ed917(0x546)](_0x292a27),_0x4e6a9e=null,_0x541a81('preset-screen'),await _0x15c1cd();}),document[_0x11344e(0x53a)](_0x11344e(0x1f7))['addEventListener']('click',()=>{const _0xd9cb12=_0x11344e;document[_0xd9cb12(0x53a)](_0xd9cb12(0x825))[_0xd9cb12(0xb2b)]();}),document[_0x11344e(0x53a)]('import-preset-input')[_0x11344e(0x1086)](_0x11344e(0x325),_0x4d7278),document[_0x11344e(0x53a)](_0x11344e(0xf2d))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x3bef32),document[_0x11344e(0x53a)](_0x11344e(0x1e6))[_0x11344e(0x1086)]('click',_0x231c57),document[_0x11344e(0x53a)](_0x11344e(0xa44))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x65d38b=_0x11344e;document['getElementById'](_0x65d38b(0x8e1))[_0x65d38b(0x1276)]['remove'](_0x65d38b(0xaef));}),document[_0x11344e(0x53a)]('go-to-clear-step2-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x21d052),document[_0x11344e(0x53a)]('back-to-clear-step1-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x3aecd8),document['getElementById'](_0x11344e(0x9b4))[_0x11344e(0x1086)]('click',()=>{const _0x1b20c7=_0x11344e;document[_0x1b20c7(0x53a)](_0x1b20c7(0x8e1))[_0x1b20c7(0x1276)]['remove']('visible');}),document[_0x11344e(0x53a)](_0x11344e(0x2ff))['addEventListener'](_0x11344e(0xb2b),_0xe77114),document[_0x11344e(0x53a)]('data-clear-wizard-modal')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x5bcd26=>{const _0x59b72b=_0x11344e,_0x193078=_0x5bcd26[_0x59b72b(0x9c2)]['closest'](_0x59b72b(0x1e4));_0x193078&&(_0x5bcd26[_0x59b72b(0xecc)](),_0x193078['classList'][_0x59b72b(0x4d7)](_0x59b72b(0x1015)));}),document[_0x11344e(0x53a)](_0x11344e(0x8e1))[_0x11344e(0x1086)](_0x11344e(0x325),_0x2c522d=>{const _0x41a236=_0x11344e;if(_0x2c522d[_0x41a236(0x9c2)]['id']===_0x41a236(0x12c1)){const _0x57e5cf=_0x2c522d[_0x41a236(0x9c2)]['checked'];document[_0x41a236(0xc3d)](_0x41a236(0x10ed))['forEach'](_0x243af5=>{const _0xaa1ca8=_0x41a236;_0x243af5['classList'][_0xaa1ca8(0x4d7)](_0xaa1ca8(0x1015),_0x57e5cf);});}else{if(_0x2c522d['target']['id']===_0x41a236(0x5ea)){const _0x39a8e5=_0x2c522d[_0x41a236(0x9c2)][_0x41a236(0x1077)];document[_0x41a236(0xc3d)](_0x41a236(0x1439))[_0x41a236(0xeaf)](_0x54002c=>{const _0x63bd2d=_0x41a236;_0x54002c[_0x63bd2d(0x1276)][_0x63bd2d(0x4d7)]('selected',_0x39a8e5);});}}}),document['getElementById'](_0x11344e(0xd89))['addEventListener'](_0x11344e(0xb2b),_0x4b78ab),document[_0x11344e(0x53a)](_0x11344e(0x13b3))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x5caf6b),document[_0x11344e(0x53a)](_0x11344e(0xbf3))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x49f969),document[_0x11344e(0x53a)](_0x11344e(0xb04))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x30335a=_0x11344e;_0x4001e6(_0x30335a(0x411));}),document[_0x11344e(0x53a)](_0x11344e(0xde4))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>_0x25fd0e(null)),document['getElementById']('save-npc-btn')['addEventListener'](_0x11344e(0xb2b),_0x12aa15),document[_0x11344e(0x53a)](_0x11344e(0x9ec))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x183ef0=_0x11344e;document[_0x183ef0(0x53a)]('npc-editor-modal')['classList'][_0x183ef0(0x2d4)](_0x183ef0(0xaef));}),document['getElementById'](_0x11344e(0x10d9))['addEventListener']('change',_0xa10904=>{const _0x43eac9=_0x11344e,_0x590ece=_0xa10904[_0x43eac9(0x9c2)][_0x43eac9(0x1413)][0x0];if(_0x590ece){const _0x46e9e4=new FileReader();_0x46e9e4['onload']=_0x4a209a=>{const _0x2e8888=_0x43eac9;document[_0x2e8888(0x53a)](_0x2e8888(0xc84))[_0x2e8888(0x7ff)]=_0x4a209a[_0x2e8888(0x9c2)]['result'];},_0x46e9e4[_0x43eac9(0x13b6)](_0x590ece);}}),document[_0x11344e(0x53a)](_0x11344e(0x97b))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x5b98f4=>{const _0x2d46f9=_0x11344e;if(_0x5b98f4[_0x2d46f9(0x9c2)]['id']==='spectator-reroll-btn')_0x40e7bf();else _0x5b98f4[_0x2d46f9(0x9c2)]['id']===_0x2d46f9(0x13d9)&&_0x13426b();}),_0x3146aa(document[_0x11344e(0x53a)](_0x11344e(0x1137)),()=>{const _0x5517d8=_0x11344e;_0x2eebda[_0x5517d8(0xe7d)]>-0x1&&_0x39ba5a(_0x2eebda[_0x5517d8(0xe7d)]);}),document[_0x11344e(0x53a)](_0x11344e(0xe29))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x16bf5c),document[_0x11344e(0x53a)](_0x11344e(0xdfb))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x8927e6),document[_0x11344e(0x53a)](_0x11344e(0xc9d))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x35969f=_0x11344e;document['getElementById'](_0x35969f(0x128a))[_0x35969f(0x1276)][_0x35969f(0x2d4)]('visible');}),document[_0x11344e(0x53a)]('time-zone-search-input')[_0x11344e(0x1086)](_0x11344e(0x1174),_0x32230f=>{const _0x33c688=_0x11344e,_0x35f1d0=_0x32230f[_0x33c688(0x9c2)]['value'][_0x33c688(0x12b5)](),_0x5d5fc4=document[_0x33c688(0x53a)](_0x33c688(0x9b2));for(const _0x3416a6 of _0x5d5fc4[_0x33c688(0x473)]){const _0x2dbbb8=_0x3416a6['textContent'][_0x33c688(0x12b5)]();_0x2dbbb8[_0x33c688(0x6e9)](_0x35f1d0)?_0x3416a6['style'][_0x33c688(0x11d9)]='':_0x3416a6[_0x33c688(0x1284)][_0x33c688(0x11d9)]='none';}}),window[_0x11344e(0x9c8)]=_0xd6d5d7,document[_0x11344e(0x53a)]('werewolf-game-btn')[_0x11344e(0x1086)]('click',()=>_0xd6d5d7(_0x11344e(0x1048))),document[_0x11344e(0x53a)](_0x11344e(0xa48))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0xddaf24=_0x11344e;document[_0xddaf24(0x53a)](_0xddaf24(0x855))[_0xddaf24(0x1276)]['remove'](_0xddaf24(0xaef));}),document['getElementById'](_0x11344e(0x6e5))[_0x11344e(0x1086)]('click',_0x32dfc6),document[_0x11344e(0x53a)](_0x11344e(0x97c))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x14c389=_0x11344e;document[_0x14c389(0x53a)](_0x14c389(0xa5c))[_0x14c389(0x1276)][_0x14c389(0x2d4)](_0x14c389(0xaef)),_0x338c52();}),document['getElementById'](_0x11344e(0x9d4))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x1b6c7e=_0x11344e,_0x9900e=await _0x355fc0(_0x1b6c7e(0x11c8),'确定要退出当前这局狼人杀吗？游戏进度将不会被保存。',{'confirmButtonClass':_0x1b6c7e(0x264)});_0x9900e&&(_0x30aab7['isActive']=![],_0x541a81(_0x30aab7[_0x1b6c7e(0x1054)]?_0x1b6c7e(0x10ba):_0x1b6c7e(0x2ab)));}),document['getElementById'](_0x11344e(0x1422))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x274f8a=_0x11344e;document['getElementById'](_0x274f8a(0xba2))[_0x274f8a(0x1276)][_0x274f8a(0x2d4)](_0x274f8a(0xaef)),_0x541a81(_0x30aab7[_0x274f8a(0x1054)]?_0x274f8a(0xbca):_0x274f8a(0x2ab));}),document[_0x11344e(0x53a)](_0x11344e(0x478))['addEventListener'](_0x11344e(0xb2b),()=>{const _0x46a551=_0x11344e;document[_0x46a551(0x53a)](_0x46a551(0xa80))[_0x46a551(0x1276)][_0x46a551(0x2d4)](_0x46a551(0xaef));}),document[_0x11344e(0x53a)]('cancel-werewolf-lobby-btn')['addEventListener']('click',()=>{const _0x3ff602=_0x11344e;document[_0x3ff602(0x53a)](_0x3ff602(0x855))['classList']['remove']('visible');}),document[_0x11344e(0x53a)](_0x11344e(0x4ff))[_0x11344e(0x1086)]('click',_0x30f786),document[_0x11344e(0x53a)](_0x11344e(0x959))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x3e78ed),document['getElementById'](_0x11344e(0x1196))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x4a8c8c),document['getElementById'](_0x11344e(0x13ac))['addEventListener']('click',_0x4ca2bc),document[_0x11344e(0x53a)](_0x11344e(0xdfc))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x4d8006=_0x11344e;document[_0x4d8006(0x53a)](_0x4d8006(0x1164))[_0x4d8006(0x1276)]['remove'](_0x4d8006(0xaef));}),document[_0x11344e(0x53a)]('confirm-delete-world-books-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x57462d),document['getElementById'](_0x11344e(0x1164))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0xb07af2=>{const _0x5e8ab2=_0x11344e,_0x8f8145=_0xb07af2[_0x5e8ab2(0x9c2)]['closest']('.clear-posts-item');_0x8f8145&&_0x8f8145[_0x5e8ab2(0x1276)][_0x5e8ab2(0x4d7)]('selected');if(_0xb07af2[_0x5e8ab2(0x9c2)]['id']===_0x5e8ab2(0xc3a)){const _0x9d4e05=_0xb07af2[_0x5e8ab2(0x9c2)][_0x5e8ab2(0x1077)];document[_0x5e8ab2(0xc3d)](_0x5e8ab2(0xed7))[_0x5e8ab2(0xeaf)](_0x26fd3b=>{const _0x11dc72=_0x5e8ab2;_0x26fd3b[_0x11dc72(0x1276)][_0x11dc72(0x4d7)]('selected',_0x9d4e05);});}}),document[_0x11344e(0x53a)](_0x11344e(0x73b))['addEventListener']('input',()=>{_0x590e2b(![]);}),document[_0x11344e(0x53a)](_0x11344e(0x49b))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x596abb=>{const _0x487a2d=_0x11344e;if(_0x596abb[_0x487a2d(0x9c2)]['classList']['contains'](_0x487a2d(0x469))){const _0x5d39bb=_0x596abb[_0x487a2d(0x9c2)][_0x487a2d(0x999)][_0x487a2d(0xbcd)],_0x7bc792=_0x5d39bb!==_0x487a2d(0x63d)&&_0x5d39bb!=='uncategorized'?parseInt(_0x5d39bb):_0x5d39bb;document[_0x487a2d(0x53a)](_0x487a2d(0x73b))[_0x487a2d(0x11a2)]='',_0x4eeba4(_0x7bc792);}});const _0x2b091f=document[_0x11344e(0x53a)]('chat-messages');_0x2b091f['addEventListener'](_0x11344e(0xf28),()=>{const _0x16e8ba=_0x11344e;if(_0x2b091f[_0x16e8ba(0xf68)]<0x1&&!_0x1df085){const _0x1d37ed=_0x53d851['chats'][_0x53d851['activeChatId']]?.[_0x16e8ba(0xe83)][_0x16e8ba(0x29d)]||0x0;_0x1d37ed>_0x1122e4&&_0xe8662();}});const _0x11c007=document['getElementById']('thoughts-history-list');_0x11c007['addEventListener'](_0x11344e(0xf28),()=>{const _0x4e5eb5=_0x11344e,{scrollTop:_0x22ee0c,scrollHeight:_0x45122d,clientHeight:_0x373d4a}=_0x11c007;if(_0x45122d-_0x22ee0c<=_0x373d4a+0x32&&!_0x4e50f1){const _0x4dc643=_0x53d851[_0x4e5eb5(0xaa3)][_0x53d851[_0x4e5eb5(0x13be)]]?.[_0x4e5eb5(0xf2c)]['length']||0x0;_0x4dc643>_0x4800fb&&_0x58a02b();}});const _0x4d3484=document['querySelector'](_0x11344e(0x1187));_0x4d3484[_0x11344e(0x1086)](_0x11344e(0xf28),()=>{const _0x2e0a2d=_0x11344e,{scrollTop:_0x30c713,scrollHeight:_0x4f01da,clientHeight:_0x584f4b}=_0x4d3484;_0x4f01da-_0x30c713<=_0x584f4b+0x64&&!_0x1d4d0d&&(_0x2ec44e[_0x2e0a2d(0x29d)]>_0x379b3d&&_0x2e0a5e());}),document[_0x11344e(0x53a)](_0x11344e(0x46c))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x4a6b00);const _0x492b28=document['getElementById'](_0x11344e(0xc0c));_0x15ab6a(_0x492b28,_0x492b28),document[_0x11344e(0x53a)](_0x11344e(0xa32))[_0x11344e(0x1086)]('click',_0x23ce0e),document['getElementById']('open-reading-library-btn')[_0x11344e(0x1086)]('click',_0x3f860f),document['getElementById'](_0x11344e(0x6f0))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x2941cf),document[_0x11344e(0x53a)](_0x11344e(0x4f8))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x772f7e),document[_0x11344e(0x53a)]('book-upload-input')[_0x11344e(0x1086)]('change',_0x5f52c7),document[_0x11344e(0x53a)](_0x11344e(0x6c1))[_0x11344e(0x1086)]('click',_0xc9dcef),document['getElementById']('reading-restore-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0xb9ad05),_0x15ab6a(document['getElementById'](_0x11344e(0x1e0)),document['querySelector']('#reading-window\x20.reading-header')),document[_0x11344e(0x53a)](_0x11344e(0x13da))['addEventListener'](_0x11344e(0xb2b),_0x3f860f),document[_0x11344e(0x53a)](_0x11344e(0xef5))['addEventListener'](_0x11344e(0xb2b),()=>{const _0x559fd1=_0x11344e;document[_0x559fd1(0x53a)]('reading-library-modal')[_0x559fd1(0x1276)]['remove'](_0x559fd1(0xaef));}),document['getElementById'](_0x11344e(0x702))['addEventListener'](_0x11344e(0xb2b),_0x48fe13),document[_0x11344e(0x53a)](_0x11344e(0xf9c))['addEventListener']('click',_0x3aaf62=>{const _0x58254f=_0x11344e,_0x1e8752=_0x3aaf62['target'];if(_0x1e8752['classList'][_0x58254f(0x6a3)](_0x58254f(0x135c))){const _0x363a2a=parseInt(_0x1e8752[_0x58254f(0x999)][_0x58254f(0x6a9)]);_0x121413(_0x363a2a);}else{if(_0x1e8752[_0x58254f(0x1276)][_0x58254f(0x6a3)](_0x58254f(0xf79))){const _0xc801fa=parseInt(_0x1e8752[_0x58254f(0x999)][_0x58254f(0x6a9)]);_0x1ccd3a(_0xc801fa);}}}),document[_0x11344e(0x53a)](_0x11344e(0x684))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x357dd3),document[_0x11344e(0x53a)](_0x11344e(0x1361))[_0x11344e(0x1086)]('input',_0x4ed741=>{const _0x21f872=_0x11344e;_0x2a996e(_0x4ed741['target'][_0x21f872(0x11a2)]);});const _0xae9545=_0x1acba8(_0x14577e,0x12c);document[_0x11344e(0x53a)](_0x11344e(0x892))[_0x11344e(0x1086)](_0x11344e(0xf28),_0xae9545),document[_0x11344e(0x53a)](_0x11344e(0x515))[_0x11344e(0x1086)](_0x11344e(0x1174),_0x536141=>{const _0x506394=_0x11344e;document[_0x506394(0x53a)]('api-temperature-value')[_0x506394(0x34a)]=_0x536141[_0x506394(0x9c2)]['value'];});const _0x13fd35=document[_0x11344e(0x53a)](_0x11344e(0x411));_0x13fd35[_0x11344e(0x1086)](_0x11344e(0xf28),()=>{const {scrollTop:_0x4bc070,scrollHeight:_0x29a8ca,clientHeight:_0xc9e8e8}=_0x13fd35;_0x29a8ca-_0x4bc070<=_0xc9e8e8+0x96&&!_0x4ec6e0&&_0x5778f5();}),document[_0x11344e(0x53a)](_0x11344e(0x5e1))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x2dab9a),document[_0x11344e(0x53a)](_0x11344e(0x993))['addEventListener']('click',()=>{const _0x11d675=_0x11344e;document[_0x11d675(0x53a)](_0x11d675(0x373))['classList']['remove'](_0x11d675(0xaef)),_0x5da4a1(_0x69ac40);}),document[_0x11344e(0x53a)](_0x11344e(0xe8d))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x237ea2),document[_0x11344e(0x53a)](_0x11344e(0xdb1))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x12610f=>{const _0x364764=_0x11344e;_0x12610f[_0x364764(0x9c2)][_0x364764(0x1276)][_0x364764(0x6a3)](_0x364764(0xf79))&&_0x2e84dc(parseInt(_0x12610f[_0x364764(0x9c2)]['dataset']['id']));}),document['getElementById']('add-product-variation-btn')[_0x11344e(0x1086)]('click',()=>_0x23b682()),document['getElementById']('cancel-variation-selection-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x5df978=_0x11344e;document[_0x5df978(0x53a)](_0x5df978(0x74b))[_0x5df978(0x1276)]['remove'](_0x5df978(0xaef));}),document[_0x11344e(0x53a)](_0x11344e(0x400))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0xa61b64=_0x11344e,_0x250ae3=document['getElementById']('variation-quantity-display');let _0x205634=parseInt(_0x250ae3['textContent']);if(_0x205634>0x1)_0x250ae3[_0xa61b64(0x34a)]=_0x205634-0x1;}),document[_0x11344e(0x53a)](_0x11344e(0xda8))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x1b3415=_0x11344e,_0x5befbd=document[_0x1b3415(0x53a)](_0x1b3415(0x708));_0x5befbd[_0x1b3415(0x34a)]=parseInt(_0x5befbd[_0x1b3415(0x34a)])+0x1;}),document[_0x11344e(0x53a)](_0x11344e(0xa2f))['addEventListener'](_0x11344e(0xb2b),_0x24537f=>{const _0x39927d=_0x11344e;if(_0x24537f[_0x39927d(0x9c2)][_0x39927d(0x1276)][_0x39927d(0x6a3)](_0x39927d(0x8e8))){const _0x5b2014=_0x24537f[_0x39927d(0x9c2)][_0x39927d(0x999)][_0x39927d(0xbcd)]===_0x39927d(0x63d)?_0x39927d(0x63d):parseInt(_0x24537f[_0x39927d(0x9c2)][_0x39927d(0x999)][_0x39927d(0xbcd)]);_0x5ede0a(_0x5b2014);}}),document[_0x11344e(0x53a)](_0x11344e(0x7a6))[_0x11344e(0x1086)]('click',_0x3be2d3),document[_0x11344e(0x53a)](_0x11344e(0x458))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x306d57),document[_0x11344e(0x53a)](_0x11344e(0x43e))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x497221),document[_0x11344e(0x53a)](_0x11344e(0x12b9))['addEventListener'](_0x11344e(0xb2b),()=>{const _0xc4ff9b=_0x11344e;document[_0xc4ff9b(0x53a)](_0xc4ff9b(0xe8f))[_0xc4ff9b(0x1276)]['remove'](_0xc4ff9b(0xaef));}),document[_0x11344e(0x53a)](_0x11344e(0xe42))[_0x11344e(0x1086)](_0x11344e(0x325),_0x279a5f=>{const _0x198394=_0x11344e,_0x3bc4c3=_0x279a5f[_0x198394(0x9c2)][_0x198394(0x1077)],_0x205993=document[_0x198394(0xc3d)](_0x198394(0x4d6));_0x205993[_0x198394(0xeaf)](_0x32e701=>{const _0x3600de=_0x198394,_0x5f263e=parseInt(_0x32e701['dataset']['id']);_0x32e701[_0x3600de(0x1276)]['toggle'](_0x3600de(0x1015),_0x3bc4c3),_0x3bc4c3?_0x14d88b['add'](_0x5f263e):_0x14d88b[_0x3600de(0x121e)](_0x5f263e);}),document[_0x198394(0x53a)](_0x198394(0x64e))[_0x198394(0x34a)]='删除\x20('+_0x14d88b[_0x198394(0x38e)]+')';}),document[_0x11344e(0x53a)]('delete-selected-products-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x321fe0=_0x11344e;if(_0x14d88b[_0x321fe0(0x38e)]===0x0){alert(_0x321fe0(0xe6e));return;}const _0x29c6b5=await _0x355fc0('确认删除',_0x321fe0(0x2b0)+_0x14d88b['size']+_0x321fe0(0x13a5),{'confirmButtonClass':_0x321fe0(0x264)});_0x29c6b5&&(await _0xa62efb[_0x321fe0(0x1257)][_0x321fe0(0x12e5)]([..._0x14d88b]),document[_0x321fe0(0x53a)](_0x321fe0(0xb39))[_0x321fe0(0xb2b)](),await _0x568252(),await _0x184397('成功','选中的商品已成功删除。'));}),document[_0x11344e(0x53a)](_0x11344e(0x132a))[_0x11344e(0x1086)](_0x11344e(0x325),_0x24cd67),document[_0x11344e(0x53a)]('save-appearance-preset-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x5e2c34),document[_0x11344e(0x53a)]('delete-appearance-preset-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x58ac6d),document['getElementById']('novelai-switch')[_0x11344e(0x1086)](_0x11344e(0x325),_0x4facfa=>{const _0x44a7ac=_0x11344e,_0x26811f=document[_0x44a7ac(0x53a)]('novelai-details');_0x26811f['style']['display']=_0x4facfa[_0x44a7ac(0x9c2)][_0x44a7ac(0x1077)]?'block':_0x44a7ac(0xbf2);}),document[_0x11344e(0x53a)](_0x11344e(0x8c6))[_0x11344e(0x1086)](_0x11344e(0xb2b),function(){const _0x345c07=_0x11344e,_0x1ac1ab=document[_0x345c07(0x53a)](_0x345c07(0x84e));_0x1ac1ab[_0x345c07(0x919)]===_0x345c07(0x13ea)?(_0x1ac1ab[_0x345c07(0x919)]=_0x345c07(0x2e6),this[_0x345c07(0x34a)]='😌'):(_0x1ac1ab[_0x345c07(0x919)]=_0x345c07(0x13ea),this[_0x345c07(0x34a)]='🧐');}),document[_0x11344e(0x53a)]('novelai-settings-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x4ec6f1=_0x11344e;_0x44d347(),document['getElementById'](_0x4ec6f1(0x129e))['style'][_0x4ec6f1(0x11d9)]=_0x4ec6f1(0x2f6);}),document[_0x11344e(0x53a)](_0x11344e(0xf8d))['addEventListener'](_0x11344e(0x325),_0x5de928=>{const _0xcb7d25=_0x11344e,_0x303e48=document[_0xcb7d25(0x53a)](_0xcb7d25(0x87f));_0x5de928[_0xcb7d25(0x9c2)]['value']===_0xcb7d25(0xa86)?_0x303e48[_0xcb7d25(0x1284)]['display']=_0xcb7d25(0x1ea):_0x303e48[_0xcb7d25(0x1284)][_0xcb7d25(0x11d9)]='none';}),document[_0x11344e(0x53a)](_0x11344e(0x8ae))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x36edb1=_0x11344e;document[_0x36edb1(0x53a)](_0x36edb1(0x129e))[_0x36edb1(0x1284)][_0x36edb1(0x11d9)]=_0x36edb1(0xbf2);}),document[_0x11344e(0x53a)](_0x11344e(0x99b))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x49ed20=_0x11344e;_0x1cdc8a(),document[_0x49ed20(0x53a)]('novelai-settings-modal')['style']['display']='none',alert('NovelAI设置已保存！');}),document[_0x11344e(0x53a)]('reset-nai-settings-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x273b55=_0x11344e;confirm(_0x273b55(0x12f3))&&_0x23627e();}),document[_0x11344e(0x53a)]('novelai-test-btn')[_0x11344e(0x1086)]('click',()=>{const _0x31289e=_0x11344e,_0x2ec739=document[_0x31289e(0x53a)](_0x31289e(0x84e))[_0x31289e(0x11a2)]['trim']();if(!_0x2ec739){alert(_0x31289e(0x128c));return;}document['getElementById'](_0x31289e(0x11a9))[_0x31289e(0x1284)][_0x31289e(0x11d9)]=_0x31289e(0x2f6),document[_0x31289e(0x53a)](_0x31289e(0x6d5))[_0x31289e(0x1284)]['display']=_0x31289e(0xbf2),document[_0x31289e(0x53a)]('nai-test-error')[_0x31289e(0x1284)][_0x31289e(0x11d9)]=_0x31289e(0xbf2);}),document[_0x11344e(0x53a)](_0x11344e(0xe59))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x5bc6c9=_0x11344e;document[_0x5bc6c9(0x53a)]('novelai-test-modal')[_0x5bc6c9(0x1284)][_0x5bc6c9(0x11d9)]=_0x5bc6c9(0xbf2);}),document['getElementById'](_0x11344e(0x2df))['addEventListener'](_0x11344e(0xb2b),()=>{const _0x22da27=_0x11344e;document[_0x22da27(0x53a)](_0x22da27(0x11a9))[_0x22da27(0x1284)][_0x22da27(0x11d9)]=_0x22da27(0xbf2);}),document[_0x11344e(0x53a)](_0x11344e(0xda3))[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{await _0x5af38d();}),document[_0x11344e(0x53a)](_0x11344e(0xc1e))[_0x11344e(0x1086)]('click',()=>{const _0x2c73c3=_0x11344e,_0x735264=document[_0x2c73c3(0x53a)](_0x2c73c3(0xe5c)),_0x4856ad=document[_0x2c73c3(0xd67)]('a');_0x4856ad['href']=_0x735264['src'],_0x4856ad[_0x2c73c3(0x888)]=_0x2c73c3(0x11cd)+Date[_0x2c73c3(0x9c1)]()+_0x2c73c3(0x1335),_0x4856ad[_0x2c73c3(0xb2b)]();}),document[_0x11344e(0x53a)]('character-nai-prompts-btn')['addEventListener'](_0x11344e(0xb2b),()=>{const _0x20b818=_0x11344e;if(!_0x53d851[_0x20b818(0x13be)])return;const _0x19403c=_0x53d851[_0x20b818(0xaa3)][_0x53d851[_0x20b818(0x13be)]],_0x13b350=_0x19403c[_0x20b818(0x81e)][_0x20b818(0x612)]||{'promptSource':_0x20b818(0xab3),'characterPositivePrompt':'','characterNegativePrompt':''};document[_0x20b818(0x53a)](_0x20b818(0x5f2))[_0x20b818(0x11a2)]=_0x13b350[_0x20b818(0xe6b)]||'',document[_0x20b818(0x53a)]('character-nai-negative')['value']=_0x13b350[_0x20b818(0x9cd)]||'',document['getElementById'](_0x20b818(0x38a))[_0x20b818(0x1284)]['display']='flex';}),document[_0x11344e(0x53a)](_0x11344e(0x10e3))[_0x11344e(0x1086)](_0x11344e(0xb2b),()=>{const _0x2cb2a0=_0x11344e;document['getElementById']('character-nai-prompts-modal')[_0x2cb2a0(0x1284)][_0x2cb2a0(0x11d9)]=_0x2cb2a0(0xbf2);}),document[_0x11344e(0x53a)]('save-character-nai-prompts-btn')[_0x11344e(0x1086)](_0x11344e(0xb2b),async()=>{const _0x48b2a3=_0x11344e;if(!_0x53d851['activeChatId'])return;const _0x123ca9=_0x53d851[_0x48b2a3(0xaa3)][_0x53d851[_0x48b2a3(0x13be)]];!_0x123ca9['settings']['naiSettings']&&(_0x123ca9[_0x48b2a3(0x81e)][_0x48b2a3(0x612)]={'promptSource':_0x48b2a3(0xab3)}),_0x123ca9[_0x48b2a3(0x81e)]['naiSettings'][_0x48b2a3(0xe6b)]=document[_0x48b2a3(0x53a)](_0x48b2a3(0x5f2))[_0x48b2a3(0x11a2)]['trim'](),_0x123ca9[_0x48b2a3(0x81e)][_0x48b2a3(0x612)][_0x48b2a3(0x9cd)]=document[_0x48b2a3(0x53a)](_0x48b2a3(0x309))['value'][_0x48b2a3(0x13bc)](),console[_0x48b2a3(0x1081)]('💾\x20[专属弹窗]\x20保存角色NAI提示词'),console['log'](_0x48b2a3(0x4bb),_0x123ca9[_0x48b2a3(0x81e)]['naiSettings']['characterPositivePrompt']),console[_0x48b2a3(0x1081)](_0x48b2a3(0x6c6),_0x123ca9[_0x48b2a3(0x81e)][_0x48b2a3(0x612)][_0x48b2a3(0x9cd)]),console[_0x48b2a3(0x1081)](_0x48b2a3(0x4fc),_0x123ca9[_0x48b2a3(0x81e)][_0x48b2a3(0x612)]['promptSource']),await _0xa62efb[_0x48b2a3(0xaa3)]['put'](_0x123ca9),document['getElementById']('character-nai-prompts-modal')['style'][_0x48b2a3(0x11d9)]=_0x48b2a3(0xbf2),alert(_0x48b2a3(0xaf3));}),document[_0x11344e(0x53a)](_0x11344e(0x801))['addEventListener'](_0x11344e(0xb2b),()=>{const _0x37532b=_0x11344e;confirm(_0x37532b(0x3c2))&&(document[_0x37532b(0x53a)]('character-nai-positive')[_0x37532b(0x11a2)]='',document[_0x37532b(0x53a)](_0x37532b(0x309))[_0x37532b(0x11a2)]='');}),document[_0x11344e(0x53a)](_0x11344e(0x1243))[_0x11344e(0x1086)]('click',()=>{const _0x476b5a=_0x11344e;if(!_0x53d851['activeChatId'])return;const _0x8ed110=_0x53d851[_0x476b5a(0xaa3)][_0x53d851[_0x476b5a(0x13be)]],_0x53243a=_0x8ed110['settings']['naiSettings']||{'promptSource':'system','characterPositivePrompt':'','characterNegativePrompt':''};document[_0x476b5a(0x53a)](_0x476b5a(0x5f2))[_0x476b5a(0x11a2)]=_0x53243a['characterPositivePrompt']||'',document[_0x476b5a(0x53a)](_0x476b5a(0x309))[_0x476b5a(0x11a2)]=_0x53243a[_0x476b5a(0x9cd)]||'',document[_0x476b5a(0x53a)]('character-nai-prompts-modal')['style'][_0x476b5a(0x11d9)]=_0x476b5a(0x2f6);}),document['getElementById'](_0x11344e(0x1058))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x1bedf7),document[_0x11344e(0x53a)](_0x11344e(0x67c))[_0x11344e(0x1086)]('change',_0x4f03b1),document[_0x11344e(0x53a)](_0x11344e(0x130f))[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x3dbc54),document['getElementById'](_0x11344e(0xacf))['addEventListener'](_0x11344e(0xb2b),_0xe0e6ca),document['getElementById'](_0x11344e(0xcf2))['addEventListener'](_0x11344e(0xb2b),()=>{const _0x4741bd=_0x11344e;_0x1805e5(_0x4741bd(0x27f));}),document[_0x11344e(0x53a)]('sticker-binding-chat-list')[_0x11344e(0x1086)](_0x11344e(0xb2b),_0x1b5fc4=>{const _0x38d404=_0x11344e,_0x469c2b=_0x1b5fc4[_0x38d404(0x9c2)][_0x38d404(0x106f)](_0x38d404(0x1395));if(_0x469c2b){const _0x30c734=_0x469c2b[_0x38d404(0x139c)](_0x38d404(0xc13));_0x30c734&&_0x1b5fc4[_0x38d404(0x9c2)]!==_0x30c734&&(_0x30c734[_0x38d404(0x1077)]=!_0x30c734[_0x38d404(0x1077)]);}});const _0x5e12fa=document[_0x11344e(0x53a)](_0x11344e(0x49b));_0x3146aa(_0x5e12fa,_0x151f9d=>{const _0x12dd88=_0x11344e,_0x366e3d=_0x151f9d[_0x12dd88(0x9c2)]['closest'](_0x12dd88(0x88a));if(_0x366e3d){_0x151f9d[_0x12dd88(0x1013)]();const _0x299220=_0x366e3d[_0x12dd88(0x999)][_0x12dd88(0xbcd)];if(_0x299220===_0x12dd88(0x63d)){_0x184397('提示','“全部”分类无法被绑定。');return;}const _0x40745a=_0x299220===_0x12dd88(0x414)?_0x12dd88(0x414):parseInt(_0x299220);_0x1f60b4(_0x40745a);}}),_0x4aaa08(),_0x541a81('home-screen');}_0x59abd1();});
