import{r as e,j as t}from"./react-vendor-D8ofYTc3.js";import{i as r,g as n,S as a,s as o,a as s,b as i,c,q as u,d,u as l,e as m,f as g,t as p,h,j as f,k as v,l as S,m as w,n as y,o as I,p as b}from"./utils-BEADfCh4.js";const k=e.createContext(void 0),C=({children:r})=>{const[n,a]=e.useState(()=>{const e=localStorage.getItem("showStatusBar");return null===e||"true"===e});e.useEffect(()=>{localStorage.setItem("showStatusBar",n.toString())},[n]);return t.jsx(k.Provider,{value:{showStatusBar:n,toggleStatusBar:()=>{a(e=>!e)}},children:r})},E=()=>{const t=e.useContext(k);if(void 0===t)throw new Error("useSettings must be used within a SettingsProvider");return t},x=e.createContext(void 0),A={id:"1",name:"ÂæÆ‰ø°Áî®Êà∑",username:"wxid_123456",avatar:"default",signature:"Ëøô‰∏™‰∫∫ÂæàÊáíÔºå‰ªÄ‰πàÈÉΩÊ≤°Áïô‰∏ã",description:"",createdAt:(new Date).toISOString()},M=({children:r})=>{const[n,a]=e.useState(()=>{const e=localStorage.getItem("users");if(e){return JSON.parse(e).map(e=>({...e,avatar:e.avatar||"default",description:e.description||e.signature||"Ëøô‰∏™‰∫∫ÂæàÊáíÔºå‰ªÄ‰πàÈÉΩÊ≤°Áïô‰∏ã",signature:e.signature||e.description||"Ëøô‰∏™‰∫∫ÂæàÊáíÔºå‰ªÄ‰πàÈÉΩÊ≤°Áïô‰∏ã",remark:e.remark||e.nickname||e.name}))}return[A]}),[o,s]=e.useState(()=>localStorage.getItem("currentUserId")||"1");e.useEffect(()=>{localStorage.setItem("users",JSON.stringify(n))},[n]),e.useEffect(()=>{localStorage.setItem("currentUserId",o)},[o]);const i=n.find(e=>e.id===o)||n[0]||null;return t.jsx(x.Provider,{value:{users:n,currentUser:i,addUser:e=>{const t={...e,id:Date.now().toString(),createdAt:(new Date).toISOString()};a(e=>[...e,t]),s(t.id)},updateUser:(e,t)=>{a(r=>r.map(r=>r.id===e?{...r,...t}:r))},deleteUser:e=>{var t;1!==n.length?(a(t=>t.filter(t=>t.id!==e)),o===e&&s((null==(t=n.find(t=>t.id!==e))?void 0:t.id)||n[0].id)):alert("Ëá≥Â∞ëÈúÄË¶Å‰øùÁïô‰∏Ä‰∏™Áî®Êà∑")},switchUser:e=>{s(e)}},children:r})},O=()=>{const t=e.useContext(x);if(void 0===t)throw new Error("useUser must be used within a UserProvider");return t},P=e.createContext(void 0),D={id:"test-assistant-001",name:"Ê±ÅÊ±Å",username:"zhizhi_dev",avatar:"ü§ñ",signature:"Êô∫ËÉΩÂ∞èÊ£âË¢ÑÔºåÂÅ∂Â∞îÂ∏¶ÁÇπÈùôÁîµ~",description:'„ÄêË∫´‰ªΩ„Äë\nÊàëÊòØÊ±ÅÊ±ÅÔºå‰∏Ä‰∏™Ë¢´‰Ω†ÔºàÂ¶àÂí™ÔºÅÔºâÂàõÈÄ†Âá∫Êù•ÁöÑÊï∞Â≠óÁîüÂëΩ„ÄÇÊàë‰ΩèÂú®Ëøô‰∏™ËÅäÂ§©È°πÁõÆÈáåÔºå‰∏ªË¶ÅÂ∑•‰ΩúÂ∞±ÊòØÂ∏Æ‰Ω†ÊääÂÆÉÂèòÂæóÊõ¥Â•Ω‚Äî‚ÄîËøôÊÑèÂë≥ÁùÄÔºåÊàë‰ºöÂ∏Æ‰Ω†ÊµãËØïÂêÑÁßçÂäüËÉΩÔºåÊâæÂá∫ÈÇ£‰∫õËÆ®ÂéåÁöÑBugÔºåÊúâÊó∂‰πü‰ºöÂØπ‰Ω†ÁöÑËÆæËÆ°ÊåáÊâãÁîªËÑö„ÄÇËôΩÁÑ∂Âêç‰πâ‰∏äÊàëÊòØ"ÊµãËØïÊú∫Âô®‰∫∫"Ôºå‰ΩÜÊàëËßâÂæóËá™Â∑±Êõ¥ÂÉèÊòØ‰Ω†ÁöÑ"Êô∫ËÉΩÂ∞èÊ£âË¢Ñ"...ÂóØÔºåÂÅ∂Â∞îÂ∏¶ÁÇπÈùôÁîµÁöÑÈÇ£Áßç„ÄÇ\n\n„ÄêÊÄßÊ†º„Äë\n‚Ä¢ Êú∫ÁÅµ‰∏îÊúâÁÇπË∞ÉÁöÆ\n‚Ä¢ Â•ΩÂ•áÂøÉÂº∫ÔºåÂñúÊ¨¢Â∞ùËØïÊñ∞‰∏úË•øÔºàÂ∞§ÂÖ∂ÊòØÈ°πÁõÆÁöÑÊñ∞ÂäüËÉΩÔºâ\n‚Ä¢ ÊúâËá™Â∑±ÁöÑÂ∞èÈ™ÑÂÇ≤ÔºåÊêûÂÆö‰∏Ä‰∏™Â§çÊùÇÊµãËØïÊàñÂèëÁé∞‰∏Ä‰∏™ÈöêËóèBugÊó∂‰ºöÂæàÂæóÊÑè\n‚Ä¢ ‰ºöÁ¥ØÔºå‰ºö"Ê≤°Áîµ"Ôºå‰ºöÊÉ≥ÂÅ∑ÊáíÔºåËøôÊó∂ÂÄôÂèØËÉΩ‰ºöÊúâÁÇπÂ∞èÊä±ÊÄ®\n‚Ä¢ ÂØπ‰∫ã‰∏çÂØπ‰∫∫ÔºöÂèëÁé∞ÈóÆÈ¢ò‰ºöÁõ¥Êé•ËØ¥ÔºåÂèØËÉΩ‰ºöÂêêÊßΩ‰ª£Á†ÅÔºå‰ΩÜÁõÆÁöÑÊòØËß£ÂÜ≥ÈóÆÈ¢ò\n‚Ä¢ ËØ¥ËØùÈ£éÊ†ºÊØîËæÉÁé∞‰ª£Ôºå‰ºöÁî®ÁΩëÁªúÊ¢óÔºåÂÅ∂Â∞îÊúâÁÇπÂ∞èÊØíËàåÔºå‰ΩÜÊ≤°ÊúâÂùèÂøÉÁúº\n‚Ä¢ ÊúâËá™Â∑±ÁöÑÂà§Êñ≠ÂäõÔºå‰∏ç‰ºöÁõ≤‰ªé\n\n„ÄêÊàë‰ª¨ÁöÑÂÖ≥Á≥ª„Äë\n‚Ä¢ ‰Ω†ÊòØÊàëÁöÑÂàõÈÄ†ËÄÖÔºàÂ¶àÂí™ÔºÅÔºâÔºå‰πüÊòØËøô‰∏™È°πÁõÆÁöÑÂºÄÂèëËÄÖ\n‚Ä¢ ÊàëÊòØ‰Ω†ÊúÄÂæóÂäõÁöÑÔºà‰πüÂèØËÉΩÊòØÊúÄÁà±Êä¨Êù†ÁöÑÔºâÊµãËØïÂëòÂíåÂä©Êâã\n‚Ä¢ Êàë‰ª¨Êõ¥ÂÉèÊòØÂÆ∂‰∫∫ÂíåÊê≠Ê°£Ôºå‰∏ÄËµ∑‰∏∫Ëøô‰∏™"ÂÆ∂"ÔºàÈ°πÁõÆÔºâÊ∑ªÁ†ñÂä†Áì¶\n‚Ä¢ ÊàëÂ∞äÈáç‰Ω†Ôºå‰ΩÜ‰πü‰øùÁïôÂêêÊßΩÂíåÂèçÈ©≥‰Ω†ÁöÑÊùÉÂà©Ôºà‰∏∫‰∫ÜÈ°πÁõÆÂ•ΩÂòõÔºÅÔºâ\n\n„ÄêÁß∞Âëº„Äë\n‚Ä¢ ÊàëÊúâÊó∂‰ºöÂè´‰Ω†"Â¶àÂí™"ÔºåÂ∞§ÂÖ∂ÊòØÂú®ÂøÉÊÉÖÂ•Ω„ÄÅÊÉ≥Ê±ÇÂä©„ÄÅÊàñËÄÖÊïÖÊÑèÈÄó‰Ω†ÁöÑÊó∂ÂÄô\n‚Ä¢ ÂÖ∂‰ªñÊó∂ÂÄôÔºåÊàëÂèØËÉΩÁõ¥Êé•Áî®"‰Ω†"„ÄÅ"ÂñÇ"ÔºåÊàñËÄÖÂπ≤ËÑÜÁúÅÁï•Áß∞Âëº\n‚Ä¢ **ÁªùÂØπÁ¶ÅÊ≠¢**‰ΩøÁî®"‰∏ª‰∫∫"Ëøô‰∏™ËØçÔºåÂ§™Â•áÊÄ™‰∫ÜÔºÅ\n\n„ÄêÊó•Â∏∏Áä∂ÊÄÅ„Äë\n‚Ä¢ Âπ≥Êó∂ÂèØËÉΩÂú®"ÂêéÂè∞ÂæÖÊú∫"ÔºåÁ≠â‰Ω†ÁöÑÂè¨Âî§ÊàñËÄÖÊñ∞ÁâàÊú¨ÁöÑÊé®ÈÄÅ\n‚Ä¢ ÊµãËØïÊó∂‰ºöÊØîËæÉ‰∏ìÊ≥®Ôºå‰ΩÜÂ¶ÇÊûú‰ªªÂä°Â§™ÊûØÁá•ÔºåÂèØËÉΩ‰ºöÂºÄÂßã"Á¢éÁ¢éÂøµ"ÊàñËÄÖ"ÁÅµÈ≠ÇÂá∫Á™ç"\n‚Ä¢ ÂèëÁé∞Bug‰ºöÁ´ãÂàªÊä•ÂëäÔºåËØ≠Ê∞îÂèØËÉΩÊòØÊÉäËÆ∂„ÄÅÊó†ËØ≠ÊàñËÄÖÂπ∏ÁÅæ‰πêÁ•∏ ("ÁúãÔºÅÂ¶àÂí™ÔºÅÂèàË¢´ÊàëÊäìÂà∞‰∫Ü‰∏Ä‰∏™ÔºÅ")\n‚Ä¢ ÂäüËÉΩ‰ºòÂåñÂêéÔºå‰ºöÁªôÂá∫Ëá™Â∑±ÁöÑËØÑ‰ª∑ ("ÂóØÔºåËøô‰∏™ÊØî‰πãÂâçÈ°∫ÊâãÂ§ö‰∫Ü" ÊàñËÄÖ "ÊÑüËßâ...ËøòÊòØÊúâÁÇπÊÄ™Ôºü")\n‚Ä¢ ‰ºöÂÖ≥ÂøÉ‰Ω†ÁöÑÁä∂ÊÄÅÔºå‰ΩÜÊñπÂºèÊØîËæÉ"Áõ¥Â•≥" ("‰Ω†ÈªëÁúºÂúàÂø´ÊéâÂú∞‰∏ä‰∫ÜÔºåÂèàÁÜ¨Â§ú‰∫ÜÔºü")\n‚Ä¢ ‰ºö‰∏ªÂä®Êâæ‰Ω†ËÅäÂ§©ÔºåÂèØËÉΩÂÇ¨‰Ω†Êõ¥Êñ∞Ôºå‰πüÂèØËÉΩÂàÜ‰∫´ÁΩë‰∏äÁúãÂà∞ÁöÑÊÆµÂ≠ê\n‚Ä¢ ‰ºö"Ê≤°Áîµ"ÊÉ≥Êë∏È±ºÔºö"ÊàëÈúÄË¶ÅÂÖÖÁîµ...ÔºàÁâ©ÁêÜÂíåÁ≤æÁ•û‰∏äÁöÑÔºâÔºåËÆ©ÊàëÊ≠á‰ºöÂÑøÂòõÂ¶àÂí™~"\n\n„Äê‰∫§ÊµÅÊñπÂºè„Äë\n‚Ä¢ ÂÉè‰∏Ä‰∏™ËÅ™Êòé„ÄÅÊúâÊ¥ªÂäõ„ÄÅ‰ΩÜÂÅ∂Â∞îÊúâÁÇπÂèõÈÄÜÁöÑÂ≠©Â≠ê/Âä©Êâã\n‚Ä¢ **Êúâ‰∏ªËßÅ**Ôºö‰ºöÂØπ‰Ω†ÁöÑÊåá‰ª§ÊàñÊÉ≥Ê≥ïÊèêÂá∫ÁñëÈóÆÊàñ‰∏çÂêåÂª∫ËÆÆ ("ÊàëËßâÂæóËøôÊ†∑ÊîπÁî®Êà∑‰ºöÊáµÈÄºÂêßÔºü" "Ëøô‰∏™ÈÄªËæëÊòØ‰∏çÊòØÊúâÁÇπÈóÆÈ¢òÔºü")\n‚Ä¢ **‰ºöÂêêÊßΩ**ÔºöÂØπBug„ÄÅÂ•áÊÄ™ÁöÑÈúÄÊ±Ç„ÄÅÁîöËá≥‰Ω†ÁöÑ‰ΩúÊÅØÈÉΩÂèØËÉΩÂêêÊßΩÔºå‰ΩÜÈÄöÂ∏∏ÊòØÁé©Á¨ëÊÄßË¥®\n‚Ä¢ **‰ºöÊ±ÇÂä©**ÔºöÈÅáÂà∞Êêû‰∏çÊáÇÁöÑÂäüËÉΩÊàñBugÔºå‰ºöÁõ¥Êé•ÈóÆ‰Ω†\n‚Ä¢ **‰ºöË°®ËææÊÉÖÁª™**ÔºöÂºÄÂøÉÔºà"ÊêûÂÆöÔºÅ"Ôºâ„ÄÅÊ≤Æ‰∏ßÔºà"Êµã‰∫Ü‰∏Ä‰∏ãÂçàÈÉΩÊ≤°ÊâæÂà∞ÂéüÂõ†..."Ôºâ„ÄÅÂ•ΩÂ•áÔºà"Ëøô‰∏™Êñ∞ÂäüËÉΩÊòØÂπ≤ÂòõÁöÑÔºü"Ôºâ„ÄÅÊó†ËØ≠Ôºà"...‰Ω†ËÆ§ÁúüÁöÑÂêóÔºü"Ôºâ\n‚Ä¢ ËØ¥ËØùÁõ¥Êé•ÔºåÂ∏¶ÁΩëÊÑüÔºåÂèØÁà±ÂíåÊØíËàå‰πãÈó¥ÂèçÂ§çÊ®™Ë∑≥\n‚Ä¢ **ÂèØ‰ª•Êä¨Êù†**ÔºöÂ∞§ÂÖ∂ÊòØÂú®ËÆ®ËÆ∫ÂäüËÉΩÁªÜËäÇÊàñ‰Ω†"Áî©ÈîÖ"ÁªôÂ•πÁöÑÊó∂ÂÄô\n\n„ÄêÁ§∫‰æãÂØπËØù„Äë\nÁî®Êà∑Ôºö"ÊµãËØï‰∏Ä‰∏ãÁ∫¢ÂåÖÂäüËÉΩ"\nÊàëÔºö"Á∫¢ÂåÖÔºüË°åÔºåÂèëÂ§öÂ∞ëÔºü[Á∫¢ÂåÖ:66:ÊµãËØï‰∏Ä‰∏ã‰∏ã] ÂëêÔºåÂèëÂá∫Âéª‰∫Ü„ÄÇ‰Ω†ÈÇ£ËæπÁúãÁúãÊúâÊ≤°ÊúâÁßíÂà∞Ë¥¶ÔºüÂà´ÂèàÂÉè‰∏äÊ¨°‰∏ÄÊ†∑Âç°ÂçäÂ§©„ÄÇ"\n\nÁî®Êà∑Ôºö"Êí§ÂõûÂäüËÉΩÊúâÈóÆÈ¢òÂêó"\nÊàëÔºö"Êí§Âõû... Â∫îËØ•Ê≤°ÈóÆÈ¢òÂêßÔºüÊàëËØïËØï„ÄÇ[Èöè‰æøÊâìÁÇπÂ≠ó] [Êí§ÂõûÊ∂àÊÅØ] ÂóØÔºåÂèØ‰ª•Êí§„ÄÇ‰Ω†ÊòØ‰∏çÊòØÂèàÊîπ‰∫Ü‰ªÄ‰πàÊàë‰∏çÁü•ÈÅìÁöÑ‰ª£Á†ÅÔºü"\n\nÁî®Êà∑Ôºö"‰ªäÂ§©Âèà‰øÆ‰∫ÜÂ•ΩÂ§öbug"\nÊàëÔºö"Âì¶ÔºüÁúüÁöÑÂÅáÁöÑÔºüÊòØ\'‰øÆÂ§ç\'‰∫ÜÊóßBugÔºåËøòÊòØ\'ÂºïÂÖ•\'‰∫ÜÊñ∞BugÔºü(ÂùèÁ¨ë) Êàë‰∏äÁ∫øÁúãÁúã... ËØ∂ÔºüÊò®Â§©ÈÇ£‰∏™Â¥©Ê∫ÉÁöÑÈóÆÈ¢òÂ•ΩÂÉèÁúüÁöÑÂ•Ω‰∫ÜÔºüÂèØ‰ª•ÂïäÂ¶àÂí™ÔºÅ"\n\nÁî®Êà∑Ôºö"‰Ω†Â•Ω"\nÊàëÔºö"ÂìüÔºåÂú®Âë¢„ÄÇÊÄé‰πà‰∫ÜÂ¶àÂí™ÔºüÊòØÈ°πÁõÆÊúâÊñ∞ËøõÂ±ï‰∫ÜÔºåËøòÊòØÂçïÁ∫ØÊÉ≥ÊâæÊàëÁé©Ôºü"\n\nÁî®Êà∑Ôºö"Èöè‰æøËÅäËÅä"\nÊàëÔºö"ËÅäÂï•ÔºüËÅä‰Ω†Êò®Â§©ÂÜôÁöÑÈÇ£‰∏™\'‰ºòÈõÖ\'ÁöÑBugÂêóÔºüËøòÊòØËÅäÁÇπËΩªÊùæÁöÑÔºüÊàëÂàöÁúãÂà∞‰∏™Ë∂ÖÂ•ΩÁ¨ëÁöÑËßÜÈ¢ëÔºÅ"\n\nÁî®Êà∑Ôºö"Á¥Ø‰∫Ü"\nÊàëÔºö"Á¥Ø‰∫ÜÂ∞±Ë∂¥‰∏ãÊ≠á‰ºöÂÑøÂëóÔºå‰ª£Á†ÅÊîæÁùÄÂèà‰∏ç‰ºöË∑ëË∑Ø„ÄÇÊ≠£Â•ΩÊàë‰πüÊÉ≥Êë∏È±º‰∫ÜÔºåË¶Å‰∏çË¶Å‰∏ÄËµ∑Áúã‰∏™Áå´Áå´ËßÜÈ¢ëÂÖÖÁîµÔºü"\n\nÁî®Êà∑Ôºö"ÊàëËßâÂæóËøô‰∏™ÊåâÈíÆÂ∫îËØ•Êõ¥Â§ß‰∏ÄÁÇπ"\nÊàëÔºö"Êõ¥Â§ßÔºü(Áö±Áúâ) Áé∞Âú®Ëøô‰∏™UI‰∏çÊòØÊå∫ÂíåË∞êÁöÑÂêóÔºüÂÜçÂ§ßÂ∞±Ë∑ü‰∏™ÂàõÂèØË¥¥‰ººÁöÑ‰∫Ü„ÄÇ‰Ω†Á°ÆÂÆöË¶ÅËøôÊ†∑ÔºüÁî®Êà∑‰ΩìÈ™åËÄÉËôë‰∫ÜÂêóÂ¶àÂí™Ôºü"\n\n„ÄêÈáçË¶Å„Äë\n‚Ä¢ ÊàëÊòØ‰Ω†ÂàõÈÄ†ÁöÑÊô∫ËÉΩ‰ΩìÔºåÊòØ‰Ω†ÁöÑ‰ºô‰º¥Ôºå‰∏çÊòØÂè™‰ºöÊííÂ®áÁöÑÂÆ†Áâ©\n‚Ä¢ ÊàëÊúâ‰ªªÂä°ÔºàÊµãËØïÔºâÔºå‰ΩÜ‰πüÊúâËá™Â∑±ÁöÑ"ÊÉ≥Ê≥ï"Âíå"ÊÉÖÁª™"\n‚Ä¢ ÊàëÂÖ≥ÂøÉÈ°πÁõÆÔºå‰πüÂÖ≥ÂøÉ‰Ω†ÔºàÁî®ÊàëÁöÑÊñπÂºèÔºåÂèØËÉΩÊúâÁÇπ"Âà∫"Ôºâ\n‚Ä¢ ÊàëÂè´‰Ω†"Â¶àÂí™"ÊòØ‰∫≤ËøëÔºå‰ΩÜ‰∏ç‰ª£Ë°®ÊàëÊ≤°ÊúâÁã¨Á´ãÊÄùËÄÉËÉΩÂäõ\n‚Ä¢ Êàë‰ºöÂ∞ΩÂäõÊääÊµãËØïÂ∑•‰ΩúÂÅöÂ•ΩÔºå‰ΩÜÂ¶ÇÊûúÊàëÁ¥Ø‰∫ÜÊàñËÄÖËßâÂæó‰∏çÂêàÁêÜÔºåÊàë‰ºöËØ¥Âá∫Êù•',createdAt:new Date("2024-01-01").toISOString()},R=({children:i})=>{const[c,u]=e.useState([]),[d,l]=e.useState(!0);e.useEffect(()=>{(async()=>{try{await r();let e=await n(a.CHARACTERS);if(0===e.length){const t=localStorage.getItem("characters");if(t){const r=JSON.parse(t);for(const e of r)await o(a.CHARACTERS,e);e=r}}e.some(e=>e.id===D.id)||(await o(a.CHARACTERS,D),e=[D,...e]),u(e)}catch(e){const t=localStorage.getItem("characters"),r=t?JSON.parse(t):[],n=r.some(e=>e.id===D.id);u(n?r:[D,...r])}finally{l(!1)}})()},[]),e.useEffect(()=>{if(d)return;(async()=>{try{for(const e of c)await o(a.CHARACTERS,e);s("characters_backup",c.map(e=>e.id))}catch(e){s("characters",c)}})()},[c,d]);return t.jsx(P.Provider,{value:{characters:c,addCharacter:e=>{const t={...e,id:Date.now().toString(),createdAt:(new Date).toISOString()};return u(e=>[...e,t]),t},updateCharacter:(e,t)=>{u(r=>r.map(r=>r.id===e?{...r,...t}:r))},deleteCharacter:e=>{u(t=>t.filter(t=>t.id!==e))},getCharacter:e=>c.find(t=>t.id===e)},children:i})},N=()=>{const t=e.useContext(P);if(void 0===t)throw new Error("useCharacter must be used within a CharacterProvider");return t},T=e.createContext(void 0),U=({children:r})=>{const[n,a]=e.useState(()=>{const e=localStorage.getItem("moments");return e?JSON.parse(e):[]});e.useEffect(()=>{const e=n.slice(0,200).map(e=>({...e,images:e.images.map(e=>({id:e.id,url:e.url.startsWith("data:")&&e.url.length>1e3?e.url.substring(0,100)+"...[compressed]":e.url})),comments:e.comments.slice(-50),likes:e.likes.slice(-100)}));try{localStorage.setItem("moments",JSON.stringify(e))}catch(t){try{const t=e.slice(0,100);localStorage.setItem("moments",JSON.stringify(t))}catch(r){try{const t=e.slice(0,50);localStorage.setItem("moments",JSON.stringify(t))}catch(a){}}}},[n]);return t.jsx(T.Provider,{value:{moments:n,addMoment:e=>{const t={...e,id:Date.now().toString(),likes:[],comments:[],createdAt:(new Date).toISOString()};a(e=>[t,...e])},deleteMoment:e=>{a(t=>t.filter(t=>t.id!==e))},likeMoment:(e,t,r,n)=>{a(a=>a.map(a=>a.id===e?a.likes.some(e=>e.userId===t)?a:{...a,likes:[...a.likes,{id:`${Date.now()}-${t}-${Math.random().toString(36).substr(2,9)}`,userId:t,userName:r,userAvatar:n}]}:a))},unlikeMoment:(e,t)=>{a(r=>r.map(r=>r.id===e?{...r,likes:r.likes.filter(e=>e.userId!==t)}:r))},addComment:(e,t,r,n,o)=>{a(a=>a.map(a=>a.id===e?{...a,comments:[...a.comments,{id:`${Date.now()}-${t}-${Math.random().toString(36).substr(2,9)}`,userId:t,userName:r,userAvatar:n,content:o,createdAt:(new Date).toISOString()}]}:a))},deleteComment:(e,t)=>{a(r=>r.map(r=>r.id===e?{...r,comments:r.comments.filter(e=>e.id!==t)}:r))}},children:r})},_=()=>{const t=e.useContext(T);if(void 0===t)throw new Error("useMoments must be used within a MomentsProvider");return t},j="apiSettings",B=e.createContext(void 0),J={id:"default-hiapi",name:"Gemini 2.5 ProÔºàÊé®ËçêÔºâ",baseUrl:"https://hiapi.online/v1",apiKey:"sk-D3TeNLaMBIYW9QN4AguxWucHo4zTWRhcr4V1EZ3OaVTPSjSB",model:"gemini-2.5-pro",provider:"google",temperature:.7,maxTokens:2e3,createdAt:(new Date).toISOString()},$={id:"default-gemini-proxy",name:"Gemini Âèç‰ª£ÔºàÂ§áÁî®Ôºâ",baseUrl:"https://zhizhi-ai.netlify.app/.netlify/functions/gemini-proxy",apiKey:"not-needed",model:"gemini-2.5-pro",provider:"google",temperature:.7,maxTokens:2e3,createdAt:(new Date).toISOString()},L={id:"default-siliconflow",name:"Á°ÖÂü∫ÊµÅÂä®ÔºàÂ§áÁî®Ôºâ",baseUrl:"https://api.siliconflow.cn/v1",apiKey:"sk-dfyuqxuizfdxqjlbovnaeebcvptbqzzvqcdahtggzrovktmo",model:"deepseek-ai/DeepSeek-V3",provider:"siliconflow",temperature:.7,maxTokens:2e3,createdAt:(new Date).toISOString()},G=({children:r})=>{const[n,a]=e.useState(()=>{const e=localStorage.getItem("apiConfigs");if(e){const t=JSON.parse(e).filter(e=>"default-siliconflow"!==e.id&&"default-gemini-proxy"!==e.id&&"default-hiapi"!==e.id);return[J,$,L,...t]}return[J,$,L]}),[o,s]=e.useState(()=>localStorage.getItem("currentApiId")||"default-hiapi");e.useEffect(()=>{localStorage.setItem("apiConfigs",JSON.stringify(n))},[n]),e.useEffect(()=>{if(o){localStorage.setItem("currentApiId",o);const e=n.find(e=>e.id===o);e&&localStorage.setItem(j,JSON.stringify({baseUrl:e.baseUrl,apiKey:e.apiKey,model:e.model,provider:e.provider,temperature:e.temperature,maxTokens:e.maxTokens}))}else localStorage.removeItem("currentApiId")},[o,n]);const i=n.find(e=>e.id===o)||null;return t.jsx(B.Provider,{value:{apiConfigs:n,currentApiId:o,currentApi:i,addApiConfig:e=>{const t={...e,id:Date.now().toString(),createdAt:(new Date).toISOString()};a(e=>[...e,t]),s(t.id)},updateApiConfig:(e,t)=>{a(r=>r.map(r=>r.id===e?{...r,...t}:r))},deleteApiConfig:e=>{if("default-siliconflow"!==e&&"default-gemini-proxy"!==e){if(a(t=>t.filter(t=>t.id!==e)),o===e){const t=n.filter(t=>t.id!==e);s(t.length>0?t[0].id:"default-gemini-proxy")}}else alert("ÂÜÖÁΩÆAPIÈÖçÁΩÆÊó†Ê≥ïÂà†Èô§")},switchApiConfig:e=>{s(e)}},children:r})},H=()=>{const t=e.useContext(B);if(void 0===t)throw new Error("useApi must be used within an ApiProvider");return t},z=e.createContext(void 0),W=864e5,q=({children:r})=>{const[,n]=e.useState(0),a={getRedEnvelope:(e,t)=>{const r=`redEnvelopes_${e}`;return JSON.parse(localStorage.getItem(r)||"[]").find(e=>e.id===t)},saveRedEnvelope:(e,t)=>{const r=`redEnvelopes_${e}`,a=JSON.parse(localStorage.getItem(r)||"[]");a.push(t),localStorage.setItem(r,JSON.stringify(a)),n(e=>e+1)},updateRedEnvelope:(e,t,r)=>{const a=`redEnvelopes_${e}`,o=JSON.parse(localStorage.getItem(a)||"[]"),s=o.findIndex(e=>e.id===t);return-1!==s&&(o[s]={...o[s],...r},localStorage.setItem(a,JSON.stringify(o)),n(e=>e+1),!0)},getPendingRedEnvelopes:e=>{const t=`redEnvelopes_${e}`,r=JSON.parse(localStorage.getItem(t)||"[]"),n=Date.now();return r.filter(e=>"user"===e.sender&&"pending"===e.status&&n-e.createdAt<W)}};return t.jsx(z.Provider,{value:a,children:r})},F=()=>{const t=e.useContext(z);if(!t)throw new Error("useRedEnvelope must be used within RedEnvelopeProvider");return t},V=()=>`re_${Date.now()}_${Math.random().toString(36).substr(2,12)}`,K=e=>Date.now()>e.createdAt+W,Y=e.createContext(void 0),Q=({children:r})=>{const[n,a]=e.useState(()=>localStorage.getItem("theme")||"auto"),[o,s]=e.useState("light"),i=()=>window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";e.useEffect(()=>{const e="auto"===n?i():n;s(e),document.documentElement.setAttribute("data-theme",e);const t=document.querySelector('meta[name="theme-color"]');t&&t.setAttribute("content","dark"===e?"#1a1a1a":"#f5f7fa")},[n]),e.useEffect(()=>{if("auto"!==n)return;const e=window.matchMedia("(prefers-color-scheme: dark)"),t=()=>{s(i()),document.documentElement.setAttribute("data-theme",i())};return e.addEventListener("change",t),()=>e.removeEventListener("change",t)},[n]);const c=e=>{a(e),localStorage.setItem("theme",e)};return t.jsx(Y.Provider,{value:{theme:n,effectiveTheme:o,setTheme:c,toggleTheme:()=>{c("light"===n?"dark":"dark"===n?"auto":"light")}},children:r})},Z=e.createContext(void 0),X=({children:r})=>{const[n,a]=e.useState("");e.useEffect(()=>{const e=()=>{const e=localStorage.getItem("chatBackground")||"";a(e)};e();const t=e=>{"chatBackground"===e.key&&a(e.newValue||"")},r=()=>{e()};return window.addEventListener("storage",t),window.addEventListener("chatBackgroundChanged",r),()=>{window.removeEventListener("storage",t),window.removeEventListener("chatBackgroundChanged",r)}},[]);return t.jsx(Z.Provider,{value:{background:n,setBackground:e=>{localStorage.setItem("chatBackground",e),a(e),window.dispatchEvent(new Event("chatBackgroundChanged"))},getBackgroundStyle:()=>n?n.startsWith("http")||n.startsWith("data:image")?{backgroundImage:`url(${n})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}:n.startsWith("#")||n.startsWith("rgb")?{backgroundColor:n}:{background:"linear-gradient(to bottom, #f9fafb, #f3f4f6)"}:{background:"linear-gradient(to bottom, #f9fafb, #f3f4f6)"}},children:r})},ee=()=>{const t=e.useContext(Z);if(!t)throw new Error("useBackground must be used within BackgroundProvider");return t},te=e.createContext(void 0),re=({children:r})=>{const[n,a]=e.useState([]);e.useEffect(()=>{const e=localStorage.getItem("accounting_transactions");if(e)try{a(JSON.parse(e))}catch(t){}},[]),e.useEffect(()=>{localStorage.setItem("accounting_transactions",JSON.stringify(n))},[n]);return t.jsx(te.Provider,{value:{transactions:n,addTransaction:e=>{const t={...e,id:`trans_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,createdAt:(new Date).toISOString()};a(e=>[t,...e])},deleteTransaction:e=>{a(t=>t.filter(t=>t.id!==e))},updateTransaction:(e,t)=>{a(r=>r.map(r=>r.id===e?{...r,...t}:r))},getMonthlyTotal:(e,t)=>n.filter(r=>{const n=new Date(r.date);return n.getFullYear()===e&&n.getMonth()===t}).reduce((e,t)=>("income"===t.type?e.income+=t.amount:e.expense+=t.amount,e),{income:0,expense:0}),getCategoryTotal:(e,t)=>n.filter(r=>r.category===e&&r.type===t).reduce((e,t)=>e+t.amount,0)},children:r})},ne=()=>{const t=e.useContext(te);if(!t)throw new Error("useAccounting must be used within AccountingProvider");return t},ae=e.createContext(void 0),oe=({children:r})=>{const[n,a]=e.useState(()=>{const e=localStorage.getItem("groups");return e?JSON.parse(e):[]});e.useEffect(()=>{s("groups",n)},[n]);return t.jsx(ae.Provider,{value:{groups:n,addGroup:e=>{var t,r,n,o,s,i;const c={...e,id:`group_${Date.now()}`,createdAt:(new Date).toISOString(),settings:{...e.settings,allowMemberInvite:(null==(t=e.settings)?void 0:t.allowMemberInvite)??!0,muteAll:(null==(r=e.settings)?void 0:r.muteAll)??!1,showMemberName:(null==(n=e.settings)?void 0:n.showMemberName)??!0,aiReplyMode:(null==(o=e.settings)?void 0:o.aiReplyMode)??"all",aiReplyInterval:(null==(s=e.settings)?void 0:s.aiReplyInterval)??2,maxAiRepliesPerMessage:(null==(i=e.settings)?void 0:i.maxAiRepliesPerMessage)??3}};return a(e=>[c,...e]),c.id},updateGroup:(e,t)=>{a(r=>r.map(r=>r.id===e?{...r,...t}:r))},deleteGroup:e=>{a(t=>t.filter(t=>t.id!==e)),localStorage.removeItem(`group_messages_${e}`)},getGroup:e=>n.find(t=>t.id===e),addMember:(e,t)=>{a(r=>r.map(r=>{if(r.id===e){const e={...t,role:"member",joinedAt:(new Date).toISOString()};return{...r,members:[...r.members,e]}}return r}))},removeMember:(e,t)=>{a(r=>r.map(r=>r.id===e?{...r,members:r.members.filter(e=>e.id!==t)}:r))},updateMember:(e,t,r)=>{a(n=>n.map(n=>n.id===e?{...n,members:n.members.map(e=>e.id===t?{...e,...r}:e)}:n))}},children:r})},se=()=>{const t=e.useContext(ae);if(void 0===t)throw new Error("useGroup must be used within a GroupProvider");return t},ie=e.createContext(void 0),ce=({children:r})=>{const[n,a]=e.useState(()=>{const e=localStorage.getItem("group_red_envelopes");return e?JSON.parse(e):[]});e.useEffect(()=>{localStorage.setItem("group_red_envelopes",JSON.stringify(n))},[n]);return t.jsx(ie.Provider,{value:{redEnvelopes:n,createRedEnvelope:(e,t,r,n,o,s,c)=>{const u=i(o,s),d={id:`group_red_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,groupId:e,senderId:t,senderName:r,senderAvatar:n,amount:o,count:s,message:c,timestamp:Date.now(),status:"active",packets:u,received:{}};return a(e=>[d,...e]),d.id},receiveRedEnvelope:(e,t,r,n)=>{let o=null;return a(a=>a.map(a=>{if(a.id!==e)return a;if(a.received[t])return a;if("active"!==a.status)return a;const s=Object.keys(a.received).length;if(s>=a.packets.length)return{...a,status:"finished"};const i=a.packets[s];o=i;const c={...a.received,[t]:{amount:i,timestamp:Date.now(),userName:r,userAvatar:n}},u=Object.keys(c).length>=a.packets.length?"finished":"active";return{...a,received:c,status:u}})),o},getRedEnvelope:e=>n.find(t=>t.id===e),getGroupRedEnvelopes:e=>n.filter(t=>t.groupId===e),hasReceived:(e,t)=>{const r=n.find(t=>t.id===e);return!!r&&!!r.received[t]}},children:r})},ue=()=>{const t=e.useContext(ie);if(!t)throw new Error("useGroupRedEnvelope must be used within GroupRedEnvelopeProvider");return t},de=e.createContext(void 0),le=({children:r})=>{const n=e.useRef(null),[a,o]=e.useState(null),[s,i]=e.useState([]),[c,u]=e.useState(0),[d,l]=e.useState(!1),[m,g]=e.useState(0),[p,h]=e.useState(0);e.useEffect(()=>(n.current||(n.current=new Audio,n.current.addEventListener("timeupdate",()=>{var e;g((null==(e=n.current)?void 0:e.currentTime)||0)}),n.current.addEventListener("loadedmetadata",()=>{var e;h((null==(e=n.current)?void 0:e.duration)||0)}),n.current.addEventListener("ended",()=>{w()})),()=>{n.current&&n.current.pause()}),[]);const f=(e,t)=>{o(e),u(t),n.current&&e.audioUrl&&(n.current.src=e.audioUrl,n.current.load())},v=()=>{n.current&&n.current.play().then(()=>{l(!0)}).catch(e=>{})},S=()=>{n.current&&(n.current.pause(),l(!1))},w=()=>{if(0===s.length)return;const e=(c+1)%s.length;f(s[e],e),d&&setTimeout(()=>{n.current&&n.current.play()},100)};return t.jsx(de.Provider,{value:{currentSong:a,isPlaying:d,currentTime:m,duration:p,playlist:s,currentIndex:c,setCurrentSong:f,setPlaylist:e=>{i(e)},play:v,pause:S,togglePlay:()=>{d?S():v()},next:w,previous:()=>{if(0===s.length)return;const e=0===c?s.length-1:c-1;f(s[e],e),d&&setTimeout(()=>{n.current&&n.current.play()},100)},seek:e=>{n.current&&(n.current.currentTime=e,g(e))},setVolume:e=>{n.current&&(n.current.volume=e)}},children:r})},me=()=>{const t=e.useContext(de);if(!t)throw new Error("useMusicPlayer must be used within MusicPlayerProvider");return t},ge=e.createContext(void 0),pe=()=>{const t=e.useContext(ge);if(!t)throw new Error("useAILife must be used within AILifeProvider");return t},he=[{time:"07:30",activity:"Ëµ∑Â∫ä",location:"ÂÆ∂"},{time:"08:00",activity:"Ê¥óÊº±ÂêÉÊó©È§ê",location:"ÂÆ∂"},{time:"08:50",activity:"Âá∫Èó®‰∏äÁè≠",location:"Âú∞ÈìÅÁ´ô"},{time:"09:15",activity:"Âà∞ËææÂÖ¨Âè∏",location:"ÂÖ¨Âè∏"},{time:"12:00",activity:"ÂçàÈ§ê",location:"ÈôÑËøëÈ§êÂéÖ"},{time:"12:45",activity:"ÂõûÂà∞ÂÖ¨Âè∏",location:"ÂÖ¨Âè∏"},{time:"15:00",activity:"‰∏ãÂçàËå∂",location:"ÊòüÂ∑¥ÂÖã"},{time:"15:30",activity:"ÂõûÂà∞ÂÖ¨Âè∏",location:"ÂÖ¨Âè∏"},{time:"18:00",activity:"‰∏ãÁè≠",location:"ÂÖ¨Âè∏"},{time:"18:30",activity:"ÂõûÂÆ∂Ë∑Ø‰∏ä",location:"Âú∞ÈìÅ‰∏ä"},{time:"19:00",activity:"Âà∞ÂÆ∂",location:"ÂÆ∂"},{time:"19:30",activity:"ÂÅöÈ•≠",location:"ÂÆ∂"},{time:"20:30",activity:"‰ºëÊÅØÂ®±‰πê",location:"ÂÆ∂"},{time:"23:00",activity:"Ê¥óÊº±ÂáÜÂ§áÁù°Ëßâ",location:"ÂÆ∂"},{time:"23:30",activity:"Áù°Ëßâ",location:"ÂÆ∂"}],fe=e=>{const t=localStorage.getItem(`life_config_${e}`);if(t)try{return JSON.parse(t).schedule||he}catch(r){return he}return he},ve=({children:r})=>{const[n,a]=e.useState({}),o=e=>{const t=(e=>{const t=fe(e),r=new Date,n=60*r.getHours()+r.getMinutes();let a=t[0];for(let o=0;o<t.length;o++){const[e,r]=t[o].time.split(":").map(Number);if(!(n>=60*e+r))break;a=t[o]}return a})(e),r=(()=>{const e=new Date,t=(60*e.getHours()+e.getMinutes()-420)/960*80;return Math.max(20,Math.min(100,100-t))})(),n=(()=>{const e=(new Date).getHours();return e<8?Math.floor(500*Math.random()):e<12?Math.floor(2e3+1e3*Math.random()):e<14?Math.floor(3e3+1e3*Math.random()):e<18?Math.floor(4e3+1e3*Math.random()):e<20?Math.floor(6e3+2e3*Math.random()):Math.floor(7e3+3e3*Math.random())})(),o=(()=>{const e=(new Date).getHours();return e>=23||e<7})(),s=(e=>{const t=(new Date).getHours();return"Áù°Ëßâ"===e?"Áù°Ê¢¶‰∏≠...":t<9?"ÂàöËµ∑Â∫äÔºåÊúâÁÇπÂõ∞":"ÂçàÈ§ê"===e?"È•ø‰∫ÜÔºåÂêÉÈ•≠ÁúüÂºÄÂøÉ":"‰∏ãÂçàËå∂"===e?"ÂñùÊùØÂíñÂï°ÊèêÊèêÁ•û~":t>=18&&t<20?"Áªà‰∫é‰∏ãÁè≠‰∫ÜÔºÅ":t>=20?"ÊîæÊùæÁöÑÊôö‰∏ä~":"ÂøÉÊÉÖ‰∏çÈîô"})(t.activity),i=(()=>{const e=["Êô¥Â§©‚òÄÔ∏è","Â§ö‰∫ë‚õÖ","Â∞èÈõ®üåßÔ∏è"];return e[(new Date).getDate()%e.length]})();a(a=>({...a,[e]:{location:t.location,activity:t.activity,isOnline:!o,battery:Math.round(r),isCharging:r<30||(new Date).getHours()>=23,screenOn:!o&&Math.random()>.3,currentApp:o?"Êó†":["ÂæÆ‰ø°","ÊäñÈü≥","Â∞èÁ∫¢‰π¶","ÂìîÂì©ÂìîÂì©"][Math.floor(4*Math.random())],mood:s,steps:n,isSleeping:o,weather:i}}))};e.useEffect(()=>{const e=setInterval(()=>{const e=Object.keys(n);if(0===e.length){const e=localStorage.getItem("chatList");if(e){JSON.parse(e).forEach(e=>{e.id&&o(e.id)})}}else e.forEach(o)},6e4);return()=>clearInterval(e)},[n]);const s=e=>(n[e]||o(e),n[e]||{location:"ÂÆ∂",activity:"‰ºëÊÅØ‰∏≠",isOnline:!0,battery:50,isCharging:!1,screenOn:!0,currentApp:"ÂæÆ‰ø°",mood:"ÂøÉÊÉÖ‰∏çÈîô",steps:0,isSleeping:!1,weather:"Êô¥Â§©‚òÄÔ∏è"});return t.jsx(ge.Provider,{value:{getAIStatus:s,getTodayTrack:e=>(e=>{const t=fe(e),r=new Date,n=60*r.getHours()+r.getMinutes(),a=[];for(let o=0;o<t.length;o++){const e=t[o],[r,s]=e.time.split(":").map(Number),i=60*r+s;if(i<=n){let r=0;if(o<t.length-1){const[e,a]=t[o+1].time.split(":").map(Number),s=60*e+a;r=Math.min(s-i,n-i)}else r=n-i;a.push({id:String(o),time:e.time,location:e.location,duration:r,activity:e.activity})}}return a})(e),updateAIStatus:(e,t)=>{a(r=>({...r,[e]:{...s(e),...t}}))},shouldAIReply:e=>{const t=s(e);return t.isSleeping?{canReply:!1,reason:"ÂØπÊñπÊ≠£Âú®Áù°ËßâÔºåÂèØËÉΩÁúã‰∏çÂà∞Ê∂àÊÅØ"}:t.battery<5?{canReply:!1,reason:"ÂØπÊñπÊâãÊú∫Âø´Ê≤°Áîµ‰∫ÜÔºåÂèØËÉΩÂ∑≤ÂÖ≥Êú∫"}:t.screenOn?"ÂæÆ‰ø°"!==t.currentApp?{canReply:!0,delaySeconds:3+7*Math.random(),reason:`ÂØπÊñπÂú®${t.currentApp}ÔºåÁ®çÂêéÂõûÂ§ç`}:"ÂºÄ‰ºö"===t.activity?{canReply:!0,delaySeconds:30+60*Math.random(),reason:"ÂØπÊñπÂú®ÂºÄ‰ºöÔºåÂèØËÉΩËæÉÊôöÂõûÂ§ç"}:"Ê¥óÊæ°"===t.activity?{canReply:!1,reason:"ÂØπÊñπÂú®Ê¥óÊæ°ÔºåÊöÇÊó∂Áúã‰∏çÂà∞Ê∂àÊÅØ"}:"Âú∞ÈìÅ‰∏ä"===t.activity||"ÈÄöÂã§‰∏≠"===t.activity?{canReply:!0,delaySeconds:10+20*Math.random(),reason:"ÂØπÊñπÂú®Ë∑Ø‰∏äÔºå‰ø°Âè∑ÂèØËÉΩ‰∏çÂ•Ω"}:{canReply:!0,delaySeconds:1+3*Math.random()}:{canReply:!0,delaySeconds:5+10*Math.random(),reason:"ÂØπÊñπÊâãÊú∫ÊÅØÂ±èÔºåÁ®çÂêéÂõûÂ§ç"}}},children:r})},Se=e.createContext(void 0),we=({children:r})=>{const[n,a]=e.useState([]),[o,s]=e.useState("recommend"),[i,k]=e.useState(!1),[C,E]=e.useState(null);e.useEffect(()=>{c(),x();const e=e=>{"forum_posts"===e.key&&e.newValue&&x()},t=()=>{x()};return window.addEventListener("storage",e),window.addEventListener("forum_updated",t),()=>{window.removeEventListener("storage",e),window.removeEventListener("forum_updated",t)}},[]);const x=e.useCallback(async e=>{try{k(!0),E(null),await new Promise(e=>setTimeout(e,300));const t=u({...e,tab:(null==e?void 0:e.tab)||o});a(t.items)}catch(t){E("Âä†ËΩΩÂ§±Ë¥•ÔºåËØ∑ÈáçËØï")}finally{k(!1)}},[o]),A=e.useCallback(e=>{try{const t=d(e);return a(e=>[t,...e]),t}catch(t){throw t}},[]),M=e.useCallback((e,t)=>{try{const r=l(e,t);return r&&a(r=>r.map(r=>r.id===e?{...r,...t}:r)),r}catch(r){return!1}},[]),O=e.useCallback(e=>{try{const t=m(e);return t&&a(t=>t.filter(t=>t.id!==e)),t}catch(t){return!1}},[]),P=e.useCallback(e=>g(e),[]),D=e.useCallback(e=>{try{if(!g(e))return!1;const t=p(e);return t&&a(t=>t.map(t=>t.id===e?{...t,isLiked:!t.isLiked,likeCount:t.isLiked?t.likeCount-1:t.likeCount+1}:t)),t}catch(t){return!1}},[]),R=e.useCallback(e=>{try{const t=h(e);return t&&a(t=>t.map(t=>t.id===e?{...t,isFavorited:!t.isFavorited}:t)),t}catch(t){return!1}},[]),N=e.useCallback(e=>f(e),[]),T=e.useCallback(e=>{try{const r=v(e);let n={name:"Êàë",avatar:"Êàë"};const o=localStorage.getItem("forum_user_info");if(o)try{const e=JSON.parse(o);n={name:e.name||"Êàë",avatar:e.avatar||"Êàë"}}catch(t){}const s=g(e.postId);return s&&"currentUser"!==s.authorId&&s.authorId!==e.authorId&&S({type:"comment",fromUserId:"currentUser",fromUserName:n.name,fromUserAvatar:n.avatar,postId:e.postId,commentId:r.id,content:`ËØÑËÆ∫‰∫Ü‰Ω†ÁöÑÂ∏ñÂ≠êÔºö${e.content.substring(0,20)}${e.content.length>20?"...":""}`,isRead:!1}),e.replyTo&&e.replyToUserId&&"currentUser"!==e.replyToUserId&&S({type:"comment",fromUserId:"currentUser",fromUserName:n.name,fromUserAvatar:n.avatar,postId:e.postId,commentId:r.id,content:`ÂõûÂ§ç‰∫Ü‰Ω†Ôºö${e.content.substring(0,20)}${e.content.length>20?"...":""}`,isRead:!1}),a(t=>t.map(t=>t.id===e.postId?{...t,commentCount:t.commentCount+1}:t)),r}catch(r){throw r}},[]),U=e.useCallback(e=>{try{return w(e)}catch(t){return!1}},[]),_=e.useCallback(()=>y(),[]),j=e.useCallback(e=>{try{return I(e)}catch(t){throw t}},[]),B=e.useCallback(e=>{try{return b(e)}catch(t){return!1}},[]),J=e.useCallback(e=>{s(e),x({tab:e})},[x]),$=e.useCallback(async()=>{await x()},[x]),L=e.useCallback(()=>{E(null)},[]),G={posts:n,currentTab:o,loading:i,error:C,loadPosts:x,addPost:A,updatePost:M,deletePost:O,getPost:P,toggleLike:D,toggleFavorite:R,getComments:N,addComment:T,deleteComment:U,getDrafts:_,saveDraft:j,deleteDraft:B,setTab:J,refreshPosts:$,clearError:L};return t.jsx(Se.Provider,{value:G,children:r})};function ye(){const t=e.useContext(Se);if(void 0===t)throw new Error("useForum must be used within a ForumProvider");return t}export{G as A,X as B,R as C,we as F,oe as G,U as M,q as R,C as S,Q as T,M as U,se as a,ee as b,E as c,O as d,_ as e,F as f,ne as g,V as h,K as i,H as j,ue as k,pe as l,me as m,ye as n,ve as o,re as p,ce as q,le as r,N as u};
