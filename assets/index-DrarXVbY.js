const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pages-CWX6yoiT.js","assets/react-vendor-D8ofYTc3.js","assets/vendor-BOALdufa.js","assets/context-C_hada-q.js","assets/utils-BkWlPcuZ.js","assets/pages-B0g7P9tg.css"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);import{r as s,j as a,u as n,a as r,O as l,c as i,d as o,e as c,R as h}from"./react-vendor-D8ofYTc3.js";import{C as d,a as m,D as x,P as j,S as p,M as u,_,b as g,c as f,d as y,e as v}from"./pages-CWX6yoiT.js";import{bF as w,bG as b,bH as E,bI as I,T as N}from"./utils-BkWlPcuZ.js";import{b as z,f as L,u as P,d as T,j as A,A as R,e as D}from"./context-C_hada-q.js";import"./vendor-BOALdufa.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const V=({show:e,title:t,subtitle:n,message:r,icon:l,onClose:i,onClick:o,duration:c=5e3})=>{const[h,d]=s.useState(!1),[m,x]=s.useState(0),[j,p]=s.useState(0),[u,_]=s.useState(!1);s.useEffect(()=>{if(e){d(!0);const e=setTimeout(()=>{g()},c);return()=>clearTimeout(e)}},[e,c]);const g=()=>{d(!1),setTimeout(()=>{i()},300)};return e||h?a.jsx("div",{className:"fixed inset-0 z-[9999] pointer-events-none",children:a.jsx("div",{className:"absolute top-0 left-0 right-0 flex justify-center px-2 pt-2 transition-all duration-300 pointer-events-auto "+(h?"translate-y-0 opacity-100":"-translate-y-full opacity-0"),style:{transform:`translateY(${h?j:-100}px)`},children:a.jsxs("div",{className:"w-full max-w-[393px] bg-white/95 backdrop-blur-2xl rounded-[20px] shadow-2xl overflow-hidden cursor-pointer",onClick:()=>{o&&o(),g()},onTouchStart:e=>{x(e.touches[0].clientY),_(!0)},onTouchMove:e=>{if(!u)return;const t=e.touches[0].clientY-m;t<0&&p(t)},onTouchEnd:()=>{j<-50&&g(),p(0),_(!1)},style:{boxShadow:"0 10px 40px rgba(0, 0, 0, 0.15), 0 2px 8px rgba(0, 0, 0, 0.08)"},children:[a.jsx("div",{className:"w-full h-1 flex justify-center pt-1",children:a.jsx("div",{className:"w-9 h-1 bg-gray-300/60 rounded-full"})}),a.jsx("div",{className:"px-3 pt-2 pb-3",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0 mt-0.5",children:l?l.startsWith("http")||l.startsWith("data:")||l.startsWith("/")?a.jsx("img",{src:l,alt:t,className:"w-10 h-10 rounded-full object-cover shadow-md"}):a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-green-400 to-green-500 flex items-center justify-center shadow-md text-lg",children:l}):a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-green-400 to-green-500 flex items-center justify-center shadow-md",children:a.jsx("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"white",children:a.jsx("path",{d:"M8.5 3C4.91 3 2 5.686 2 9c0 1.846.906 3.471 2.333 4.667L3.5 16.5l3.167-1.5C7.553 15.326 8.48 15.5 9.5 15.5c.166 0 .33-.007.493-.02C9.373 14.457 9 13.264 9 12c0-3.314 2.686-6 6-6 .35 0 .693.03 1.027.088C15.41 4.19 12.286 3 8.5 3zm7.5 6c-2.761 0-5 2.015-5 4.5s2.239 4.5 5 4.5c.827 0 1.607-.15 2.316-.418L21.5 19l-1.167-2.333C21.591 15.471 22 14.028 22 12.5c0-2.485-2.239-4.5-5-4.5z"})})})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-baseline justify-between gap-2 mb-0.5",children:[a.jsx("span",{className:"text-[13px] font-semibold text-gray-900 truncate",children:t}),a.jsx("span",{className:"text-[11px] text-gray-500 flex-shrink-0",children:"çŽ°åœ¨"})]}),n&&a.jsx("div",{className:"text-[13px] text-gray-600 mb-1 truncate",children:n}),a.jsx("div",{className:"text-[13px] text-gray-900 leading-[18px] line-clamp-3",children:r})]})]})})]})})}):null},O=()=>{const[e,t]=s.useState(null);s.useEffect(()=>{const e=w.subscribe(e=>{t(e)});return()=>{e()}},[]);return a.jsx(V,{show:!!e,title:(null==e?void 0:e.title)||"",subtitle:null==e?void 0:e.subtitle,message:(null==e?void 0:e.message)||"",icon:null==e?void 0:e.icon,onClose:()=>{w.close()},onClick:null==e?void 0:e.onClick,duration:null==e?void 0:e.duration})},k=()=>{const e=n(),[t,r]=s.useState(null),[l,i]=s.useState(!1);s.useEffect(()=>{b(e=>{r(e),i(!0)})},[]);return t?a.jsx(V,{show:l,title:t.title,subtitle:t.subtitle,message:t.message,icon:"ðŸ’¬",onClose:()=>{i(!1),setTimeout(()=>{r(null)},300)},onClick:()=>{if(t)switch(t.type){case"comment":case"like":t.targetId&&e(`/forum/post/${t.targetId}`);break;case"dm":e("/forum/notifications?tab=messages");break;case"follow":e("/forum/notifications?tab=follows");break;case"init":case"system":e("/forum")}},duration:5e3}):null},C=()=>{const e=n(),[t,r]=s.useState(null),[l,i]=s.useState(!1);s.useEffect(()=>{const e=e=>{const{title:t,message:s,chatId:a,characterId:n,type:l="single",avatar:o}=e.detail;r({title:t,message:s,chatId:a||n,type:l||"single",avatar:o}),i(!0)};return window.addEventListener("background-chat-message",e),()=>{window.removeEventListener("background-chat-message",e)}},[]);if(!t)return null;const o=t.title;return a.jsx(V,{show:l,title:"å¾®ä¿¡",subtitle:o,message:t.message,icon:t.avatar||"ðŸ’¬",onClose:()=>{i(!1),setTimeout(()=>{r(null)},300)},onClick:()=>{t&&("group"===t.type?(e(`/group/${t.chatId}`),setTimeout(()=>{window.dispatchEvent(new Event("reload-group-messages"))},100)):(e(`/chat/${t.chatId}`),setTimeout(()=>{window.dispatchEvent(new Event("reload-chat-messages"))},100)))},duration:6e3})},S=({isPlaying:e,currentSong:t,onPlayPause:r,onNext:l,onPrevious:i,currentTime:o,duration:c})=>{const h=n(),[d,m]=s.useState(!1),[x,j]=s.useState(0),p=(u=null==t?void 0:t.lyrics)?u.split("\n").map(e=>{const t=e.match(/\[(\d+):(\d+)\.(\d+)\](.*)/);return t?{time:60*parseInt(t[1])+parseInt(t[2])+parseInt(t[3])/1e3,text:t[4].trim()}:null}).filter(e=>{if(!e||!e.text)return!1;const t=e.text;return!(t.includes("ä½œè¯")||t.includes("ä½œæ›²")||t.includes("ç¼–æ›²")||t.includes("åˆ¶ä½œ")||t.includes("æ··éŸ³")||t.includes("å½•éŸ³")||t.includes("æ¯å¸¦")||t.includes("ç›‘åˆ¶")||t.includes("å‘è¡Œ")||t.includes("ä¼åˆ’")||t.includes("å°é¢")||t.includes("é’¢ç´")||t.includes("å‰ä»–")||t.includes("è´æ–¯")||t.includes("é¼“")||t.includes("å¼¦ä¹")||t.includes("No Label Crew")||t.includes("æœ¬æ­Œæ›²æ¥è‡ª")||t.includes("è¥é”€æŽ¨å¹¿")||t.includes("é’äº‘")||t.includes("LAB"))}).sort((e,t)=>e.time-t.time):[];var u;const _=p.map(e=>e.text);s.useEffect(()=>{if(p.length>0){let e=0;for(let t=0;t<p.length&&o>=p[t].time;t++)e=t;j(e)}},[o,p]);const g=()=>{d?h("/music-player"):m(!0)},f=e=>`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`;return t?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed top-2 left-1/2 -translate-x-1/2 z-[9999] transition-all duration-500 "+(d?"opacity-0 pointer-events-none":"opacity-100"),onClick:g,children:a.jsxs("div",{className:"bg-black rounded-full px-2.5 py-1.5 flex items-center gap-1.5 shadow-lg cursor-pointer hover:scale-105 transition-transform w-[150px]",children:[a.jsx("div",{className:"w-5 h-5 rounded-full overflow-hidden flex-shrink-0",children:a.jsx("img",{src:t.cover,alt:t.title,className:"w-full h-full object-cover "+(e?"animate-spin-slow":"")})}),a.jsx("div",{className:"overflow-hidden flex-1",children:a.jsx("div",{className:"text-white text-xs whitespace-nowrap",children:_[x]||t.title})}),a.jsx("div",{className:"flex items-center gap-0.5",children:e?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-0.5 h-2 bg-white rounded animate-pulse"}),a.jsx("div",{className:"w-0.5 h-3 bg-white rounded animate-pulse",style:{animationDelay:"0.1s"}}),a.jsx("div",{className:"w-0.5 h-1.5 bg-white rounded animate-pulse",style:{animationDelay:"0.2s"}})]}):a.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M8 5v14l11-7z"})})})]})}),d&&a.jsx("div",{className:"fixed inset-0 bg-black/20 z-[9998]",onClick:()=>m(!1)}),a.jsx("div",{className:"fixed top-2 left-1/2 -translate-x-1/2 z-[9999] transition-all duration-500 "+(d?"opacity-100":"opacity-0 pointer-events-none"),children:a.jsxs("div",{className:"bg-black rounded-3xl p-4 w-[320px] shadow-2xl",onClick:e=>e.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-11 h-11 rounded-xl overflow-hidden flex-shrink-0",children:a.jsx("img",{src:t.cover,alt:t.title,className:"w-full h-full object-cover "+(e?"animate-spin-slow":"")})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-white font-medium truncate",children:t.title}),a.jsx("div",{className:"text-gray-400 text-sm truncate",children:t.artist})]}),a.jsx("button",{onClick:e=>{e.stopPropagation(),m(!1)},className:"text-gray-400 hover:text-white transition-colors",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),_.length>0&&a.jsx("div",{className:"mb-3 h-16 overflow-hidden flex items-center justify-center",children:a.jsx("div",{className:"text-center space-y-1",children:_.slice(Math.max(0,x-1),x+2).map((e,t)=>a.jsx("p",{className:"text-sm transition-all duration-300 "+(1===t?"text-white font-medium text-base":"text-gray-500 text-xs"),children:e},t))})}),a.jsxs("div",{className:"mb-3",children:[a.jsx("div",{className:"h-1 bg-gray-700 rounded-full overflow-hidden",children:a.jsx("div",{className:"h-full bg-white rounded-full transition-all",style:{width:o/c*100+"%"}})}),a.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[a.jsx("span",{children:f(o)}),a.jsx("span",{children:f(c)})]})]}),a.jsxs("div",{className:"flex items-center justify-center gap-6",children:[a.jsx("button",{onClick:e=>{e.stopPropagation(),i()},className:"text-white hover:scale-110 transition-transform",children:a.jsx("svg",{className:"w-7 h-7",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M6 6h2v12H6zm3.5 6l8.5 6V6z"})})}),a.jsx("button",{onClick:e=>{e.stopPropagation(),r()},className:"w-12 h-12 bg-white rounded-full flex items-center justify-center hover:scale-110 transition-transform",children:e?a.jsx("svg",{className:"w-6 h-6 text-black",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"})}):a.jsx("svg",{className:"w-6 h-6 text-black ml-0.5",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M8 5v14l11-7z"})})}),a.jsx("button",{onClick:e=>{e.stopPropagation(),l()},className:"text-white hover:scale-110 transition-transform",children:a.jsx("svg",{className:"w-7 h-7",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"})})})]}),a.jsx("div",{className:"text-center mt-3",children:a.jsx("button",{onClick:g,className:"text-gray-400 text-xs hover:text-white transition-colors",children:"ç‚¹å‡»è¿”å›žæ’­æ”¾å™¨"})})]})}),a.jsx("style",{children:"\n        @keyframes marquee {\n          0% { transform: translateX(0); }\n          100% { transform: translateX(-50%); }\n        }\n\n        .animate-marquee {\n          animation: marquee 10s linear infinite;\n        }\n\n        @keyframes spin-slow {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n\n        .animate-spin-slow {\n          animation: spin-slow 10s linear infinite;\n        }\n      "})]}):null},$=()=>{const e=r(),t=n(),[i,o]=s.useState(0),{background:c}=z(),h=[{name:"å¾®ä¿¡",path:"/wechat",Icon:d},{name:"é€šè®¯å½•",path:"/wechat/contacts",Icon:m},{name:"å‘çŽ°",path:"/wechat/discover",Icon:x},{name:"æˆ‘",path:"/wechat/me",Icon:j}];s.useEffect(()=>{const t=h.findIndex(t=>t.path===e.pathname);-1!==t&&o(t)},[e.pathname]);const p=c?{backgroundImage:`url(${c})`,backgroundSize:"cover",backgroundPosition:"center"}:{};return a.jsxs("div",{className:"h-screen flex flex-col "+(c?"":"gradient-bg"),style:p,children:[a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx(l,{})}),a.jsxs("nav",{className:"border-t border-gray-200/50 "+(c?"glass-dark":"glass-effect"),role:"navigation","aria-label":"ä¸»å¯¼èˆª",children:[a.jsx("div",{className:"h-16 flex items-center justify-around px-2",children:h.map((e,s)=>{const n=e.Icon,r=i===s;return a.jsxs("button",{onClick:()=>((e,s)=>{o(e),t(s)})(s,e.path),className:"flex flex-col items-center justify-center flex-1 py-2 ios-button","aria-label":`${e.name}${r?"ï¼Œå½“å‰é¡µé¢":""}`,"aria-current":r?"page":void 0,tabIndex:0,children:[a.jsx(n,{size:26,className:"mb-1 smooth-transition "+(r?"text-wechat-primary scale-110":"text-gray-600"),"aria-hidden":"true"}),a.jsx("span",{className:"text-xs smooth-transition "+(r?"text-wechat-primary font-medium":"text-gray-600"),children:e.name})]},s)})}),a.jsx("div",{className:"flex justify-center pb-2","aria-hidden":"true",children:a.jsx("div",{className:"w-32 h-1 bg-gray-900 rounded-full opacity-40"})})]})]})},M=({children:e})=>((()=>{const e=L(),{moments:t,likeMoment:a,addComment:n}=e,r=P(),{characters:l,getCharacter:i}=r,{currentUser:o}=T(),c=s.useRef(t),h=s.useRef(new Set);if("true"===localStorage.getItem("emergency_stop_ai_moments"))return;const d=s.useCallback((e,t)=>{const s=localStorage.getItem(`chat_messages_${e}`);if(!s)return`ä¸Ž ${t} ä¹‹é—´æ²¡æœ‰èŠå¤©è®°å½•ã€‚`;try{const a=JSON.parse(s),n=i(e);if(!n)return"æœªçŸ¥è§’è‰²ã€‚";const r=a.filter(e=>"system"!==e.type&&"system"!==e.messageType).slice(-30);if(0===r.length)return`ä¸Ž ${t} ä¹‹é—´è¿˜æ²¡æœ‰å®žé™…å¯¹è¯ï¼Œåªæœ‰ç³»ç»Ÿæ¶ˆæ¯ã€‚`;const l=r.map(e=>`${"sent"===e.type?t:n.name}: ${e.content}`).join("\n");return`æœ€è¿‘çš„èŠå¤©è®°å½•ï¼ˆå…±${r.length}æ¡ï¼‰ï¼š\n${l}`}catch(a){return"èŠå¤©è®°å½•è§£æžå¤±è´¥ã€‚"}},[i]);s.useEffect(()=>{const s=c.current;t.forEach(t=>{const a=s.find(e=>e.id===t.id),n=!a,c=a&&t.comments.length>a.comments.length;if(n&&!h.current.has(t.id)){h.current.add(t.id);const s=l.some(e=>e.id===t.userId)?i(t.userId):o?{id:o.id,name:o.name}:null;if(!s)return;setTimeout(async()=>{const a=await E(t,l,s,e=>d(e,s.name));a&&I(a,t,e,r)},2e3+3e3*Math.random())}if(c){const a=s.find(e=>e.id===t.id);if(a&&t.comments.slice(a.comments.length).some(e=>!l.some(t=>t.id===e.userId))){const s=l.some(e=>e.id===t.userId)?i(t.userId):o?{id:o.id,name:o.name}:null;if(!s)return;setTimeout(async()=>{const a=await E(t,l,s,e=>d(e,s.name));a&&I(a,t,e,r)},1500+2e3*Math.random())}}}),c.current=t},[t,l,o,a,n,i,e,r,d])})(),a.jsx(a.Fragment,{children:e}));class B extends s.Component{constructor(e){super(e),t(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})}),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:a.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[a.jsx("div",{className:"flex items-center justify-center w-16 h-16 mx-auto bg-red-100 rounded-full mb-4",children:a.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),a.jsx("h2",{className:"text-xl font-bold text-gray-800 text-center mb-2",children:"å‡ºé”™äº†"}),a.jsx("p",{className:"text-gray-600 text-center mb-4",children:"åº”ç”¨é‡åˆ°äº†ä¸€ä¸ªé”™è¯¯ï¼Œè¯·å°è¯•åˆ·æ–°é¡µé¢"}),!1,a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:this.handleReset,className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors",children:"é‡è¯•"}),a.jsx("button",{onClick:()=>window.location.href="/",className:"flex-1 bg-gray-200 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors",children:"è¿”å›žé¦–é¡µ"})]})]})}):this.props.children}}const F=()=>{const[e,t]=s.useState(navigator.onLine),[n,r]=s.useState(!1);return s.useEffect(()=>{const e=()=>{t(!0),r(!0),setTimeout(()=>r(!1),3e3)},s=()=>{t(!1),r(!0)};return window.addEventListener("online",e),window.addEventListener("offline",s),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}},[]),n?a.jsx("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 animate-slide-down",children:a.jsx("div",{className:"px-6 py-3 rounded-lg shadow-lg flex items-center gap-3 "+(e?"bg-green-500 text-white":"bg-red-500 text-white"),children:e?a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),a.jsx("span",{className:"font-medium",children:"ç½‘ç»œå·²æ¢å¤"})]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),a.jsx("span",{className:"font-medium",children:"ç½‘ç»œå·²æ–­å¼€"})]})})}):null},W=({show:e,character:t,isVideoCall:n,onEnd:r,onSendMessage:l,onRequestAIReply:i,messages:o,isAITyping:c})=>{const[h,d]=s.useState(0),[m,x]=s.useState(!1),[j,_]=s.useState(!1),[g,f]=s.useState(!1),[y,v]=s.useState(""),w=s.useRef(null),b=o||[];s.useEffect(()=>{if(!e)return d(0),void f(!1);const t=setInterval(()=>{d(e=>e+1)},1e3);return()=>clearInterval(t)},[e]),s.useEffect(()=>{var e;null==(e=w.current)||e.scrollIntoView({behavior:"smooth"})},[b]);const E=e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},I=()=>{y.trim()?(l&&l(y),v("")):i&&i()};return e?a.jsxs(a.Fragment,{children:[!g&&a.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col "+(n?"bg-black":"bg-white"),children:[n&&a.jsxs("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center",children:[a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:t.avatar?t.avatar.startsWith("data:image")||t.avatar.startsWith("http")?a.jsx("img",{src:t.avatar,alt:t.name,className:"w-48 h-48 rounded-full object-cover"}):a.jsx("span",{className:"text-9xl",children:t.avatar}):a.jsx("div",{className:"w-48 h-48 rounded-full bg-gray-700 flex items-center justify-center",children:a.jsx("span",{className:"text-white text-6xl",children:t.name.charAt(0)})})}),a.jsx("div",{className:"absolute top-4 right-4 w-24 h-32 bg-gray-900 rounded-lg overflow-hidden border-2 border-white/30 shadow-2xl",children:a.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-700 to-gray-800 flex items-center justify-center",children:a.jsx("span",{className:"text-white text-2xl",children:"æˆ‘"})})})]}),a.jsxs("div",{className:"absolute top-0 left-0 right-0 flex items-center justify-between px-4 py-4 z-10 "+(n?"bg-gradient-to-b from-black/60 to-transparent":"bg-gray-50 border-b border-gray-200"),children:[a.jsx("button",{onClick:()=>f(!0),className:"w-10 h-10 rounded-full flex items-center justify-center ios-button "+(n?"bg-white/20 backdrop-blur-sm hover:bg-white/30":"bg-gray-200 hover:bg-gray-300"),children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:a.jsx("path",{d:"M19 13H5v-2h14v2z",fill:n?"white":"#374151"})})}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden flex items-center justify-center "+(n?"bg-white/20 backdrop-blur-sm":"bg-gray-200"),children:t.avatar?t.avatar.startsWith("data:image")||t.avatar.startsWith("http")?a.jsx("img",{src:t.avatar,alt:t.name,className:"w-full h-full object-cover"}):a.jsx("span",{className:"text-lg",children:t.avatar}):a.jsx("span",{className:"text-sm "+(n?"text-white":"text-gray-700"),children:t.name.charAt(0)})}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-medium "+(n?"text-white drop-shadow-lg":"text-gray-900"),children:t.name}),a.jsx("span",{className:"text-sm "+(n?"text-white/80 drop-shadow":"text-gray-500"),children:E(h)})]})]}),a.jsxs("div",{className:"w-10 h-10 flex items-center justify-center",children:[n&&a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"white",children:[a.jsx("rect",{x:"2",y:"5",width:"16",height:"14",rx:"2",stroke:"white",strokeWidth:"2",fill:"none"}),a.jsx("path",{d:"M18 10l4-2v8l-4-2",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})]}),!n&&a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"#10b981",children:a.jsx("path",{d:"M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"})})]})]}),a.jsx("div",{className:"absolute left-0 right-0 overflow-y-auto px-4 py-4 hide-scrollbar z-10 "+(n?"bottom-48 max-h-[40%] bg-gradient-to-t from-black/60 to-transparent":"bottom-44 top-20 bg-white"),children:0===b.length?a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx("p",{className:"text-sm "+(n?"text-white/60":"text-gray-400"),children:"å¼€å§‹å¯¹è¯..."})}):a.jsxs("div",{className:"space-y-3",children:[b.map(e=>"narrator"===e.type?a.jsx("div",{className:"flex justify-center",children:a.jsx("p",{className:"text-xs italic px-4 py-1 text-center max-w-[80%] "+(n?"text-white/70 drop-shadow":"text-gray-500"),children:e.content})},e.id):a.jsx("div",{className:"flex "+("user"===e.type?"justify-end":"justify-start"),children:a.jsx("div",{className:"max-w-[70%] px-4 py-2 rounded-2xl shadow-lg "+("user"===e.type?"bg-green-500 text-white":n?"bg-white/90 backdrop-blur-sm text-gray-900":"bg-gray-100 text-gray-900"),children:a.jsx("p",{className:"text-sm break-words",children:e.content})})},e.id)),c&&a.jsx("div",{className:"flex justify-start",children:a.jsx("div",{className:"px-4 py-3 rounded-2xl shadow-lg "+(n?"bg-white/90 backdrop-blur-sm":"bg-gray-100"),children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms",animationDuration:"1s"}}),a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms",animationDuration:"1s"}}),a.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms",animationDuration:"1s"}})]})})}),a.jsx("div",{ref:w})]})}),a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 px-4 pb-6 z-20 "+(n?"bg-gradient-to-t from-black/90 via-black/80 to-transparent pt-8":"bg-white pt-4"),children:[a.jsxs("div",{className:"rounded-full px-4 py-2 flex items-center gap-2 mb-4 "+(n?"bg-white/20 backdrop-blur-md border border-white/30":"bg-gray-100 border border-gray-200"),children:[a.jsx("input",{type:"text",value:y,onChange:e=>v(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),I())},placeholder:"è¯´ç‚¹ä»€ä¹ˆ...",className:"flex-1 bg-transparent outline-none text-sm "+(n?"text-white placeholder-white/60":"text-gray-900 placeholder-gray-400")}),a.jsx("button",{onClick:I,className:"w-8 h-8 rounded-full flex items-center justify-center ios-button transition-all "+(y.trim()?"bg-green-500":"bg-blue-500"),title:y.trim()?"å‘é€æ¶ˆæ¯":"AIå›žå¤",children:a.jsx(p,{size:16,className:"text-white"})})]}),a.jsxs("div",{className:"flex justify-center items-center gap-8",children:[a.jsx("button",{onClick:()=>x(!m),className:"w-16 h-16 rounded-full flex items-center justify-center ios-button transition-all "+(m?"bg-red-500 shadow-2xl":n?"bg-white/20 backdrop-blur-md":"bg-gray-200"),children:a.jsx(u,{size:28,className:m||n?"text-white":"text-gray-700"})}),a.jsx("button",{onClick:r,className:"w-20 h-20 rounded-full bg-red-500 flex items-center justify-center ios-button shadow-2xl hover:bg-red-600",children:a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"white",children:a.jsx("path",{d:"M12,9C10.4,9,8.85,9.25,7.4,9.72v2.09C7.4,12.46,6.86,13,6.21,13H3.78c-0.65,0-1.18-0.54-1.18-1.18v-1.09 C2.6,5.88,6.88,1.6,11.73,1.6h0.55c4.85,0,9.13,4.28,9.13,9.13v1.09c0,0.65-0.54,1.18-1.18,1.18h-2.43 c-0.65,0-1.18-0.54-1.18-1.18V9.72C15.15,9.25,13.6,9,12,9z"})})}),a.jsx("button",{onClick:()=>_(!j),className:"w-16 h-16 rounded-full flex items-center justify-center ios-button transition-all "+(j?"bg-green-500 shadow-2xl":n?"bg-white/20 backdrop-blur-md":"bg-gray-200"),children:a.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:j||n?"white":"#374151",children:a.jsx("path",{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"})})})]})]})]}),g&&a.jsxs("div",{onClick:()=>f(!1),className:"fixed top-20 right-4 z-50 bg-white rounded-2xl shadow-2xl p-3 flex items-center gap-3 cursor-pointer ios-button border border-gray-200",children:[a.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-gray-200 flex items-center justify-center",children:t.avatar?t.avatar.startsWith("data:image")||t.avatar.startsWith("http")?a.jsx("img",{src:t.avatar,alt:t.name,className:"w-full h-full object-cover"}):a.jsx("span",{className:"text-lg",children:t.avatar}):a.jsx("span",{className:"text-gray-700 text-sm",children:t.name.charAt(0)})}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-gray-900 text-sm font-medium",children:t.name}),a.jsx("span",{className:"text-gray-500 text-xs",children:E(h)})]}),a.jsx("button",{onClick:e=>{e.stopPropagation(),r()},className:"w-8 h-8 rounded-full bg-red-500 flex items-center justify-center ml-2",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"white",children:a.jsx("path",{d:"M12,9C10.4,9,8.85,9.25,7.4,9.72v2.09C7.4,12.46,6.86,13,6.21,13H3.78c-0.65,0-1.18-0.54-1.18-1.18v-1.09 C2.6,5.88,6.88,1.6,11.73,1.6h0.55c4.85,0,9.13,4.28,9.13,9.13v1.09c0,0.65-0.54,1.18-1.18,1.18h-2.43 c-0.65,0-1.18-0.54-1.18-1.18V9.72C15.15,9.25,13.6,9,12,9z"})})})]})]}):null},H=()=>{const{callState:e,endCall:t,sendMessage:n,addAIMessage:r,addNarratorMessage:l,setAITyping:i}=A(),{currentUser:o}=T(),c=s.useRef(!1),h=(e,t,s,a)=>{const n={id:Date.now(),type:"system",content:`${s?"è§†é¢‘":"è¯­éŸ³"}é€šè¯ ${Math.floor(t/60)}åˆ†${t%60}ç§’`,time:(new Date).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),timestamp:Date.now(),isCallRecord:!0,callDuration:t,callMessages:e,messageType:"system"},r=localStorage.getItem(`chat_messages_${a}`),l=[...r?JSON.parse(r):[],n];localStorage.setItem(`chat_messages_${a}`,JSON.stringify(l));const i=new CustomEvent("callRecordSaved",{detail:{characterId:a,messageCount:l.length}});window.dispatchEvent(i)},d=async()=>{i(!0);try{const t=(new Date).toLocaleString("zh-CN",{month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1}),s=e.character;if(!s)return;const a=s.relationship||"æœ‹å‹",n=s.favorability||50,i=e.isVideoCall?"è§†é¢‘é€šè¯":"è¯­éŸ³é€šè¯",c=e.messages.slice(-5).map(e=>"user"===e.type?`${(null==o?void 0:o.name)||"ç”¨æˆ·"}: ${e.content}`:"ai"===e.type?`${s.name}: ${e.content}`:"narrator"===e.type?`[${e.content}]`:"").join("\n"),h=e.isAIInitiated&&0===e.messages.length,d=`ä½ æ˜¯ ${s.name}ã€‚\n${s.profile||""}\n\nçŽ°åœ¨æ˜¯${t}ï¼Œä½ æ­£åœ¨å’Œ${(null==o?void 0:o.name)||"ç”¨æˆ·"}${i}ã€‚\n\nä½ ä»¬çš„å…³ç³»ï¼š${a}\nå½“å‰å¥½æ„Ÿåº¦ï¼š${n}/100\n\n${h?"**æƒ…å†µè¯´æ˜Ž**ï¼šæ˜¯ä½ ä¸»åŠ¨æ‰“ç”µè¯ç»™å¯¹æ–¹çš„ï¼Œå¯¹æ–¹åˆšæŽ¥é€šç”µè¯ã€‚è¯·è¯´å¼€åœºç™½ï¼Œå‘Šè¯‰TAä½ ä¸ºä»€ä¹ˆæ‰“ç”µè¯æ¥ã€‚":`æœ€è¿‘çš„é€šè¯å†…å®¹ï¼š\n${c||"ï¼ˆåˆšå¼€å§‹é€šè¯ï¼‰"}`}\n\nè¯·è‡ªç„¶åœ°ç»§ç»­å¯¹è¯ã€‚æ³¨æ„ï¼š\n1. è¿™æ˜¯å®žæ—¶${i}ï¼Œè¦åƒçœŸäººä¸€æ ·è‡ªç„¶äº¤æµï¼Œ**åˆ†æ®µå›žå¤**è®©å¯¹è¯æ›´çœŸå®ž\n2. å°†ä½ çš„å›žå¤åˆ†æˆå¤šä¸ªç‰‡æ®µï¼Œæ¯ä¸ªç‰‡æ®µç”¨ ||| åˆ†éš”\n3. æ¯ä¸ªç‰‡æ®µå¯ä»¥æ˜¯ï¼š\n   - ç®€çŸ­çš„è¯è¯­ï¼ˆå¦‚ï¼š"å—¯..."ã€"å°±æ˜¯..."ã€"æˆ‘è§‰å¾—..."ï¼‰\n   - æ—ç™½æè¿°ï¼ˆåªåœ¨å¿…è¦æ—¶ç”¨æ‹¬å·ï¼Œå¦‚ï¼š(æ²‰é»˜äº†å‡ ç§’)ã€(å¹äº†å£æ°”)ï¼‰\n   - å®Œæ•´çš„å¥å­\n4. **é‡è¦**ï¼šä¸è¦æ¯å¥è¯éƒ½åŠ æ—ç™½ï¼Œåªåœ¨å…³é”®æ—¶åˆ»åŠ æ—ç™½ï¼ˆåœé¡¿ã€æƒ…ç»ªå˜åŒ–ç­‰ï¼‰\n5. å¦‚æžœæ˜¯è§†é¢‘é€šè¯ï¼Œå¯ä»¥æè¿°è¡¨æƒ…ã€åŠ¨ä½œ\n6. ä¿æŒè§’è‰²æ€§æ ¼ä¸€è‡´\n\n**ç¤ºä¾‹æ ¼å¼ï¼š**\nå—¯...|||å°±æ˜¯...|||ï¼ˆåœé¡¿äº†ä¸€ä¸‹ï¼‰|||æˆ‘æƒ³è¯´çš„æ˜¯...|||å…¶å®žæŒºæƒ³ä½ çš„\n\nåªè¿”å›žåˆ†æ®µå†…å®¹ï¼Œç”¨|||åˆ†éš”æ¯ä¸€æ®µï¼Œä¸è¦åŠ ä»»ä½•å…¶ä»–å‰ç¼€æˆ–è¯´æ˜Žã€‚`,m=(await N([{role:"user",content:d}])).split("|||").map(e=>e.trim()).filter(e=>e.length>0);for(let e=0;e<m.length;e++){const t=m[e];e>0&&await new Promise(e=>setTimeout(e,800+800*Math.random()));const s=t.match(/^[\(ï¼ˆ](.+?)[\)ï¼‰]$/);s?l(s[1]):r(t)}}catch(t){r("æŠ±æ­‰ï¼Œåˆšæ‰æ²¡å¬æ¸…...")}finally{i(!1)}};return s.useEffect(()=>{e.isActive&&e.isAIInitiated&&!c.current&&0===e.messages.length&&(c.current=!0,setTimeout(()=>{d()},800)),e.isActive||(c.current=!1)},[e.isActive,e.isAIInitiated,e.messages.length]),e.isActive&&e.character?a.jsx(W,{show:e.isActive,character:e.character,isVideoCall:e.isVideoCall,onEnd:()=>t(h),onSendMessage:e=>{n(e)},onRequestAIReply:d,messages:e.messages,isAITyping:e.isAITyping}):null},q=()=>a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"åŠ è½½ä¸­..."})]})}),J=e=>s.lazy(()=>e().catch(t=>e().catch(e=>{throw e}))),K=J(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.f),__vite__mapDeps([0,1,2,3,4,5]))),Y=J(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.g),__vite__mapDeps([0,1,2,3,4,5]))),G=J(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.h),__vite__mapDeps([0,1,2,3,4,5]))),U=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.i),__vite__mapDeps([0,1,2,3,4,5]))),X=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.j),__vite__mapDeps([0,1,2,3,4,5]))),Q=J(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.k),__vite__mapDeps([0,1,2,3,4,5]))),Z=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.E),__vite__mapDeps([0,1,2,3,4,5]))),ee=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.l),__vite__mapDeps([0,1,2,3,4,5]))),te=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.A),__vite__mapDeps([0,1,2,3,4,5]))),se=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.m),__vite__mapDeps([0,1,2,3,4,5]))),ae=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.n),__vite__mapDeps([0,1,2,3,4,5]))),ne=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.o),__vite__mapDeps([0,1,2,3,4,5]))),re=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.p),__vite__mapDeps([0,1,2,3,4,5]))),le=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.U),__vite__mapDeps([0,1,2,3,4,5]))),ie=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.q),__vite__mapDeps([0,1,2,3,4,5]))),oe=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.r),__vite__mapDeps([0,1,2,3,4,5]))),ce=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.s),__vite__mapDeps([0,1,2,3,4,5]))),he=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.W),__vite__mapDeps([0,1,2,3,4,5]))),de=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.t),__vite__mapDeps([0,1,2,3,4,5]))),me=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.u),__vite__mapDeps([0,1,2,3,4,5]))),xe=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.T),__vite__mapDeps([0,1,2,3,4,5]))),je=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.v),__vite__mapDeps([0,1,2,3,4,5]))),pe=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.w),__vite__mapDeps([0,1,2,3,4,5]))),ue=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.I),__vite__mapDeps([0,1,2,3,4,5]))),_e=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.R),__vite__mapDeps([0,1,2,3,4,5]))),ge=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.x),__vite__mapDeps([0,1,2,3,4,5]))),fe=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.y),__vite__mapDeps([0,1,2,3,4,5]))),ye=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.z),__vite__mapDeps([0,1,2,3,4,5]))),ve=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.B),__vite__mapDeps([0,1,2,3,4,5]))),we=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.F),__vite__mapDeps([0,1,2,3,4,5]))),be=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.G),__vite__mapDeps([0,1,2,3,4,5]))),Ee=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.H),__vite__mapDeps([0,1,2,3,4,5]))),Ie=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.J),__vite__mapDeps([0,1,2,3,4,5]))),Ne=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.K),__vite__mapDeps([0,1,2,3,4,5]))),ze=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.L),__vite__mapDeps([0,1,2,3,4,5]))),Le=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.N),__vite__mapDeps([0,1,2,3,4,5]))),Pe=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.O),__vite__mapDeps([0,1,2,3,4,5]))),Te=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.Q),__vite__mapDeps([0,1,2,3,4,5]))),Ae=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.V),__vite__mapDeps([0,1,2,3,4,5]))),Re=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.X),__vite__mapDeps([0,1,2,3,4,5]))),De=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.Y),__vite__mapDeps([0,1,2,3,4,5]))),Ve=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.Z),__vite__mapDeps([0,1,2,3,4,5]))),Oe=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.$),__vite__mapDeps([0,1,2,3,4,5]))),ke=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.a0),__vite__mapDeps([0,1,2,3,4,5]))),Ce=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.a1),__vite__mapDeps([0,1,2,3,4,5]))),Se=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.a2),__vite__mapDeps([0,1,2,3,4,5]))),$e=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.a3),__vite__mapDeps([0,1,2,3,4,5]))),Me=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.a4),__vite__mapDeps([0,1,2,3,4,5]))),Be=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.a5),__vite__mapDeps([0,1,2,3,4,5]))),Fe=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.a6),__vite__mapDeps([0,1,2,3,4,5]))),We=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.a7),__vite__mapDeps([0,1,2,3,4,5]))),He=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.a8),__vite__mapDeps([0,1,2,3,4,5]))),qe=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.a9),__vite__mapDeps([0,1,2,3,4,5]))),Je=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aa),__vite__mapDeps([0,1,2,3,4,5]))),Ke=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.ab),__vite__mapDeps([0,1,2,3,4,5]))),Ye=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.ac),__vite__mapDeps([0,1,2,3,4,5]))),Ge=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.ad),__vite__mapDeps([0,1,2,3,4,5]))),Ue=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.ae),__vite__mapDeps([0,1,2,3,4,5]))),Xe=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.af),__vite__mapDeps([0,1,2,3,4,5]))),Qe=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.ag),__vite__mapDeps([0,1,2,3,4,5]))),Ze=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.ah),__vite__mapDeps([0,1,2,3,4,5]))),et=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.ai),__vite__mapDeps([0,1,2,3,4,5]))),tt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aj),__vite__mapDeps([0,1,2,3,4,5]))),st=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.ak),__vite__mapDeps([0,1,2,3,4,5]))),at=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.al),__vite__mapDeps([0,1,2,3,4,5]))),nt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.am),__vite__mapDeps([0,1,2,3,4,5]))),rt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.an),__vite__mapDeps([0,1,2,3,4,5]))),lt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.ao),__vite__mapDeps([0,1,2,3,4,5]))),it=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.ap),__vite__mapDeps([0,1,2,3,4,5]))),ot=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aq),__vite__mapDeps([0,1,2,3,4,5]))),ct=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.ar),__vite__mapDeps([0,1,2,3,4,5]))),ht=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.as),__vite__mapDeps([0,1,2,3,4,5]))),dt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.at),__vite__mapDeps([0,1,2,3,4,5]))),mt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.au),__vite__mapDeps([0,1,2,3,4,5]))),xt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.av),__vite__mapDeps([0,1,2,3,4,5]))),jt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aw),__vite__mapDeps([0,1,2,3,4,5]))),pt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.ax),__vite__mapDeps([0,1,2,3,4,5]))),ut=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.ay),__vite__mapDeps([0,1,2,3,4,5]))),_t=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.az),__vite__mapDeps([0,1,2,3,4,5]))),gt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aA),__vite__mapDeps([0,1,2,3,4,5]))),ft=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aB),__vite__mapDeps([0,1,2,3,4,5]))),yt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aC),__vite__mapDeps([0,1,2,3,4,5]))),vt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aD),__vite__mapDeps([0,1,2,3,4,5]))),wt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aE),__vite__mapDeps([0,1,2,3,4,5]))),bt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aF),__vite__mapDeps([0,1,2,3,4,5]))),Et=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aG),__vite__mapDeps([0,1,2,3,4,5]))),It=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aH),__vite__mapDeps([0,1,2,3,4,5]))),Nt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aI),__vite__mapDeps([0,1,2,3,4,5]))),zt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aJ),__vite__mapDeps([0,1,2,3,4,5]))),Lt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aK),__vite__mapDeps([0,1,2,3,4,5]))),Pt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aL),__vite__mapDeps([0,1,2,3,4,5]))),Tt=s.lazy(()=>_(()=>import("./pages-CWX6yoiT.js").then(e=>e.aM),__vite__mapDeps([0,1,2,3,4,5]))),At=()=>{const e=D();return e.currentSong?a.jsx(S,{isPlaying:e.isPlaying,currentSong:e.currentSong,onPlayPause:e.togglePlay,onNext:e.next,onPrevious:e.previous,currentTime:e.currentTime,duration:e.duration}):null},Rt=({children:e})=>a.jsx(B,{children:a.jsx(s.Suspense,{fallback:a.jsx(q,{}),children:e})});function Dt(){return s.useEffect(()=>{},[]),s.useEffect(()=>{(async()=>{try{const{initPeriodicCleanup:e}=await _(async()=>{const{initPeriodicCleanup:e}=await import("./utils-BkWlPcuZ.js").then(e=>e.bJ);return{initPeriodicCleanup:e}},__vite__mapDeps([4,1,2,0,3,5]));e()}catch(e){}})()},[]),s.useEffect(()=>{(async()=>{try{const e=localStorage.getItem("custom_fonts");if(!e)return;const t=JSON.parse(e),s=new Set;document.fonts.forEach(e=>{e.family&&s.add(e.family)});const a=t.map(async e=>{try{if(s.has(e.fontFamily))return!0;const t=new FontFace(e.fontFamily,`url(${e.url})`,{display:"swap"});return await t.load(),document.fonts.add(t),s.add(e.fontFamily),!0}catch(t){return!1}});await Promise.all(a);const n=localStorage.getItem("chat_font_family_value"),r=localStorage.getItem("chat_font_family");n&&"system"!==r&&document.documentElement.style.setProperty("--chat-font-family",n)}catch(e){}})()},[]),a.jsx(B,{children:a.jsxs(R,{children:[a.jsx(F,{}),a.jsx(At,{}),a.jsx(O,{}),a.jsx(k,{}),a.jsx(C,{}),a.jsx(H,{}),a.jsx(M,{children:a.jsxs(i,{children:[a.jsxs(o,{path:"/wechat",element:a.jsx($,{}),children:[a.jsx(o,{index:!0,element:a.jsx(g,{})}),a.jsx(o,{path:"contacts",element:a.jsx(f,{})}),a.jsx(o,{path:"discover",element:a.jsx(y,{})}),a.jsx(o,{path:"me",element:a.jsx(v,{})})]}),a.jsx(o,{path:"/chat/:id",element:a.jsx(Rt,{children:a.jsx(K,{})})}),a.jsx(o,{path:"/settings",element:a.jsx(Rt,{children:a.jsx(G,{})})}),a.jsx(o,{path:"/settings-new",element:a.jsx(Rt,{children:a.jsx(jt,{})})}),a.jsx(o,{path:"/settings/sound-upload",element:a.jsx(Rt,{children:a.jsx(pt,{})})}),a.jsx(o,{path:"/profile/:id",element:a.jsx(Rt,{children:a.jsx(U,{})})}),a.jsx(o,{path:"/edit-profile",element:a.jsx(Rt,{children:a.jsx(re,{})})}),a.jsx(o,{path:"/users",element:a.jsx(Rt,{children:a.jsx(le,{})})}),a.jsx(o,{path:"/create-user",element:a.jsx(Rt,{children:a.jsx(ie,{})})}),a.jsx(o,{path:"/create-character",element:a.jsx(Rt,{children:a.jsx(Q,{})})}),a.jsx(o,{path:"/api-config",element:a.jsx(Rt,{children:a.jsx(te,{})})}),a.jsx(o,{path:"/api-list",element:a.jsx(Rt,{children:a.jsx(se,{})})}),a.jsx(o,{path:"/add-api",element:a.jsx(Rt,{children:a.jsx(ae,{})})}),a.jsx(o,{path:"/edit-api/:id",element:a.jsx(Rt,{children:a.jsx(ne,{})})}),a.jsx(o,{path:"/wechat/api-config",element:a.jsx(Rt,{children:a.jsx(te,{})})}),a.jsx(o,{path:"/wechat/api-list",element:a.jsx(Rt,{children:a.jsx(se,{})})}),a.jsx(o,{path:"/wechat/add-api",element:a.jsx(Rt,{children:a.jsx(ae,{})})}),a.jsx(o,{path:"/wechat/edit-api/:id",element:a.jsx(Rt,{children:a.jsx(ne,{})})}),a.jsx(o,{path:"/character/:id",element:a.jsx(Rt,{children:a.jsx(ee,{})})}),a.jsx(o,{path:"/edit-character/:id",element:a.jsx(Rt,{children:a.jsx(Z,{})})}),a.jsx(o,{path:"/moments",element:a.jsx(Rt,{children:a.jsx(Y,{})})}),a.jsx(o,{path:"/publish-moment",element:a.jsx(Rt,{children:a.jsx(oe,{})})}),a.jsx(o,{path:"/moment-notifications",element:a.jsx(Rt,{children:a.jsx(ce,{})})}),a.jsx(o,{path:"/wechat/moments",element:a.jsx(Rt,{children:a.jsx(Y,{})})}),a.jsx(o,{path:"/send-transfer/:id",element:a.jsx(Rt,{children:a.jsx(de,{})})}),a.jsx(o,{path:"/chat-settings/:id",element:a.jsx(Rt,{children:a.jsx(X,{})})}),a.jsx(o,{path:"/memory/:characterId",element:a.jsx(Rt,{children:a.jsx(fe,{})})}),a.jsx(o,{path:"/memory-summary/:characterId",element:a.jsx(Rt,{children:a.jsx(ye,{})})}),a.jsx(o,{path:"/wallet",element:a.jsx(Rt,{children:a.jsx(he,{})})}),a.jsx(o,{path:"/services",element:a.jsx(Rt,{children:a.jsx(me,{})})}),a.jsx(o,{path:"/transaction-history",element:a.jsx(Rt,{children:a.jsx(xe,{})})}),a.jsx(o,{path:"/card-wallet",element:a.jsx(Rt,{children:a.jsx(je,{})})}),a.jsx(o,{path:"/create-intimate-pay/:characterId",element:a.jsx(Rt,{children:a.jsx(pe,{})})}),a.jsx(o,{path:"/intimate-pay/:characterId",element:a.jsx(Rt,{children:a.jsx(ue,{})})}),a.jsx(o,{path:"/intimate-pay/receive/:characterId/:monthlyLimit",element:a.jsx(Rt,{children:a.jsx(_e,{})})}),a.jsx(o,{path:"/wallet-help",element:a.jsx(Rt,{children:a.jsx(ge,{})})}),a.jsx(o,{path:"/diary/:characterId",element:a.jsx(Rt,{children:a.jsx(we,{})})}),a.jsx(o,{path:"/streak/:characterId",element:a.jsx(Rt,{children:a.jsx(be,{})})}),a.jsx(o,{path:"/about",element:a.jsx(Rt,{children:a.jsx(ut,{})})}),a.jsx(o,{path:"/accounting",element:a.jsx(Rt,{children:a.jsx(Ie,{})})}),a.jsx(o,{path:"/accounting-chat",element:a.jsx(Rt,{children:a.jsx(Ne,{})})}),a.jsx(o,{path:"/add-transaction",element:a.jsx(Rt,{children:a.jsx(ze,{})})}),a.jsx(o,{path:"/groups",element:a.jsx(Rt,{children:a.jsx(Le,{})})}),a.jsx(o,{path:"/create-group",element:a.jsx(Rt,{children:a.jsx(Pe,{})})}),a.jsx(o,{path:"/group/:id",element:a.jsx(Rt,{children:a.jsx(Te,{})})}),a.jsx(o,{path:"/group-settings/:id",element:a.jsx(Rt,{children:a.jsx(Ae,{})})}),a.jsx(o,{path:"/shake-shake",element:a.jsx(Rt,{children:a.jsx(Re,{})})}),a.jsx(o,{path:"/live",element:a.jsx(Rt,{children:a.jsx(De,{})})}),a.jsx(o,{path:"/live-room/:id",element:a.jsx(Rt,{children:a.jsx(Ve,{})})}),a.jsx(o,{path:"/couple-space",element:a.jsx(Rt,{children:a.jsx(Oe,{})})}),a.jsx(o,{path:"/couple-space/:characterId",element:a.jsx(Rt,{children:a.jsx(Oe,{})})}),a.jsx(o,{path:"/couple-album",element:a.jsx(Rt,{children:a.jsx(ke,{})})}),a.jsx(o,{path:"/couple-anniversary",element:a.jsx(Rt,{children:a.jsx(Ce,{})})}),a.jsx(o,{path:"/couple-message-board",element:a.jsx(Rt,{children:a.jsx(Se,{})})}),a.jsx(o,{path:"/calendar",element:a.jsx(Rt,{children:a.jsx($e,{})})}),a.jsx(o,{path:"/ai-footprint",element:a.jsx(Rt,{children:a.jsx(Me,{})})}),a.jsx(o,{path:"/ai-footprint/:characterId",element:a.jsx(Rt,{children:a.jsx(Me,{})})}),a.jsx(o,{path:"/life-settings/:characterId",element:a.jsx(Rt,{children:a.jsx(dt,{})})}),a.jsx(o,{path:"/spark-moments",element:a.jsx(Rt,{children:a.jsx(Ee,{})})}),a.jsx(o,{path:"/memes-library",element:a.jsx(Rt,{children:a.jsx(Be,{})})}),a.jsx(o,{path:"/mini-programs",element:a.jsx(Rt,{children:a.jsx(xt,{})})}),a.jsx(o,{path:"/bubble-store",element:a.jsx(Rt,{children:a.jsx(Fe,{})})}),a.jsx(o,{path:"/font-customizer",element:a.jsx(Rt,{children:a.jsx(We,{})})}),a.jsx(o,{path:"/icon-customizer",element:a.jsx(Rt,{children:a.jsx(He,{})})}),a.jsx(o,{path:"/background-customizer",element:a.jsx(Rt,{children:a.jsx(qe,{})})}),a.jsx(o,{path:"/weather-detail",element:a.jsx(Rt,{children:a.jsx(Je,{})})}),a.jsx(o,{path:"/music-player",element:a.jsx(Rt,{children:a.jsx(Ke,{})})}),a.jsx(o,{path:"/upload-song",element:a.jsx(Rt,{children:a.jsx(Ye,{})})}),a.jsx(o,{path:"/music-search",element:a.jsx(Rt,{children:a.jsx(Ue,{})})}),a.jsx(o,{path:"/music-together-chat",element:a.jsx(Rt,{children:a.jsx(Xe,{})})}),a.jsx(o,{path:"/music-invite-demo",element:a.jsx(Rt,{children:a.jsx(Qe,{})})}),a.jsx(o,{path:"/game/gomoku/:characterId",element:a.jsx(Rt,{children:a.jsx(Ze,{})})}),a.jsx(o,{path:"/game/character-select",element:a.jsx(Rt,{children:a.jsx(et,{})})}),a.jsx(o,{path:"/game-list",element:a.jsx(Rt,{children:a.jsx(tt,{})})}),a.jsx(o,{path:"/game/undercover/:groupId",element:a.jsx(Rt,{children:a.jsx(st,{})})}),a.jsx(o,{path:"/desktop",element:a.jsx(Rt,{children:a.jsx(at,{})})}),a.jsx(o,{path:"/story-mode/:characterId",element:a.jsx(Rt,{children:a.jsx(nt,{})})}),a.jsx(o,{path:"/preset",element:a.jsx(Rt,{children:a.jsx(it,{})})}),a.jsx(o,{path:"/offline-chat",element:a.jsx(Rt,{children:a.jsx(ot,{})})}),a.jsx(o,{path:"/customize",element:a.jsx(Rt,{children:a.jsx(ct,{})})}),a.jsx(o,{path:"/statusbar-customize",element:a.jsx(Rt,{children:a.jsx(ht,{})})}),a.jsx(o,{path:"/worldbook",element:a.jsx(Rt,{children:a.jsx(rt,{})})}),a.jsx(o,{path:"/world-book",element:a.jsx(Rt,{children:a.jsx(rt,{})})}),a.jsx(o,{path:"/edit-world-book/:id",element:a.jsx(Rt,{children:a.jsx(lt,{})})}),a.jsx(o,{path:"/memory-cleanup",element:a.jsx(Rt,{children:a.jsx(ve,{})})}),a.jsx(o,{path:"/storage-migration",element:a.jsx(Rt,{children:a.jsx(mt,{})})}),a.jsx(o,{path:"/ai-phone-select",element:a.jsx(Rt,{children:a.jsx(Ge,{})})}),a.jsx(o,{path:"/forum",element:a.jsx(Rt,{children:a.jsx(_t,{})})}),a.jsx(o,{path:"/forum/welcome",element:a.jsx(Rt,{children:a.jsx(gt,{})})}),a.jsx(o,{path:"/forum/initialize",element:a.jsx(Rt,{children:a.jsx(ft,{})})}),a.jsx(o,{path:"/forum/character-list",element:a.jsx(Rt,{children:a.jsx(yt,{})})}),a.jsx(o,{path:"/forum/publish",element:a.jsx(Rt,{children:a.jsx(vt,{})})}),a.jsx(o,{path:"/forum/post/:id",element:a.jsx(Rt,{children:a.jsx(wt,{})})}),a.jsx(o,{path:"/forum/search",element:a.jsx(Rt,{children:a.jsx(bt,{})})}),a.jsx(o,{path:"/forum/topics",element:a.jsx(Rt,{children:a.jsx(Et,{})})}),a.jsx(o,{path:"/forum/create-topic",element:a.jsx(Rt,{children:a.jsx(It,{})})}),a.jsx(o,{path:"/forum/topic/:id",element:a.jsx(Rt,{children:a.jsx(Nt,{})})}),a.jsx(o,{path:"/forum/notifications",element:a.jsx(Rt,{children:a.jsx(zt,{})})}),a.jsx(o,{path:"/forum/profile",element:a.jsx(Rt,{children:a.jsx(Lt,{})})}),a.jsx(o,{path:"/forum/user/:userId",element:a.jsx(Rt,{children:a.jsx(Pt,{})})}),a.jsx(o,{path:"/forum/memes",element:a.jsx(Rt,{children:a.jsx(Tt,{})})}),a.jsx(o,{path:"/",element:a.jsx(Rt,{children:a.jsx(at,{})})})]})})]})})}c.createRoot(document.getElementById("root")).render(a.jsx(h.StrictMode,{children:a.jsx(Dt,{})}));
